(window.webpackJsonp=window.webpackJsonp||[]).push([[4],[,,,function(e,t,n){"use strict";n.d(t,"gf",function(){return r}),n.d(t,"lg",function(){return a}),n.d(t,"Ni",function(){return i}),n.d(t,"Xb",function(){return o}),n.d(t,"Wb",function(){return s}),n.d(t,"hg",function(){return c}),n.d(t,"Yd",function(){return u}),n.d(t,"Lb",function(){return l}),n.d(t,"Ob",function(){return f}),n.d(t,"Jb",function(){return h}),n.d(t,"if",function(){return p}),n.d(t,"oj",function(){return d}),n.d(t,"pj",function(){return m}),n.d(t,"pf",function(){return v}),n.d(t,"a",function(){return b}),n.d(t,"s",function(){return g}),n.d(t,"k",function(){return y}),n.d(t,"i",function(){return k}),n.d(t,"j",function(){return O}),n.d(t,"o",function(){return j}),n.d(t,"m",function(){return w}),n.d(t,"l",function(){return E}),n.d(t,"c",function(){return S}),n.d(t,"rj",function(){return P}),n.d(t,"qj",function(){return x}),n.d(t,"ri",function(){return T}),n.d(t,"sj",function(){return C}),n.d(t,"C",function(){return N}),n.d(t,"ai",function(){return R}),n.d(t,"mi",function(){return M}),n.d(t,"eg",function(){return A}),n.d(t,"Jf",function(){return q}),n.d(t,"vi",function(){return D}),n.d(t,"ii",function(){return I}),n.d(t,"qi",function(){return _}),n.d(t,"Rc",function(){return F}),n.d(t,"Nc",function(){return L}),n.d(t,"af",function(){return B}),n.d(t,"id",function(){return z}),n.d(t,"jd",function(){return V}),n.d(t,"kd",function(){return H}),n.d(t,"fd",function(){return U}),n.d(t,"gd",function(){return J}),n.d(t,"ig",function(){return G}),n.d(t,"cg",function(){return W}),n.d(t,"Zc",function(){return K}),n.d(t,"Ah",function(){return X}),n.d(t,"Eh",function(){return Q}),n.d(t,"og",function(){return Y}),n.d(t,"Cf",function(){return Z}),n.d(t,"mc",function(){return $}),n.d(t,"kc",function(){return ee}),n.d(t,"Rf",function(){return te}),n.d(t,"Sf",function(){return ne}),n.d(t,"Kd",function(){return re}),n.d(t,"Kb",function(){return ae}),n.d(t,"tc",function(){return ie}),n.d(t,"pi",function(){return oe}),n.d(t,"bi",function(){return se}),n.d(t,"Yi",function(){return ce}),n.d(t,"Fb",function(){return ue}),n.d(t,"Ji",function(){return le}),n.d(t,"Fh",function(){return fe}),n.d(t,"Kh",function(){return he}),n.d(t,"Vc",function(){return pe}),n.d(t,"Wc",function(){return de}),n.d(t,"lh",function(){return me}),n.d(t,"Ag",function(){return ve}),n.d(t,"kh",function(){return be}),n.d(t,"eh",function(){return ge}),n.d(t,"fh",function(){return ye}),n.d(t,"yg",function(){return ke}),n.d(t,"sb",function(){return Oe}),n.d(t,"cd",function(){return je}),n.d(t,"zh",function(){return we}),n.d(t,"Fe",function(){return Ee}),n.d(t,"Tf",function(){return Se}),n.d(t,"wf",function(){return Pe}),n.d(t,"Bf",function(){return xe}),n.d(t,"xh",function(){return Te}),n.d(t,"zd",function(){return Ce}),n.d(t,"ec",function(){return Ne}),n.d(t,"lf",function(){return Re}),n.d(t,"sd",function(){return Me}),n.d(t,"di",function(){return Ae}),n.d(t,"Zf",function(){return qe}),n.d(t,"zi",function(){return De}),n.d(t,"Ed",function(){return Ie}),n.d(t,"Di",function(){return _e}),n.d(t,"Rb",function(){return Fe}),n.d(t,"Bi",function(){return Le}),n.d(t,"ye",function(){return Be}),n.d(t,"xe",function(){return ze}),n.d(t,"zb",function(){return Ve}),n.d(t,"Kg",function(){return He}),n.d(t,"Qh",function(){return Ue}),n.d(t,"We",function(){return Je}),n.d(t,"q",function(){return Ge}),n.d(t,"wh",function(){return We}),n.d(t,"dg",function(){return Ke}),n.d(t,"Ch",function(){return Xe}),n.d(t,"B",function(){return Qe}),n.d(t,"z",function(){return Ye}),n.d(t,"A",function(){return Ze}),n.d(t,"ki",function(){return $e}),n.d(t,"li",function(){return et}),n.d(t,"wd",function(){return tt}),n.d(t,"sc",function(){return nt}),n.d(t,"Ee",function(){return rt}),n.d(t,"ld",function(){return at}),n.d(t,"ef",function(){return it}),n.d(t,"qd",function(){return ot}),n.d(t,"ah",function(){return st}),n.d(t,"Vd",function(){return ct}),n.d(t,"Mg",function(){return ut}),n.d(t,"rg",function(){return lt}),n.d(t,"Yh",function(){return ft}),n.d(t,"Zg",function(){return ht}),n.d(t,"Ug",function(){return pt}),n.d(t,"Jg",function(){return dt}),n.d(t,"oi",function(){return mt}),n.d(t,"nj",function(){return vt}),n.d(t,"yd",function(){return bt}),n.d(t,"kb",function(){return gt}),n.d(t,"ff",function(){return yt}),n.d(t,"Zi",function(){return kt}),n.d(t,"ab",function(){return Ot}),n.d(t,"Qi",function(){return jt}),n.d(t,"Ri",function(){return wt}),n.d(t,"Hd",function(){return Et}),n.d(t,"re",function(){return St}),n.d(t,"qe",function(){return Pt}),n.d(t,"g",function(){return xt}),n.d(t,"ud",function(){return Tt}),n.d(t,"me",function(){return Ct}),n.d(t,"x",function(){return Nt}),n.d(t,"w",function(){return Rt}),n.d(t,"f",function(){return Mt}),n.d(t,"pg",function(){return At}),n.d(t,"qg",function(){return qt}),n.d(t,"uh",function(){return Dt}),n.d(t,"wb",function(){return It}),n.d(t,"Cb",function(){return _t}),n.d(t,"Bb",function(){return Ft}),n.d(t,"vb",function(){return Lt}),n.d(t,"Oe",function(){return Bt}),n.d(t,"hb",function(){return zt}),n.d(t,"yf",function(){return Vt}),n.d(t,"Gd",function(){return Ht}),n.d(t,"hh",function(){return Ut}),n.d(t,"zg",function(){return Jt}),n.d(t,"Qg",function(){return Gt}),n.d(t,"we",function(){return Wt}),n.d(t,"ch",function(){return Kt}),n.d(t,"n",function(){return Xt}),n.d(t,"Dg",function(){return Qt}),n.d(t,"lc",function(){return Yt}),n.d(t,"Db",function(){return Zt}),n.d(t,"Lf",function(){return $t}),n.d(t,"Df",function(){return en}),n.d(t,"nh",function(){return tn}),n.d(t,"Md",function(){return nn}),n.d(t,"Hg",function(){return rn}),n.d(t,"Gh",function(){return an}),n.d(t,"Pb",function(){return on}),n.d(t,"Pd",function(){return sn}),n.d(t,"Hh",function(){return cn}),n.d(t,"qf",function(){return un}),n.d(t,"Af",function(){return ln}),n.d(t,"Bg",function(){return fn}),n.d(t,"Vb",function(){return hn}),n.d(t,"nc",function(){return pn}),n.d(t,"ji",function(){return dn}),n.d(t,"Oc",function(){return mn}),n.d(t,"Yf",function(){return vn}),n.d(t,"t",function(){return bn}),n.d(t,"rh",function(){return gn}),n.d(t,"Wg",function(){return yn}),n.d(t,"td",function(){return kn}),n.d(t,"ph",function(){return On}),n.d(t,"Yb",function(){return jn}),n.d(t,"Hf",function(){return wn}),n.d(t,"Vf",function(){return En}),n.d(t,"Sc",function(){return Sn}),n.d(t,"Ub",function(){return Pn}),n.d(t,"Tb",function(){return xn}),n.d(t,"Sb",function(){return Tn}),n.d(t,"Fc",function(){return Cn}),n.d(t,"Ue",function(){return Nn}),n.d(t,"nf",function(){return Rn}),n.d(t,"jc",function(){return Mn}),n.d(t,"Ih",function(){return An}),n.d(t,"ci",function(){return qn}),n.d(t,"ti",function(){return Dn}),n.d(t,"Kc",function(){return In}),n.d(t,"Ic",function(){return _n}),n.d(t,"Jc",function(){return Fn}),n.d(t,"ic",function(){return Ln}),n.d(t,"Of",function(){return Bn}),n.d(t,"sh",function(){return zn}),n.d(t,"Bh",function(){return Vn}),n.d(t,"xf",function(){return Hn}),n.d(t,"dh",function(){return Un}),n.d(t,"Dd",function(){return Jn}),n.d(t,"oe",function(){return Gn}),n.d(t,"ce",function(){return Wn}),n.d(t,"Og",function(){return Kn}),n.d(t,"Kf",function(){return Xn}),n.d(t,"Hb",function(){return Qn}),n.d(t,"Be",function(){return Yn}),n.d(t,"De",function(){return Zn}),n.d(t,"yh",function(){return $n}),n.d(t,"Lg",function(){return er}),n.d(t,"qh",function(){return tr}),n.d(t,"Ci",function(){return nr}),n.d(t,"ze",function(){return rr}),n.d(t,"xb",function(){return ar}),n.d(t,"yb",function(){return ir}),n.d(t,"Oi",function(){return or}),n.d(t,"wi",function(){return sr}),n.d(t,"Jh",function(){return cr}),n.d(t,"X",function(){return ur}),n.d(t,"Q",function(){return lr}),n.d(t,"H",function(){return fr}),n.d(t,"N",function(){return hr}),n.d(t,"D",function(){return pr}),n.d(t,"W",function(){return dr}),n.d(t,"O",function(){return mr}),n.d(t,"V",function(){return vr}),n.d(t,"Z",function(){return br}),n.d(t,"bg",function(){return gr}),n.d(t,"xc",function(){return yr}),n.d(t,"wc",function(){return kr}),n.d(t,"ag",function(){return Or}),n.d(t,"bd",function(){return jr}),n.d(t,"ei",function(){return wr}),n.d(t,"Ae",function(){return Er}),n.d(t,"Y",function(){return Sr}),n.d(t,"Nh",function(){return Pr}),n.d(t,"I",function(){return xr}),n.d(t,"J",function(){return Tr}),n.d(t,"K",function(){return Cr}),n.d(t,"R",function(){return Nr}),n.d(t,"U",function(){return Rr}),n.d(t,"M",function(){return Mr}),n.d(t,"S",function(){return Ar}),n.d(t,"L",function(){return qr}),n.d(t,"tf",function(){return Dr}),n.d(t,"pc",function(){return Ir}),n.d(t,"G",function(){return _r}),n.d(t,"Rh",function(){return Fr}),n.d(t,"Sh",function(){return Lr}),n.d(t,"xg",function(){return Br}),n.d(t,"Uh",function(){return zr}),n.d(t,"pe",function(){return Vr}),n.d(t,"v",function(){return Hr}),n.d(t,"Mh",function(){return Ur}),n.d(t,"Rg",function(){return Jr}),n.d(t,"Xf",function(){return Gr}),n.d(t,"e",function(){return Wr}),n.d(t,"Th",function(){return Kr}),n.d(t,"bb",function(){return Xr}),n.d(t,"db",function(){return Qr}),n.d(t,"eb",function(){return Yr}),n.d(t,"fb",function(){return Zr}),n.d(t,"si",function(){return $r}),n.d(t,"gb",function(){return ea}),n.d(t,"cb",function(){return ta}),n.d(t,"Ac",function(){return na}),n.d(t,"vc",function(){return ra}),n.d(t,"d",function(){return aa}),n.d(t,"df",function(){return ia}),n.d(t,"Ui",function(){return oa}),n.d(t,"Vi",function(){return sa}),n.d(t,"Wi",function(){return ca}),n.d(t,"yc",function(){return ua}),n.d(t,"dd",function(){return la}),n.d(t,"ve",function(){return fa}),n.d(t,"Ld",function(){return ha}),n.d(t,"Nd",function(){return pa}),n.d(t,"vf",function(){return da}),n.d(t,"zc",function(){return ma}),n.d(t,"F",function(){return va}),n.d(t,"Bc",function(){return ba}),n.d(t,"ue",function(){return ga}),n.d(t,"p",function(){return ya}),n.d(t,"ng",function(){return ka}),n.d(t,"Wh",function(){return Oa}),n.d(t,"jb",function(){return ja}),n.d(t,"ui",function(){return wa}),n.d(t,"md",function(){return Ea}),n.d(t,"sf",function(){return Sa}),n.d(t,"Vh",function(){return Pa}),n.d(t,"If",function(){return xa}),n.d(t,"gi",function(){return Ta}),n.d(t,"fi",function(){return Ca}),n.d(t,"Hc",function(){return Na}),n.d(t,"Gc",function(){return Ra}),n.d(t,"Ai",function(){return Ma}),n.d(t,"Mc",function(){return Aa}),n.d(t,"Nf",function(){return qa}),n.d(t,"jf",function(){return Da}),n.d(t,"Zb",function(){return Ia}),n.d(t,"be",function(){return _a}),n.d(t,"Ib",function(){return Fa}),n.d(t,"Od",function(){return La}),n.d(t,"Qc",function(){return Ba}),n.d(t,"Ad",function(){return za}),n.d(t,"Zh",function(){return Va}),n.d(t,"Eb",function(){return Ha}),n.d(t,"rd",function(){return Ua}),n.d(t,"P",function(){return Ja}),n.d(t,"Oh",function(){return Ga}),n.d(t,"Ph",function(){return Wa}),n.d(t,"Qf",function(){return Ka}),n.d(t,"Xe",function(){return Xa}),n.d(t,"Cc",function(){return Qa}),n.d(t,"bf",function(){return Ya}),n.d(t,"ih",function(){return Za}),n.d(t,"Mf",function(){return $a}),n.d(t,"fg",function(){return ei}),n.d(t,"ub",function(){return ti}),n.d(t,"tb",function(){return ni}),n.d(t,"Xd",function(){return ri}),n.d(t,"jg",function(){return ai}),n.d(t,"uf",function(){return ii}),n.d(t,"Mb",function(){return oi}),n.d(t,"bh",function(){return si}),n.d(t,"Pi",function(){return ci}),n.d(t,"E",function(){return ui}),n.d(t,"uc",function(){return li}),n.d(t,"u",function(){return fi}),n.d(t,"Ne",function(){return hi}),n.d(t,"ni",function(){return pi}),n.d(t,"rf",function(){return di}),n.d(t,"te",function(){return mi}),n.d(t,"wg",function(){return vi}),n.d(t,"T",function(){return bi}),n.d(t,"oh",function(){return gi}),n.d(t,"vg",function(){return yi}),n.d(t,"Dc",function(){return ki}),n.d(t,"Gb",function(){return Oi}),n.d(t,"ge",function(){return ji}),n.d(t,"bc",function(){return wi}),n.d(t,"fe",function(){return Ei}),n.d(t,"ed",function(){return Si}),n.d(t,"r",function(){return Pi}),n.d(t,"vh",function(){return xi}),n.d(t,"yi",function(){return Ti}),n.d(t,"Eg",function(){return Ci}),n.d(t,"tg",function(){return Ni}),n.d(t,"Ze",function(){return Ri}),n.d(t,"Bd",function(){return Mi}),n.d(t,"se",function(){return Ai}),n.d(t,"Nb",function(){return qi}),n.d(t,"ug",function(){return Di}),n.d(t,"Qb",function(){return Ii}),n.d(t,"xd",function(){return _i}),n.d(t,"ee",function(){return Fi}),n.d(t,"of",function(){return Li}),n.d(t,"Ge",function(){return Bi}),n.d(t,"Fd",function(){return zi}),n.d(t,"he",function(){return Vi}),n.d(t,"ne",function(){return Hi}),n.d(t,"le",function(){return Ui}),n.d(t,"Si",function(){return Ji}),n.d(t,"Xh",function(){return Gi}),n.d(t,"Uc",function(){return Wi}),n.d(t,"th",function(){return Ki}),n.d(t,"Xi",function(){return Xi}),n.d(t,"Ye",function(){return Qi}),n.d(t,"ie",function(){return Yi}),n.d(t,"kg",function(){return Zi}),n.d(t,"mg",function(){return $i}),n.d(t,"Me",function(){return eo}),n.d(t,"Ti",function(){return to}),n.d(t,"je",function(){return no}),n.d(t,"Pf",function(){return ro}),n.d(t,"cc",function(){return ao}),n.d(t,"lb",function(){return io}),n.d(t,"Wf",function(){return oo}),n.d(t,"pb",function(){return so}),n.d(t,"oc",function(){return co}),n.d(t,"y",function(){return uo}),n.d(t,"Rd",function(){return lo}),n.d(t,"hi",function(){return fo}),n.d(t,"qc",function(){return ho}),n.d(t,"mb",function(){return po}),n.d(t,"nb",function(){return mo}),n.d(t,"h",function(){return vo}),n.d(t,"sg",function(){return bo}),n.d(t,"Xc",function(){return go}),n.d(t,"Sd",function(){return yo}),n.d(t,"Qd",function(){return ko}),n.d(t,"Yc",function(){return Oo}),n.d(t,"de",function(){return jo}),n.d(t,"Ig",function(){return wo}),n.d(t,"He",function(){return Eo}),n.d(t,"Ie",function(){return So}),n.d(t,"Ke",function(){return Po}),n.d(t,"Td",function(){return xo}),n.d(t,"ad",function(){return To}),n.d(t,"bj",function(){return Co}),n.d(t,"aj",function(){return No}),n.d(t,"ib",function(){return Ro}),n.d(t,"Ki",function(){return Mo}),n.d(t,"gg",function(){return Ao}),n.d(t,"nd",function(){return qo}),n.d(t,"lj",function(){return Do}),n.d(t,"Gi",function(){return Io}),n.d(t,"Id",function(){return _o}),n.d(t,"Tc",function(){return Fo}),n.d(t,"hd",function(){return Lo}),n.d(t,"Lc",function(){return Bo}),n.d(t,"Cd",function(){return zo}),n.d(t,"Mi",function(){return Vo}),n.d(t,"mh",function(){return Ho}),n.d(t,"Pg",function(){return Uo}),n.d(t,"Vg",function(){return Jo}),n.d(t,"Yg",function(){return Go}),n.d(t,"Dh",function(){return Wo}),n.d(t,"jh",function(){return Ko}),n.d(t,"Ng",function(){return Xo}),n.d(t,"qb",function(){return Qo}),n.d(t,"rb",function(){return Yo}),n.d(t,"Hi",function(){return Zo}),n.d(t,"Ii",function(){return $o}),n.d(t,"Ei",function(){return es}),n.d(t,"Fi",function(){return ts}),n.d(t,"mj",function(){return ns}),n.d(t,"gj",function(){return rs}),n.d(t,"Li",function(){return as}),n.d(t,"Cg",function(){return is}),n.d(t,"Jd",function(){return os}),n.d(t,"Wd",function(){return ss}),n.d(t,"xi",function(){return cs}),n.d(t,"pd",function(){return us}),n.d(t,"ke",function(){return ls}),n.d(t,"od",function(){return fs}),n.d(t,"ae",function(){return hs}),n.d(t,"Uf",function(){return ps}),n.d(t,"Ec",function(){return ds}),n.d(t,"Je",function(){return ms}),n.d(t,"Le",function(){return vs}),n.d(t,"Pc",function(){return bs}),n.d(t,"Ce",function(){return gs}),n.d(t,"jj",function(){return ys}),n.d(t,"zf",function(){return ks}),n.d(t,"b",function(){return Os}),n.d(t,"kf",function(){return js}),n.d(t,"hc",function(){return ws}),n.d(t,"fc",function(){return Es}),n.d(t,"gc",function(){return Ss}),n.d(t,"vd",function(){return Ps}),n.d(t,"Ud",function(){return xs}),n.d(t,"ac",function(){return Ts}),n.d(t,"hf",function(){return Cs}),n.d(t,"Ef",function(){return Ns}),n.d(t,"Gf",function(){return Rs}),n.d(t,"Ff",function(){return Ms}),n.d(t,"Xg",function(){return As}),n.d(t,"fj",function(){return qs}),n.d(t,"mf",function(){return Ds}),n.d(t,"Ve",function(){return Is}),n.d(t,"Ab",function(){return _s}),n.d(t,"Re",function(){return Fs}),n.d(t,"Sg",function(){return Ls}),n.d(t,"Pe",function(){return Bs}),n.d(t,"Tg",function(){return zs}),n.d(t,"Qe",function(){return Vs}),n.d(t,"dc",function(){return Hs}),n.d(t,"Fg",function(){return Us}),n.d(t,"dj",function(){return Js}),n.d(t,"Se",function(){return Gs}),n.d(t,"Te",function(){return Ws}),n.d(t,"ob",function(){return Ks}),n.d(t,"Gg",function(){return Xs}),n.d(t,"Lh",function(){return Qs}),n.d(t,"gh",function(){return Ys}),n.d(t,"cf",function(){return Zs}),n.d(t,"kj",function(){return $s}),n.d(t,"cj",function(){return ec}),n.d(t,"ej",function(){return tc}),n.d(t,"Zd",function(){return nc}),n.d(t,"rc",function(){return rc}),n.d(t,"hj",function(){return ac}),n.d(t,"ij",function(){return ic});var r=1,a=2,i=3,o=4,s=5,c=6,u=7,l=8,f=9,h=10,p=11,d=12,m=13,v=16,b=17,g=18,y=19,k=20,O=21,j=22,w=23,E=24,S=25,P=26,x=27,T=28,C=29,N=30,R=31,M=32,A=33,q=34,D=35,I=36,_=37,F=38,L=39,B=40,z=41,V=42,H=43,U=44,J=45,G=46,W=47,K=48,X=49,Q=50,Y=51,Z=52,$=53,ee=54,te=55,ne=56,re=57,ae=58,ie=59,oe=60,se=61,ce=62,ue=63,le=64,fe=65,he=66,pe=67,de=68,me=69,ve=70,be=71,ge=72,ye=73,ke=74,Oe=75,je=76,we=77,Ee=78,Se=79,Pe=80,xe=81,Te=82,Ce=83,Ne=84,Re=85,Me=86,Ae=87,qe=88,De=89,Ie=90,_e=91,Fe=92,Le=93,Be=94,ze=95,Ve=96,He=97,Ue=98,Je=99,Ge=100,We=101,Ke=102,Xe=103,Qe=104,Ye=105,Ze=106,$e=107,et=108,tt=109,nt=110,rt=111,at=112,it=113,ot=114,st=115,ct=116,ut=117,lt=118,ft=119,ht=120,pt=121,dt=122,mt=123,vt=124,bt=125,gt=126,yt=127,kt=128,Ot=129,jt=130,wt=131,Et=132,St=133,Pt=134,xt=135,Tt=136,Ct=137,Nt=138,Rt=139,Mt=140,At=141,qt=142,Dt=143,It=144,_t=145,Ft=146,Lt=147,Bt=148,zt=149,Vt=150,Ht=151,Ut=152,Jt=153,Gt=154,Wt=155,Kt=156,Xt=157,Qt=158,Yt=159,Zt=160,$t=161,en=162,tn=163,nn=164,rn=165,an=166,on=167,sn=168,cn=169,un=170,ln=171,fn=172,hn=173,pn=174,dn=175,mn=176,vn=178,bn=179,gn=180,yn=181,kn=182,On=183,jn=184,wn=185,En=186,Sn=187,Pn=188,xn=189,Tn=190,Cn=191,Nn=192,Rn=193,Mn=194,An=195,qn=196,Dn=197,In=198,_n=199,Fn=200,Ln=201,Bn=202,zn=203,Vn=204,Hn=205,Un=206,Jn=207,Gn=208,Wn=209,Kn=210,Xn=211,Qn=212,Yn=213,Zn=214,$n=215,er=216,tr=217,nr=218,rr=219,ar=220,ir=221,or=222,sr=223,cr=224,ur=225,lr=226,fr=229,hr=230,pr=231,dr=232,mr=233,vr=234,br=235,gr=236,yr=237,kr=238,Or=239,jr=240,wr=241,Er=242,Sr=243,Pr=244,xr=245,Tr=246,Cr=247,Nr=248,Rr=249,Mr=250,Ar=251,qr=252,Dr=253,Ir=254,_r=255,Fr=256,Lr=257,Br=258,zr=259,Vr=260,Hr=261,Ur=262,Jr=263,Gr=264,Wr=265,Kr=266,Xr=267,Qr=268,Yr=269,Zr=270,$r=271,ea=272,ta=273,na=274,ra=275,aa=276,ia=277,oa=278,sa=279,ca=280,ua=281,la=282,fa=283,ha=284,pa=285,da=286,ma=287,va=288,ba=289,ga=290,ya=291,ka=292,Oa=293,ja=294,wa=295,Ea=296,Sa=297,Pa=298,xa=299,Ta=300,Ca=301,Na=302,Ra=303,Ma=304,Aa=305,qa=306,Da=307,Ia=308,_a=309,Fa=310,La=311,Ba=312,za=313,Va=314,Ha=315,Ua=316,Ja=317,Ga=318,Wa=319,Ka=320,Xa=321,Qa=322,Ya=323,Za=324,$a=325,ei=326,ti=327,ni=328,ri=329,ai=330,ii=331,oi=332,si=333,ci=334,ui=335,li=336,fi=337,hi=338,pi=339,di=340,mi=341,vi=342,bi=343,gi=344,yi=345,ki=347,Oi=348,ji=349,wi=350,Ei=351,Si=352,Pi=353,xi=354,Ti=355,Ci=356,Ni=357,Ri=358,Mi=359,Ai=360,qi=361,Di=362,Ii=363,_i=364,Fi=365,Li=366,Bi=367,zi=368,Vi=369,Hi=370,Ui=371,Ji=372,Gi=373,Wi=374,Ki=375,Xi=376,Qi=377,Yi=378,Zi=379,$i=379,eo=380,to=381,no=382,ro=383,ao=384,io=385,oo=386,so=387,co=388,uo=389,lo=390,fo=391,ho=392,po=393,mo=394,vo=395,bo=396,go=397,yo=398,ko=399,Oo=400,jo=401,wo=402,Eo=403,So=404,Po=405,xo=406,To=407,Co=408,No=409,Ro=410,Mo=411,Ao=412,qo=413,Do=414,Io=415,_o=416,Fo=417,Lo=418,Bo=419,zo=420,Vo=421,Ho=422,Uo=423,Jo=424,Go=425,Wo=426,Ko=427,Xo=428,Qo=429,Yo=430,Zo=431,$o=432,es=433,ts=434,ns=445,rs=446,as=447,is=448,os=449,ss=450,cs=451,us=452,ls=453,fs=454,hs=455,ps=456,ds=457,ms=458,vs=459,bs=460,gs=461,ys=462,ks=463,Os=464,js=465,ws=466,Es=467,Ss=468,Ps=469,xs=470,Ts=471,Cs=472,Ns=473,Rs=474,Ms=475,As=476,qs=477,Ds=478,Is=479,_s=480,Fs=481,Ls=482,Bs=483,zs=484,Vs=485,Hs=486,Us=487,Js=488,Gs=489,Ws=490,Ks=491,Xs=492,Qs=493,Ys=494,Zs=495,$s=496,ec=497,tc=498,nc=499,rc=500,ac=501,ic=502},,,function(e,t,n){"use strict";n.d(t,"Ce",function(){return a}),n.d(t,"Cf",function(){return i}),n.d(t,"Dh",function(){return o}),n.d(t,"Jb",function(){return s}),n.d(t,"vf",function(){return c}),n.d(t,"yd",function(){return u}),n.d(t,"Ab",function(){return l}),n.d(t,"zb",function(){return f}),n.d(t,"xb",function(){return h}),n.d(t,"Ee",function(){return p}),n.d(t,"ei",function(){return d}),n.d(t,"fi",function(){return m}),n.d(t,"Je",function(){return v}),n.d(t,"a",function(){return b}),n.d(t,"j",function(){return g}),n.d(t,"h",function(){return y}),n.d(t,"i",function(){return k}),n.d(t,"n",function(){return O}),n.d(t,"l",function(){return j}),n.d(t,"k",function(){return w}),n.d(t,"nb",function(){return E}),n.d(t,"gi",function(){return S}),n.d(t,"y",function(){return P}),n.d(t,"sf",function(){return x}),n.d(t,"rf",function(){return T}),n.d(t,"Ze",function(){return C}),n.d(t,"mh",function(){return N}),n.d(t,"bh",function(){return R}),n.d(t,"ih",function(){return M}),n.d(t,"vc",function(){return A}),n.d(t,"xe",function(){return q}),n.d(t,"Jc",function(){return D}),n.d(t,"Kc",function(){return I}),n.d(t,"Lc",function(){return _}),n.d(t,"Gc",function(){return F}),n.d(t,"Hc",function(){return L}),n.d(t,"wf",function(){return B}),n.d(t,"yg",function(){return z}),n.d(t,"Cg",function(){return V}),n.d(t,"yf",function(){return H}),n.d(t,"Se",function(){return U}),n.d(t,"Ub",function(){return J}),n.d(t,"bc",function(){return G}),n.d(t,"hf",function(){return W}),n.d(t,"if",function(){return K}),n.d(t,"hh",function(){return X}),n.d(t,"Ug",function(){return Q}),n.d(t,"Dc",function(){return Y}),n.d(t,"xg",function(){return Z}),n.d(t,"de",function(){return $}),n.d(t,"jf",function(){return ee}),n.d(t,"Fg",function(){return te}),n.d(t,"ad",function(){return ne}),n.d(t,"Pb",function(){return re}),n.d(t,"Fe",function(){return ae}),n.d(t,"Uc",function(){return ie}),n.d(t,"Wg",function(){return oe}),n.d(t,"pf",function(){return se}),n.d(t,"th",function(){return ce}),n.d(t,"fd",function(){return ue}),n.d(t,"Bh",function(){return le}),n.d(t,"Fb",function(){return fe}),n.d(t,"zh",function(){return he}),n.d(t,"Xd",function(){return pe}),n.d(t,"Wd",function(){return de}),n.d(t,"qb",function(){return me}),n.d(t,"Pf",function(){return ve}),n.d(t,"Jf",function(){return be}),n.d(t,"qh",function(){return ge}),n.d(t,"te",function(){return ye}),n.d(t,"p",function(){return ke}),n.d(t,"Eg",function(){return Oe}),n.d(t,"Ag",function(){return je}),n.d(t,"Af",function(){return we}),n.d(t,"zf",function(){return Ee}),n.d(t,"dh",function(){return Se}),n.d(t,"eh",function(){return Pe}),n.d(t,"Wb",function(){return xe}),n.d(t,"hi",function(){return Te}),n.d(t,"Sc",function(){return Ce}),n.d(t,"dc",function(){return Ne}),n.d(t,"ce",function(){return Re}),n.d(t,"Mc",function(){return Me}),n.d(t,"Ae",function(){return Ae}),n.d(t,"Qc",function(){return qe}),n.d(t,"Jd",function(){return De}),n.d(t,"dg",function(){return Ie}),n.d(t,"Rf",function(){return _e}),n.d(t,"vd",function(){return Fe}),n.d(t,"eg",function(){return Le}),n.d(t,"Zf",function(){return Be}),n.d(t,"Of",function(){return ze}),n.d(t,"gh",function(){return Ve}),n.d(t,"Qh",function(){return He}),n.d(t,"Zc",function(){return Ue}),n.d(t,"ab",function(){return Je}),n.d(t,"Be",function(){return Ge}),n.d(t,"Ph",function(){return We}),n.d(t,"S",function(){return Ke}),n.d(t,"Hh",function(){return Xe}),n.d(t,"Ih",function(){return Qe}),n.d(t,"id",function(){return Ye}),n.d(t,"Od",function(){return Ze}),n.d(t,"Pd",function(){return $e}),n.d(t,"f",function(){return et}),n.d(t,"s",function(){return tt}),n.d(t,"t",function(){return nt}),n.d(t,"e",function(){return rt}),n.d(t,"Wc",function(){return at}),n.d(t,"vg",function(){return it}),n.d(t,"mb",function(){return ot}),n.d(t,"tb",function(){return st}),n.d(t,"sb",function(){return ct}),n.d(t,"lb",function(){return ut}),n.d(t,"le",function(){return lt}),n.d(t,"Z",function(){return ft}),n.d(t,"hd",function(){return ht}),n.d(t,"ig",function(){return pt}),n.d(t,"Vf",function(){return dt}),n.d(t,"Vd",function(){return mt}),n.d(t,"m",function(){return vt}),n.d(t,"Tb",function(){return bt}),n.d(t,"ub",function(){return gt}),n.d(t,"bf",function(){return yt}),n.d(t,"Te",function(){return kt}),n.d(t,"og",function(){return Ot}),n.d(t,"md",function(){return jt}),n.d(t,"Db",function(){return wt}),n.d(t,"Jg",function(){return Et}),n.d(t,"x",function(){return St}),n.d(t,"w",function(){return Pt}),n.d(t,"v",function(){return xt}),n.d(t,"pd",function(){return Tt}),n.d(t,"Gg",function(){return Ct}),n.d(t,"Ke",function(){return Nt}),n.d(t,"Re",function(){return Rt}),n.d(t,"Vb",function(){return Mt}),n.d(t,"ch",function(){return At}),n.d(t,"of",function(){return qt}),n.d(t,"Vc",function(){return Dt}),n.d(t,"qg",function(){return It}),n.d(t,"Xe",function(){return _t}),n.d(t,"lf",function(){return Ft}),n.d(t,"wc",function(){return Lt}),n.d(t,"Ib",function(){return Bt}),n.d(t,"Hb",function(){return zt}),n.d(t,"Gb",function(){return Vt}),n.d(t,"nc",function(){return Ht}),n.d(t,"re",function(){return Ut}),n.d(t,"He",function(){return Jt}),n.d(t,"Zb",function(){return Gt}),n.d(t,"Hg",function(){return Wt}),n.d(t,"Vg",function(){return Kt}),n.d(t,"kh",function(){return Xt}),n.d(t,"qc",function(){return Qt}),n.d(t,"ac",function(){return Yt}),n.d(t,"ef",function(){return Zt}),n.d(t,"tg",function(){return $t}),n.d(t,"zg",function(){return en}),n.d(t,"gg",function(){return tn}),n.d(t,"ed",function(){return nn}),n.d(t,"Ud",function(){return rn}),n.d(t,"Cd",function(){return an}),n.d(t,"Tf",function(){return on}),n.d(t,"af",function(){return sn}),n.d(t,"ae",function(){return cn}),n.d(t,"be",function(){return un}),n.d(t,"wg",function(){return ln}),n.d(t,"Qf",function(){return fn}),n.d(t,"sg",function(){return hn}),n.d(t,"Ah",function(){return pn}),n.d(t,"Yd",function(){return dn}),n.d(t,"ob",function(){return mn}),n.d(t,"pb",function(){return vn}),n.d(t,"Ch",function(){return bn}),n.d(t,"nh",function(){return gn}),n.d(t,"Ig",function(){return yn}),n.d(t,"Q",function(){return kn}),n.d(t,"J",function(){return On}),n.d(t,"B",function(){return jn}),n.d(t,"H",function(){return wn}),n.d(t,"P",function(){return En}),n.d(t,"G",function(){return Sn}),n.d(t,"O",function(){return Pn}),n.d(t,"qf",function(){return xn}),n.d(t,"Cc",function(){return Tn}),n.d(t,"Xg",function(){return Cn}),n.d(t,"Zd",function(){return Nn}),n.d(t,"R",function(){return Rn}),n.d(t,"Lg",function(){return Mn}),n.d(t,"C",function(){return An}),n.d(t,"D",function(){return qn}),n.d(t,"E",function(){return Dn}),n.d(t,"K",function(){return In}),n.d(t,"N",function(){return _n}),n.d(t,"F",function(){return Fn}),n.d(t,"L",function(){return Ln}),n.d(t,"Xb",function(){return Bn}),n.d(t,"A",function(){return zn}),n.d(t,"Mg",function(){return Vn}),n.d(t,"Og",function(){return Hn}),n.d(t,"Pg",function(){return Un}),n.d(t,"Ng",function(){return Jn}),n.d(t,"Hf",function(){return Gn}),n.d(t,"Nd",function(){return Wn}),n.d(t,"Wf",function(){return Kn}),n.d(t,"nf",function(){return Xn}),n.d(t,"d",function(){return Qn}),n.d(t,"c",function(){return Yn}),n.d(t,"T",function(){return Zn}),n.d(t,"U",function(){return $n}),n.d(t,"V",function(){return er}),n.d(t,"W",function(){return tr}),n.d(t,"jh",function(){return nr}),n.d(t,"Y",function(){return rr}),n.d(t,"X",function(){return ar}),n.d(t,"ic",function(){return ir}),n.d(t,"fc",function(){return or}),n.d(t,"Nh",function(){return sr}),n.d(t,"Lh",function(){return cr}),n.d(t,"Mh",function(){return ur}),n.d(t,"gc",function(){return lr}),n.d(t,"Ec",function(){return fr}),n.d(t,"Td",function(){return hr}),n.d(t,"ld",function(){return pr}),n.d(t,"nd",function(){return dr}),n.d(t,"Qe",function(){return mr}),n.d(t,"hc",function(){return vr}),n.d(t,"jc",function(){return br}),n.d(t,"Sd",function(){return gr}),n.d(t,"o",function(){return yr}),n.d(t,"xf",function(){return kr}),n.d(t,"Rg",function(){return Or}),n.d(t,"Qg",function(){return jr}),n.d(t,"cb",function(){return wr}),n.d(t,"lh",function(){return Er}),n.d(t,"Nc",function(){return Sr}),n.d(t,"Me",function(){return Pr}),n.d(t,"Ye",function(){return xr}),n.d(t,"Zg",function(){return Tr}),n.d(t,"Yg",function(){return Cr}),n.d(t,"pc",function(){return Nr}),n.d(t,"oc",function(){return Rr}),n.d(t,"yh",function(){return Mr}),n.d(t,"sc",function(){return Ar}),n.d(t,"df",function(){return qr}),n.d(t,"Ne",function(){return Dr}),n.d(t,"Kb",function(){return Ir}),n.d(t,"Bd",function(){return _r}),n.d(t,"yb",function(){return Fr}),n.d(t,"od",function(){return Lr}),n.d(t,"uc",function(){return Br}),n.d(t,"bd",function(){return zr}),n.d(t,"Tg",function(){return Vr}),n.d(t,"vb",function(){return Hr}),n.d(t,"Tc",function(){return Ur}),n.d(t,"I",function(){return Jr}),n.d(t,"oh",function(){return Gr}),n.d(t,"ph",function(){return Wr}),n.d(t,"gf",function(){return Kr}),n.d(t,"Bf",function(){return Xr}),n.d(t,"ue",function(){return Qr}),n.d(t,"kc",function(){return Yr}),n.d(t,"ye",function(){return Zr}),n.d(t,"jg",function(){return $r}),n.d(t,"cf",function(){return ea}),n.d(t,"tf",function(){return ta}),n.d(t,"kb",function(){return na}),n.d(t,"jb",function(){return ra}),n.d(t,"xd",function(){return aa}),n.d(t,"Pe",function(){return ia}),n.d(t,"Bb",function(){return oa}),n.d(t,"fg",function(){return sa}),n.d(t,"Gh",function(){return ca}),n.d(t,"z",function(){return ua}),n.d(t,"ec",function(){return la}),n.d(t,"r",function(){return fa}),n.d(t,"ke",function(){return ha}),n.d(t,"fh",function(){return pa}),n.d(t,"Le",function(){return da}),n.d(t,"Rd",function(){return ma}),n.d(t,"Gf",function(){return va}),n.d(t,"M",function(){return ba}),n.d(t,"pg",function(){return ga}),n.d(t,"Ff",function(){return ya}),n.d(t,"lc",function(){return ka}),n.d(t,"wb",function(){return Oa}),n.d(t,"Gd",function(){return ja}),n.d(t,"Mb",function(){return wa}),n.d(t,"Fd",function(){return Ea}),n.d(t,"Fc",function(){return Sa}),n.d(t,"q",function(){return Pa}),n.d(t,"Dg",function(){return xa}),n.d(t,"sh",function(){return Ta}),n.d(t,"Kf",function(){return Ca}),n.d(t,"mg",function(){return Na}),n.d(t,"we",function(){return Ra}),n.d(t,"cd",function(){return Ma}),n.d(t,"Qd",function(){return Aa}),n.d(t,"Cb",function(){return qa}),n.d(t,"ng",function(){return Da}),n.d(t,"Eb",function(){return Ia}),n.d(t,"Yc",function(){return _a}),n.d(t,"Ed",function(){return Fa}),n.d(t,"Ie",function(){return La}),n.d(t,"ee",function(){return Ba}),n.d(t,"gd",function(){return za}),n.d(t,"Ld",function(){return Va}),n.d(t,"Kd",function(){return Ha}),n.d(t,"Jh",function(){return Ua}),n.d(t,"Sg",function(){return Ja}),n.d(t,"yc",function(){return Ga}),n.d(t,"ug",function(){return Wa}),n.d(t,"Oh",function(){return Ka}),n.d(t,"ve",function(){return Xa}),n.d(t,"Md",function(){return Qa}),n.d(t,"Ef",function(){return Ya}),n.d(t,"Df",function(){return Za}),n.d(t,"je",function(){return $a}),n.d(t,"Kh",function(){return ei}),n.d(t,"qe",function(){return ti}),n.d(t,"Hd",function(){return ni}),n.d(t,"Nb",function(){return ri}),n.d(t,"ff",function(){return ai}),n.d(t,"db",function(){return ii}),n.d(t,"mf",function(){return oi}),n.d(t,"gb",function(){return si}),n.d(t,"fb",function(){return ci}),n.d(t,"u",function(){return ui}),n.d(t,"qd",function(){return li}),n.d(t,"ah",function(){return fi}),n.d(t,"Yb",function(){return hi}),n.d(t,"eb",function(){return pi}),n.d(t,"g",function(){return di}),n.d(t,"lg",function(){return mi}),n.d(t,"zc",function(){return vi}),n.d(t,"rd",function(){return bi}),n.d(t,"td",function(){return gi}),n.d(t,"Ac",function(){return yi}),n.d(t,"Dd",function(){return ki}),n.d(t,"Nf",function(){return Oi}),n.d(t,"fe",function(){return ji}),n.d(t,"ge",function(){return wi}),n.d(t,"sd",function(){return Ei}),n.d(t,"Bc",function(){return Si}),n.d(t,"bi",function(){return Pi}),n.d(t,"Rh",function(){return xi}),n.d(t,"bb",function(){return Ti}),n.d(t,"Eh",function(){return Ci}),n.d(t,"Fh",function(){return Ni}),n.d(t,"uf",function(){return Ri}),n.d(t,"Oc",function(){return Mi}),n.d(t,"ai",function(){return Ai}),n.d(t,"xh",function(){return qi}),n.d(t,"jd",function(){return Di}),n.d(t,"xc",function(){return Ii}),n.d(t,"Ic",function(){return _i}),n.d(t,"rc",function(){return Fi}),n.d(t,"dd",function(){return Li}),n.d(t,"rg",function(){return Bi}),n.d(t,"Uf",function(){return zi}),n.d(t,"ag",function(){return Vi}),n.d(t,"cg",function(){return Hi}),n.d(t,"Bg",function(){return Ui}),n.d(t,"kg",function(){return Ji}),n.d(t,"Sf",function(){return Gi}),n.d(t,"hb",function(){return Wi}),n.d(t,"ib",function(){return Ki}),n.d(t,"vh",function(){return Xi}),n.d(t,"wh",function(){return Qi}),n.d(t,"uh",function(){return Yi}),n.d(t,"di",function(){return Zi}),n.d(t,"Vh",function(){return $i}),n.d(t,"If",function(){return eo}),n.d(t,"kd",function(){return to}),n.d(t,"wd",function(){return no}),n.d(t,"rh",function(){return ro}),n.d(t,"Rc",function(){return ao}),n.d(t,"Id",function(){return io}),n.d(t,"Pc",function(){return oo}),n.d(t,"Ad",function(){return so}),n.d(t,"kf",function(){return co}),n.d(t,"mc",function(){return uo}),n.d(t,"he",function(){return lo}),n.d(t,"ie",function(){return fo}),n.d(t,"tc",function(){return ho}),n.d(t,"Yh",function(){return po}),n.d(t,"b",function(){return mo}),n.d(t,"Oe",function(){return vo}),n.d(t,"Sb",function(){return bo}),n.d(t,"Qb",function(){return go}),n.d(t,"Rb",function(){return yo}),n.d(t,"Xc",function(){return ko}),n.d(t,"ud",function(){return Oo}),n.d(t,"Lb",function(){return jo}),n.d(t,"De",function(){return wo}),n.d(t,"Ue",function(){return Eo}),n.d(t,"We",function(){return So}),n.d(t,"Ve",function(){return Po}),n.d(t,"bg",function(){return xo}),n.d(t,"Uh",function(){return To}),n.d(t,"Ge",function(){return Co}),n.d(t,"se",function(){return No}),n.d(t,"rb",function(){return Ro}),n.d(t,"me",function(){return Mo}),n.d(t,"Xf",function(){return Ao}),n.d(t,"ne",function(){return qo}),n.d(t,"Yf",function(){return Do}),n.d(t,"oe",function(){return Io}),n.d(t,"Ob",function(){return _o}),n.d(t,"Lf",function(){return Fo}),n.d(t,"Sh",function(){return Lo}),n.d(t,"pe",function(){return Bo}),n.d(t,"Mf",function(){return zo}),n.d(t,"Kg",function(){return Vo}),n.d(t,"hg",function(){return Ho}),n.d(t,"ze",function(){return Uo}),n.d(t,"Zh",function(){return Jo}),n.d(t,"ci",function(){return Go}),n.d(t,"Th",function(){return Wo}),n.d(t,"zd",function(){return Ko}),n.d(t,"cc",function(){return Xo}),n.d(t,"Wh",function(){return Qo}),n.d(t,"Xh",function(){return Yo});var r=n(3),a=function(e){return{type:r.gf,payload:e}},i=function(e){return{type:r.lg,payload:e}},o=function(e){return{type:r.Ni,payload:e}},s=function(e){return{type:r.Wb,payload:e}},c=function(e){return{type:r.hg,payload:e}},u=function(e,t){return{type:r.Yd,payload:{id:e,numberOfPatterns:t}}},l=function(e,t){return{type:r.Lb,payload:{sequenceId:e,currentPattern:t}}},f=function(e,t){return{type:r.Jb,payload:{sequenceId:e,currentGlobalStep:t}}},h=function(e,t,n){return{type:r.Hb,payload:{sequenceId:e,currentStep:t,currentGlobalStep:n}}},p=function(e,t){return{type:r.if,payload:{sampleId:e,sample:t}}},d=function(e,t){return{type:r.oj,payload:{trackNumber:e,sliceNumber:t}}},m=function(e,t){return{type:r.pj,payload:{trackNumber:e,sliceNumber:t}}},v=function(e){return{type:r.pf,payload:e}},b=function(e){return{type:r.a,payload:e}},g=function(e){return{type:r.k,payload:e}},y=function(e){return{type:r.i,payload:e}},k=function(e){return{type:r.j,payload:e}},O=function(e){return{type:r.o,payload:e}},j=function(e){return{type:r.m,payload:e}},w=function(e){return{type:r.l,payload:e}},E=function(e){return{type:r.c,payload:e}},S=function(e,t){return{type:r.rj,payload:{id:e,recording:t}}},P=function(e,t,n,a,i,o,s,c,u){return{type:r.C,payload:{id:e,steps:t,pianoRollSteps:n,fills:a,stepToId:i,stepToPosition:o,pianoRollDurations:s,patternSteps:c,groups:u}}},x=function(e){return{type:r.eg,payload:e}},T=function(e){return{type:r.cg,payload:e}},C=function(e){return{type:r.Jf,payload:e}},N=function(e,t){return{type:r.vi,payload:{id:e,volume:t}}},R=function(e,t){return{type:r.ii,payload:{id:e,muted:t}}},M=function(e,t){return{type:r.qi,payload:{id:e,solo:t}}},A=function(e,t){return{type:r.Rc,payload:{groupNumber:e,volume:t}}},q=function(e){return{type:r.af,payload:e}},D=function(e){return{type:r.id,payload:e}},I=function(e){return{type:r.jd,payload:e}},_=function(e){return{type:r.kd,payload:e}},F=function(e,t){return{type:r.fd,payload:{sequenceId:e,isPlaying:t}}},L=function(e){return{type:r.gd,payload:e}},B=function(e,t){return{type:r.ig,payload:{sendNumber:e,muted:t}}},z=function(e){return{type:r.Ah,payload:e}},V=function(e){return{type:r.Eh,payload:e}},H=function(e){return{type:r.og,payload:e}},U=function(e){return{type:r.Cf,payload:e}},J=function(e,t){return{type:r.mc,payload:{id:e,value:t}}},G=function(e){return{type:r.kc,payload:e}},W=function(e){return{type:r.Rf,payload:e}},K=function(e){return{type:r.Sf,payload:e}},X=function(e,t,n,a){return{type:r.pi,payload:{subSequenceId:e,trackNumber:t,sendNumber:n,volume:a}}},Q=function(e){return{type:r.bi,payload:e}},Y=function(e){return{type:r.cd,payload:e}},Z=function(e){return{type:r.zh,payload:e}},$=function(e,t,n,a){return{type:r.Fe,payload:{stepNumber:e,transpose:t,numSteps:n,numNotes:a}}},ee=function(e){return{type:r.Tf,payload:e}},te=function(e){return{type:r.xh,payload:e}},ne=function(e,t){return{type:r.zd,payload:{id:e,loading:t}}},re=function(e){return{type:r.ec,payload:e}},ae=function(e){return{type:r.lf,payload:e}},ie=function(e){return{type:r.sd,payload:e}},oe=function(e,t,n){return{type:r.di,payload:{subSequenceId:e,trackNumber:t,isEnabled:n}}},se=function(e,t){return{type:r.Zf,payload:{sampleId:e,tag:t}}},ce=function(e){return{type:r.zi,payload:{transpose:e}}},ue=function(e,t){return{type:r.Ed,payload:{sequenceId:e,volume:t}}},le=function(e){return{type:r.Di,payload:e}},fe=function(e){return{type:r.Rb,payload:e}},he=function(e){return{type:r.Bi,payload:e}},pe=function(e){return{type:r.ye,payload:e}},de=function(e,t){return{type:r.xe,payload:{pattern:e,color:t}}},me=function(e){return{type:r.zb,payload:e}},ve=function(e){return{type:r.Kg,payload:e}},be=function(e){return{type:r.Dg,payload:e}},ge=function(e){return{type:r.Qh,payload:e}},ye=function(e){return{type:r.We,payload:e}},ke=function(){return{type:r.q,payload:{}}},Oe=function(e,t,n){return{type:r.wh,payload:{trackNumber:e,fromStep:t,toStep:n}}},je=function(e){return{type:r.Ch,payload:e}},we=function(e){return{type:r.qg,payload:{patternLocks:e}}},Ee=function(e,t){return{type:r.pg,payload:{patternNumber:e,locked:t}}},Se=function(e,t,n,a){return{type:r.ki,payload:{subSequence:e,trackNumber:t,patternNumber:n,locked:a}}},Pe=function(e,t,n){return{type:r.li,payload:{subSequence:e,trackNumber:t,patternLocks:n}}},xe=function(e,t){return{type:r.oc,payload:{id:e,patternLocks:t}}},Te=function(e){return{type:r.sj,payload:e}},Ce=function(e,t){return{type:r.wd,payload:{patternLocks:t,subSequence:e}}},Ne=function(e,t){return{type:r.sc,payload:{patternLocks:t,subSequence:e}}},Re=function(e,t){return{type:r.Ee,payload:{start:e,end:t}}},Me=function(e){return{type:r.ld,payload:e}},Ae=function(e){return{type:r.ef,payload:e}},qe=function(e){return{type:r.qd,payload:e}},De=function(e){return{type:r.me,payload:e}},Ie=function(e){return{type:r.ah,payload:e}},_e=function(e){return{type:r.Mg,payload:e}},Fe=function(e,t){return{type:r.Vd,payload:{id:e,value:t}}},Le=function(e){return{type:r.Zg,payload:e}},Be=function(e){return{type:r.Ug,payload:e}},ze=function(e){return{type:r.Jg,payload:e}},Ve=function(e){return{type:r.oi,payload:e}},He=function(e){return{type:r.nj,payload:e}},Ue=function(e){return{type:r.yd,payload:e}},Je=function(e){return{type:r.kb,payload:e}},Ge=function(e){return{type:r.ff,payload:e}},We=function(e){return{type:r.Zi,payload:e}},Ke=function(e){return{type:r.ab,payload:e}},Xe=function(e){return{type:r.Qi,payload:e}},Qe=function(e){return{type:r.Ri,payload:e}},Ye=function(e){return{type:r.Hd,payload:e}},Ze=function(e){return{type:r.re,payload:e}},$e=function(e,t){return{type:r.qe,payload:{parameter:e,midiControl:t}}},et=function(e){return{type:r.g,payload:e}},tt=function(e){return{type:r.x,payload:e}},nt=function(e,t){return{type:r.w,payload:{action:e,midiControl:t}}},rt=function(e){return{type:r.f,payload:e}},at=function(e){return{type:r.ud,payload:e}},it=function(e){return{type:r.uh,payload:e}},ot=function(e){return{type:r.wb,payload:e}},st=function(e){return{type:r.Cb,payload:e}},ct=function(e){return{type:r.Bb,payload:e}},ut=function(e){return{type:r.vb,payload:e}},lt=function(e){return{type:r.Oe,payload:e}},ft=function(e){return{type:r.hb,payload:e}},ht=function(e){return{type:r.Gd,payload:e}},pt=function(e,t){return{type:r.hh,payload:{trackNumber:e,show:t}}},dt=function(e){return{type:r.Qg,payload:e}},mt=function(e){return{type:r.we,payload:e}},vt=function(){return{type:r.n,payload:{}}},bt=function(e,t){return{type:r.lc,payload:{id:e,isCollapsed:t}}},gt=function(e,t){return{type:r.Db,payload:{element:e,arg:t}}},yt=function(e){return{type:r.Lf,payload:e}},kt=function(e){return{type:r.Df,payload:e}},Ot=function(e){return{type:r.nh,payload:e}},jt=function(e,t,n){return{type:r.Md,payload:{subSequenceId:e,type:t,events:n}}},wt=function(e,t){return{type:r.Pb,payload:{sequenceId:e,subSequenceId:t}}},Et=function(e,t){return{type:r.Gh,payload:{sequenceId:e,ids:t}}},St=function(e){return{type:r.B,payload:e}},Pt=function(e){return{type:r.A,payload:e}},xt=function(e){return{type:r.z,payload:e}},Tt=function(e){return{type:r.Pd,payload:e}},Ct=function(e,t){return{type:r.Hh,payload:{subSequenceId:e,value:t}}},Nt=function(e,t){return{type:r.qf,payload:{id:e,slices:t}}},Rt=function(e){return{type:r.Af,payload:e}},Mt=function(e){return{type:r.nc,payload:e}},At=function(e,t){return{type:r.ji,payload:{trackNumber:e,pan:t}}},qt=function(e){return{type:r.Yf,payload:e}},Dt=function(e){return{type:r.td,payload:e}},It=function(e){return{type:r.ph,payload:e}},_t=function(e){return{type:r.Hf,payload:e}},Ft=function(e){return{type:r.Vf,payload:e}},Lt=function(e){return{type:r.Sc,payload:e}},Bt=function(e){return{type:r.Ub,payload:e}},zt=function(e){return{type:r.Tb,payload:e}},Vt=function(e){return{type:r.Sb,payload:e}},Ht=function(e){return{type:r.Fc,payload:e}},Ut=function(e){return{type:r.Ue,payload:e}},Jt=function(e){return{type:r.nf,payload:e}},Gt=function(e,t,n){return{type:r.jc,payload:{subSequenceId:e,trackNumber:t,chainNumber:n}}},Wt=function(e,t){return{type:r.Ih,payload:{id:e,muted:t}}},Kt=function(e,t,n){return{type:r.ci,payload:{subSequenceId:e,trackNumber:t,frozen:n}}},Xt=function(e,t){return{type:r.ti,payload:{subSequenceId:e,trackNumber:t}}},Qt=function(e,t,n){return{type:r.Kc,payload:{subSequenceId:e,trackNumber:t,playing:n}}},Yt=function(e,t){return{type:r.ic,payload:{subSequenceId:e,effectsChains:t}}},Zt=function(e,t){return{type:r.Of,payload:{id:e,selectedOnsets:t}}},$t=function(e){return{type:r.sh,payload:e}},en=function(e){return{type:r.Bh,payload:e}},tn=function(e,t){return{type:r.dh,payload:{option:e,effect:t}}},nn=function(e){return{type:r.Dd,payload:e}},rn=function(e){return{type:r.oe,payload:e}},an=function(e){return{type:r.ce,payload:e}},on=function(e){return{type:r.Og,payload:e}},sn=function(e){return{type:r.Kf,payload:e}},cn=function(e){return{type:r.Be,payload:e}},un=function(e){return{type:r.De,payload:e}},ln=function(e,t){return{type:r.yh,payload:{stepNumber:e,stepData:t}}},fn=function(e){return{type:r.Lg,payload:e}},hn=function(e){return{type:r.qh,payload:e}},pn=function(e,t){return{type:r.Ci,payload:{userName:e,token:t}}},dn=function(e){return{type:r.ze,payload:e}},mn=function(e){return{type:r.xb,payload:e}},vn=function(e){return{type:r.yb,payload:e}},bn=function(e){return{type:r.Oi,payload:e}},gn=function(e,t,n){return{type:r.wi,payload:{subSequenceId:e,trackNumber:t,warp:n}}},yn=function(e,t){return{type:r.Jh,payload:{subSequenceId:e,warps:t}}},kn=function(e,t){return{type:r.X,payload:{start:e,end:t}}},On=function(e){return{type:r.Q,payload:e}},jn=function(e,t){return{type:r.H,payload:{subSequenceId:e,type:t}}},wn=function(e){return{type:r.N,payload:e}},En=function(e){return{type:r.W,payload:e}},Sn=function(e){return{type:r.O,payload:e}},Pn=function(e){return{type:r.V,payload:e}},xn=function(e){return{type:r.ag,payload:e}},Tn=function(e){return{type:r.bd,payload:e}},Cn=function(e,t,n){return{type:r.ei,payload:{subSequenceId:e,trackNumber:t,isLoading:n}}},Nn=function(e){return{type:r.Ae,payload:e}},Rn=function(e){return{type:r.Y,payload:e}},Mn=function(e){return{type:r.Nh,payload:e}},An=function(e){return{type:r.I,payload:e}},qn=function(e){return{type:r.J,payload:e}},Dn=function(e){return{type:r.K,payload:e}},In=function(e,t){return{type:r.R,payload:void 0===e?void 0:{patternDragging:e,offsetX:t}}},_n=function(e,t,n){return{type:r.U,payload:{subSequenceId:e,patternId:t,startStep:n}}},Fn=function(e){return{type:r.M,payload:e}},Ln=function(e,t){return{type:r.S,payload:void 0===e?void 0:{pattern:e,direction:t}}},Bn=function(e,t,n,a){return{type:r.pc,payload:{rackId:e,effectId:t,x:n,y:a}}},zn=function(e){return{type:r.G,payload:e}},Vn=function(e,t){return{type:r.Rh,payload:{trackId:e,device:t}}},Hn=function(e,t){return{type:r.Th,payload:{trackId:e,device:t}}},Un=function(e,t){return{type:r.Uh,payload:{trackId:e,subDevice:t}}},Jn=function(e,t){return{type:r.Sh,payload:{trackId:e,parameter:t}}},Gn=function(e){return{type:r.xg,payload:{show:e}}},Wn=function(e,t,n){return{type:r.pe,payload:{parameter:e,automations:t,scheduler:n}}},Kn=function(e){return{type:r.Rg,payload:e}},Xn=function(e,t){return{type:r.Xf,payload:{trackId:e,track:t}}},Qn=function(e){return{type:r.e,payload:e}},Yn=function(e){return{type:r.d,payload:e}},Zn=function(e,t){return{type:r.bb,payload:{id:e,guidePoint:t}}},$n=function(e,t){return{type:r.db,payload:{id:e,point:t}}},er=function(e,t){return{type:r.eb,payload:{id:e,hasMoved:t}}},tr=function(e,t){return{type:r.fb,payload:{id:e,pt:t}}},nr=function(e){return{type:r.si,payload:e}},rr=function(e,t){return{type:r.gb,payload:{id:e,selection:t}}},ar=function(e,t){return{type:r.cb,payload:{id:e,points:t}}},ir=function(e){return{type:r.Ac,payload:e}},or=function(e){return{type:r.vc,payload:e}},sr=function(e){return{type:r.Ui,payload:e}},cr=function(e,t){return{type:r.Vi,payload:{sequenceId:e,transpose:t}}},ur=function(e,t){return{type:r.Wi,payload:{sequenceId:e,volume:t}}},lr=function(e){return{type:r.yc,payload:e}},fr=function(e){return{type:r.dd,payload:e}},hr=function(e){return{type:r.ve,payload:e}},pr=function(e,t){return{type:r.Ld,payload:{id:e,value:t}}},dr=function(e){return{type:r.Nd,payload:e}},mr=function(e,t){return{type:r.vf,payload:{id:e,variables:t}}},vr=function(e){return{type:r.zc,payload:e}},br=function(e){return{type:r.Bc,payload:e}},gr=function(e){return{type:r.ue,payload:e}},yr=function(e,t){return{type:r.p,payload:{oldId:e,newId:t}}},kr=function(e,t){return{type:r.ng,payload:{sequenceId:e,progress:t}}},Or=function(e,t){return{type:r.Wh,payload:{trackId:e,samples:t}}},jr=function(e,t){return{type:r.Vh,payload:{trackId:e,presets:t}}},wr=function(e){return{type:r.jb,payload:e}},Er=function(e){return{type:r.ui,payload:e}},Sr=function(e){return{type:r.md,payload:e}},Pr=function(e){return{type:r.sf,payload:e}},xr=function(e){return{type:r.If,payload:e}},Tr=function(e){return{type:r.gi,payload:e}},Cr=function(e){return{type:r.fi,payload:e}},Nr=function(e){return{type:r.Hc,payload:e}},Rr=function(e,t,n){return{type:r.Gc,payload:{trackId:e,column:t,samples:n}}},Mr=function(e){return{type:r.Ai,payload:e}},Ar=function(e,t,n){return{type:r.Mc,payload:{subSequenceId:e,groupNumber:t,collapsed:n}}},qr=function(e,t,n,a,i){return{type:r.Nf,payload:{subSequenceId:e,trackNumber:t,groupNumber:n,effectType:a,effect:i}}},Dr=function(e){return{type:r.jf,payload:e}},Ir=function(e){return{type:r.Zb,payload:e}},_r=function(e){return{type:r.be,payload:e}},Fr=function(e,t,n){return{type:r.Ib,payload:void 0===e?void 0:{name:e,index:t,total:n}}},Lr=function(e){return{type:r.Od,payload:e}},Br=function(e,t){return{type:r.Qc,payload:{groupId:e,tracks:t}}},zr=function(e){return{type:r.Ad,payload:e}},Vr=function(e,t){return{type:r.Zh,payload:{id:e,envelopes:t}}},Hr=function(e){return{type:r.Eb,payload:e}},Ur=function(e){return{type:r.rd,payload:e}},Jr=function(e){return{type:r.P,payload:e}},Gr=function(e){return{type:r.Oh,payload:e}},Wr=function(e){return{type:r.Ph,payload:e}},Kr=function(e,t){return{type:r.Qf,payload:{trackId:e,palette:t}}},Xr=function(e,t){return{type:r.jg,payload:{trackId:e,palette:t}}},Qr=function(e){return{type:r.Xe,payload:e}},Yr=function(e){return{type:r.Cc,payload:e}},Zr=function(e){return{type:r.bf,payload:e}},$r=function(e,t){return{type:r.ih,payload:{id:e,show:t}}},ea=function(e){return{type:r.Mf,payload:e}},ta=function(e,t){return{type:r.fg,payload:{track:e,slice:t}}},na=function(e,t){return{type:r.ub,payload:{track:e,parameter:t}}},ra=function(e,t){return{type:r.tb,payload:{track:e,mode:t}}},aa=function(e){return{type:r.Xd,payload:e}},ia=function(e){return{type:r.uf,payload:e}},oa=function(e){return{type:r.Mb,payload:e}},sa=function(e){return{type:r.bh,payload:e}},ca=function(e){return{type:r.Pi,payload:e}},ua=function(e){return{type:r.E,payload:e}},la=function(e){return{type:r.uc,payload:e}},fa=function(e){return{type:r.u,payload:e}},ha=function(e){return{type:r.Ne,payload:e}},pa=function(e){return{type:r.ni,payload:e}},da=function(e){return{type:r.rf,payload:e}},ma=function(e,t,n){return{type:r.te,payload:{parameter:e,automations:t,scheduler:n}}},va=function(e,t){return{type:r.wg,payload:{subSequenceId:e,show:t}}},ba=function(e){return{type:r.T,payload:e}},ga=function(e){return{type:r.oh,payload:e}},ya=function(e){return{type:r.vg,payload:e}},ka=function(e){return{type:r.Dc,payload:e}},Oa=function(e){return{type:r.Gb,payload:e}},ja=function(e,t){return{type:r.ge,payload:{x:e,y:t}}},wa=function(e){return{type:r.bc,payload:e}},Ea=function(e){return{type:r.fe,payload:e}},Sa=function(e){return{type:r.ed,payload:e}},Pa=function(e){return{type:r.r,payload:e}},xa=function(e){return{type:r.vh,payload:e}},Ta=function(e){return{type:r.yi,payload:e}},Ca=function(e){return{type:r.Eg,payload:e}},Na=function(e){return{type:r.tg,payload:e}},Ra=function(e){return{type:r.Ze,payload:e}},Ma=function(e){return{type:r.Bd,payload:e}},Aa=function(e){return{type:r.se,payload:e}},qa=function(e){return{type:r.Nb,payload:e}},Da=function(e){return{type:r.ug,payload:e}},Ia=function(e){return{type:r.Qb,payload:e}},_a=function(e,t){return{type:r.xd,payload:e?{effect:e,name:t}:void 0}},Fa=function(e){return{type:r.ee,payload:e}},La=function(e){return{type:r.of,payload:e}},Ba=function(e){return{type:r.Ge,payload:e}},za=function(e){return{type:r.Fd,payload:e}},Va=function(e,t){return{type:r.he,payload:{id:e,pads:t}}},Ha=function(e,t){return{type:r.ne,payload:{id:e,slots:t}}},Ua=function(e){return{type:r.Si,payload:e}},Ja=function(e){return{type:r.Xh,payload:e}},Ga=function(e){return{type:r.Uc,payload:e}},Wa=function(e){return{type:r.th,payload:e}},Ka=function(e){return{type:r.Xi,payload:e}},Xa=function(e){return{type:r.Ye,payload:e}},Qa=function(e){return{type:r.ie,payload:e}},Ya=function(e,t){return{type:r.kg,payload:{id:e,sequencers:t}}},Za=function(e,t){return{type:r.mg,payload:{id:e,tracks:t}}},$a=function(e,t){return{type:r.Me,payload:{id:e,macros:t}}},ei=function(e,t){return{type:r.Ti,payload:{id:e,position:t}}},ti=function(e,t){return{type:r.Te,payload:{id:e,position:t}}},ni=function(e,t){return{type:r.je,payload:{id:e,effects:t}}},ri=function(e,t){return{type:r.cc,payload:{id:e,edge:t}}},ai=function(e){return{type:r.Pf,payload:e}},ii=function(e){return{type:r.lb,payload:e}},oi=function(e){return{type:r.Wf,payload:e}},si=function(e){return{type:r.pb,payload:e}},ci=function(e){return{type:r.ob,payload:e}},ui=function(e){return{type:r.y,payload:e}},li=function(e,t){return{type:r.Rd,payload:{id:e,collapsed:t}}},fi=function(e,t){return{type:r.hi,payload:{id:e,effects:t}}},hi=function(e,t){return{type:r.qc,payload:{id:e,starred:t}}},pi=function(e){return{type:r.mb,payload:e}},di=function(e){return{type:r.h,payload:e}},mi=function(e){return{type:r.sg,payload:e}},vi=function(e){return{type:r.Xc,payload:e}},bi=function(e,t){return{type:r.Sd,payload:{id:e,color:t}}},gi=function(e,t){return{type:r.Qd,payload:{inputModules:e,outputModules:t}}},yi=function(e){return{type:r.Yc,payload:e}},ki=function(e){return{type:r.de,payload:e}},Oi=function(e){return{type:r.Ig,payload:e}},ji=function(e,t){return{type:r.He,payload:{track:e,planar:t}}},wi=function(e,t){return{type:r.Ie,payload:{id:e,color:t}}},Ei=function(e,t){return{type:r.Td,payload:{id:e,size:t}}},Si=function(e,t){return{type:r.ad,payload:{id:e,connections:t}}},Pi=function(e,t){return{type:r.bj,payload:{id:e,objects:t}}},xi=function(e,t){return{type:r.aj,payload:{id:e,messages:t}}},Ti=function(e){return{type:r.ib,payload:e}},Ci=function(e){return{type:r.Ki,payload:e}},Ni=function(e){return{type:r.Li,payload:e}},Ri=function(e){return{type:r.gg,payload:e}},Mi=function(e,t){return{type:r.nd,payload:{id:e,grid:t}}},Ai=function(e){return{type:r.lj,payload:e}},qi=function(e){return{type:r.Gi,payload:e}},Di=function(e){return{type:r.Id,payload:e}},Ii=function(e){return{type:r.Tc,payload:e}},_i=function(e){return{type:r.hd,payload:e}},Fi=function(e){return{type:r.Lc,payload:e}},Li=function(e){return{type:r.Cd,payload:e}},Bi=function(e){return{type:r.mh,payload:e}},zi=function(e){return{type:r.Pg,payload:e}},Vi=function(e){return{type:r.Vg,payload:e}},Hi=function(e){return{type:r.Yg,payload:e}},Ui=function(e){return{type:r.Dh,payload:e}},Ji=function(e){return{type:r.jh,payload:e}},Gi=function(e){return{type:r.Ng,payload:e}},Wi=function(e,t){return{type:r.qb,payload:{id:e,segmentation:t}}},Ki=function(e){return{type:r.rb,payload:e}},Xi=function(e,t){return{type:r.Hi,payload:{id:e,lock:t}}},Qi=function(e){return{type:r.Ii,payload:e}},Yi=function(e,t){return{type:r.Ei,payload:{id:e,hide:t}}},Zi=function(e){return{type:r.mj,payload:e}},$i=function(e){return{type:r.gj,payload:e}},eo=function(e){return{type:r.Cg,payload:e}},to=function(e){return{type:r.Jd,payload:e}},no=function(e){return{type:r.Wd,payload:e}},ro=function(e){return{type:r.xi,payload:e}},ao=function(e){return{type:r.pd,payload:e}},io=function(e,t){return{type:r.ke,payload:{id:e,mode:t}}},oo=function(e){return{type:r.od,payload:e}},so=function(e,t){return{type:r.ae,payload:{id:e,styling:t}}},co=function(e,t){return{type:r.Uf,payload:{id:e,selected:t}}},uo=function(e,t){return{type:r.Ec,payload:{id:e,filtered:t}}},lo=function(e,t){return{type:r.Je,payload:{id:e,macro:t}}},fo=function(e,t){return{type:r.Le,payload:{id:e,isRegionMode:t}}},ho=function(e){return{type:r.Pc,payload:e}},po=function(e,t){return{type:r.jj,payload:{id:e,size:t}}},mo=function(){return{type:r.b,payload:{}}},vo=function(e){return{type:r.kf,payload:e}},bo=function(e,t){return{type:r.hc,payload:{x:e,y:t}}},go=function(e,t){return{type:r.fc,payload:{x:e,y:t}}},yo=function(e,t){return{type:r.gc,payload:{width:e,height:t}}},ko=function(e){return{type:r.vd,payload:e}},Oo=function(e){return{type:r.Ud,payload:e}},jo=function(e){return{type:r.ac,payload:e}},wo=function(e){return{type:r.hf,payload:e}},Eo=function(e){return{type:r.Ef,payload:e}},So=function(e){return{type:r.Gf,payload:e}},Po=function(e){return{type:r.Ff,payload:e}},xo=function(e){return{type:r.Xg,payload:e}},To=function(e,t){return{type:r.fj,payload:{id:e,timestamp:t}}},Co=function(e,t){return{type:r.mf,payload:{downloaded:e,total:t}}},No=function(e){return{type:r.Ve,payload:e}},Ro=function(e){return{type:r.Ab,payload:e}},Mo=function(e){return{type:r.Re,payload:e}},Ao=function(e){return{type:r.Sg,payload:e}},qo=function(e){return{type:r.Pe,payload:e}},Do=function(e){return{type:r.Tg,payload:e}},Io=function(e){return{type:r.Qe,payload:e}},_o=function(e){return{type:r.dc,payload:e}},Fo=function(e){return{type:r.Fg,payload:e}},Lo=function(e){return{type:r.dj,payload:e}},Bo=function(e){return{type:r.Se,payload:e}},zo=function(e){return{type:r.Gg,payload:e}},Vo=function(e){return{type:r.Lh,payload:e}},Ho=function(e){return{type:r.gh,payload:e}},Uo=function(e){return{type:r.cf,payload:e}},Jo=function(e,t,n){return{type:r.kj,payload:{id:e,position:t,text:n}}},Go=function(e){return{type:r.cj,payload:e}},Wo=function(e,t,n){return{type:r.ej,payload:{id:e,position:t,zobject:n}}},Ko=function(e){return{type:r.Zd,payload:e}},Xo=function(e){return{type:r.rc,payload:e}},Qo=function(e){return{type:r.hj,payload:e}},Yo=function(e){return{type:r.ij,payload:e}}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"m",function(){return c}),n.d(t,"n",function(){return u}),n.d(t,"j",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"a",function(){return h}),n.d(t,"e",function(){return p}),n.d(t,"i",function(){return d}),n.d(t,"g",function(){return m}),n.d(t,"l",function(){return v}),n.d(t,"k",function(){return b}),n.d(t,"h",function(){return g}),n.d(t,"f",function(){return y}),n.d(t,"J",function(){return k}),n.d(t,"w",function(){return O}),n.d(t,"Q",function(){return j}),n.d(t,"C",function(){return w}),n.d(t,"E",function(){return E}),n.d(t,"O",function(){return S}),n.d(t,"K",function(){return P}),n.d(t,"x",function(){return x}),n.d(t,"L",function(){return C}),n.d(t,"A",function(){return N}),n.d(t,"y",function(){return R}),n.d(t,"z",function(){return M}),n.d(t,"o",function(){return A}),n.d(t,"q",function(){return q}),n.d(t,"N",function(){return D}),n.d(t,"I",function(){return I}),n.d(t,"B",function(){return _}),n.d(t,"F",function(){return F}),n.d(t,"H",function(){return L}),n.d(t,"P",function(){return B}),n.d(t,"M",function(){return z}),n.d(t,"r",function(){return V}),n.d(t,"R",function(){return H}),n.d(t,"p",function(){return U}),n.d(t,"s",function(){return J}),n.d(t,"t",function(){return G}),n.d(t,"u",function(){return W}),n.d(t,"v",function(){return K}),n.d(t,"G",function(){return X}),n.d(t,"D",function(){return Q});var r=n(104),a=n(172),i=n(72),o="FILTER",s="COND",c="SWITCH_OUTPUT",u="TRIGGER",l="SET",f="GRAB",h="CHOKE",p="GRAB_TIME",d="SEQUENTIALLY",m="PARALLEL",v="SET_MODULATOR",b="SET_MACRO",g="PATTERN_SWITCH",y="ON";Object(i.a)("s",{"...args":"Arguments"},"Evaluates arguments sequentially");var k=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{axiom:d,sequence:t}};Object(i.a)("filter",{boolean:"True or false"},"Allows a trigger to pass, based on the argument passed");var O=function(e){return{axiom:o,value:e}},j=function(e){return{axiom:u,value:e}},w=function(e,t){return{axiom:y,value:{type:e,fn:t}}};Object(i.a)("patternSwitch",{patternNumber:"The pattern number to go to (zero indexed)"},"Switches the pattern of the track`'s sub-sequence");var E=function(e){return{axiom:g,value:e}};Object(i.a)("switchOutput",{outputNumber:"The output-number to send the trigger to (zero-indexed)"},"Midi Effects can have several outputs. This function lets you choose which one to send a trigger through.");var S=function(e){return{axiom:c,value:e}};Object(i.a)("set",{param:"The parameter name of a trigger to alter","...values":"The remaining arguments are values that are alternated. This param gets set with these values"},"Sets a trigger's parameter");var P=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{axiom:l,param:e,value:1!==n.length||Array.isArray(n[0])||"function"===typeof n[0]?a.a.apply(void 0,n):n[0]}},x=function(e){return function(t){return t[e]}},T=function(e,t,n,r){return{axiom:v,modType:e,number:t,param:n,value:r}},C=function(e,t){return{axiom:b,name:e,value:t}},N=function(e){if(!e)return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a="function"===typeof e?e.apply(void 0,n):e;return"object"===typeof a&&"SEQUENTIALLY"===a.axiom?a.sequence[0]:a};Object(i.a)("grab",{trackNumber:"The track number we wish to grab parameter values from (zero-indexed)",fromParam:"The parameter in the target track we wish to grab",toParam:"The parameter in the current track we wish to set with the grabbed value",add:"True/false whether we add the grabbed value to the current value"},"Grab trigger-parameter values from other tracks");var R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"transpose",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"transpose",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{axiom:f,trackNumber:N(e),toParam:N(n),fromParam:N(t),add:N(r)}};Object(i.a)("grabTime",{trackNumber:"The track number we wish to grab time values from (zero-indexed)"},"Grabs timing information from other tracks, if that track has any triggers occuring on this step.");var M=function(e){return{axiom:p,trackNumber:N(e)}};Object(i.a)("choke",{trackNumber:"The track-number we wish to choke"},"Prevents triggers from another track from occuring when this track triggers");var A=function(e){return{axiom:h,trackNumber:N(e)}};Object(i.a)("cond",{condition:"True/false whether we execute statement1 or statement2",statement1:"Triggered when the condition evalulates to true",statement2:"Triggered when the condition evalulates to false"},"Conditional control allows you to execute different functions depending on the condition");var q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O(!0);return{axiom:s,condition:e,statement1:t,statement2:n}},D=function(e,t){return function(n,r,a){return O(n&&r>=N(e)&&r<=N(t))}};Object(i.a)("rolling",{},"Filter only passing when the sequence is in roll-mode");var I=function(){return function(e,t,n,r){return O(r.isRolling())}},_=function(e,t){return function(n,r,a){return O(n&&n.transpose>=e()&&n.transpose<=t())}};Object(i.a)("prob",{probability:"Percentage value of how often a trigger is passed through"},"Generates a random value from 0-100 and lets triggers pass when they are below the probability argument");var F=function(e){return function(t,n,r){return O(Math.random()<=N(e)/100)}};Object(i.a)("reverse",{"...values":"Values to be alternated (true/false)"},"Sets the reverse parameter of the trigger. If a sample is played, it will play reversed");var L=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return P.apply(void 0,["reverse"].concat(t))};Object(i.a)("transpose",{"...values":"Values to be alternated"},"Sets the transpose of the trigger to the value passed (which are alternated every trigger)");var B=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return void 0===t||0===t.length?x("transpose"):P.apply(void 0,["transpose"].concat(t))};Object(i.a)("start",{"...values":"Values to be alternated"},"Sets the start percentage (of sample) of the trigger to the value passed (which are alternated every trigger)");var z=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return void 0===t||0===t.length?x("start"):P.apply(void 0,["start"].concat(t))};Object(i.a)("dur",{"...values":"Values to be alternated"},"Sets the duration of the trigger to the value passed (which are alternated every trigger)");var V=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return void 0===t||0===t.length?x("duration"):P.apply(void 0,["duration"].concat(t))};Object(i.a)("vel",{"...values":"Values to be alternated"},"Sets the velocity of the trigger to the value passed (which are alternated every trigger)");var H=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return void 0===t||0===t.length?x("velocity"):P.apply(void 0,["velocity"].concat(t))};Object(i.a)("chop",{"...values":"Values to be alternated"},"Sets the chop of the trigger to the value passed (which are alternated every trigger)");var U=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return void 0===t||0===t.length?x("chop"):P.apply(void 0,["chop"].concat(t))},J=function(e,t){return T(r.a,0,e,t)},G=function(e,t){return T(r.a,1,e,t)},W=function(e,t){return T(r.a,2,e,t)},K=function(e,t){return T(r.a,3,e,t)};Object(i.a)("randomSelect",{options:"Options to be randomly chosen from"},"Randomly selects an option from the arguemnts. randomSelect(0,1,2,3) will randomly return 0,1,2, or 3 with uniform probability");var X=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){return N(t[Math.floor(Math.random()*t.length)])}};Object(i.a)("knob",{name:"Name of the variable you wish to create"},"Create a variable that is controlled via a slider."),Object(i.a)("p",{"...args":"Arguments"},"Evaluates arguments in parallel");var Q=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{axiom:m,sequence:t}}},,function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(380),a=Object(r.a)()},,function(e,t,n){"use strict";var r=n(16),a=n(9),i=n(2),o=n(4),s=n(7),c=n(10),u=n(1),l=n(6),f=n(427),h=n(46),p=n(600),d=n(320),m=n(62),v=n(131),b=n(45),g=(n(601),n(235)),y=n(104),k=function(){function e(t,n,r,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y.b;Object(i.a)(this,e),this.parameter=t,this.modulator=n,this.scale=r,this.scales=a,this.type=o,void 0===this.scale&&void 0!==this.scales&&(this.scale=this.scales[0])}return Object(o.a)(e,[{key:"getJson",value:function(){return{modulator:this.modulator.number,min:this.scale.min,max:this.scale.max,type:this.type}}},{key:"min",get:function(){return this.scale.min},set:function(e){void 0!==e&&(void 0!==this.scales?this.scales.forEach(function(t){return t.min=e}):this.scale.min=e)}},{key:"max",get:function(){return this.scale.max},set:function(e){void 0!==e&&(void 0!==this.scales?this.scales.forEach(function(t){return t.max=e}):this.scale.max=e)}}]),e}(),O=(n(278),n(199)),j=n(15),w=n.n(j),E=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(i.a)(this,e),a=e.getDefaultConfig(a),this.config=a,this.hide=this.config.hide,this.isParameter=!0,this.isAlwaysLocked=a.isAlwaysLocked,this.toCache={},this.fromCache={},this.isDb=a.isDb,this.context=void 0,this.name=t,this.prettyName=a.prettyName||t,this.effectName=void 0,this.builder=a.builder,this.object=n,this.setter=r,this.min=a.min,this.useMeter=!1,this.max=a.max,this.constantAutomationRate=a.constantAutomationRate,this.units=a.units,this.unlockedValue=null,this.automatable=a.automatable,this.uxAutomatable=a.uxAutomatable,this.patternToValue={},this.paletteToValue={},this.id=Object(b.uuid)(),null!==a.defaultValue&&this.set(a.defaultValue,!0,!0),this.originalMin=this.min,this.originalMax=this.max,this.store=void 0,this.context=void 0,this.mixSession=void 0,this.lfos=[],this.envelopes=[],this.patternToAutomation={},this.unlockedAutomation=new d.a(this),this.mixAutomation=new d.a(this,!0),this.previousAutomation=this.unlockedAutomation,this.currentStep=void 0,this.keyScaling=void 0}return Object(o.a)(e,null,[{key:"getDefaultConfig",value:function(e){return void 0===e.min&&(e.min=0),void 0===e.max&&(e.max=1),void 0===e.max&&(e.units=""),void 0===e.defaultValue&&(e.defaultValue=0),void 0===e.automatable&&(e.automatable=!0),void 0===e.uxAutomatable&&(e.uxAutomatable=!0),void 0===e.constantAutomationRate&&(e.constantAutomationRate=!1),e}}]),e}();function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var P=function(e){return void 0===e};function x(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}function R(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var A=n(8);function q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var D=n(35);function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var F=n(193);function L(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}n.d(t,"a",function(){return B}),n.d(t,"b",function(){return z}),n.d(t,"c",function(){return V});w.a.Master.context;var B=function(e){Object(s.a)(n,e);var t=L(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"documentation",get:function(){if(this.config.documentation){var e=Array.isArray(this.config.documentation)?this.config.documentation:[this.config.documentation];return[].concat(Object(a.a)(e),["Click to view modulators for this parameter. Double click for automation"])}return"Click to view modulators for this parameter. Double click for automation"}},{key:"disposed",value:function(){return this._wasDisposed}},{key:"dispose",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(p.a.deleteParameter(this),!this.disposed()&&!this.config.doNotDispose){var t=this.sequencerEngine||window.sequencerEngine;for(var n in t&&t.idToParameter&&delete t.idToParameter[this.id],this.unmap(),this.disconnectFromAllModulators(),this.unlockedAutomation.dispose(),this.unlockedAutomation=void 0,this.patternToAutomation)this.patternToAutomation[n].dispose();this.patternToAutomation=void 0,this.patternToValue=void 0,e&&(this.audioParam&&this.audioParam.input&&this.audioParam.dispose(),this.audioParams&&this.audioParams.filter(function(e){return e.input}).forEach(function(e){return e.dispose()}),this._audioParams&&this._audioParams.filter(function(e){return e.input}).forEach(function(e){return e.dispose()})),this.context=void 0,this.audioParam=void 0,this.audioParams=void 0,this.object=void 0,this.id=void 0,this.name=void 0,this.prettyName=void 0,this.envelopes=void 0,this.lfos=void 0,this.unlockedValue=void 0,this.depthParameter&&(this.depthParameter.dispose(),this.depthParameter=void 0),this._wasDisposed=!0}}},{key:"state",get:function(){return this.store.getState()}},{key:"sequencerEngine",get:function(){return this.track?this.track.sequencerEngine:this.object&&this.object.track?this.object.track.sequencerEngine:this.context&&this.context.effect?this.context.effect.sequencerEngine:this.context&&this.context.track?this.context.track.sequencerEngine:this.context&&this.context.instrumentRack?this.context.instrumentRack.sequencerEngine:this.context&&this.context.instrument?this.context.instrument.sequencerEngine:this.context&&this.context.lfoTrack?this.context.lfoTrack.sequencerEngine:this.context&&this.context.envelopeTrack?this.context.envelopeTrack.sequencerEngine:this.context&&this.context.sequencerEngine?this.context.sequencerEngine:void 0}},{key:"isValidValue",value:function(e){return!isNaN(e)&&e>=this.min&&e<=this.max}},{key:"setContext",value:function(e){this.context=e,void 0!==this.context.track?(this.track=this.context.track,this.track.sequencerEngine&&(this.track.sequencerEngine.idToParameter[this.id]=this)):this.context.zObject?this.context.zObject.sequencerEngine&&(this.context.zObject.sequencerEngine.idToParameter[this.id]=this):this.context.lfoTrack?this.context.lfoTrack.sequencerEngine&&(this.context.lfoTrack.sequencerEngine.idToParameter[this.id]=this):this.context.envelopeTrack?this.context.envelopeTrack.sequencerEngine&&(this.context.envelopeTrack.sequencerEngine.idToParameter[this.id]=this):this.context.group?this.context.group.sequencerEngine&&(this.context.group.sequencerEngine.idToParameter[this.id]=this):this.context.send&&this.context.send.sequencerEngine&&(this.context.send.sequencerEngine.idToParameter[this.id]=this),this.context&&p.a.newParameter(this.name,this.config.tags||[],this)}},{key:"setStore",value:function(e){void 0!==e&&(this.store=e,this.unlockedAutomation.store=e,this.mixAutomation.store=e,this.automation.updateRedux());var t={};return t[this.id]=this.get(!0),t}},{key:"setMixSession",value:function(e){this.mixSession=e}},{key:"setTrack",value:function(e){this.track=e}},{key:"copyFrom",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.value=e.value:(this.disconnectFromAllModulators(),this.fromJson(e.getJson(),t),e.isMapped&&e.isMapped.replaceParameter(this),this.isMapped=e.isMapped,this.set(e.value,!0))}},{key:"mix",get:function(){return this.context&&this.context.subSequence?this.context.subSequence.mix:void 0}},{key:"getNumber",value:function(e,t,n){return this.get(e,t,n)}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.disposed())return 0;if((!e||n)&&this.shouldUseGetAtStep())return this.getAtStep(this.currentStep);if(this.isConnectedToAnyModulator(!1)&&!e){var r=this.getMeterValue(t);return(r=parseFloat(this.value)+parseFloat(r))>=this.max?this.max:r}return void 0===this.audioParam||void 0===this.meter?null===this.value?null:this.value:null===this.value||void 0===this.value||isNaN(this.value)?this.value:void 0}},{key:"trackStep",get:function(){return void 0===this.context||void 0===this.context.track?0:this.context.track.sequencerEngine.trackStep}},{key:"initDepth",value:function(){this.depthParameter=new n("depth",this,function(){},{min:0,max:1,defaultValue:this._depth||1,automationRate:v.a}),this.context&&this.depthParameter.setContext(this.context),this.depthParameter.setStore(this.store)}}]),n}(Object(F.a)(function(e){return function(e){Object(s.a)(n,e);var t=S(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"currentPattern",get:function(){return void 0===this.context?0:this.context.track&&void 0!==this.context.track.currentPattern?this.context.track.instrumentRack?this.context.track.instrumentRack.currentPattern:this.context.track.currentPattern:this.context.lfosTrack?this.context.lfosTrack.currentPattern:this.context.envelopesTrack?this.context.envelopesTrack.currentPattern:this.context.sequencerEngine?this.context.sequencerEngine.currentPattern:this.context.subSequence?this.store.getState().sequencer.currentPattern[this.context.subSequence.id]:void 0}},{key:"deletePattern",value:function(e){this.patternToValue=Object(O.a)(e,this.patternToValue)}},{key:"movePatternTo",value:function(e,t){this.patternToValue=Object(O.b)(e,t,this.patternToValue)}},{key:"newPattern",value:function(e,t){this.patternToValue[t]=this.patternToValue[e],this.patternToAutomation[e]?this.patternToAutomation[t]=this.patternToAutomation[e].getCopy(this.store):this.patternToAutomation[t]=this.automation.getCopy(this.store),this.patternToAutomation[t].updateRedux()}},{key:"isPatternLocked",value:function(){if(!this.automatable)return!1;if(this.isAlwaysLocked)return!0;if(void 0===this.context)return!1;var e=!1;this.context.track?(this.context.track.instrumentRack&&(e=this.context.track.instrumentRack.patternLocked),e=this.context.track.patternLocked):this.context.lfosTrack?e=this.context.lfosTrack.patternLocked:this.context.envelopesTrack?e=this.context.envelopesTrack.patternLocked:this.context.sequencerEngine&&(e=this.context.sequencerEngine.patternLocked);var t=this.context.subDevice||this.context.effect||this.context.midiEffect;return t&&t.locked||e}},{key:"deleteLocks",value:function(){this.currentPattern in this.patternToValue&&(this.unlockedValue=this.patternToValue[this.currentPattern]),this.patternToValue={},this.patternToValue[this.currentPattern]=this.unlockedValue}},{key:"hasPatternLockedValues",value:function(e,t){if(void 0===t)return Object.keys(this.patternToValue).length>0||Object.keys(this.patternToAutomation).length>0;if((P(this.patternToValue[t])?this.unlockedValue:this.patternToValue[t])!==(P(this.patternToValue[e])?this.unlockedValue:this.patternToValue[e]))return!0;this.automation;var n=this.patternToAutomation[t]||this.unlockedAutomation,r=this.patternToAutomation[e]||this.unlockedAutomation;return n!==r&&(r.length>0||n.length>0)}}]),n}(e)},function(e){return function(e){Object(s.a)(n,e);var t=_(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).stepToValue={},e}return Object(o.a)(n,[{key:"deletePLockForStep",value:function(e){var t=this;delete this.stepToValue[e.id],e.pLockedParameters=e.pLockedParameters.filter(function(e){return e!==t})}},{key:"setPLockedValue",value:function(e){var t=this;this.selectedSteps.forEach(function(n){n.pLockedParameters.includes(t)||n.pLockedParameters.push(t),t.stepToValue[n.id]=e})}},{key:"setForPLockedStep",value:function(e,t){if(e.id in this.stepToValue){void 0===this.savedUnlockedValue&&(this.savedUnlockedValue=this.unlockedValue),this.set(this.stepToValue[e.id],!0,!0,t);var n={};return n[this.id]=this.stepToValue[e.id],n}return{}}},{key:"isCommandDown",get:function(){return this.state.keyboard.isCommandDown}},{key:"hasStepsSelected",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.store)return!1;var n=this.store.getState().keyboard.selectedPianoRollSteps,r=this.context&&this.context.track,a=this.context&&this.context.lfoTrack,i=this.context&&this.context.envelopeTrack,o=this.context&&this.context.send;if(!n||0===n.length)return!1;if(t&&!this.isCommandDown)return!!n.some(function(t){return t.id in e.stepToValue});var s=!1;return a||i||o?s=!0:r&&(s=n.every(function(e){return e&&e.track===r})),s}},{key:"selectedSteps",get:function(){return this.store.getState().keyboard.selectedPianoRollSteps}}]),n}(e)},function(e){return function(e){Object(s.a)(n,e);var t=C(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"onNewStep",value:function(e){this.currentStep=e;var t=this.store&&this.store.getState();t&&t.automation.parameterSliderDown.indexOf(this)>-1&&(t.mix.isRecordingMix?this.mixAutomation.removeAtStep(this.currentStep):t.sequencer.isRecording&&this.automation.removeAtStep(this.currentStep))}},{key:"automation",get:function(){return this.isPatternLocked()?(void 0===this.patternToAutomation[this.currentPattern]&&(this.patternToAutomation[this.currentPattern]=this.previousAutomation.getCopy(this.store),this.patternToAutomation[this.currentPattern].updateRedux()),this.previousAutomation=this.patternToAutomation[this.currentPattern],this.previousAutomation):(this.previousAutomation=this.unlockedAutomation,this.unlockedAutomation)}},{key:"automations",get:function(){return this.automation?this.automation.automations:[]}},{key:"isRecording",get:function(){if(!this.store)return!1;var e=this.store.getState();return e.sequencer.isRecording&&Object.values(e.sequencer.isPlaying).some(function(e){return e})&&this.automatable}},{key:"isRecordingMix",get:function(){if(!this.store)return!1;var e=this.store.getState();return e.mix.isRecordingMix&&Object.values(e.sequencer.isPlaying).some(function(e){return e})&&this.automatable}},{key:"isPlayingMix",get:function(){return!!this.store&&this.store.getState().mix.isPlayingMix&&this.automatable}},{key:"getAtStep",value:function(e){if(this.hasMacro){var t=this.hasMacro.macroParameter.getAtStep(e);return this.hasMacro.normalizeParameterValue(this,t)}if(this.isPlayingMix&&this.mixAutomation.automations.length>0){if(!this.mixAutomation.hasEventsAfterStep(e)&&this.isPatternLocked())return this.get(!0);var n=this.mixAutomation.getValueAtStep(e);return this.isConnectedToAnyModulator()?n+this.get(!0):n}if(this.automations&&this.automations.length>0){var r=this.automation.getValueAtStep(e);return this.isConnectedToAnyModulator()?r+this.get(!0):r}return this.get()}},{key:"shouldUseGetAtStep",value:function(){if(this.store&&this.store.getState().automation.parameterSliderDown.indexOf(this)>-1)return!1;var e=this.automations,t=void 0;if(this.store){var n=this.isPlayingMix;e=n?[].concat(Object(a.a)(this.mixAutomation.automations),Object(a.a)(this.automations)):this.automations,this.hasMacro&&(t=n?[].concat(Object(a.a)(this.hasMacro.macroParameter.automations),Object(a.a)(this.hasMacro.macroParameter.mixAutomation.automations)):this.hasMacro.macroParameter.automations)}return e.length>0||this.hasMacro&&(t.length>0||this.hasMacro.macroParameter.isConnectedToAnyModulator())}},{key:"deleteAutomations",value:function(){this.automation.deleteAutomations(),this.patternToAutomation={}}},{key:"automatedValue",set:function(e){this.isPaletteLocked()?this.paletteToValue[this.getCurrentPalette()]=e:this.isPatternLocked()?this.patternToValue[this.currentPattern]=e:this.unlockedValue=e}},{key:"automationRate",get:function(){return this.audioParams?this.audioParams[0]&&this.audioParams[0].input&&this.audioParams[0].input.automationRate:this.audioParam&&this.audioParam.input&&this.audioParam.input.automationRate},set:function(e){if(e=this.config.automationRate||e,this.audioParam&&this.audioParam.input&&(this.constantAutomationRate||(this.audioParam.input.automationRate=e)),this.audioParams){var t,n=x(this.audioParams);try{for(n.s();!(t=n.n()).done;){var r=t.value;r&&r.input&&(this.constantAutomationRate||(r.input.automationRate=e))}}catch(a){n.e(a)}finally{n.f()}}}},{key:"hasAnyAutomation",value:function(){for(var e in this.patternToAutomation)if(this.patternToAutomation[e].automations.length>0)return!0;return this.automations&&this.automations.length>0}}]),n}(e)},function(e){return function(e){Object(s.a)(n,e);var t=N(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getPaletteValue",value:function(e){if(void 0===e||null===e)return this.unlockedValue;var t=this.paletteToValue[e];return void 0===t?this.unlockedValue:t}},{key:"isPaletteLocked",value:function(e){return void 0!==this.getCurrentPalette(e)}},{key:"getCurrentPalette",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.store&&this.context&&this.context.track&&this.automatable)return e?this.store.getState().effects.selectedPalettes[this.context.track.id]:this.store.getState().effects.sequencedPalettes[this.context.track.id]}}]),n}(e)},function(e){return function(e){Object(s.a)(n,e);var t=R(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"callSetter",value:function(){var e=this.get();this.setter(this.object,e)}},{key:"set",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.04,o=arguments.length>5?arguments[5]:void 0;if(this.immutable)return{};this.builder&&(e=this.builder(e));var s=this.value;if(n&&!o?this.automatedValue=e:this.value=e,a&&(this.audioParam||this.audioParams)&&!isNaN(e)){var c=this.audioParams?this.audioParams:[this.audioParam],u=e;"macro"===this.name||"BPM"===this.name||"send volume"===this.name?"BPM"===this.name?this.sequencerEngine.onNewBpm(u):this.audioParam.setValueAtTime(u,a):c.every(function(e){return e.linearRampTo})?c.forEach(function(e){return e.linearRampTo(u,i,a)}):c.forEach(function(e){return e.linearRampToValueAtTime?e.linearRampToValueAtTime(u,a+i):0})}else if(a){var f=a-w.a.Master.context.now();w.a.Master.context.setTimeout(function(){t.setter(t.object,e,n,a)},f)}else this.setter(this.object,e,n,a);if(void 0!==this.store&&(this.track&&this.track.preset&&this.isLoaded&&(this.track.preset.hasEdits=!0),r||this.store.dispatch(Object(l.Ub)(this.id,this.value)),!n&&(this.isRecording||this.isRecordingMix))){var p=this.isRecordingMix?this.mixAutomation:this.automation;this.sequencerEngine?this.sequencerEngine.operationManager.dispatch(Object(h.n)(this,p,this.value,s)):p.record(this.value,s)}return this.isMapped&&!n&&this.isMapped.clearParameter(this),this.config.onChange&&this.config.onChange(e),{id:this.id,value:this.value}}},{key:"value",get:function(){var e=this;if(this.hasStepsSelected(!1)&&Object.keys(this.stepToValue).length>0){var t=this.selectedSteps.find(function(t){return t.id in e.stepToValue});if(t)return this.stepToValue[t.id]}if(this.isPaletteLocked())return this.getPaletteValue(this.getCurrentPalette());if(this.isPatternLocked()){var n=this.currentPattern;if(void 0===n)return;var r=this.patternToValue[n];return void 0===r?this.unlockedValue:r}return this.unlockedValue},set:function(e){this.isPaletteLocked(!0)?this.paletteToValue[this.getCurrentPalette(!0)]=e:this.hasStepsSelected()?this.setPLockedValue(e):this.isPatternLocked()?this.patternToValue[this.currentPattern]=e:this.unlockedValue=e}},{key:"normalizedSet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;this.set(this.normalize(e),t,n,r)}},{key:"normalizeOriginal",value:function(e){return this.originalMin+(this.originalMax-this.originalMin)*e}},{key:"normalize",value:function(e){return this.min+(this.max-this.min)*e}},{key:"updateRedux",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;for(var n in this.patternToAutomation)this.patternToAutomation[n].clear();if(this.unlockedAutomation&&this.unlockedAutomation.clear(),this.automation&&(this.automation.clear(),this.automation.store=this.store,this.automation.updateRedux()),this.mixAutomation&&(this.mixAutomation.store=this.store),null!==this.value&&void 0!==this.value)return this.set(this.value,!0,e,t)}},{key:"refresh",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=this.get(e);if(null!==a&&void 0!==a)return this.set(this.get(e),!0,t,n,void 0,r)}}]),n}(e)},function(e){return function(e){Object(s.a)(n,e);var t=M(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a)))._depth=1,e}return Object(o.a)(n,[{key:"connectToLFO",value:function(e){var t=this,n=!1;if(this.depthParameter||(this.initDepth(),n=!0),!this.isConnectedToLFO(e))return this.lfos=[].concat(Object(a.a)(this.lfos),[e]),this.audioParams?(this.audioParams.forEach(function(n,r){return e.connect(n,t,r)}),this.connectToDepth(e,void 0,n),new k(this,e,void 0,this.audioParams.map(function(n,r){return e.getScaleForParameter(t,r)}))):(this.automationRate=v.a,e.connect(this.audioParam,this,0),this.connectToDepth(e,void 0,n),new k(this,e,e.getScaleForParameter(this),void 0,y.b))}},{key:"connectToEnvelope",value:function(e){var t=this;if(e){var n=!1;if(this.depthParameter||(this.initDepth(),n=!0),!this.isConnectedToEnvelope(e))return this.envelopes=[].concat(Object(a.a)(this.envelopes),[e]),this.audioParams?(this.audioParams.forEach(function(n,r){return e.connect(n,t,r)}),this.connectToDepth(void 0,e,n),new k(this,e,void 0,this.audioParams.map(function(n,r){return e.getScaleForParameter(t,r)}),y.a)):(this.automationRate=v.a,e.connect(this.audioParam,this,0),this.connectToDepth(void 0,e,n),new k(this,e,e.getScaleForParameter(this),void 0,y.a))}}},{key:"enableKeyScaling",value:function(){this.keyScaling=new f.a(this)}},{key:"depth",get:function(){return this.depthParameter?this.depthParameter.get():this._depth},set:function(e){this._depth=e,this.depthParameter&&this.depthParameter.set(e,!1,!0)}},{key:"connectToDepth",value:function(e,t,n){if(this.depthParameter.audioParam){var r=e||t;if(r){var a=r.getDepthForParameter(this);if(!n){var i=this.depth;isNaN(i)||(this.depthParameter.audioParam.value=i)}this.depthParameter.audioParam.connect(a.gain)}}}},{key:"disconnectFromDepth",value:function(e,t){if(this.depthParameter.audioParam){var n=e||t;if(n){var r=n.getDepthForParameter(this);r&&this.depthParameter.audioParam.disconnect(r.gain)}}}},{key:"disconnectFromLFO",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.lfos.indexOf(e);i<0||(this.useMeter?this.useMeter=!1:this.audioParams?(r&&this.disconnectFromDepth(e),this.audioParams.forEach(function(n,r){return e.disconnect(n,t,r)})):this.audioParam&&(r&&this.disconnectFromDepth(e),e.disconnect(this.audioParam,this,0)),this.lfos.splice(i,1),this.lfos=Object(a.a)(this.lfos),0===this.lfos.length&&n&&(this.audioParam,this.meter,this.audioParam=void 0,this.meter=void 0),this.cleanDepthIfNecessary())}},{key:"disconnectFromEnvelope",value:function(e){var t=this,n=(!(arguments.length>1&&void 0!==arguments[1])||arguments[1],!(arguments.length>2&&void 0!==arguments[2])||arguments[2]),r=this.envelopes.indexOf(e);r<0||(this.useMeter?this.useMeter=!1:this.audioParams?(n&&this.disconnectFromDepth(void 0,e),this.audioParams.forEach(function(n,r){return e.disconnect(n,t,r)})):(n&&this.disconnectFromDepth(void 0,e),this.automationRate=v.a,e.disconnect(this.audioParam,this,0)),this.envelopes.splice(r,1),this.envelopes=Object(a.a)(this.envelopes),this.cleanDepthIfNecessary())}},{key:"disableKeyScaling",value:function(){this.keyScaling=void 0,this.set(this.get(!0),!0,!0)}},{key:"disconnectFromAllModulators",value:function(){var e=Object(a.a)(this.lfos);for(var t in e)this.disconnectFromLFO(e[t],!1,!1);var n=Object(a.a)(this.envelopes);for(var r in n)this.disconnectFromEnvelope(n[r],void 0,!1);this.lfos=[],this.envelopes=[],this.keyScaling&&this.disableKeyScaling()}},{key:"getParameterMod",value:function(e,t){var n=this,r=e||t;return this.audioParams?new k(this,r,void 0,this.audioParams.map(function(e,t){return r.getScaleForParameter(n,t)}),e?y.b:y.a):new k(this,r,r.getScaleForParameter(this),void 0,e?y.b:y.a)}},{key:"parameterMods",get:function(){var e=this;if(void 0!==this.audioParams){var t=this.lfos.map(function(t){return new k(e,t,void 0,e.audioParams.map(function(n,r){return t.getScaleForParameter(e,r)}))}),n=this.envelopes.map(function(t){return new k(e,t,void 0,e.audioParams.map(function(n,r){return t.getScaleForParameter(e,r)}),y.a)});return t.concat(n).filter(function(e){return void 0!==e.scale})}var r=this.lfos.map(function(t){return new k(e,t,t.getScaleForParameter(e),void 0,y.b)}),a=this.envelopes.map(function(t){return new k(e,t,t.getScaleForParameter(e),void 0,y.a)});return r.concat(a).filter(function(e){return void 0!==e.scale})}},{key:"getConnectableParam",value:function(){return this.audioParam}},{key:"isAudioParamEnabled",value:function(){return void 0!==this.audioParam||void 0!==this.audioParams}},{key:"isConnectedToAnyModulator",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.isConnectedToAnyLFO()||this.isConnectedToAnyEnvelope()||e&&this.keyScaling}},{key:"isConnectedToAnyLFO",value:function(){return this.lfos&&this.lfos.length>0}},{key:"isConnectedToLFO",value:function(e){return this.lfos&&this.lfos.includes(e)}},{key:"isConnectedToAnyEnvelope",value:function(){return this.envelopes&&this.envelopes.length>0}},{key:"isConnectedToEnvelope",value:function(e){return this.envelopes&&this.envelopes.includes(e)}},{key:"enableAudioParam",value:function(){this.audioParam||this.audioParams||(this.useMeter=!0)}},{key:"setAudioParam",value:function(e){this.audioParam=e,this.automationRate=v.a,this.useMeter=!1}},{key:"setAudioParams",value:function(e){this.audioParams=e,this.automationRate=v.a,this.useMeter=!1}},{key:"loadModsFromJson",value:function(e){if(void 0!==e.mods)for(var t in e.mods){var n=e.mods[t],r=n.modulator||n.lfo,a=n.type||y.b,i=this.parameterMods;for(var o in i){var s=i[o];if(s.modulator.number===r&&s.type===a){var c=s.scales||[s.scale];w.a.Master.context.isOffline||c.forEach(function(e){return e.rampTime=1}),s.min=parseFloat(n.min),s.max=parseFloat(n.max),w.a.Master.context.isOffline||c.forEach(function(e){return e.rampTime=.001});break}}}}},{key:"getMeterValue",value:function(e){var t=0;for(var n in this.lfos){var r=this.lfos[n].getScaleForParameter(this);if(void 0!==r&&!(e>=8)){var a=this.depthParameter?this.depthParameter.get():this.depth,i=this.lfos[n].getValue(e)*a,o=r.max,s=r.min,c=(o-s)*(i+100)/200+s;r.max,r.min,r.min,t+=c}}for(var u in this.envelopes){var l=this.depthParameter?this.depthParameter.get():this.depth,f=this.envelopes[u].getScaleForParameter(this);if(f){var h=this.envelopes[u].getValue(this.trackStep)*l,p=f.max,d=f.min;t+=(p-d)*h/1+d}}return t}},{key:"getKeyScaledValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(e- -32)/92;return void 0===this.keyScaling||void 0===e?this.get(t):this.get(t)+this.keyScaling.min+(this.keyScaling.max-this.keyScaling.min)*n}},{key:"cleanDepthIfNecessary",value:function(){!this.isConnectedToAnyModulator()&&this.depthSignal&&(this.depthSignal.value=0,this.depthSignal.disconnect(),this.depthParameter.dispose(!0),this.depthParameter=void 0,this.depthSignal=void 0)}},{key:"resetMinMax",value:function(){this.min=this.originalMin,this.max=this.originalMax}},{key:"availableLFOs",get:function(){var e;if(this.track&&this.track.subSequence)e=this.context&&!this.context.subDevice&&this.context.effect?this.config.useInstrumentModulators&&this.track.subSequence.lfosTrack?this.track.subSequence.lfosTrack:this.sequencerEngine:this.track.lfosTrack?this.track.lfosTrack:this.track.subSequence.lfosTrack;else if(this.context&&!this.context.subDevice&&this.context.effect)e=this.config.useInstrumentModulators&&this.context.effect.subSequence.lfosTrack?this.context.effect.subSequence.lfosTrack:this.context.track?this.context.track.lfosTrack:this.sequencerEngine;else if(this.context&&this.context.lfosTrack)e=this.context.lfosTrack;else if(this.context&&this.context.track){var t=this.context.track;t.lfosTrack?e=t.lfosTrack:t.subSequence&&(e=t.subSequence.lfosTrack)}else if(this.context&&this.context.subSequence)e=this.context.subSequence.lfosTrack;else{if(!this.sequencerEngine)return[];e=this.sequencerEngine}return e&&e.lfos?e.lfos.map(function(e){return e.lfo}):[]}},{key:"availableEnvelopes",get:function(){var e;if(this.track&&this.track.subSequence)e=this.context&&!this.context.subDevice&&this.context.effect?this.track.subSequence.envelopesTrack:this.track.envelopesTrack?this.track.envelopesTrack:this.track.subSequence.envelopesTrack;else if(this.context&&this.context.lfosTrack&&this.context.lfosTrack.context&&this.context.lfosTrack.context.track)e=this.context.lfosTrack.context.track.envelopesTrack;else if(this.context&&!this.context.subDevice&&this.context.effect)e=this.sequencerEngine.currentSubSequence.envelopesTrack;else if(this.context&&this.context.track){var t=this.context.track;t.envelopesTrack?e=t.envelopesTrack:t.subSequence&&(e=t.subSequence.envelopesTrack)}else this.context&&this.context.envelopesTrack?e=this.context.envelopesTrack:this.context&&this.context.subSequence?e=this.context.subSequence.envelopesTrack:this.context&&this.context._subSequence?e=this.context._subSequence.envelopesTrack:this.sequencerEngine&&(e=this.sequencerEngine.currentSubSequence.envelopesTrack);return e&&e.envelopes?e.envelopes.map(function(e){return e.envelope}):[]}}]),n}(e)},function(e){return function(e){Object(s.a)(n,e);var t=q(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"fromJson",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.id;if(void 0!==e){var i={};e.id&&!r&&(this.id=e.id,this.sequencerEngine&&(this.sequencerEngine.idToParameter[this.id]=this));var o=void 0!==t?t.currentSubSequence||t.subSequences[0]:void 0;if(void 0!==e.lfo)this.enableAudioParam(),this.connectToLFO(t.lfos[0].lfo);else if(o&&void 0!==e.lfos&&e.lfos.length>0)for(var s in this.enableAudioParam(),e.lfos){var c=e.lfos[s];this.lfos.includes(c)&&c.replaceParameterIds(a,this.id,this),this.connectToLFO(o.lfos[c].lfo)}if(o&&void 0!==e.envelopes&&e.envelopes.length>0&&(this.enableAudioParam(),e.envelopes.forEach(function(e){var t=o.envelopes[e];n.envelopes.includes(t)?t.replaceParameterIds(a,n.id,n):n.connectToEnvelope(t)})),void 0!==e.value&&(i=this.set(e.value,!0,!0)),this.unlockedValue=void 0!==e.unlockedValue?this.convertValue(e.unlockedValue):this.value,void 0!==e.patternToValue&&(this.patternToValue=Object(g.a)(e.patternToValue)),this.isPatternLocked()&&void 0!==this.patternToValue[0]?i=this.set(this.patternToValue[0],!0,!0):void 0!==this.unlockedValue&&(i=this.set(this.unlockedValue,!0,!0)),void 0!==e.paletteToValue&&(this.paletteToValue=Object(g.a)(e.paletteToValue)),e.patternToAutomation){for(var u in e.patternToAutomation)this.patternToAutomation[u]=new d.a(this),this.patternToAutomation[u].fromJson(e.patternToAutomation[u],!1);this.unlockedAutomation.fromJson(e.unlockedAutomation,!1),this.isPatternLocked()&&this.patternToAutomation[0]?this.patternToAutomation[0].schedule():this.automation.schedule()}e.mixAutomation&&this.mixAutomation.fromJson(e.mixAutomation,!1),e.keyScaling&&(this.keyScaling=new f.a(this,e.keyScaling.min,e.keyScaling.max)),void 0!==e.depth?(this.depthParameter||this.initDepth(),this.depthParameter.fromJson(e.depth,t,r)):void 0!==e._depth&&(this._depth=e._depth),this.loadModsFromJson(e);var l={};return void 0===i?l:(l[i.id]=i.value,void 0!==e.min&&(this.min=e.min),void 0!==e.max&&(this.max=e.max),e.stepToValue&&(this.stepToValue=e.stepToValue),e.hide&&(this.hide=e.hide),l)}}},{key:"convertValue",value:function(e){return Object(g.b)(e)}},{key:"getPresetValue",value:function(){return this.currentPattern in this.patternToValue?this.patternToValue[this.currentPattern]:this.unlockedValue}},{key:"getJson",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.parameterMods,n=void(void 0===this.context||this.context.subSequence);if(this.hasAnyAutomation())for(var r in n={},this.patternToAutomation)n[r]=this.patternToAutomation[r].getJson();var a=void 0;this.unlockedAutomation.automations.length>0&&(a=this.unlockedAutomation.getJson());var i=void 0;this.mixAutomation.automations.length>0&&(i=this.mixAutomation.getJson());var o=void 0;!e&&Object.keys(this.patternToValue).length>0&&(o=this.patternToValue);var s=void 0;return Object.keys(this.stepToValue).length>0&&(s=Object(A.a)({},this.stepToValue)),{id:this.id,patternToAutomation:n,unlockedAutomation:a,mixAutomation:i,min:this.min!==this.originalMin?this.min:void 0,max:this.max!==this.originalMax?this.max:void 0,unlockedValue:e?this.getPresetValue():this.unlockedValue,patternToValue:o,mods:t.length>0?t.map(function(e){return e.getJson()}):void 0,lfos:this.lfos.length>0?this.lfos.map(function(e){return e.number-1}):void 0,envelopes:this.envelopes.length>0?this.envelopes.map(function(e){return e.number-1}):void 0,keyScaling:this.keyScaling?this.keyScaling.getJson():void 0,depth:this.depthParameter&&this.depthParameter.getJson(e),_depth:1===this._depth?void 0:this._depth,stepToValue:s,hide:this.hide}}}]),n}(e)},function(e){return function(e){Object(s.a)(n,e);var t=I(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getCoordinates",value:function(){var e=this.toSeconds?this.toSeconds(!0):this.getNumber(!0),t=this.depth,n=this.depthParameter?this.depthParameter.min:0;t=(t-n)/((this.depthParameter?this.depthParameter.max:1)-n),e=(e-this.min)/(this.max-this.min);var r=D.b+D.c*Math.pow(Math.max(0,e),1),a=D.a-D.a*Math.pow(Math.max(0,t),1)-D.b;return{x:Math.min(D.c-D.b,r),y:Math.max(D.b,a)}}},{key:"fromCoordinates",value:function(e,t){Math.max(0,(D.a-(t+D.b))/D.a);var n=this.depthParameter?this.depthParameter.min:0,r=n+((this.depthParameter?this.depthParameter.max:1)-n)*Math.pow(Math.max(0,(D.a-t)/D.a),1);return{value:this.min+(this.max-this.min)*Math.pow(e/D.c,1),depth:r}}},{key:"setCoordinates",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=(Math.max(0,(D.a-(t+D.b))/D.a),this.depthParameter?this.depthParameter.min:0),o=i+((this.depthParameter?this.depthParameter.max:1)-i)*Math.pow(Math.max(0,(D.a-(t+D.b))/D.a),1);if(o<0||o>1)return{id:-1,value:-1};var s=this.min+(this.max-this.min)*Math.pow((e-D.b)/D.c,1);return s>=this.max||s<=this.min?{value:-1,id:-1}:isNaN(s)||isNaN(o)?{id:-1,value:-1}:(this._depth=o,this.depthParameter&&this.depthParameter.set(o,a,!0,n,r),this.set(s,a,!0,n,r))}},{key:"moveCoordinates",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.isRecording,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1,a=this.getCoordinates(),i=a.x,o=a.y;return i+=e,o+=t,this.setCoordinates(i,o,w.a.Master.context.currentTime,r,n)}},{key:"unmap",value:function(){this.isMapped&&(this.isMapped.unmapParameter(this.isMapped._parameters.indexOf(this)),this.depthParameter&&this.depthParameter.set(1,!0,!0))}}]),n}(e)})(E)),z=function(e){Object(s.a)(n,e);var t=L(n);function n(e,r,a,o,s,c,u){var l=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],f=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];return Object(i.a)(this,n),t.call(this,e,r,a,o,s,c,u,l,f)}return Object(o.a)(n,[{key:"normalize",value:function(e){return Math.round(this.min+(this.max-this.min)*e)}},{key:"set",value:function(e,t,a){if(Object(m.a)(e))return null===e?Object(r.a)(Object(u.a)(n.prototype),"set",this).call(this,null,t,a):Object(r.a)(Object(u.a)(n.prototype),"set",this).call(this,Math.round(e),t,a)}}]),n}(B),V=function(e){Object(s.a)(n,e);var t=L(n);function n(e,r,a,o,s,c){return Object(i.a)(this,n),t.call(this,e,r,function(e,t){return e.value=t},a,o,s,c,!0)}return n}(B)},function(e,t,n){"use strict";var r=n(28),a=n(11),i=n(0),o=n.n(i),s=n(167),c=n(99),u=n(90),l=n.n(u),f=n(12),h=function(e,t){return e<0?-1*Math.pow(Math.abs(e),t):Math.pow(e,t)},p=Object(f.b)(function(e,t){if(t.parameter){var n=e.effects.effectParameters[t.parameter.id];return{value:void 0===n?t.parameter.get(!0):n}}},function(e){return{}})(function(e){var t=e.convertToRoot,n=e.onMouseUp,r=e.value,a=e.root,i=e.onUpdateParameter,s=e.step,c=e.max,u=e.min,f=h(parseFloat(r),1/a);return o.a.createElement(l.a,{slideStop:n,value:t?Math.log2(f):f,change:i,step:s,max:c,min:u,orientation:"horizontal",reversed:!1})}),d=n(34),m=n(15),v=n.n(m),b=n(76);var g=Object(f.b)(function(e,t){if(t.parameter){var n=e.effects.effectParameters[t.parameter.id];return{value:void 0===n?t.parameter.get(!0):n}}},function(e){return{}})(function(e){var t=e.displayFunction,n=e.unit,r=e.isParameter,a=e.parameter,s=e.onEdit,u=e.value,l=Object(c.a)(e,["displayFunction","unit","isParameter","parameter","onEdit","value"]),f=Object(i.useCallback)(function(){if(void 0===u||null===u)return 0;if("object"===typeof u){if(u.toSeconds)return u.toSeconds();if(u._val)return new v.a.Time(u._val).toSeconds()}else if("string"===typeof u)return new v.a.Time(u).toSeconds();return u},[u]),h=Object(i.useCallback)(function(){var e=f();return void 0!==e?e:r?a.get():l.getValue()},[a,u]);n=n||"";var p=(void 0===t?function(e){return Math.round(1e3*e)/1e3}(u):t(h()))+" "+n;return o.a.createElement(b.a,{element:d.gb,className:"pushable parameter-label-value",onClick:function(e){return s(e)}},l.convertToRoot?Math.round(Math.log2(p)):p)}),y=n(59),k=n(62),O=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setEditing,n=e.onUpdateParameter,r=e.value,s=(e.editedValue,Object(i.useState)(r)),c=Object(a.a)(s,2),u=c[0],l=c[1],f=Object(i.useCallback)(function(e){(Object(k.a)(e)||"."===e||""===e||"-"===e||"-."===e)&&(l(e),n({target:{value:e}},!1))},[l,n]),h=Object(i.useCallback)(function(e){"Enter"===e.key&&t(!1)},[t]);return o.a.createElement(y.h,{className:"tag-sound-input"},o.a.createElement(y.g,{value:u,onKeyUp:h,onChange:function(e){return f(e.target.value)},placeholder:"Parameter",className:"parameter-input-box"}))}),j=n(6),w=n(886),E=n(46),S=n(29),P=n(106),x=(n(79),n(124)),T=function(e,t){return e<0?-1*Math.pow(Math.abs(e),t):Math.pow(e,t)},C=new S.a,N=function(e,t){return e<0?-1*Math.pow(Math.abs(e),t):Math.pow(e,t)};var R=Object(f.b)(function(e,t){return t.parameter?{hasAutomations:t.parameter.automations&&t.parameter.automations.length>0}:{}},function(e){return{deleteParameterMidiMapping:function(t){return e(Object(j.f)(t))},setParameterSliderDown:function(t){return e(Object(j.Sd)(t))},setEffectParameterValue:function(t,n){return e(Object(j.Ub)(t,n))},setShowAutomation:function(t){return e(Object(j.Hf)(t))},setBottomMode:function(t){return e(Object(j.D)(t))},setShowPianoRoll:function(t){return e(Object(j.Wf)(t))}}})(function(e){var t=e.step,n=e.root,r=(e.deleteParameterMidiMapping,e.showAutomation),s=e.onClickParameterName,u=(e.setShowModulators,e.midiMapRef),l=e.onMouseDown,f=e.isMouseDown,h=(e.setShowModulator,Object(c.a)(e,["step","root","deleteParameterMidiMapping","showAutomation","onClickParameterName","setShowModulators","midiMapRef","onMouseDown","isMouseDown","setShowModulator"])),d=Object(i.useState)(N(h.max,1/n)),m=Object(a.a)(d,2),v=m[0],y=(m[1],Object(i.useState)(N(h.min,1/n))),j=Object(a.a)(y,2),S=j[0],P=(j[1],function(e,t){var n=e.root,r=e.isMouseDown,o=e.onMouseDown,s=e.midiMapRef,c=e.convertToRoot,u=Object(i.useRef)(t.parameter),l=Object(i.useState)(!1),f=Object(a.a)(l,2),h=f[0],p=f[1],d=Object(i.useState)(t.value||t.parameter&&t.parameter.get(!0)),m=Object(a.a)(d,2),v=m[0],b=m[1],g=Object(i.useCallback)(function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.stopPropagation(),n!==h&&n&&b(t.value),p(n)},[p,b,t.value,h]),y=Object(i.useCallback)(function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=e.target.value;if(r)o(),a=T(a,n);else if("."===a||"-."===a)a=0;else if("-"===a)a=0;else if("-."===a)a=0;else if(""===a)a=0;else{if(!Object(k.a)(a))return;a=parseFloat(a)}c&&(a=Math.pow(2,a));var i=u.current;s.current===x.b&&t.setParameterMidiMapSelection(i.id);var l=t.sequencerEngine&&t.sequencerEngine.operationManager;l?l.dispatch(Object(E.v)(i,a,!1,!1)):i.set(a,!1),b(a)},[b,n]);Object(i.useEffect)(function(){h||!r.current&&t.parameter&&b(t.parameter.get(!0))},[h,t.parameter,b]);var O=Object(i.useCallback)(function(e){"Enter"===e.key&&p(!1)},[p]);return Object(i.useEffect)(function(){u.current=t.parameter},[t.parameter]),{onEdit:g,value:v,setValue:b,onUpdateParameter:y,setEditing:p,onKeyPress:O,editing:h}}({root:n,midiMapRef:u,convertToRoot:h.convertToRoot,isMouseDown:f,onMouseDown:l},h)),R=P.onEdit,M=P.editing,A=(P.onKeyPress,P.setEditing),q=P.value,D=P.onUpdateParameter;P.onTypedInputChanged,P.inputValue;Object(i.useEffect)(function(){u.current=h.midiMapMode},[h.midiMapMode]);var I=Object(i.useCallback)(function(){h.setParameterSliderDown(void 0),h.parameter&&(h.parameter.automation.smoothen(),h.parameter.mixAutomation.smoothen()),f.current=!1},[q,h.parameter]),_=Object(i.useCallback)(function(){h.pLockedSteps.forEach(function(e){return h.parameter.deletePLockForStep(e)})},[h.pLockedSteps,h.parameter]);return o.a.createElement("div",{className:"slider-and-labels"},o.a.createElement("div",{className:"parameter-label-container"},o.a.createElement("div",{className:"parameter-label effect-parameter-label"},o.a.createElement(b.a,{element:h.parameter,onClick:function(){return s()},className:"pushable parameter-label-name"},h.name,": "),M&&o.a.createElement(O,{setEditing:A,onUpdateParameter:D,value:q}),!M&&o.a.createElement(g,{convertToRoot:h.convertToRoot,unit:h.unit,displayFunction:h.displayFunction,isParameter:h.isParameter,onEdit:R,getValue:h.getValue,parameter:h.parameter}),!M&&h.pLockedSteps&&o.a.createElement("div",{onClick:_,style:{backgroundColor:C.getColorForTrack(h.pLockedSteps[0].track)},className:"p-lock-indicator"},"P-Locked"),h.hasAutomations&&o.a.createElement("img",{onClick:function(){return r()},src:"/automation-icon-disabled.png",className:"automation-icon"}))),h.children,o.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"slider-and-modulators"},!h.hideSlider&&o.a.createElement(p,{onMouseUp:I,convertToRoot:h.convertToRoot,onUpdateParameter:D,parameter:h.parameter,step:t,max:v,min:S,root:n}),o.a.createElement(w.a,{sequencerEngine:h.sequencerEngine,parameter:h.parameter})))}),M=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.parameter,n=Object(i.useState)(t&&void 0!==t.keyScaling),r=Object(a.a)(n,2),s=r[0],c=r[1];Object(i.useEffect)(function(){t&&c(void 0!==t.keyScaling)},[t,c]);var u=Object(i.useCallback)(function(){s?t.disableKeyScaling():t.enableKeyScaling(),t.context.track&&(console.log("clearing cache"),t.context.track.parametersToScale=void 0),c(!s)},[t,c,s]),l="key-scaling-toggle pushable ";return s&&(l="key-scaling-toggled pushable"),o.a.createElement("div",{onClick:u,className:l})}),A=n(534),q=n(830),D=(n(428),n(38)),I=new S.a;t.a=Object(f.b)(function(e,t){if(void 0===t.parameter)return{};t.parameter&&t.parameter.id;var n=e.keyboard.selectedPianoRollSteps,r=n&&n.length>0&&t.parameter&&n.filter(function(e){return e&&e.id in t.parameter.stepToValue});return{context:t.parameter&&t.parameter.context,pLockedSteps:r&&0!==r.length?r:void 0,isMidiSelected:e.midi.parameterSelected&&t.parameter.id===e.midi.parameterSelected,isSelected:t.parameter===e.effects.accumulatorParameterSelected,midiMapMode:e.midi.midiMapMode,isMacroMapping:e.effects.isMacroMapping,isParameterToMap:e.effects.parameterToMap&&t.parameter&&e.effects.parameterToMap===t.parameter,isSelectedParameter:t.parameter&&e.effects.accumulatorParameterSelected==t.parameter,isAccumulated:t.parameter&&t.parameter.isMapped,depthParameter:t.parameter&&t.parameter.depthParameter}},function(e){return{setEffectParameterValue:function(t,n){return e(Object(j.Ub)(t,n))},setContextualHelp:function(t){return e(Object(j.ub)(t))},setParameterMidiMapSelection:function(t){return e(Object(j.Od)(t))},deleteParameterMidiMapping:function(t){return e(Object(j.f)(t))},setParameterToMap:function(t){return e(Object(j.Td)(t))},setParameterSliderDown:function(t){return e(Object(j.Sd)(t))},setShowAutomation:function(t){return e(Object(j.Hf)(t))},setBottomMode:function(t){return e(Object(j.D)(t))},setShowPianoRoll:function(t){return e(Object(j.Wf)(t))},setTrackAutomationParameter:function(t,n){return e(Object(j.Ng)(t,n))},setAccumulatorParameterSelected:function(t){return e(Object(j.r)(t))}}})(function(e){var t=Object(i.useRef)(void 0),n=Object(i.useRef)(e.midiMapMode),c=Object(i.useRef)(!1),u=Object(i.useCallback)(function(){e.setParameterSliderDown(e.parameter),c.current=!0},[]),l=Object(i.useState)(!(!e.parameter||!e.parameter.isConnectedToAnyModulator)&&e.parameter.isConnectedToAnyModulator()),f=Object(a.a)(l,2),h=f[0],p=f[1],m=Object(i.useState)(!1),v=Object(a.a)(m,2),b=(v[0],v[1],Object(i.useState)(e.value||e.parameter&&e.parameter.get(!0))),g=Object(a.a)(b,2),y=(g[0],g[1],Object(i.useState)(e.value||e.parameter&&e.parameter.get(!0))),k=Object(a.a)(y,2),O=(k[0],k[1],Object(i.useRef)(0)),w=e.root||1;Object(i.useEffect)(function(){e.parameter&&e.parameter.isConnectedToAnyModulator()&&p(!0)},[e.parameter&&e.parameter.isConnectedToAnyModulator()]),Object(i.useEffect)(function(){e.isSelected&&E()},[]),Object(i.useEffect)(function(){e.isSelected&&E()},[e.isSelected]);var E=function(){if(!e.parameter.isMapped||!e.parameter.context||e.parameter.isMapped.track!==e.parameter.context.track){for(var n=t.current,r=n,a=0;n&&n&&n.className&&!(n.className.includes("effects-view")||a>=20);)n=n.parentNode,a++;if(!n.className&&n.className.includes("effects-view")){var i=r.offsetLeft;i>n.offsetWidth?n.scroll(i,0):n.scroll(0,0)}}},S=(e.sequencerEngine&&e.sequencerEngine.operationManager,Object(i.useCallback)(function(){return e.parameter?e.parameter.availableLFOs:[]},[e.lfos,e.parameter])),T=function(){return e.parameter?e.parameter.availableEnvelopes:[]},C=Object(i.useCallback)(function(){var t=e.isMacroMapping,n=e.parameter,r=e.isParameterToMap;if(t&&n&&!n.isMapped){var a="macro-overlay";r&&(a+=" parameter-to-map"),n.hasMacro&&(a+=" mapped");var i={};e.parameter.hasMacro&&(i={backgroundColor:I.getColorForHash(n.hasMacro.id)});var s=n.hasMacro&&n.hasMacro.name;return o.a.createElement("div",{onClick:function(t){t.stopPropagation(),e.parameter.isMapped||e.setParameterToMap(e.parameter)},className:a},o.a.createElement("div",{className:"overlay-main"}),o.a.createElement("div",{className:"overlay-detail",style:i},s))}return""},[e.parameter,e.parameterToMap,e.isMacroMapping]),N=Object(i.useState)(S()),_=Object(a.a)(N,2),F=_[0],L=_[1],B=Object(i.useState)(T()),z=Object(a.a)(B,2),V=z[0],H=z[1],U=void 0!==e.customClassName?e.customClassName:"",J=e.isSelectedParameter;U+=J?" selected-parameter parameter-box":"parameter-box";var G=e.refined?.01:e.step;Object(i.useEffect)(function(){L(S()),H(T())},[e.parameter&&e.parameter.context,H,L]),e.isMidiSelected&&e.midiMapMode===x.b&&(U+=" midi-selected");e.contextualHelp||d.v;e.isSelected&&(U+=" accumulator-selected");var W=e.parameter&&e.parameter.id;W&&(W="parameter-"+W);var K=Object(i.useCallback)(function(){n.current===x.b?Object(j.f)(e.parameter.id):void 0!==e.sequencerEngine&&p(!0);var t=(new Date).getTime();t-O.current<=250&&X(),O.current=t},[p,e.parameter]),X=Object(i.useCallback)(function(){if(e.setShowAutomation(!0),e.setShowPianoRoll(!0),e.setBottomMode(P.d),e.parameter.track){var t=e.parameter.track.instrumentRack?e.parameter.track.instrumentRack:e.parameter.track;e.setTrackAutomationParameter(t.id,e.parameter)}},[e.parameter]);return o.a.createElement("div",{onContextMenu:function(e){e.stopPropagation(),e.preventDefault()},ref:t,id:W,className:U},e.isAccumulated?o.a.createElement("div",{onClick:function(){return e.setAccumulatorParameterSelected(J?void 0:e.parameter)},className:"accumulator-corner"}):"",C(),o.a.createElement(R,{max:e.max,midiMapRef:n,onMouseDown:u,onClickParameterName:K,showAutomation:X,isMouseDown:c,min:e.min,setShowModulators:p,hideSlider:e.hideSlider,sequencerEngine:e.sequencerEngine,root:w,displayFunction:e.displayFunction,convertToRoot:e.convertToRoot,parameter:e.parameter,pLockedSteps:e.pLockedSteps,step:G,name:e.name},o.a.createElement(D.a,{condition:e.lfoEnabled&&(void 0===e.sequencerEngine||h)},o.a.createElement("div",{className:"lfo-boxes"},F&&F.map(function(t,n){var a;return o.a.createElement(A.a,(a={connectToLFO:e.connectToLFO,key:n,isToggled:e.parameter&&e.parameter.isConnectedToLFO(t),parameter:e.parameter,lfo:t,lfos:F},Object(r.a)(a,"parameter",e.parameter),Object(r.a)(a,"instrument",e.instrument),a))}),V&&V.map(function(t,n){var a;return o.a.createElement(q.a,(a={key:n,isToggled:e.parameter&&e.parameter.isConnectedToEnvelope(t),parameter:e.parameter,envelope:t,envelopes:V},Object(r.a)(a,"parameter",e.parameter),Object(r.a)(a,"instrument",e.instrument),a))}),o.a.createElement(M,{parameter:e.parameter}))),o.a.createElement("div",{className:"clear-fix"})),e.parameter&&e.parameter.depthParameter&&e.parameter.isConnectedToAnyModulator()&&o.a.createElement(s.a,{display:function(e){return Math.round(100*e)+"%"},min:0,max:1,width:70,label:"Amount",name:"",parameter:e.parameter.depthParameter}))})},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return s});var r=n(8),a=(n(45),n(6));function i(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n.depthParameter;if(o(n)){var i=Object(r.a)({},e);return i[t]=n.getJson(a),i}return e}var o=function(e,t){return e.isConnectedToAnyModulator()||Object.keys(e.patternToValue).length>0||Object.keys(e.paletteToValue).length>0||Object.keys(e.stepToValue).length>0||e.mixAutomation.automations.length>0||e.automations&&e.automations.length>0||e.hasMacro||e.depthParameter||e.isMapped||e.higherOrdered||t};function s(e,t,n,r,i){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(t in e){c(e[t],n);var s=n.fromJson(e[t],r,i);if(o)return s;(r=r||n.sequencerEngine)&&r.store.dispatch(Object(a.Vb)(s))}else n.disconnectFromAllModulators(),n.resetMinMax();return{}}var c=function(e,t){var n=t.lfos.filter(function(t){return!e.lfos||!e.lfos.includes(t.number-1)});e.lfos||(n=t.lfos),n.forEach(function(e){return t.disconnectFromLFO(e)});var r=t.envelopes.filter(function(t){return!e.envelopes||!e.envelopes.includes(t.number-1)});e.envelopes||(r=t.envelopes),r.forEach(function(e){return t.disconnectFromEnvelope(e)}),t.keyScaling&&!e.keyScaling&&t.disableKeyScaling()}},,,function(e,t,n){"use strict";(function(e){n.d(t,"i",function(){return f}),n.d(t,"h",function(){return h}),n.d(t,"f",function(){return p}),n.d(t,"g",function(){return d}),n.d(t,"n",function(){return m}),n.d(t,"b",function(){return v}),n.d(t,"e",function(){return b}),n.d(t,"d",function(){return g}),n.d(t,"l",function(){return y}),n.d(t,"j",function(){return k}),n.d(t,"k",function(){return O}),n.d(t,"a",function(){return j}),n.d(t,"m",function(){return w}),n.d(t,"c",function(){return E});var r=n(2),a=n(4),i=(n(289),n(369)),o=n(36),s=n(229),c=(window.web3,o.a.utils.padLeft("0x0",64)),u=function(){function e(t,n){Object(r.a)(this,e),this.toConversion=t,this.fromConversion=n}return Object(a.a)(e,[{key:"convertTo",value:function(e){return this.toConversion(e)}},{key:"convertFrom",value:function(e){return e===c?null:this.fromConversion(e)}}]),e}();function l(e){var t="";for(var n in e)0!=e.charCodeAt(n)&&(t+=e.charAt(n));return t}var f=new u(function(e){return function(e){var t=s.decode(e).toString("hex").replace(/^1220/,"");return 64!=t.length?null:"0x"+t}(e)},function(t){return function(t){var n=new e(t.replace(/^0x/,"1220"),"hex");return s.encode(n)}(t)}),h=new u(function(e){return o.a.utils.padLeft(o.a.utils.numberToHex(e),64)},function(e){return o.a.utils.hexToNumber(e)}),p=new u(function(e){return o.a.utils.padLeft(o.a.utils.numberToHex(e),64)},function(e){return l(o.a.utils.toAscii(e))}),d=new u(function(e){return o.a.utils.padLeft(o.a.utils.numberToHex(e),64)},function(e){return o.a.utils.hexToNumber(e)}),m=new u(function(e){return o.a.utils.padLeft(o.a.utils.numberToHex(parseInt(e)),64)},function(e){return o.a.utils.hexToNumber(e)}),v=new u(function(e){return o.a.utils.padRight(o.a.utils.fromAscii(e),64)},function(e){return l(o.a.utils.toAscii(e))}),b=new u(function(e){return o.a.utils.padLeft(o.a.utils.fromAscii(e),64)},function(e){return l(o.a.utils.toAscii(e))}),g=new u(function(e){return o.a.utils.padLeft(o.a.utils.toHex(e),64)},function(e){return function(e){for(var t=0;t<e.length;t++)if("0"!==e.slice(t,t+1))return e.slice(t);return e}(e.slice(2))});var y=new u(function(e){return o.a.utils.padRight(o.a.utils.toHex(e),64)},function(e){return l(o.a.utils.toAscii(e))}),k=new u(function(e){return o.a.utils.padRight(e,64)},function(e){return l(o.a.utils.toAscii(e)).split("").map(function(e){return i.a[e]})}),O=new u(function(e){return o.a.utils.padRight(e,64)},function(e){return i.a[l(o.a.utils.toAscii(e))]}),j=new u(function(e){return o.a.utils.padLeft(e,64)},function(e){return function(e){return"0x"+e.slice(e.length-40)}(e)}),w=new u(function(e){return o.a.utils.padLeft(e[0],64)},function(e){return l(o.a.utils.toAscii(e))}),E=function(e){return new u(function(e){return e},function(t){return t.slice(2,2+64*e)})}}).call(this,n(27).Buffer)},,,function(e,t,n){"use strict";var r=n(11),a=n(2),i=n(4),o=n(55),s=["#29FFFF","#5429FF","#FF29D0","#0AFF6C","#FFBA7B","#FFE600","#8FFF00","#9EF3FF","#A48DFF","#FF9AE9","#FF8D8D","#FF7A00","#C8FF82"],c={},u={},l=function(){function e(){Object(a.a)(this,e)}return Object(i.a)(e,[{key:"getColorForTrack",value:function(e){if(void 0===e)return this.getColorForHash(void 0);if(e.envelopesTrack)return this.getColorForHash(e.presetName||e.id);e.getTrackType()===o.c&&(e=e.tracks[0]&&e.tracks[0].track||e);var t=void 0!==e.sample&&void 0!==e.sample.getId()?e.sample.getId():e.presetName||e.instrument&&e.instrument.defaultSampler&&e.instrument.defaultSampler.sample.getId()||e.getName();if(e.isAudioTrack&&(t=e.id),e.getTrackType()===o.e&&(t=e.presetName||"MULTI FREEZE"),t in u)return u[t];var n=this.getColorForHash(t),r=this.saturate(n,4);return u[t]=r,r}},{key:"transparent",value:function(e,t){return e.slice(0,e.length-1)+", "+t+")"}},{key:"getColor",value:function(e){return s[e%s.length]}},{key:"getColorForHash",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("Empty Patch"===e)return"#fb1515";if("Synth"===e)return"#ff0471";if("External Instrument"===e)return"#7effb3";if("Resampled"===e)return"#ff1e00";if("breaks"===e||"drums"===e)return"#11ff64";var t=this.intToRGB(this.hashCode(e)),n=f(this.getRGB(t)),r=n.h;n.s,n.l;return 100,60,this.rawHSLToHex({h:r,s:100,l:60})}},{key:"hashCode",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t}},{key:"intToRGB",value:function(e){var t=(16777215&e).toString(16).toUpperCase();return"#"+"00000".substring(0,6-t.length)+t}},{key:"hueShift",value:function(e,t){var n=p(e);return h({h:n.h+t,s:n.s,l:n.l})}},{key:"compliment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=p(e),r=n.h;return 0===r&&r++,h({h:r+=10*t%255,s:n.s,l:n.l})}},{key:"saturate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(e){if(e.startsWith("hsl")){var r=p(e),a=r.h,i=r.s,o=r.l;return o*=n,e=h({h:a,s:i=Math.min(i*t,100),l:o})}var s=f(this.getRGB(e)),c=s.h,u=s.s,l=s.l;return l*=n,e=h({h:c,s:u=Math.min(u*t,100),l:l})}}},{key:"brighten",value:function(e,t){if(e.startsWith("hsl")){var n=p(e);return h(n=function(e,t){var n=e.h,r=e.s,a=e.l;return{h:n,s:r,l:a*t}}(n,t))}var r=c[e+"."+t];if(r)return r;var a=Math.min(255,Math.floor(parseInt(e.slice(1,3),16)*t)),i=Math.min(255,Math.floor(parseInt(e.slice(3,5),16)*t)),o=Math.min(255,Math.floor(parseInt(e.slice(5),16)*t));a=a.toString(16),i=i.toString(16),o=o.toString(16),1===a.length&&(a="0"+a),1===i.length&&(i="0"+i),1===o.length&&(o="0"+o);var s="#"+a+i+o;return c[e+"."+t]=s,s}},{key:"getBrightness",value:function(e){var t=this.getRGB(e);return.299*t.r+.587*t.g+.114*t.b}},{key:"rawHSLToHex",value:function(e){return d(e.h,e.s,e.l)}},{key:"hslToHex",value:function(e){var t=p(e);return d(t.h,t.s,t.l)}},{key:"getRGB",value:function(e){return{r:Math.floor(parseInt(e.slice(1,3),16)),g:Math.floor(parseInt(e.slice(3,5),16)),b:Math.floor(parseInt(e.slice(5),16))}}}]),e}();function f(e){var t=e.r,n=e.g,r=e.b;t/=255,n/=255,r/=255;var a=Math.min(t,n,r),i=Math.max(t,n,r),o=i-a,s=0,c=0;return s=0==o?0:i==t?(n-r)/o%6:i==n?(r-t)/o+2:(t-n)/o+4,(s=Math.round(60*s))<0&&(s+=360),c=(i+a)/2,{h:s,s:+(100*(0==o?0:o/(1-Math.abs(2*c-1)))).toFixed(1),l:c=+(100*c).toFixed(1)}}function h(e){return"hsl("+e.h+","+e.s+"%,"+e.l+"%)"}function p(e){var t=(e=e.substring(4)).split(","),n=Object(r.a)(t,3),a=n[0],i=n[1],o=n[2],s=i.indexOf("%");return i=i.substring(0,s),s=o.indexOf("%"),o=o.substring(0,s),{h:parseFloat(a),s:parseFloat(i),l:parseFloat(o)}}function d(e,t,n){n/=100;var r=t*Math.min(n,1-n)/100,a=function(t){var a=(t+e/30)%12,i=n-r*Math.max(Math.min(a-3,9-a,1),-1);return Math.round(255*i).toString(16).padStart(2,"0")};return"#".concat(a(0)).concat(a(8)).concat(a(4))}t.a=l},function(e,t,n){"use strict";(function(e){var r=n(8),a=n(9),i=n(5),o=n.n(i),s=n(14),c=n(2),u=n(4),l=n(36),f=n(1512),h=n(52),p=n(1484),d=n(1510),m=(n(1545),n(70)),v=n(44),b=n(1485),g=n(269),y=n(1486),k=n(1487),O=n(1052),j=n(1488),w=n(1514),E=n(750),S=n(1489),P=n(1490),x=n(763),T=n(1491),C=n(1037),N=n(1492),R=n(40),M=(n(192),n(31)),A=n(1053),q=n(1515),D=n(1493),I=new g.a;console.log("initialized contract wiht address = "+I.contractAddress);var _=new k.a,F=new E.a,L=new S.a,B=new P.a,z=new b.a,V=n(229);function H(e){for(var t=e.map(function(e){return J(e.ipfsHash)}),n=l.a.utils.padLeft("0x0",64),r=t.length;r<16;r++)t.push(n);for(var a=[],i=[],o=[],s=0;s<16;s++)if(void 0!==e[s]){var c=e[s].videoId;void 0===c||"0x00"===c||""===c?o.push(n):o.push(l.a.utils.padRight(l.a.utils.fromAscii(c),64));var u=e[s].coverArt;void 0===u?a.push(n):a.push(J(u)),void 0===e[s].discogsId?i.push(0):i.push(e[s].discogsId)}else a.push(n),i.push(0),o.push(n);for(var f=e.map(function(e){return l.a.utils.padRight(l.a.utils.fromAscii(e.title).slice(0,66),64)}),h=f.length;h<16;h++)f.push(n);for(var p=e.map(function(e){var t=e.tags.map(function(e){return l.a.utils.padRight(l.a.utils.fromAscii(e),64)});return K(t)}),d=p.length;d<16;d++)p.push([n,n,n,n]);for(var m=e.map(function(e){var t=e.styles.map(function(e){return e?l.a.utils.padRight(l.a.utils.fromAscii(e),64):n});return K(t)}),v=m.length;v<16;v++)m.push([n,n,n,n]);for(var b=e.map(function(e){return null===e.country||""===e.country?n:l.a.utils.padRight(l.a.utils.fromAscii(e.country),64)}),g=b.length;g<16;g++)b.push(n);for(var y=e.map(function(e){return null===e.year||void 0===e.year?0:e.year}),k=y.length;k<16;k++)y.push(0);return{sampleHashes:t,tags:p,titles:f,styles:m,years:y,countries:b,discogsIds:i,coverArts:a,videoIds:o}}function U(e){for(var t=l.a.utils.fromAscii(e),n=t.length;n<=65;n++)t+="0";return t}function J(e){var t=V.decode(e).toString("hex").replace(/^1220/,"");return 64!=t.length?null:"0x"+t}var G=new(function(){function e(){Object(c.a)(this,e),void 0!==l.a&&(this.web3=l.a,l.a.eth.net.isListening()&&(this.contract=new l.a.eth.Contract(I.abi,I.contractAddress),this.slicesContract=new l.a.eth.Contract(_.abi,_.contractAddress),this.favoritesContract=new l.a.eth.Contract(F.abi,F.contractAddress),this.slicesContractAddress=this.slicesContract.options.address,this.ethAddress=this.contract.options.address,this.favoritesContractAddress=this.favoritesContract.options.address,this.sequencesContract=new l.a.eth.Contract(B.abi,B.contractAddress),this.sequencesContractAddress=this.sequencesContract.options.address,this.indexContract=new l.a.eth.Contract(L.abi,L.contractAddress),this.indexContractAddress=this.indexContract.options.address,this.multiSamplesContract=z.getContract(l.a)),this.cachedTags=void 0,this.users=new x.a(l.a),this.crypto=new O.a(this),this.encryption=new j.a(l.a,this.crypto),this.guilds=new T.a(l.a,this.crypto,this.encryption),this.tokenizedSequences=new y.a(l.a),this.guildSequences=new N.a(l.a,this.guilds,this.encryption,this.crypto),this.samples2D=new f.a(l.a),this.messaging=new w.a(l.a),this.dmca=new q.a(l.a),this.folders=new p.a(l.a),this.resample=new D.a(l.a),this.presets=new A.a(l.a,this.crypto,this.guilds),this.xanadu=new d.a(l.a),this.guildSamples=new C.a(l.a))}return Object(u.a)(e,[{key:"postUserId",value:function(){var e=Object(s.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"guildId",get:function(){if(void 0===this.store)return 0;var e=this.store.getState().guilds.selectedGuild;return e?e.guildId:0}},{key:"isMetamaskInstalled",value:function(){return!1}},{key:"getUser",value:function(){var e=Object(s.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.getAccount();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getSoundsWithUserBlockNumber",value:function(){var e=Object(s.a)(o.a.mark(function e(t,n){var r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new R.a(this.ethAddress).from(M.Y).select("ipfsHash").where("user",t).fromBlock(n).toBlock(n).where("guildId",this.guildId),e.next=3,r.executeQuery(!0);case 3:return a=e.sent,e.abrupt("return",Array.from(new Set(a.map(function(e){return e.ipfsHash}))));case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSoundsWithDiscogs",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new R.a(this.ethAddress).from(M.n).select("sampleHash").where("discogsId",t).where("guildId",this.guildId),e.next=3,n.executeQuery(!0);case 3:return r=e.sent,e.abrupt("return",Array.from(new Set(r.map(function(e){return e.sampleHash}))));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getCoverArtForDiscogs",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new R.a(this.ethAddress).from(M.n).select("coverArtHash").where("discogsId",t),e.next=3,n.executeQuery(!0);case 3:return r=e.sent,e.abrupt("return",r[0]);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getCachedTags",value:function(e,t){return e>this.cachedTags.length?[]:e+t>this.cachedTags.length?this.cachedTags.slice(e):this.cachedTags.slice(e,e+t)}},{key:"searchTags",value:function(e){var t=this;return new Promise(function(n,r){void 0!==t.cachedTags?(e=e.toLowerCase(),n(t.cachedTags.filter(function(t){return t.toLowerCase().includes(e)}))):n([])})}},{key:"getTagsForSound",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new R.a(this.ethAddress).from(M.cb).select("tag").where("ipfsHash",t).executeQuery(!0);case 2:return n=e.sent,e.abrupt("return",n.map(function(e){return e.tag}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getYearsForSound",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new R.a(this.ethAddress).from(M.fb).select("year").where("ipfsHash",t).executeQuery(!0);case 2:return n=e.sent,e.abrupt("return",n.map(function(e){return e.year}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getVideoIdForSound",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new R.a(this.ethAddress).from(M.gb).select("videoId").where("ipfsHash",t).executeQuery(!0);case 2:return n=e.sent,e.abrupt("return",n.map(function(e){return e.videoId})[0]);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTitleForSound",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new R.a(this.ethAddress).from(M.Y).select("title").where("ipfsHash",t).executeQuery(!0);case 2:return n=(n=e.sent).filter(function(e){return""!==e.title})[0],e.abrupt("return",void 0!==n?n.title:void 0);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getUserNameForSound",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new R.a(this.ethAddress).from(M.Y).select("user").where("ipfsHash",t).executeQuery(!0);case 2:if(void 0===(n=(n=e.sent).map(function(e){return e.user})[0])){e.next=9;break}return console.log("user = "+n),e.next=8,this.users.getUserName(n);case 8:return e.abrupt("return",e.sent);case 9:return e.abrupt("return",void 0);case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getCoverArtForSound",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new R.a(this.ethAddress).from(M.n).select("coverArtHash").where("sampleHash",t).executeQuery(!0);case 2:return n=(n=e.sent).filter(function(e){return""!==e.coverArtHash})[0],e.abrupt("return",void 0!==n?n.coverArtHash:void 0);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getFavoritesForSound",value:function(e){var t=this;return new Promise(function(){var n=Object(s.a)(o.a.mark(function n(r,a){var i,s,c,u,l,f,p,d;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h.a.getAccount();case 2:if(void 0!==(i=n.sent)){n.next=6;break}return r({userFavorited:[],othersFavorited:[]}),n.abrupt("return");case 6:return n.next=8,new R.a(t.favoritesContractAddress).from(M.Z).select("user").where("sampleHash",e).executeQuery();case 8:return s=n.sent,n.next=11,new R.a(t.favoritesContractAddress).from(M.eb).select("user").where("sampleHash",e).executeQuery();case 11:c=n.sent,u=i.toLowerCase(),l=s.filter(function(e){return e.user===u}),f=s.filter(function(e){return e.user!==u}),p=c.filter(function(e){return e.user===u}),d=c.filter(function(e){return e.user!==u}),r({userFavorited:l.length-p.length,othersFavorited:f.length-d.length});case 18:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getOverallVotedRankings",value:function(){var e=this;return new Promise(function(){var t=Object(s.a)(o.a.mark(function t(n,r){var a,i,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new R.a(e.favoritesContractAddress).from(M.Z).select("sampleHash").executeQuery();case 2:return a=t.sent,t.next=5,new R.a(e.favoritesContractAddress).from(M.eb).select("sampleHash").executeQuery();case 5:i=t.sent,s={},a.forEach(function(e){var t=e.sampleHash;t in s?s[t]++:s[t]=1}),i.forEach(function(e){var t=e.sampleHash;t in s?s[t]--:s[t]=-1}),n(s);case 10:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getFavoritesForUser",value:function(){var e=this;return new Promise(function(){var t=Object(s.a)(o.a.mark(function t(n,r){var a,i,s,c,u,l,f,p,d,m,v,b,g;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.getAccount();case 2:if(void 0!==(a=t.sent)){t.next=6;break}return n([]),t.abrupt("return");case 6:return i=a.toLowerCase(),t.next=9,new R.a(e.favoritesContractAddress).from(M.Z).select("sampleHash").where("user",i).executeQuery();case 9:return s=t.sent,t.next=12,new R.a(e.favoritesContractAddress).from(M.eb).select("sampleHash").where("user",i).executeQuery();case 12:for(d in c=t.sent,u=s.map(function(e){return e.sampleHash}),l=c.map(function(e){return e.sampleHash}),f={},p={},u)u[d]in f?f[u[d]]++:f[u[d]]=1;for(m in l)l[m]in p?p[l[m]]++:p[l[m]]=1;for(b in v=[],f)g=f[b],b in p&&(g-=p[b]),g>0&&v.push(b);n(v);case 22:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getSoundsWithVideo",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new R.a(this.ethAddress).from(M.gb).select("ipfsHash").where("videoId",t).where("guildId",this.guildId).executeQuery();case 2:return n=e.sent,e.abrupt("return",Array.from(new Set(n.map(function(e){return e.ipfsHash}))));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithOrTags",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=new R.a(this.ethAddress).from(M.cb).select("ipfsHash").whereIn("tag",t),e.next=3,this.getGuildsWithAccess();case 3:return e.t1=e.sent,n=e.t0.whereIn.call(e.t0,"guildId",e.t1),e.next=7,n.executeQuery();case 7:return r=e.sent,e.abrupt("return",r.map(function(e){return e.ipfsHash}));case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithTag",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,r=void 0,this.cache.useMonth&&(n=this.cache.toBlock,r=this.cache.fromBlock),e.t0=Array,e.t1=Set,e.next=7,this.getSoundsWithField("tag",t,M.cb,!1,r,n);case 7:return e.t2=e.sent,e.t3=new e.t1(e.t2),e.abrupt("return",e.t0.from.call(e.t0,e.t3));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithStyle",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,r=void 0,this.cache.useMonth&&(n=this.cache.toBlock,r=this.cache.fromBlock),e.abrupt("return",this.getSoundsWithField("style",t,M.bb,!1,r,n));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithCountry",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,r=void 0,this.cache.useMonth&&(n=this.cache.toBlock,r=this.cache.fromBlock),e.abrupt("return",this.getSoundsWithField("country",t,M.X,!1,r,n));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithYear",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,r=void 0,this.cache.useMonth&&(n=this.cache.toBlock,r=this.cache.fromBlock),e.abrupt("return",this.getSoundsWithField("year",t,M.fb,!1,r,n));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithFieldParallel",value:function(){var e=Object(s.a)(o.a.mark(function e(t,n,r){var a,i,s,c,u,l,f,h,p,d,m,v=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=v.length>3&&void 0!==v[3]&&v[3],i=v.length>4?v[4]:void 0,s=v.length>5?v[5]:void 0,!(i+1>=s)){e.next=5;break}return e.abrupt("return",[]);case 5:for(8,c=s-i,u=[],l=1;l<=8;l++)f=i+Math.floor((l-1)*c/8),h=i+Math.floor(l*c/8),u.push(this.getSoundsWithField(t,n,r,a,f,h));return e.next=11,Promise.all(u);case 11:for(m in p=e.sent,d=[],p)d=d.concat(p[m]);return e.abrupt("return",Array.from(new Set(d)));case 15:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getSoundsWithField",value:function(){var e=Object(s.a)(o.a.mark(function e(t,n,r){var a,i,s,c=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>3&&void 0!==c[3]&&c[3],i=c.length>4&&void 0!==c[4]?c[4]:37e5,s=c.length>5?c[5]:void 0,e.prev=3,e.next=6,this.getSoundsWithFieldHelper(t,n,r,a,i,s);case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(3),e.next=13,this.getSoundsWithFieldParallel(t,n,r,a,i,s);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}},e,this,[[3,9]])}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getGuildsWithAccess",value:function(){var e=Object(s.a)(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((new Date).getTime(),0===this.guildId){e.next=3;break}return e.abrupt("return",[this.guildId]);case 3:return e.t0=a.a,e.next=6,this.guilds.getGuildsWithAccess();case 6:e.t1=e.sent,(t=(0,e.t0)(e.t1)).sort(),e.t2=o.a.keys(t);case 10:if((e.t3=e.t2()).done){e.next=18;break}if(!((n=e.t3.value)>=1)){e.next=14;break}return e.abrupt("break",18);case 14:return e.next=16,this.guilds.getGuildKey(t[n]);case 16:e.next=10;break;case 18:return t.length>0&&(t=[t[0]]),(new Date).getTime(),e.abrupt("return",[].concat(Object(a.a)(t),[0]));case 21:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getSoundsWithFieldHelper",value:function(e,t,n){var r=this,a=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:37e5),i=arguments.length>5?arguments[5]:void 0;a&&l.a.utils.toHex(a);return i&&l.a.utils.toHex(i),new Promise(function(){var c=Object(s.a)(o.a.mark(function s(c,u){var l,f,h;return o.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.getGuildsWithAccess();case 2:return l=o.sent,f=new R.a(r.ethAddress).from(n).select("ipfsHash").where(e,t).whereIn("guildId",l),i&&f.toBlock(i),a&&f.fromBlock(a),o.next=8,f.executeQuery(!0);case 8:h=o.sent,c(h.map(function(e){return e.ipfsHash}));case 10:case"end":return o.stop()}},s)}));return function(e,t){return c.apply(this,arguments)}}())}},{key:"getSoundsFromBlock",value:function(e,t){var n=this;return new Promise(function(){var r=Object(s.a)(o.a.mark(function r(a,i){var s,c,u,l,f,h;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("getting guilds with access"),s=(new Date).getTime(),r.next=4,n.getGuildsWithAccess();case 4:return c=r.sent,u=(new Date).getTime(),l=u-s,console.log("getting guilds with access took %s ms",l),f=new R.a(n.ethAddress).from(M.Y).select("ipfsHash").select("guildId").fromBlock(e).toBlock(t).limit(1e3).whereIn("guildId",window.installation?[0]:c),r.next=11,f.executeQuery(!0);case 11:h=r.sent,a(h.map(function(e){return e.ipfsHash}));case 13:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}},{key:"getBlockDate",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getting blockdate = ",t),e.next=3,l.a.eth.getBlock(t);case 3:if(null!==(n=e.sent)){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.abrupt("return",new Date(1e3*n.timestamp));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getBlockNumberAtDate",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r,a,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.eth.getBlockNumber();case 2:return n=e.sent,r=500,e.next=6,l.a.eth.getBlock(n);case 6:a=e.sent,i=new Date(1e3*a.timestamp);case 8:if(!(t.getTime()<i.getTime())){e.next=16;break}return n-=r,e.next=12,l.a.eth.getBlock(n);case 12:a=e.sent,i=new Date(1e3*a.timestamp),e.next=8;break;case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAllSounds",value:function(){var e=Object(s.a)(o.a.mark(function e(t,n){var r,a,i,s,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return 5e4,r=void 0,a=void 0,this.cache.useMonthly&&(r=this.cache.toBlock,a=this.cache.fromBlock),i=[],s=new Date,e.next=8,this.getSoundsFromBlock(a,r);case 8:return i=e.sent,c=new Date,c.getTime()-s.getTime(),e.abrupt("return",i);case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOldSequence",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(r,a){var i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new R.a(n.ethAddress).select("user").select("ipfsHash").select("title").where("ipfsHash",t).from(M.hb),e.next=3,i.executeQuery();case 3:s=e.sent,r(s.map(function(e){return{user:e.user,previousSequence:"0x0",newSequence:e.ipfsHash,diff:"0x0",title:e.title,blockNumber:e.blockNumber,edits:0}}));case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPrivateSequences",value:function(){var e=Object(s.a)(o.a.mark(function e(t,n){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.getAccount();case 2:if(void 0!==(r=e.sent)){e.next=5;break}return e.abrupt("return",[]);case 5:return e.next=7,this.encryption.getEncryptedSequenceIfAny(void 0,r,t,n);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNewSequence",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(a,i){var s,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=new R.a(n.sequencesContractAddress).select("user").select("previousSequence").select("newSequence").select("diff").select("title").where("newSequence",t).from(M.ib),e.next=3,s.executeQuery();case 3:c=e.sent,a(c.map(function(e){return Object(r.a)({},e,{edits:0})}));case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTokenizedSequence",value:function(){var e=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizedSequences.getSequence(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSequence",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(r,a){var i,s,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getTokenizedSequence(t);case 2:if(!((i=e.sent).length>0)){e.next=6;break}return r(i[0]),e.abrupt("return");case 6:return e.next=8,n.getOldSequence(t);case 8:if(!((s=e.sent).length>0)){e.next=12;break}return r(s[0]),e.abrupt("return");case 12:return e.next=14,n.getNewSequence(t);case 14:if(!((c=e.sent).length>0)){e.next=18;break}return r(c[0]),e.abrupt("return");case 18:r("");case 19:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"favoriteSound",value:function(e){return new Promise(function(){var t=Object(s.a)(o.a.mark(function t(n,r){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(h.a.isLoggedIn()){t.next=3;break}return n(),t.abrupt("return");case 3:e=J(e),new m.a(v.f,"favoriteSample",[e]).execute().then(function(e){return n(e)});case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"unfavoriteSound",value:function(e){return new Promise(function(){var t=Object(s.a)(o.a.mark(function t(n,r){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(h.a.isLoggedIn()){t.next=3;break}return n(),t.abrupt("return");case 3:e=J(e),new m.a(v.f,"unfavoriteSample",[e]).execute().then(function(e){return n(e)});case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"saveNewSequence",value:function(e,t,n,r,a){var i=this;return new Promise(function(){var c=Object(s.a)(o.a.mark(function s(c,u){return o.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:i.tokenizedSequences.saveNewSequence(e,t,n,r,a);case 1:case"end":return o.stop()}},s)}));return function(e,t){return c.apply(this,arguments)}}())}},{key:"getNewSequences",value:function(e,t,n){var a=this;!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise(function(){var i=Object(s.a)(o.a.mark(function i(s,c){var u,l;return o.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return u=new R.a(a.sequencesContractAddress).select("user").select("previousSequence").select("newSequence").select("diff").select("title").fromBlock(t).toBlock(n).from(M.ib),void 0!==e&&u.where("user",e),i.prev=2,i.next=5,u.executeQuery();case 5:(l=i.sent).reverse(),l.sort(function(e,t){return t.blockNumber-e.blockNumber}),s(l.map(function(e){return Object(r.a)({},e,{edits:0})})),i.next=14;break;case 11:i.prev=11,i.t0=i.catch(2),s([]);case 14:case"end":return i.stop()}},i,null,[[2,11]])}));return function(e,t){return i.apply(this,arguments)}}())}},{key:"getOldSequences",value:function(e,t,n){var r=this;return new Promise(function(){var a=Object(s.a)(o.a.mark(function a(i,s){var c,u;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=new R.a(r.ethAddress).select("user").select("ipfsHash").fromBlock(t).toBlock(n).select("title").from(M.hb),void 0!==e&&c.where("user",e),a.prev=2,a.next=5,c.executeQuery();case 5:(u=a.sent).reverse(),u=u.map(function(e){return{user:e.user,previousSequence:"0x0",newSequence:e.ipfsHash,diff:"0x0",title:e.title,blockNumber:e.blockNumber,edits:0}}),i(u),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(2),i([]);case 14:case"end":return a.stop()}},a,null,[[2,11]])}));return function(e,t){return a.apply(this,arguments)}}())}},{key:"getSequences",value:function(e,t,n){var r=this;return new Promise(function(){var t=Object(s.a)(o.a.mark(function t(n,a){var i,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.tokenizedSequences.getSequences(e);case 2:return t.sent,t.next=5,r.getNewSequences(e);case 5:return i=t.sent,t.next=8,r.getOldSequences(e);case 8:s=t.sent,n(i.concat(s));case 10:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getHeadSequence",value:function(e,t){return t in e?this.getHeadSequence(e,e[t]):t}},{key:"collapseAllSequences",value:function(e){var t=this,n=new Set,a=[],i={};return e.forEach(function(o){if("0x0"!==o.previousSequence&&o.previousSequence!==o.newSequence&&(n.add(o.previousSequence),i[o.previousSequence]=o.newSequence),!n.has(o.newSequence)){var s=t.getEditsForSequence(o.newSequence,e);a.push(Object(r.a)({},o,{edits:s.length-1}))}}),a}},{key:"getEditsForSequence",value:function(e,t){for(var n=[],r=this.getPreviousSequence(e,t);void 0!==r;){n.push(r);var a=this.getPreviousSequence(r.previousSequence,t);if(void 0===a||a.newSequence===r.newSequence)break;r=a}return n}},{key:"getPreviousSequence",value:function(e,t){var n=void 0;for(var r in t)t[r].newSequence===e&&(n=t[r]);return n}},{key:"tagSample",value:function(){var e=Object(s.a)(o.a.mark(function e(t,n){var r,a=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:0,e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(a,i){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=J(t),n=U(n),new m.a(v.j,"setSampleTag",[t,n,r]).execute().then(function(){return a()});case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"newSampleWithMetadata",value:function(){var e=Object(s.a)(o.a.mark(function e(t,n,r,a,i,c,u){var f,h=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f=h.length>7&&void 0!==h[7]?h[7]:this.guildId,e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(s,h){var p,d;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p=l.a.utils.padLeft("0x0",64),void 0===a&&(a=[]),a.length<4)for(d=a.length;d<4;d++)a.push(null);a=a.map(function(e){return null===e?p:l.a.utils.fromAscii(e)}),i=i.map(function(e){return null===e?p:l.a.utils.fromAscii(e)}),c=null===c?p:l.a.utils.fromAscii(c),r=null===r?p:l.a.utils.fromAscii(r),t=J(t),new m.a(v.j,"newSampleWithMetadata",[t,n,r,a,i,c,null===u?0:u,0,p,f]).execute().then(function(){return s()});case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e,this)}));return function(t,n,r,a,i,o,s){return e.apply(this,arguments)}}()},{key:"splitArray",value:function(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}},{key:"newEncryptedSamples",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r,a=this,i=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:this.guildId,r=i.length>2?i[2]:void 0,e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(i,s){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("new encrypted samples"),a.splitArray(t,16).forEach(function(e){return a.newEncryptedSamples16(e,n,r)});case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"newEncryptedSamples16",value:function(e,t,n){return new Promise(function(){var r=Object(s.a)(o.a.mark(function r(a,i){var s;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:s=H(e),console.log("arguments=",s),new m.a(v.j,"newEncryptedSamples",[s.sampleHashes,s.titles,s.videoIds,s.coverArts,s.discogsIds,s.tags,s.styles,s.countries,s.years,t,n.convertForEthereum(),n.getPublicKeyAsBytes32()]).execute().then(function(){return a()});case 3:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}},{key:"newSamplesWithMetadata",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r=this,a=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:this.guildId,e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(a,i){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.splitArray(t,16).forEach(function(e){return r.newSamplesWithMetadata16(e,n)});case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"newSamplesWithMetadata16",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n,r=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:this.guildId,e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(r,a){var i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=H(t),console.log("new samples with metadata",t,i),console.log("args =",i),new m.a(v.j,"newSamplesWithMetadata",[i.sampleHashes,i.titles,i.videoIds,i.coverArts,i.discogsIds,i.tags,i.styles,i.countries,i.years,n]).execute().then(function(){return r()});case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}());console.log("initialized ethereum"),t.a=G;var W=l.a.utils.padLeft("0x0",64),K=function(e){for(;e.length<4;)e.push(W);return e.slice(0,4)}}).call(this,n(27).Buffer)},function(e,t,n){"use strict";var r=n(26),a=n(2),i=function e(t,n){Object(a.a)(this,e),this.event=t,this.topics=n;for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];this.data=i},o=n(4),s=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Object(a.a)(this,e),this.name=t,this.type=n,this.size=64*r}return Object(o.a)(e,[{key:"convertTo",value:function(e){if(void 0!==e&&null!==e)return this.type.convertTo(e)}},{key:"convertFrom",value:function(e){if(void 0!==e&&null!==e)return this.type.convertFrom(e)}}]),e}();n.d(t,"cb",function(){return c}),n.d(t,"bb",function(){return u}),n.d(t,"fb",function(){return l}),n.d(t,"X",function(){return f}),n.d(t,"gb",function(){return h}),n.d(t,"hb",function(){return p}),n.d(t,"Y",function(){return d}),n.d(t,"B",function(){return m}),n.d(t,"n",function(){return v}),n.d(t,"C",function(){return b}),n.d(t,"Z",function(){return g}),n.d(t,"eb",function(){return y}),n.d(t,"ib",function(){return k}),n.d(t,"ob",function(){return O}),n.d(t,"P",function(){return j}),n.d(t,"q",function(){return w}),n.d(t,"s",function(){return E}),n.d(t,"t",function(){return S}),n.d(t,"u",function(){return P}),n.d(t,"e",function(){return x}),n.d(t,"p",function(){return T}),n.d(t,"c",function(){return C}),n.d(t,"G",function(){return N}),n.d(t,"F",function(){return R}),n.d(t,"O",function(){return M}),n.d(t,"N",function(){return A}),n.d(t,"A",function(){return q}),n.d(t,"i",function(){return D}),n.d(t,"T",function(){return I}),n.d(t,"W",function(){return _}),n.d(t,"db",function(){return F}),n.d(t,"d",function(){return L}),n.d(t,"w",function(){return B}),n.d(t,"v",function(){return z}),n.d(t,"r",function(){return V}),n.d(t,"pb",function(){return H}),n.d(t,"lb",function(){return U}),n.d(t,"jb",function(){return J}),n.d(t,"kb",function(){return G}),n.d(t,"mb",function(){return W}),n.d(t,"nb",function(){return K}),n.d(t,"m",function(){return X}),n.d(t,"y",function(){return Q}),n.d(t,"k",function(){return Y}),n.d(t,"j",function(){return Z}),n.d(t,"x",function(){return $}),n.d(t,"z",function(){return ee}),n.d(t,"o",function(){return te}),n.d(t,"U",function(){return ne}),n.d(t,"V",function(){return re}),n.d(t,"b",function(){return ae}),n.d(t,"h",function(){return ie}),n.d(t,"ab",function(){return oe}),n.d(t,"g",function(){return se}),n.d(t,"f",function(){return ce}),n.d(t,"K",function(){return ue}),n.d(t,"D",function(){return le}),n.d(t,"L",function(){return fe}),n.d(t,"qb",function(){return he}),n.d(t,"H",function(){return pe}),n.d(t,"l",function(){return de}),n.d(t,"J",function(){return me}),n.d(t,"rb",function(){return ve}),n.d(t,"a",function(){return be}),n.d(t,"M",function(){return ge}),n.d(t,"E",function(){return ye}),n.d(t,"Q",function(){return ke}),n.d(t,"S",function(){return Oe}),n.d(t,"R",function(){return je}),n.d(t,"I",function(){return we});var c=new i("SampleTagged(bytes32,bytes32,uint32)",[new s("ipfsHash",r.i),new s("tag",r.b),new s("guildId",r.g)]),u=new i("SampleStyle(bytes32,bytes32,uint32)",[new s("ipfsHash",r.i),new s("style",r.b),new s("guildId",r.g)]),l=new i("SampleYear(bytes32,int16,uint32)",[new s("ipfsHash",r.i),new s("year",r.f),new s("guildId",r.g)]),f=new i("SampleCountry(bytes32,bytes32,uint32)",[new s("ipfsHash",r.i),new s("country",r.b),new s("guildId",r.g)]),h=new i("SampledYoutube(bytes32,bytes32,uint32)",[new s("ipfsHash",r.i),new s("videoId",r.l),new s("guildId",r.g)]),p=new i("SequenceCreated(address,bytes32,string)",[new s("user",r.a),new s("ipfsHash",r.i)],new s("title",r.m)),d=new i("SampleCreated(address,bytes32,string,uint32)",[new s("user",r.a),new s("ipfsHash",r.i),new s("guildId",r.g)],new s("title",r.m)),m=new i("NewNoteSequence(bytes32,bytes32)",[new s("sampleHash",r.i),new s("noteSequenceHash",r.i)]),v=new i("NewDiscogsSample(bytes32,uint256,bytes32,uint32)",[new s("sampleHash",r.i),new s("coverArtHash",r.i),new s("guildId",r.g)],new s("discogsId",r.n)),b=new i("NewNotesAggregation(bytes32,bytes32,bytes32,uint32,uint32,bytes32)",[new s("sampleHash",r.i),new s("noteA",r.k),new s("noteB",r.k)],new s("startTime",r.g),new s("endTime",r.g),new s("remainingNotes",r.j)),g=new i("SampleFavorited(address,bytes32)",[new s("user",r.a),new s("sampleHash",r.i)]),y=new i("SampleUnfavorited(address,bytes32)",[new s("user",r.a),new s("sampleHash",r.i)]),k=new i("SequenceEdited(address,bytes32,bytes32,bytes32,string)",[new s("user",r.a),new s("previousSequence",r.i),new s("newSequence",r.i)],new s("diff",r.i),new s("title",r.m)),O=new i("SequenceEdited(address,bytes32,bytes32,string,uint32)",[new s("user",r.a),new s("previousSequence",r.i),new s("newSequence",r.i)],new s("title",r.m),new s("bpm",r.g)),j=new i("PresetTagged(address,bytes32,bytes32,uint32)",[new s("contentHash",r.i),new s("tag",r.b),new s("guildId",r.g)],new s("user",r.a)),w=new i("NewGuild(address,uint32,string)",[new s("user",r.a),new s("guildId",r.g)],new s("name",r.m)),E=new i("NewGuildMemberRequest(address,address,uint32)",[new s("requester",r.a),new s("newMember",r.a),new s("guildId",r.g)]),S=new i("NewGuildMemberRequestAccepted(address,uint32)",[new s("newMember",r.a),new s("guildId",r.g)]),P=new i("NewGuildMemberRequestRejected(address,uint32)",[new s("newMember",r.a),new s("guildId",r.g)]),x=new i("GuildKeyEncrypted(address,uint32,bytes32)",[new s("user",r.a),new s("guildId",r.g),new s("ipfsHash",r.i)]),T=new i("NewEncryptedContent(address,bytes32,bytes32,int8,bytes32,bytes32[9],bytes32[6])",[new s("user",r.a),new s("newContent",r.i),new s("contentType",r.h)],new s("previousContent",r.i),new s("encryptedName",r.d),new s("encryptedContentKey",Object(r.c)(9),9),new s("publicKey",Object(r.c)(6),6)),C=new i("EncryptedContentShared(address,address,bytes32,bytes32[9],bytes32[6])",[new s("sharedWith",r.a),new s("creator",r.a),new s("contentHash",r.i)],new s("encryptedContentKey",Object(r.c)(9),9),new s("publicKey",Object(r.c)(6),6)),N=new i("NewPublicKey(address,bytes32[6])",[new s("user",r.a)],new s("publicKey",Object(r.c)(6),6)),R=new i("NewPreset(address,bytes32,uint32,bytes32,bytes32[9],bytes32[6])",[new s("user",r.a),new s("contentHash",r.i),new s("guildId",r.g)],new s("encryptedName",r.d),new s("encryptedContentKey",Object(r.c)(9),9),new s("publicKey",Object(r.c)(6),6)),M=new i("PresetSample(bytes32,bytes32,uint32)",[new s("contentHash",r.i),new s("sampleHash",r.i),new s("guildId",r.g)]),A=new i("PresetInstrumentType(bytes32,bytes32,uint32)",[new s("contentHash",r.i),new s("instrumentType",r.e),new s("guildId",r.g)]),q=new i("NewMonthlyIndex(bytes32,uint32,uint64)",[new s("month",r.n),new s("year",r.n)],new s("hash",r.i)),D=new i("New2DMapping(bytes32)",[new s("ipfsHash",r.i)]),I=new i("PublicMessageSent(address,address,bytes32,bytes32)",[new s("fromUser",r.a),new s("toUser",r.a),new s("referenceHash",r.i)],new s("messageHash",r.i)),_=new i("SampleCopyStrike(address,bytes32,bytes32)",[new s("user",r.a),new s("sampleHash",r.i),new s("referenceHash",r.i)]),F=new i("SampleTakenDown(bytes32)",[new s("sampleHash",r.i)]),L=new i("FoldersUpdated(address,bytes32)",[new s("user",r.a),new s("foldersHash",r.i)]),B=new i("NewIndex(uint32,bytes32)",[new s("guildId",r.g)],new s("indexHash",r.i)),z=new i("NewGuildSequence(address,bytes32,uint32,bytes32,bytes32,bytes32[9],bytes32[6])",[new s("user",r.a),new s("contentHash",r.i),new s("guildId",r.g)],new s("previousHash",r.i),new s("encryptedName",r.d),new s("encryptedContentKey",Object(r.c)(9),9),new s("publicKey",Object(r.c)(6),6)),V=new i("NewGuildClassification(uint32,bytes32)",[new s("guildId",r.g),new s("contentHash",r.i)]),H=new i("Transfer(address,address,uint256)",[new s("fromUser",r.a),new s("toUser",r.a)],new s("amount",r.g)),U=new i("SequenceTagged(bytes32,bytes32,uint32)",[new s("ipfsHash",r.i),new s("tag",r.b),new s("guildId",r.g)]),J=new i("SequenceFavorited(bytes32,address,uint32)",[new s("ipfsHash",r.i),new s("user",r.a),new s("guildId",r.g)]),G=new i("SequenceStarred(bytes32,address,uint32)",[new s("ipfsHash",r.i),new s("user",r.a),new s("guildId",r.g)]),W=new i("SequenceUnfavorited(bytes32,address,uint32)",[new s("ipfsHash",r.i),new s("user",r.a),new s("guildId",r.g)]),K=new i("SequenceUnstarred(bytes32,address,uint32)",[new s("ipfsHash",r.i),new s("user",r.a),new s("guildId",r.g)]),X=new i("NewDataType(bytes32,string)",[new s("dataType",r.b)],new s("description",r.m)),Q=new i("NewLinkType(bytes32,string)",[new s("linkType",r.b)],new s("description",r.m)),Y=new i("NewAnnotationType(bytes32,string)",[new s("annotationType",r.b)],new s("description",r.m)),Z=new i("NewAnnotation(bytes32,bytes32,bytes32,address)",[new s("annotationType",r.b),new s("data",r.i),new s("address",r.a)],new s("annotationData",r.b)),$=new i("NewLink(bytes32,bytes32,bytes32,address)",[new s("linkType",r.b),new s("fromData",r.i),new s("toData",r.i)],new s("address",r.a)),ee=new i("NewMix(address,bytes32,bytes32,string,uint32)",[new s("user",r.a),new s("mixHash",r.i),new s("previousHash",r.i)],new s("title",r.m),new s("guildId",r.g)),te=new i("NewEffect(address,bytes32,bytes32,string,uint32)",[new s("user",r.a),new s("effectHash",r.i),new s("effectType",r.b)],new s("title",r.m),new s("guildId",r.g)),ne=new i("ReleaseInfo(bytes32,uint32,string,bytes32,bytes32)",[new s("artistName",r.b),new s("releaseId",r.g)],new s("releaseName",r.m),new s("coverArtHash",r.i),new s("releaseType",r.b)),re=new i("SampleByArtist(bytes32,bytes32)",[new s("artistName",r.b),new s("ipfsHash",r.i)]),ae=new i("ArtistInfo(bytes32,bytes32,string)",[new s("artistName",r.b),new s("linkType",r.b)],new s("link",r.m)),ie=new i("MidiCCParameter(bytes32,uint32,bytes32,address)",[new s("deviceName",r.b),new s("ccNumber",r.g),new s("parameterName",r.b)],new s("user",r.a)),oe=new i("SampleInSequence(bytes32,bytes32)",[new s("sequenceHash",r.i),new s("sampleHash",r.i)]),se=new i("ListEdited(bytes32,bytes32,address,bytes32,uint32)",[new s("newContent",r.i),new s("previousContent",r.i),new s("user",r.a)],new s("title",r.b),new s("guildId",r.g)),ce=(new i("ListHighlighted(bytes32,address)",[new s("contentHash",r.i)],new s("user",r.a)),new i("ListUnhighlighted(bytes32,address)",[new s("contentHash",r.i)],new s("user",r.a)),new i("ListFavorited(bytes32,address)",[new s("contentHash",r.i)],new s("user",r.a)),new i("ListUnfavorited(bytes32,address)",[new s("contentHash",r.i)],new s("user",r.a)),new i("ListDeleted(bytes32,address)",[new s("contentHash",r.i),new s("user",r.a)])),ue=new i("NewWallpaper(address,bytes32,bytes32)",[new s("user",r.a),new s("wallpaperHash",r.i),new s("thumbnailHash",r.i)]),le=(new i("DefaultWallpaper(address,bytes32)",[new s("user",r.a),new s("wallpaperHash",r.i)]),new i("NewPack(address,bytes32,bytes32,bytes32)",[new s("user",r.a),new s("packHash",r.i),new s("previousHash",r.i)],new s("title",r.b))),fe=new i("PackHasContent(bytes32,bytes32)",[new s("packHash",r.i),new s("contentHash",r.i)]),he=new i("UserLeftGuild(uint256,address)",[new s("guildId",r.g)],new s("user",r.a)),pe=new i("NewScript(address,bytes32,bytes32,bytes32)",[new s("user",r.a),new s("scriptHash",r.i),new s("scriptType",r.b)],new s("title",r.b)),de=new i("NewCreatorProject(address,uint256,bytes32,uint256,string)",[new s("creator",r.a),new s("projectId",r.n),new s("contentHash",r.i)],new s("maxInvocations",r.n),new s("title",r.m)),me=new i("NewTokenSeed(uint256,uint256,bytes32)",[new s("projectId",r.n),new s("tokenId",r.n)],new s("seedHash",r.b)),ve=new i("ZoraProject(bytes32,uint256)",[new s("projectHash",r.i),new s("zoraId",r.n)]),be=new i("AccountAuthorized(address,address,string,uint8,bytes32,bytes32)",[new s("zequencerAddress",r.a),new s("walletAddress",r.a)],new s("message",r.m),new s("v",r.h),new s("r",r.d),new s("s",r.d)),ge=new i("PluginCreated(uint256,address,string)",[new s("tokenId",r.n),new s("creator",r.a)],new s("name",r.m)),ye=new i("NewPluginVersion(uint256,uint256,bytes32,string)",[new s("tokenId",r.n),new s("versionNumber",r.n)],new s("pluginContentHash",r.i),new s("pluginMetadataURI",r.m)),ke=new i("ProjectHasArrangement(bytes32)",[],new s("projectHash",r.i)),Oe=(new i("ProjectBPM(bytes32,int16)",[],new s("projectHash",r.i),new s("bpm",r.n)),new i("ProjectVisuals(bytes32,bytes32)",[],new s("projectHash",r.i),new s("thumbnailhash",r.i))),je=new i("ProjectUsesPreset(bytes32,bytes32)",[],new s("projectHash",r.i),new s("presetHash",r.i)),we=(new i("ProjectPatternsCount(bytes32,int8)",[],new s("projectHash",r.i),new s("patterns",r.n)),new i("NewSporeCreated(uint256,uint256,address,address,bytes32)",[],new s("sporeId",r.n),new s("tokenId",r.n),new s("proxy",r.a),new s("creator",r.a),new s("sporeHash",r.i)))},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e,t,n){if(!e)return n;var r=e.set(t,!0,!0);if(r){var a=r.id,i=r.value;n[a]=i}else n[e.id]=t;return n}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(15),o=n.n(i),s=n(128),c=new o.a.Time("16n"),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(r.a)(this,e),this.resolution=t,this.isTriplet=n,this.baseResolution=n?48:32}return Object(a.a)(e,[{key:"getTripletOrNonTriplet",value:function(){return this.isTriplet?new e(this.resolution,!1):new e(this.resolution,!0)}},{key:"equals",value:function(e){return this.resolution===e.resolution&&this.isTriplet===e.isTriplet}},{key:"getOffset",value:function(){return this.baseResolution/this.numSteps()}},{key:"getLengthAtResolution",value:function(e){return e*(this.numSteps()/this.baseResolution)}},{key:"getNumberOfStepsAtBaseResolution",value:function(){var e=this.baseResolution/this.numSteps();return this.isTriplet?e*(16/24):e}},{key:"getTimeInStep",value:function(){return this.isTriplet?new o.a.Time(this.resolution+"t"):new o.a.Time(this.resolution+"n")}},{key:"getDurationOfStep",value:function(){return this.getTimeInStep().toMilliseconds()/new c.toMilliseconds}},{key:"numSteps",value:function(){return this.isTriplet?this.resolution/32*48:this.resolution}},{key:"toString",value:function(){return this.isTriplet?this.resolution+"t":this.resolution}},{key:"transformList",value:function(e,t){for(var n=(t=t||this.baseResolution)/this.numSteps(),r=[],a=0;a<e.length;a+=n)r.push(e[a]);return r}},{key:"transformBucketsIntoSteps",value:function(e){for(var t=this.baseResolution/this.numSteps(),n=[],r=0;r<e.length;r+=t){for(var a=16,i=null,o=0;o<t;o++){var s=e[r+o];if(void 0===s)break;var c=s.steps;for(var u in c)u<a&&c[u].on&&(a=u,i=o)}null==i&&(i=0,a=0),n.push(e[r+i].getStep(a))}return n}},{key:"transformBucketsAtResolution",value:function(e,t,n,r,a){if(this.isTriplet==t.isTriplet)return this.transformList(e,t);var i=e.length*this.numSteps()/t.numSteps(),o=e[0].track,c=a||[];if(void 0===a)for(var u=0;u<i;u++){var l=new s.a(o,this.isTriplet);c.push(l)}void 0===r&&(r=e.length),void 0===n&&(n=0);for(var f=n;f<r;f++)for(var h in e[f].steps){var p=(f+parseFloat(h))*this.numSteps()/t.numSteps(),d=Math.floor(p),m=p-d,v=c[d];void 0!==v&&(v.setStep(m,e[f].getStep(h)),c[d]=v)}return c}},{key:"transformStepAtResolution",value:function(e,t){return e*(this.baseResolution/this.numSteps())*this.numSteps()/t.numSteps()}},{key:"transformStepAtResolution2",value:function(e,t){return e*this.numSteps()/t.numSteps()}},{key:"transformStepAtBaseResolution",value:function(t){return t*new e(32,!1).numSteps()/this.numSteps()}},{key:"transformStepFromBaseResolution",value:function(e){return this.transformStepAtResolution2(e,l)}},{key:"getJson",value:function(){return{resolution:this.resolution,baseResolution:this.baseResolution,isTriplet:this.isTriplet}}},{key:"fromJson",value:function(e){return this.resolution=e.resolution,this.baseResolution=e.baseResolution,this.isTriplet=e.isTriplet,this}},{key:"getCopy",value:function(){return new e(this.resolution,this.isTriplet)}}]),e}(),l=new u(32,!1);t.a=u},function(e,t,n){"use strict";n.d(t,"Eb",function(){return r}),n.d(t,"ib",function(){return a}),n.d(t,"S",function(){return i}),n.d(t,"Tb",function(){return o}),n.d(t,"G",function(){return s}),n.d(t,"F",function(){return c}),n.d(t,"H",function(){return u}),n.d(t,"Nb",function(){return l}),n.d(t,"Gb",function(){return f}),n.d(t,"Pb",function(){return h}),n.d(t,"Lb",function(){return p}),n.d(t,"Sb",function(){return d}),n.d(t,"Ob",function(){return m}),n.d(t,"Kb",function(){return v}),n.d(t,"a",function(){return b}),n.d(t,"Qb",function(){return g}),n.d(t,"Rb",function(){return y}),n.d(t,"Jb",function(){return k}),n.d(t,"N",function(){return O}),n.d(t,"A",function(){return j}),n.d(t,"Q",function(){return w}),n.d(t,"D",function(){return E}),n.d(t,"v",function(){return S}),n.d(t,"gb",function(){return P}),n.d(t,"y",function(){return x}),n.d(t,"w",function(){return T}),n.d(t,"x",function(){return C}),n.d(t,"t",function(){return N}),n.d(t,"u",function(){return R}),n.d(t,"p",function(){return M}),n.d(t,"hb",function(){return A}),n.d(t,"J",function(){return q}),n.d(t,"T",function(){return D}),n.d(t,"r",function(){return I}),n.d(t,"q",function(){return _}),n.d(t,"V",function(){return F}),n.d(t,"s",function(){return L}),n.d(t,"xb",function(){return B}),n.d(t,"jb",function(){return z}),n.d(t,"vb",function(){return V}),n.d(t,"yb",function(){return H}),n.d(t,"ob",function(){return U}),n.d(t,"Mb",function(){return J}),n.d(t,"Bb",function(){return G}),n.d(t,"h",function(){return W}),n.d(t,"E",function(){return K}),n.d(t,"P",function(){return X}),n.d(t,"eb",function(){return Q}),n.d(t,"fb",function(){return Y}),n.d(t,"mb",function(){return Z}),n.d(t,"db",function(){return $}),n.d(t,"Ub",function(){return ee}),n.d(t,"kb",function(){return te}),n.d(t,"wb",function(){return ne}),n.d(t,"i",function(){return re}),n.d(t,"j",function(){return ae}),n.d(t,"k",function(){return ie}),n.d(t,"n",function(){return oe}),n.d(t,"e",function(){return se}),n.d(t,"c",function(){return ce}),n.d(t,"b",function(){return ue}),n.d(t,"O",function(){return le}),n.d(t,"B",function(){return fe}),n.d(t,"C",function(){return he}),n.d(t,"g",function(){return pe}),n.d(t,"d",function(){return de}),n.d(t,"f",function(){return me}),n.d(t,"Wb",function(){return ve}),n.d(t,"m",function(){return be}),n.d(t,"l",function(){return ge}),n.d(t,"nb",function(){return ye}),n.d(t,"lb",function(){return ke}),n.d(t,"L",function(){return Oe}),n.d(t,"Vb",function(){return je}),n.d(t,"Ib",function(){return we}),n.d(t,"Hb",function(){return Ee}),n.d(t,"Xb",function(){return Se}),n.d(t,"pb",function(){return Pe}),n.d(t,"qb",function(){return xe}),n.d(t,"Cb",function(){return Te}),n.d(t,"Db",function(){return Ce}),n.d(t,"R",function(){return Ne}),n.d(t,"o",function(){return Re}),n.d(t,"I",function(){return Me}),n.d(t,"M",function(){return Ae}),n.d(t,"Fb",function(){return qe}),n.d(t,"zb",function(){return De}),n.d(t,"Ab",function(){return Ie}),n.d(t,"U",function(){return _e}),n.d(t,"rb",function(){return Fe}),n.d(t,"ub",function(){return Le}),n.d(t,"tb",function(){return Be}),n.d(t,"sb",function(){return ze}),n.d(t,"W",function(){return Ve}),n.d(t,"ab",function(){return He}),n.d(t,"Z",function(){return Ue}),n.d(t,"Y",function(){return Je}),n.d(t,"bb",function(){return Ge}),n.d(t,"X",function(){return We}),n.d(t,"K",function(){return Ke}),n.d(t,"cb",function(){return Xe}),n.d(t,"z",function(){return Qe});var r="STEP",a="PLAYHEAD_DIRECTION_BUTTON",i="MODULATOR_CONTROL",o="TRACK_THUMBNAIL",s="FILTER_BY_DAY_TAG",c="FILTER_BY_DAY",u="FILTER_BY_TAG",l="TRACK_PIANO_ROLL_BUTTON",f="TRACK_ADD_STEPS_BUTTON",h="TRACK_REMOVE_STEPS_BUTTON",p="TRACK_MUTE_BUTTON",d="TRACK_SOLO_BUTTON",m="TRACK_RECORD_ARM_BUTTON",v="TRACK_MIDI_DROPDOWN",b="ADD_EFFECTS_BUTTON",g="TRACK_SEND_A_SLIDER",y="TRACK_SEND_B_SLIDER",k="TRACK_LOCK_BUTTON",O="LFOS_BUTTON",j="ENVELOPES_BUTTON",w="LFO_TOGGLE_BUTTON",E="ENVELOPE_TOGGLE_BUTTON",S="EFFECT_PARAMETER",P="PARAMETER_VALUE",x="EFFECT_TOGGLE_BUTTON",T="EFFECT_PRESETS_BUTTON",C="EFFECT_RETURN_PRESETS_BUTTON",N="EFFECT_COLLAPSE_BUTTON",R="EFFECT_DELETE_BUTTON",M="CURRENT_PATTERN_BUTTON",A="PATTERN_BUTTON",q="GO_BACK_HOME",D="NEW_PATTERN_BUTTON",I="DELETE_PATTERN_BUTTON",_="CURRENT_SUB_SEQUENCE_BUTTON",F="NEW_SUB_SEQUENCE_BUTTON",L="DELETE_SUB_SEQUENCE_BUTTON",B="RESOLUTION_DROPDOWN",z="PLAY_BUTTON",V="RECORD_BUTTON",H="ROLL_BUTTON",U="QUANTIZE_BUTTON",J="TRACK_PARAMETERS",G="SELECTOR_WAVEFORM",W="ARRANGEMENT_LOOP_BUTTON",K="ENVELOPE_TRACK_DROPDOWN",X="LFO_MAX_SLIDER",Q="PARAMETERIZER_FACTOR",Y="PARAMETERIZER_OFFSET",Z="PROBABILITY",$="PARAMETERIZER_DROPDOWN",ee="TRANSCRIBE",te="PLAY_MIX_BUTTON",ne="RECORD_MIX_BUTTON",re="AUDITION_BUTTON",ae="AUDITION_NEXT",ie="AUDITION_PREVIOUS",oe="BROWSE_SOUNDS",se="ADD_MULTI_SYNTH_BUTTON",ce="ADD_FM_SYNTH_BUTTON",ue="ADD_EXTERNAL_INSTRUMENT_BUTTON",le="LFO_COMPONENT",fe="ENVELOPE_COMPONENT",he="ENVELOPE_TOGGLE",pe="ADD_SOUNDS_BUTTON",de="ADD_INSTRUMENTS_BUTTON",me="ADD_SEQUENCES_BUTTON",ve="VIEW_DROPDOWN",be="BPM_SLIDER",ge="BPM_LOCK",ye="PUBLIC_SAVE",ke="PRIVATE_SAVE",Oe="GUILDS_SELECTOR",je="UNFREEZE_BUTTON",we="TRACK_LENGTH_BUTTON",Ee="TRACK_DELETE_BUTTON",Se="WARP_BUTTON",Pe="QUICK_ADD_BUTTON",xe="QUICK_ADD_INSTRUMENT_BUTTON",Te="SIDEBAR_SEARCH",Ce="SOUNDS_SEARCH",Ne="METRONOME_BUTTON",Re="CHOOSE_INSTRUMENT_PRESET",Me="FILTER_INSTRUMENT_TAG",Ae="INSTRUMENT_FX_LOAD",qe="SYNTH_ENVELOPE",De="SELECTOR_GRID_VIEW",Ie="SELECTOR_LIST_VIEW",_e="NEW_RACK_CONFIGURATION",Fe="RACK_CONFIGURATION_OPTION",Le="RACK_NODE_OUTPUT",Be="RACK_NODE_INPUT",ze="RACK_MODULATOR_OUTPUT",Ve="PADS_DELETE_BUTTON",He="PADS_SLOT_EMPTY",Ue="PADS_SLOT",Je="PADS_MUTES_BUTTON",Ge="PADS_WAVEFORM_BUTTON",We="PADS_LENGTH_BUTTON",Ke="GO_TO_PAD_SEQUENCER",Xe="PAD_FX",Qe={STEP:["Click to toggle on/off. ","\u2318+click or Alt+click to view step's parameters. Drag the right edge to change it's duration.","Type shift to hide the parameters."],TRACK:"An audio track. Click to select the track. And press a key to map the key to the selected track.",TRACK_THUMBNAIL:"Click to view details for this track.",TRACK_EFFECTS_BUTTON:"Click to show the effects for this track.",TRACK_PIANO_ROLL_BUTTON:"Click to show a piano roll at the bottom.",TRACK_ADD_STEPS_BUTTON:"Click to double the length of steps in this track.",TRACK_REMOVE_STEPS_BUTTON:"Click to half the length of steps in this track.",TRACK_MUTE_BUTTON:"Click to mute/unmute the track.",TRACK_SOLO_BUTTON:"Click to solo/un-solo the track. When soloed, you will only hear this track's output",TRACK_RECORD_ARM_BUTTON:"Click to arm this track. When armed (red), you can play this track like a keyboard, by using your computer keyboard or a midi controller.",TRACK_MIDI_DROPDOWN:"Specify what inputs can control this track when the record arm button is enabled. By default, the computer keyboard and MIDI controllers are enabled.",ADD_EFFECTS_BUTTON:"Click to add effects to this track.",TRACK_SEND_A_SLIDER:'Controls the level of output from this track that goes to "Send A". "Send A" by default is a reverb.',TRACK_SEND_B_SLIDER:'Controls the level of output from this track that goes to "Send B". "Send B" by default is a delay.',TRACK_LOCK_BUTTON:"Click to lock/unlock this track's parameters to this pattern. A track can be locked with respect to specific pattern. Any parameter changes made to a locked track are specific to that pattern.",LFOS_BUTTON:"Click to edit the project-wide LFOs",ENVELOPES_BUTTON:"Click to edit the project-wide envelopes",LFO_TOGGLE_BUTTON:"Click to control this parameter with one of the project-wide LFOs",ENVELOPE_TOGGLE_BUTTON:"Click to control this parameter with one of the project-wide envelopes",EFFECT_PARAMETER:"Click the parameter name to display the LFOs/Envelopes that can control this parameter.",EFFECT_TOGGLE_BUTTON:"Click the toggle the effect on/off.",EFFECT_COLLAPSE_BUTTON:"Click to collapse/uncollapse the effect.",EFFECT_DELETE_BUTTON:"Click to delete this effect.",EFFECT_PRESETS_BUTTON:"Click to view presets for this effect.",EFFECT_RETURN_PRESETS_BUTTON:"Click to return to the effect view.",ADD_SOUND_BUTTON:"Click to view sound. Click again, or drag, to add to the project.",PARAMETER_MODS_BUTTON:"Click to fine-tune the LFO/Envelope modulations (if any) for this effect.",CURRENT_SUB_SEQUENCE_BUTTON:"Click to go to this sub-sequence. ",NEW_SUB_SEQUENCE_BUTTON:"Click to create a new sub-sequence.",DELETE_SUB_SEQUENCE_BUTTON:"Click to delete the current sub-sequence.",CURRENT_PATTERN_BUTTON:"The current pattern of this project.",PATTERN_BUTTON:"Click to switch to another pattern",NEW_PATTERN_BUTTON:"Click to create a new pattern, copied from the current pattern.",DELETE_PATTERN_BUTTON:"Click to delete the current pattern.",RESOLUTION_DROPDOWN:"Specify the step resolution of the step sequencer. For example, you can view the steps in triplets.",PLAY_BUTTON:"Click to play the project in pattern mode.",RECORD_BUTTON:"Click to toggle recording. When recording, anything triggered via the computer-keyboard/midi controller will be recorded into the pattern.",ROLL_BUTTON:'Click to enable "roll". When enabled, you can trigger tracks in time with the selected resolution of the project.',QUANTIZE_BUTTON:"Turns on/off quantizing for recording. When quantized, recorded triggers will snap to the grid (according to the resolution).",AND_TAG_BUTTON:"Sounds must contain this tag, along with any other red colored tags. Click to unselect this tag.",OR_TAG_BUTTON:"Sounds may contain this tag. Click to unselect this tag.",SELECTOR_TAG_BUTTON:"Click to filter by this tag.",SELECTOR_CATEGORY_BUTTON:"Click to filter by this category of tags.",TRACK_PARAMETERS:"All steps on this track are by default set to these parameters. Changing the parameter for a specific step overrides that default for that step.",TRACK_WAVEFORM:'Drag the markers to set the start/end of the slice. You can also select a new region and click "Add Slice" to create additional slices from this sample.',SELECTOR_WAVEFORM:"Click to listen to the sample. Drag to make a selection (which you can then add to the project)",DETAIL_VIEW_HAS_SELECTED_SLICE:"Press a key to map the selected slice to a key. You can also click on the graphical keyboard on this page to map this.",GRAPHICAL_KEYBOARD:"Shows what keys are mapped to what sounds and slices. Click on a mapped key to unmap it. Click on an unmapped key to map it to the selected slice for this track",ENVELOPE_TRACK_DROPDOWN:"Specify which track will trigger this envelope.",MODULATOR_CONTROL:"Controls the min and max values that the modulator controls this parameter by",LFO_MIN_SLIDER:"Controls the minimum value that LFO oscillators from at the given rate",LFO_MAX_SLIDER:"Controls the maximum value that LFO oscillators to at the given rate",PARAMETERIZER_FACTOR:"Multiplies the chosen parameter`s value by this factor, everytime the track triggers",PARAMETERIZER_OFFSET:"Sums the chosen parameter`s value with this offset, everytime the track triggers.",PROBABILITY:"Controls the probability rate which this MIDI effect will apply. I.E. 100% means it always applies ",PARAMETERIZER_DROPDOWN:"Specifiy the parameter which this effect will apply to.",RESAMPLE:"Resamples this track's pattern (including effects), creating a new track with the recorded sample",TRANSCRIBE:"Transcribes the midi notes for this sample, creating a new External Instrument track with the transcribed midi notes (takes a few seconds to run).",PLAY_MIX_BUTTON:"Plays a recorded arrangement (if there is one)",RECORD_MIX_BUTTON:"Record an arrangement, so that all pattern switches, parameter changes are recorded and can be played back.",ARRANGEMENT_LOOP_BUTTON:"Toggles looping for an arrangement, with the start and end points in the arrangement view",AUTOMATION_BUTTON:"When clicked, and the RECORD button at the bottom is turned on, any automation changes made within a pattern are recorded to that pattern. To delete the automations, hold down the / key",AUDITION_BUTTON:"Audition this sample, replacing the current sample in the selected track with it.",CONVOLVER_BUTTON:"Replace a convolver reverb's impulse sample with this sample",LAYER_BUTTON:"Add this sample to the selected track, so that multiple samples can be triggered by one track.",ADD_SYNTH_BUTTON:"Click to add a simple synth to the project",ADD_MULTI_SYNTH_BUTTON:"Click to add a multi-oscillator synth to the project",ADD_FM_SYNTH_BUTTON:"Click to add an FM synth to the project",ADD_EXTERNAL_INSTRUMENT_BUTTON:"Click to add an external instrument to the project. This can control midi devices connected to your computer, including hardware synths",ADD_PRESET_BUTTON:"Click to add this preset to your project",LFO_COMPONENT:"An LFO oscillates between minimum and maximum values, at a constant rate. You can connect parameters to an LFO to modulate its value",ENVELOPE_COMPONENT:"An envelope is triggered any time its connected track has triggered. When triggered, it can control parameter values according to the ASDR (attack, sustain, decay, release) of the envelope.",ADD_ALL_SOUNDS_BUTTON:"Click to select sounds, instruments, presets, and/or sequences to load into the project.",ADD_SOUNDS_BUTTON:"Click to search for and load sounds into your project.",ADD_INSTRUMENTS_BUTTON:"Click to add instruments (e.g. synths) into your project.",ADD_PRESETS_BUTTON:"Click to add saved presets into your project.",ADD_SEQUENCES_BUTTON:"Click to search for and load saved projects.",VIEW_DROPDOWN:"Go to other views, like the mix view",BPM_SLIDER:"Set the BPM (i.e. the tempo) of the project",SWING_SLIDER:"Set the swing of the project.",BPM_LOCK:"Lock/unlock the pattern BPM. This allows different patterns to have different BPMs",PUBLIC_SAVE:"Saves the sequence publicly-- without encryption-- so anyone can see",PRIVATE_SAVE:"Saves the sequence encrypted, so that only you can see (with a password)",PARAMETER_VALUE:"Click to edit the parameter value",PRESET_FOLDERS:"Choose ready-to-go presets to add to your track (by double-clicking the item).",GUILDS_SELECTOR:"Chooses the selected Guild. When selected, only show samples, presets, sequences from that Guild.",FREEZE_BUTTON:"Click to freeze all the patterns for this track. This will free up your CPU.",UNFREEZE_BUTTON:"Click to unfreeze this track, back to its original settings.",TRACK_LENGTH_BUTTON:"Click to choose the length for this track.",TRACK_DELETE_BUTTON:"Click to delete this track from your project.",WARP_BUTTON:"Click to warp this track, syncing it's tempo to the project's tempo.",QUICK_ADD_BUTTON:function(e){return"Click to add a random ".concat(e," sample to your project.")},QUICK_ADD_INSTRUMENT_BUTTON:function(e){return"Click to add a blank ".concat(e," track to your project.")},FILTER_BY_DAY:"Click to filter sounds by adding on this day.",FILTER_BY_DAY_TAG:function(e){return["Click to filter sounds by a tag sampled on this day.",e]},FILTER_BY_TAG:function(e){return'Click to search for all "'.concat(e,'" sounds.')},PLAYHEAD_DIRECTION_BUTTON:"Click to select the playhead's direction-mode for this track",BROWSE_SOUNDS:"Click to browse through related sounds for this track.",ENVELOPE_TOGGLE:function(e){return"Click to toggle Envelope ".concat(e," to be triggered by this track. ")},SIDEBAR_SEARCH:"Type to search for samples, effects and presets. Results will appear below that you can click to add.",SOUNDS_SEARCH:"Type to search for sounds by tag or title.",METRONOME_BUTTON:"Click to turn on/off the metronome.",CHOOSE_INSTRUMENT_PRESET:"Click to load this preset into the currently selected track",FILTER_INSTRUMENT_TAG:function(e){return'Click to filter presets by the "'.concat(e,'" tag')},INSTRUMENT_FX_LOAD:["Toggles whether we should load the effects from the any presets","When toggled, the preset's effects will replace the current effects"],INSTRUMENT_MODS_LOAD:["Toggles whether we should load the modulators from the any presets","When toggled, the preset's modulators will replace the current modulator configuration."],OPERATOR_HARMONICITY_MODULATION:function(e){return"Controls the harmonicity (x-axis) and modulation (y-axis) of operator ".concat(e)},SYNTH_ENVELOPE:function(e){return"Controls the attack, decay, sustain, release of ".concat(e)},SELECTOR_GRID_VIEW:"Click to view samples by day, in a grid",SELECTOR_LIST_VIEW:"Click to view samples as a list",RACK_CONFIGURATION_OPTION:"Choose the routing configuration (i.e. how the effects are connected) for this rack",NEW_RACK_CONFIGURATION:["Create a new routing configuration (i.e. how the effects are connected) for this rack","Copies the current routing."],RACK_NODE_OUTPUT:"Drag from here to another effect to connect them.",RACK_NODE_INPUT:"Drag to here from another effect to connect them.",RACK_MODULATOR_OUTPUT:"Drag from here to an effect parameter to modulate that parameter.",PADS_DELETE_BUTTON:["Toggle delete mode","When in delete mode, hold down track to delete steps"],PADS_SLOT_EMPTY:"Drag tracks and samples here to assign to pad",PADS_SLOT:"Change volume of track by sliding mouse",PADS_MUTES_BUTTON:["Toggle mute mode","When in mute mode, clicking pads mutes/unmutes"],PADS_WAVEFORM_BUTTON:"Toggle waveform mode",PADS_EXPAND_BUTTON:"Shows expanded view for selected track",PADS_LENGTH_BUTTON:"Click to change the pattern length of all the tracks.",GO_TO_PAD_SEQUENCER:"Click to go to the step sequencer for this pad.",PAD_FX:"Click to add effects to this entire pad.",GO_BACK_HOME:"Returns to project-wide context for the sidebar",AUDITION_NEXT:"Audition the next new sound for the selected track",AUDITION_PREVIOUS:"Audition the previous sound for the selected track"}},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"d",function(){return o});var r=300,a=200,i=10,o=function(e,t){r=e,a=t};window.updatePlanarSize=o},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n(289),a=n.n(r),i=new a.a(new a.a.providers.HttpProvider("https://ropsten.infura.io/v3/2f3dce2af1044e88b4851c3d73c3d00c")),o=new a.a(new a.a.providers.WebsocketProvider("wss://ropsten.infura.io/ws/v3/2f3dce2af1044e88b4851c3d73c3d00c"))},function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"b",function(){return u});var r=n(8),a=n(19),i=n(80),o=n(78);n(422),n(62);Object(a.a)("gl.abs",{x:""},"Creates GLSL expression calculating absolute value of inlet",function(){return 1},{tags:"GLSL",inlets:1});Object(a.a)("gl.mix",{a:"",b:"","mix amt":""},"Creates GLSL expression calculating mix interpolation between inlets",function(){return 1},{isHot:!0,tags:"GLSL",inlets:3});Object(a.a)("gl.rainbow",{x:""},"Creates GLSL expression calculating rainbow value of inlet",function(){return 1},{tags:"GLSL",inlets:1});Object(a.a)("gl.exp",{x:""},"Creates GLSL expression calculating absolute value of inlet",function(){return 1},{tags:"GLSL",inlets:1});Object(a.a)("gl.min",{},"Creates GLSL expression calculating min of inlets",function(){return 1},{tags:"GLSL",isHot:!0,inlets:2});Object(a.a)("gl.max",{},"Creates GLSL expression calculating max of inlets",function(){return 1},{isHot:!0,inlets:2});Object(a.a)("gl.mod",{},"Creates a GLSL expression calculating the modulo of inlets",function(){return 1},{tags:"GLSL",isHot:!0,inlets:2});Object(a.a)("gl.clamp",{a:"",b:""},"Creates GLSL expression clamping left-inlet number between 2nd and 3rd inlet",function(){return 1},{isHot:!0,inlets:3,tags:"GLSL"});var s={"gl.abs":function(e){return e.needsHotReload=!0,Object(o.a)(function(t){var n=Object(i.a)(t);return e.flash(),"abs("+u(n[0])+")"})},"gl.min":function(e,t){return e.needsHotReload=!0,Object(o.a)(function(n){var r=Object(i.a)(n,t);return e.flash(),"min(".concat(r[0],", ").concat(r[1],")")},t)},"gl.max":function(e,t){return e.needsHotReload=!0,Object(o.a)(function(n){var r=Object(i.a)(n,t);return e.flash(),"max(".concat(u(r[0]),", ").concat(u(r[1]),")")},t)},"gl.mod":function(e,t){return e.needsHotReload=!0,Object(o.a)(function(n){var r=Object(i.a)(n,t);return e.flash(),"mod(".concat(u(r[0]),", ").concat(u(r[1]),")")},t)},"gl.clamp":function(e,t,n){return e.needsHotReload=!0,Object(o.a)(function(r){var a=Object(i.a)(r,t,n);return e.flash(),"clamp(".concat(u(a[0]),", ").concat(u(a[1]),", ").concat(u(a[2]),")")},t,n)},"gl.exp":function(e){return e.needsHotReload=!0,Object(o.a)(function(t){var n=Object(i.a)(t);return e.flash(),"exp("+u(n[0])+")"})},"gl.rainbow":function(e){return e.needsHotReload=!0,Object(o.a)(function(t){var n=Object(i.a)(t);return e.flash(),"rainbow("+u(n[0])+")"})},"gl.mix":function(e,t,n){return e.needsHotReload=!0,Object(o.a)(function(r){var a=Object(i.a)(r,t,n);return e.flash(),"mix(".concat(u(a[0]),", ").concat(u(a[1]),", ").concat(u(a[2]),")")},t,n)}},c=function(){for(var e={},t={},n={},a=[],i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];for(var c=0,u=o;c<u.length;c++){var l=u[c];"function"===typeof l&&(l=l());var f=(l=void 0===l?{}:l).uniforms||{};e=Object(r.a)({},e,f);var h=l.functions||{};n=Object(r.a)({},n,h);var p=l.closure||{};t=Object(r.a)({},t,p),a.push(l.code||l||"0.0")}return{codes:a,uniforms:e,functions:n,closure:t}},u=function(e){return"object"===typeof e?"1.0":"bang"===e||void 0===e?"1.0":e.toFixed?e.toFixed(3):e}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var f=function(e){Object(i.a)(n,e);var t=l(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){return this.props.condition?this.props.children:u.a.createElement("div",null)}}]),n}(c.Component);t.a=f},,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(192),u=(n(31),n(5)),l=n.n(u),f=n(14);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=new(function(){function e(){Object(r.a)(this,e),this.runningQueries=new Set}return Object(a.a)(e,[{key:"submit",value:function(e){var t=this;return new Promise(function(){var n=Object(f.a)(l.a.mark(function n(r,a){var i;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t.runningQueries.size>=4)){n.next=5;break}return n.next=3,t.sleep(20);case 3:n.next=0;break;case 5:t.runningQueries.add(e),i="/search",window.spores&&(i="https://zequencer.io"+i),fetch(i,{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(n){t.removeQuery(e),r(n||[])}).catch(function(n){console.log(n),t.removeQuery(e)});case 9:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"removeQuery",value:function(e){this.runningQueries.delete(e)}},{key:"sleep",value:function(e){return new Promise(function(t,n){setTimeout(t,e)})}}]),e}()),d=function(e){Object(i.a)(n,e);var t=h(n);function n(e){return Object(r.a)(this,n),t.call(this,e)}return Object(a.a)(n,[{key:"executeQuery",value:function(){var e=this;!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise(function(t,n){if(window.isNFT)return t([]);p.submit(e.getJson()).then(t)})}}]),n}(c.a);t.a=d},function(e,t,n){"use strict";n.d(t,"a",function(){return b}),n.d(t,"b",function(){return y}),n.d(t,"c",function(){return g});var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(21),l=n(427),f=n(131),h=n(15),p=n.n(h),d=n(235),m=n(320);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var b=function(e){Object(o.a)(n,e);var t=v(n);function n(e,a,i){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object(r.a)(this,n),(o=t.call(this,e,a,i,s)).hasAudioParamSetter=!0,o.setAudioParam(a),o}return Object(a.a)(n,[{key:"fromJson",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.depth&&(this._depth=e.depth.unlockedValue);var a=this.id,i={},o=this.context&&this.context.subSequence?this.context.subSequence:void 0!==t?t.currentSubSequence||t.subSequences[0]:void 0;if(void 0===e.id||r||(this.id=e.id,this.sequencerEngine&&(this.sequencerEngine.idToParameter[this.id]=this)),void 0!==e.lfos&&e.lfos.length>0&&void 0!==o&&e.lfos.forEach(function(e){var t=n.availableLFOs[e]||o.lfos[e].lfo;n.lfos.includes(t)&&t.replaceParameterIds(a,n.id,n),n.connectToLFO(t)}),void 0!==e.envelopes&&e.envelopes.length>0&&void 0!==o&&e.envelopes.forEach(function(e){var t=n.availableEnvelopes[e]||o.envelopes[e];n.envelopes.includes(t)?t.replaceParameterIds(a,n.id,n):n.connectToEnvelope(t)}),void 0!==e.value&&(i=this.set(e.value,!0,!0)),e.keyScaling&&(this.keyScaling=new l.a(this,e.keyScaling.min,e.keyScaling.max)),this.unlockedValue=void 0!==e.unlockedValue?Object(d.b)(e.unlockedValue):this.value,void 0!==e.patternToValue&&(this.patternToValue=Object(d.a)(e.patternToValue)),this.isPatternLocked()&&void 0!==this.patternToValue[0]?i=this.set(this.patternToValue[0],!0,!0):void 0!==this.unlockedValue&&(i=this.set(this.unlockedValue,!0,!0)),void 0!==e.paletteToValue&&(this.paletteToValue=Object(d.a)(e.paletteToValue)),e.patternToAutomation)for(var s in e.patternToAutomation)this.patternToAutomation[s]=new m.a(this),this.patternToAutomation[s].fromJson(e.patternToAutomation[s]);e.unlockedAutomation&&this.unlockedAutomation.fromJson(e.unlockedAutomation),this.loadModsFromJson(e);var c={};return c[i.id]=i.value,void 0!==e.depth?(this.depthParameter||this.initDepth(),this.depthParameter.fromJson(e.depth,t,r)):void 0!==e._depth&&(this._depth=e._depth),e.mixAutomation&&this.mixAutomation.fromJson(e.mixAutomation,!1),void 0!==e.min&&(this.min=e.min),void 0!==e.max&&(this.max=e.max),e.stepToValue&&(this.stepToValue=e.stepToValue),c}},{key:"initDepth",value:function(){var e=void 0!==this._depth?this._depth:1;this.depthSignal=new p.a.Signal(0),this.depthParameter=new g("depth",this.depthSignal,{min:0,max:1,defaultValue:e,automationRate:f.a},.2),this.context&&this.depthParameter.setContext(this.context),this.depthParameter.setStore(this.store)}},{key:"connectToLFO",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(i.a)(Object(c.a)(n.prototype),"connectToLFO",this).call(this,e),t&&this.set(this.value,!0,!0)}},{key:"disconnectFromLFO",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;Object(i.a)(Object(c.a)(n.prototype),"disconnectFromLFO",this).call(this,e,!1,r),t&&this.set(this.value,!0,!0)}},{key:"connectToEnvelope",value:function(e){Object(i.a)(Object(c.a)(n.prototype),"connectToEnvelope",this).call(this,e),this.set(this.value,!0,!0)}},{key:"disconnectFromEnvelope",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;Object(i.a)(Object(c.a)(n.prototype),"disconnectFromEnvelope",this).call(this,e,!1,r),t&&this.set(this.value,!0,!0)}}]),n}(u.a),g=function(e){Object(o.a)(n,e);var t=v(n);function n(e,a){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1;return Object(r.a)(this,n),(i=t.call(this,e,a,function(t,n,r){if(t&&!isNaN(n)&&(t.input||o.noInput)){var a=p.a.Master.context.isOffline?p.a.Master.context._currentTime:p.a.Master.context.currentTime;s>0&&"macro"!==e&&window.sequencerEngine&&window.sequencerEngine.playing?isNaN(n)||t.linearRampToValueAtTime(n,a+s):"harmonicity"!==e&&"octave"!==e?t.value=n:t.setValueAtTime(n,a)}},o)).hasAudioParamSetter=!1,i.automationRate=f.a,i}return n}(b),y=function(e){Object(o.a)(n,e);var t=v(n);function n(e,a){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(r.a)(this,n),o.unit="%",(i=t.call(this,e,a,o)).hasAudioParamSetter=!1,i}return n}(g)},,function(e,t,n){"use strict";n.d(t,"i",function(){return o}),n.d(t,"q",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"m",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"o",function(){return h}),n.d(t,"p",function(){return p}),n.d(t,"n",function(){return d}),n.d(t,"k",function(){return m}),n.d(t,"j",function(){return v}),n.d(t,"l",function(){return b}),n.d(t,"a",function(){return g}),n.d(t,"f",function(){return y}),n.d(t,"b",function(){return k}),n.d(t,"c",function(){return O}),n.d(t,"g",function(){return j}),n.d(t,"r",function(){return w}),n.d(t,"s",function(){return E});var r=n(198),a=n(602),i=n(234),o=1,s=2,c=3,u=5,l=6,f=7,h=8,p=9,d=10,m=11,v=12,b=14,g=15,y="LINEAR",k="BASIC",O="DETERMINISTIC",j={id:"none"};function w(e){switch(e){case o:return new r.a;case m:return new i.a;case b:return new a.a;default:return}}function E(e){switch(e){case m:case v:case o:return!0;default:return!1}}},function(e,t,n){"use strict";n(289);var r=n(750),a=n(751),i=n(752),o=n(299),s=n(753),c=n(269),u=n(500),l=n(516),f=n(362),h=n(754),p=n(755),d=n(756),m=n(757),v=n(2),b=n(4),g=function(){function e(){Object(v.a)(this,e),this.abi=[{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"ipfsHash",type:"bytes32"},{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SequenceFavorited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"ipfsHash",type:"bytes32"},{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SequenceStarred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"ipfsHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"tag",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SequenceTagged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"ipfsHash",type:"bytes32"},{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SequenceUnfavorited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"ipfsHash",type:"bytes32"},{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SequenceUnstarred",type:"event"},{constant:!1,inputs:[{internalType:"bytes32",name:"ipfsHash",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"favoriteSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"ipfsHash",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"starSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"ipfsHash",type:"bytes32"},{internalType:"bytes32",name:"tag",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"tagSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"ipfsHash",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"unfavoriteSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"ipfsHash",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"unstarSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}],this.contractAddress="0x03172e863dbF7EEb3994AF5a6608c470eB6E79fC"}return Object(b.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}(),y=n(758),k=n(188),O=n(1336),j=n(714),w=n(715),E=n(759),S=n(760),P=n(1337),x=n(716),T=n(641),C=n(642),N=n(717),R=n(761),M=n(36);n.d(t,"b",function(){return A}),n.d(t,"j",function(){return q}),n.d(t,"f",function(){return D}),n.d(t,"k",function(){return I}),n.d(t,"i",function(){return _}),n.d(t,"h",function(){return F}),n.d(t,"d",function(){return L}),n.d(t,"g",function(){return B}),n.d(t,"m",function(){return z}),n.d(t,"u",function(){return V}),n.d(t,"s",function(){return H}),n.d(t,"w",function(){return U}),n.d(t,"o",function(){return J}),n.d(t,"c",function(){return G}),n.d(t,"a",function(){return W}),n.d(t,"l",function(){return K}),n.d(t,"n",function(){return X}),n.d(t,"e",function(){return Q}),n.d(t,"v",function(){return Y}),n.d(t,"p",function(){return Z}),n.d(t,"t",function(){return $}),n.d(t,"x",function(){return ee}),n.d(t,"r",function(){return te}),n.d(t,"q",function(){return ne}),n.d(t,"y",function(){return re});var A="AUTHORIZER",q="GUILD_SAMPLES",D="FAVORITES",I="GUILD_SEQUENCES",_="GUILD_PRESETS",F="GUILDS",L="ENCRYPTION",B="FOLDERS",z="MESSAGING",V="SEQUENCE_METADATA",H="RESAMPLE",U="XANADU",J="MIX",G="EFFECTS",W="ARTISTS",K="GUILD_SETTINGS",X="MIDI_CC",Q="EXPLORE_LISTS",Y="WALLPAPER",Z="PACKS",$="SCRIPTS",ee="ZPROJECTS",te="PROJECT_METADATA",ne="PLUGINS",re={USERS:(new s.a).getContract(M.a),FAVORITES:(new r.a).getContract(M.a),GUILDS:(new h.a).getContract(M.a),PLUGINS:(new R.a).getContract(M.a),GUILD_SAMPLES:(new c.a).getContract(M.a),TOKENIZED_SEQUENCES:(new u.a).getContract(M.a),GUILD_SEQUENCES:(new l.a).getContract(M.a),GUILD_PRESETS:(new f.a).getContract(M.a),ENCRYPTION:(new p.a).getContract(M.a),FOLDERS:(new d.a).getContract(M.a),MESSAGING:(new m.a).getContract(M.a),SEQUENCE_METADATA:(new g).getContract(M.a),RESAMPLE:(new y.a).getContract(M.a),XANADU:(new k.a).getContract(M.a),MIX:(new O.a).getContract(M.a),EFFECTS:(new j.a).getContract(M.a),ARTISTS:(new w.a).getContract(M.a),GUILD_SETTINGS:(new E.a).getContract(M.a),MIDI_CC:(new S.a).getContract(M.a),EXPLORE_LISTS:(new P.a).getContract(M.a),WALLPAPER:(new x.a).getContract(M.a),PACKS:(new T.a).getContract(M.a),SCRIPTS:(new C.a).getContract(M.a),NFT:(new o.a).getContract(M.a),ZPROJECTS:(new N.a).getContract(M.a),AUTHORIZER:(new a.a).getContract(M.a),PROJECT_METADATA:(new i.a).getContract(M.a)}},,function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"g",function(){return i}),n.d(t,"o",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"m",function(){return c}),n.d(t,"h",function(){return u}),n.d(t,"f",function(){return l}),n.d(t,"w",function(){return f}),n.d(t,"b",function(){return h}),n.d(t,"e",function(){return p}),n.d(t,"s",function(){return d}),n.d(t,"l",function(){return m}),n.d(t,"v",function(){return v}),n.d(t,"y",function(){return b}),n.d(t,"x",function(){return g}),n.d(t,"a",function(){return y}),n.d(t,"k",function(){return k}),n.d(t,"q",function(){return O}),n.d(t,"p",function(){return j}),n.d(t,"j",function(){return w}),n.d(t,"r",function(){return E}),n.d(t,"n",function(){return S}),n.d(t,"i",function(){return P}),n.d(t,"d",function(){return x}),n.d(t,"u",function(){return T});var r=n(67),a=function(e,t,n,a,i,o){return{type:r.c,payload:{track:e,step:t,stepNumber:n,resolution:a,displayResolution:i,slide:o}}},i=function(e,t,n){return{type:r.j,timestamp:(new Date).getTime(),payload:{track:e,stepNumber:t,resolution:n}}},o=function(e,t,n,a,i,o){return{type:r.q,timestamp:(new Date).getTime(),payload:{track:e,step:t,stepNumber:n,resolution:a,displayResolution:i,isQuantized:o}}},s=function(e,t,n){return{type:r.w,payload:{track:e,stepNumber:t,resolution:n}}},c=function(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return{type:r.o,payload:{track:e,steps:t,transformation:n,wrap:i,resolution:a,isPianoRoll:o}}},u=function(e,t){return{type:r.i,payload:{track:e,steps:t}}},l=function(e){return{type:r.g,payload:{patternNumber:e}}},f=function(e,t,n,a){return{type:r.z,payload:{track:e,step:t,parameter:n,value:a}}},h=function(e,t,n,a){return{type:r.b,payload:{effect:e,track:t,group:n,send:a}}},p=function(e,t,n,a){return{type:r.f,payload:{effect:e,track:t,group:n,send:a}}},d=function(e,t,n,a){return{type:r.v,payload:{effect:e,track:t,group:n,send:a}}},m=function(e,t,n,a,i,o){return{type:r.n,payload:{from:e,to:t,isMidiEffect:n,track:a,group:i,send:o}}},v=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{type:r.y,timestamp:(new Date).getTime(),payload:{parameter:e,value:t,automation:n,isBulk:a}}},b=function(e,t){return{type:r.B,payload:{track:e,value:t}}},g=function(e,t){return{type:r.A,payload:{track:e,mute:t}}},y=function(e,t,n,a){return{type:r.a,payload:{automation:e,step:t,value:n,pointId:a}}},k=function(e,t,n,a){return{type:r.l,payload:{automation:e,point:t,step:n,value:a}}},O=function(e,t){return{type:r.r,payload:{automation:e,point:t}}},j=function(e,t){return{type:r.s,payload:{automation:e,points:t}}},w=function(e,t,n,a){return{type:r.m,payload:{automation:e,points:t,stepDiff:n,valueDiff:a}}},E=function(e,t,n){return{type:r.u,payload:{track:e,steps:t,resolution:n}}},S=function(e,t,n,a){return{type:r.p,timestamp:(new Date).getTime(),payload:{parameter:e,automation:t,value:n,oldValue:a}}},P=function(e,t){return{type:r.k,payload:{tracks:e,patternToLoad:t}}},x=function(e,t,n,a){return{type:r.d,payload:{track:t,preset:e,loadMods:n,loadEffects:a}}},T=function(e,t){return{type:r.x,payload:{effect:e,parameters:t}}}},function(e,t,n){"use strict";(function(e){var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(351),u=n.n(c),l=n(588),f=new XMLHttpRequest,h="/ip4/3.17.26.249/tcp/4001/ipfs/QmeQRpfSrYcAaqkhNoArDyTUwyYiru2gJp4WY1WegQGjtR",p=[85,110,105,118,101,114,115,97,108,32,83,101,113,101,117,110,99,101,115];window.httpV="http://www.zequencer.io:5001",window.httpsV="https://www.zequencer.io:5002";var d=new(function(){function t(){var e=this;if(Object(o.a)(this,t),this.controllers=new Set,!window.isNFT){"http:"===window.location.protocol?(this.backupIpfs=new u.a("ipfs.infura.io","5001",{protocol:"https"}),window.isNFT?(this.centralIpfs=this.backupIpfs,this._centralIpfs=u()("www.zequencer.io","5001",{protocol:"http"})):(this.centralIpfs=u()("www.zequencer.io","5001",{protocol:"http"}),this._centralIpfs=this.centralIpfs)):window.isNFT?(this.centralIpfs=this.backupIpfs,this._centralIpfs=u()("www.zequencer.io","5002",{protocol:"https"})):(this.centralIpfs=u()("www.zequencer.io","5002",{protocol:"https"}),this._centralIpfs=this.centralIpfs),this.ipfs=this.centralIpfs;var n=this;this.connectedLocally=!1,this.finishedTestingLocalConnection=!1,f.onreadystatechange=function(){4==f.readyState&&200==f.status&&(n.ipfs=u()("localhost","5001",{protocol:"http"}),n.connectToCentral(),n.connectedLocally=!0,n.finishedTestingLocalConnection=!0,e.keepSwarmConnectionAlive())},window.isNFT||(f.open("POST","http://localhost:5001/api/v0/swarm/peers",!0),f.timeout=4e3,f.ontimeout=function(){console.log("timed out connecting to local ipfs daemon")}),setTimeout(function(){e.finishedTestingLocalConnection=!0},4e3),f.send("")}}return Object(s.a)(t,[{key:"restart",value:function(){}},{key:"getIPFSPrefix",value:function(){return this.connectedLocally?"http://localhost:5001":"http:"===window.location.protocol?window.httpV:"https:"===window.location.protocol?window.httpsV:void 0}},{key:"getHashUrl",value:function(e){return this.connectedLocally?"http://localhost:8080/ipfs/"+e:(window.location.protocol,"/ipfs/"+e)}},{key:"getPinnedHashes",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ipfs.refs.local();case 2:return t=e.sent,e.abrupt("return",t.map(function(e){return e.ref}));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"findProvs",value:function(e){var t=this;return new Promise(function(n,r){t.ipfs.dht.findprovs(e,{maxNumProviders:1},function(e,t){n(t)})})}},{key:"connectToCentral",value:function(){try{this.ipfs.swarm.connect(h,function(e,t){}).catch(function(e){return console.log("error")})}catch(e){console.log("error connecting to ipfs")}}},{key:"keepSwarmConnectionAlive",value:function(){var e=this;try{this.ipfs.swarm.connect(h,function(e,t){}).catch(function(e){return console.log("error")})}catch(t){console.log("error connecting to ipfs")}setInterval(function(){if(window.sequencerEngine&&window.sequencerEngine.getSequenceId){var n=window.sequencerEngine.getSequenceId();if(window.sequencerEngine.store.getState().sequencer.isPlaying[n])return}try{e.ipfs.swarm.connect(h,function(e,t){}).catch(function(e){return console.log("error")})}catch(t){console.log("error connecting to ipfs")}},6e4)}},{key:"isConnectedLocally",value:function(){return this.connectedLocally}},{key:"addArrayBuffer",value:function(e,t){return this.addHelper(e,t)}},{key:"addArrayBufferAndSaveToDB",value:function(e,t){return this.addBlobAndSaveToDB(new Blob([new Uint8Array(e)]),t)}},{key:"addHelper",value:function(t){var n=this,r=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2?arguments[2]:void 0);void 0===r&&(r="hello");return new Promise(function(a,i){var o=n._centralIpfs||n.ipfs;o||(o="http:"===window.location.protocol?u()("www.zequencer.io","5001",{protocol:"http"}):u()("www.zequencer.io","5002",{protocol:"https"})),o.add({name:r,path:"hello",content:new e(t)},function(e,t){console.log("IPFS HASH = ",t);var n=t[0].hash;e?i(e):a(n)})})}},{key:"addBuffer",value:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&arguments[2];return new Promise(function(n,r){var a=t.centralIpfs;a.add(e,function(e,t){if(e)r(e);else{var i=t[0].hash;a.pin.add(i),n(i)}})})}},{key:"addJson",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LOCAL",a=arguments.length>2?arguments[2]:void 0;return new Promise(function(i,o){console.log("adding json noUTF=",a,t);var s="UNIVERSAL"===r?n.centralIpfs:"LOCAL"===r?n.ipfs:n.backupIpfs;s.add(e.from(JSON.stringify(t)),function(e,t){if(e)o(e);else{var n=t[0].hash;s.pin.add(n),i(n)}}),"LOCAL"===r&&(s!==n.centralIpfs&&n.addJson(t,"UNIVERSAL",a).then(function(e){return i(e)}),n.addJson(t,"INFURA",a).then(function(e){return i(e)}))})}},{key:"getJson",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.restart(),new Promise(function(s,c){if(!o){var u="/api/v0/cat?arg="+e,l=(n?t.centralIpfs:t.ipfs,new AbortController);t.controllers.add(l);var f=l.signal;setTimeout(function(){l.abort(),t.controllers.delete(l),c()},r);var h="POST",p=t.getIPFSPrefix()+u;return window.isNFT?(h="GET",p=e,void fetch(p,{signal:f,method:h}).then(function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:n=e.sent,s(n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())):window.isNFT?s({}):void fetch(p,{signal:f,method:h}).then(function(){var e=Object(i.a)(a.a.mark(function e(n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.readAllChunks(n.body).then(function(e){var n=t.mergeArrays(e,0,!1),r=(new TextDecoder).decode(n);s(JSON.parse(r))});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}t.ipfs.cat(e,function(e,t){s(JSON.parse(t.toString("utf8")))})})}},{key:"addBytesArray",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new Uint8Array(t.length+p.length)).set(t,0),n.set(p,t.length),e.next=5,this.addHelper(n.buffer);case 5:return r=e.sent,this.ipfs.pin.add(r),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"pin",value:function(){var e=Object(i.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ipfs.pin.add(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addBlob",value:function(e,t){var n=this;return this.restart(),new Promise(function(r,a){var i,o=new FileReader,s=n;o.onload=function(){var e=this;i=this.result,s.addHelper(i,void 0,t).then(function(t){e.connectedLocally&&s.ipfs.pin.add(t),s.centralIpfs.pin.add(t),r(t)}).catch(function(e){return a(e)})},o.readAsArrayBuffer(e)})}},{key:"addBlobAndSaveToDB",value:function(e,t){}},{key:"converttoarraybuffer",value:function(e){return new Promise(function(t,n){var r=new r;r.onload=function(){t(this.result)},r.readasarraybuffer(e)})}},{key:"readAllChunks",value:function(e){var t=e.getReader(),n=[];return function e(){return t.read().then(function(t){var r=t.value;return t.done?n:(n.push(r),e())})}()}},{key:"getSound",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e4;return new Promise(function(r,o){var s=new AbortController;t.controllers.add(s);var c=s.signal;setTimeout(function(){s.abort(),t.controllers.delete(s),o()},n);var u="GET",l="https://zequencer.io/ipfs/"+e;return window.isNFT?(u="GET",l=e,fetch(l,{signal:c,method:u}).then(function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.arrayBuffer();case 2:n=e.sent,r(new Uint8Array(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())):window.isNFT?r([]):void fetch(l,{signal:c,method:u}).then(function(){var e=Object(i.a)(a.a.mark(function e(n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.arrayBuffer();case 2:return i=e.sent,r(t.processArray(new Uint8Array(i))),e.abrupt("return");case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log("aborted")})})}},{key:"arrayToBuffer",value:function(e){var t=new ArrayBuffer(e.length);return e.map(function(e,n){t[n]=e}),t}},{key:"cancel",value:function(){console.log("cancelling = ",this.controllers),Array.from(this.controllers).forEach(function(e){return e.abort()})}},{key:"processArray",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]))return e;var t=e,n=this.findEnd(t,p);return-1!==n?t.slice(0,n):e.slice(0,e.length-1024)}},{key:"mergeArrays",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:512,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=0;for(var a in e)r+=e[a].length;var i=new Uint8Array(r-t),o=0;for(var s in e)0===o?(i.set(e[s].subarray(t),o),o+=e[s].length-t):(i.set(e[s],o),o+=e[s].length);if(!n)return i;var c=i,u=this.findEnd(c,p);return-1!==u?c.slice(0,u):i.slice(0,i.length-1024)}},{key:"findEnd",value:function(e,t){for(var n=e.length-1600,r=e.slice(n).values(),a=0,i=n;i<e.length;i++){if(r.next().value===t[a]){if(0==a&&(n=i),++a===t.length-1)return n}else a=0,n=i}return-1}},{key:"getAudioBuffer",value:function(e,t){var n=this;return this.restart(),new Promise(function(r,a){n.getSound(e).then(function(e){return t.decodeAudioData(l(e),function(e){r(e)},function(e,t,n){n&&a(n)})}).catch(function(e){a(e)})})}}]),t}());t.a=d}).call(this,n(27).Buffer)},function(e,t,n){"use strict";n.d(t,"q",function(){return s}),n.d(t,"p",function(){return u}),n.d(t,"r",function(){return l}),n.d(t,"o",function(){return f}),n.d(t,"l",function(){return h}),n.d(t,"m",function(){return p}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return m}),n.d(t,"d",function(){return v}),n.d(t,"h",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"j",function(){return y}),n.d(t,"f",function(){return k}),n.d(t,"g",function(){return O}),n.d(t,"i",function(){return j}),n.d(t,"c",function(){return w}),n.d(t,"k",function(){return E}),n.d(t,"n",function(){return P});var r=n(8),a=n(17);n(1039);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=void 0;return function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];var s,c=[],u=!1,l=0,f=i(t=t.map(function(e){return a.A.apply(void 0,[e].concat(n))}).flat(4));try{for(f.s();!(s=f.n()).done;){var h=s.value,p={};for(var d in h)p[d]=a.A.apply(void 0,[h[d]].concat(n)),"counter"!==d&&r&&r[l]&&r[l][d]&&"object"!==typeof p[d]&&r[l][d]!==p[d]&&(u=!0);c.push(p),l++}}catch(m){f.e(m)}finally{f.f()}return!u&&r?r:(r=c,c)}},c=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a={decide:function(e){return Object(r.a)({},t,{decide:e})},always:function(e){return Object(r.a)({},t,{always:e})},alt:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return Object(r.a)({},t,{alt:n})},series:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return Object(r.a)({},t,{series:n})},never:function(e){return Object(r.a)({},t,{never:e})}};return n<=3&&(a.later=function(a){return e(Object(r.a)({},t,{delay:a}),n++)},a.first=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e(Object(r.a)({},t,{firstOffset:a}),n++)},a.last=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e(Object(r.a)({},t,{lastOffset:a}),n++)},a.figure=function(a,i){return e(Object(r.a)({},t,{figureFrom:a,figureTo:i}),n++)},a.every=function(a){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e(Object(r.a)({},t,{every:a,offset:i}),n++)},a.max=function(a){return e(Object(r.a)({},t,{max:a}),n++)},a.skip=function(a){return e(Object(r.a)({},t,{skip:a}),n++)}),a},u=function(){var e={otherwise:!0,every:1,offset:0,counter:0};return Object(r.a)({},e,c(e))},l=function(e){var t={when:e,every:1,offset:0,counter:0};return Object(r.a)({},t,c(t))},f=function(e){var t={before:e,every:1,offset:0,counter:0};return Object(r.a)({},t,c(t))},h=function(e){var t={after:e,every:1,offset:0,counter:0};return Object(r.a)({},t,c(t))},p=function(e,t,n,a,o,s){var c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!t)return[];var u,l=[],f=[],h=[],p=i(t);try{for(p.s();!(u=p.n()).done;){var d=u.value;if(S(e,d)){var m=d.firstOffset,v=d.lastOffset,b=d.delay,g=d.every,y=d.offset,k=(d.max,d.skip,d.figureFrom),O=d.figureTo;if(void 0!==k){if(void 0===O&&k!==a)continue;if(void 0!==O&&(k>a||a>O))continue}if(void 0!==m&&o!==m&&m>=0)continue;if(void 0!==v&&s-o-1!==v&&v>=0)continue;if(c||d.counter++,d.max&&d.counter>d.max)continue;if(void 0!==d.skip&&d.counter<=d.skip)continue;if((d.counter-1)%g!==y)continue;if(h.push(d),d.decide)n()&&(b?f.push(Object(r.a)({delay:b},d.decide)):l.push(d.decide));else if(d.always)b?f.push(Object(r.a)({delay:b},d.always)):Array.isArray(d.always)?d.always.forEach(function(e){return l.push(e)}):l.push(d.always);else if(d.alt){var j=d.alt;b?f.push(Object(r.a)({delay:b},j[(d.counter-1)%j.length])):l.push(j[(d.counter-1)%j.length])}else d.series?d.series.forEach(function(e,t){(Array.isArray(e)?e:[e]).forEach(function(e){0===t?l.push(e):f.push(Object(r.a)({delay:t},e))})}):d.never}}}catch(w){p.e(w)}finally{p.f()}return{actions:l,delayedActions:f,matchedRules:h}},d={type:"any",value:""},m={type:"accent",value:""},v={type:"flam",value:""},b={type:"regular",value:""},g={type:"legato",value:""},y={type:"staccato",value:""},k={type:"pianissimo",value:""},O={type:"piano",value:""},j={type:"rest",value:""},w={type:"double",value:""},E={type:"times",value:""},S=function(e,t){return e.when&&t.when?e.when.type===t.when.type&&e.when.value===t.when.value:e.before&&t.before?e.before.type===t.before.type&&e.before.value===t.before.value:e.after&&t.after?e.after.type===t.after.type&&e.after.value===t.after.value:!(!e.otherwise||!t.otherwise)},P=function(e,t){if(Array.isArray(e))return"regular"===t.type?e[0]:e;switch(e=Object(r.a)({},e),t.type){case"flam":e.flam=!0;break;case"regular":e.staccato=!1,e.transpose=0,e.accent=!1,e.flam=!1,e.piano=!1,e.pianissimo=!1;break;case"staccato":e.staccato=!0,e.transpose=0;break;case"legato":e.legato=!0,e.staccato=!1,e.transpose=0;break;case"accent":e.accent=!0,e.pianissimo=!1,e.piano=!1,e.transpose=0;break;case"rest":e.transpose=null,e.accent=!1;break;case"pianissimo":e.pianissimo=!0,e.accent=!1,e.transpose=0;break;case"piano":e.piano=!0,e.accent=!1,e.transpose=0;break;case"double":null===e.transpose&&(e.transpose=0),e=[e,e];break;case"times":e=new Array(t.value).fill(e)}return e}},,function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"j",function(){return a}),n.d(t,"r",function(){return i}),n.d(t,"h",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"k",function(){return c}),n.d(t,"s",function(){return u}),n.d(t,"o",function(){return l}),n.d(t,"m",function(){return f}),n.d(t,"l",function(){return h}),n.d(t,"q",function(){return p}),n.d(t,"i",function(){return d}),n.d(t,"d",function(){return m}),n.d(t,"g",function(){return v}),n.d(t,"p",function(){return b}),n.d(t,"b",function(){return g}),n.d(t,"e",function(){return y}),n.d(t,"n",function(){return k}),n.d(t,"f",function(){return O});var r="bang",a="scale",i="trigger-routing",o="reset",s="cycle-restart",c="snapshot-changed",u="use-snapshot",l="tick",f="stop",h="start",p="trigger",d="rules",m="figures",v="params",b="tidals",g="choke",y="grid-operation",k="swap-min-max",O="nft"},,function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(555),u=n.n(c),l=n(6),f=new(function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,[{key:"setEthereum",value:function(e){this.ethereum=e}},{key:"setStore",value:function(e){this.store=e}},{key:"isMetamaskInstalled",value:function(){return!1}},{key:"appear",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAccount();case 2:if(t=e.sent,console.log("appear called = ",t),t){e.next=6;break}return e.abrupt("return");case 6:fetch("/appear/"+t,{method:"POST",headers:{Accept:"text/html","Content-Type":"text/html"}});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"isLoggedIn",value:function(){return this.store&&void 0!==this.store.getState().sequencer.userToken}},{key:"getToken",value:function(){var e=this.store.getState().sequencer.userToken;return e?e.token:void 0}},{key:"checkLogin",value:function(){var e=this;return console.log("check login called"),new Promise(function(t){if(window.isNFT)t();else{var n=u.a.load("token");console.log("token cookie=",n),""!==n&&void 0!==n?(console.log("checking login"),fetch("/checkToken/"+n,{method:"POST",headers:{Accept:"text/html","Content-Type":"text/html"}}).then(function(){var n=Object(i.a)(a.a.mark(function n(r){var i,o;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(401!==r.status){n.next=5;break}console.log("401"),t(!1),n.next=12;break;case 5:return n.next=7,r.text();case 7:i=n.sent,o=u.a.load("token"),console.log("all good",o),e.store.dispatch(Object(l.Ah)(i,o)),t(!0);case 12:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())):t(!1)}})}},{key:"logout",value:function(){console.log("logging out"),this.store.dispatch(Object(l.Ah)(void 0)),this.account=void 0,u.a.remove("token",{path:"/"})}},{key:"signUp",value:function(e,t){var n=this;fetch("/signUp/"+e+"/"+t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(r){var a=u.a.load("token");n.store.dispatch(Object(l.Ah)(e,a)),n.ethereum.crypto.password=t})}},{key:"relogin",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.login(this._userName,this._password);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"login",value:function(e,t){var n=this;return new Promise(function(r,a){fetch("/login/"+e+"/"+t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(a){if(401===a.status)r(!1);else{n._userName=e,n._password=t;var i=u.a.load("token");n.store.dispatch(Object(l.Ah)(e,i)),n.ethereum.crypto.password=t,n.ethereum.guilds.onUserChanged(),n.account=void 0,n.appear(),r(!0)}})})}},{key:"getAccount",value:function(){var e=this;return new Promise(function(){var t=Object(i.a)(a.a.mark(function t(n,r){var o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.account){t.next=4;break}return o=e.account,n(o),t.abrupt("return");case 4:if(e.isLoggedIn()){t.next=8;break}return console.log("not logged in"),n(void 0),t.abrupt("return");case 8:fetch("/getAccount/",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"}).then(function(){var t=Object(i.a)(a.a.mark(function t(r){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(401!==r.status&&404!==r.status){t.next=4;break}n(void 0),t.next=9;break;case 4:return t.next=6,r.text();case 6:e.account=t.sent,console.log("account = ",e.account),n(e.account);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 9:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getUserName",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isMetamaskInstalled()){e.next=10;break}return e.next=3,this.ethereum.getUser();case 3:return t=e.sent,e.next=6,this.ethereum.users.getUserName(t);case 6:return n=e.sent,e.abrupt("return",n);case 10:if(!this.isLoggedIn()){e.next=14;break}return e.abrupt("return",this.store.getState().sequencer.userToken.userName);case 14:return console.log("is not logged in..."),e.abrupt("return","Not Logged In");case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}());window._accounts=f,t.a=f},,,function(e,t,n){"use strict";n.d(t,"f",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"e",function(){return u});var r="SAMPLER",a="MIDI",i="AUDIO",o="Z4",s="INSTRUMENT",c="INSTRUMENT_RACK",u="MULTI_FREEZE"},function(e,t,n){"use strict";var r=n(16),a=n(8),i=n(11),o=n(2),s=n(4),c=n(20),u=n(7),l=n(10),f=n(1),h=(n(0),n(15)),p=n.n(h),d=(n(90),n(21)),m=new(function(){function e(){Object(o.a)(this,e),this.nameToEffects={}}return Object(s.a)(e,[{key:"useEffect",value:function(e,t,n){return n.isOffline?t():e in this.nameToEffects&&this.nameToEffects[e].length>0?this.nameToEffects[e].pop():t()}},{key:"totalEffects",get:function(){var e=0;for(var t in this.nameToEffects)e+=this.nameToEffects[t].length;return e}},{key:"releaseEffect",value:function(e,t,n){if(n.isOffline)t.dispose();else{if(this.totalEffects>=12)for(var r in this.nameToEffects){var a=this.nameToEffects[r][0];if(a){this.nameToEffects[r]=this.nameToEffects[r].slice(1),a.dispose(!1);break}}this.nameToEffects[e]||(this.nameToEffects[e]=[]),t.disconnect(),this.nameToEffects[e].push(t)}}}]),e}()),v=n(41),b=n(6),g=n(519),y=n(50),k=n(97),O=n(102),j=n(32),w=(n(47),n(71)),E=n(45);function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var P=function(e){Object(u.a)(n,e);var t=S(n);function n(e,r,a,i){var s;return Object(o.a)(this,n),(s=t.call(this)).sequencerEngine=a,s.initialBulkValues={},s.store=a.store,s.name=e,s.id=Object(E.uuid)(),s.sequencerEngine.idToObject[s.id]=Object(c.a)(s),s.parameters=[],s.effectFn=r,s.enabledParameter=new d.a("Enabled",Object(c.a)(s),function(e,t){s.toggle(t)},{min:0,max:1,unit:"boolean",defaultValue:!0}),s.effectNode=m.useEffect(s.name,r,a),s.initializeParameters(),s.numberOfOutputs=1,s.enabled=!1,s.toggledValue=0,s.value=0,s.connected=0,s.newInlet(y.n,function(){return s.swapMinMax()}),s.newInlet("set parameter",function(e){return s.paramSet(e)}),s.newInlet("enable",function(e){return s.onEnableMsg(e)}),s}return Object(s.a)(n,[{key:"onEnableMessage",value:function(e){Object(i.a)(e,1)[0]?this.enableParameter.set(!0):this.enableParameter.set(!1)}},{key:"initializeParameters",value:function(){this.wetParameter=void 0!==this.effectNode.wet?new v.b("Wet",this.effectNode.wet,{documentation:"Controls the amount of (wet) effected signal, vs. dry (un-effected) signal.",defaultValue:0}):void 0,this.registerParameter(this.wetParameter),this.track=void 0,this.group=void 0,this.setWet(0)}},{key:"getObjectType",value:function(){return k.a}},{key:"paramSet",value:function(e){var t=Object(i.a)(e,1)[0];if(t.split){var n=t.split(" ");if(2===n.length){var r=n[0].toLowerCase(),a=this.getParameters().filter(function(e){return e.name.toLowerCase().includes(r)}),o=parseFloat(n[1]);isNaN(o)&&(o=n[1]),a.forEach(function(e){return e.set(o)})}}}},{key:"swapMinMax",value:function(){this.getParameters().forEach(function(e){e.parameterMods.forEach(function(e){var t=e.min;e.min=e.max,e.max=t})})}},{key:"getEffectType",value:function(){return w.a}},{key:"updateInitialValues",value:function(){this.sequencerEngine.dispatch(Object(b.Vb)(this.initialBulkValues))}},{key:"makePublicIfNeeded",value:function(){}},{key:"getParameters",value:function(){return this.parameters||[]}},{key:"isMidiEffect",value:function(){return!1}},{key:"wet",set:function(e){this.wetParameter&&this.wetParameter.set(e)}},{key:"registerContext",value:function(e,t){var n=this;this.context?this.context.combineWith(e):this.context=e.getCopy(),t?(this.context.forSubDevice(this),this.context.forEffect(t)):this.context.forEffect(this),this.parameters.forEach(function(e){return e.setContext(n.context)})}},{key:"registerMixSession",value:function(e){this.parameters.forEach(function(t){return t.setMixSession(e)})}},{key:"registerParameter",value:function(e){void 0!==e&&(e.name=e.name,e.effectName=this.name,this.initialBulkValues=Object(a.a)({},this.initialBulkValues,e.setStore(this.store)),this.parameters.push(e))}},{key:"finishRegistering",value:function(){}},{key:"connect",value:function(e){this.effectNode.connect(e)}},{key:"syncable",value:function(){return!1}},{key:"disconnect",value:function(e){this.effectNode.disconnect(e)}},{key:"isEnabled",value:function(){return this.enabledParameter.get()}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.enabledParameter.set(e)}},{key:"toggleEnabled",value:function(){this.enabledParameter.set(!this.enabledParameter.get())}},{key:"toggle",value:function(e){}},{key:"setValue",value:function(e){this.value=e,this.effectNode.wet&&this.wetParameter.set(e)}},{key:"setWet",value:function(e){this.effectNode.wet&&this.wetParameter.set(e)}},{key:"getWet",value:function(){return this.wetParameter.value}},{key:"getName",value:function(){return this.name}},{key:"getEffect",value:function(){return this.effectNode}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=(!(arguments.length>1&&void 0!==arguments[1])||arguments[1],new n(this.name,this.effectFn,e));return this.wetParameter&&t.setWet(this.wetParameter.get()),t.enable(this.enabledParameter.get()),t}},{key:"fromJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];void 0===e.id||t&&"boolean"===typeof t||(this.id=e.id,this.sequencerEngine.idToObject[this.id]=this),this.x=e.x,this.y=e.y,void 0!==e.enabled&&this.enable(e.enabled);var n={};return void 0!==this.wetParameter&&(void 0!==e.wet&&(Object(j.a)(this.wetParameter,e.wet,n),this.effectNode.wet&&(this.effectNode.wet.value=e.wet)),n=Object(a.a)({},n,this.loadParameterFromJson(e,"wetParameter",this.wetParameter,t))),n}},{key:"saveParameterToJson",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n.isConnectedToAnyModulator()||Object.keys(n.patternToValue).length>0||Object.keys(n.stepToValue).length>0||Object.keys(n.paletteToValue).length>0||n.mixAutomation.automations.length>0||n.automations.length>=0||n.isMapped||n.higherOrdered||n.depthParameter||n.hasMacro){var i=Object(a.a)({},e);return i[t]=n.getJson(r),i}return e}},{key:"loadParameterFromJson",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r="boolean"===typeof r&&r,t in e?(this.handleModulators(e[t],n),n.fromJson(e[t],this.sequencerEngine,r)):(n.disconnectFromAllModulators(),{})}},{key:"handleModulators",value:function(e,t){e.lfos&&t.lfos.filter(function(t){return!e.lfos.includes(t.number-1)}).forEach(function(e){return t.disconnectFromLFO(e)});e.envelopes&&t.envelopes.filter(function(t){return!e.envelopes.includes(t.number-1)}).forEach(function(e){return t.disconnectFromEnvelope(e)});t.disableKeyScaling()}},{key:"getJson",value:function(){var e={name:this.name,enabled:this.enabledParameter.get(),id:this.id,x:this.x,y:this.y};return void 0!==this.wetParameter&&(e.wet=this.wetParameter.get(!0),e.value=this.wetParameter.get(!0),e=this.saveParameterToJson(e,"wetParameter",this.wetParameter)),e}},{key:"dispose",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.sequencerEngine.isOffline||!e?(this.effectNode&&this.effectNode.dispose(),this.parameters.forEach(function(e){return e.dispose()})):(this.parameters.forEach(function(e){return e.dispose(!1)}),m.releaseEffect(this.name,this.effectNode,this.sequencerEngine)),this.effectNode=void 0,this.parameters=void 0,this.context=void 0,this.name=void 0}}]),n}(Object(O.a)(Object(g.a)(function(){return function e(){Object(o.a)(this,e)}}()))),x=function(e){Object(u.a)(n,e);var t=S(n);function n(e,r){var a;Object(o.a)(this,n),a=t.call(this,"Filter",function(){return new p.a.Filter(80,"lowpass",-24)},e);var i={min:0,max:1e4,unit:"HZ",defaultValue:80,documentation:["Controls the frequency at which filtering works at. ","Ex: For Lowpass filters, frequencies above this value will be cut."]};return r&&(i.automationRate=r),a.cutoffParameter=new v.c("Cutoff",a.effectNode.frequency,i),a.qParameter=new v.c("Q",a.effectNode.Q,{min:0,max:20,unit:"",defaultValue:1}),a.typeParameter=new d.a("type",Object(c.a)(a),function(e,t){return a.effectNode.type=t},{min:"lowpass",max:"highpass",unit:"",defaultValue:"lowpass"}),a.registerParameter(a.cutoffParameter),a.registerParameter(a.typeParameter),a.registerParameter(a.qParameter),a.updateInitialValues(),a}return Object(s.a)(n,[{key:"dispose",value:function(){Object(r.a)(Object(f.a)(n.prototype),"dispose",this).call(this,!1)}},{key:"connect",value:function(e){Object(r.a)(Object(f.a)(n.prototype),"connect",this).call(this,e)}},{key:"syncable",value:function(){return!1}},{key:"toggle",value:function(e){}},{key:"setValue",value:function(e){this.value=e,e=5e3*e+50,this.effectNode.frequency.value=e}},{key:"setFrequency",value:function(e){try{this.cutoffParameter.set(e)}catch(t){}}},{key:"cutoffFrequency",get:function(){return this.cutoffParameter.get()},set:function(e){this.cutoffParameter.set(e)}},{key:"Q",set:function(e){this.qParameter.set(e)}},{key:"setQ",value:function(e){this.qParameter.set(e)}},{key:"lowpass",value:function(){this.type="lowpass"}},{key:"hipass",value:function(){this.type="highpass"}},{key:"type",get:function(){return this.typeParameter.get()},set:function(e){this.typeParameter.set(e)}},{key:"getFrequency",value:function(){return this.effectNode.frequency.value}},{key:"getQ",value:function(){return this.effectNode.Q.value}},{key:"getJson",value:function(){var e=Object(a.a)({},Object(r.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{name:this.name,enabled:this.enabledParameter.get(),frequency:this.effectNode.frequency.value,q:this.effectNode.Q.value,type:this.effectNode.type});return e=this.saveParameterToJson(e,"cutoffParameter",this.cutoffParameter),e=this.saveParameterToJson(e,"qParameter",this.qParameter),e=this.saveParameterToJson(e,"typeParameter",this.typeParameter)}},{key:"fromJson",value:function(e,t){var i=Object(r.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t);return this.enable(e.enabled),Object(j.a)(this.qParameter,e.q,i),Object(j.a)(this.cutoffParameter,e.frequency,i),Object(j.a)(this.typeParameter,e.type,i),Object(a.a)({},i,this.loadParameterFromJson(e,"qParameter",this.qParameter,t),this.loadParameterFromJson(e,"cutoffParameter",this.cutoffParameter,t),this.loadParameterFromJson(e,"typeParameter",this.typeParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(P),T=function(e){Object(u.a)(n,e);var t=S(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Auto Filter",function(){return new p.a.AutoFilter(4*new p.a.Time("1m"))},e)).qParameter=new v.c("Q",r.effectNode.filter.Q,{min:0,max:20,unit:"",defaultValue:1}),r.registerParameter(r.qParameter),r.effectNode.start(),r.effectNode.wet.value=1,r.storedLFOTime=4*new p.a.Time("1m"),r.updateInitialValues(),r}return Object(s.a)(n,[{key:"syncable",value:function(){return!0}},{key:"start",value:function(){this.effectNode.start()}},{key:"stop",value:function(){this.effectNode.stop()}},{key:"toggle",value:function(e){}},{key:"getLFOTime",value:function(){return new p.a.Time(this.effectNode.frequency.value).toNotation()}},{key:"getStoredLFOTime",value:function(){return this.storedLFOTime}},{key:"setLFOTime",value:function(e){this.storedLFOTime=e,this.effectNode.frequency.value=e}},{key:"lowpass",value:function(){this.effectNode.filter.type="lowpass"}},{key:"hipass",value:function(){this.effectNode.filter.type="highpass"}},{key:"getFilterType",value:function(){return this.effectNode.filter.type}},{key:"getJson",value:function(){return Object(a.a)({},Object(r.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{name:this.name,enabled:this.enabledParameter.get(),frequency:this.effectNode.frequency.value,storedLFOTime:this.storedLFOTime,baseFrequency:this.effectNode.baseFrequency,octaves:this.effectNode.octaves,q:this.effectNode.filter.Q.value,filterType:this.effectNode.filter.type})}},{key:"fromJson",value:function(e,t){Object(r.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.enable(e.enabled),this.effectNode.filter.Q.value=e.q,this.effectNode.frequency.value=e.frequency,this.effectNode.baseFrequency=e.baseFrequency,this.effectNode.octaves=e.octaves,this.storedLFOTime="storedLFOTime"in e?e.storedLFOTime:e.frequency,this.effectNode.filter.type=e.filterType}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(P),C=function(e){Object(u.a)(n,e);var t=S(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Pan",function(){return new p.a.Panner},e)).panParameter=new d.a("Panning",r.effectNode.pan,function(e,t){return e.value=t},{min:-1,max:1,unit:"",defaultValue:0}),r.registerParameter(r.panParameter),r.updateInitialValues(),r}return Object(s.a)(n,[{key:"toggle",value:function(e){}},{key:"setValue",value:function(e){this.value=e,this.panParameter.normalizedSet(e)}},{key:"getJson",value:function(){return Object(a.a)({},Object(r.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{name:this.name,enabled:this.enabledParameter.get(),value:this.value})}},{key:"fromJson",value:function(e,t){Object(r.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t);var a=new n;return a.setValue(this.value),a}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEnginei,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(P),N={ReverbEffect:function(e){Object(u.a)(n,e);var t=S(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Reverb",function(){return new p.a.Freeverb},e)).roomSizeParameter=new v.b("Room Size",r.effectNode.roomSize),r.registerParameter(r.roomSizeParameter),r.dampeningParameter=new v.a("Dampening",r.effectNode.dampening,function(e,t){return e.value=t},{min:0,max:1e4}),r.registerParameter(r.dampeningParameter),r.updateInitialValues(),r}return Object(s.a)(n,[{key:"setRoomSize",value:function(e){this.roomSizeParameter.set(e)}},{key:"setDampening",value:function(e){this.dampening.set(e)}},{key:"getDampening",value:function(){return this.effectNode.dampening.value}},{key:"getRoomSize",value:function(){return this.effectNode.roomSize.value}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEnginei,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"getJson",value:function(){var e=Object(a.a)({},Object(r.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{name:this.name,enabled:this.enabledParameter.get(),roomSize:this.roomSizeParameter.get(),wet:this.wetParameter.get(),dampening:this.dampeningParameter.get()});return(this.roomSizeParameter.isConnectedToAnyModulator()||Object.keys(this.roomSizeParameter.patternToValue).length>0)&&(e.roomSizeParameter=this.roomSizeParameter.getJson()),(this.dampeningParameter.isConnectedToAnyModulator()||Object.keys(this.dampeningParameter.patternToValue).length>0)&&(e.dampeningParameter=this.dampeningParameter.getJson()),e}},{key:"fromJson",value:function(e,t){Object(r.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.name=e.name,this.enable(e.enabled),"roomSize"in e&&this.roomSizeParameter.set(e.roomSize),"wet"in e&&this.wetParameter.set(e.wet),"dampening"in e&&this.dampeningParameter.set(e.dampening),this.loadParameterFromJson(e,"roomSizeParameter",this.roomSizeParameter,t),this.loadParameterFromJson(e,"dampeningParameter",this.dampeningParameter,t)}}]),n}(P),FilterEffect:x,TremoloEffect:function(e){Object(u.a)(n,e);var t=S(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Tremolo",function(){return new p.a.Tremolo},e)).effectNode.start(),r.rateParameter=new v.a("Rate",r.effectNode.frequency,function(e,t){return e.value=t},{min:0,max:32,defaultValue:0}),r.spreadParameter=new v.a("Spread",r.effectNode,function(e,t){return e.spread=t},{min:0,max:360,defaultValue:180}),r.depthParameter=new v.b("Depth",r.effectNode.depth),r.registerParameter(r.depthParameter),r.registerParameter(r.rateParameter),r.registerParameter(r.spreadParameter),r.updateInitialValues(),r}return Object(s.a)(n,[{key:"setRate",value:function(e){this.effectNode.frequency.value=e}},{key:"setDepth",value:function(e){this.effectNode.depth.value=e}},{key:"getRate",value:function(){return this.effectNode.frequency.value}},{key:"getDepth",value:function(){return this.effectNode.depth.value}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEnginei,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"getJson",value:function(){var e=Object(a.a)({},Object(r.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{name:this.name,enabled:this.enabledParameter.get(),depth:this.depthParameter.get(),spread:this.spreadParameter.get(),rate:this.rateParameter.get()});return(this.depthParameter.isConnectedToAnyModulator()||Object.keys(this.depthParameter.patternToValue).length>0)&&(e.depthParameter=this.depthParameter.getJson()),(this.spreadParameter.isConnectedToAnyModulator()||Object.keys(this.spreadParameter.patternToValue).length>0)&&(e.spreadParameter=this.spreadParameter.getJson()),(this.rateParameter.isConnectedToAnyModulator()||Object.keys(this.rateParameter.patternToValue).length>0)&&(e.rateParameter=this.rateParameter.getJson()),e}},{key:"fromJson",value:function(e,t){Object(r.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.name=e.name,this.enable(e.enabled),this.depthParameter.set(void 0!==e.depth?e.depth:1),this.spreadParameter.set(void 0!==e.spread?e.spread:180),this.wetParameter.set(void 0!==e.wet?e.wet:1),this.rateParameter.set(void 0!==e.rate?e.rate:1),this.loadParameterFromJson(e,"depthParameter",this.depthParameter,t),this.loadParameterFromJson(e,"spreadParameter",this.spreadParameter,t),this.loadParameterFromJson(e,"rateParameter",this.rateParameter,t)}}]),n}(P),AutoFilterEffect:T,ChorusEffect:function(e){Object(u.a)(n,e);var t=S(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Chorus",function(){return new p.a.Chorus},e)).rateParameter=new v.a("Rate",r.effectNode.frequency,function(e,t){e&&(e.value=t)},{min:0,max:32,defaultValue:.8}),r.registerParameter(r.rateParameter),r.depthParameter=new v.a("Depth",r.effectNode,function(e,t){return e.depth=t},{min:0,max:100,unit:"%",automatable:!1,defaultValue:.5}),r.registerParameter(r.depthParameter),r.updateInitialValues(),r}return Object(s.a)(n,[{key:"setRate",value:function(e){this.effectNode.frequency.value=e}},{key:"setDepth",value:function(e){this.effectNode.depth=e}},{key:"getRate",value:function(){return this.effectNode.frequency.value}},{key:"getDepth",value:function(){return this.effectNode.depth}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"dispose",value:function(){Object(r.a)(Object(f.a)(n.prototype),"dispose",this).call(this,!0)}},{key:"getJson",value:function(){var e=Object(a.a)({},Object(r.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{name:this.name,enabled:this.enabledParameter.get(!0),depth:this.depthParameter.get(!0),rate:this.rateParameter.get(!0)});return e=this.saveParameterToJson(e,"depthParameter",this.depthParameter),e=this.saveParameterToJson(e,"rateParameter",this.rateParameter)}},{key:"fromJson",value:function(e,t){var i=Object(r.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t);return this.name=e.name,this.enable(e.enabled),Object(j.a)(this.wetParameter,e.wet,i),Object(j.a)(this.depthParameter,e.depth,i),Object(j.a)(this.rateParameter,e.rate,i),Object(a.a)({},i,this.loadParameterFromJson(e,"rateParameter",this.rateParameter,t),this.loadParameterFromJson(e,"depthParameter",this.depthParameter,t))}}]),n}(P),PanEffect:C,Effect:P};t.a=N},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(55),s=function(){function e(){Object(a.a)(this,e)}return Object(i.a)(e,[{key:"getCopy",value:function(){var t=new e;return t.sequencerEngine=this.sequencerEngine,t.envelopesTrack=this.envelopesTrack,t.envelopeTrack=this.envelopeTrack,t.lfosTrack=this.lfosTrack,t.lfoTrack=this.lfoTrack,t.liveEffect=this.liveEffect,t.track=this.track,t.group=this.group,t.instrument=this.instrument,t.send=this.effect,t.effect=this.effect,t.midiEffect=this.midiEffect,t.subDevice=this.subDevice,t.macro=this.macro,t.formant=this.formant,t.oscillator=this.oscillator,t._subSequence=this._subSequence,t.zObject=this.zObject,t}},{key:"forZObject",value:function(e){return this.zObject=e,this}},{key:"forSequencerEngine",value:function(e){return this.sequencerEngine=e,this}},{key:"subSequence",get:function(){return this._subSequence?this._subSequence:void 0!==this.envelopesTrack?this.envelopesTrack.subSequence:void 0!==this.lfosTrack?this.lfosTrack.subSequence:void 0!==this.track?this.track.subSequence:void 0}},{key:"forEnvelopeTrack",value:function(e,t){return this.envelopeTrack=e,this.envelopesTrack=t,this}},{key:"forLFOTrack",value:function(e,t){return this.lfoTrack=e,this.lfosTrack=t,this}},{key:"forMacro",value:function(e){return this.macro=e,this}},{key:"forTrack",value:function(e){return this.track=e,this}},{key:"forGroup",value:function(e){return this.group=e,this}},{key:"forSend",value:function(e){return this.send=e,this}},{key:"forEffect",value:function(e){return this.effect=e,this}},{key:"forMidiEffect",value:function(e){return this.midiEffect=e,this}},{key:"forLiveEffect",value:function(e){return this.liveEffect=e,this}},{key:"forInstrument",value:function(e){return this.instrument=e,this}},{key:"forSubSequence",value:function(e){return this._subSequence=e,this}},{key:"forOscillator",value:function(e){return this.oscillator=e,this}},{key:"forSubDevice",value:function(e){return this.subDevice=e,this}},{key:"forFormant",value:function(e){return this.formant=e,this}},{key:"getEffectContext",value:function(){return void 0!==this.track?this.track:void 0!==this.group?this.group:void 0!==this.send?this.send:void 0}},{key:"getJson",value:function(){var e={},t=[];if(void 0!==this.track&&this.track.getTrackType&&this.track.getTrackType()===o.b&&(e=Object(r.a)({},e,{track:this.track.trackNumber,isInstrument:!0})),void 0!==this.track?(t=this.track.effects,e.track=this.track.trackNumber):void 0!==this.group?(t=this.group.effects,e.group=this.group.groupNumber):void 0!==this.send&&(t=this.send.effects,e.send=this.send.sendNumber),e.effect=-1,this.effect&&(t&&(e.effect=t.indexOf(this.effect),e.effectName=this.effect.name),this.subDevice&&this.effect.getSubDeviceIndex&&(e.subDevice=this.effect.getSubDeviceIndex(this.subDevice))),this.midiEffect&&this.track&&this.track.midiEffects&&(e.midiEffect=this.track.midiEffects.effects.indexOf(this.midiEffect),e.midiEffectName=this.midiEffect.name),this.liveEffect&&(e.liveEffect=this.track.liveEffects.effects.indexOf(this.liveEffect),e.liveEffectName=e.liveEffect.name),this.macro&&(e.macro=this.macro.id),this.instrument){e.isInstrument=!0;var n=void 0;this.subDevice&&(n=this.track.instrument.getSubDeviceIndex(this.subDevice)),e.subDevice=n,e.instrumentType=this.instrument.getInstrumentType&&this.instrument.getInstrumentType()}return e}},{key:"combineWith",value:function(e){return e.track&&(this.track=e.track),e.effect&&(this.effect=e.effect),e.subDevice&&(this.subDevice=e.subDevice),e.send&&(this.send=e.send),e._subSequence&&(this._subSequence=e._subSequence),this}}]),e}();t.a=s},,,,function(e,t,n){"use strict";var r=n(9),a=n(8),i=n(2),o=n(4),s=n(21),c=n(719),u=n(443),l=n(6),f=n(428),h=(n(15),n(33),n(45));function p(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}window.initStepDatas=0;var m=function(){function e(t,n,r,a){Object(i.a)(this,e);var o=void 0!==t?t.store:void 0;window.initStepDatas++,this.track=a,this.context=r,this.mixSession=n,this.sequencerEngine=t,this.stepNumber=void 0,this.position=0,this.id=Object(h.uuid)(),this.parameters=[],this.on=!1,this.pLockedParameters=[],this.hand=c.a,this.durationParameter=new s.a("Duration",this,function(e,t){return t},{min:.01,max:64,unit:"1/16th",defaultValue:null}),this.registerParameter(this.durationParameter,o,n,r),this.transposeParameter=new s.a("Transpose",this,function(e,t){return t},{min:-32,max:32,unit:"",defaultValue:null}),this.registerParameter(this.transposeParameter,o,n,r),this.chopParameter=new s.b("Chop",this,function(e,t){return t},{min:1,max:16,unit:"",defaultValue:null}),this.registerParameter(this.chopParameter,o,n,r),this.chopDurationParameter=new s.b("Chop Duration",this,function(e,t){return t},{min:1,max:32,unit:"",defaultValue:null}),this.registerParameter(this.chopDurationParameter,o,n,r),this.panningParameter=new s.a("Panning",this,function(e,t){return t},{min:-1,max:1,unit:"",defaultValue:null}),this.registerParameter(this.panningParameter,o,n,r),this.velocityParameter=new s.a("Velocity",this,function(e,t){return t},{min:0,max:1,unit:"",defaultValue:null}),this.registerParameter(this.velocityParameter,o,n,r),this.startParameter=new s.a("Start",this,function(e,t){return t},{min:0,max:100,unit:"%",defaultValue:null}),this.registerParameter(this.startParameter,o,n,r),this.attackParameter=new s.a("Attack",this,function(e,t){return t},{min:0,max:1e4,unit:"",defaultValue:null}),this.registerParameter(this.attackParameter,o,n,r),this.releaseParameter=new s.a("Release",this,function(e,t){return t},{min:0,max:1e4,unit:"",defaultValue:null}),this.registerParameter(this.releaseParameter,o,n,r),this.sliceParameter=new s.b("Slice",this,function(e,t){return t},{min:0,max:64,unit:"",defaultValue:null,automatable:!1}),this.registerParameter(this.sliceParameter,o,n,r),this.pitchAttackParameter=new s.a("Pitch Attack",this,function(e,t){return t},{min:.01,max:1e4,unit:"",defaultValue:null}),this.registerParameter(this.pitchAttackParameter,o,n,r),this.pitchDecayParameter=new s.a("Pitch Decay",this,function(e,t){return t},{min:.01,max:1e4,unit:"",defaultValue:null}),this.registerParameter(this.pitchDecayParameter,o,n,r),this.pitchSustainParameter=new s.a("Pitch Sustain",this,function(e,t){return t},{min:-10,max:10,unit:"",defaultValue:null}),this.registerParameter(this.pitchSustainParameter,o,n,r),this.pitchReleaseParameter=new s.a("Pitch Release",this,function(e,t){return t},{min:.01,max:1e4,unit:"",defaultValue:null}),this.registerParameter(this.pitchReleaseParameter,o,n,r),this.selectedRecordingParameter=new s.a("Selected Recording",this,function(e,t){return t},{min:1,max:100,unit:"",defaultValue:null}),this.registerParameter(this.selectedRecordingParameter,o,n,r),this.monophonicParameter=new s.a("Monophonic",this,function(e,t){return t},{min:!1,max:!0,unit:"",defaultValue:null}),this.registerParameter(this.monophonicParameter,o,n,r),this.reverseParameter=new s.a("reverse",this,function(e,t){return t},{min:0,max:1,unit:"",defaultValue:null,automatable:!1}),this.registerParameter(this.reverseParameter,o,n,r),this.transposeMatchParameter=new s.a("Transpose Match",this,function(e,t){return t},{min:0,max:20,unit:"",defaultValue:null}),this.registerParameter(this.transposeMatchParameter,o,n,r),this.paletteParameter=new s.a("Palette",this,function(e,t){return t},{min:0,max:20,unit:"",defaultValue:null}),this.registerParameter(this.paletteParameter,o,n,r),this.mutateParameter=new s.a("Mutate",this,function(e,t){return t},{min:-100,max:100,unit:"",defaultValue:null}),this.registerParameter(this.mutateParameter,o,n,r),this.probabilityParameter=new s.a("Probability",this,function(e,t){return t},{min:0,max:100,unit:"",defaultValue:null}),this.registerParameter(this.probabilityParameter,o,n,r),this.auxEventAParameter=new s.a("Aux Event A",this,function(e,t){return t},{min:0,max:100,unit:"",defaultValue:null}),this.registerParameter(this.auxEventAParameter,o,n,r),this.auxEventBParameter=new s.a("Aux Event B",this,function(e,t){return t},{min:0,max:100,unit:"",defaultValue:null}),this.registerParameter(this.auxEventBParameter,o,n,r),this.auxEventCParameter=new s.a("Aux Event C",this,function(e,t){return t},{min:0,max:100,unit:"",defaultValue:null}),this.registerParameter(this.auxEventCParameter,o,n,r),this.auxEventDParameter=new s.a("Aux Event D",this,function(e,t){return t},{min:0,max:100,unit:"",defaultValue:null}),this.registerParameter(this.auxEventDParameter,o,n,r),this.effectAutomations=new v,this.polyphonicSteps=[],this.nextStepData=void 0}return Object(o.a)(e,[{key:"registerParameter",value:function(e,t,n,r){e.setStore(t),void 0!==n&&e.setMixSession(n),void 0!==r&&e.setContext(r),e.track=this.track,this.parameters.push(e)}},{key:"triggerAutomations",value:function(e,t){null!==this.panningParameter.get()&&t.setPanning(this.panning,e);var n,r={},i=p(this.pLockedParameters);try{for(i.s();!(n=i.n()).done;){var o=n.value;r=Object(a.a)({},r,o.setForPLockedStep(this,e))}}catch(s){i.e(s)}finally{i.f()}return Object.keys(r).length>0&&t.store.dispatch(Object(l.Vb)(r)),this.pLockedParameters}},{key:"trackData",get:function(){return void 0!==this.track?this.track.trackData:this}},{key:"duration",get:function(){return null===this.durationParameter.get()?this.trackData.durationParameter.get():this.durationParameter.get()},set:function(e){this.durationParameter.set(e)}},{key:"panning",get:function(){return null===this.panningParameter.get()?this.trackData.panningParameter.get():this.panningParameter.get()},set:function(e){this.panningParameter.set(e)}},{key:"transpose",get:function(){return null===this.transposeParameter.get()?this.trackData.transposeParameter.get():this.transposeParameter.get()},set:function(e){this.transposeParameter.set(e)}},{key:"velocity",get:function(){return null===this.velocityParameter.get()?this.trackData.velocityParameter.get():this.velocityParameter.get()},set:function(e){this.velocityParameter.set(e)}},{key:"start",get:function(){return null===this.startParameter.get()?this.trackData.startParameter.get():this.startParameter.get()},set:function(e){this.startParameter.set(e)}},{key:"chop",get:function(){return null===this.chopParameter.get()?this.trackData.chopParameter.get():this.chopParameter.get()},set:function(e){this.chopParameter.set(e)}},{key:"chopDuration",get:function(){return null===this.chopDurationParameter.get()?this.trackData.chopDurationParameter.get():this.chopDurationParameter.get()},set:function(e){this.chopDurationParameter.set(e)}},{key:"slice",get:function(){return null===this.sliceParameter.get()?this.trackData.sliceParameter.get():this.sliceParameter.get()},set:function(e){this.sliceParameter.set(e)}},{key:"palette",get:function(){return null===this.paletteParameter.get()?this.trackData.paletteParameter.get():this.paletteParameter.get()},set:function(e){this.paletteParameter.set(e)}},{key:"probability",get:function(){return null===this.probabilityParameter.get()?this.trackData.probabilityParameter.get():this.probabilityParameter.get()},set:function(e){this.probabilityParameter.set(e)}},{key:"auxEventA",get:function(){return null===this.auxEventAParameter.get()?this.trackData.auxEventAParameter.get():this.auxEventAParameter.get()},set:function(e){this.auxEventAParameter.set(e)}},{key:"auxEventB",get:function(){return null===this.auxEventBParameter.get()?this.trackData.auxEventBParameter.get():this.auxEventBParameter.get()},set:function(e){this.auxEventBParameter.set(e)}},{key:"auxEventC",get:function(){return null===this.auxEventCParameter.get()?this.trackData.auxEventCParameter.get():this.auxEventCParameter.get()},set:function(e){this.auxEventCParameter.set(e)}},{key:"auxEventD",get:function(){return null===this.auxEventDParameter.get()?this.trackData.auxEventDParameter.get():this.auxEventDParameter.get()},set:function(e){this.auxEventDParameter.set(e)}},{key:"attack",get:function(){return null===this.attackParameter.get()?this.trackData.attackParameter.get():this.attackParameter.get()},set:function(e){this.attackParameter.set(e)}},{key:"release",get:function(){return null===this.releaseParameter.get()?this.trackData.releaseParameter.get():this.releaseParameter.get()},set:function(e){this.releaseParameter.set(e)}},{key:"pitchAttack",get:function(){return null===this.pitchAttackParameter.get()?this.trackData.pitchAttackParameter.get():this.pitchAttackParameter.get()},set:function(e){this.pitchAttackParameter.set(e)}},{key:"pitchDecay",get:function(){return null===this.pitchDecayParameter.get()?this.trackData.pitchDecayParameter.get():this.pitchDecayParameter.get()},set:function(e){this.pitchDecayParameter.set(e)}},{key:"pitchSustain",get:function(){return null===this.pitchSustainParameter.get()?this.trackData.pitchSustainParameter.get():this.pitchSustainParameter.get()},set:function(e){this.pitchSustainParameter.set(e)}},{key:"pitchRelease",get:function(){return null===this.pitchReleaseParameter.get()?this.trackData.pitchReleaseParameter.get():this.pitchReleaseParameter.get()},set:function(e){this.pitchReleaseParameter.set(e)}},{key:"reverse",get:function(){return null===this.reverseParameter.get()?this.trackData.reverseParameter.get():this.reverseParameter.get()},set:function(e){this.reverseParameter.set(e)}},{key:"transposeMatch",get:function(){return this.transposeMatchParameter.get()},set:function(e){this.transposeMatchParameter.set(e)}},{key:"mutate",get:function(){return this.mutateParameter.get()},set:function(e){this.mutateParameter.set(e)}},{key:"selectedRecording",get:function(){return null===this.selectedRecordingParameter.get()?this.trackData.selectedRecordingParameter.get():this.selectedRecordingParameter.get()},set:function(e){this.selectedRecordingParameter.set(e)}},{key:"monophonic",get:function(){return null===this.monophonicParameter.get()?this.trackData.monophonicParameter.get():this.monophonicParameter.get()},set:function(e){this.monophonicParameter.set(e)}},{key:"addStep",value:function(e){if(this===e||this.id===e.id||this.transpose===e.transpose)return e;if(void 0===this.nextStepData){if(!this.on)return e;this.nextStepData=e}else this.nextStepData=this.nextStepData.addStep(e);return this}},{key:"hasStep",value:function(e){return void 0!==e&&(this===e||this.id===e.id||void 0!==this.nextStepData&&this.nextStepData.hasStep(e))}},{key:"deleteStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this===e||this.id===e.id){if(void 0===this.nextStepData)return u.a;var n=this.nextStepData;return this.nextStepData=void 0,n}if(void 0!==this.nextStepData){var r=this.nextStepData.deleteStep(e,t+1);return r===u.a?this.nextStepData=void 0:void 0!==r&&(this.nextStepData=r),this}}},{key:"containsStep",value:function(e){return e.id===this.id||void 0!==this.nextStepData&&this.containsStep(this.nextStepData)}},{key:"getStepDataForTranspose",value:function(e,t){if(Math.round(this.transpose)==e||t&&null===this.transpose)return this;var n=this.getPolyphony(),r=-1;for(var a in n){var i=n[a];if(Math.round(i.transpose)==e||t&&null===i.transpose){r=a;break}}return-1!=r?n[r]:void 0}},{key:"deleteTranspose",value:function(e,t){if(this.transpose===e||t&&null===this.transpose){var n=this.polyphonicSteps;this.clear(),n.length>0&&(this.copyFrom(n[0]),this.polyphonicSteps=n.slice(1))}else{var r=this.polyphonicSteps.filter(function(n){return n.transpose==e||t&&null==n.transpose});if(r.length>0){var a=this.polyphonicSteps.indexOf(r[0]);this.polyphonicSteps.splice(a,1)}}}},{key:"getPolyphony",value:function(){for(var e=this,t=[];void 0!==e;)e.track=this.track,t.push(e),e=e.nextStepData;return t}},{key:"equals",value:function(e){return!(this.on!=e.on||this.duration!=e.duration||this.transpose!=e.transpose||this.chop!=e.chop||this.chopDuration!=e.chopDuration||this.velocity!=e.velocity||this.start!=e.start||this.panning!=e.panning||this.attack!=e.attack||this.reverse!=e.reverse||this.release!=e.release||this.slice!=e.slice||this.pitchAttack!==e.pitchAttack||this.pitchDecay!==e.pitchDecay||this.pitchSustain!==e.pitchSutain||this.selectedRecording!==e.selectedRecording||this.pitchRelease!==e.pitchRelease)}},{key:"simpleLoad",value:function(e,t,n,r){this.loadFromJson(e,t,void 0,void 0,void 0,n,r)}},{key:"loadFromJson",value:function(t,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0;return this.on=t.on,void 0!==t.id&&(this.id=t.id),this.slide=t.slide,this.duration=void 0===t.duration?null:t.duration,void 0!==t.durationParameter&&this.durationParameter.fromJson(t.durationParameter,o),this.panning=void 0===t.panning?null:t.panning,void 0!==t.transpose&&(this.transpose=t.transpose),this.transposeParameter.fromJson(t.transposeParameter,o),void 0!==t.velocity&&(this.velocity=t.velocity),this.velocityParameter.fromJson(t.velocityParameter,o),void 0!==t.start&&(this.start=t.start),this.startParameter.fromJson(t.startParameter,o),void 0!==t.chop&&(this.chop=t.chop),this.chopParameter.fromJson(t.chopParameter,o),this.chopDuration=void 0===t.chopDuration?null:t.chopDuration,void 0!==t.attack&&(this.attack=t.attack),this.attackParameter.fromJson(t.attackParameter,o),void 0!==t.release&&(this.release=t.release),this.releaseParameter.fromJson(t.releaseParameter,o),this.slice="slice"in t?t.slice:0,this.palette="palette"in t?t.palette:null,this.probability="probability"in t?t.probability:100,this.auxEventAParameter.fromJson(t.auxEventAParameter,o),this.auxEventBParameter.fromJson(t.auxEventBParameter,o),this.auxEventCParameter.fromJson(t.auxEventCParameter,o),this.auxEventDParameter.fromJson(t.auxEventDParameter,o),this.mutate="mutate"in t?t.mutate:null,void 0!==t.pitchAttack&&(this.pitchAttack=t.pitchAttack),this.pitchAttackParameter.fromJson(t.pitchAttackParameter,o),void 0!==t.pitchDecay&&(this.pitchDecay=t.pitchDecay),this.pitchDecayParameter.fromJson(t.pitchDecayParameter,o),void 0!==t.pitchSustain&&(this.pitchSustain=t.pitchSustain),this.pitchSustainParameter.fromJson(t.pitchSustainParameter,o),void 0!==t.pitchRelease&&(this.pitchRelease=t.pitchRelease),this.pitchReleaseParameter.fromJson(t.pitchReleaseParameter,o),void 0!==t.selectedRecording&&(this.selectedRecording=t.selectedRecording),this.monophonicParameter.fromJson(t.monophonicParameter,o),void 0!==t.monophonic&&(this.monophonic=t.monophonic),this.selectedRecordingParameter.fromJson(t.selectedRecordingParameter,o),this.reverse=void 0===t.reverse?a:t.reverse,void 0!==t.effectAutomations&&this.loadAutomations(t.effectAutomations,s,n,c),"polyphonicSteps"in t&&!i&&(t.polyphonicSteps.map(function(t){var n=new e;return n.stepNumber=r.stepNumber,n.loadFromJson(t,void 0,null,!0),n}).forEach(function(e){return r.addStep(e)}),this.nextStepData),t.pLockedParameters&&(this.pLockedParameterIds=t.pLockedParameters),t.group&&this.track&&(this.group=this.track.getGroupForId(t.group),this.group&&(this.group.steps||(this.group.steps=[]),this.group.steps.push(this))),this}},{key:"loadParameterLocks",value:function(){var e=this.pLockedParameterIds;if(e&&this.pLockedParameterIds.length>0){var t=[].concat(Object(r.a)(this.track.getAllParameters()),Object(r.a)(this.track.sequencerEngine.currentSubSequence.getAllParameters()),Object(r.a)(this.track.sequencerEngine.envelopes.flatMap(function(e){return e.parameters})),Object(r.a)(this.track.sequencerEngine.lfos.flatMap(function(e){return e.lfo.parameters})));this.pLockedParameters=t.filter(function(t){return e.includes(t.id)})}}},{key:"clearAutomations",value:function(){this.automations.clear()}},{key:"loadAutomations",value:function(e,t,n,r){for(var a=0;a<e.length;a++){var i=e[a],o=i.effectNumber,s=i.parameterName,c=i.value,u=n[o],l=r[o];void 0!==u&&this.findAutomationParameter(u,s,o,c),void 0!==l&&this.findAutomationParameter(l,s,o,c),void 0===o&&this.findAutomationInstrumentParameter(t.instrument,i,s,c)}}},{key:"findAutomationParameter",value:function(e,t,n,r){var a=e.parameters.filter(function(e){return t===e.name});if(a.length>0){var i=a[0];this.effectAutomations.set(i,new f.a(n,i,r))}}},{key:"findAutomationInstrumentParameter",value:function(e,t,n,r){var i=e.findParameter(t,n),o=Object(a.a)({},t);delete o.name,delete o.value,delete o.effectNumber,void 0!==i&&this.effectAutomations.set(i,new f.a(void 0,i,r,o))}},{key:"loadDefaults",value:function(){this.on=!1,this.reverse=!1,this.mutate=0,this.transpose=0,this.duration=1,this.velocity=1,this.start=0,this.chop=1,this.chopDuration=1,this.attack=0,this.panning=0,this.release=15,this.slice=0,this.probability=100,this.auxEventA=0,this.auxEventB=0,this.auxEventC=0,this.auxEventD=0,this.pitchAttack=.01,this.pitchDecay=.01,this.pitchSustain=0,this.pitchRelease=.01,this.monophonic=!1,this.selectedRecording=0}},{key:"clear",value:function(){this.on=!1,this.reverse=null,this.transpose=null,this.panning=null,this.duration=null,this.velocity=null,this.start=null,this.chop=null,this.chopDuration=null,this.attack=null,this.release=null,this.pitchAttack=null,this.pitchDecay=null,this.pitchRelease=null,this.pitchSustain=null,this.selectedRecording=null,this.probability=null,this.transposeMatch=null,this.slice=null,this.polyphonicSteps=[],this.nextStepData=void 0,this.monophonic=null,this.mutate=null,this.auxEventA=null,this.auxEventB=null,this.auxEventC=null,this.auxEventD=null}},{key:"getCopy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],c=void 0;c=void 0!==this.stepDataCopy&&o?this.stepDataCopy:i?new e:new e(this.sequencerEngine,this.mixSession),s&&(this.stepDataCopy=c),c.stepNumber=this.stepNumber,n&&(c.id=this.id),c.track=this.track,c.group=this.group,c.position=this.position,c.on=this.on,c.slide=this.slide,c.effectAutomations=this.effectAutomations.getCopy(),c.durationParameter.copyFrom(this.durationParameter,this.sequencerEngine,a),c.chopParameter.copyFrom(this.chopParameter,this.sequencerEngine,a),c.panningParameter.copyFrom(this.panningParameter,this.sequencerEngine,a),c.transposeParameter.copyFrom(this.transposeParameter,this.sequencerEngine,a),c.velocityParameter.copyFrom(this.velocityParameter,this.sequencerEngine,a),c.startParameter.copyFrom(this.startParameter,this.sequencerEngine,a),c.attackParameter.copyFrom(this.attackParameter,this.sequencerEngine,a),c.releaseParameter.copyFrom(this.releaseParameter,this.sequencerEngine,a),c.auxEventAParameter.copyFrom(this.auxEventAParameter,this.sequencerEngine,a),c.auxEventBParameter.copyFrom(this.auxEventBParameter,this.sequencerEngine,a),c.auxEventCParameter.copyFrom(this.auxEventCParameter,this.sequencerEngine,a),c.auxEventDParameter.copyFrom(this.auxEventDParameter,this.sequencerEngine,a),c.sliceParameter.copyFrom(this.sliceParameter,this.sequencerEngine,a),c.transposeMatchParameter.copyFrom(this.transposeMatchParameter,this.sequencerEngine,a),t||this.getPolyphony().map(function(e){return e.getCopy(!0,n,a,i,o)}).slice(1).forEach(function(e){return c.addStep(e)}),c.pitchAttackParameter.copyFrom(this.pitchAttackParameter,this.sequencerEngine,a),c.pitchDecayParameter.copyFrom(this.pitchDecayParameter,this.sequencerEngine,a),c.pitchSustainParameter.copyFrom(this.pitchSustainParameter,this.sequencerEngine,a),c.pitchReleaseParameter.copyFrom(this.pitchReleaseParameter,this.sequencerEngine,a),c.selectedRecordingParameter.copyFrom(this.selectedRecordingParameter,this.sequencerEngine,a),c.monophonicParameter.copyFrom(this.monophonicParameter,this.sequencerEngine,a),c.paletteParameter.copyFrom(this.paletteParameter,this.sequencerEngine,a),c.reverse=this.reverse,c.probability=this.probability,c.pLockedParameters=Object(r.a)(this.pLockedParameters);var u,l=p(c.pLockedParameters);try{for(l.s();!(u=l.n()).done;){var f=u.value;f.stepToValue[c.id]=f.stepToValue[this.id]}}catch(h){l.e(h)}finally{l.f()}return c}},{key:"copyFrom",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&(this.on=e.on,this.stepNumber=e.stepNumber,this.duration=e.durationParameter.get(),this.panning=e.panningParameter.get(),this.chop=e.chopParameter.get(),this.chopDuration=e.chopDurationParameter.get(),this.transpose=e.transposeParameter.get(),this.velocity=e.velocityParameter.get(),this.start=e.startParameter.get(),this.attack=e.attackParameter.get(),this.release=e.releaseParameter.get(),this.slice=e.sliceParameter.get(),this.pitchAttack=e.pitchAttackParameter.get(),this.pitchDecay=e.pitchDecayParameter.get(),this.pitchSustain=e.pitchSustainParameter.get(),this.pitchRelease=e.pitchReleaseParameter.get(),this.palette=e.paletteParameter.get(),this.probability=e.probabilityParameter.get(),this.selectedRecording=e.selectedRecordingParameter.get(),this.transposeMatch=e.transposeMatchParameter.get(),this.monophonic=e.monophonicParameter.get(),this.reverse=e.reverse,n||e.getPolyphony().slice(1).map(function(e){return e.getCopy()}).forEach(function(e){return t.addStep(e)}))}},{key:"getJson",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={on:this.on,id:this.pLockedParameters&&this.pLockedParameters.length>0?this.id:void 0,slide:this.slide};if(this.group&&(t.group=this.group.id),this.pLockedParameters&&this.pLockedParameters.length>0&&(t.pLockedParameters=this.pLockedParameters.map(function(e){return e.id})),this.reverse&&(t.reverse=this.reverse),(this.durationParameter.lfos.length>0||Object.keys(this.durationParameter.patternToValue).length>0||null!==this.durationParameter.get())&&this.durationParameter.store&&(t.durationParameter=this.durationParameter.getJson()),null!==this.durationParameter.get()&&(t.duration=this.duration),null!==this.probabilityParameter.get()&&100!==this.probability&&(t.probability=this.probability),null!==this.velocityParameter.get()&&(t.velocity=this.velocity),null!==this.panningParameter.get()&&(t.panning=this.panning),(this.chopParameter.lfos.length>0||Object.keys(this.chopParameter.patternToValue).length>0||null!==this.chopParameter.get())&&(t.chopParameter=this.chopParameter.getJson()),(this.transposeParameter.lfos.length>0||Object.keys(this.transposeParameter.patternToValue).length>0||null!==this.transposeParameter.get())&&(t.transposeParameter=this.transposeParameter.getJson()),(this.velocityParameter.lfos.length>0||Object.keys(this.velocityParameter.patternToValue).length>0||null!==this.velocityParameter.get())&&this.velocityParameter.store&&(t.velocityParameter=this.velocityParameter.getJson()),null!==this.auxEventAParameter.get()&&(t.auxEventAParameter=this.auxEventAParameter.getJson()),null!==this.auxEventBParameter.get()&&(t.auxEventBParameter=this.auxEventBParameter.getJson()),null!==this.auxEventCParameter.get()&&(t.auxEventCParameter=this.auxEventCParameter.getJson()),null!==this.auxEventDParameter.get()&&(t.auxEventDParameter=this.auxEventDParameter.getJson()),(this.startParameter.lfos.length>0||Object.keys(this.startParameter.patternToValue).length>0||null!==this.startParameter.get())&&(t.startParameter=this.startParameter.getJson()),(this.attackParameter.lfos.length>0||Object.keys(this.attackParameter.patternToValue).length>0||null!==this.attackParameter.get())&&(t.attackParameter=this.attackParameter.getJson()),null!==this.attackParameter.get()&&(t.attack=this.attack),(this.releaseParameter.lfos.length>0||Object.keys(this.releaseParameter.patternToValue).length>0||null!=this.releaseParameter.get())&&(t.releaseParameter=this.releaseParameter.getJson()),this.slice&&(t.slice=this.slice),null!==this.palette&&(t.palette=this.palette),null!==this.mutate&&(t.mutate=this.mutate),(this.pitchAttackParameter.lfos.length>0||Object.keys(this.pitchAttackParameter.patternToValue).length>0||null!=this.pitchAttackParameter.get())&&(t.pitchAttackParameter=this.pitchAttackParameter.getJson()),(this.pitchDecayParameter.lfos.length>0||Object.keys(this.pitchDecayParameter.patternToValue).length>0||null!=this.pitchDecayParameter.get())&&(t.pitchDecayParameter=this.pitchDecayParameter.getJson()),(this.pitchSustainParameter.lfos.length>0||Object.keys(this.pitchSustainParameter.patternToValue).length>0||null!=this.pitchSustainParameter.get())&&(t.pitchSustainParameter=this.pitchSustainParameter.getJson()),(this.pitchReleaseParameter.lfos.length>0||Object.keys(this.pitchReleaseParameter.patternToValue).length>0||null!=this.pitchReleaseParameter.get())&&(t.pitchReleaseParameter=this.pitchReleaseParameter.getJson()),(this.selectedRecordingParameter.lfos.length>0||Object.keys(this.selectedRecordingParameter.patternToValue).length>0||null!=this.selectedRecordingParameter.get())&&(t.selectedRecordingParameter=this.selectedRecordingParameter.getJson()),(Object.keys(this.monophonicParameter.patternToValue).length>0||null!=this.monophonicParameter.get())&&(t.monophonicParameter=this.monophonicParameter.getJson()),!e){var n=this.getPolyphony().slice(1).map(function(e){return e.getJson(!0)});n.length>0&&(t.polyphonicSteps=n)}return this.effectAutomations.automations.length>0&&(t.effectAutomations=this.effectAutomations.automations.map(function(e){return e.getJson()})),t}}]),e}(),v=function(){function e(){Object(i.a)(this,e),this.automations=[]}return Object(o.a)(e,[{key:"clear",value:function(){this.automations=[]}},{key:"get",value:function(e){var t=this.automations.filter(function(t){return t.parameter===e});if(t.length>0)return t[0]}},{key:"delete",value:function(e){var t=-1;for(var n in this.automations)this.automations[n].parameter===e&&(t=n);-1!==t&&this.automations.splice(t,1)}},{key:"set",value:function(e,t){this.automations.push(t)}},{key:"trigger",value:function(e,t){this.automations.forEach(function(n){return n.setAtTime(e,t)})}},{key:"isEmpty",value:function(){return 0==this.automations.length}},{key:"forAudioEffects",value:function(){return this.automations.filter(function(e){return e.parameter.context.effect}).filter(function(e){return!e.parameter.context.effect.isMidiEffect()})}},{key:"forMidiEffects",value:function(){return this.automations.filter(function(e){return e.parameter.context.effect}).filter(function(e){return e.parameter.context.effect.isMidiEffect()})}},{key:"forInstruments",value:function(){return this.automations.filter(function(e){return e.parameter.context.track}).filter(function(e){return void 0!==e.parameter.context.track.instrument})}},{key:"getCopy",value:function(){var t=new e;return t.automations=this.automations.map(function(e){return e.getCopy()}),t}}]),e}();t.a=m},function(e,t,n){"use strict";function r(e){return!isNaN(parseFloat(e))&&isFinite(e)}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o={C:0,"C#":1,D:2,"D#":3,E:4,F:5,"F#":6,G:7,"G#":8,A:9,"A#":10,B:11},s={"C#":!0,"D#":!0,"F#":!0,"G#":!0,"A#":!0},c={},u=function(){function e(t,n){Object(r.a)(this,e),void 0===t&&(t="C"),this.note=t.toUpperCase(),this.octave=n}return Object(a.a)(e,[{key:"isBlackNote",value:function(){return s[this.note]}},{key:"transpose",value:function(t){this.note;var n=Math.floor(f(t,12)),r=Math.floor(t/12);return new e(i[n],this.octave+r)}},{key:"addTranspose",value:function(t){var n=o[this.note],r=Math.floor(f(t+n,12)),a=Math.floor((t+n)/12);return new e(i[r],this.octave+a)}},{key:"toString",value:function(){return this.note+this.octave}},{key:"getTranspose",value:function(){this.noteIndex();return 12*(this.octave-l.octave)+(this.noteIndex()-l.noteIndex())}},{key:"noteIndex",value:function(){return o[this.note]}},{key:"getCopy",value:function(){return new e(this.note,this.octave)}},{key:"equal",value:function(e){return this.note===e.note&&this.octave===e.octave}}]),e}(),l=new u("C",3);function f(e,t){return(e%t+t)%t}function h(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t&&c[e])return c[e];var n=void 0;return n="#"===e.substring(1,2)?new u(e.substring(0,2),parseInt(e.substring(2))):new u(e.substring(0,1),parseInt(e.substring(1))),t&&(c[e]=n),n}for(var p=i.map(function(e){return new u(e,3)}),d=0;d<16;d++)for(var m in i){h(i[m]+d)}t.a={Note:u,middleC:l,fromString:h,fromTranspose:function(e){return l.getCopy().transpose(e)},NOTES:p,baseNotes:i}},,function(e,t,n){"use strict";(function(e){n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s});var r=n(36),a=n(229);function i(e){var t=a.decode(e).toString("hex").replace(/^1220/,"");return 64!=t.length?null:"0x"+t}function o(t){var n=new e(t.replace(/^0x/,"1220"),"hex");return a.encode(n)}function s(e){for(var t=r.a.utils.fromAscii(e),n=t.length;n<=65;n++)t+="0";return t}}).call(this,n(27).Buffer)},,function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"h",function(){return a}),n.d(t,"j",function(){return i}),n.d(t,"q",function(){return o}),n.d(t,"o",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"w",function(){return u}),n.d(t,"g",function(){return l}),n.d(t,"z",function(){return f}),n.d(t,"b",function(){return h}),n.d(t,"n",function(){return p}),n.d(t,"f",function(){return d}),n.d(t,"v",function(){return m}),n.d(t,"y",function(){return v}),n.d(t,"B",function(){return b}),n.d(t,"A",function(){return g}),n.d(t,"a",function(){return y}),n.d(t,"l",function(){return k}),n.d(t,"m",function(){return O}),n.d(t,"r",function(){return j}),n.d(t,"s",function(){return w}),n.d(t,"t",function(){return E}),n.d(t,"u",function(){return S}),n.d(t,"p",function(){return P}),n.d(t,"k",function(){return x}),n.d(t,"d",function(){return T}),n.d(t,"x",function(){return C}),n.d(t,"e",function(){return N});var r="ADD_STEP",a="DELETE_STEP",i="DELETE_STEP_NUMBER",o="RECORD_STEP",s="MOVE_STEPS",c="DELETE_STEPS",u="TOGGLE_STEP",l="DELETE_PATTERN",f="UPDATE_STEP_PARAMETER",h="ADD_EFFECT",p="MOVE_EFFECT",d="DELETE_EFFECT",m="TOGGLE_EFFECT",v="UPDATE_PARAMETER",b="UPDATE_TRACK_VOLUME",g="UPDATE_TRACK_MUTE",y="ADD_AUTOMATION_BREAK_POINT",k="MOVE_AUTOMATION_BREAK_POINT",O="MOVE_AUTOMATION_BREAK_POINTS",j="REMOVE_AUTOMATION_BREAK_POINT",w="REMOVE_AUTOMATION_BREAK_POINTS",E="SNAP_AUTOMATION_BREAK_POINT",S="SNAP_TO_GRID",P="RECORD_AUTOMATION",x="LOAD_PROJECT_TRACKS",T="AUDITION_PRESET",C="UNMAP_PLANAR_PARAMETERS",N=[o,P,v]},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"===typeof e?e.apply(void 0,n):e}},function(e,t,n){"use strict";n.d(t,"h",function(){return r}),n.d(t,"g",function(){return a}),n.d(t,"i",function(){return i}),n.d(t,"f",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return f});var r="SAMPLER",a="SAMPLED_INSTRUMENT",i="SYNTH",o="MULTI_SYNTH",s="FM_SYNTH",c="METAL_SYNTH",u="EXTERNAL_INSTRUMENT",l="EFFECTS",f={SAMPLER:"Sampler",SYNTH:"Synth",MULTI_SYNTH:"Synth",FM_SYNTH:"FM Synth",EXTERNAL_INSTRUMENT:"External Instrument",SAMPLED_INSTRUMENT:"Sampled Instrument",INSTRUMENT_RACK:"Instrument Rack",METAL_SYNTH:"Metal Synth",EFFECTS:"FX"}},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(9),o=n(14),s=n(2),c=n(4),u=n(52);function l(e,t){return f.apply(this,arguments)}function f(){return(f=Object(o.a)(a.a.mark(function e(t,n){var r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.eth.getTransaction(t);case 3:return r=e.sent,e.next=6,n.eth.getBlockNumber();case 6:return i=e.sent,e.abrupt("return",r&&null!==r.blockNumber?i-r.blockNumber:0);case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}var h=n(6),p=n(44),d={AUTHORIZER:{authorize:p.y.AUTHORIZER.methods.authorize,revoke:p.y.AUTHORIZER.methods.revoke},USERS:{setName:p.y.USERS.methods.setName,setProfileHash:p.y.USERS.methods.setProfileHash},TOKENIZED_SEQUENCES:{editSequence:p.y.TOKENIZED_SEQUENCES.methods.editSequence,buyTokens:p.y.TOKENIZED_SEQUENCES.methods.buyTokens},GUILD_SEQUENCES:{editSequence:p.y.GUILD_SEQUENCES.methods.editSequence},GUILD_PRESETS:{newPreset:p.y.GUILD_PRESETS.methods.newPreset,tagPreset:p.y.GUILD_PRESETS.methods.tagPreset},GUILDS:{newGuild:p.y.GUILDS.methods.newGuild,requestToAddMember:p.y.GUILDS.methods.requestToAddMember,leaveGuild:p.y.GUILDS.methods.leaveGuild,acceptRequestToAddToGuild:p.y.GUILDS.methods.acceptRequestToAddToGuild,rejectRequestToAddToGuild:p.y.GUILDS.methods.requestRequestToAddToGuild},GUILD_SAMPLES:{newSamplesWithMetadata:p.y.GUILD_SAMPLES.methods.newSamplesWithMetadata,newSampleWithMetadata:p.y.GUILD_SAMPLES.methods.newSampleWithMetadata,newEncryptedSamples:p.y.GUILD_SAMPLES.methods.newEncryptedSamples},ENCRYPTION:{setPublicKey:p.y.ENCRYPTION.methods.setPublicKey,newEncryptedContent:p.y.ENCRYPTION.methods.newEncryptedContent,shareEncryptedContentWith:p.y.ENCRYPTION.methods.newEncryptedContent},FOLDERS:{foldersUpdated:p.y.FOLDERS.methods.foldersUpdated},MESSAGING:{sendPublicMessage:p.y.MESSAGING.methods.sendPublicMessage},SEQUENCE_METADATA:{tagSequence:p.y.SEQUENCE_METADATA.methods.tagSequence,starSequence:p.y.SEQUENCE_METADATA.methods.starSequence,favoriteSequence:p.y.SEQUENCE_METADATA.methods.favoriteSequence,unfavoriteSequence:p.y.SEQUENCE_METADATA.methods.unfavoriteSequence,unstarSequence:p.y.SEQUENCE_METADATA.methods.unstarSequence},RESAMPLE:{newResample:p.y.RESAMPLE.methods.newResample},XANADU:{newDataType:p.y.XANADU.methods.newDataType,newLinkType:p.y.XANADU.methods.newLinkType,newAnnotationType:p.y.XANADU.methods.newAnnotationType,newLink:p.y.XANADU.methods.newLink,newLinks:p.y.XANADU.methods.newLinks,newAnnotation:p.y.XANADU.methods.newAnnotation},MIX:{newMix:p.y.MIX.methods.newMix},EFFECTS:{newEffect:p.y.EFFECTS.methods.newEffect},FAVORITES:{favoriteSample:p.y.FAVORITES.methods.favoriteSample,unfavoriteSample:p.y.FAVORITES.methods.unfavoriteSample},ARTISTS:{newRelease:p.y.ARTISTS.methods.newRelease,newArtistInfo:p.y.ARTISTS.methods.newArtistInfo,newSampleByArtist:p.y.ARTISTS.methods.newSampleByArtist},GUILD_SETTINGS:{leaveGuild:p.y.GUILD_SETTINGS.methods.guildSettings,userChoseDefaultGuild:p.y.GUILD_SETTINGS.methods.userChoseDefaultGuild,createGuildWithPeople:p.y.GUILD_SETTINGS.methods.createGuildWithPeople},MIDI_CC:{newMidiCCParameter:p.y.MIDI_CC.methods.newMidiCCParameter},EXPLORE_LISTS:{editList:p.y.EXPLORE_LISTS.methods.editList,bulkEdit:p.y.EXPLORE_LISTS.methods.bulkEdit,deleteList:p.y.EXPLORE_LISTS.methods.deleteList,highlightList:p.y.EXPLORE_LISTS.methods.highlightList,unhighlightList:p.y.EXPLORE_LISTS.methods.unhighlightList,favoriteList:p.y.EXPLORE_LISTS.methods.favoriteList,unfavoriteList:p.y.EXPLORE_LISTS.methods.unfavoriteList},WALLPAPER:{newWallpaper:p.y.WALLPAPER.methods.newWallpaper,setDefaultWallpaper:p.y.WALLPAPER.methods.setDefaultWallpaper},PACKS:{newPack:p.y.PACKS.methods.newPack},SCRIPTS:{newScript:p.y.SCRIPTS.methods.newScript},NFT:{newProject:p.y.NFT.methods.newProject,mint:p.y.NFT.methods.mint},ZPROJECTS:{editSequence:p.y.ZPROJECTS.methods.editSequence,zoraProject:p.y.ZPROJECTS.methods.zoraProject},PLUGINS:{createPlugin:p.y.PLUGINS.methods.createPlugin,updatePlugin:p.y.PLUGINS.methods.updatePlugin},PROJECT_METADATA:{newProjectMetadata:p.y.PROJECT_METADATA.methods.newProjectMetadata}},m=n(30),v=function(){function e(t,n,r,a){Object(s.a)(this,e),this.contract=t,this.method=n,this.arguments=r,this.value=a}return Object(c.a)(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=Object(o.a)(a.a.mark(function t(n,r){var s,c,l;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.getAccount();case 2:if(void 0!==(s=t.sent)){t.next=6;break}return r(),t.abrupt("return");case 6:m.a.isMetamaskInstalled()?(l={from:s},e.value&&(l.value=e.value),(c=d[e.contract])[e.method].apply(c,Object(i.a)(e.arguments)).send(l,function(e,t){e?r(e):n()})):(console.log("runnign transaction"),fetch("/transaction/",{method:"POST",body:JSON.stringify(e.getJson()),headers:{Accept:"application/json","Content-Type":"application/json"},withCredentials:!0}).then(function(){var t=Object(o.a)(a.a.mark(function t(r){var i,o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("returned ="),t.next=3,r.json();case 3:i=t.sent,o=i.transactionHash,console.log("transaction hash = "+o),e.newPendingTransaction(o),e.waitForConfirmation(o),n();case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()));case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"transactions",get:function(){return m.a.store.getState().transactions.pendingTransactions},set:function(e){m.a.store.dispatch(Object(h.Yd)(e))}},{key:"newPendingTransaction",value:function(e){this.transactions=[].concat(Object(i.a)(this.transactions),[e])}},{key:"waitForConfirmation",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;setTimeout(Object(o.a)(a.a.mark(function r(){return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l(e,m.a.web3);case 2:if(!(r.sent>=n)){r.next=6;break}return t.onConfirm(e),r.abrupt("return");case 6:return r.abrupt("return",t.waitForConfirmation(e,n));case 7:case"end":return r.stop()}},r)})),3e4)}},{key:"onConfirm",value:function(e){var t=Object(i.a)(this.transactions),n=t.indexOf(e);n>-1&&(t.splice(n,1),this.transactions=t)}},{key:"getJson",value:function(){return{contract:this.contract,method:this.method,arguments:this.arguments,token:u.a.getToken(),value:this.value}}}]),e}();t.a=v},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"d",function(){return o});var r="AUDIO_FX",a="MIDI_FX",i="LIVE_FX",o="OSCILLATOR"},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(380),a=Object(r.a)()},,,function(e,t,n){"use strict";var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(7),l=n(10),f=n(1),h=(n(196),n(888)),p=n(52),d=n(92),m=n(141),v=n(658),b=n(254),g=n(297),y=n(718),k=n(222),O=n(517),j=n(15),w=n.n(j),E=n(762),S=n(30),P=n(47),x=(n(1036),n(423)),T=n(62),C=(n(693),n(29));function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var R=n(588),M=new C.a,A=function(e){Object(u.a)(n,e);var t=N(n);function n(e,r,a){var i;return Object(s.a)(this,n),i=t.call(this),"number"==typeof e||Object(T.a)(e)?i.soundId=e:i.ipfsHash=e,i.guildId=a,i.downloadUrl=void 0,i.videoId=void 0,i.name=void 0,i.tags=void 0,i.slices=void 0,i.noteSequence=void 0,i.packs=[],i.isStems=!1,i.styles=[],i.guildId=void 0,r?i.encryptedIpfs=r:window.sequencerEngine&&(i.encryptedIpfs=new x.a(window.sequencerEngine.store,window.sequencerEngine.ethereum.guilds,window.sequencerEngine.ethereum.encryption,window.sequencerEngine.ethereum.crypto)),i.audioBuffer=void 0,i.addedToProject=!1,i.highlightedTags={},i.samplesUsed=[],i}return Object(c.a)(n,[{key:"getName",value:function(){return this.name}},{key:"getTagsToSave",value:function(){var e=this;return Object.keys(this.highlightedTags).length>0?Object.keys(this.highlightedTags).filter(function(t){return e.highlightedTags[t]}):this.tags}},{key:"getId",value:function(){return void 0!==this.ipfsHash?this.ipfsHash:this.soundId}},{key:"fromJson",value:function(e){this.ipfsHash=e.id,this.name=e.name,this.videoId=e.videoId,this.tags=e.tags||[],this.slices=e.slices,this.coverArtHash=e.coverArtHash,this.discogsId=e.discogsId}},{key:"dispose",value:function(){!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.addedToProject||(this.audioBuffer=void 0,this.discogsId=void 0,this.videoId=void 0,this.coverArtHash=void 0,this.slices=void 0,this.packs=void 0)}},{key:"isLoaded",value:function(){return void 0!==this.audioBuffer}},{key:"getJson",value:function(){return{id:this.getId(),slices:this.slices,name:this.name,videoId:this.videoId,tags:this.tags,thumbnail:this.getThumbnail(),discogsId:this.discogsId,coverArtHash:this.coverArtHash}}},{key:"fetchMetadata",value:function(){var e=this;if(void 0!==this.ipfsHash)return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){var a,o,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.a.getTitleForSound(e.ipfsHash);case 2:return a=t.sent,t.next=5,S.a.getVideoIdForSound(e.ipfsHash);case 5:return o=t.sent,t.next=8,S.a.getCoverArtForSound(e.ipfsHash);case 8:s=t.sent,void 0!==a&&(e.name=a),void 0!==o&&(e.videoId=o),void 0!==s&&(e.coverArtHash=s),n(e);case 13:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"fetchTags",value:function(){var e=this;return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e.soundId||void 0===e.ipfsHash){t.next=11;break}return t.t0=Set,t.next=4,S.a.getTagsForSound(e.ipfsHash);case 4:return t.t1=t.sent,a=new t.t0(t.t1),e.tags=Array.from(a)||[],n(e.tags||[]),t.abrupt("return");case 11:n([]);case 12:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"fetchSlices",value:function(){var e=this;return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:S.a.getSlicesForSound(e.ipfsHash).then(function(t){e.slices=t,n(t)});case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"fetchAudio",value:function(){var e=this;return new Promise(function(t,n){void 0!==e.ipfsHash&&e.fetchAudioFromIPFS().then(function(e){return t(e)}).catch(function(e){n("timed out")})})}},{key:"fetchAudioFromIPFS",value:function(){var e=this;return new Promise(function(t,n){var r=(new Date).getTime();e.encryptedIpfs.getSound(e.ipfsHash).then(function(){var a=Object(o.a)(i.a.mark(function a(o){var s;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(void 0!==o){a.next=3;break}return n(),a.abrupt("return");case 3:if(s=(new Date).getTime(),s-r,a.prev=5,a.prev=6,"RIFF"!==(new TextDecoder).decode(o.slice(0,4))){a.next=14;break}return a.next=11,w.a.Master.context.decodeAudioData(R(o));case 11:e.audioBuffer=a.sent,a.next=19;break;case 14:return(new Date).getTime(),a.next=17,Object(h.a)(o);case 17:e.audioBuffer=a.sent,(new Date).getTime();case 19:t(e),a.next=24;break;case 22:a.prev=22,a.t0=a.catch(6);case 24:a.next=29;break;case 26:a.prev=26,a.t1=a.catch(5),n(a.t1);case 29:case"end":return a.stop()}},a,null,[[5,26],[6,22]])}));return function(e){return a.apply(this,arguments)}}()).catch(function(e){n(e)})})}},{key:"fetchGuild",value:function(){var e=Object(o.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.guildSamples.getGuildIdForSound(this.getId());case 2:this.guildId=e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"analyze",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(void 0===this.tempo){var n=Object(E.a)(this.audioBuffer,e,t),r=n.tempo,a=n.onsets;this.tempo=r,this.onsets=a}}},{key:"fetchNoteSequence",value:function(){var e=this;return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n(e.noteSequence);case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getThumbnail",value:function(){return this.coverArtHash&&""!==this.coverArtHash?P.a.getHashUrl(this.coverArtHash):this.videoId&&""!==this.videoId?"https://img.youtube.com/vi/"+this.videoId+"/1.jpg":void 0}},{key:"load",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise(function(){var n=Object(o.a)(i.a.mark(function n(a,o){var s;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.getId()&&e.getId()!==k.a){n.next=3;break}return a(),n.abrupt("return");case 3:if(n.prev=3,!t){n.next=7;break}return n.next=7,e.fetchAudio();case 7:if(!window.isNFT){n.next=18;break}if(window.samplesMetadata){n.next=10;break}return n.abrupt("return",a());case 10:if(s=window.samplesMetadata[e.getId()]){n.next=14;break}return e.name="",n.abrupt("return",a());case 14:return e.tags?e.tags=[].concat(Object(r.a)(e.tags),Object(r.a)(s.tags)):e.tags=s.tags,e.name=s.name,e.videoId=s.videoId,n.abrupt("return",a());case 18:return n.t0=fetch,n.t1=JSON,n.next=22,p.a.getAccount();case 22:n.t2=n.sent,n.t3=e.getId(),n.t4={user:n.t2,id:n.t3},n.t5=n.t1.stringify.call(n.t1,n.t4),n.t6={Accept:"application/json","Content-Type":"application/json"},n.t7={method:"POST",body:n.t5,headers:n.t6},(0,n.t0)("/querySample/",n.t7).then(function(e){return e.json()}).then(function(t){e.tags=Array.from(new Set(t.tags||[])),e.videoId=t.videoId,""===e.videoId&&(e.videoId=void 0),e.name=t.title,e.packs=t.packs,e.favorited=5===t.rating,e.artistName=t.artistName,e.releaseName=t.releaseName,e.sampledByUser=t.user,e.blockNumber=t.blockNumber,e.year=t.year,e.discogsId=t.discogsId,e.coverArtHash=""===t.coverArtHash?void 0:t.coverArtHash,e.guildId=t.guildId,a()}).catch(function(e){console.log(e)}),n.next=34;break;case 31:n.prev=31,n.t8=n.catch(3),o();case 34:case"end":return n.stop()}},n,null,[[3,31]])}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"color",get:function(){return M.getColorForHash(this.getId())}},{key:"getCopyWith",value:function(e,t){var a=new n(e);return a.videoId=this.videoId,a.discogsId=this.discogsId,a.coverArtHash=this.coverArtHash,a.name=this.name+"("+t+")",a.year=this.year,a.country=this.country,a.styles=this.styles,a.tags=[].concat(Object(r.a)(this.tags),[t]),a.packs=Object(r.a)(this.packs),a.isStems=!0,a}},{key:"getCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new n(this.getId());if(t.videoId=this.videoId,t.discogsId=this.discogsId,t.coverArtHash=this.coverArtHash,t.name=this.name,t.year=this.year,t.country=this.country,t.styles=this.styles,t.tags=this.tags?Object(r.a)(this.tags):[],e)t.audioBuffer=this.audioBuffer;else if(void 0!==this.audioBuffer){var a=new AudioBuffer({length:this.audioBuffer.length,numberOfChannels:this.audioBuffer.numberOfChannels,sampleRate:this.audioBuffer.sampleRate}),i=this.audioBuffer.getChannelData(0);a.copyToChannel(i,0),this.audioBuffer.numberOfChannels>1&&(i=this.audioBuffer.getChannelData(1),a.copyToChannel(i,1)),t.audioBuffer=a}return t}},{key:"newTag",value:function(e){this.tags.push(e),this.needsSave||S.a.tagSample(this.ipfsHash,e,this.guildId)}},{key:"getContentType",value:function(){return y.b}},{key:"uploadAudioToIPFS",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r,a,o,s=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:0,this.getId()!==k.a){e.next=20;break}return n=[this.audioBuffer.getChannelData(0)],this.audioBuffer.numberOfChannels>1&&n.push(this.audioBuffer.getChannelData(1)),e.next=6,Object(b.a)(n);case 6:if(r=e.sent,0!==t){e.next=14;break}return e.next=10,P.a.addArrayBuffer(r);case 10:a=e.sent,this.ipfsHash=a,e.next=20;break;case 14:return this.contentKey=new g.a,e.next=17,this.encryptedIpfs.addSound(r,m.a,t,this.contentKey);case 17:o=e.sent,this.ipfsHash=o,this.guildId=t;case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"saveBuffer",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.mp3Data){e.next=7;break}return n=[this.audioBuffer.getChannelData(0)],this.audioBuffer.numberOfChannels>1&&n.push(this.audioBuffer.getChannelData(0)),e.next=6,Object(b.a)(n);case 6:t=e.sent;case 7:return e.next=9,P.a.addArrayBuffer(t);case 9:r=e.sent,this.ipfsHash=r;case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"uploadAudioBuffer",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r,a,o,s,c=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:0,n=void 0,this.getId()!==k.a){e.next=25;break}if(r=this.mp3Data){e.next=12;break}return a=[this.audioBuffer.getChannelData(0)],this.audioBuffer.numberOfChannels>1&&a.push(this.audioBuffer.getChannelData(0)),e.next=9,Object(b.a)(a);case 9:r=e.sent,e.next=12;break;case 12:if(0!==t){e.next=19;break}return e.next=15,P.a.addArrayBuffer(r);case 15:o=e.sent,this.ipfsHash=o,e.next=25;break;case 19:return n=new g.a,e.next=22,this.encryptedIpfs.addSound(r,m.a,t,n);case 22:s=e.sent,this.ipfsHash=s,this.guildId=t;case 25:return e.abrupt("return",n);case 26:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"saveSample",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,a,o,s,c,u,l=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:0,e.next=3,this.uploadAudioBuffer(t);case 3:for(n=e.sent,a=Object(r.a)(this.tags),o=a.length;o<4;o++)a.push("");for(s=this.styles?Object(r.a)(this.styles):[],c=s.length;c<4;c++)s.push("");return u={ipfsHash:this.ipfsHash,title:this.name,videoId:this.videoId,tags:a.slice(0,4),styles:s.slice(0,4),country:this.country||null,year:this.year||0,coverArt:this.coverArtHash,discogsId:this.discogsId},this.needsSave=!1,0===t?S.a.newSamplesWithMetadata([u],0):S.a.newEncryptedSamples([u],t,n),e.next=13,Object(d.a)(1e3);case 13:this.saveArtistInfo();case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"saveArtistInfo",value:function(){var e=Object(o.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.artistName){e.next=5;break}return Object(v.f)(this.artistName.slice(0,32),this.discogsId,this.releaseName,this.coverArtHash,this.releaseType),e.next=4,Object(d.a)(1e3);case 4:Object(v.g)(this.artistName.slice(0,32),this.ipfsHash);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(O.a);t.a=A},function(e,t,n){"use strict";var r=n(99),a=n(0),i=n.n(a),o=n(12),s=n(6);window.mouseDownX=0,document.body.onmousedown=function(){++window.mouseDownX},document.body.onmouseup=function(){--window.mouseDownX};var c=Object(a.memo)(function(e){var t=e.object,n=e.refObj,o=e.element,s=e.setContextualHelp,c=e.arg,u=e.children,l=e.className,f=void 0===l?"":l,h=Object(r.a)(e,["object","refObj","element","setContextualHelp","arg","children","className"]);t&&t.docElement&&(o=t.docElement);var p=Object(a.useCallback)(function(e){s(o,c)},[]),d=Object(a.useCallback)(function(){s(void 0)},[]);return f+=" documented ",i.a.createElement("div",Object.assign({},h,{ref:n,className:f,onMouseLeave:d,onMouseOver:p}),u)});t.a=Object(o.b)(null,function(e){return{setContextualHelp:function(t,n){return e(Object(s.ub)(t,n))}}})(c)},function(e,t,n){"use strict";var r=n(8),a=n(5),i=n.n(a),o=n(14),s=n(9),c=n(11),u=n(2),l=n(4),f=n(20),h=n(16),p=n(7),d=n(10),m=n(1),v=n(15),b=n.n(v),g=n(75),y=n(6),k=n(211),O=(n(56),new(function(){function e(){Object(u.a)(this,e),this.tracks=[],this.sends=[]}return Object(l.a)(e,[{key:"useSend",value:function(){return 0!==this.sends.length&&window.explore?this.sends.pop():new b.a.Volume(-100)}},{key:"releaseSend",value:function(e){window.explore?(e.disconnect(),e.volume.value=-100,this.sends.push(e)):e.dispose()}},{key:"useTrack",value:function(){return 0!==this.tracks.length&&window.explore?this.tracks.pop():{gainNode:new b.a.PanVol,volumeNode:new b.a.Volume,muteableNode:new b.a.Volume,trackNode:new b.a.Solo,trackMeter:new b.a.Meter(.9),faderNode:new b.a.Gain}}},{key:"releaseTrack",value:function(e){for(var t in e){var n=e[t];window.explore?n.disconnect():n.dispose()}this.tracks.push(e)}}]),e}())),j=n(200),w=n(821),E=n(441),S=n(102),P=n(97),x=n(222),T=n(45),C=n(46),N=function(e,t,n,r){var a,i=e.state;if(t.isMapped){var o=t.isMapped.getInitialValueForParameter(t);void 0!==t.patternToValue[n]?t.patternToValue[n]=o:t.unlockedValue=o}(t.automatable&&(i.mix.isRecordingMix?R(i,t)||(a=t.updateRedux(!0,r)):i.mix.isPlayingMix&&t.mixAutomation.hasEventsAfterStep(e.trackStep)||(a=t.updateRedux(!0,r))),t.isMapped)&&t.isMapped.clearParameter(t);return a},R=function(e,t){return e.automation.parameterSliderDown.includes(t)},M=n(822),A=(n(435),n(823)),q=(n(232),n(57)),D=n(206),I=n(824),_=(n(501),n(23)),F=n(41),L=n(21),B=function(){function e(t){Object(u.a)(this,e),this.track=t,this.choke=void 0,this.transposeMatch=void 0,this.chokingDuration=0,this.isLiveTriggering=!1}return Object(l.a)(e,[{key:"onStep",value:function(){this.chokingDuration=Math.max(this.chokingDuration-1,0)}},{key:"newChoke",value:function(e,t){this.chokingDuration=e,this.track.releaseAll(t)}},{key:"isChoked",value:function(){return this.isLiveTriggering||this.chokingDuration>0}},{key:"liveTrigger",value:function(){this.choke&&(this.choke.chokes.isLiveTriggering=!0,this.choke.releaseAll())}},{key:"liveRelease",value:function(){this.choke&&(this.choke.chokes.isLiveTriggering=!1)}},{key:"getJson",value:function(){return{choke:void 0===this.choke?void 0:this.choke.trackNumber}}},{key:"fromJson",value:function(e,t){void 0!==e.choke&&(this.choke=t[e.choke])}}]),e}(),z=n(250),V=n(47),H=n(215),U=n(183),J=n(429),G=n(50),W=n(270),K=n(825),X=n(226),Q=function(){function e(){Object(u.a)(this,e),this.type=X.a,this.nameToMidiInput={}}return Object(l.a)(e,[{key:"addMidiInput",value:function(e){this.nameToMidiInput[e.name]=e,this.type=X.c}},{key:"deleteMidiInput",value:function(e){e.name in this.nameToMidiInput&&(delete this.nameToMidiInput[e.name],0===Object.keys(this.nameToMidiInput).length&&(this.type=X.a))}},{key:"setType",value:function(e){e!==X.a&&e!==X.b||(this.nameToMidiInput={}),this.type=e}},{key:"accepts",value:function(e,t){return this.type===X.a||(e?t in this.nameToMidiInput:this.type===X.b)}},{key:"getMidiInputs",value:function(){return Object.values(this.nameToMidiInput)}},{key:"getMidiInputNames",value:function(){return Object.keys(this.nameToMidiInput)}}]),e}(),Y=(n(502),n(424)),Z=(n(603),n(178)),$=(n(604),n(62),n(55)),ee=n(278),te=(n(196),n(233)),ne=n(890),re=n(61),ae=n(271),ie=n(33),oe=(n(221),n(199)),se=n(89),ce=function(){function e(t,n){Object(u.a)(this,e),this.envelope=t,this.mode=n}return Object(l.a)(e,[{key:"equals",value:function(e){return this.envelope===e.envelope&&this.mode===e.mode}},{key:"getJson",value:function(){return{envelope:this.envelope.number-1,mode:this.mode}}}]),e}(),ue=n(214),le=n(30),fe=n(826);function he(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(m.a)(e);if(t){var a=Object(m.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var pe=n(827);function de(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(m.a)(e);if(t){var a=Object(m.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var me=new(n(29).a);function ve(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return be(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ge(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(m.a)(e);if(t){var a=Object(m.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var ye=le.a.presets,ke=new ie.a(32,!1),Oe=new ie.a(16,!1),je=function(e){Object(p.a)(n,e);var t=ge(n);function n(e,r,a,i,o,s){var l;Object(u.a)(this,n),(l=t.call(this)).subSequence=s,l.id=Object(T.uuid)(),l.trackNumber=e,l.gated=!0,l.sequencerEngine=r,l.sequencerEngine.idToObject[l.id]=Object(f.a)(l),l.store=r.store,l.parameters=[],l.update=o;var h=O.useTrack(),p=h.gainNode,d=h.volumeNode,m=h.muteableNode,v=h.trackNode,b=h.trackMeter,g=h.faderNode;l.gainNode=p,l.volumeNode=d,l.muteableNode=m,l.trackNode=v,l.trackMeter=b,l.faderNode=g,l.volumeParameter=new F.c("volume",l.volumeNode.volume,{defaultValue:0,prettyName:"Track Volume",min:-60,max:6,isDb:!0,onChange:function(e){l.pad&&l.pad.sendSliderLevels()}},.1),l.registerParameter(l.volumeParameter),l.trackNode.connect(l.volumeNode),l.volumeNode.connect(l.faderNode),l.faderNode.connect(l.muteableNode),l.muteableNode.connect(l.trackMeter),l.muted=!1,l.sendNodes=[],l.sendNodeVolumeParameters=[],l.patternNumberLocked=void 0,l.pattern=new te.a(l.sequencerEngine,Object(f.a)(l)),l.patterns=[l.pattern];for(var y=1;y<i;y++)l.patterns.push(new te.a(l.sequencerEngine,Object(f.a)(l)));return l.currentPattern=l.getInitialPattern(),l.soundIds=[],l.auditionedSounds=[],l.toAudition=[],l.trackData=new re.a(l.sequencerEngine,l.mix,(new q.a).forTrack(Object(f.a)(l))),l.trackData.loadDefaults(),l.on=!1,l.samplers={},l.group=null,l.selectedStep=void 0,l.name=void 0,l.videoId="",l.resampler=void 0,l.masterResampler=new I.a(l.sequencerEngine,l.volumeNode),l.effectsChains=[new j.a(l.gainNode,l.trackNode,(new q.a).forTrack(Object(f.a)(l)),l.sequencerEngine)],l.effectsChains[0].initDefault(),l.midiEffects=new E.a(Object(f.a)(l)),l.liveEffects=new M.a(Object(f.a)(l)),l.midiInputs=new Q,l.samples=[],l.connectedEnvelopes=[],l.frozenSamplesToSave=[],l.chokes=new B(Object(f.a)(l)),l.outputTypeConfigured=H.a,l.outputTypeParameter=new L.a("outputType",Object(f.a)(l),function(e,t){return l.changeOutputType(t)},{defaultValue:H.a,automatable:!1}),l.registerParameter(l.outputTypeParameter),l.skipMidiMasterParameter=new L.a("skipMidiMaster",Object(f.a)(l),function(e,t){return[]},{defaultValue:!1,automatable:!1}),l.registerParameter(l.skipMidiMasterParameter),l.newFrozenColumn(),l.disabled=!1,l.stepGroups=[],l.newInlet("trigger ",function(e){var t=Object(c.a)(e,1)[0];return l.onTrigger(t)}),l.newInlet("audition sample",function(e){var t=Object(c.a)(e,1)[0];return l.loadAndUseNewSound(t)}),l.newInlet("restart",function(e){var t=Object(c.a)(e,1)[0];return l.onRestart(t)}),l.newOutlet(G.q),l.newOutlet("levels data"),l.newOutlet("pattern progress"),l}return Object(l.a)(n,[{key:"onTrigger",value:function(e){var t="bang"===e;"bang"!==e&&void 0!==e.transpose||(e=this.trackData);var n=e.time,r=this.sequencerEngine.stepNumber;(e=this.midiEffects.getStep(e)).transpose+=this.trackData.transpose,e.velocity*=this.trackData.velocity,e.duration*=this.trackData.duration,e.track=this,t?this.liveTrigger(e,0,b.a.Master.context.currentTime+.001):this.midiEffects.receivedTriggers.push({time:n,stepNumber:r,stepData:e})}},{key:"getObjectType",value:function(){return P.c}},{key:"skipMidiMaster",get:function(){return this.skipMidiMasterParameter.get()}},{key:"changeOutputType",value:function(e){this.outputTypeConfigured!==e&&(this.outputTypeConfigured=e,e===H.b?(this.muteableNode.disconnect(),this.reconnectAll()):this.addToGroup(this.group))}},{key:"registerParameter",value:function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.parameters.push(e),e.setStore(this.store),e.setContext((new q.a).forTrack(this))}},{key:"newEffectsChain",value:function(){var e=new j.a(this.gainNode,this.trackNode,(new q.a).forTrack(this),this.sequencerEngine);e.initDefault(),this.effectsChains.push(e),this.store.dispatch(Object(y.Zb)(this.subSequence.id,this.trackNumber,this.effectsChains.length-1))}},{key:"deleteEffectsChain",value:function(){var e=this.effectsChains[this.chainNumber];void 0!==e&&(e.dispose(),this.effectsChains.splice(this.chainNumber,1),this.store.dispatch(Object(y.Zb)(this.subSequence.id,this.trackNumber,this.effectsChains.length-1)))}},{key:"getEffects",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chainNumber;return this.effectsChains[e].effects}},{key:"connectToEnvelope",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue.a;for(var n in this.sequencerEngine.tracks){var r=this.sequencerEngine.tracks[n];r.isConnectedToEnvelope(e)&&r.disconnectFromEnvelope(e)}this.connectedEnvelopes.push(new ce(e,t)),this.store.dispatch(Object(y.Tg)(this.id,Object(s.a)(this.connectedEnvelopes)))}},{key:"disconnectFromEnvelope",value:function(e){for(var t=0;t<this.connectedEnvelopes.length;t++)if(this.connectedEnvelopes[t].envelope===e)return this.connectedEnvelopes.splice(t,1),void this.store.dispatch(Object(y.Tg)(this.id,Object(s.a)(this.connectedEnvelopes)))}},{key:"getEnvelopeMode",value:function(e){return this.connectedEnvelopes.filter(function(t){return t.envelope===e}).map(function(e){return e.mode})[0]}},{key:"setEnvelopeMode",value:function(e,t){return this.connectedEnvelopes.filter(function(t){return t.envelope===e}).forEach(function(e){return e.mode=t})}},{key:"isConnectedToEnvelope",value:function(e){return this.connectedEnvelopes.some(function(t){return t.envelope===e})}},{key:"rolling",get:function(){var e=this.liveEffects.getEffect(se.f);if(!e)return this.sequencerEngine.rolling;switch(e.mode){case se.b:return!0;case se.a:return!1;default:return this.sequencerEngine.rolling}}},{key:"start",value:function(){if(this.restartedAtStepNumber=void 0,this.lastPatternStep=void 0,this.effectsChains.forEach(function(e){return e.start()}),this.midiEffects.clear(),this.liveEffects.clear(),this.getTrackType()===$.b){var e=this.getInstrument();e&&e.hasLFO()&&(e.stop(),e.start())}this.notesTriggered={},this.accumulators={},this.patterns.forEach(function(e){return e.isRecording=!1}),this.scheduleTrackPatternChangeIfAny();var t,n=ve(this.stepGroups);try{for(n.s();!(t=n.n()).done;){t.value.transformations.forEach(function(e){return e.loopCounter=-1})}}catch(r){n.e(r)}finally{n.f()}}},{key:"getGroupForId",value:function(e){return this.stepGroups.find(function(t){return t.id===e})}},{key:"patternLocked",get:function(){var e=this.store.getState().tracks.trackPatternLocks[this.subSequence.id];return void 0!==e&&((e[this.trackNumber]||{})[this.currentPattern]||!1)}},{key:"linearRampFade",value:function(e,t,n){this.faderNode.gain.linearRampTo(e,.001,b.a.Master.context.currentTime+.001),this.faderNode.gain.linearRampTo(t,n,b.a.Master.context.currentTime+.003)}},{key:"fade",set:function(e){var t=Object(W.a)(e,0,1,1,0);this.faderNode.gain.setValueAtTime(t,1e-4)}},{key:"patternLocks",set:function(e){for(var t in e)this.store.dispatch(Object(y.dh)(this.subSequence.id,this.trackNumber,t,e[t]));this.getAllPatternLockedParameters().forEach(function(e){return e.updateRedux()})}},{key:"deletePatternLocks",value:function(){this.getAllParameters().forEach(function(e){return e.deleteLocks()}),this.store.dispatch(Object(y.eh)(this.subSequence.id,this.trackNumber,{}))}},{key:"deleteAutomations",value:function(){this.getAllPatternLockedParameters().forEach(function(e){return e.deleteAutomations()})}},{key:"togglePatternLock",value:function(){this.store.dispatch(Object(y.dh)(this.subSequence.id,this.trackNumber,this.currentPattern,!this.patternLocked)),this.getAllPatternLockedParameters().forEach(function(e){return e.updateRedux()})}},{key:"getName",value:function(e){return void 0!==e?this.samples[e].name:void 0===this.sample?"":this.sample.name}},{key:"isRecordable",value:function(){return!1}},{key:"setSequencerEngine",value:function(e){this.sequencerEngine=e}},{key:"resolution",get:function(){return this.sequencerEngine.resolution}},{key:"getFactoredResolution",value:function(){var e=this.sequencerEngine.rollingResolution,t=this.liveEffects.getEffect(se.f);return t&&((e=e.getCopy()).resolution*=t.rollFactor),e}},{key:"solo",value:function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.trackNode.solo=e,t&&this.store.dispatch(Object(y.ih)(this.id,e))}},{key:"getSolo",value:function(){return this.trackNode.solo}},{key:"mix",get:function(){return this.state.sequencer.isRecording&&this.state.sequencer.automationMode===ee.b?this.pattern.mix:this.subSequence.mix}},{key:"dispose",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.levelsInterval&&clearInterval(this.levelsInterval),this.sequencerEngine.dispatch(Object(y.ve)(void 0));var n=[];this.midiEffects.dispose(),t&&(n=this.getAllParameters()).forEach(function(e){return e.isMapped&&e.isMapped.unmap(e)});var r=n.filter(function(e){return e.automations&&e.automations.length>0});this.sequencerEngine.store.dispatch(Object(y.d)(r)),O.releaseTrack({gainNode:this.gainNode,volumeNode:this.volumeNode,muteableNode:this.muteableNode,trackNode:this.trackNode,trackMeter:this.trackMeter,faderNode:this.faderNode}),this.sendNodes.forEach(function(e){return O.releaseSend(e)}),this.effectsChains.forEach(function(e){return e.dispose()}),this.isFrozen?this.disposeFreezes():this.getSamplers().filter(function(e){return void 0!==e}).forEach(function(e){return e.dispose()}),this.faderNode=void 0,this.gainNode=void 0,this.muteableNode=void 0,this.trackNode=void 0,this.trackMeter=void 0,this.sendNodes=void 0,this.pattern=void 0,this.patterns.forEach(function(e){return e.dispose()}),this.patterns=void 0,this.soundIds=void 0,this.auditionedSounds=void 0,this.trackData=void 0,this.samplerConnectedToMaster=!1,this.samplers=void 0,this.group=null,this.selectedStep=void 0,this.name=void 0,this.videoId=void 0,this.sample&&this.sample.dispose(!0),this.presetId=void 0,this.samplesStream&&(this.samplesStream.dispose(),this.samplesStream=void 0),t&&n.filter(function(t){return t!==e.volumeParameter}).filter(function(t){return!e.sendNodeVolumeParameters.includes(t)}).forEach(function(e){return e.dispose()}),this.parameters=void 0}},{key:"getTrackType",value:function(){return $.f}},{key:"addToGroup",value:function(e){this.outputTypeParameter.get()===H.a&&this.muteableNode.connect(e.inputNode),this.group=e}},{key:"disconnectFromGroup",value:function(){this.muteableNode.disconnect(),this.reconnectAll(),this.group=void 0}},{key:"getLoadedSampleIfAny",value:function(e){return this.sequencerEngine.loadedSamples[e]}},{key:"addSound",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n,r){var a,o,s=this,c=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=!(c.length>3&&void 0!==c[3])||c[3])&&this.store.dispatch(Object(y.Xg)(this.subSequence.id,this.trackNumber,!0)),"string"!==typeof t&&"number"!==typeof t){e.next=23;break}if(o=t,this.soundIds.push(o),void 0===this.getLoadedSampleIfAny(o)){e.next=10;break}t=this.getLoadedSampleIfAny(o),void 0===this.sample&&(this.sample=t),e.next=21;break;case 10:if(t=new g.a(o),void 0===this.sample&&(this.sample=t),e.prev=12,t.getId()===x.a){e.next=16;break}return e.next=16,t.load();case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),console.log("error sample ",e.t0);case 21:e.next=35;break;case 23:if(void 0===this.sample&&(this.sample=t),this.sample.isLoaded()||t.getId()===x.a){e.next=34;break}return e.prev=25,e.next=28,this.sample.load();case 28:e.next=34;break;case 30:return e.prev=30,e.t1=e.catch(25),console.log("error in track load"),e.abrupt("return");case 34:this.soundIds.push(t.getId());case 35:if(t.isLoaded()){e.next=37;break}return e.abrupt("return");case 37:this.samples.push(t),r=r||!1,this.loadTrackInfo(r,t,n,a),this.samplesStream=new k.a(t,this.sequencerEngine),setTimeout(function(){s.samplesStream.sounds&&0!==s.samplesStream.sounds.length||s.samplesStream.search()},300),a&&this.store.dispatch(Object(y.Xg)(this.subSequence.id,this.trackNumber,!1)),this.addSoundToBrowsedSamples(t);case 44:case"end":return e.stop()}},e,this,[[12,18],[25,30]])}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"trackIsLoading",get:function(){return this.sequencerEngine.state.tracks.trackIsLoading[this.subSequence.id]&&this.sequencerEngine.state.tracks.trackIsLoading[this.subSequence.id][this.trackNumber]},set:function(e){this.sequencerEngine.isOffline||this.store.dispatch(Object(y.Xg)(this.subSequence.id,this.trackNumber,e))}},{key:"loadTrackInfo",value:function(e,t,n){var r=this,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];void 0===n&&(n={slices:void 0,offset:0,transpose:0,volume:0}),e=e||!0;var i=this;this.store.dispatch(Object(y.Ee)(t.getId(),t.getJson())),e?(this.videoId=t.videoId,this.sample=t,void 0===this.videoId&&"MIDI"!==this.getTrackType()&&(this.name=t.name),this.update()):(this.name=t.name,this.update());var o=n.slices;this.samplers[t.getId()]=new ae.a(this,t,function(e){return r.onNewSampler(i,e)},o,n),this.samplers[t.getId()].init(),this.samplers[t.getId()].sliceFirstOnset(!1),t.addedToProject=!0,a&&this.store.dispatch(Object(y.Xg)(this.subSequence.id,this.trackNumber,!1))}},{key:"chainNumber",get:function(){return(this.store.getState().effects.effectsChainToShow[this.subSequence.id]||{})[this.trackNumber]||0}},{key:"effectsChain",get:function(){return this.effectsChains[this.chainNumber]}},{key:"effects",get:function(){return void 0===this.effectsChains[this.chainNumber]?[]:this.effectsChains[this.chainNumber].effects}},{key:"updateEffects",value:function(e){void 0===e&&(e=this.effects),this.effectsChains[this.chainNumber].updateEffects(e)}},{key:"onNewSampler",value:function(e,t){for(var n in this.samplers)if(t===this.samplers[n]&&this.toAudition.indexOf(n)>-1&&this.isWarped()){var r=this.toAudition.indexOf(n);this.toAudition.splice(r,1),t.sliceFirstOnset();break}t.gainNode.connect(this.gainNode),e.switchToPattern(e.currentPattern),e.setVolume(e.getVolume(),!0,!0),e.setPanning(e.getPanning(),void 0,!0)}},{key:"setSends",value:function(e){var t=this;this.sends=e,this.sends.getSends().map(function(e){return t.newSend(e)})}},{key:"setSendVolume",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.sendNodeVolumeParameters[e].set(t,n),this.store.dispatch(Object(y.hh)(this.trackNumber,e,t))}},{key:"setupEffects",value:function(){var e=this.effectsChains[this.chainNumber];e&&e.setupEffects()}},{key:"newSend",value:function(e){var t=O.useSend();this.muteableNode.connect(t),e.connectToTrack(t),this.sendNodes.push(t);var n=new F.c("send volume",t.volume,{defaultValue:-90,prettyName:"Send "+e.name,min:-90,max:0,isDb:!0});this.registerParameter(n),this.sendNodeVolumeParameters.push(n)}},{key:"reconnectAll",value:function(){var e=this;this.sendNodes.forEach(function(t){return e.muteableNode.connect(t)}),this.muteableNode.connect(this.trackMeter)}},{key:"toggleEnabled",value:function(){this.setIsEnabled(!this.isEnabled)}},{key:"setIsEnabled",value:function(e){this.isEnabled=e,this.isEnabled&&this.store.dispatch(Object(y.Ch)(!1)),this.store.dispatch(Object(y.Wg)(this.subSequence.id,this.id,this.isEnabled))}},{key:"getSendNodes",value:function(){return this.sendNodes}},{key:"getSampler",value:function(e){return this.isFrozen?this.frozenColumns[0].frozenSamplers[0]:(e=e||0,void 0!==this.samplers&&void 0!==this.soundIds?this.samplers[this.soundIds[e]]:void 0)}},{key:"getSamplers",value:function(){var e=this;return this.isFrozen?this.frozenColumns.map(function(e){return e.frozenSamplers[e.playing]}).filter(function(e){return void 0!==e}):this.soundIds.map(function(t){return e.samplers[t]})}},{key:"deleteSound",value:function(e){var t=this.soundIds.indexOf(e);t>-1&&(this.soundIds.splice(t,1),delete this.samplers[e],this.soundId=this.soundIds[0])}},{key:"getVolume",value:function(){return this.pattern?this.pattern.volume:0}},{key:"getMuted",value:function(){return!!this.pattern&&this.pattern.isMuted}},{key:"newPattern",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(new Date).getTime(),(t=void 0!==t&&t)?(n=this.pattern.getCopy(),this.patterns.push(n),(new Date).getTime(),this.patterns.length-1,this.getAllPatternLockedParameters().forEach(function(e){return e.newPattern(r.currentPattern,r.patterns.length-1)}),(new Date).getTime(),this.patternLocked&&this.store.dispatch(Object(y.dh)(this.subSequence.id,this.trackNumber,this.patterns.length-1,this.patternLocked))):this.patterns.push(new te.a(this.sequencerEngine,this)),(new Date).getTime();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"switchToPattern",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.001;this.presetName||this.getName();if(e>=0&&e<this.patterns.length){var n=this.patterns[e],r=n.volume,a=n.muted,i=this.pattern;this.pattern=n,this.currentPattern=e;var o=this.patterns.indexOf(i),s=!this.attributes||void 0!==this.attributes["volume pattern-locked"]&&!this.attributes["volume pattern-locked"]?function(e,t,n,r){var a=e.sequencerEngine,i=a.state,o=e.volumeParameter;if(!e.patterns[t])return e.setVolume(n,!0,!0);var s;e.patterns[t].volume;return i.mix.isRecordingMix?R(i,o)||(s=e.setVolume(n,!0,!0,r)):i.mix.isPlayingMix&&(R(i,o)||o.mixAutomation.hasEventsAfterStep(a.trackStep))||(s=e.setVolume(n,!0,!0,r)),s}(this,o,r,t):{},c=this.mute(a,!0,!0),u=this.getAllPatternLockedParameters(this.patterns.indexOf(i),e),l={},f=new Set;for(var h in u){var p=u[h];if(!f.has(p.id)){f.add(p.id);var d=N(this.sequencerEngine,p,o,t);d&&(l[d.id]=d.value)}}var m=this.setPanning(this.pattern.panning,void 0,!0);return{bulkUpdate:l,panning:{id:this.id,panning:m},volume:{id:this.id,volume:s},mute:{id:this.id,mute:c}}}return{bulkUpdate:{},mute:{},volume:{},panning:{}}}},{key:"getAllParameters",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=[].concat(Object(s.a)(this.parameters),[this.outputTypeParameter]),r=ve(this.stepGroups);try{for(r.s();!(e=r.n()).done;){var a,i=ve(e.value.transformations);try{for(i.s();!(a=i.n()).done;){var o=a.value;n.push(o.thenValue),n.push(o.whenValue)}}catch(u){i.e(u)}finally{i.f()}}}catch(u){r.e(u)}finally{r.f()}for(var c in this.trackData&&(n=[].concat(Object(s.a)(n),Object(s.a)(this.trackData.parameters))),this.effectsChains)n=[].concat(Object(s.a)(n),Object(s.a)(this.effectsChains[c].getAllParameters()));return this.isFrozen&&(n=[].concat(Object(s.a)(n),Object(s.a)(this.frozenColumns.map(function(e){return e.gainParameter})),Object(s.a)(this.frozenColumns.map(function(e){return e.playingParameter})))),t&&(n=[].concat(Object(s.a)(n),Object(s.a)(this.midiEffects.getAllParameters()),Object(s.a)(this.liveEffects.getAllParameters()))),this.getSamplers()[0]&&(n=[].concat(Object(s.a)(n),Object(s.a)(this.getSamplers()[0].parameters))),n=[].concat(Object(s.a)(n),Object(s.a)(n.filter(function(e){return e.depthParameter}).map(function(e){return e.depthParameter})))}},{key:"getAllPatternLockedParameters",value:function(e,t){return this.getAllParameters().filter(function(n){return n.hasPatternLockedValues(e,t)})}},{key:"deletePattern",value:function(e){if(this.patterns.splice(e,1),this.getAllPatternLockedParameters().forEach(function(t){return t.deletePattern(e)}),void 0!==this.store.getState().tracks.trackPatternLocks[this.subSequence.id]){var t=Object(r.a)({},this.store.getState().tracks.trackPatternLocks[this.subSequence.id][this.trackNumber]);this.store.dispatch(Object(y.eh)(this.subSequence.id,this.trackNumber,Object(oe.a)(e,t)))}}},{key:"movePatternTo",value:function(e,t){if(e!=t){var n=[];if(e>t?(n=this.patterns.slice(0,t).concat([this.patterns[e]]).concat(this.patterns.slice(t,e)),this.patterns.length>e+1&&(n=n.concat(this.patterns.slice(e+1)))):(n=this.patterns.slice(0,e).concat(this.patterns.slice(e+1,t)).concat([this.patterns[t],this.patterns[e]]),this.patterns.length>t+1&&(n=n.concat(this.patterns.slice(t+1)))),this.patterns=n,this.getAllPatternLockedParameters().forEach(function(n){return n.movePatternTo(e,t)}),this.store.getState().tracks.trackPatternLocks[this.subSequence.id]){var a=Object(r.a)({},this.store.getState().tracks.trackPatternLocks[this.subSequence.id][this.trackNumber]);this.store.dispatch(Object(y.eh)(this.subSequence.id,this.trackNumber,Object(oe.b)(e,t,a)))}}}},{key:"getStepAtResolution",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.resolution,n=this.getStepsAtResolution(t);return n[Math.floor(e)%n.length]}},{key:"getStepsAtResolution",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,t=this.getEasyPattern().pattern;return t.getStepsAtResolution(e).slice(0,t.length(e))}},{key:"getBucketsAtResolution",value:function(e){return this.pattern.getBucketsAtResolution(e)}},{key:"getFillsAtResolution",value:function(e){return this.pattern.getFillsAtResolution(e)}},{key:"getStepDataForStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.getCopy(!1,!1,!0,!0,t),r=n.getPolyphony();for(var a in r){var i=r[a];i.duration=null==i.durationParameter.value?this.trackData.duration:i.duration,i.transpose=null==i.transposeParameter.value?this.trackData.transpose:i.transpose,i.velocity=null==i.velocityParameter.value?this.trackData.velocity:i.velocity,i.start=null==i.startParameter.value?this.trackData.start:i.start,i.chop=null==i.chopParameter.value?this.trackData.chop:i.chop,i.chopDuration=null==i.chopDurationParameter.value?this.trackData.chopDuration:i.chopDuration,i.attack=null==i.attackParameter.value?this.trackData.attack:i.attack,this.getTrackType()!==$.b?i.release=null==i.releaseParameter.value?this.trackData.release:i.release:i.release=null==i.releaseParameter.value?null:i.release,i.slice=null==i.sliceParameter.value?this.trackData.slice:i.slice,i.panning=i.panningParameter.value,i.pitchAttack=null==i.pitchAttackParameter.value?this.trackData.pitchAttack:i.pitchAttack,i.pitchDecay=null==i.pitchDecayParameter.value?this.trackData.pitchDecay:i.pitchDecay,i.pitchSustain=null==i.pitchSustainParameter.value?this.trackData.pitchSustain:i.pitchSustain,i.pitchRelease=null==i.pitchReleaseParameter.value?this.trackData.pitchRelease:i.pitchRelease,i.monophonic=null==i.monophonicParameter.value?this.trackData.monophonic:i.monophonic,i.reverse=null==i.reverse?this.trackData.reverse:i.reverse,i.palette=null==i.palette?this.trackData.palette:i.palette,i.mutate=null==i.mutateParameter.value?this.trackData.mutate:i.mutate,i.auxEventA=null==i.auxEventA?this.trackData.auxEventA:i.auxEventA,i.auxEventB=null==i.auxEventA?this.trackData.auxEventB:i.auxEventB,i.auxEventC=null==i.auxEventA?this.trackData.auxEventC:i.auxEventC,i.auxEventD=null==i.auxEventA?this.trackData.auxEventD:i.auxEventD,i.effectAutomations=i.effectAutomations}return n}},{key:"getMainSoundId",value:function(){return this.soundIds[0]}},{key:"calculateFills",value:function(){this.pattern.calculateFills(this.trackData)}},{key:"updateStepDuration",value:function(e,t,n){n=n||ke;var r=this.getBucketsAtResolution(n);for(var a in r[e].steps){var i=r[e].getStep(a);i.on&&(i.duration=t)}this.pattern.calculateFills(this.trackData),this.updateSteps()}},{key:"doubleTrackLength",value:function(){var e=this.getEasyPattern().pattern;e.doubleTrackLength(),e.calculateFills(this.trackData),this.updateSteps(!0)}},{key:"length",get:function(){return void 0===this.pattern?16:this.pattern.length()}},{key:"halfTrackLength",value:function(){var e=this.getEasyPattern().pattern;e.halfTrackLength(),e.calculateFills(this.trackData),this.updateSteps(!0)}},{key:"getJson",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={},n=0;n<this.soundIds.length;n++){var a=this.samplers[this.soundIds[n]];a&&(t[this.soundIds[n]]=a.getJson())}var i=this.store.getState().tracks.trackPatternLocks[this.trackNumber]||{},o=[];for(var s in this.sendNodeVolumeParameters){var c=this.sendNodeVolumeParameters[s],u={volume:c.get()};u=Object(_.b)(u,"volumeParameter",c,!0),o.push(u)}var l=Object(_.b)({},"outputTypeParameter",this.outputTypeParameter);l=Object(_.b)(l,"skipMidiMasterParameter",this.skipMidiMasterParameter);var f=this.instrumentRack?this.instrumentRack.isFrozen:this.isFrozen;return l=Object(_.b)(l,"volumeParameter",this.volumeParameter,!0),this.lfosTrack&&(l.lfos=this.lfosTrack.lfos.map(function(e){return e.getJson()}),l.envelopes=this.envelopesTrack.envelopes.map(function(e){return e.getJson()})),Object(r.a)({},l,{id:this.id,color:this._color,skipMidiMaster:this.skipMidiMasterParameter.get(),outputType:this.outputTypeParameter.get(),annotations:this.annotations.map(function(e){return e.getJson()}),isMuted:this.pattern.isMuted,sends:o,isNewVolume:!0,volume:this.pattern.volume,samplers:t,gated:this.gated,type:this.getTrackType(),patternLocks:i,envelopeConnections:this.connectedEnvelopes.filter(function(e){return e&&e.envelope}).map(function(e){return e.getJson()}),isFrozen:f,isFrozenPlaying:this.isFrozenPlaying,freeze:e?void 0:this.getFreezeJson(),chokes:this.chokes.getJson(),rawVolume:this.volumeNode.volume.value,presetName:this.presetName,stepGroups:this.stepGroups.map(function(e){return Object(Z.d)(e)})},this.getAuxJson())}},{key:"setPanning",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==t){var r=b.a.Master.context.isOffline?b.a.Master.context._currentTime:b.a.Master.context.currentTime;this.gainNode.pan.linearRampToValueAtTime(e,r+t-.001)}else this.gainNode.pan.value=e;return this.gainNode.pan.value=e,this.pattern.panning=e,n||this.store.dispatch(Object(y.ch)(this.id,e)),e}},{key:"getPanning",value:function(){return this.pattern.panning}},{key:"setVolume",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return t||this.state.mix.isRecordingMix||(this.pattern.volume=e),t||this.state.mix.isRecordingMix||(t=!0),e>6&&(e=Math.max(4,Object(W.b)(e,0,128))),this.volumeParameter.set(e,t,!0,r),n||this.store.dispatch(Object(y.mh)(this.id,e)),e}},{key:"setRawVolume",value:function(e){this.volumeParameter.set(e,!0,!0),this.pattern.volume=e+15}},{key:"mute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e=void 0===e||e,this.addEvent(new Y.a(this,e),t),this.muted=e,this.muteableNode.mute=e,this.pattern.muted=e,n||this.store.dispatch(Object(y.bh)(this.id,e)),e}},{key:"moveEffectTo",value:function(e,t){this.effectsChains[this.chainNumber].moveEffectTo(e,t)}},{key:"moveMidiEffectTo",value:function(e,t){this.midiEffects.moveEffectTo(e,t)}},{key:"onBPMUpdated",value:function(){this.effectsChains.forEach(function(e){return e.onBPMUpdated()})}},{key:"getEffectNumber",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.midiEffects.getEffectNumber(e):this.effectsChains[this.chainNumber].getEffectNumber(e)}},{key:"deleteEffect",value:function(e){this.effectsChains[this.chainNumber].deleteEffect(e)}},{key:"numberOfSlices",value:function(){var e=0;for(var t in this.samplers)this.samplers[t].slices.length>e&&(e=this.samplers[t].slices.length);return e}},{key:"isLoaded",value:function(){return this.soundIds.length>0&&void 0!==this.getSampler(0)&&this.getSampler(0).isLoaded()}},{key:"updateStepData",value:function(e,t,n){var r=ke.transformStepAtResolution(t,n),a=Math.floor(r),i=this.pattern.stepBuckets[a];for(var o in i.steps){if(i.getStep(o).on){i.setStep(o,e,!0),this.pattern.syncBuckets();break}}this.updateSteps()}},{key:"stepSelected",value:function(e){this.selectedStep=e}},{key:"stepUnselected",value:function(e){this.selectedStep=void 0}},{key:"isReversed",value:function(){return this.getSamplers().filter(function(e){return void 0!==e}).some(function(e){return e.isReversed()})}},{key:"reverse",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.getSamplers().forEach(function(t){return t.reverse(e)})}},{key:"addEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==this.mix){this.store.getState();!t&&this.isRecordingAutomations()&&this.mix.addEvent(e)}}},{key:"isRecordingAutomations",value:function(){return this.state.sequencer.automationMode===ee.b&&this.state.sequencer.isRecording||this.state.mix.isRecordingMix}},{key:"setKeyboardEngine",value:function(e){this.keyboardEngine=e}},{key:"updateSteps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.pattern;if(this.state.arrangement.patternSelected&&((r=this.patterns[this.state.arrangement.patternSelected.patternNumber])||(r=this.pattern)),!this.multiSequencerEngine&&!this.sequencerEngine.context.isOffline)if(this.instrumentRack)this.instrumentRack.updateSteps(e,t);else{t||this.store.dispatch(Object(y.Wg)(this.subSequence.id,this.id,this.isEnabled));(new Date).getTime();var a=r.getUpdateStepsAction(e,n),i=((new Date).getTime(),void 0);if(this.subSequence.isTrack)for(var o in i={},this.patterns)i[o]=this.patterns[o].getTrackStepsAction();this.store.dispatch(Object(y.y)(a.id,a.steps,a.pianoRollSteps,a.trackFills,a.stepToId,a.pianoRollPositions,a.pianoRollDurations,i,a.groups))}}},{key:"getUpdateStepsAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sequencerEngine.resolution.isTriplet;return this.pattern.getUpdateStepsAction(e,t)}},{key:"patternSelected",get:function(){return this.state.arrangement.patternSelected}},{key:"getEasyPattern",value:function(){var e=this.patternSelected?this.patterns[this.patternSelected.patternNumber]:this.pattern;return new ne.a(e||this.pattern,this.trackData)}},{key:"deleteMidiInput",value:function(e){this.midiInputs.deleteMidiInput(e)}},{key:"addMidiInput",value:function(e){this.midiInputs.addMidiInput(e)}},{key:"getInstrumentType",value:function(){return $.f}},{key:"state",get:function(){return this.store.getState()}},{key:"dispatch",value:function(e){this.sequencerEngine.dispatch(e)}},{key:"fromJson",value:function(e,t){var n=this;this.cachedPlayhead=void 0,e.id&&(this.sequencerEngine.trackIDExists(e.id,this)||(this.id=e.id,this.sequencerEngine.idToObject[this.id]=this)),void 0!==e.isFrozen&&(this.isFrozen=e.isFrozen),e.freeze&&this.loadFreezeJson(e.freeze),e.outputType&&this.outputTypeParameter.set(e.outputType),e.color&&(this.color=e.color),e.skipMidiMaster&&this.skipMidiMasterParameter.set(e.skipMidiMaster),void 0===e.skipMidiMaster&&e.isFrozen&&this.skipMidiMasterParameter.set(!1),e.skipMidiMasterParameter&&Object(_.a)(e,"skipMidiMasterParameter",this.skipMidiMasterParameter),e.stepGroups&&(this.stepGroups=e.stepGroups.map(function(e){return Object(Z.c)(e,n)})),Object(_.a)(e,"outputTypeParameter",this.outputTypeParameter),void 0!==e.isFrozenPlaying&&(this.isFrozenPlaying=e.isFrozenPlaying),this.frozenJson=e.frozenJson,this.currentPattern=this.getInitialPattern();var a={};if(t||(a=Object(_.a)(e,"volumeParameter",this.volumeParameter)),e.sends)for(var i in e.sends)this.sendNodeVolumeParameters[i]&&(this.sendNodeVolumeParameters[i].set(e.sends[i].volume),a=Object(r.a)({},a,Object(_.a)(e.sends[i],"volumeParameter",this.sendNodeVolumeParameters[i])));this.store.dispatch(Object(y.Vb)(a)),this.presetName=e.presetName,e.auxEventATypeParameter&&this.fromAuxJson(e),e.lfos&&this.lfosTrack&&(this.lfosTrack.lfos.map(function(t,n){return t.lfo.fromJson(e.lfos[n])}),this.envelopesTrack.envelopes.map(function(t,n){return t.envelope.fromJson(e.envelopes[n])}))}},{key:"tempo",get:function(){return void 0===this.getSamplers()[0]?void 0:this.getSamplers()[0].tempo}},{key:"warp",value:function(){var e=this.midiEffects.effects.filter(function(e){return"Warp"===e.name})[0];e?this.operationManager.dispatch(Object(C.s)(e,this)):this.operationManager.dispatch(Object(C.b)(new z.a(this),this)),this.getSamplers()[0]&&this.getSamplers()[0].sliceFirstOnset()}},{key:"isWarped",value:function(){return this.midiEffects.effects.filter(function(e){return"Warp"===e.name}).filter(function(e){return e.enabled}).length>0}},{key:"mateWithPreset",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o,s,c,u=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:.5,r=u.length>2?u[2]:void 0,e.next=4,ye.getPresetData(t.contentHash);case 4:for(o in(a=e.sent).lfos)this.sequencerEngine.lfos[o].lfo.mateJson(a.lfos[o],n);if(this.instrument.mateJson(a.trackParameters.instrument,n),!r){e.next=14;break}return e.next=10,this.sequencerEngine.getEffectsPreset(a,this);case 10:for(s=e.sent,this.effectsChains[0].mate(s.effectsChains[0],n),c=1;c<s.effectsChains.length;c++)s.effectsChains[c].dispose();s.midiEffects&&this.midiEffects.mate(s.midiEffects,n);case 14:return this.sequencerEngine.update(),e.abrupt("return");case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"extractStems",value:function(){var e=this;return new Promise(function(t){var n=e.sample.audioBuffer,r=[n.getChannelData(0),n.getChannelData(1)];e.sequencerEngine.dispatch(Object(y.bd)("Extracting stems (might take a few)")),new U.a(2).exportToWAV(r,function(){var n=Object(o.a)(i.a.mark(function n(r){var a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,V.a.addBytesArray(r);case 2:a=n.sent,fetch("/splitStems/"+a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(){var n=Object(o.a)(i.a.mark(function n(r){var a,o,s,c,u;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.drums?e.sample.getCopyWith(r.drums,"drums"):void 0,o=r.vocals?e.sample.getCopyWith(r.vocals,"vocals"):void 0,s=r.bass?e.sample.getCopyWith(r.bass,"bass"):void 0,c=r.other?e.sample.getCopyWith(r.other,"other"):void 0,u=[a,o,s,c].filter(function(e){return void 0!==e}).map(function(e){return e.fetchAudio()}),n.next=7,Promise.all(u);case 7:e.sequencerEngine.dispatch(Object(y.bd)(void 0)),a&&(e.sequencerEngine.addSound(a),e.sequencerEngine.addSampleToSync(a)),o&&(e.sequencerEngine.addSound(o),e.sequencerEngine.addSampleToSync(o)),s&&(e.sequencerEngine.addSound(s),e.sequencerEngine.addSampleToSync(s)),c&&(e.sequencerEngine.addSound(c),e.sequencerEngine.addSampleToSync(c)),t();case 13:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}());case 4:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())})}},{key:"extractGroove",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r,a,o,s,c,u,l,f,h,p;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getSamplers()[0],n=t.onsets,r=t.tempo,a=t.slices[0].startTime,n=n.filter(function(e){return e/1e3>=a}),o=Object(K.b)(n,r,this.sequencerEngine.bpm),"QmRHeFU644J9LFZoPzd93M4WqF8tyhydDYL2EZWS6dmbF8",e.next=9,this.sequencerEngine.addSound("QmRHeFU644J9LFZoPzd93M4WqF8tyhydDYL2EZWS6dmbF8");case 9:for(u in s=e.sent,c=s.getEasyPattern(),o.steps.forEach(function(e){return c.addStep(s.getNewStep(),e.stepNumber,ke,e.offset,!1,!0)}),o.timings)l=o.timings[u].resolution,f=o.timings[u].odd,h=o.timings[u].even,(p=new J.a(s)).oddOffset=f,p.evenOffset=h,p.resolution=32/l,s.midiEffects.addEffect(p);c.update(!1),s.updateSteps();case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getNewStep",value:function(){var e=new re.a(this.sequencerEngine,void 0,void 0,this);return e.on=!0,e}},{key:"showEffects",value:function(e){this.store.dispatch(Object(y.ig)(this.trackNumber,e))}},{key:"isEffectsShowing",value:function(){return this.state.spatial.showEditorBottom===D.a}},{key:"isHidden",value:function(){return this.state.tracks.tracksToHide.indexOf(this)>-1}},{key:"restart",value:function(){}},{key:"onStepEnded",value:function(){}},{key:"onNewStep",value:function(e){this.midiEffects.onNewStep()}},{key:"getInitialPattern",value:function(){if(!this.subSequence.isTrack)return 0}},{key:"scheduleTrackPatternChangeIfAny",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine.trackStep;arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.subSequence.isTrack&&!this.patterns.some(function(e){return e.isRecording})){for(var t in this.patterns){t=parseInt(t);var n=this.patterns[t],r=n.startStep;if(void 0!==r&&(e>=r&&e<r+n.length()))return void(t!==this.currentPattern&&this.switchToPattern(t))}this.currentPattern=void 0,this.pattern=this.patterns[0]}}},{key:"getGuildIds",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.sample){e.next=2;break}return e.abrupt("return",[0]);case 2:return e.next=4,le.a.guildSamples.getGuildIdForSound(this.sample.getId());case 4:return t=e.sent,e.abrupt("return",void 0===t?[0]:[t]);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"makePublicIfNeeded",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGuildIds();case 2:if(0===e.sent[0]||!this.sample){e.next=8;break}return e.next=6,le.a.guildSamples.saveSample(this.sample);case 6:t=e.sent,this.replaceSoundId(this.sample.getId(),t);case 8:e.t0=i.a.keys(this.effectsChains);case 9:if((e.t1=e.t0()).done){e.next=15;break}return n=e.t1.value,e.next=13,this.effectsChains[n].makePublicIfNeeded();case 13:e.next=9;break;case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"replaceSoundId",value:function(e,t){var n=this.soundIds.indexOf(e);if(-1!==n){this.soundIds[n]=t;var r=this.samplers[this.sample.getId()];this.samplers[t]=r,this.sample.ipfsHash=t,delete this.samplers[e]}}},{key:"operationManager",get:function(){return this.sequencerEngine.operationManager}},{key:"deleteAtStep",value:function(e){this.pattern.deleteStepNumber(e)}},{key:"isMonophonic",value:function(){return!1}},{key:"getIdentifier",value:function(){var e=this;return this&&this.tracks&&this.tracks[0]&&(e=this.tracks[0].track),e.presetName?e.presetName:void 0!==e.sample&&void 0!==e.sample.getId()?e.sample.getId():e.getName()}},{key:"addRackEffect",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];(e=Object(h.a)(Object(m.a)(n.prototype),"addRackEffect",this)).call.apply(e,[this].concat(r)),this.updateMidiEffectsRedux()}},{key:"updateEffectRedux",value:function(e){this.updateMidiEffectsRedux()}},{key:"updateMidiEffectsRedux",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.effectRack&&this.effectRack.effects;this.effectRack&&this.dispatch(Object(y.ah)(this.id,Object(s.a)(e)))}},{key:"effectRack",get:function(){return this.midiEffects.effects.find(function(e){return"Midi Effect Rack"===e.name})}},{key:"getParameters",value:function(){return[]}},{key:"sendLevels",value:function(e){var t=this;this.levelsInterval&&clearInterval(this.levelsInterval),e&&(this.levelsInterval=setInterval(function(){if(!t.sequencerEngine.isLoading){var e=t.trackMeter.getLevel();t.sendMessage("levels data",e<-80?0:Math.pow((e+80)/86,2))}},20))}},{key:"saveNewSample",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sample.saveBuffer();case 2:t=this.sample.ipfsHash,n=this.samplers.NOT_UPLOADED_YET,this.soundIds=[t],this.samplers[t]=n;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"scheduleAnyRecording",value:function(e){}}]),n}(Object(A.a)(Object(S.a)(Object(w.a)(Object(pe.a)(function(e){return function(e){Object(p.a)(n,e);var t=he(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getKeyMapping",value:function(e){var t=this.sequencerEngine.keyboardEngine;if(t){var n=t.keyMappings;for(var r in n){var a=n[r],i=a.trackNumber,o=a.sliceNumber;if(i===this.trackNumber&&(void 0===e||e==o))return r}}}},{key:"mapToKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.sequencerEngine.keyboardEngine.map(e,this.trackNumber,t)}},{key:"getPadMapping",value:function(){}}]),n}(e)}(function(e){Object(p.a)(n,e);var t=de(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"color",get:function(){return this._color?this._color:me.getColorForTrack(this)},set:function(e){this._color=e}}]),n}(Object(fe.a)(function(){return function e(){Object(u.a)(this,e)}}()))))))));t.a={Track:je,baseResolution:ke,oldDefaultResolution:Oe}},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(8),a=n(11),i=(n(37),n(166)),o=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var m=void 0,v=void 0,b=void 0,g=s(),y=void 0,k=void 0;return function(t){var o=Object(a.a)(t,1)[0],s=g.apply(void 0,[o].concat(n)),O=c.apply(void 0,[o].concat(n)),j=l.apply(void 0,[o].concat(n)),w=u.apply(void 0,[o].concat(n)),E=n.map(function(e){return e()});if(f(b,o)&&h(v,E)&&p(s,y)&&d(O,k))return m.uniforms=s,m.variables=O,m.functions=j,m.closure=w,v=E,b=o,m;y=Object.keys(s),k=Object(r.a)({},O);var S=e(o);return v=E,b=o,m={code:S,hashCode:Object(i.a)(S),uniforms:s,variables:O,functions:j,closure:w}}},s=function(){var e={};return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];if("function"===typeof o&&(o=o()),o&&o.uniforms)for(var s in o.uniforms)e[s]=o.uniforms[s]}return e}},c=function(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];if("function"===typeof o&&(o=o()),o&&o.variables)for(var s in o.variables)e[s]=o.variables[s]}return e},u=function(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];if("function"===typeof o&&(o=o()),o&&o.closure)for(var s in o.closure)e[s]=o.closure[s]}return e},l=function(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];if("function"===typeof o&&(o=o()),o&&o.functions)for(var s in o.functions)e[s]=o.functions[s]}return e},f=function(e,t){return Array.isArray(e)?h(e,t):e&&t?e.hashCode&&t.hashCode?e.hashCode===t.hashCode:e===t:!e&&!t},h=function(e,t){if(!e)return!e&&!t;for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(void 0===r||void 0===a){if(void 0===r&&void 0===a)continue;return!1}if(!(r.hashCode&&a.hashCode===r.hashCode||r===a))return!1}return!0},p=function(e,t){var n=0;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e){if(!e[r].update||t[r]&&!t[r].update)return!1;if(t[n]!==r)return!1;n++}return!0},d=function(e,t){if(!t)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0}},function(e,t,n){"use strict";n.d(t,"f",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"a",function(){return c});var r="SOUND_DETAILS_VIEW",a="MULTI_DETAILS_VIEW",i="SEQUENCER_VIEW",o="MIX_VIEW",s="PREFERENCES_VIEW",c="ARRANGEMENT_VIEW"},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];"function"===typeof o&&(o=o()),o=void 0===o?{}:o,e.push(o.code||o||"0.0")}return e}},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"g",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"h",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"i",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"f",function(){return f}),n.d(t,"j",function(){return h});var r=20,a=40,i="INPUT",o="OUTPUT",s="black",c="#3837374f",u=600,l=400,f={AUDIO_FX:20,LIVE_FX:20,MIDI_FX:20,OSCILLATOR:26},h={AUDIO_FX:u,LIVE_FX:u,MIDI_FX:u,OSCILLATOR:200}},function(e,t,n){"use strict";n.d(t,"e",function(){return f}),n.d(t,"f",function(){return h}),n.d(t,"d",function(){return p}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return v});n(273);var r=n(255),a=n(117),i=n(72),o=n(789),s=n(105),c=n(17),u=n(101),l=n(83);Object(i.a)("tidal",{pattern:"",cycleLength:"",accentFactor:"",cycleRetrigger:""},"Plays a tidal pattern");var f=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=void 0,i=void 0,o=void 0;return function(){for(var s=arguments.length,f=new Array(s),h=0;h<s;h++)f[h]=arguments[h];var p=f[0],d=f[1],m=f[2],v=f[3];a||(a=v.useTidal());var b=c.A.apply(void 0,[e].concat(f))||[];if(b!==i){if("string"===typeof b){var g=Object(l.g)(e);a.cycleParameter.set(g,!0,!0)}else Array.isArray(b)&&(o&&o===Object(l.e)(b)||a.cycle!==b&&a.cycleParameter.set(b,!0,!0));i=b,o=Object(l.e)(i)}var y=c.A.apply(void 0,[t].concat(f));void 0===y&&(y=32),y!==a.cycleLength&&a.cycleLengthParameter.set(y,!0,!0);var k=c.A.apply(void 0,[n].concat(f));k!==a.accentFactor&&a.accentFactorParameter.set(k,!0,!0);var O=c.A.apply(void 0,[r].concat(f));if(O!==a.cycleRetrigger&&(a.cycleRetrigger=O),p){var j=new u.a(p,m,d);a.input(j)}var w=a.output(m,d,d);return 0===w.length?Object(c.w)(!1):Object(c.J)(Object(c.Q)(w))}},h=function(e){var t=void 0,n=void 0;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];var o=c.A.apply(void 0,[e].concat(a));return o===t?n:(n=Object(l.g)(o),t=o,n)}},p=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=c.A.apply(void 0,[e].concat(n));return Object(o.a)(Object(l.e)(a)).apply(void 0,n)}},d=function(e,t,n){return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];var o=c.A.apply(void 0,[e].concat(a)),s=c.A.apply(void 0,[t].concat(a)),u=c.A.apply(void 0,[n].concat(a));return"object"===typeof o&&(o=o.value),o?s:u}};Object(i.a)("hand",{handType:""},"Filters triggers generated by tidal by hand (left=false right=true)");var m=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0];n[1];if(n[3].zObject.sequencerEngine.isSequenceRolling)return Object(c.w)(!0);if(!i)return Object(c.w)(!1);if(i.isDouble)return Object(c.w)(!0);var o=i.hand?1:0,s=Math.round(c.A.apply(void 0,[e].concat(n)));return s===a.a?Object(c.w)(!0):s===a.d?Object(c.w)(!1):Object(c.w)(o===s)}},v=function(e,t,n){return f(d(Object(r.b)(n,!0),b(e),e),Object(s.l)(e,t,n))},b=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=c.A.apply(void 0,[e].concat(n));return a.slice(0,Math.floor(3*a.length/4))}}},function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"g",function(){return h}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return m}),n.d(t,"f",function(){return v}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return y});var r=n(9),a=n(45),i=(n(0),n(87));function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c="%",u=function(e){return{type:i.c,name:e}},l=function(){return{cycle:void 0,transpose:"",operand:"",operator:void 0,id:Object(a.uuid)()}},f=function(e){return""===e.transpose},h=function(e){e=" "+e+" ";for(var t=[],n=[t],r=l(),a=0;a<e.length;a++){var o=e.charAt(a);switch(o){case"*":""===r.transpose&&(r.cycle=t.pop()),r.operator="*";break;case c:""===r.transpose&&(r.cycle=t.pop()),r.operator=c;break;case"^":""===r.transpose&&(r.cycle=t.pop()),r.operator="^";break;case"/":""===r.transpose&&(r.cycle=t.pop()),r.operator="/";break;case"~":r.transpose=null;break;case"'":r.accent=!0;break;case",":r.legato=!0;break;case" ":case"\n":p(r,t),r=l();break;case"[":p(r,t),t=[],n.push(t),r=l();break;case"]":p(r,t);var s=n.pop();(t=n[n.length-1]||[]).push(s),r=l();break;default:"."!==o||f(r)?o===i.b&&f(r)?(r.type=g(),r.transpose="0"):o===i.a&&f(r)?(r.type=y(0),r.transpose="0",p(r,t),(r=l()).type=y(1),r.transpose="0"):r.operator?r.operand+=o:r.transpose+=o:r.staccato=!0}}return n[0]};function p(e,t){if(e.cycle)isNaN(parseInt(e.operand))?e.operand=u(e.operand):e.operand=parseInt(e.operand),t.push(e);else if(void 0!==e.transpose&&""!==e.transpose){var n=null;null!=e.transpose&&(n=parseFloat(e.transpose),isNaN(n)?e.transpose=u(e.transpose):e.transpose=n),isNaN(parseInt(e.operand))?e.operand&&""!==e.operand&&(e.operand=u(e.operand)):e.operand=parseInt(e.operand),t.push(e)}}var d=function e(t,n,a){for(var i=[],s="",c=void 0,u=function(a){if(Array.isArray(t[a])){s+="[";var o=e(t[a],n,!0),u=o.spans;if(void 0!==o.index&&(c=i.length+o.index),s+=u[0],u.length>=1){if(i.push("["!==s[s.length-1]&&"["!==s.trim()?s.trim()+" ":s.trim()),(i=[].concat(Object(r.a)(i),Object(r.a)(u.slice(1))))[i.length-1]=i[i.length-1].trim(),i[i.length-2]){var l=i[i.length-2].trim();"]"===l[l.length-1]&&(i[i.length-2]=l)}i[i.length-1]+="] ",s=""}else s=s.trim(),i[i.length-1]=i[i.length-1].trim(),s+="] "}else{var f=!1;n&&n.some(function(e){return e.id===t[a].id})&&(f=!0,0===i.length?i.push(s):i[i.length-1]+=s,s=""),s+=v(t[a]),a<t.length-1&&" "!==s[s.length-1]&&(s+=" "),f&&(c=i.length,i.push(s),s=" ")}},l=0;l<t.length;l++)u(l);var f,h=[].concat(Object(r.a)(i),[s]);""===h[1]&&(h.splice(1,1),c--);var p,d=[],m=o(h);try{for(m.s();!(p=m.n()).done;){var b=p.value;f&&"]"===f[f.length-1]&&(" "!==b[0]&&"]"!==b&&"["!==b&&(b=" "+b),"]"===b.trim()[0]&&(b=b.trim())),d.push(b),f=b}}catch(g){m.e(g)}finally{m.f()}return a?{spans:d,index:c}:d},m=function e(t){for(var n="",r=0;r<t.length;r++){if(Array.isArray(t[r]))n+="["+e(t[r]).trim()+"] ";else n+=v(t[r]),r<t.length-1&&" "!==n[n.length-1]&&(n+=" ")}return n},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.cycle)return"["+m(e.cycle).trim()+"]"+e.operator+b(e.operand);var n="";if(e.operator){var r=e.transpose;r=null==r?"~":"object"===typeof e.transpose?e.transpose.name:e.transpose,n=t?r:r+e.operator+b(e.operand)}else if("object"===typeof e.transpose)n=null===e.transpose?"~":e.transpose.name;else if(e.type){var a=e.type,o=a.type,s=a.value;n=o===i.b?".":o===i.a&&0===s?"-":""}else n=e.transpose;return e.accent?n+="'":e.staccato?n+=".":e.legato&&(n+=","),n},b=function(e){if(""!==e)return"object"===typeof e?e.name:e},g=function(){return{type:i.b}},y=function(e){return{type:i.a,value:e}}},,function(e,t,n){"use strict";var r=n(8),a=n(9),i=n(2),o=n(4),s=n(20),c=n(7),u=n(10),l=n(1),f=(n(21),n(719),n(97)),h=n(6),p=n(71),d=n(768),m=n(520),v=n(61),b=n(101),g=n(519);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var k=function(e){Object(c.a)(n,e);var t=y(n);function n(e,r,a){var o;return Object(i.a)(this,n),(o=t.call(this,e,r)).track.sequencerEngine&&(o.track.sequencerEngine.idToObject[o.id]=Object(s.a)(o)),o.triggers=[],o.initCache(a),o.numberOfOutputs=1,o}return Object(o.a)(n,[{key:"getObjectType",value:function(){return f.a}},{key:"getChordEffectType",value:function(){return null}},{key:"registerContext",value:function(e,t){var n=this;this.context?this.context.combineWith(e):this.context=e.getCopy(),t?(this.context.forSubDevice(this),this.context.forMidiEffect(t)):this.context.forMidiEffect(this),this.parameters.forEach(function(e){return e.setContext(n.context)})}},{key:"getText",value:function(){return this.getVisualizedParameters().map(function(e){return e.get(!0)}).map(function(e){return"number"===typeof e?Math.round(100*e)/100:e}).map(function(e){return e>0?"+"+e:e}).join(", ")}},{key:"getVisualizedParameters",value:function(){return this.parameters.filter(function(e){return e.isMapped})}},{key:"isRealTime",value:function(){return!0}},{key:"getEffectType",value:function(){return p.c}},{key:"isMidiEffect",value:function(){return!0}},{key:"needsStableLookAhead",value:function(){return!1}},{key:"onNewStep",value:function(){this.clear()}},{key:"stop",value:function(){}},{key:"clear",value:function(){this.triggers.length>0&&(this.triggers.length=0)}},{key:"input",value:function(e){e.outputNumber=0,this.triggers.push(e)}},{key:"output",value:function(){return this.triggers}},{key:"removeNote",value:function(){}},{key:"getCopy",value:function(e){return this}},{key:"addNote",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.getStep(this.track.trackData,e,null,!1);r.velocity=this.track.trackData.velocity,r.duration=null,r.transpose=e,r.slice=t,this.input(new b.a(r,0,n),!0)}},{key:"copyTrigger",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(e.stepData.duration,e.stepData||new v.a);this.track&&!this._subSequence&&(n.track=this.track);var i=this.getStep(n,void 0,void 0,t),o=new b.a(i,e.time,e.stepNumber,e.outputNumber);return e.grabs&&(o.grabs=Object(a.a)(e.grabs)),e.chokes&&(o.chokes=Object(a.a)(e.chokes)),e.message&&(o.message=Object(r.a)({},e.message)),e.delays&&(o.message=Object(r.a)({},e.delays)),o}},{key:"dispose",value:function(){var e=this;this.name=void 0;var t=this.track.sequencerEngine.state.effects.pulledEffects;this.track.sequencerEngine.dispatch(Object(h.we)(t.filter(function(t){return t!==e})))}},{key:"getParameters",value:function(){return this.parameters}},{key:"isRolling",value:function(){return this.track.sequencerEngine.isSequenceRolling}}]),n}(Object(d.a)(Object(g.a)(m.a)));t.a=k},function(e,t,n){"use strict";var r=n(56),a=n(808),i=n(647),o=n(807),s=n(1040),c=n(892),u=n(722),l=n(816),f=n(8),h=n(2),p=n(4),d=n(20),m=n(16),v=n(7),b=n(10),g=n(1),y=n(525),k=n(32),O=n(15),j=n.n(O),w=n(21),E=n(41);n(212);function S(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(g.a)(e);if(t){var a=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}new Float32Array(65536);var T=function(e){Object(v.a)(n,e);var t=x(n);function n(e){var r;return Object(h.a)(this,n),(r=t.call(this,"Genetic WaveShaper",function(){return new j.a.Gain(1)},e)).counter=0,r.waveShaperNode=new j.a.WaveShaper([-1,1]),r.effectNode.connect(r.waveShaperNode),r.postGain=new j.a.Gain(1),r.waveShaperNode.connect(r.postGain),r.overSampleParameter=new w.a("oversample",Object(d.a)(r),function(e,t){return r.waveShaperNode.oversample=t?"4x":"none"},{min:.01,max:32,unit:"",defaultValue:!1,constantAutomationRate:!0}),r.driveParameter=new E.a("drive",r.effectNode.gain,function(e,t){r.effectNode.gain.value=t,r.postGain.gain.value=Math.pow(1/t,.6)},{documention:"Controls the level of saturation.",min:.01,max:32,unit:"",defaultValue:1,constantAutomationRate:!0}),r.registerParameter(r.driveParameter),r.recomputeCurve(),r}return Object(p.a)(n,[{key:"stages",get:function(){return 6}},{key:"smoothness",get:function(){return 6}},{key:"recomputeCurve",value:function(){var e=Math.pow(2,this.smoothness+1)*(2*this.stages+1)+1;console.log("points = ",e);for(var t=new Float32Array(e),n=0;n<e;n++){var r=(2*this.stages+1)*Math.PI*(n/(e-1)-.5);t[n]=Math.sin(r)}this.waveShaperNode.curve=t}},{key:"documentation",get:function(){return"Saturates the sound, making it more distorted."}},{key:"dispose",value:function(){Object(m.a)(Object(g.a)(n.prototype),"dispose",this).call(this),this.postGain.dispose(),this.waveShaperNode.dispose()}},{key:"connect",value:function(e){this.postGain.connect(e)}},{key:"disconnect",value:function(e){this.postGain.disconnect(e)}},{key:"getJson",value:function(){var e=Object(f.a)({},Object(m.a)(Object(g.a)(n.prototype),"getJson",this).call(this),{drive:this.driveParameter.get()});return e=this.saveParameterToJson(e,"driveParameter",this.driveParameter)}},{key:"fromJson",value:function(e,t){var r=Object(m.a)(Object(g.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(k.a)(this.driveParameter,e.drive,r),Object(f.a)({},r,this.loadParameterFromJson(e,"driveParameter",this.driveParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"generateVariation",value:function(e,t){console.log("generate dregree=",t);var n,r=[],a=S(this.waveShaperNode.curve);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=Math.min(1,i+t*Math.random());Math.random()<t&&(o=0),r.push(o)}}catch(s){a.e(s)}finally{a.f()}return Float32Array.from(r)}},{key:"breed",value:function(e,t){for(var n=[],r=0;r<this.waveShaperNode.curve.length;r++){Math.random()<.6?n.push(e[r]):n.push(t[r])}return Float32Array.from(n)}},{key:"selectVariation",value:function(e,t,n){var r=this.variations[e];console.log("selected variation = ",r),this.waveShaperNode.curve=r,this.selectedVariation=e}},{key:"firstReproduction",value:function(){this.variations=this.generateVariations(this.waveShaperNode.curve)}},{key:"getBestCopy",value:function(){return this.bestSolutions}}]),n}(Object(y.a)(r.a.Effect)),C=n(815),N=n(436),R=n(542),M=n(809),A=(n(38),n(292)),q=n(639),D=n(810),I=n(232),_=n(616),F=n(293),L=n(250),B=n(773),z=n(793),V=(n(989),n(437)),H=n(619),U=n(1041),J=n(618),G=n(723),W=n(818),K=n(612),X=n(724),Q=n(725),Y=n(620),Z=n(621),$=n(509),ee=n(617),te=n(530),ne=n(811),re=n(812),ae=n(529),ie=n(813),oe=n(814),se=n(5),ce=n.n(se),ue=n(14),le=n(147);function fe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(g.a)(e);if(t){var a=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}r.a.Effect;var he=n(817),pe=n(780),de=n(510),me=n(613),ve=n(378),be=n(429),ge=n(611),ye=n(430),ke=n(609),Oe=n(431),je=(n(438),n(623),n(342)),we=n(608),Ee=n(273),Se=n(778),Pe=n(779),xe=n(783),Te=n(786),Ce=n(802),Ne=n(798),Re=n(799),Me=n(781),Ae=n(782),qe=n(384),De=n(787),Ie=n(784),_e=n(785),Fe=n(523),Le=n(614),Be=n(800),ze=n(777),Ve=n(797),He=n(801),Ue=n(772),Je=n(803),Ge=n(549),We=n(883),Ke=n(891),Xe=n(794),Qe=n(769),Ye=n(771),Ze=n(88);n.d(t,"a",function(){return $e}),n.d(t,"b",function(){return et}),n.d(t,"f",function(){return tt}),n.d(t,"e",function(){return nt}),n.d(t,"d",function(){return rt}),n.d(t,"c",function(){return at});var $e=[{value:"Bit Crusher",label:"Bit Crusher"},{value:"Chorus",label:"Chorus"},{value:"Compressor",label:"Compressor"},{value:"Convolver Reverb",label:"Convolver Reverb"},{value:"Delay",label:"Delay"},{value:"Distortion",label:"Distortion"},{value:"Effect Rack",label:"Effect Rack"},{value:"EQ8",label:"EQ 8"},{value:"Filter",label:"Filter"},{value:"Freak Shifter",label:"Freak Shifter"},{value:"Frequency Shifter",label:"Frequency Shifter"},{value:"Gain",label:"Gain"},{value:"Guitar Amp",label:"Guitar Amp"},{value:"Multi Filter",label:"Multi Filter"},{value:"Oscilloscope",label:"Oscilloscope"},{value:"Panner",label:"Panner"},{value:"Pitch Shift",label:"Pitch Shift"},{value:"Phaser",label:"Phaser"},{value:"Saturator",label:"Saturator"},{value:"Soft Clipper",label:"Soft Clipper"},{value:"Tape Delay",label:"Tape Delay"},{value:"Transient Shaper",label:"Transient Shaper"},{value:"Wave Folder",label:"Wave Folder"}];function et(e,t){var n=null;return"Filter"===e?n=new r.a.FilterEffect(t):"Reverb"===e?n=new r.a.ReverbEffect(t):"Convolver Reverb"===e?n=new A.a(t):"Delay"===e?n=new I.a(t):"Chorus"===e?n=new r.a.ChorusEffect(t):"Gain"===e?n=new i.a(t):"Genetic WaveShaper"===e?n=new T(t):"Tremolo"===e?n=new r.a.TremoloEffect(t):"Auto Filter"===e?n=new r.a.AutoFilterEffect(t):"Compressor"===e?n=new V.a(t):"Multi Filter"===e?n=new a.a(t):"Multiband Compressor"===e?n=new q.a(t):"Distortion"===e?n=new H.a(t):"Bit Crusher"===e?n=new J.a(t):"Guitar Amp"===e?n=new ie.a(t):"Granular"===e?n=new U.a(t):"EQ 3"===e||("EQ 3"===e?n=new G.a(t):"EQ 10"===e?n=new X.a(t):"Freak Shifter"===e?n=new c.a(t):"Phaser"===e?n=new N.a(t):"Auto Wah"===e?n=new u.a(t):"Gate"===e?n=new Q.a(t):"Pitch Shift"===e?n=new Y.a(t):"Panner"===e?n=new Z.a(t):"EQ8"===e?n=new F.a(t):"Chebyshev"===e?n=new ee.a(t):"Stereo Widener"===e?n=new _.a(t):"Saturator"===e?n=new te.a(t):"Soft Clipper"===e?n=new o.a(t):"Tape Delay"===e?n=new ne.a(t):"Stereo Delay"===e?n=new re.a(t):"Oscilloscope"===e?n=new D.a(t):"Effect Rack"===e?n=new ae.a(t):"Wave Folder"===e?n=new oe.a(t):"Granulator"===e?n=new s.a(t):"Ring Modulator"===e?n=new M.a(t):"Follower"===e?n=new l.a(t):"Vocoder"===e?n=new C.a(t):"Frequency Shifter"===e?n=new he.a(t):"Transient Shaper"===e&&(n=new W.a(t))),n.toggle(),n}var tt=[{value:"Regular",label:"Regular"},{value:"Double",label:"Double"},{value:"R.Every",label:"Every"},{value:"Figure",label:"Figure"},{value:"First",label:"First"},{value:"Last",label:"Last"},{value:"Later",label:"Later"},{value:"Max",label:"Max"},{value:"Skip",label:"Skip"}],nt=[{value:"Accumulator Effect",label:"Accumulator Effect"},{value:"Arpeggiator",label:"Arpeggiator"},{value:"Chord Rhythm",label:"Chord Rhythm"},{value:"Conditional Parameters",label:"Conditional Parameters"},{value:"Control Parameters",label:"Control Parameters"},{value:"Midi Delay",label:"Delay"},{value:"Every",label:"Every"},{value:"Gate",label:"Gate"},{value:"Generative Chords",label:"Generative Chords"},{value:"Grab",label:"Grab"},{value:"Grab Time",label:"Grab Time"},{value:"Harmony",label:"Harmony"},{value:"Jaki",label:"Jaki"},{value:"Linked Tidal",label:"Linked Tidal"},{value:"Midi CC",label:"Midi CC"},{value:"Midi Effect Rack",label:"Midi Effect Rack"},{value:"Note Display",label:"Note Display"},{value:"Plane Parameters",label:"Plane Parameters"},{value:"Parametizer",label:"Parametizer"},{value:"Scale",label:"Scale"},{value:"User Script",label:"Script"},{value:"Sparse",label:"Sparse"},{value:"Stats",label:"Stats"},{value:"Tidal",label:"Tidal"},{value:"Timing",label:"Timing"},{value:"Warp",label:"Warp"}],rt=[{value:"Alternate",label:"Alternate"},{value:"Alternate N",label:"Alternate N"},{value:"Limit",label:"Limit"},{value:"Midi Outputter",label:"Midi Outputter"},{value:"Pattern Switch",label:"Pattern Switch"},{value:"Roll",label:"Rolling"}];var at=function(e,t){var n=null;return"Arpeggiator"===e?n=new $.a(t):"Parametizer"===e?n=new ve.a(t):"Harmony"===e?n=new de.a(t):"Every"===e?n=new me.a(t):"Timing"===e?n=new be.a(t):"Midi Outputter"===e?n=new we.a(t):"Midi Interface"===e?n=new Oe.a(t):"Alternate Tuning"===e?n=new K.a(t):"Warp"===e?n=new L.a(t):"Midi Delay"===e?n=new ge.a(t):"Chord Rhythm"===e?n=new ye.a(t):"Chord Sculptor"===e?n=new ke.a(t):"Tidal"===e?n=new Ee.a(t):"Flush"===e?n=new Qe.a(t):"Message"===e?n=new Ye.a(t):"Midi Effect Rack"===e?n=new je.a(t):"Limit"===e?n=new Pe.a(t):"Beat Repeat"===e?n=new xe.a(t):"Steps"===e?n=new Me.a(t):"Notes"===e?n=new Ae.a(t):"User Script"===e?n=new qe.a(t):"Grab"===e?n=new Ie.a(t):"Gate"===e?n=new Ce.a(t):"Roll"===e?n=new He.a(t):"Grab Time"===e?n=new _e.a(t):"Alternate"===e?n=new Fe.a(t):"Alternate N"===e?n=new Le.a(t):"Density"===e?n=new Be.a(t):"Threshold"===e?n=new De.a(t):"Midi CC"===e?n=new pe.a(t):"Accumulator Effect"===e?n=new B.a(t):"Control Parameters"===e?n=new z.a(t):"Conditional Parameters"===e?n=new Xe.a(t):"Plane Parameters"===e?n=new R.a(t):"Micro Tuning"===e?n=new ze.a(t):"Scale"===e?n=new Ve.a(t):"Beat"===e?n=new Te.a(t):"Pattern Switch"===e?n=new Ne.a(t):"Poly"===e?n=new Re.a(t):"Linked Tidal"===e?n=new Se.a(t):"Note Display"===e?n=new Ue.a(t):"Sparse"===e?n=new Je.a(t):"Stats"===e?n=new Ke.a(t):"Jaki"===e?n=new Ge.a(t):"Accent"===e?n=new Ze.a(t):"Regular"===e?n=new Ze.r(t):"Staccato"===e?n=new Ze.u(t):"Rest"===e?n=new Ze.s(t):"Piano"===e?n=new Ze.p(t):"Pianissimo"===e?n=new Ze.o(t):"Dot"===e?n=new Ze.e(t):"Dash 1"===e?n=new Ze.c(t):"Dash 2"===e?n=new Ze.d(t):"Max"===e?n=new Ze.m(t):"Figure"===e?n=new Ze.g(t):"First"===e?n=new Ze.h(t):"R.Every"===e?n=new Ze.q(t):"Last"===e?n=new Ze.j(t):"Legato"===e?n=new Ze.l(t):"Double"===e?n=new Ze.f(t):"Later"===e?n=new Ze.k(t):"Skip"===e?n=new Ze.t(t):"Generative Chords"===e&&(n=new We.a(t)),n}},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});var r="VARIABLE",a=".",i="-"},function(e,t,n){"use strict";n.d(t,"a",function(){return k}),n.d(t,"i",function(){return O}),n.d(t,"r",function(){return j}),n.d(t,"f",function(){return w}),n.d(t,"v",function(){return E}),n.d(t,"l",function(){return S}),n.d(t,"u",function(){return P}),n.d(t,"b",function(){return x}),n.d(t,"s",function(){return T}),n.d(t,"p",function(){return C}),n.d(t,"o",function(){return N}),n.d(t,"e",function(){return R}),n.d(t,"c",function(){return M}),n.d(t,"d",function(){return A}),n.d(t,"n",function(){return q}),n.d(t,"m",function(){return D}),n.d(t,"g",function(){return I}),n.d(t,"k",function(){return _}),n.d(t,"t",function(){return F}),n.d(t,"q",function(){return L}),n.d(t,"h",function(){return B}),n.d(t,"j",function(){return z});var r=n(8),a=n(20),i=n(16),o=n(2),s=n(4),c=n(7),u=n(10),l=n(1),f=n(85),h=n(21),p=n(32),d=n(23),m=n(83),v=n(48);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var g=function(e){Object(c.a)(n,e);var t=b(n);function n(e,r,a,i,s){var c;return Object(o.a)(this,n),(c=t.call(this,e,r,0)).numberOfOutputs=3,c.predicate=a,c.action=i,c.aux=s,c}return Object(s.a)(n,[{key:"getText",value:function(){return void 0!==this.value?this.value:""}}]),n}(f.a),y=function(e){Object(c.a)(n,e);var t=b(n);function n(e,r,i){var s;return Object(o.a)(this,n),(s=t.call(this,e,r,void 0,void 0,i)).numberOfOutputs=1,s.valueParameter=new h.b("value",Object(a.a)(s),function(e,t){e.rack&&e.rack.updateRules()},{defaultValue:void 0,min:-1,max:16,exactAutomation:!0}),s.registerParameter(s.valueParameter),s}return Object(s.a)(n,[{key:"getJson",value:function(){var e=Object(r.a)({},Object(i.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{value:this.value});return e=Object(d.b)(e,"valueParameter",this.valueParameter)}},{key:"fromJson",value:function(e){var t=Object(i.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e);return Object(p.a)(this.valueParameter,e.value,t),Object(r.a)({},t,Object(d.a)(e,"valueParameter",this.valueParameter))}},{key:"value",get:function(){return Math.round(this.valueParameter.get())},set:function(e){this.valueParameter.set(e,!1,!1)}}]),n}(g),k=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Accent",e,void 0,v.a)}return n}(g),O=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Flam",e,void 0,v.d)}return n}(g),j=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Regular",e,void 0,v.h)}return n}(g),w=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Double",e,void 0,v.c)}return n}(g),E=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,"Times",e,void 0,v.k)).valueParameter=new h.b("value",Object(a.a)(i),function(e,t){i.action=Object(r.a)({},v.k,{value:t}),e.rack&&e.rack.updateRules()},{defaultValue:3,min:1,max:16,exactAutomation:!0}),i.registerParameter(i.valueParameter),i}return Object(s.a)(n,[{key:"value",get:function(){return Math.round(this.valueParameter.get())},set:function(e){this.valueParameter.set(e,!1,!1)}},{key:"getJson",value:function(){var e=Object(r.a)({},Object(i.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{value:this.value});return e=Object(d.b)(e,"valueParameter",this.valueParameter)}},{key:"fromJson",value:function(e){var t=Object(i.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e);return Object(p.a)(this.valueParameter,e.value,t),Object(r.a)({},t,Object(d.a)(e,"valueParameter",this.valueParameter))}}]),n}(g),S=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Legato",e,void 0,v.e)}return n}(g),P=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Staccato",e,void 0,v.j)}return n}(g),x=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Any",e,v.b)}return n}(g),T=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Rest",e,void 0,v.i)}return n}(g),C=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Piano",e,void 0,v.g)}return n}(g),N=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Pianissimo",e,void 0,v.f)}return n}(g),R=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Dot",e,Object(m.c)())}return n}(g),M=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Dash 1",e,Object(m.b)(0))}return n}(g),A=function(e){Object(c.a)(n,e);var t=b(n);function n(e){return Object(o.a)(this,n),t.call(this,"Dash 2",e,Object(m.b)(1))}return n}(g),q=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Otherwise",e,Object(v.p)())).numberOfOutputs=1,r}return n}(g),D=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Max",e,function(e,t){return e.max(t)})).value=1,r}return n}(y),I=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Figure",e,function(e,t){return e.figure(t)})).value=0,r}return n}(y),_=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Later",e,function(e,t){return e.later(t)})).value=2,r}return n}(y),F=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Skip",e,function(e,t){return e.skip(t)})).value=2,r}return n}(y),L=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"R.Every",e,function(e,t){return e.every(t)})).value=2,r}return n}(y),B=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"First",e,function(e,t){return e.first(t)})).value=0,r}return n}(y),z=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Last",e,function(e,t){return e.last(t)})).value=0,r}return n}(y)},function(e,t,n){"use strict";n.d(t,"f",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"b",function(){return u});var r=1,a=2,i=3,o=4,s=1,c=2,u=3},,,function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return new Promise(function(t,n){setTimeout(t,e)})}},function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=1,a=2,i=3,o="bang"},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),a=n(4),i=new(function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,[{key:"setItem",value:function(e,t){if(!window.isNFT)return window.localStorage.setItem(e,t)}},{key:"removeItem",value:function(e){window.isNFT||window.localStorage.removeItem(e)}},{key:"getItem",value:function(e){return window.isNFT?null:window.localStorage.getItem(e)}}]),e}())},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e,t){return(e%t+t)%t}},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});var r=36,a=56,i=24},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return s});var r="zobject",a="zmessage",i="pad",o="track",s="effect"},,,,function(e,t,n){"use strict";var r=n(2);t.a=function e(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(r.a)(this,e),this.stepData=t,this.time=n,this.stepNumber=a,this.grabs=[],this.chokes=[],this.outputNumber=i}},function(e,t,n){"use strict";var r=n(9),a=n(8),i=n(2),o=n(4),s=n(7),c=n(10),u=n(1),l=n(111),f=n(125),h=n(388);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var d=n(236),m=n(45);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var b=function(e){Object(s.a)(n,e);var t=v(n);function n(e,r,a,o,s){var c;return Object(i.a)(this,n),(c=t.call(this)).id=Object(m.uuid)(),c.sourceNode=r,c.destNode=o,c.sourceType=e,c.sourceId=r.id,c.destType=a,c.destId=o.id,c.action=s,c._sourceType=c.getFullType(e,c.sourceId),c.reader=Object(d.a)(c._sourceType),s&&Object(l.d)(c._sourceType,s),c.segmentation=void 0,c}return Object(o.a)(n,[{key:"segment",value:function(){this.segmentation=!0}},{key:"getJson",value:function(){return{id:this.id,sourceEl:this.getFullType(this.sourceType,this.sourceId),destEl:this.getFullType(this.destType,this.destId),sourceType:this.sourceType,sourceId:this.sourceId,destType:this.destType,destId:this.destId,sourceWindowId:this.sourceNode.zObject?this.sourceNode.zObject.id:this.sourceNode.id,destWindowId:this.destNode.zObject?this.destNode.zObject.id:this.destNode.id}}},{key:"dispose",value:function(){Object(l.e)(this._sourceType,this.action),this.reader(!0)}}]),n}(function(e){Object(s.a)(n,e);var t=p(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getFullType",value:function(e){return e+"."+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.id)}}]),n}(function(){return function e(){Object(i.a)(this,e)}}())),g=n(6);function y(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var j=[];window.bulkCalled=0,window.notBulkCalled=0;t.a=function(e){return function(e){Object(s.a)(n,e);var t=O(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).inlets={},e.outlets={},e.numInlets=0,e.numOutlets=0,e.messageSubscribers={},e}return Object(o.a)(n,[{key:"newInlet",value:function(e,t){this.inlets[e]={action:t,connections:[]},this.numInlets++,this.subSequence&&this.subSequence.hasInstances&&this.subSequence.onChange()}},{key:"newOutlet",value:function(e){this.outlets[e]={connections:[]},this.numOutlets++,this.subSequence&&this.subSequence.hasInstances&&this.subSequence.onChange()}},{key:"bang",value:function(){}},{key:"isInletConnected",value:function(e){return!!this.inlets[e]&&this.inlets[e].connections.length>0}},{key:"isOutletConnected",value:function(e){for(var t in this.getConnectedOutlets(e))return!0;return!1}},{key:"getConnectedInlets",value:function(e){return this.inlets[e]?this.inlets[e].connections:j}},{key:"getConnectedOutlets",value:function(e){return this.outlets[e]?this.outlets[e].connections:j}},{key:"connectInlet",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!t.outlets[n]&&(n=Object.keys(t.outlets)[0],!t.outlets[n]))return{};if(!this.inlets[e])return{};var i=new b(n,t,e,this,this.inlets[e].action);return r&&(i.id=r),this.inlets[e].connections.some(function(r){return r.sourceNode===t&&r.sourceType===n&&r.destType===e})?{}:(this.inlets[e].connections.push(i),t.outlets[n].connections.push(i),t.needsStart,this.needsHotReload&&this.sequencerEngine&&!this.sequencerEngine.isLoading&&(this.args&&(this.previousArgs=void 0),t.args,Object(h.a)(this),t.args),this.subSequence.propagate(Object(f.l)(t,this,n,e)),this.updateMessagingRedux(a))}},{key:"deleteConnection",value:function(e){var t=e.destType,n=e.sourceType,r=e.sourceNode;this.inlets&&this.inlets[t]&&(this.inlets[t].connections=this.inlets[t].connections.filter(function(t){return t!==e})),r.outlets&&r.outlets[n]&&(r.outlets[n].connections=r.outlets[n].connections.filter(function(t){return t!==e}),r.outlets[n].connections=r.outlets[n].connections),e.dispose(),this.updateMessagingRedux(),this.needsHotReload&&(this.args&&this.previousArgs&&(this.args=this.previousArgs),Object(h.a)(this)),r.needsHotReload&&Object(h.a)(r),this.dispatch&&this.dispatch(Object(g.ff)(void 0))}},{key:"disconnectInlet",value:function(e,t,n){var r=this.inlets[e].connections.find(function(r){return r.sourceNode===t&&r.destType===e&&r.sourceType===n});this.deleteConnection(r),this.subSequence.propagate(Object(f.m)(r.sourceNode,r.destNode,r.sourceType,r.destType))}},{key:"updateMessagingRedux",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e={};for(var t in this.inlets){this.inlets[t].readers;e[this.getFullType(t)]=this.inlets[t].connections.map(function(e){return e.getJson()})}window.notBulkCalled++;var n=this.subSequence;if(this.track&&this.track.subSequence&&(n=this.track.subSequence),this.sequencerEngine&&this.sequencerEngine.isLoading)this.sequencerEngine.bulkConnections[n.id]=Object(a.a)({},this.sequencerEngine.bulkConnections[n.id],e);else if(n){var r=n.state.windows.inletConnections[n.id]||{};n.dispatch(Object(g.Bc)(n.id,Object(a.a)({},r,e)))}}},{key:"clearMessagingRedux",value:function(){var e=[];for(var t in this.inlets){var n=this.getFullType(t);e.push(n)}var r=this.subSequence;if(this.track&&this.track.subSequence&&(r=this.track.subSequence),r){var i=r.state.windows.inletConnections[r.id]||{};i=Object(a.a)({},i);var o,s=y(e);try{for(s.s();!(o=s.n()).done;){delete i[o.value]}}catch(c){s.e(c)}finally{s.f()}r.dispatch(Object(g.Bc)(r.id,i))}}},{key:"getFullType",value:function(e){return e+"."+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.id)}},{key:"sendMessage",value:function(e){var t=this.outlets[e];if(t){for(var n=t.connections,r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];var o,s=y(n);try{for(s.s();!(o=s.n()).done;){var c=o.value,u=(c.destNode,c.action);u&&u(a)}}catch(l){s.e(l)}finally{s.f()}}}},{key:"receiveMessage",value:function(e){if(!this.inlets[e])return j;var t,n=this.inlets[e].connections,a=j,i=y(n);try{for(i.s();!(t=i.n()).done;){var o=t.value.reader();o.length>0&&(a=a===j?o:[].concat(Object(r.a)(a),Object(r.a)(o)))}}catch(s){i.e(s)}finally{i.f()}return a}},{key:"disposeMessaging",value:function(){for(var e in this.inlets)this.deleteInlet(e,!1);for(var t in this.outlets)this.deleteOutlet(t,!1);this.updateMessagingRedux(),this.inlets=void 0,this.outlets=void 0}},{key:"deleteInlet",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inlets[e]&&(this.disconnectFromInlet(e),delete this.inlets[e],this.numInlets--,t&&this.updateMessagingRedux())}},{key:"disconnectFromInlet",value:function(e){var t=this;this.inlets[e]&&(this.inlets[e].connections.forEach(function(e){return t.deleteConnection(e)}),this.subSequence&&this.subSequence.hasInstances&&this.subSequence.onChange())}},{key:"disconnectFromOutlet",value:function(e){this.outlets[e]&&(this.outlets[e].connections.forEach(function(e){e.sourceNode.deleteConnection(e)}),this.subSequence&&this.subSequence.hasInstances&&this.subSequence.onChange())}},{key:"deleteOutlet",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=y(this.outlets[e].connections);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.destNode.deleteConnection(a)}}catch(i){r.e(i)}finally{r.f()}delete this.outlets[e],this.numOutlets--,n&&this.updateMessagingRedux(),this.subSequence&&this.subSequence.hasInstances&&this.subSequence.onChange()}},{key:"getOutboundNodes",value:function(){return this.getAdjacentNodes(this.outlets,"destNode","destType")}},{key:"getAdjacentNodes",value:function(e,t,n){var r={};for(var a in e){var i=e[a].connections.map(function(e){return{node:e[t],type:e[n]}});i.length>0&&(r[a]=i)}return r}},{key:"getInboundNodes",value:function(){return this.getAdjacentNodes(this.inlets,"sourceNode","sourceType")}},{key:"searchForNode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.outlets;if(n){var r=Object.keys(n),a=t?n[t]:n[r[0]];if(this.linkedOutlet&&(a=this.linkedOutlet),a){var i,o=y(a.connections);try{for(o.s();!(i=o.n()).done;){var s=i.value.destNode;if(s.name===e)return s;if(s.effect&&s.effect.name===e)return s;var c=s.searchForNode(e,void 0);if(c)return c}}catch(u){o.e(u)}finally{o.f()}}}}}]),n}(e)}},function(e,t,n){"use strict";n.d(t,"k",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"g",function(){return i}),n.d(t,"h",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"l",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"p",function(){return f}),n.d(t,"b",function(){return h}),n.d(t,"d",function(){return p}),n.d(t,"m",function(){return d}),n.d(t,"n",function(){return m}),n.d(t,"i",function(){return v}),n.d(t,"j",function(){return b}),n.d(t,"r",function(){return g}),n.d(t,"q",function(){return y}),n.d(t,"o",function(){return k});var r="PROBABILITY",a="EVERY",i="MARKOV",o="MARKOV_PREVIOUS",s="GATE_MASK",c="REVERSE",u="LEGATO",l="DELAY",f="TRANSPOSE",h="DURATION",p="EXPAND",d="ROLL",m="SCRIPT",v=[f,l,p,h],b=[c,f,h,s,l,p,d,u],g=function(e){return e===p?{min:0,max:4,step:.25}:e===l?{min:0,max:16,step:1}:e===h?{min:0,max:4,step:.01}:{min:-32,max:32,step:1}},y=[{label:"Every",value:a},{label:"Markov",value:i},{label:"Probability",value:r}],k=[{label:"Delay",value:l},{label:"Duration",value:h},{label:"Expand",value:p},{label:"Gate Mask",value:s},{label:"Legato",value:u},{label:"Reverse",value:c},{label:"Roll",value:d},{label:"Script",value:m},{label:"Transpose",value:f}]},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r="LFO",a="ENV"},function(e,t,n){"use strict";n.d(t,"o",function(){return l}),n.d(t,"p",function(){return f}),n.d(t,"k",function(){return h}),n.d(t,"b",function(){return p}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return m}),n.d(t,"d",function(){return v}),n.d(t,"t",function(){return b}),n.d(t,"q",function(){return g}),n.d(t,"g",function(){return y}),n.d(t,"h",function(){return k}),n.d(t,"i",function(){return O}),n.d(t,"m",function(){return j}),n.d(t,"f",function(){return w}),n.d(t,"r",function(){return E}),n.d(t,"u",function(){return S}),n.d(t,"n",function(){return P}),n.d(t,"v",function(){return x}),n.d(t,"e",function(){return T}),n.d(t,"s",function(){return C}),n.d(t,"j",function(){return N}),n.d(t,"l",function(){return R}),n.d(t,"w",function(){return M});var r=n(11),a=n(8),i=n(9),o=n(17),s=(n(153),n(344),n(82));function c(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e,t,n){return function(){for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];var u=o.A.apply(void 0,[t].concat(s)),l=Object(i.a)(o.A.apply(void 0,[e].concat(s))),f=o.A.apply(void 0,[n].concat(s))(l[u]);return f=Array.isArray(f)?Object(i.a)(f):Object(a.a)({},f),l[u]=f,l}},f=function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];var c=o.A.apply(void 0,[t].concat(i)),u=o.A.apply(void 0,[e].concat(i));if(n){var l=Object(a.a)({},o.A.apply(void 0,[n].concat(i)));return l.operator=u,l.operand=c,l}return function(e){return e.operator=u,e.operand=c,e}}},h=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=o.A.apply(void 0,[e].concat(r)),s=o.A.apply(void 0,[t].concat(r)),u=i.flat(16);return function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!Array.isArray(t))return{p:t,count:r};var a,i=c(t);try{for(i.s();!(a=i.n()).done;){var o=a.value,s=e(o,n,r);if(s.count===n&&s.p)return s;Array.isArray(o)?r=s.count:r++}}catch(u){i.e(u)}finally{i.f()}return{count:r}}(i,s%u.length).p}},p=function(e){return!Array.isArray(e)},d=function(e){return null===e.transpose},m=function(e){return e.accent},v=function(e){return e.staccato},b=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var c=void 0;return function(){for(var t=arguments.length,i=new Array(t),u=0;u<t;u++)i[u]=arguments[u];var l=o.A.apply(void 0,[e].concat(i));return void 0===l?c:c=function e(t){var c=n.map(function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];return[o.A.apply(void 0,[n].concat(i)),o.A.apply(void 0,[a].concat(i))]});if(p(t)){var u=c.find(function(e){var n=Object(r.a)(e,2),a=n[0];return n[1],a===t.transpose});if(u){var l=u[1];return Array.isArray(l)?l:"string"===typeof l?Object(s.f)(l).apply(void 0,i):Object(a.a)({},t,{transpose:l})}return t}return t.map(function(t){return e(t)})}(l)}},g=function(e,t,n){return function(){for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];var l=o.A.apply(void 0,[e].concat(a)),f=Object(i.a)(l[0]),h=o.A.apply(void 0,[t].concat(a)).map(function(e){return o.A.apply(void 0,[e].concat(a))}),p=o.A.apply(void 0,[n].concat(a));Array.isArray(p)||(p=null===p?Object(s.f)("~").apply(void 0,a):Object(s.f)(p).apply(void 0,a));var d,m=c(h);try{for(m.s();!(d=m.n()).done;){f[d.value%f.length]=p}}catch(v){m.e(v)}finally{m.f()}return[f]}},y=function(e,t,n){return function(){for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];var u=o.A.apply(void 0,[e].concat(a));u=Object(i.a)(u[0]);var l=o.A.apply(void 0,[n].concat(a)),f=o.A.apply(void 0,[t].concat(a));return Array.isArray(l)?u.splice(f,0,l):u.splice(f,0,Object(s.f)(new String(l))()),[u]}},k=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var c=o.A.apply(void 0,[e].concat(r));c=Object(i.a)(c[0]);var u=n.map(function(e){return o.A.apply(void 0,[e].concat(r))}),l=u.length;return[c.flatMap(function(e,t){return[e,Array.isArray(u[t%l])?u[t%l]:Object(s.f)(new String(u[t%l]))()]})]}},O=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var c=o.A.apply(void 0,[e].concat(r));c=Object(i.a)(c[0]);var u=n.map(function(e){return o.A.apply(void 0,[e].concat(r))}),l=u.length;return[c.flatMap(function(e,t){return[Array.isArray(u[t%l])?u[t%l]:Object(s.f)(new String(u[t%l]))(),e]})]}},j=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var s=o.A.apply(void 0,[e].concat(r));return[(s=Object(i.a)(s[0])).map(function(e,n){return o.A.apply(void 0,[t(e,n)].concat(r))})]}},w=function(e,t,n){return function(){for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];var u=o.A.apply(void 0,[e].concat(a));u=Object(i.a)(u[0]);var l=o.A.apply(void 0,[n].concat(a)),f=o.A.apply(void 0,[t].concat(a))%u.length,h=u[f];return Array.isArray(h)||(h=[h]),Array.isArray(l)||(l=Object(s.f)(new String(l))()),u[f]=[].concat(Object(i.a)(h),[l]),[u]}},E=function(e,t,n){return function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];var c=o.A.apply(void 0,[e].concat(a));c=Object(i.a)(c[0]);var u=o.A.apply(void 0,[t].concat(a)),l=o.A.apply(void 0,[n].concat(a));return c.splice(u,l),[c]}},S=function(e,t,n){return function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];var c=o.A.apply(void 0,[e].concat(a));c=Object(i.a)(c[0]);var u=o.A.apply(void 0,[t].concat(a)),l=o.A.apply(void 0,[n(c[u])].concat(a));return c[u]=l,[c]}},P=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var s=o.A.apply(void 0,[e].concat(r));Array.isArray(s)||(s=[s]);for(var c=o.A.apply(void 0,[t].concat(r)),u=[],l=0;l<c;l++)u=[].concat(Object(i.a)(u),Object(i.a)(s));return[u]}},x=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0;return function(){for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];var f=o.A.apply(void 0,[e].concat(u)),h=function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;if(!Array.isArray(t))return i===r?{pattern:o.A.apply(void 0,[n(t,s,l)].concat(u)),count:i}:{pattern:t,count:i};var f,h=[],p=0,d=c(t);try{for(d.s();!(f=d.n()).done;){var m=f.value,v=e(m,r,i,t,p++);h.push(v.pattern),Array.isArray(m)?i=v.count:a&&null!==m.transpose&&i++}}catch(b){d.e(b)}finally{d.f()}return{pattern:h,count:i}}(f=!r&&Array.isArray(f[0])?Object(i.a)(f[0]):Object(i.a)(f),o.A.apply(void 0,[t].concat(u)));return r?h.pattern:[h.pattern]}},T=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Object(a.a)({},o.A.apply(void 0,[e].concat(r)),{accent:o.A.apply(void 0,[t].concat(r))})}},C=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Object(a.a)({},o.A.apply(void 0,[e].concat(r)),{staccato:o.A.apply(void 0,[t].concat(r))})}},N=function(e,t){var n,r,a;return function(){for(var i=arguments.length,u=new Array(i),l=0;l<i;l++)u[l]=arguments[l];var f=o.A.apply(void 0,[e].concat(u)),h=o.A.apply(void 0,[t].concat(u));if(r===f&&h===a)return n;r=f,a=h;return n=[function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(p(t))return n.includes(r)?{pattern:t,count:r}:{pattern:Object(s.f)("~")(),count:r};var a,i=[],o=c(t);try{for(o.s();!(a=o.n()).done;){var u=a.value,l=e(u,n,r);p(u)?r++:r=l.count,i.push(l.pattern)}}catch(f){o.e(f)}finally{o.f()}return{count:r,pattern:i}}(f,h).pattern]}},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];for(var s=o.A.apply(void 0,[t].concat(a)),c=o.A.apply(void 0,[e].concat(a)),u=0,l=0;l<c.length;l++){var f=c[l];f.cycleLength?u+=f.cycleLength:u++}return o.A.apply(void 0,[n].concat(a)),2*s*u}},M=function(e,t){var n,r,a;return function(){for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];var u=o.A.apply(void 0,[t].concat(s)),l=o.A.apply(void 0,[e].concat(s));if(0===u)return l;if(u===r&&n===l)return a;r=u,n=l;for(var f=void 0,h=0,p=l.length-1;p>=0;p--){var d=l[p];if(Array.isArray(d)&&(d=d[0]),f!==d.figureId&&(f=d.figureId,p!==l.length-1&&h++,h===u))break}var m=0;for(m=0;m<l.length&&l[m].lastFigure===f;m++);var v=l.slice(m,p+1);return a=v}}},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return s});var r=1,a=2,i=3,o=4,s=function(e){switch(e){case i:return window.innerHeight-280;default:return 380}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){var e={};return function(t,n,r){return void 0===t?Object.keys(e):t in e?e[t]:void(e[t]={params:n,description:r})}}()},,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(22),u=n(0),l=n.n(u);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){return l.a.createElement(c.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,name:"Wet",parameter:this.props.effect.wetParameter,lfoEnabled:!0,onParameterChanged:this.props.onParameterChanged,isParameter:!0,displayFunction:function(e){return Math.floor(100*e)},unit:"%",step:.01,max:1,min:0})}}]),n}(u.Component);t.a=h},function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return h}),n.d(t,"a",function(){return p});var r=n(9),a=n(1038);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=[],c=function(){var e={},t=[],n={},o=function(e,t){n[e]&&n[e].forEach(function(e){return e(t)})},c=function(e,t){n[e]&&(n[e]=n[e].filter(function(e){return e!==t}))},u=function(t){return e[t]||s};return{notify:o,subscribe:function(e,a,i){return n[e]||(n[e]=[]),n[e]=[a].concat(Object(r.a)(n[e])),i&&t.push(a),function(){return c(e,a)}},publish:function(t,n){e[t]||(e[t]=[]),e[t].unshift(n),o(t,n)},read:u,drain:function(t){var n=u(t);return e[t]&&(e[t].length=0),n},clearQueue:function(){Object(a.a)(e);var r,o=i(t);try{var s=function(){var e=r.value;for(var t in n)n[t]=n[t].filter(function(t){return t!==e})};for(o.s();!(r=o.n()).done;)s()}catch(c){o.e(c)}finally{o.f()}t.length=0},unsubscribe:c}}(),u=(c.notify,c.unsubscribe),l=c.subscribe,f=c.publish,h=c.read,p=(c.drain,c.clearQueue);window.subs=l},function(e,t,n){"use strict";n.d(t,"d",function(){return p}),n.d(t,"e",function(){return d}),n.d(t,"i",function(){return m}),n.d(t,"c",function(){return v}),n.d(t,"a",function(){return b}),n.d(t,"b",function(){return g}),n.d(t,"f",function(){return y}),n.d(t,"h",function(){return k}),n.d(t,"g",function(){return O}),n.d(t,"k",function(){return E}),n.d(t,"o",function(){return S}),n.d(t,"j",function(){return P}),n.d(t,"l",function(){return x}),n.d(t,"m",function(){return T}),n.d(t,"n",function(){return C});var r=n(8),a=n(35),i=n(236),o=(n(209),n(107)),s=n(154),c=n(152),u=n(795),l=n(68);function f(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p="NAVIER",d="NONE",m="ROTATE",v="LIFE",b="BOUNCE",g="BOUNCE_2",y="ROTATE_ANGLE",k="SPIRAL",O="SCRIPT",j=(Math.sqrt,Math.pow,Object.keys),w=Object.values,E=function(e){return function(t,n,r){return(r.density||1)*e[5].getViscosity(t,n)}};Object(o.a)("swap",{},"Swaps the parameter values cyclicly");var S=function(){var e=Object(c.b)();return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];t=Object(c.a)(e,t,r);var i,o={},s=j(t),u=t[s[0]],l=0,h=f(s);try{for(h.s();!(i=h.n()).done;){var p=i.value,d=void 0;d=l===s.length-1?u:t[s[l+1]],o[p]={x:d.x,y:d.y,density:d.density},l++}}catch(m){h.e(m)}finally{h.f()}return o}},P=function(e,t,n){var r=Object(s.a)(w(e)),a={};for(var i in e){var o=e[i],c=o.x,u=o.y,l=n?n(c,u,e[i]):10,f=c+(c-r.x)*t*10/l,h=u+(u-r.y)*t*10/l;a[i]={x:f,y:h,density:l}}return a};Object(o.a)("expand",{minWidth:"Minimum width of the expansion",maxWidth:"Maximum width of the expansion"},"Expands the values to maxWidth (ratio of initial width 0-1) and then contracts to minWidth (ratio of initial width)");var x=function(e,t){var n=Object(c.b)(),r=!0,i=void 0;return function(o){var u=Object(s.b)(o);i||(i=u);for(var f=arguments.length,h=new Array(f>1?f-1:0),p=1;p<f;p++)h[p-1]=arguments[p];var d=Object(c.a)(n,o,h),m=l.a.apply(void 0,[e].concat(h))*i,v=l.a.apply(void 0,[t].concat(h))*i,b=h[0];return r&&(u>=v||u>=a.c)?r=!1:!r&&u<=m&&(r=!0),P(d,r?b/5:-b/5,E(h))}};Object(o.a)("life",{},"Expands/contracts and randomizes");var T=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=Object(c.b)(),n=!1,a=0,o=Object(i.a)("planarReset");return function(i){for(var s=arguments.length,u=new Array(s>1?s-1:0),l=1;l<s;l++)u[l-1]=arguments[l];i=Object(c.a)(t,i,u);var f=u[0],h=u[1],p=u[5];o().some(function(e){return e===p.id})&&(n=!1,a=0),++a%h===0&&(n=!n);var d={};if(e)for(var m in i){var v=Math.random(),b=i[m],g=b.x,y=b.y;v<.2||(v<.4?g--:v<.6?g++:v<.8?y++:y--,d[m]={x:g,y:y})}else d=Object(r.a)({},i);var k=n?Math.random()*f/5:-Math.random()*f/5;return e||(k=n?f/10:-f/10),P(d,k,E(u))}};Object(o.a)("rotate",{degrees:"The degrees of rotation"},"Rotates the parameter values by the center, according to the degrees (0-90)");var C=function(e){var t=Object(c.b)();return function(n){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];n=Object(c.a)(t,n,[r].concat(i));var f=l.a.apply(void 0,[e,r].concat(i)),h=Object(s.a)(w(n)),p=h.x,d=h.y,m=N(n,-p,-d),v=Object(u.a)(f)*r,b={};return j(m).forEach(function(e){var t=m[e],n=t.x,a=t.y,o=E([r].concat(i))(n,a,m[e]),s=10*v/o;b[e]={x:n*Math.cos(s)-a*Math.sin(s),y:a*Math.cos(s)+n*Math.sin(s),density:o}}),N(b,p,d)}},N=function(e,t,n){var a={};return j(e).forEach(function(i){return a[i]=Object(r.a)({},e[i],{x:e[i].x+t,y:e[i].y+n})}),a}},,function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(76),o=n(12);t.a=Object(o.b)(function(e,t){return{value:t.parameter.get()}},null)(function(e){var t=Object(r.useCallback)(function(t){document.activeElement.blur(),e.parameter.set(!e.value)},[e.parameter,e.value]);return a.a.createElement(i.a,{element:e.parameter,className:"checkbox-parameter"},a.a.createElement("label",null,a.a.createElement("input",{type:"checkbox",value:"checked",checked:e.flipped?!e.value:e.value,onChange:t}),e.name))})},function(e,t,n){"use strict";var r=n(9),a=n(104),i=n(61),o=n(17);n(111);function s(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=new i.a,l=function e(t,n,a){var i=t;void 0===t.axiom&&(i=t(n.stepData,n.stepNumber,n.time,a,n.graphics,n.delays));var c,l,d,m;switch(i.axiom){case o.c:return Object(o.A)(i.value,n.stepData,n.stepNumber,n.time,a)?[n]:[];case o.j:(c=a.copyTrigger(n,!0)).stepData.slide=n.stepData.slide;var v=Object(o.A)(i.value,n.stepData,n.stepNumber,n.time,a);Array.isArray(v)&&(v=v[0]);var b=void 0!==v[i.param]?v[i.param]:"function"===typeof v?Object(o.A)(v,n.stepData,n.stepNumber,n.time,a):v;"object"===typeof b&&b.sequence&&(b=b.sequence[0]);var g=c.stepData[i.param+"Parameter"];return g&&g.set(b),[c];case o.m:return(c=a.copyTrigger(n,!0)).outputNumber=Object(o.A)(i.value),[c];case o.d:return(c=a.copyTrigger(n,!0)).grabs=[].concat(Object(r.a)(c.grabs),[{trackNumber:i.trackNumber,fromParam:i.fromParam,toParam:i.toParam,add:i.add}]),[c];case o.a:return(c=a.copyTrigger(n,!0)).chokes=[].concat(Object(r.a)(c.chokes),[{trackNumber:i.trackNumber}]),[c];case o.e:return(c=a.copyTrigger(n,!0)).grabs=[].concat(Object(r.a)(c.grabs),[{trackNumber:i.trackNumber,isTime:!0}]),[c];case o.i:var y,k=s(i.sequence);try{for(k.s();!(y=k.n()).done;){var O=y.value,j=n,w=j.time,E=j.stepNumber;Array.isArray(n)&&(w=n[0].time,E=n[0].stepNumber);var S=f(O,Array.isArray(n)?n:[n],E,w,a);if(0===S.length)return[];n=S}}catch(A){k.e(A)}finally{k.f()}return Array.isArray(n)?n:[n];case o.g:var P,x=[],T=s(i.sequence);try{for(T.s();!(P=T.n()).done;){var C=e(P.value,n,a);0!==C.length&&(x=[].concat(Object(r.a)(x),Object(r.a)(C)))}}catch(A){T.e(A)}finally{T.f()}return x;case o.l:return h(i,a.track.sequencerEngine),[n];case o.k:return p(i,a.track),[n];case o.h:return l=i.value,d=a.sequencerEngine||a.track.sequencerEngine,m=a.track,d.switchToPattern(Math.round(Object(o.A)(l)),!0,m.subSequence,void 0,void 0,!0),[n];case o.n:var N=[];if(Array.isArray(i.value))return i.value;if(0===(N=[i.value]).length){var R=a.getStep(u);R.track=a.track,N=[{stepData:R,time:n.time,stepNumber:n.stepNumber}]}return N;case o.b:var M=Object(o.A)(i.condition,n.stepData,n.stepNumber,n.time,a);return e(("object"===typeof M?M.value:M)?i.statement1:i.statement2,n,a);case o.f:return n.message&&n.message.type===i.value.type?e(i.value.fn(n.message.value),n,a):Array.isArray(n)?n:[n]}return[]},f=function e(t,n,a,i,c){var f=[];if(n.length>0){var h,p=s(n);try{for(p.s();!(h=p.n()).done;){var d=h.value;f=[].concat(Object(r.a)(f),Object(r.a)(l(t,d,c)))}}catch(y){p.e(y)}finally{p.f()}}else{if("function"!==typeof t){var m=t;t=function(){return m}}var v=t(void 0,a,i,c),b=v.axiom,g=v.value;if(b===o.n||b===o.g||b==o.i)if(v.sequence&&(f=b===o.g?[].concat(Object(r.a)(f),Object(r.a)(v.sequence.map(function(t){return e(t,n,a,i,c)}).reduce(function(e,t){return[].concat(Object(r.a)(e),Object(r.a)(t))},[]))):[].concat(Object(r.a)(f),Object(r.a)(v.sequence.reduce(function(t,n){return e(n,t,a,i,c)},n)))),Array.isArray(g)?f=[].concat(Object(r.a)(f),Object(r.a)(g)):void 0!==g&&f.push(g),b===o.n&&0===f.length)c.getStep(u).track=c.track,f.push({stepData:c.getStep(u),time:i,stepNumber:a})}return f},h=function(e,t){var n=e.number,r=e.modType,i=e.param,s=e.value;if(r===a.a){var c=t.envelopes[n][i+"Parameter"];c&&c.set(Object(o.A)(s))}else{var u=t.lfos[n].lfo[i+"Parameter"];u&&u.set(Object(o.A)(s))}},p=function(e,t){var n=e.name,r=e.value,a=t.liveEffects.effects.find(function(e){return"Macros"===e.name});if(a){var i=a.macros.find(function(e){return e.name===n});if(i){var s=Math.max(0,Math.min(1,Object(o.A)(r)));i.macroParameter.set(s)}}};n.d(t,"a",function(){return d});var d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n,r,a){return t.reduce(function(e,t){return f(t,e,n,r,a)},e)}}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=(n(15),n(85)),u=(n(57),n(21),n(521)),l=n(9),f=n(273);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(e,a){var i;return Object(r.a)(this,n),(i=t.call(this,e,a)).myScript=function(){return[]},i.isScript=!0,i}return Object(a.a)(n,[{key:"onNewStep",value:function(){this.triggers.length>0&&(this.triggers.length=0)}},{key:"currentStep",get:function(){return this.track.sequencerEngine.trackStep%this.track.length}},{key:"output",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentStep,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.currentStep;try{if(this.currentTime=e,this.actualStepNumber=r,e||this.triggers.forEach(function(e){return e.stepNumber=r}),void 0===this.myScript)return this.triggers;var a=this.script(this.triggers,n,e,this);return this.graphics=[],a.forEach(function(e){var n=e.stepData,r=e.graphics;n&&(t._subSequence||(n.track=t.track)),r&&t.graphics.push(r)}),a}catch(i){return console.log("error w script=",i),[]}}},{key:"script",get:function(){return this.myScript}},{key:"isRealTime",value:function(){return!1}}]),n}(function(e){Object(i.a)(n,e);var t=h(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).tidals=[],e}return Object(a.a)(n,[{key:"useTidal",value:function(){var e=this.tidals.find(function(e){return!e.inUse});return e?(e.inUse=!0,e):((e=new f.a(this.track,this)).inUse=!0,this.tidals=[].concat(Object(l.a)(this.tidals),[e]),e)}},{key:"freeTidals",value:function(){this.tidals.forEach(function(e){e.inUse?e.lastUsed=0:e.lastUsed=(e.lastUsed||0)+1,e.inUse=!1})}},{key:"getTidalsInUse",value:function(){return this.tidals.filter(function(e){return e.inUse})}}]),n}(Object(u.a)(c.a)));t.a=d},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"b",function(){return s});var r=0,a=1,i=2,o=3,s={3:[". -","- ."],4:[". . -",". - .","- . .","- -"],5:[". . . -",". . - .","- - .",". - -"]}},,,,,,,function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return i});var r="MAP",a="DELETE",i="OFF"},function(e,t,n){"use strict";n.d(t,"i",function(){return r}),n.d(t,"f",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"k",function(){return u}),n.d(t,"h",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"j",function(){return h}),n.d(t,"g",function(){return p}),n.d(t,"t",function(){return d}),n.d(t,"q",function(){return m}),n.d(t,"n",function(){return v}),n.d(t,"p",function(){return b}),n.d(t,"l",function(){return g}),n.d(t,"m",function(){return y}),n.d(t,"v",function(){return k}),n.d(t,"s",function(){return O}),n.d(t,"o",function(){return j}),n.d(t,"u",function(){return w}),n.d(t,"r",function(){return E});var r=1,a=2,i=3,o=4,s=7,c=8,u=9,l=10,f=11,h=12,p=13,d=function(e){return{type:r,zobject:e}},m=function(e){return{type:a,zmessage:e}},v=function(e,t){return{type:i,inlet:e,isInstanceInlet:t}},b=function(e){return{type:o,outlet:e}},g=function(e,t,n,r){return{type:s,sourceType:n,destType:r,destNode:t,sourceNode:e}},y=function(e,t,n,r){return{type:c,sourceType:n,destType:r,destNode:t,sourceNode:e}},k=function(e,t){return{type:u,zobject:e,text:t}},O=function(e,t){return{type:l,zmessage:e,text:t}},j=function(e){return{type:f,inletNumber:e}},w=function(e){return{type:h,zobject:e}},E=function(e){return{type:p,zmessage:e}}},,function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"f",function(){return s}),n.d(t,"b",function(){return c});var r="TAG",a="STYLE",i="YEAR",o="COUNTRY",s="YOUTUBE",c="DISCOGS"},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(61),s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(a.a)(this,e),this.track=t,this.isTriplet=n,this.steps={}}return Object(i.a)(e,[{key:"getAllOnSteps",value:function(e){var t=[];if(void 0!==e&&this.steps[e])return this.steps[e].getPolyphony().filter(function(e){return e.on});for(var n in this.steps)t=t.concat(this.steps[n].getPolyphony().filter(function(e){return e.on}));return t}},{key:"getAllOnStepsBefore",value:function(e){var t=[];for(var n in this.steps)parseFloat(n)<e&&(t=[].concat(Object(r.a)(t),Object(r.a)(this.steps[n].getPolyphony().filter(function(e){return e.on}))));return t}},{key:"getAnyOnStep",value:function(){for(var e in this.steps)if(this.steps[e].on)return this.steps[e]}},{key:"getStep",value:function(e){return void 0===this.steps[e]?void 0:this.steps[e]}},{key:"setStep",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.track=this.track,this.isTriplet||(t.position=parseFloat(e)),n&&void 0!==this.steps[e]&&this.steps[e].on&&this.steps[e].getPolyphony().length>=1?this.steps[e].addStep(t):this.steps[e]=t}},{key:"setStepAtPosition",value:function(e,t){e.track=this.track,this.isTriplet||(e.position=parseFloat(t)),this.steps[t]=e}},{key:"clear",value:function(){this.steps={}}},{key:"getCopy",value:function(){var t=new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.track);t.isTriplet=t.isTriplet;var n=[];for(var r in this.steps)this.steps[r].on&&n.push({key:r,stepData:this.steps[r].getCopy(!1,!1,!0,!0,!1,!0)});for(var a in n)t.setStep(n[a].key,n[a].stepData);return t}},{key:"getJson",value:function(){var e={};for(var t in this.steps)e[t]=this.steps[t].getJson();return e}},{key:"fromJson",value:function(e){for(var t in e){var n=this.steps[t]||new o.a;n.track=this.track,n.simpleLoad(e[t],this.effects,this.track,this.track.midiEffects.effects),this.steps[t]=n}}},{key:"anyOn",value:function(){for(var e in this.steps)if(this.steps[e].getPolyphony().some(function(e){return e.on}))return!0;return!1}},{key:"anyEffectAutomation",value:function(){for(var e in this.steps)if(this.steps[e].getPolyphony().some(function(e){return!e.effectAutomations.isEmpty()}))return!0;return!1}},{key:"anyOnAfter",value:function(e,t,n){for(var r in e=parseFloat(e),this.steps){if(parseFloat(r)+1e-5>=e&&this.steps[r].getPolyphony().some(function(e){return e.on&&(void 0===t||n&&null==e.transpose||e.transpose===t)}))return!0}return!1}},{key:"clearAfterIfOn",value:function(e,t,n){var r=!1;for(var a in this.steps)a>=e&&this.steps[a].getPolyphony().some(function(e){return e.on&&(void 0==t||n&&null==e.transpose||e.transpose==t)})&&(void 0!==t?this.steps[a].deleteTranspose(t,n):this.steps[a]=new o.a,r=!0);return r}},{key:"clearBeforeIfOn",value:function(e,t,n){var r=!1;for(var a in this.steps)a<e&&this.getStep(a).getPolyphony().some(function(e){return e.on&&(void 0===t||n&&null==e.transpose||e.transpose==t)})&&(void 0!==t?this.steps[a].deleteTranspose(t,n):this.steps[a]=new o.a,r=!0);return r}}]),e}();t.a=s},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"f",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"h",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return l});var r="AMP",a="OP_A",i="OP_B1",o="OP_B2",s="PITCH",c="FILTER",u="FILTER_2",l="MODULATION"},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(43),o=n(396),s=n(433),c=function(){function e(t,n){Object(r.a)(this,e),this.mix=t,this.type=n}return Object(a.a)(e,[{key:"mixByType",get:function(){var e=Object(i.s)(this.type)?this.mix.deterministicMixesByType:this.mix.mixesByType;return this.type in e||(Object(i.s)(this.type)?e[this.type]=new o.a(this.type):e[this.type]=new s.a(this.type)),e[this.type]}},{key:"events",get:function(){return this.mixByType.events},set:function(e){this.mixByType.events=e}},{key:"execute",value:function(){}},{key:"getDuration",value:function(e){for(var t=0;t<this.events.length;t++){var n=this.events[t];if(void 0===e)return n.step-e.step}return 0}},{key:"calculateDurations",value:function(){for(var e=[],t=void 0,n=0;n<this.events.length;n++){var r=this.events[n];void 0!==t&&r.isEquivalent(t)||e.push(r),t=r}this.events=e,t=void 0;for(var a=0;a<this.events.length;a++){var i=this.events[a];void 0!==t&&(t.duration=i.step-t.step),t=i}}}]),e}();t.a=c},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="a-rate"},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(41),l=n(15),f=n.n(l);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var p=function(e){Object(o.a)(n,e);var t=h(n);function n(e,a){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1;return Object(r.a)(this,n),i=t.call(this,e,new f.a.Signal(0),o,s),a&&i.setAudioParams(a),i}return Object(a.a)(n,[{key:"set",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.04,s=Object(i.a)(Object(c.a)(n.prototype),"set",this).call(this,e,t,r,a,o);return!this._audioParams||!this.keyScaling&&t||this._audioParams.filter(function(e){return e.input}).forEach(function(e){return e.value=0}),s}},{key:"disableKeyScaling",value:function(){this.set(this.get(!0),!0,!0),this.keyScaling=void 0,this._audioParams.filter(function(e){return e.input}).forEach(function(e){return e.value=0})}},{key:"setAudioParams",value:function(e){var t=this;(e=e.filter(function(e){return e})).filter(function(e){return!t._audioParams||!t._audioParams.includes(e)}).forEach(function(e){return t.audioParam.connect(e)}),this._audioParams=e}},{key:"removeAudioParams",value:function(e){var t=this;e.forEach(function(e){return t.removeAudioParam(e)})}},{key:"removeAudioParam",value:function(e){e&&this._audioParams.includes(e)?(this._audioParams=this._audioParams.filter(function(t){return t!==e}),e.input&&this.audioParam&&(this.audioParam.disconnect(e),e.value=0)):console.log("Failed to remove audio param for %s",this.name,e,this._audioParams)}}]),n}(u.c);window.findBadPoly=function(){return window.sequencerEngine.tracks[0].getAllParameters().filter(function(e){return!e.name.includes("Formant")}).filter(function(e){return e._audioParams}).filter(function(e){return e._audioParams.some(function(e){return!e.input||0!==e.value})}).map(function(e){return[e.name,e._audioParams.map(function(e){return e.input&&e.value})]})},t.a=p},function(e,t,n){"use strict";n.d(t,"i",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"f",function(){return s}),n.d(t,"h",function(){return c}),n.d(t,"k",function(){return u}),n.d(t,"m",function(){return l}),n.d(t,"c",function(){return f}),n.d(t,"e",function(){return h}),n.d(t,"j",function(){return p}),n.d(t,"o",function(){return d}),n.d(t,"l",function(){return m}),n.d(t,"d",function(){return v}),n.d(t,"n",function(){return b});var r=2,a=3,i=4,o=5,s=6,c=7,u=8,l=9,f=10,h=11,p=12,d=13,m=14,v=15,b=16},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"f",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c});var r="SEQUENCE_USED_SOUND",a="PRESET_RATED",i="SAMPLE_RATED",o="SEQUENCE_BPM",s="PACK_TYPE",c="PRESET_RESAMPLED"},function(e,t,n){"use strict";var r=n(0),a=n.n(r);t.a=function(e){return a.a.createElement("div",Object.assign({className:"menu-item"},e),e.children)}},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(85),f=n(21),h=n(23),p=n(32);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var m=function(e){return function(e){Object(s.a)(n,e);var t=d(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"initValueParameter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:13,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.valueParameter=new f.b("value",this,function(){return 0},{min:e,max:t,defaultValue:n}),this.registerParameter(this.valueParameter)}},{key:"value",get:function(){return this.valueParameter.get()},set:function(e){this.valueParameter.set(e,!1,!1)}},{key:"fromValueJson",value:function(e){var t={};return Object(p.a)(this.valueParameter,e.value,t),Object(r.a)({},t,Object(h.a)(e,"valueParameter",this.valueParameter))}},{key:"getValueJson",value:function(){var e={value:this.value};return e=Object(h.b)(e,"valueParameter",this.valueParameter)}}]),n}(e)};function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}n.d(t,"a",function(){return y}),n.d(t,"d",function(){return k}),n.d(t,"e",function(){return O}),n.d(t,"b",function(){return j}),n.d(t,"f",function(){return w}),n.d(t,"g",function(){return E}),n.d(t,"c",function(){return S});var y=1,k=2,O=3,j=function(e){Object(s.a)(n,e);var t=g(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this,"Chord Type",e,1)).numeral=r,i.nextChords={},i}return Object(i.a)(n,[{key:"onNewStep",value:function(){this.active=!1,Object(o.a)(Object(u.a)(n.prototype),"onNewStep",this).call(this)}},{key:"output",value:function(){return this.active=this.triggers.length>0,this.triggers||[]}},{key:"getChordEffectType",value:function(){return y}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{numeral:this.numeral})}},{key:"fromJson",value:function(e){Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.numeral=e.numeral}},{key:"prettyName",get:function(){switch(this.numeral){case 1:return"I";case 2:return"II";case 3:return"III";case 4:return"IV";case 5:return"V";case 6:return"VI";case 7:return"VII";default:return"All Chords"}}}]),n}(l.a),w=function(e){Object(s.a)(n,e);var t=g(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this,"Voice",e,2)).initValueParameter(0,13,r),i}return Object(i.a)(n,[{key:"degree",get:function(){return this.value},set:function(e){return this.value=e}},{key:"getText",value:function(){return""}},{key:"onNewStep",value:function(){this.active=!1,Object(o.a)(Object(u.a)(n.prototype),"onNewStep",this).call(this)}},{key:"output",value:function(){var e=this.triggers||[];this.active=e.length>0;var t,n=v(e);try{for(n.s();!(t=n.n()).done;){var r,a=t.value,i=v(a.stepData.voices);try{for(i.s();!(r=i.n()).done;){var o=r.value;void 0===o.voice&&(o.voice=this.degree)}}catch(s){i.e(s)}finally{i.f()}a.stepData.voices.push({voice:this.degree})}}catch(s){n.e(s)}finally{n.f()}return e}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),Object(o.a)(Object(u.a)(n.prototype),"getValueJson",this).call(this))}},{key:"fromJson",value:function(e){Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),e.value=e.degree,this.fromValueJson(e)}},{key:"getChordEffectType",value:function(){return k}},{key:"prettyName",get:function(){switch(this.degree){case 1:return"1st";case 2:return"2nd";case 3:return"3rd";default:return this.degree+"th"}}}]),n}(m(l.a)),E=function(e){Object(s.a)(n,e);var t=g(n);function n(e,r,i,o,s){var c;return Object(a.a)(this,n),(c=t.call(this,e,r,1)).initValueParameter(i,o,s),c}return Object(i.a)(n,[{key:"onNewStep",value:function(){this.active=!1,Object(o.a)(Object(u.a)(n.prototype),"onNewStep",this).call(this)}},{key:"getText",value:function(){return void 0!==this.value?this.value:""}},{key:"transform",value:function(e){return e}},{key:"getChordEffectType",value:function(){return O}},{key:"fromJson",value:function(e){Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.fromValueJson(e)}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),Object(o.a)(Object(u.a)(n.prototype),"getValueJson",this).call(this))}}]),n}(m(l.a)),S=function(e){Object(s.a)(n,e);var t=g(n);function n(e){return Object(a.a)(this,n),t.call(this,"Octave",e,-4,4,-1)}return Object(i.a)(n,[{key:"output",value:function(){var e=this,t=this.triggers||[];this.active=t.length>0;var n,r=v(t);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=a.stepData.voices.filter(function(e){return void 0===e.octave});if(i.length>0)i.forEach(function(t){return t.octave=e.value});else{var o=a.stepData.voices[0]||{voice:1};o.octave=this.value,a.stepData.voices.push(o)}}}catch(s){r.e(s)}finally{r.f()}return t}},{key:"transform",value:function(e){return e+12*this.value}}]),n}(E)},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});var r="PUBLIC",a="PRIVATE",i="GUILD"},,,,,,,function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(124),s=n(76),c=n(6),u=n(880),l=n(12);t.a=Object(l.b)(function(e,t){return t.parameter?{value:t.parameter.get(),isMidiSelected:t.parameter.id===e.midi.parameterSelected,midiMapMode:e.midi.midiMapMode,isMacroMapping:e.effects.isMacroMapping}:{value:0}},function(e){return{setParameterToMap:function(t){return e(Object(c.Td)(t))},setParameterSliderDown:function(t){return e(Object(c.Sd)(t))},setParameterMidiMapSelection:function(t){return e(Object(c.Od)(t))}}})(function(e){var t=e.unit,n=e.size,c=void 0===n?30:n,l=e.name,f=e.parameter,h=e.setParameterSliderDown,p=e.value,d=e.color,m=e.min,v=void 0===m?f.min:m,b=e.max,g=void 0===b?f.max:b,y=e.step,k=e.scrollContainer,O=e.isMidiSelected,j=e.midiMapMode,w=e.setParameterMidiMapSelection,E=e.setParameterToMap,S=e.isMacroMapping,P=Object(a.useState)(!1),x=Object(r.a)(P,2),T=x[0],C=x[1],N=v>=0;p<v&&(p=v);var R=Object(a.useCallback)(function(e){if(T){document.activeElement.blur();var t=N?Math.pow(e,2):e;t===v&&(t=f.min),f.set(t,!1),j===o.b&&w(f.id)}else C(!0)},[f,N,T,C,j]),M=N?Math.sqrt(p):p,A=i.a.createElement(u.b,{scrollContainer:k,size:c,angleOffset:220,angleRange:280,value:M,initialValue:M,step:y||1,min:N?Math.sqrt(v):v,max:N?Math.sqrt(g):g,onChange:R},i.a.createElement(u.a,{arcWidth:2,color:d||"white",background:"#6c757a"}),i.a.createElement(u.c,{width:2,height:c/3,radius:4,type:"rect",color:d||"white"})),q=Object(a.useCallback)(function(e){S&&(f.isMapped||E(f)),e.stopPropagation(),h(f)},[S,f]),D=Object(a.useCallback)(function(){h(void 0),f.automation.smoothen(),f.mixAutomation.smoothen()},[f]),I="parameter-knob";return O&&j===o.b&&(I+=" midi-selected"),S&&(I+=" plane-mapping"),l?i.a.createElement(s.a,{element:f,onMouseDown:q,onMouseUp:D,onContextMenu:function(e){e.stopPropagation(),e.preventDefault()},className:I},l,A,Math.round(100*p)/100," ",t):i.a.createElement(s.a,{onContextMenu:function(e){e.stopPropagation(),e.preventDefault()},onMouseDown:q,onMouseUp:D,className:I},A)})},,,function(e,t,n){"use strict";n.d(t,"b",function(){return A}),n.d(t,"a",function(){return q});var r=n(56),a=n(647),i=(n(1040),n(807)),o=n(892),s=n(808),c=(n(722),n(1041),n(989),n(616)),u=n(809),l=n(810),f=n(639),h=n(436),p=n(232),d=n(292),m=n(617),v=n(618),b=n(437),g=n(619),y=n(620),k=n(621),O=(n(723),n(724),n(725),n(293)),j=n(57),w=n(530),E=n(811),S=n(529),P=n(812),x=n(813),T=n(814),C=n(815),N=n(816),R=n(817),M=n(818),A={Filter:function(e){return new r.a.FilterEffect(e)},"Wave Folder":function(e){return new T.a(e)},Delay:function(e){return new p.a(e)},Reverb:function(e){return new r.a.ReverbEffect(e)},"Convolver Reverb":function(e){return new d.a(e)},Chorus:function(e){return new r.a.ChorusEffect(e)},"Multiband Compressor":function(e){return new f.a(e)},Distortion:function(e){return new g.a(e)},Compressor:function(e){return new b.a(e)},"Bit Crusher":function(e){return new v.a(e)},"Ultra Phaser":function(e){return new h.a(e)},"Pitch Shift":function(e){return new y.a(e)},Panner:function(e){return new k.a(e)},Gain:function(e){return new a.a(e)},EQ8:function(e){return new O.a(e)},Chebyshev:function(e){return new m.a(e)},"Stereo Widener":function(e){return new c.a(e)},"Tape Delay":function(e){return new E.a(e)},Saturator:function(e){return new w.a(e)},"Stereo Delay":function(e){return new P.a(e)},Oscilloscope:function(e){return new l.a(e)},"Effect Rack":function(e){return new S.a(e)},"Multi Filter":function(e){return new s.a(e)},"Freak Shifter":function(e){return new o.a(e)},"Guitar Amp":function(e){return new x.a(e)},"Ring Modulator":function(e){return new u.a(e)},Vocoder:function(e){return new C.a(e)},Follower:function(e){return new N.a(e)},"Frequency Shifter":function(e){return new R.a(e)},"Transient Shaper":function(e){return new M.a(e)},"Soft Clipper":function(e){return new i.a(e)}};function q(e,t,n,r,i){if(!e)return{effect:new a.a(n),bulk:{}};var o=e.name,s=A[o](n);if("Gain"===o&&console.log("Gain was =",s),void 0!==r){var c=(new j.a).forTrack(t[r]);s.registerContext(c)}else i&&s.registerContext(i);var u=s.fromJson(e,t,r);return{effect:s,bulk:u}}},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n(9),a=n(236),i=function(e,t,n){return e(t,n[4],n[5],n[3])},o=function(){0;var e=0,t=Object(a.a)("planarReset");return function(n,a,i,o){t().some(function(e){return e===i.id})&&(e=0),e++;var s=Object.keys(o[0]),c=Math.round(a*s.length),u=e*c%s.length,l=s.slice(u,u+c);l.length<c&&(c-l.length,l=[].concat(Object(r.a)(l),Object(r.a)(s.slice(0,c-l.length))));var f={};return l.forEach(function(e){n[e]&&(f[e]=n[e])}),f}}},function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"l",function(){return u}),n.d(t,"o",function(){return l}),n.d(t,"g",function(){return f}),n.d(t,"i",function(){return h}),n.d(t,"j",function(){return p}),n.d(t,"d",function(){return d}),n.d(t,"c",function(){return m}),n.d(t,"f",function(){return v}),n.d(t,"e",function(){return b}),n.d(t,"k",function(){return g}),n.d(t,"m",function(){return y}),n.d(t,"h",function(){return k}),n.d(t,"n",function(){return O}),n.d(t,"a",function(){return j});var r=n(9),a=n(17),i=n(45);function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=a.A.apply(void 0,[e].concat(r)),s=a.A.apply(void 0,[t].concat(r));return o.push(s),Object(a.w)(!0)}},u=function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var s=a.A.apply(void 0,[e].concat(i));if(s){var c=a.A.apply(void 0,[t].concat(i)),u=void 0;return n&&(u=a.A.apply(void 0,[n].concat(i))),s.slice(c,Math.max(1,u%(s.length+1)))}return 0}},l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=t;return 1===t.length&&(i=Array.isArray(t[0])?t[0]:a.A.apply(void 0,[t[0]].concat(n))),i.reduce(function(e,t){return a.A.apply(void 0,[t].concat(n)).map(function(t,n){return t+e[n%e.length]})},[0])}},f=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=a.A.apply(void 0,[e].concat(n));return i?i.length:0}},h=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=a.A.apply(void 0,[e].concat(r)),s=t;return o.map(s)}},p=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(!r[0])return t[0];var o=a.A.apply(void 0,[t].concat(r));return o[a.A.apply(void 0,[e].concat(r))%o.length]}},d=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=a.A.apply(void 0,[e].concat(n));return i?i.slice(1):[]}},m=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=a.A.apply(void 0,[e].concat(n));if(i)return i[0]}},v=function(e){var t=void 0,n=void 0;return function(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];var l=a.A.apply(void 0,[e].concat(c));if(l===n)return t;var f,h=[],p=o(l);try{for(p.s();!(f=p.n()).done;){var d=f.value;d=a.A.apply(void 0,[d].concat(c)),Array.isArray(d)?h=[].concat(Object(r.a)(h),Object(r.a)(d)):d&&(d.id&&(d.id=Object(i.uuid)()),h=[].concat(Object(r.a)(h),[d]))}}catch(m){p.e(m)}finally{p.f()}return t=h,n=l,h}},b=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=void 0,c=void 0;return function(){var e=[];if(s===t)return c;s=t;for(var n=arguments.length,u=new Array(n),l=0;l<n;l++)u[l]=arguments[l];var f,h=o(t);try{for(h.s();!(f=h.n()).done;){var p=f.value;p=a.A.apply(void 0,[p].concat(u)),Array.isArray(p)?e=[].concat(Object(r.a)(e),Object(r.a)(p)):(p.id&&(p.id=Object(i.uuid)()),e=[].concat(Object(r.a)(e),[p]))}}catch(d){h.e(d)}finally{h.f()}return c=e}},g=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=void 0,c=void 0;return function(){for(var e=arguments.length,n=new Array(e),u=0;u<e;u++)n[u]=arguments[u];var l=t.map(function(e){return a.A.apply(void 0,[e].concat(n))});if(s&&s.every(function(e,t){return e===l[t]}))return c;s=l;var f,h=[],p=o(l);try{for(p.s();!(f=p.n()).done;){var d=f.value;Array.isArray(d)?h=[].concat(Object(r.a)(h),Object(r.a)(d)):d&&(d.id&&(d.id=Object(i.uuid)()),h=[].concat(Object(r.a)(h),[d]))}}catch(m){p.e(m)}finally{p.f()}return c=h}},y=function(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=a.A.apply(void 0,[e].concat(n));return(o=Object(r.a)(o[0])).reverse(),[o]}},k=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=[],n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];var u,l=o(t);try{for(l.s();!(u=l.n()).done;){var f=u.value;(f=a.A.apply(void 0,[f].concat(s))).id&&(f.id=Object(i.uuid)()),e=[].concat(Object(r.a)(e),[f])}}catch(h){l.e(h)}finally{l.f()}return e}},O=function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var s=a.A.apply(void 0,[e].concat(i));if(s){var c=a.A.apply(void 0,[t].concat(i)),u=void 0;return n&&(u=a.A.apply(void 0,[n].concat(i))),[s[0].slice(c,Math.max(1,u%(s[0].length+1)))]}return 0}},j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];for(var s=a.A.apply(void 0,[e].concat(i)),c=(a.A.apply(void 0,[t].concat(i)),a.A.apply(void 0,[n].concat(i))),u=[s[0]],l=1;l<s.length;l++)l%t===c&&u.push(s[l]);return u}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"f",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c});Math.sqrt;var r=function(e){if(0===e.length)return{x:0,y:0,diameter:1};var t=new Uint32Array(e.map(function(e){var t=e.x;e.y;return isNaN(t)?0:t})),n=new Uint32Array(e.map(function(e){e.x;var t=e.y;return isNaN(t)?0:t})),r=window.api.create_geometry_buffer(e.length),a=window.api.create_geometry_buffer(e.length),i=window.api.create_geometry_buffer(3);window.Module.HEAP32.set(t,r/t.BYTES_PER_ELEMENT),window.Module.HEAP32.set(n,a/n.BYTES_PER_ELEMENT),window.api.getGeometry(r,a,e.length,i);var o=new Uint32Array(window.Module.HEAP32.buffer,i,3),s=o[0],c=o[1],u=o[2];return window.api.destroy_buffer(i),window.api.destroy_buffer(r),window.api.destroy_buffer(a),{x:s,y:c,diameter:u}},a=function(e){if(0===e.length)return{x:0,y:0,diameter:1};var t=e;if(e.some(function(e){return isNaN(e)}))return{x:0,y:0,diameter:1};var n=window.api.create_geometry_buffer(e.length),r=window.api.create_geometry_buffer(3);window.Module.HEAPF32.set(t,n/t.BYTES_PER_ELEMENT),window.api.getGeometryFlat(n,e.length,r);var a=new Uint32Array(window.Module.HEAP32.buffer,r,3),i=a[0],o=a[1],s=a[2];return window.api.destroy_buffer(r),window.api.destroy_buffer(n),{x:i,y:o,diameter:s}},i=function(e){return r(e)},o=function(e){return r(e).diameter},s=function(){return function(e){var t=Object.keys(e).map(function(t){return e[t]}).filter(function(e){return e});return 0===t.length?0:o(t)}},c=function(){return function(e){var t=Object.keys(e).map(function(t){return e[t]}).filter(function(e){return e});return 0===t.length?0:i(t)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"f",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"g",function(){return u});var r="OPERATORS_MIXER",a="LFO",i="FM_PARAMETERS",o="PLANAR_SHAPSHOTS",s="JAKI_PARAMS",c="JAKI_FIGURES",u={JAKI_PARAMS:"jakiParamsComponent",PLANAR_SNAPSHOTS:"snapshotComponent",JAKI_FIGURES:"figuresComponent"}},,,,,,,function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;return Math.random()<e}function a(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;if(void 0!==n&&r(i)){var o=t+"Parameter";o in n?(a.disconnectFromAllModulators(),a.fromJson(n[o],e),a.set(n[t])):t in n&&a.set(n[t])}}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a})},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o});var r=1,a=2,i=3,o=4},,function(e,t,n){"use strict";var r=n(2),a=n(4),i=(n(15),0),o=function(){function e(){Object(r.a)(this,e),this.canceled=!1,this.id=i++}return Object(a.a)(e,[{key:"setValue",value:function(e){}},{key:"value",get:function(){return this.getValue()},set:function(e){this.setValue(e)}},{key:"cancel",value:function(){this.canceled=!0}},{key:"isDeterministic",value:function(){return!1}},{key:"isSkippable",value:function(){return!0}},{key:"isPrunable",value:function(){return!1}},{key:"setTime",value:function(e,t){this.step=t,this.time=e}},{key:"scheduleEvent",value:function(e,t,n){var r=this;e+=this.time,setTimeout(function(){if(!r.canceled)try{r.executeEvent(t,n)}catch(e){console.log("got an error executing event = "),console.log(r),console.log(e)}},e-0)}},{key:"getValue",value:function(){}},{key:"executeEvent",value:function(e){}},{key:"getType",value:function(){}},{key:"getJson",value:function(){return{type:this.getType(),time:this.time,step:this.step}}},{key:"fromJson",value:function(e){return this.time=e.time,this.step=e.step,this}},{key:"isEquivalent",value:function(){return!1}},{key:"restart",value:function(){}},{key:"getCopy",value:function(){}},{key:"loadSubSequence",value:function(e,t){void 0!==e.subSequence?this.subSequence=t.getSubSequence(e.subSequence):this.subSequence=t.currentSubSequence}}]),e}();t.a=o},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){var t,n=0;if(!e||0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n}},function(e,t,n){"use strict";var r=n(28),a=n(11),i=n(0),o=n.n(i),s=n(6),c=n(12),u=40,l=250;function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;return(e-t)/(n-t)}(e,t,n,r);return r*Math.pow(i,1/a)+4}t.a=Object(c.b)(function(e,t){return{value:t.parameter.get(),isMacroMapping:e.effects.isMacroMapping}},function(e){return{setParameterToMap:function(t){return e(Object(s.Td)(t))}}})(function(e){var t,n=e.needsRound,s=e.setParameterToMap,c=e.isMacroMapping,h=e.isDraggable,p=void 0===h||h,d=(e.track,e.color),m=e.name,v=e.label,b=(e.rackTrack,e.value),g=e.parameter,y=(e.id,e.min),k=void 0===y?g.min:y,O=e.max,j=void 0===O?g.max:O,w=e.width,E=void 0===w?u:w,S=e.units,P=void 0===S?"":S,x=e.display,T=e.root,C=void 0===T?2:T,N=e.stopPropagation,R=void 0===N||N,M=Object(i.useState)(!1),A=Object(a.a)(M,2),q=A[0],D=A[1],I=Object(i.useState)(!1),_=Object(a.a)(I,2),F=_[0],L=_[1],B=Object(i.useRef)(void 0),z=Object(i.useState)(""),V=Object(a.a)(z,2),H=V[0],U=V[1],J=Object(i.useRef)(0),G=Object(i.useRef)(void 0),W={width:f(b,k,j,E,C),backgroundColor:d},K=Object(i.useCallback)(function(e){if("Enter"===e.key){var t=parseFloat(H);if(isNaN(t))return;g.set(t,!0),L(!1)}},[L,H,g]);Object(i.useEffect)(function(){F&&(U(Math.round(100*g.get(!0))/100),G.current&&(G.current.focus(),G.current.select()))},[F,U,g]);var X=function(){return g.id},Q=Object(i.useCallback)(function(e){e.stopPropagation();var t=(new Date).getTime();t-J.current<l?L(!0):(J.current=t,!R&&p||e.stopPropagation(),D(!0))},[c,p,g,D]);Object(i.useEffect)(function(){return window.addEventListener("mousemove",$),window.addEventListener("mouseup",Z),function(){window.removeEventListener("mousemove",$),window.removeEventListener("mouseup",Z)}},[g,D,q]);var Y,Z=Object(i.useCallback)(function(){D(!1)},[D]),$=Object(i.useCallback)(function(e){if(R&&e.stopPropagation(),q){var t=function(e,t,n,r,a,i,o){var s=o.current.getBoundingClientRect(),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=(e=Math.min(Math.max(0,e),r))/r,o=Math.pow(i,a);return t+(n-t)*o}(e.clientX-s.left,n,r,a,i);return isNaN(c)?-100:c}(e,X(),k,j,E,C,B);1===C&&(t=Math.round(t)),n&&(t=Math.round(t)),g.get()!==t&&g.set(t,!1)}},[g,q]),ee=Object(i.useCallback)(function(e){e.stopPropagation(),c&&(g.isMapped||s(g))},[c]);return F?o.a.createElement("div",{className:"p-box"},o.a.createElement("div",{className:"p-name"},m),o.a.createElement("input",{ref:G,className:"volume-box",onChange:function(e){return U(e.target.value)},onKeyDown:K,value:H})):o.a.createElement("div",{className:"p-box "},c&&o.a.createElement("div",{onClick:ee,className:"macro-overlay"}),o.a.createElement("div",{className:"p-name"},m),o.a.createElement("div",(t={draggable:!0,onClick:ee,onDragStart:function(e){return e.preventDefault()},style:{width:E+6},id:X()},Object(r.a)(t,"onClick",function(e){return e.stopPropagation()}),Object(r.a)(t,"onMouseUp",function(e){e.stopPropagation(),D(!1)}),Object(r.a)(t,"onMouseLeave",function(e){e.stopPropagation()}),Object(r.a)(t,"onMouseDown",Q),Object(r.a)(t,"className","volume-box"),t),o.a.createElement("div",{style:W,ref:B,className:"volume-indicator"}),o.a.createElement("span",{className:"volume-value"},v?v+": ":""," ",x?x(b):(Y=b,Math.round(100*Y)/100)," ",P)))})},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i});var r="MASTER",a="SLAVE",i="NONE"},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return o});var r="OFF",a="PREPARING",i="RECORDING",o="STOPPING"},,,function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"f",function(){return c}),n.d(t,"e",function(){return u}),n.d(t,"c",function(){return l});var r=n(17),a=n(72);Object(a.a)("alt",{arg1:"",arg2:"",argN:""},"Alternates between the arguments with every trigger received by this function");var i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=0;return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var o=n[0];n[1],n[2];if(void 0===o)return Object(r.w)(!1);var s=t;if(1===t.length){var c=r.A.apply(void 0,[t[0]].concat(n));Array.isArray(c)&&(s=c)}var u=a++%s.length;return r.A.apply(void 0,[Object(r.J)(s[u])].concat(n))}},o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=0,i=void 0,o=void 0;return function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];var c=n[0],u=n[1];n[2];if(o===u)return i;if(o=u,void 0===c)return void 0===i?t[0]:i;var l=t;if(1===t.length){var f=r.A.apply(void 0,[t[0]].concat(n));Array.isArray(f)&&(l=f)}var h=a++%l.length;return i=r.A.apply(void 0,[Object(r.J)(l[h])].concat(n))}};Object(a.a)("altn",{n:"How many triggers it takes to increment the output conditional",arg1:"Output conditional",arg2:"Output conditional",argN:"Output conditional (will loop back to arg1 after this this)"},"Alternates between the arguments every n-many triggers received by this function");var s=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i=0,o=0;return function(t,a,s,c){var u="number"===typeof e?e:e();if(++i%u===0&&o++,void 0===t)return Object(r.w)(!1);var l=n[o%n.length];return Object(r.A)(l,t,a,s,c)}},c=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i=0,o=0;return function(t,a,s,c){var u="number"===typeof e?e:e();++i%u===0&&o++;var l=n[o%n.length];return Object(r.A)(l,t,a,s,c)}},u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=0;return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n[0],n[1],n[2];if(1===t.length){var o=r.A.apply(void 0,[t[0]].concat(n));Array.isArray(o)&&(t=o)}var s=a++%t.length;return r.A.apply(void 0,[Object(r.J)(t[s])].concat(n))}};Object(a.a)("every",{n:"",action:""},"Trigger a given action every n-many triggers");var l=function(e,t,n){var a=0;return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var c=r.A.apply(void 0,[e].concat(o));if(o[0]&&++a%c===0)return r.A.apply(void 0,[t].concat(o));return n?r.A.apply(void 0,[n].concat(o)):Object(r.w)(!0)}}},function(e,t,n){"use strict";n.d(t,"i",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"f",function(){return c}),n.d(t,"h",function(){return u}),n.d(t,"j",function(){return l}),n.d(t,"c",function(){return f}),n.d(t,"b",function(){return h}),n.d(t,"k",function(){return p}),n.d(t,"e",function(){return d});var r=n(6),a=function(e){e.midiEffects.makePlanar()},i=function(e){e.currentPattern;var t=e.getEasyPattern().getAllSteps();e.sequencerEngine.dispatch(Object(r.Fg)(t)),e.sequencerEngine.dispatch(Object(r.Pb)(e.getEasyPattern()))},o=function(e){e.sequencerEngine.dispatch(Object(r.jh)(e))},s=function(e){e.extractStems()},c=function(e){e.effectsChain.convertToRack()},u=function(e){e.midiEffects.convertToRack()},l=function(e){e.sequencerEngine.dispatch(Object(r.fh)(e))},f=function(e){e.deletePatternLocks()},h=function(e){e.deleteAutomations()},p=function(e){e.sequencerEngine.dispatch(Object(r.Nc)(!0)),setTimeout(function(){e.sequencerEngine.transcribeIntoMidi(e).then(function(){e.sequencerEngine.dispatch(Object(r.Nc)(!1))})},200)},d=function(e){e.freezeAllPatterns()}},,,function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"a",function(){return o});var r="NONE",a="SYNCED",i="WAITING",o="DISCONNECTED"},,function(e,t,n){"use strict";n.d(t,"e",function(){return v}),n.d(t,"f",function(){return g}),n.d(t,"k",function(){return y}),n.d(t,"g",function(){return k}),n.d(t,"i",function(){return O}),n.d(t,"j",function(){return j}),n.d(t,"d",function(){return x}),n.d(t,"c",function(){return T}),n.d(t,"a",function(){return C}),n.d(t,"b",function(){return N}),n.d(t,"h",function(){return R});var r=n(8),a=n(9),i=n(45),o=n(186),s=n(101),c=n(57),u=n(21),l=n(103),f=(n(15),n(6));function h(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=0,m={},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(arguments.length>2?arguments[2]:void 0);else{if(e.every(function(e){return e.group}))return;if(e.some(function(e){return e.group})){var n,r=e.find(function(e){return e.group}).group,a=h(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;i.group!==r&&(r.steps.push(i),i.group=r)}}catch(s){a.e(s)}finally{a.f()}return t.sequencerEngine.dispatch(Object(f.q)(r)),r}}var o=b(e);return e.forEach(function(e){return e.group=o}),t.stepGroups.push(o),t.sequencerEngine.dispatch(Object(f.q)(o)),o},b=function(e,t){var n={id:Object(i.uuid)(),name:"Group "+ ++d,steps:e,transformations:[]};return g(n,t),n},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.steps[0].track,n=P("Conditional ",t,0,100),r=P("Action Amount",t,-32,32),a=P("Aux Value",t,0,100,100),o={id:Object(i.uuid)(),whenType:l.k,whenValue:n,thenType:void 0,thenValue:r,probabilityBit:!0,loopCounter:-1,auxValue:a,auxProbabilityBit:!0,midiEffect:void 0};return m[o.id]=o,e.transformations.push(o),o},y=function(e){e.forEach(function(e){return N(e)}),e[0]&&e[0].track&&e[0].track.updateSteps()},k=function(e){var t,n=h(e.transformations);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=r.whenType,i=r.whenValue,o=r.auxValue;if(r.loopCounter++,r.previousProbabilityBit=r.probabilityBit,r.previousAuxBit=r.auxBit,a===l.k){var s=Math.random()<i.get()/100;r.probabilityBit=s}else if(a===l.g||a===l.h){var c=Math.random()<Math.abs(o.get())/100;r.auxProbabilityBit=c}}}catch(u){n.e(u)}finally{n.f()}},O=function e(t){if(!t)return!1;var n=t.whenValue.get();if(t.whenType===l.k)return t.probabilityBit;if(t.whenType===l.c)return t.loopCounter%n===n-1;if(t.whenType===l.g){var r=m[n];return t.auxValue.get()>=0?t.auxProbabilityBit&&e(r):t.auxProbabilityBit&&!e(r)}return!1},j=function(e,t,n,r){if(t.transformations.every(function(e){return!O(e)}))return{step:e,time:n};var i=Object(a.a)(t.transformations);i.sort(function(e,t){return l.j.indexOf(e.thenType)-l.j.indexOf(t.thenType)});var o,c=h(i);try{for(c.s();!(o=c.n()).done;){var u=o.value;if(O(u))if(u.thenType===l.l)e=w(e,t);else if(u.thenType===l.p)e=E(e,u.thenValue.get());else if(u.thenType===l.b)e=S(e,u.thenValue.get());else if(u.thenType===l.n){u.midiEffect.onNewStep(),u.midiEffect.input(new s.a(e,n,r));var f=u.midiEffect.output(n,r,r);return 0===f.length?{time:n,step:e}:{time:f[0].time,step:f[0].stepData}}}}catch(p){c.e(p)}finally{c.f()}return{time:n,step:e}},w=function(e,t){var n=t.steps.indexOf(e),r=Object(a.a)(t.steps);return r.reverse(),r[n]},E=function(e,t){return(e=e.getCopy()).transpose+=t,e},S=function(e,t){return(e=e.getCopy()).duration*=t,e},P=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=new u.a(e,t,function(){return 0},{defaultValue:a,min:n,max:r,doNotDispose:!0});return i.setContext((new c.a).forTrack(t)),i},x=function(e){var t,n=Object(r.a)({},e,{transformations:[],steps:void 0}),a=h(e.transformations);try{for(a.s();!(t=a.n()).done;){var i=t.value,o=Object(r.a)({},i,{copiedFrom:void 0,copiedTo:void 0});o.whenValue=i.whenValue.getJson(),o.thenValue=i.thenValue.getJson(),o.auxValue=i.auxValue.getJson(),i.midiEffect&&(o.midiEffect=i.midiEffect.getJson()),n.transformations.push(o)}}catch(s){a.e(s)}finally{a.f()}return n},T=function(e,t){var n=b([],t);n.name=e.name,n.id=e.id;var r,a=0,i=h(e.transformations);try{for(i.s();!(r=i.n()).done;){var s=r.value;n.transformations[a].id=s.id,n.transformations[a].whenType=s.whenType,n.transformations[a].thenType=s.thenType,n.transformations[a].whenValue.fromJson(s.whenValue),n.transformations[a].thenValue.fromJson(s.thenValue),s.auxValue&&n.transformations[a].auxValue.fromJson(s.auxValue),s.midiEffect&&(n.transformations[a].midiEffect=Object(o.a)(s.midiEffect,t),n.transformations[a].midiEffect.fromJson(s.midiEffect)),m[s.id]=n.transformations[a],a<e.transformations.length-1&&g(n,t),a++}}catch(c){i.e(c)}finally{i.f()}return n},C=function(e,t,n){for(var r=0;r<e.transformations.length;r++){var a=e.transformations[r],i=t.transformations[r];i.whenType=a.whenType,i.thenType=a.thenType,i.whenValue.copyFrom(a.whenValue),i.thenValue.copyFrom(a.thenValue),a.midiEffect&&(i.midiEffect=a.midiEffect.getCopy(n,!0)),a.copiedTo=i,i.copiedFrom=a;var o=a.whenValue.get();if(a.whenType===l.g&&o){var s=m[o];s&&s.copiedTo&&i.whenValue.set(s.copiedTo.id)}r<e.transformations.length-1&&g(t,n)}},N=function(e){e.group&&(e.group.steps=e.group.steps.filter(function(t){return t!==e}),e.group=void 0)},R=function(e){if(e.group){var t=e.group.transformations.find(function(e){return e.thenType===l.e});return!!t&&O(t)}return!1}},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(7),u=n(10),l=n(1),f=n(30),h=n(52),p=n(36),d=n(718);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var v=function(e){Object(c.a)(n,e);var t=m(n);function n(e,r,a,i){var s;return Object(o.a)(this,n),(s=t.call(this)).name=e,s.contentHash=r,s.user=a,s.blockNumber=i,s.tags=[],s}return Object(s.a)(n,[{key:"getJson",value:function(){return{name:this.name,contentHash:this.contentHash,user:this.user,blockNumber:this.blockNumber,hasEdits:this.hasEdits}}},{key:"fromJson",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!e.name&&t||(e.contentHash&&(this.contentHash=e.contentHash),this.user=e.user,this.blockNumber=e.blockNumber,this.hasEdits=e.hasEdits,t&&this.load()),this}},{key:"load",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.contentHash){e.next=4;break}return e.next=3,f.a.presets.getTags(this.contentHash);case 3:this.tags=e.sent;case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getContentType",value:function(){return d.a}},{key:"title",get:function(){return this.name}},{key:"ipfsHash",get:function(){return this.contentHash}},{key:"getName",value:function(){return this.name}},{key:"getId",value:function(){return this.contentHash}},{key:"newTag",value:function(e){this.isCreated()&&(this.tags.push(e),f.a.presets.tagPreset(this.contentHash,[e],0))}},{key:"save",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.track.trackNumber,this.name=t,e.next=4,h.a.getAccount();case 4:return this.user=e.sent,this.hasEdits=!1,e.next=8,p.a.eth.getBlockNumber();case 8:return this.blockNumber=e.sent,e.next=11,this.track.sequencerEngine.saveTrackPreset(n,t,!1,0,this.contentHash);case 11:this.contentHash=e.sent;case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),n}(n(517).a);t.a=v},function(e,t,n){"use strict";n.d(t,"f",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var r=n(149),a=function(e){return"circle"!==e&&"rect"!==e},i=function(e){var t=Object(r.a)(e),n=t[0],i=t.slice(1);return a(n)?i[6]:i[4]},o=function(e){var t=Object(r.a)(e),n=t[0],i=t.slice(1);return a(n)?i[8]||0:i[6]||0},s=function(e){var t=Object(r.a)(e),n=t[0],i=t.slice(1);return a(n)?i[7]||0:i[5]||0},c=function(e){var t=Object(r.a)(e),n=t[0],i=t.slice(1);return a(n)?[i[0],i[1],i[2]]:[i[0],i[1]]},u=function(e){var t=Object(r.a)(e),n=t[0],i=t.slice(1);return a(n)?[i[3],i[4],i[5]]:[i[2],i[3]]}},function(e,t,n){"use strict";function r(e){return e?(e.current&&(e=e.current),.99*e.clientWidth):window.innerWidth-30}n.d(t,"e",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return s});var a=window.innerWidth-30,i=130,o="START",s="END"},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),a=0,i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2?arguments[2]:void 0,i=Object(r.useRef)(0);Object(r.useRef)(a++);return Object(r.useCallback)(function(r){var a=(new Date).getTime(),o=a-i.current;i.current=a,o<=t?e(r):n&&n(r)},[e,n])}},function(e,t,n){"use strict";(function(e){var r=n(2),a=n(4),i=(n(196),n(15)),o=n.n(i),s=n(47),c=(n(30),function(){function t(e,n){Object(r.a)(this,t),this.onSoundUploaded=n,this.numChannels=e,this.soundIdCounter=0}return Object(a.a)(t,[{key:"exportToWAV",value:function(t,n){new FormData;var r=new Worker(window.isNFT?"recorderWorker.js":"/recorderWorker.js");r.postMessage({command:"init",config:{sampleRate:o.a.context.sampleRate,numChannels:this.numChannels}}),r.onmessage=function(t){var r,a=t.data,i=new FileReader;i.onload=function(){r=this.result,n(new e(r))},i.readAsArrayBuffer(a)},r.postMessage({command:"record",buffer:t}),r.postMessage({command:"exportWAV",type:"audio/wav"})}},{key:"uploadBufferToIpfs",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return new Promise(function(i,c){new FormData;var u=t,l=new Worker(window.isNFT?"recorderWorker.js":"/recorderWorker.js");l.postMessage({command:"init",config:{sampleRate:o.a.context.sampleRate,numChannels:t.numChannels}});new Date;if(l.onmessage=function(e){var t=this,o=e.data;s.a.addBlob(o,a).then(function(e){n&&u.onSoundUploaded(t.soundIdCounter++,e,r),i(e)})},n)l.postMessage({command:"record",buffer:e});else{for(var f=[],h=0;h<e.numberOfChannels;h++)f.push(e.getChannelData(h));l.postMessage({command:"record",buffer:f})}l.postMessage({command:"exportWAV",type:"audio/wav"})})}},{key:"uploadVideoBlob",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=(new FormData,this),u=new Worker(window.isNFT?"recorderWorker.js":"/recorderWorker.js");u.postMessage({command:"init",config:{sampleRate:o.a.context.sampleRate,numChannels:this.numChannels}});new Date;u.onmessage=function(e){var t=e.data;s.a.addBlob(t).then(function(e){i?c.onSoundUploaded(void 0,e,a):c.onSoundUploaded(a,e,a)})},u.postMessage({command:"record",buffer:e}),u.postMessage({command:"exportWAV",type:"audio/wav"})}}]),t}());t.a=c}).call(this,n(27).Buffer)},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"e",function(){return c});var r=["01_Saw","02_Triangle","03_Square","04_Noise","05_Pulse","06_Warm_Saw","07_Warm_Triangle","08_Warm_Square","09_Dropped_Saw","10_Dropped_Square","11_TB303_Square","Bass","Bass_Amp360","Bass_Fuzz_2","Bass_Sub_Dub","Bass_Sub_Dub_2","Brass","Brit_Blues","Brit_Blues_Driven","Buzzy_1","Buzzy_2","Celeste","Chorus_Strings","Dissonant_Piano","Dissonant_1","Dissonant_2","Dyna_EP_Bright","Dyna_EP_Med","Ethnic_33","Full_1","Full_2","Guitar_Fuzz","Harsh","Mkl_Hard","Organ_2","Organ_3","Phoneme_ah","Phoneme_bah","Phoneme_ee","Phoneme_o","Phoneme_ooh","Phoneme_pop_ahhhs","Piano","Putney_Wavering","Throaty","Trombone","Twelve_String_Guitar_1","Twelve_OpTines","Wurlitzer","Wurlitzer_2"],a={},i=function(e){return new Promise(function(t,n){e in a?t(a[e]):fetch(window.isNFT?"waveforms/"+e:"/waveforms/"+e,{}).then(function(e){return e.text()}).then(function(n){var r=JSON.parse(n);a[e]=r,t(r)})})},o=function(e){return a[e]},s=function(e){var t=r[Math.round(e)%r.length];return i(t)},c=function(e){var t=r[Math.round(e)%r.length];return o(t)}},,function(e,t,n){"use strict";n.d(t,"b",function(){return Y}),n.d(t,"a",function(){return Z});var r=n(509),a=n(378),i=n(429),o=n(769),s=n(771),c=n(772),u=n(773),l=n(608),f=n(430),h=n(609),p=n(431),d=n(611),m=n(342),v=n(510),b=n(777),g=n(612),y=n(250),k=n(273),O=n(778),j=n(779),w=n(613),E=n(780),S=n(781),P=n(782),x=n(783),T=n(784),C=n(785),N=n(523),R=n(614),M=n(786),A=n(787),q=n(384),D=n(793),I=n(794),_=n(542),F=n(797),L=n(798),B=n(799),z=n(800),V=n(801),H=n(802),U=n(891),J=n(803),G=n(549),W=n(883),K=n(140),X=n(395),Q=n(88),Y={Accumulator:function(e){return new u.a(e)},Arpeggiator:function(e){return new r.a(e)},Beat:function(e){return new M.a(e)},"Control Parameters":function(e){return new D.a(e)},"Conditional Parameters":function(e){return new I.a(e)},"Plane Parameters":function(e){return new _.a(e)},Every:function(e){return new w.a(e)},Limit:function(e){return new j.a(e)},Parameterizer:function(e){return new a.a(e)},Timing:function(e){return new i.a(e)},"Midi Outputter":function(e){return new l.a(e)},"Midi CC":function(e){return new E.a(e)},"Midi Interface":function(e){return new p.a(e)},Harmony:function(e){return new v.a(e)},"Alternate Tuning":function(e){return new g.a(e)},"Micro Tuning":function(e){return new b.a(e)},"Midi Delay":function(e){return new d.a(e)},"Chord Rhythm":function(e){return new f.a(e)},"Chord Sculptor":function(e){return new h.a(e)},Warp:function(e){return new y.a(e)},Tidal:function(e){return new k.a(e)},"Linked Tidal":function(e){return new O.a(e)},"Midi Effect Rack":function(e){return new m.a(e)},"Beat Repeat":function(e){return new x.a(e)},"Pattern Switch":function(e){return new L.a(e)},Steps:function(e){return new S.a(e)},Notes:function(e){return new P.a(e)},Grab:function(e){return new T.a(e)},"Grab Time":function(e){return new C.a(e)},Alternate:function(e){return new N.a(e)},Scale:function(e){return new F.a(e)},Flush:function(e){return new o.a(e)},Message:function(e){return new s.a(e)},"User Script":function(e){return new q.a(e)},Threshold:function(e){return new A.a(e)},Roll:function(e){return new V.a(e)},"Alternate N":function(e){return new R.a(e)},Density:function(e){return new z.a(e)},Poly:function(e){return new B.a(e)},"Note Display":function(e){return new c.a(e)},Sparse:function(e){return new J.a(e)},"Midi Gate":function(e){return new H.a(e)},Stats:function(e){return new U.a(e)},Jaki:function(e){return new G.a(e)},Figure:function(e){return new Q.g(e)},Max:function(e){return new Q.m(e)},First:function(e){return new Q.h(e)},Last:function(e){return new Q.j(e)},"Dash 1":function(e){return new Q.c(e)},"Dash 2":function(e){return new Q.d(e)},Dot:function(e){return new Q.e(e)},Accent:function(e){return new Q.a(e)},Staccato:function(e){return new Q.u(e)},Piano:function(e){return new Q.p(e)},Pianissimo:function(e){return new Q.o(e)},Rest:function(e){return new Q.s(e)},Otherwise:function(e){return new Q.n(e)},Legato:function(e){return new Q.l(e)},"R.Every":function(e){return new Q.q(e)},Double:function(e){return new Q.f(e)},Later:function(e){return new Q.k(e)},Skip:function(e){return new Q.t(e)},Any:function(e){return new Q.b(e)},Times:function(e){return new Q.v(e)},Flam:function(e){return new Q.i(e)},Regular:function(e){return new Q.r(e)},"Chord Type":function(e){return new K.b(e)},"Generative Chords":function(e){return new W.a(e)},Voice:function(e){return new K.f(e)},Octave:function(e){return new K.c(e)},Split:function(e){return new X.b(e)},Flat:function(e){return new X.a(e)},Thick:function(e){return new X.c(e)}};function Z(e,t){if(e.name in Y)return Y[e.name](t)}},function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"f",function(){return h}),n.d(t,"c",function(){return p}),n.d(t,"b",function(){return d});var r=n(9),a=n(8),i=n(17),o=n(72),s=function(e){return e.length},c=function(e){return e[s(e)-1]},u=function(e,t){var n=[];return function(o,u,l){if(function(e,t,n){return c(e)&&t-c(e).stepNumber===Math.floor(n)}(n,u,Object(i.A)(t))){var f=void 0===o?Object(a.a)({},c(n),{stepNumber:u,time:l}):{stepData:o,stepNumber:u,time:l},h=void 0===o?Object(i.Q)(f):Object(i.w)(!0);return n=void 0!==o?[f]:[].concat(Object(r.a)(n),[f]),s(n)>Object(i.A)(e)&&(n=[]),h}return void 0!==o?(n=[{stepData:o,stepNumber:u,time:l}],Object(i.w)(!0)):Object(i.w)(!1)}};Object(o.a)("beat",{step:"The step within the beat at which this executes the ifCond condition",beat:"The total number of steps within which we determine if the step has occured",ifCond:"The condition that is executed when the step is reached",elseCond:"The condition that is executed otherwise"},"Conditions on a certain step within a beat. For example, beat(0,32,a,b) executes a on the 1st beat of every bar, and executes b on every other step");var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return function(a,o,s){var c=[a,o,s];return o%i.A.apply(void 0,[t].concat(c))===i.A.apply(void 0,[e].concat(c))?i.A.apply(void 0,[n].concat(c)):r?i.A.apply(void 0,[r].concat(c)):Object(i.w)(!0)}};Object(o.a)("gate",{stepsLists:"An array where each element is a number from 0-1 determing the probability that we allow a trigger occuring at that step to pass through"},"Control which steps are triggered within a beat, probabilistically. gate([1, 1]) allows every trigger to occur.");var f=function(e){return function(t,n,r){var a=Object(i.A)(e,t,n,r);"number"===typeof a&&(a=p(a));var o=Object(i.A)(a[Math.floor(n/2)%a.length],t,n,r);return Math.random()<o?Object(i.w)(!0):Object(i.w)(!1)}};Object(o.a)("shift",{list:"The list that we wish to shift",shiftNumber:"The number of indices to shift by"},"Shifts a list by a number of indices, on each trigger");var h=function(e){var t,n,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];c[0],c[1],c[2];var l=i.A.apply(void 0,[o].concat(c)),f=i.A.apply(void 0,[e].concat(c));if(void 0!==l&&"FILTER"!==l.axiom||(l=0),t===f&&n===l)return a;t=f,n=l,l=Math.round(l);if(0===f.length)return f;f=Object(r.a)(f);for(var h=0;h<l;h++){var p=f.shift();f.push(p)}return a=f}},p=function(e){for(var t=[];e>0;)t.push(e%2),e=Math.floor(e/2);for(;t.length<16;)t.push(0);return t},d=function(e){for(var t=0,n=0;n<e.length;n++){var r=n;e[r]&&(t+=Math.pow(2,r))}return t}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[{internalType:"bytes32",name:"annotationType",type:"bytes32"},{internalType:"bytes32",name:"data",type:"bytes32"},{internalType:"bytes32",name:"annotationData",type:"bytes32"}],name:"newAnnotation",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"annotationType",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"data",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"annotationData",type:"bytes32"},{indexed:!0,internalType:"address",name:"user",type:"address"}],name:"NewAnnotation",type:"event"},{inputs:[{internalType:"bytes32",name:"annotationType",type:"bytes32"},{internalType:"bytes32",name:"data",type:"bytes32"},{internalType:"bytes32[]",name:"annotationData",type:"bytes32[]"}],name:"newAnnotations",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"annotationType",type:"bytes32"},{internalType:"string",name:"description",type:"string"}],name:"newAnnotationType",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"annotationType",type:"bytes32"},{indexed:!1,internalType:"string",name:"description",type:"string"}],name:"NewAnnotationType",type:"event"},{inputs:[{internalType:"bytes32",name:"dataType",type:"bytes32"},{internalType:"string",name:"description",type:"string"}],name:"newDataType",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"dataType",type:"bytes32"},{indexed:!1,internalType:"string",name:"description",type:"string"}],name:"NewDataType",type:"event"},{inputs:[{internalType:"bytes32",name:"linkType",type:"bytes32"},{internalType:"bytes32",name:"fromData",type:"bytes32"},{internalType:"bytes32",name:"toData",type:"bytes32"}],name:"newLink",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"linkType",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"fromData",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"toData",type:"bytes32"},{indexed:!1,internalType:"address",name:"user",type:"address"}],name:"NewLink",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"linkType",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"fromData",type:"bytes32"},{indexed:!1,internalType:"address",name:"user",type:"address"}],name:"NewLinkRoot",type:"event"},{inputs:[{internalType:"bytes32",name:"linkType",type:"bytes32"},{internalType:"bytes32",name:"fromData",type:"bytes32"},{internalType:"bytes32[]",name:"toData",type:"bytes32[]"}],name:"newLinks",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"linkType",type:"bytes32"},{internalType:"string",name:"description",type:"string"}],name:"newLinkType",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"linkType",type:"bytes32"},{indexed:!1,internalType:"string",name:"description",type:"string"}],name:"NewLinkType",type:"event"}],this.contractAddress="0x305306F68D9C230B59d5B6869AEd1723365C9290"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},,,function(e,t,n){"use strict";function r(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=r.createBuffer(e.numberOfChannels,a+n-t+1,r.sampleRate),o=i.getChannelData(0),s=e.getChannelData(0).subarray(t,n);if(o.set(s,a),e.numberOfChannels>1){var c=i.getChannelData(1),u=e.getChannelData(1).subarray(t,n);c.set(u,a)}return i}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=(n(31),n(36)),l=n(26),f="undefined"!==typeof window.web3,h=function(){function e(t){Object(s.a)(this,e),this.address=t,this.distinct=!1,this.selectStatements=[],this.whereClauses=[],this.groupBy=[],this.joinClauses=[],this.limitSize=void 0,this.fromBlockNumber="0x2",this.toBlockNumber=void 0}return Object(c.a)(e,[{key:"from",value:function(e){return this.eventLog=e,this}},{key:"select",value:function(e){return this.selectStatements.push(e),this}},{key:"distinct",value:function(){return this.distinct=!0,this}},{key:"groupBy",value:function(e){return this.groupBy.push(e),this}},{key:"where",value:function(e,t){return this.whereClauses.push(new p(e,t)),this}},{key:"whereIn",value:function(e,t){return this.whereClauses.push(new p(e,void 0,t)),this}},{key:"join",value:function(e,t){this.joinClauses.push(new d(e,t))}},{key:"fromBlock",value:function(e){return this.fromBlockNumber=u.a.utils.toHex(e),this}},{key:"toBlock",value:function(e){return this.toBlockNumber=u.a.utils.toHex(e),this}},{key:"limit",value:function(e){return this.limitSize=e,this}},{key:"getTopics",value:function(){var e=[u.a.utils.sha3(this.eventLog.event)];for(var t in this.eventLog.topics){var n=this.eventLog.topics[parseInt(t)],r=null;for(var a in this.whereClauses){var i=this.whereClauses[parseInt(a)];if(i.name===n.name){var o=void 0!==i.value?i.value:i.valueList[0];r=n.convertTo(o)}}e.push(r)}return e}},{key:"executeQuery",value:function(){var e=this;return new Promise(function(t,n){u.a.eth.getPastLogs({address:e.address,topics:e.getTopics(),toBlock:e.toBlockNumber,fromBlock:e.fromBlockNumber},function(r,a){if(r)n(r);else{var i=[];a.reverse();for(var o=Math.min(a.length,e.limitSize||a.length),s=0;s<o;s++)i.push(e.parseResult(a[s]));t(i)}})})}},{key:"watchQuery",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.eth.getBlockNumber();case 2:n=e.sent,(f?u.a:u.b).eth.subscribe("logs",{address:this.address,topics:this.getTopics(),fromBlock:u.a.utils.toHex(n)},function(e,n){e&&(console.log("error watching "),console.log(e));var a=r.parseResult(n);console.log("watch query got "),console.log(a),t(a)});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseResult",value:function(e){if(void 0!==e&&null!==e){var t={};for(var n in this.selectStatements){var r=this.selectStatements[parseInt(n)];for(var a in this.eventLog.topics){var i=e.topics[1+parseInt(a)],o=this.eventLog.topics[parseInt(a)];o.name===r&&(t[r]=o.type.convertFrom(i))}var s=0;for(var c in this.eventLog.data){c=parseInt(c);var u=this.eventLog.data[c];if(void 0!==u&&r==u.name){var f=e.data.slice(2+s,2+s+u.size);f="0x"+f,u.type==l.m&&(f="0x"+e.data.slice(130+64*c)),t[r]=u.convertFrom(f)}s+=u.size}}return t.blockNumber=e.blockNumber,t}}},{key:"getCopy",value:function(){var t=new e(this.address);return t.eventLog=this.eventLog,t.selectStatements=Object(r.a)(this.selectStatements),t.joinClauses=Object(r.a)(this.joinClauses),t.groupBy=Object(r.a)(this.groupBy),t.fromBlockNumber=this.fromBlockNumber,t.toBlockNumber=this.toBlockNumber,t.limitSize=this.limitSize,t}},{key:"getJson",value:function(){return{address:this.address,eventLog:this.eventLog.event,selectStatements:Object(r.a)(this.selectStatements),whereClauses:Object(r.a)(this.whereClauses),joinClauses:Object(r.a)(this.joinClauses),groupBy:Object(r.a)(this.groupBy),fromBlockNumber:u.a.utils.hexToNumber(this.fromBlockNumber),toBlockNumber:void 0===this.toBlockNumber?void 0:u.a.utils.hexToNumber(this.toBlockNumber),limitSize:this.limitSize,distinct:this.distinct}}}]),e}(),p=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object(s.a)(this,e),this.name=t,this.value=n,this.valueList=r},d=function e(t,n){Object(s.a)(this,e),this.event=t,this.field=n};t.a=h},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}}},,function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"e",function(){return s});var r=1,a=2,i=3,o=1,s=2},,,function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=(n(15),n(43));function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(e){Object(s.a)(n,e);var t=h(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this)).patternNumber=e,r}return Object(i.a)(n,[{key:"getValue",value:function(){return this.patternNumber}},{key:"isSkippable",value:function(){return!1}},{key:"isDeterministic",value:function(){return!0}},{key:"executeEvent",value:function(e){e.switchToPatternHelper(this.patternNumber)}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{patternNumber:this.patternNumber})}},{key:"getCopy",value:function(e){var t=new n;return t.fromJson(this.getJson(),e),t}},{key:"getType",value:function(){return f.i}},{key:"fromJson",value:function(e,t){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.loadSubSequence(e,t),this.patternNumber=e.patternNumber,this}}]),n}(l.a);t.a=p},function(e,t,n){"use strict";function r(e,t,n){var r={};if(e<t)for(var a in n)(a=parseInt(a))>t?r[a]=n[a]:a>e?r[a-1]=n[a]:a===e?r[t]=n[e]:r[a]=n[a];else for(var i in n)(i=parseInt(i))<t?r[i]=n[i]:i===e?r[t]=n[e]:i>=t?r[i+1]=n[i]:r[i]=n[i];return r}function a(e,t){var n={};for(var r in t)(r=parseInt(r))!==e&&(r>e?n[r-1]=t[r]:n[r]=t[r]);return n}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},function(e,t,n){"use strict";var r=n(8),a=n(9),i=n(5),o=n.n(i),s=n(14),c=n(2),u=n(4),l=n(435),f=(n(314),n(529)),h=n(6),p=n(151),d=n(162),m=n(15),v=n.n(m),b=n(57);function g(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var k=function(){function e(t,n,r,a){Object(c.a)(this,e),this.inputNode=t,this.effectsInputNode=new v.a.Gain,this.inputNode.connect(this.effectsInputNode),this.outputNode=n,this.mixSession=a.mixSession,this.parameterContext=r,this.sequencerEngine=a,this.effects=[],this.samplerConnectedToMaster=!1}return Object(u.a)(e,[{key:"initDefault",value:function(){this.effects=Object(l.a)(this.sequencerEngine),this.updateEffects()}},{key:"setupEffects",value:function(){this.connectEffects(this.effectsInputNode,this.effects)}},{key:"updateEffects",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.effects;this.effects=t,this.effects.map(function(t){return t.track=e}),this.connectEffects(this.effectsInputNode,t)}},{key:"disconnectAll",value:function(){this.effects.map(function(e){return e.disconnect()})}},{key:"makePublicIfNeeded",value:function(){var e=Object(s.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=o.a.keys(this.effects);case 1:if((e.t1=e.t0()).done){e.next=7;break}return t=e.t1.value,e.next=5,this.effects[t].makePublicIfNeeded();case 5:e.next=1;break;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"connectEffects",value:function(e,t){e.disconnect(),this.effects.map(function(e){return e.disconnect()});for(var n=e,r=0;r<t.length;r++){var a=t[r].getEffect();t[r].isEnabled()&&(n.connect(a),n=t[r])}n.connect(this.outputNode),this.linkEffectParameters()}},{key:"linkEffectParameters",value:function(){var e=this;this.effects.forEach(function(t){t.registerContext(e.parameterContext),t.registerMixSession(e.mixSession)})}},{key:"dispose",value:function(){this.effectsInputNode.disconnect(),this.effectsInputNode.dispose(),this.effects.forEach(function(e){return e.disconnect()}),this.effects.forEach(function(e){return e.dispose()}),this.effects=void 0,this.effectsInputNode=void 0}},{key:"clear",value:function(){this.effects.forEach(function(e){return e.disconnect()}),this.effects.forEach(function(e){return e.dispose()}),this.effects=[]}},{key:"start",value:function(){this.effects.filter(function(e){return e.syncable()}).forEach(function(e){return e.start()}),this.effects.forEach(function(e){return e.parameters.filter(function(e){return e.isConnectedToAnyModulator()}).forEach(function(e){return e.refresh()})})}},{key:"getAllParameters",value:function(){var e=[];return void 0===this.effects?e:(this.effects.forEach(function(t){return t.getParameters().forEach(function(t){return e.push(t)})}),e)}},{key:"getAllPatternLockedParameters",value:function(){return this.getAllParameters().filter(function(e){return e.hasPatternLockedValues()})}},{key:"moveEffectTo",value:function(e,t){if(e!=t){this.effectsInputNode.disconnect(this.effects[0]),this.effects.forEach(function(e){return e.disconnect()});var n=[];e>t?(n=this.effects.slice(0,t).concat([this.effects[e]]).concat(this.effects.slice(t,e)),this.effects.length>e+1&&(n=n.concat(this.effects.slice(e+1)))):(n=this.effects.slice(0,e).concat(this.effects.slice(e+1,t)).concat([this.effects[t],this.effects[e]]),this.effects.length>t+1&&(n=n.concat(this.effects.slice(t+1)))),this.updateEffects(n)}}},{key:"onBPMUpdated",value:function(){for(var e in this.effects)this.effects[e].onBPMUpdated&&this.effects[e].onBPMUpdated()}},{key:"getEffectNumber",value:function(e){var t=e.id;return this.effects.map(function(e){return e.id}).indexOf(t)}},{key:"getEffectById",value:function(e){return this.effects.find(function(t){return t.id===e})}},{key:"addEffect",value:function(e){this.effects=[].concat(Object(a.a)(this.effects),[e]),this.updateEffects()}},{key:"deleteEffect",value:function(e){var t=this.getEffectNumber(e);t<0||(e.disconnect(),t>0&&this.effects[t-1].disconnect(),this.effects.splice(t,1),this.effects=Object(a.a)(this.effects),this.updateEffects(this.effects),e.dispose())}},{key:"getCopy",value:function(t,n,r){var a=new e(t.gainNode,t.trackNode,(new b.a).forTrack(t),this.sequencerEngine);return a.effects=this.effects.map(function(e){return e.getEffectCopy(n,r)}),a.linkEffectParameters(),a}},{key:"getJson",value:function(e){return this.effects.map(function(t){return t.getJson(e)})}},{key:"mate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=Math.max(e.effects.length,this.effects.length),r=[];e.disconnectAll();for(var a=[],i=0;i<n;i++){var o=this.effects[i],s=e.effects[i];Object(d.a)(t)?(s&&r.push(s.getEffectCopy(this.track)),o&&a.push(o)):o&&r.push(o)}this.updateEffects(r),a.forEach(function(e){return e.dispose()}),e.effectsInputNode.disconnect(),e.effectsInputNode.dispose()}},{key:"addEffectJson",value:function(e,t,n){var r=Object(p.a)(e,t,this.sequencerEngine,n);return this.addEffect(r.effect),r}},{key:"fromJson",value:function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var a={};for(var i in e){var o=e[i],s=Object(p.a)(o,t,this.sequencerEngine,n);this.addEffect(s.effect),a=Object(r.a)({},a,s.bulk)}this.sequencerEngine.store.dispatch(Object(h.Vb)(a))}},{key:"convertToRack",value:function(){var e=this.effects.map(function(e){return e.getEffectCopy()}),t=new f.a(this.sequencerEngine);e.forEach(function(e){return t.addEffect(e,!1)});var n,r=50,a=100,i=g(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.x=r,o.y=a,(r+=50)>300&&(r=50,a+=50)}}catch(c){i.e(c)}finally{i.f()}t.connectNodes(void 0,e[0]);for(var s=0;s<e.length;s++)t.connectNodes(e[s],e[s+1]);this.clear(),this.addEffect(t)}}]),e}();t.a=k},,function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(12);n(164);t.a=Object(o.b)(function(e,t){return{}},null)(function(e){var t=e.text,n=e.className,o=void 0===n?"":n,s=e.width,c=void 0===s?390:s,u=e.intervalTime,l=void 0===u?100:u,f=e.intervalPiece,h=void 0===f?10:f,p=Object(a.useState)(0),d=Object(r.a)(p,2),m=d[0],v=d[1];Object(a.useEffect)(function(){var e=setInterval(function(){v(function(e){return(e+h)%100})},l);return function(){return clearInterval(e)}},[]);var b={width:c*m/100};return i.a.createElement("div",{className:"progress-bar "+o},i.a.createElement("div",{className:"inner-progress-bar"},i.a.createElement("div",{className:"progress",style:b}),i.a.createElement("div",{className:"loading-text"},t," ...")))})},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(11),a=n(0),i=n(367),o=function(e){var t=e.ref,n=e.useTop,o=void 0===n||n,s=e.useLeft,c=void 0===s||s,u=Object(a.useState)(void 0),l=Object(r.a)(u,2),f=l[0],h=l[1];return Object(i.a)({clear:function(){return h(void 0)},selected:f}),{onContextMenu:Object(a.useCallback)(function(e){if(e.preventDefault(),e.stopPropagation(),t){var n=t.current.getBoundingClientRect(),r={x:c?e.clientX-n.left+t.current.scrollLeft:e.clientX,y:o?e.clientY-n.top+t.current.scrollTop:e.clientY};h(r)}else{var a={x:e.clientX,y:e.clientY};h(a)}},[h,o,c,t]),dropdownPos:f,setDropdownPos:h}}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(97),o=(n(34),n(76)),s=(n(902),n(694)),c=n(6),u=n(106),l=n(29),f=n(12),h=n(55),p=n(69),d=n(164),m=n.n(d),v=(n(2553),new l.a);new Set(["clap","tom","toms","clave","perc","snare","kick","hi-hat","rim","side-stick","breaks","sub","ride","piano","violin"]);t.a=Object(f.b)(function(e,t){var n=t.track;return n&&n.tracks&&n.tracks[0]&&(n=n.tracks[0].track),t.track&&t.track.subSequence?{id:void 0===n?0:void 0!==n.sample&&void 0!==n.sample.getId()?n.sample.getId():n.presetName||n.getName&&n.getName(),_videoId:n&&n.sample&&n.sample.videoId,_discogsId:n&&n.sample&&n.sample.coverArtHash,isCompactMode:e.sequencer.isCompactMode&&!t.isBig,showingWaveform:e.sequencer.showPianoRoll&&(e.arrangement.bottomMode===u.e||e.arrangement.bottomMode===u.b),isLoading:void 0!==t.track&&!!e.tracks.trackIsLoading[t.track.subSequence.id]&&!0===e.tracks.trackIsLoading[t.track.subSequence.id][t.track.trackNumber]}:{}},function(e){return{setSampleDragging:function(t){return e(Object(c.He)(t))},setTrackDragging:function(t){return e(Object(c.Sg)(t))}}})(function(e){var t=e.isLoading,n=e.hasInner,r=e.track,c=(e.isSelectedTrack,e.onMouseDown),u=void 0===c?function(){return[]}:c,l=e.sample,f=e.isPad,d=e.draggable,b=void 0===d||d,g=e.onClickThumbnail,y=e.showingWaveform,k=e.className,O=e.showPresetName,j=e.setSampleDragging,w=e.setTrackDragging,E=e.children,S=e.hasBorder,P=e.scale;l=l||r.sample;var x={backgroundColor:r&&r.getTrackType?v.getColorForTrack(r):l&&v.getColorForHash(l.getId())};S&&(x.borderColor=x.backgroundColor);var T="";if(y&&r&&(T=" showing-waveform "),k&&(T+=k+" "),!r&&!l)return"";var C=Object(s.a)(r,l);r&&r.getObjectType&&r.getObjectType()===i.c&&(r&&r.getTrackType()===h.e&&(T+=" is-multi "),void 0!==C&&""!==C||O&&r&&(C=r.presetName||r.getName())),P&&(x.height=12*P+"px",x.lineHeight=12*P+"px",x.fontSize=6*P+"pt");var N=a.a.createElement("div",{draggable:b,onMouseDown:u,onClick:g,onDragStart:function(e){e.stopPropagation(),j(l),w(r)},onDragOver:function(e){return e.preventDefault()},className:"pushable sound-thumbnail "+T,style:x},C);if(l){var R=l.getThumbnail();R&&""!==R&&(N=a.a.createElement("img",{draggable:b,onMouseDown:u,onDragStart:function(e){e.stopPropagation(),w(r),j(l)},onDragOver:function(e){return e.preventDefault()},src:R,onClick:g,className:"pushable youtube-thumbnail "+T}))}return n&&r&&r.sample&&""!==r.sample.getThumbnail()&&r.sample.getThumbnail()&&(n=!1),f||(r.instrument&&r.instrument.getInstrumentType()===p.f?N=a.a.createElement("img",{onDragStart:function(e){e.stopPropagation(),w(r),j(l)},onClick:g,className:"pushable synth-icon",src:"/synth-icon.svg"}):r.getTrackType&&r.getTrackType()===h.a&&(N=a.a.createElement("img",{onDragStart:function(e){e.stopPropagation(),w(r),j(l)},className:"live-loop-icon",src:"/live-loop-icon.svg"}))),a.a.createElement(o.a,{element:void 0},a.a.createElement("div",{style:n&&x.backgroundColor?{backgroundColor:v.transparent(v.saturate(x.backgroundColor,1),.65)}:{},className:"youtube-info"},N,a.a.createElement(m.a,{className:"track-loading-spinner",sizeUnit:"px",size:10,color:"#123abc",loading:t}),E))})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(22),s=n(12),c=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){return i.a.createElement("div",null,i.a.createElement(o.a,{effectNumber:e.effectNumber,name:"Flush",parameter:e.effect.flushParameter,automation:e.automation,onParameterChanged:e.onParameterChanged,isParameter:!0,sequencerEngine:e.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:32}))}),u=n(844),l=n(72),f=n(76),h=n(377),p=n(2),d=n(4),m=n(7),v=n(10),b=n(1),g=n(428),y=n(46),k=n(39),O=n.n(k),j=n(504),w=(n(33),n(256));function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var S=function(e){Object(m.a)(n,e);var t=E(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={effect:e.effect},r}return Object(d.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"handleOptionChange",value:function(e){this.setState(this.state)}},{key:"handleParameterChange",value:function(e,t){if(this.props.automation){var n=this.props.automation.get(e);void 0===n?this.props.automation.set(this.props.parameter,new g.a(this.props.effectNumber,e,t)):n.value=t}else this.props.sequencerEngine.operationManager.dispatch(Object(y.v)(e,t))}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"getParameter",value:function(e){var t=e.get();if(this.props.automation){var n=this.props.automation.get(e);if(void 0!==n)return n.value}return t}},{key:"render",value:function(){var e,t=this;return i.a.createElement("div",null,this.isEnabled()?i.a.createElement("div",null,i.a.createElement(j.a,{automation:this.props.automation,onChange:function(e){return t.handleParameterChange(t.state.effect.arpRateParameter,e)},parameter:this.state.effect.arpRateParameter}),i.a.createElement("div",{className:"lfo-rate-dropdown"},i.a.createElement("div",{className:"lfo-rate-label"},"Direction:"),i.a.createElement(O.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:P,onChange:function(e){return t.handleParameterChange(t.state.effect.arpDirectionParameter,e.value)},value:(e=this.getParameter(this.state.effect.arpDirectionParameter),P.filter(function(t){return t.value===e})[0]),placeholder:"Direction"}),i.a.createElement("div",{className:"clear-fix"})),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Octaves",parameter:this.state.effect.arpOctavesParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:6}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Repeats",parameter:this.state.effect.arpRepeatParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:8}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Duration Factor",parameter:this.state.effect.arpDurationFactorParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.1,min:.1,max:8})):"")}}]),n}(a.Component),P=[{value:w.a,label:"Down"},{value:w.b,label:"Up"}];var x=Object(s.b)(function(e,t){return{arpDirection:t.effect.arpDirectionParameter.get(),isMacroMapping:e.effects.isMacroMapping}},null)(S),T=n(340),C=n(114),N=n(547),R=n(195);n(2446);function M(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q=[{label:"Forward",value:R.b},{label:"Forward/Reverse",value:R.c},{label:"Forward/Stay",value:R.d}],D=(R.a,R.e,Object(s.b)(function(e,t){return{mode:t.effect.modeParameter.get()}},function(e){return{}})(function(e){var t=e.effect,n=e.isDraggable,s=e.sequencerEngine,c=e.mode,u=(e.operation,Object(a.useState)(t._parameters)),l=Object(r.a)(u,2),h=l[0];l[1];if(!t.isEnabled())return i.a.createElement("div",null);var p,d=1,m=0,v=M(h);try{for(v.s();!(p=v.n()).done;){var b=p.value;b&&(b.min<m&&(m=b.min),b.max>d&&(d=b.max))}}catch(g){v.e(g)}finally{v.f()}return i.a.createElement("div",{className:"accumulator"},i.a.createElement("div",{className:"acc-column"},i.a.createElement(f.a,{element:t.modeParameter,className:"synced-parameter"},i.a.createElement("span",null,"Limit Mode: "),i.a.createElement(O.a,{placeholder:"Limit Mode",options:q,value:q.find(function(e){return e.value===c}),onChange:function(e){return t.modeParameter.set(e.value)}})),i.a.createElement(o.a,{name:"Accumulator",parameter:t.accumulatorValueParameter,isParameter:!0,sequencerEngine:s,lfoEnabled:!0,step:.001,min:m,max:d}),i.a.createElement(o.a,{name:"Limit",parameter:t.limitParameter,isParameter:!0,sequencerEngine:s,lfoEnabled:!0,step:.001,min:0,max:d-m}),i.a.createElement(o.a,{name:"Ramp Time",parameter:t.rampTimeParameter,isParameter:!0,sequencerEngine:s,lfoEnabled:!0,unit:"ms",step:1,min:1,max:3e3}),i.a.createElement(C.a,{name:"Reset on step 1",parameter:t.resetAtZeroParameter})),i.a.createElement(T.a,{isDraggable:n,effect:t}))})),I=n(9),_=function(e){var t=e.effect,n=e.item,o=e.i,s=(e.key,e.isCurrent),c=Object(a.useState)(void 0===n?"":void 0),u=Object(r.a)(c,2),l=u[0],f=u[1];Object(a.useEffect)(function(){f(void 0===n?"":void 0)},[n,f]);var h=Object(a.useCallback)(function(e){if("Enter"===e.key){var n=parseFloat(l);if(isNaN(n))return;var r=t.valueList;void 0===o?t.valueList=[].concat(Object(I.a)(r),[n]):(r[o]=n,t.valueList=r),f(void 0)}},[f,l,t,o]),p=Object(a.useCallback)(function(e){e.stopPropagation();var n=Object(I.a)(t.valueList);n.splice(o,o),t.valueList=n},[t,o]);return void 0!==l?i.a.createElement("div",{className:"value-list-item"},i.a.createElement("input",{placeholder:"Enter value",value:l,onChange:function(e){return f(e.target.value)},onKeyDown:h})):i.a.createElement("div",{onClick:function(){return f(n)},className:s?"value-list-item current":"value-list-item"},i.a.createElement("div",null,n),i.a.createElement("div",{onClick:p,className:"delete-btn"},"x"))},F=Object(s.b)(function(e,t){var n=t.effect.listParameter.get();return{valueList:n,len:n.length,index:t.effect.counter}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.effect,r=e.valueList,a=(e.len,e.index),s=e.isDraggable,c=Array.isArray(r)?[].concat(Object(I.a)(r),[void 0]):[void 0];return a%=r.length,i.a.createElement("div",{className:"control-parameters accumulator"},i.a.createElement("div",{className:"acc-column"},c.map(function(e,t){return i.a.createElement(_,{isCurrent:t===a,effect:n,key:t,item:e,i:t})})),i.a.createElement(T.a,{isDraggable:s,effect:n},i.a.createElement(o.a,{name:"Ramp Time",parameter:n.rampTimeParameter,isParameter:!0,sequencerEngine:t,lfoEnabled:!0,unit:"ms",step:1,min:1,max:3e3}),i.a.createElement(C.a,{name:"Reset on step 1",parameter:n.resetAtZeroParameter})))}),L=n(6),B=n(335),z=Object(s.b)(function(e,t){return{color:e.plane.gradientColors[t.effect.id]}},function(e){return{setPlanarGradientColor:function(t,n){return e(Object(L.ge)(t,n))}}})(function(e){var t=e.effect,n=e.color,o=e.setPlanarGradientColor;n=n||"#ffffff";var s=Object(a.useState)(n),c=Object(r.a)(s,2),u=c[0],l=c[1],f=Object(a.useState)(!1),h=Object(r.a)(f,2),p=h[0],d=h[1],m=Object(a.useCallback)(function(e){o(t.id,e.hex),l(e)},[l,t]);return i.a.createElement("div",{className:"gradient-color"},"Gradient Color: ",i.a.createElement("div",{onClick:function(){return d(!p)},style:{backgroundColor:n},className:"color-dot"}),p&&i.a.createElement(B.a,{color:u,onChange:m}))}),V=n(90),H=n.n(V),U=n(35),J=[{label:"240x160",value:{width:240,height:160}},{label:"300x200",value:{width:300,height:200}},{label:"600x400",value:{width:600,height:400}},{label:"900x600",value:{width:900,height:600}}],G=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,s=Object(a.useState)(U.c),c=Object(r.a)(s,2),u=c[0],l=c[1],f=Object(a.useState)(U.a),h=Object(r.a)(f,2),p=(h[0],h[1]),d=Object(a.useCallback)(function(e){var n=e.value,r=n.width,a=n.height;l(r),p(a),Object(U.d)(r,a),t.stop()},[l,p]);return i.a.createElement("div",{className:"look-config"},i.a.createElement(O.a,{className:"osc-type-dropdown",options:J,onChange:d,value:J.find(function(e){return e.value.width===u})}),i.a.createElement(o.a,{name:"Blur",unit:"px",parameter:t.blurParameter,min:0,max:40,step:1,lfoEnabled:!0,isParameter:!0,sequencerEngine:n}),i.a.createElement(o.a,{name:"Tension",parameter:t.splineTensionParameter,root:3,min:.5,max:400,step:.01,lfoEnabled:!0,isParameter:!0,sequencerEngine:n}),i.a.createElement(z,{effect:t}))}),W=function(e){var t=e.hideUI,n=e.setHideUI,r="hide-ui-toggle";return t&&(r+=" hiding"),i.a.createElement("div",{onClick:function(){return n(!t)},className:r},t&&i.a.createElement("div",{className:"circle-button"}),t?"No UI":"UI",!t&&i.a.createElement("div",{className:"circle-button"}))},K=function(e){var t=e.effect,n=e.sequencerEngine;return i.a.createElement("div",{className:"config-parameters"},i.a.createElement(o.a,{name:"Ramp Time",unit:"ms",parameter:t.rampTimeParameter,min:1,max:2e3,step:1,lfoEnabled:!0,isParameter:!0,sequencerEngine:n}),i.a.createElement(o.a,{name:"# Parameters per iter",unit:"ms",parameter:t.maxParametersParameter,min:16,max:64,step:1,lfoEnabled:!0,isParameter:!0,sequencerEngine:n}),i.a.createElement(o.a,{name:"Update Rate",unit:"",parameter:t.updateRateParameter,min:0,max:8,step:1,lfoEnabled:!0,isParameter:!0,sequencerEngine:n}))},X=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,o=e.hideUI,s=e.setHideUI,c=Object(a.useState)("MAIN"),u=Object(r.a)(c,2),l=u[0];u[1];return i.a.createElement("div",{className:"plane-config"},"MAIN"===l&&i.a.createElement(K,{effect:t,sequencerEngine:n}),"LOOK"===l&&i.a.createElement(G,{effect:t,sequencerEngine:n}),i.a.createElement("div",{className:"tab-options"},i.a.createElement(W,{hideUI:o,setHideUI:s})))}),Q=Object(s.b)(function(e,t){return{playing:t.effect.playing}},function(e){return{}})(function(e){var t=e.playing,n=e.effect,r=Object(a.useCallback)(function(){n.playingParameter.set(!t)},[t,n]),o="plane-play";return o+=t?" pause-btn":" play-btn",i.a.createElement("div",{onClick:r,className:o})}),Y=n(1469),Z=Object(s.b)(function(e,t){return{planeMapping:e.effects.planeMapping}},function(e){return{setPlaneMapping:function(t){return e(Object(L.ke)(t))}}})(function(e){var t=e.isDraggable,n=e.sequencerEngine,o=e.effect,s=e.planeMapping,c=e.setPlaneMapping,u=Object(a.useState)(12),l=Object(r.a)(u,2),f=l[0],h=(l[1],Object(a.useState)(o.hideUI)),p=Object(r.a)(h,2),d=p[0],m=p[1],v="control-parameters plane-parameters";return d&&(v+=" hide-ui"),Object(a.useEffect)(function(){o.hideUI=d},[d]),i.a.createElement("div",{className:v},i.a.createElement("div",{className:"acc-column"},i.a.createElement(Y.a,{debug:f,hideUI:d,isDraggable:t,sequencerEngine:n,effect:o},i.a.createElement("div",{className:"control-toolbar"},i.a.createElement("div",{className:"row-powa"},i.a.createElement("div",{onClick:function(e){e.stopPropagation(),c(s?void 0:o)},className:s?"mappy-btn mapping":"mappy-btn"},"map devices"),i.a.createElement(N.a,{onMapped:function(){return[]},effect:o,skipSelected:!0,label:"map params"}),i.a.createElement(Q,{effect:o})),i.a.createElement(X,{setHideUI:m,hideUI:d,sequencerEngine:n,effect:o})))))}),$=n(38),ee=n(34);function te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var ne=function(e){Object(m.a)(n,e);var t=te(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"getParameterOptions",value:function(){return this.props.effect.getAvailableParameters().map(function(e){return{label:e.name,value:e}})}},{key:"getParameterOption",value:function(e){if(void 0!==e){var t=this.getParameterOptions().filter(function(t){return t.value===e});return t.length>0?t[0]:void 0}}},{key:"handleParameterChange",value:function(e){this.props.effect.parameter=e.value,this.setState(this.state)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"deleteParameter",value:function(){this.props.deleteParameterizer(this.props.effect)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:this.props.isSimple?"parameterizer":""},i.a.createElement($.a,{condition:this.isEnabled()},i.a.createElement("div",{onMouseOver:function(t){return e.setContextualHelp(t,ee.db)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"parameter-dropdown-container"},i.a.createElement("div",{className:"lfo-rate-label"},"Parameter:"),i.a.createElement(O.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getParameterOptions(),onChange:function(t){return e.handleParameterChange(t)},value:this.getParameterOption(this.props.effect.parameter),placeholder:"Parameter"})),i.a.createElement("div",{className:"clear-fix"}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,contextualHelp:ee.eb,name:"Factor",automation:this.props.automation,parameter:this.props.effect.factorParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:.01,max:8}),i.a.createElement(o.a,{contextualHelp:ee.fb,effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Offset",root:1,parameter:this.props.effect.offsetParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.1,min:-12,max:12}),this.props.isSimple?"":i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Probability",contextualHelp:ee.mb,automation:this.props.automation,parameter:this.props.effect.probabilityParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:100})),this.props.isSimple?i.a.createElement("div",{onClick:function(){return e.deleteParameter()},className:"delete-btn"},"x"):"")}}]),n}(a.Component),re=Object(s.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(L.ub)(t))}}})(ne);function ae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var ie=function(e){Object(m.a)(n,e);var t=ae(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"handleResolutionChange",value:function(e){this.props.effect.resolution=e.value,this.setState(this.state)}},{key:"render",value:function(){var e,t=this;return i.a.createElement("div",null,i.a.createElement($.a,{condition:this.isEnabled()},i.a.createElement("div",{className:"lfo-rate-dropdown"},i.a.createElement("div",{className:"lfo-rate-label"},"Resolution:"),i.a.createElement(O.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:oe,onChange:function(e){return t.handleResolutionChange(e)},value:(e=this.props.effect.resolution,oe.filter(function(t){return t.value===e})[0]),placeholder:"Rate"}),i.a.createElement("div",{className:"clear-fix"})),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,root:2,name:"Odd Timing Offset",parameter:this.props.effect.evenOffsetParameter,onParameterChanged:this.props.onParameterChanged,automation:this.props.automation,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:-.5,max:4}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Even Timing Offset",root:2,parameter:this.props.effect.oddOffsetParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:-.5,max:4}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Probability",parameter:this.props.effect.probabilityParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:100})))}}]),n}(a.Component),oe=[{value:32,label:"1"},{value:16,label:"1/2"},{value:8,label:"1/4"},{value:4,label:"1/8"},{value:2,label:"1/16"},{value:1,label:"1/32"}];var se=ie;function ce(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var ue=function(e){Object(m.a)(n,e);var t=ce(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement($.a,{condition:this.isEnabled()},i.a.createElement(o.a,{effectNumber:this.props.effectNumber,contextualHelp:ee.eb,name:"Limit",parameter:this.props.effect.limitParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:16})))}}]),n}(a.Component),le=Object(s.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(L.ub)(t))}}})(ue);function fe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var he=function(e){Object(m.a)(n,e);var t=fe(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"onChangeResolution",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(y.v)(this.props.effect.resolutionParameter,e))}},{key:"onChangeSliceRetrigger",value:function(e){document.activeElement.blur(),this.props.effect.sliceRetrigger=!this.props.effect.sliceRetrigger,this.setState(this.state)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement($.a,{condition:this.isEnabled()},i.a.createElement("div",{className:"clear-fix"}),i.a.createElement(j.a,{automation:this.props.automation,parameter:this.props.effect.resolutionParameter,onChange:function(t){return e.onChangeResolution(t)}}),i.a.createElement($.a,{condition:!window.installation},i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Warp Speed",parameter:this.props.effect.warpLengthParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:.01,max:4}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Warp Factor",parameter:this.props.effect.warpFactorParameter,onParameterChanged:this.props.onParameterChanged,automation:this.props.automation,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.5,min:1,max:8})),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Loop Length",automation:this.props.automation,parameter:this.props.effect.loopLengthParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,unit:"%",step:.1,min:.1,max:100}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Grain Size",automation:this.props.automation,parameter:this.props.effect.durationFactorParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:.01,max:2}),i.a.createElement($.a,{condition:!window.installation},i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Smoothness",parameter:this.props.effect.smoothnessParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.1,min:.1,max:20})),i.a.createElement("div",{className:"refined-checkbox-preferences"},i.a.createElement("label",null,i.a.createElement("input",{type:"checkbox",value:"reversed",checked:this.props.effect.sliceRetrigger,onChange:function(t){return e.onChangeSliceRetrigger(t.target.value)}}),"Slice Retrigger"))))}}]),n}(a.Component),pe=Object(s.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(L.ub)(t))}}})(he),de=n(874),me=Object(s.b)(function(e,t){return{linkingEffects:e.effects.linkingEffects}},function(e){return{setLinkingEffects:function(t,n){return e(Object(L.Yc)(t,n))}}})(function(e){var t=e.setLinkingEffects,n=e.sequencerEngine,r=e.effect,s=e.effectNumber,c=e.linkingEffects,u=Object(a.useCallback)(function(e){c?t(void 0):t(r,"Tidal")},[c,r]);return i.a.createElement("div",null,i.a.createElement("div",{onClick:u,className:c?"map-button mapping":"map-button"},r.linkedEffect?"Unmap Linked Tidal":"Map Tidal Effect"),i.a.createElement(o.a,{effectNumber:s,name:"Cycle Factor",parameter:r.cycleFactorParameter,isParameter:!0,sequencerEngine:n,lfoEnabled:!0,step:.25,min:.25,max:16}))}),ve=n(252);function be(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var ge=function(e){Object(m.a)(n,e);var t=be(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"getParameterOptions",value:function(){return this.props.sequencerEngine.tracks.map(function(e){return{label:e.trackNumber+1,value:e}})}},{key:"getParameterOption",value:function(e){if(void 0!==e){e=this.props.sequencerEngine.tracks[e];var t=this.getParameterOptions().filter(function(t){return t.value===e});return t.length>0?t[0]:void 0}}},{key:"onSelectTrack",value:function(e){this.props.effect.trackOutput=null===e?void 0:e.trackNumber,this.setState(this.state)}},{key:"track",get:function(){return this.props.sequencerEngine.tracks[this.props.effect.trackOutput]}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement($.a,{condition:this.isEnabled()},i.a.createElement(ve.a,{track:this.track,onSelectTrack:function(t){return e.onSelectTrack(t)},sequencerEngine:this.props.sequencerEngine}),i.a.createElement("div",{className:"clear-fix"}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Probability",parameter:this.props.effect.probabilityParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:100})))}}]),n}(a.Component);function ye(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var ke=function(e){Object(m.a)(n,e);var t=ye(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){var e=this.props.effect.ccParameters;return i.a.createElement("div",null,i.a.createElement("div",{className:"external-instrument-name"},this.props.effect.midiOutput.name),i.a.createElement("div",{className:"midi-interface-effect"},i.a.createElement($.a,{condition:this.isEnabled()},e.map(function(e){return i.a.createElement("div",{className:"instrument-section"},Object.keys(e).map(function(t){return i.a.createElement(Oe,{section:e[t],sectionName:t})}))}))))}}]),n}(a.Component),Oe=function(e){Object(m.a)(n,e);var t=ye(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"external-instrument-subsection"},i.a.createElement("div",{className:"instrument-subsection-name"},this.props.sectionName),i.a.createElement("div",{className:"clear-fix"}),Object.keys(this.props.section).map(function(t){return i.a.createElement(o.a,{effectNumber:e.props.effectNumber,name:t,parameter:e.props.section[t],onParameterChanged:e.props.onParameterChanged,isParameter:!0,step:1,min:0,max:127})}))}}]),n}(a.Component),je=ke;function we(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var Ee=function(e){Object(m.a)(n,e);var t=we(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"getParameterOptions",value:function(){return this.props.effect.getAvailableParameters().map(function(e){return{label:e.name,value:e}})}},{key:"getParameterOption",value:function(e){if(void 0!==e){var t=this.getParameterOptions().filter(function(t){return t.value===e});return t.length>0?t[0]:void 0}}},{key:"handleParameterChange",value:function(e){this.props.effect.parameter=e.value,this.setState(this.state)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement($.a,{condition:this.isEnabled()},i.a.createElement(o.a,{effectNumber:this.props.effectNumber,contextualHelp:ee.eb,name:"Pitch",parameter:this.props.effect.pitchParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.1,min:-32,max:32}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,contextualHelp:ee.eb,name:"Velocity",parameter:this.props.effect.velocityParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:0,max:1}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,contextualHelp:ee.eb,name:"Timing Offset",parameter:this.props.effect.timingOffsetParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:0,max:4}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Probability",contextualHelp:ee.mb,parameter:this.props.effect.probabilityParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:100})))}}]),n}(a.Component),Se=Object(s.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(L.ub)(t))}}})(Ee),Pe=n(62),xe=n(59);function Te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var Ce=function(e){Object(m.a)(n,e);var t=Te(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement($.a,{condition:this.isEnabled()},[0,1,2,3,4,5,6,7,8,9,10,11].map(function(t){return i.a.createElement(Ne,{isLastNote:e.props.lastNotePlayed===t,input:t,effect:e.props.effect})})))}}]),n}(a.Component),Ne=function(e){Object(m.a)(n,e);var t=Te(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={value:r.getOutput()},r}return Object(d.a)(n,[{key:"getOutput",value:function(){return this.props.effect.tuningMappings[this.props.input]}},{key:"onUpdateOutput",value:function(e){if(""===e)this.props.effect.tuningMappings[this.props.input]=0,this.setState({value:""});else if("-"===e)this.props.effect.tuningMappings[this.props.input]=0,this.setState({value:"-"});else if("."===e)this.props.effect.tuningMappings[this.props.input]=0,this.setState({value:"."});else if(!Object(Pe.a)(e))return;try{var t=parseFloat(e);this.props.effect.tuningMappings[this.props.input]=t}catch(n){}this.setState({value:e})}},{key:"render",value:function(){var e=this,t=this.props.isLastNote?"note-mapping highlighted":"note-mapping";return i.a.createElement("div",{className:t},i.a.createElement("label",{className:"input-note"},this.props.input,":"),i.a.createElement(xe.g,{value:this.state.value,onChange:function(t){return e.onUpdateOutput(t.target.value)},placeholder:"Output Note",className:"note-mapping-output"}))}}]),n}(a.Component),Re=Object(s.b)(function(e,t){return{lastNotePlayed:e.keyboard.lastNotePlayed}},function(e,t){return{setContextualHelp:function(t){return e(Object(L.ub)(t))}}})(Ce),Me=n(110);function Ae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var qe=function(e){Object(m.a)(n,e);var t=Ae(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement($.a,{condition:this.isEnabled()},i.a.createElement("div",{className:"clear-fix"}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Steps Delay",parameter:this.props.effect.delayTimeParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:64}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Repeats",parameter:this.props.effect.repeatsParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:32}),i.a.createElement(Me.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})))}}]),n}(a.Component),De=(n(2550),Object(s.b)(function(e,t){return{currentStep:t.sequencerEngine.lastTrackStep,every:t.effect.every,offset:t.effect.offset}},function(e){return{}})(function(e){for(var t=e.effect,n=(e.sequencerEngine,e.currentStep,e.every),r=e.offset,a=[],o=0;o<n;o++)a.push(o);var s=t.counter%n-1;return t.counter%n===0&&(s=n-1),i.a.createElement("div",{className:"every-visualizer"},a.map(function(e){return i.a.createElement("div",{className:e===s&&e===r?"step current offset":e===s?"step current":e===r?"step offset":"step"})}))}));function Ie(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var _e=function(e){Object(m.a)(n,e);var t=Ie(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"addParameter",value:function(){this.props.effect.newParameter(),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"getParameterOptions",value:function(){return this.props.effect.getAvailableParameters().map(function(e){return{label:e.name,value:e}})}},{key:"getParameterOption",value:function(e){if(void 0!==e){var t=this.getParameterOptions().filter(function(t){return t.value===e});return t.length>0?t[0]:void 0}}},{key:"handleParameterChange",value:function(e){this.props.effect.parameter=e.value,this.setState(this.state)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"deleteParameterizer",value:function(e){this.props.effect.deleteParameterizer(e),this.setState(this.state)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement($.a,{condition:this.isEnabled()},i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Every",contextualHelp:ee.mb,unit:"th trigger",automation:this.props.automation,parameter:this.props.effect.everyParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:16}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Trigger Offset",contextualHelp:ee.mb,unit:"th trigger",automation:this.props.automation,parameter:this.props.effect.offsetParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:8}),i.a.createElement(De,{effect:this.props.effect,sequencerEngine:this.props.sequencerEngine}),this.props.effect.parameterEffects.map(function(t){return i.a.createElement(re,{isSimple:!0,deleteParameterizer:function(t){return e.deleteParameterizer(t)},effect:t,sequencerEngine:e.props.sequencerEngine})}),i.a.createElement("div",{onClick:function(){return e.addParameter()},className:"add-parameterizer-button"},"Add Parameter")))}}]),n}(a.Component),Fe=Object(s.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(L.ub)(t))}}})(_e);function Le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var Be=function(e){Object(m.a)(n,e);var t=Le(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement($.a,{condition:this.isEnabled()},i.a.createElement("div",{className:"midi-row"},i.a.createElement("div",{className:"midi-col"},i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Duration Factor",parameter:this.props.effect.durationFactorParameter,onParameterChanged:this.props.onParameterChanged,automation:this.props.automation,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:.1,max:2}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Even Delay Time",automation:this.props.automation,parameter:this.props.effect.oddDelayTimeParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:.01,max:16}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Odd Delay Time",automation:this.props.automation,parameter:this.props.effect.evenDelayTimeParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:.01,max:16})),i.a.createElement("div",{className:"midi-col"},i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Repeats",automation:this.props.automation,parameter:this.props.effect.repeatsParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:8}),i.a.createElement(o.a,{effectNumber:this.props.effectNumber,name:"Velocity Spread",automation:this.props.automation,parameter:this.props.effect.velocitySpreadParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:1,max:100}),i.a.createElement(C.a,{name:"Synced",parameter:this.props.effect.syncedParameter})))))}}]),n}(a.Component),ze=Object(s.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(L.ub)(t))}}})(Be),Ve=n(8);function He(e){var t=e.line;if(void 0===t)return i.a.createElement("div",null);var n=Object(a.useCallback)(function(t){console.log("on change value = "+t),e.onChangeValue({brightness:t})},[]),r=t.brightness||1;return i.a.createElement("div",{className:"line-parameters"},i.a.createElement("div",null,"Brightness: ",r),i.a.createElement(H.a,{value:parseFloat(r),change:function(e){return n(e.target.value)},step:.01,max:1,min:0,orientation:"horizontal",reversed:!1}))}var Ue=n(42),Je=10;function Ge(e,t,n){for(var r in e){var a=e[r];if(We(t,n,a.x1,a.y1)<Je)return{x:a.x1,y:a.y1};if(We(t,n,a.x2,a.y2)<Je)return{x:a.x2,y:a.y2}}return{x:t,y:n}}function We(e,t,n,r){return Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))}var Ke=n(29),Xe=new Ke.a,Qe="#eb3434",Ye="#ebe534";function Ze(e){var t=Object(a.useState)(!1),n=Object(r.a)(t,2),o=n[0],s=n[1],c=e.line,u=o||e.isSelected?Ye:Qe;u=Xe.brighten(u,c.brightness||1);var l=Object(a.useCallback)(function(t){t.cancelBubble=!0,e.onClickLine()},[e.onClickLine]),f=Object(a.useCallback)(function(t,n,r){t.cancelBubble=!0,e.onClickPoint(n,r)},[e.onClickPoint]);return i.a.createElement(Ue.Group,null,i.a.createElement(Ue.Line,{onMouseLeave:function(){return s(!1)},onMouseOver:function(){return s(!0)},onMouseDown:l,strokeWidth:10,alpha:.1,stroke:"black",points:[c.x1,c.y1,c.x2,c.y2]}),i.a.createElement(Ue.Line,{onMouseDown:l,strokeWidth:2,stroke:u,points:[c.x1,c.y1,c.x2,c.y2]}),i.a.createElement(Ue.Circle,{onMouseDown:function(e){return f(e,c.x1,c.y1)},x:c.x1,y:c.y1,radius:8,fill:"black"}),i.a.createElement(Ue.Circle,{x:c.x1,y:c.y1,radius:2,fill:"red"}),i.a.createElement(Ue.Circle,{onMouseDown:function(e){return f(e,c.x2,c.y2)},x:c.x2,y:c.y2,radius:8,fill:"black"}),i.a.createElement(Ue.Circle,{x:c.x2,y:c.y2,radius:2,fill:"red"}))}var $e="rgb(2, 30, 11)";function et(e){var t=Array(16).fill(0),n=e.width/16,r=e.width/16;return i.a.createElement(Ue.Group,null,t.map(function(t,r){return i.a.createElement(Ue.Line,{stroke:$e,strokeWidth:1,points:[r*n,0,r*n,e.height]})}),t.map(function(t,n){return i.a.createElement(Ue.Line,{stroke:$e,strokeWidth:1,points:[0,n*r,e.width,n*r]})}))}n(2551);var tt=400,nt=400,rt="PENCIL",at="LINE";function it(e){var t=Object(a.useState)(rt),n=Object(r.a)(t,2),o=(n[0],n[1],Object(a.useState)(void 0)),s=Object(r.a)(o,2),c=s[0],u=s[1],l=Object(a.useState)(void 0),f=Object(r.a)(l,2),h=f[0],p=f[1],d=Object(a.useState)(!1),m=Object(r.a)(d,2),v=m[0],b=m[1],g=Object(a.useState)([]),y=Object(r.a)(g,2),k=y[0],O=y[1],j=Object(a.useState)(at),w=Object(r.a)(j,2),E=w[0],S=w[1],P=Object(a.useState)([]),x=Object(r.a)(P,2),T=x[0],C=x[1],N=Object(a.useCallback)(function(e){S(e)},[S]),R=Object(a.useCallback)(function(e){if(v)if(E===at){var t=Ge(k,e.evt.layerX,e.evt.layerY),n=t.x,r=t.y,a=Object(Ve.a)({},c,{x2:n,y2:r});u(a)}else{var i=e.evt.layerX,o=e.evt.layerY;C([].concat(Object(I.a)(T),[{x:i,y:o}]))}},[v,C,T,E,c,u,k]),M=function(t){e.onLinesChanged(t.map(function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2,i=e.brightness;return{x1:t/nt,y1:n/tt,x2:r/nt,y2:a/tt,brightness:i}}))},A=Object(a.useCallback)(function(e){if(c){var t=[].concat(Object(I.a)(k),[c]);O(t),M(t)}b(!1),u(void 0)},[O,k,b,c,u]),q=Object(a.useCallback)(function(t){O([]),e.onLinesChanged([])},[O]),D=Object(a.useCallback)(function(e){if(void 0!==h){var t=k.indexOf(h);k.splice(t,1),O(k),p(void 0),M(k)}},[O,h,p]),_=Object(a.useCallback)(function(e){if(h)p(void 0);else{var t=Ge(k,e.evt.layerX,e.evt.layerY),n=t.x,r=t.y;u({x1:n,y1:r,x2:n,y2:r}),b(!0)}},[b,u,k,p,h]),F=Object(a.useCallback)(function(e){p(e===h?void 0:e)},[p,h]),L=Object(a.useCallback)(function(e){var t=Object(I.a)(k),n=t.indexOf(h);t[n]=Object(Ve.a)({},h,e),O(t),p(t[n]),M(t)},[p,k,h,O]),B=Object(a.useCallback)(function(e,t,n){var r=Object(Ve.a)({},e);t===e.x1&&n===e.y1&&(r={x1:r.x2,y1:r.y2,x2:r.x1,y2:r.y1});var a=k.indexOf(e);k.splice(a,1),O(k),u(r),b(!0)},[O,u,k,b]);return Object(a.useEffect)(function(){O(e.lines.map(function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2,i=e.brightness;return{x1:nt*t,y1:tt*n,x2:nt*r,y2:tt*a,brightness:i}}))},[e.lines,O]),i.a.createElement("div",{className:"draw-component"},i.a.createElement(Ue.Stage,{onMouseDown:_,onMouseMove:R,onMouseLeave:function(){return b(!1)},onMouseUp:A,width:nt,height:tt},i.a.createElement(Ue.Layer,null,i.a.createElement(Ue.Rect,{x:0,y:0,width:nt,height:tt,fill:"black"}),i.a.createElement(et,{width:nt,height:tt}),T.map(function(e){return i.a.createElement(Ue.Circle,{x:e.x,y:e.y,radius:5,fill:"red"})}),i.a.createElement(st,{currentLine:c}),k.map(function(e){return i.a.createElement(Ze,{onClickPoint:function(t,n){return B(e,t,n)},isSelected:h===e,onClickLine:function(){return F(e)},line:e})}))),i.a.createElement("div",{className:"draw-toolbar"},i.a.createElement(ot,{name:"Line",isSelected:E===at,onClick:function(){return N(at)}}),i.a.createElement(ot,{name:"Pencil",isSelected:E===rt,onClick:function(){return N(rt)}}),i.a.createElement("div",{className:"option",onClick:q},"Clear"),i.a.createElement("div",{className:"option",onClick:D},"Delete")),i.a.createElement(He,{line:h,onChangeValue:L}))}function ot(e){var t="option";return e.isSelected&&(t+=" selected"),i.a.createElement("div",{onClick:e.onClick,className:t},e.name)}function st(e){if(e.currentLine){var t=e.currentLine;return i.a.createElement(Ue.Line,{strokeWidth:2,stroke:"red",points:[t.x1,t.y1,t.x2,t.y2]})}return i.a.createElement(Ue.Circle,{x:0,y:0,radius:1,fill:"black"})}function ct(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var ut=function(e){Object(m.a)(n,e);var t=ct(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement($.a,{condition:this.isEnabled()},i.a.createElement("div",{className:"clear-fix"}),i.a.createElement(it,{lines:this.props.effect.rawLines,onLinesChanged:function(t){return e.props.effect.linesParameter.set(t)}})))}}]),n}(a.Component),lt=Object(s.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(L.ub)(t))}}})(ut),ft=n(249);function ht(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var pt=function(e){Object(m.a)(n,e);var t=ht(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={effect:e.effect},r}return Object(d.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return i.a.createElement("div",null,this.isEnabled()?i.a.createElement("div",null,i.a.createElement(ft.a,{isDraggable:this.props.isDraggable,track:this.props.track,send:this.props.send,compact:this.props.compact,sequencerEngine:this.props.sequencerEngine,effect:this.state.effect})):"")}}]),n}(a.Component),dt=(new Ke.a,Object(s.b)(function(e,t){return{mem:t.effect.mem,trackStep:t.sequencerEngine.trackStep}},function(e){return{}})(function(e){var t=e.effect,n=e.mem,r=e.trackStep,a=e.trackMem,o=(void 0===a&&t.trackMem,e.WIDTH),s=void 0===o?300:o,c=e.HEIGHT,u=void 0===c?100:c,l=Object.keys(n).map(parseFloat),f=Object.values(n).map(parseFloat),h=Math.max.apply(Math,Object(I.a)(l)),p=n.maxTriggers||Math.max.apply(Math,Object(I.a)(f)),d=t.maxLength;h=32*(Math.floor(h/32)+1);var m=l.map(function(e){return{x:5+s*e/h,y:u-(5+u*n[e]/p)}}),v="";m.length>0&&(v="M "+m[0].x+" "+m[0].y+" L "+m.slice(1,h).map(function(e){return e.x+" "+e.y}).join(","));var b={width:s*(r%d/d)};n[r%d];return i.a.createElement("div",{className:"stats-effect"},i.a.createElement("div",{style:b,className:"stat-tick"}),i.a.createElement("svg",{className:"stats-drawer",width:s+10,height:u+10},m.length>1&&i.a.createElement("path",{className:"total-stat",d:v,stroke:"red",fill:"transparent"})))}));function mt(e){function t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.parameter;if(void 0!==t)return{value:t,label:t}}var n=e.className?e.className+" tracks-dropdown-container":"tracks-dropdown-container";return i.a.createElement("div",{className:n},i.a.createElement(O.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:function(){var n=e.parameters.map(function(e){return t(e)});return[{label:"None",value:null}].concat(Object(I.a)(n))}(),onChange:function(t){return e.onSelectParameter(t.value)},value:t(),placeholder:e.placeholder}))}function vt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var a=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var bt=function(e){Object(m.a)(n,e);var t=vt(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"getTrackVariables",value:function(){var e=this,t=this.props.sequencerEngine.tracks;return this.props.effect.trackVariables.map(function(n){return i.a.createElement("div",null,i.a.createElement("div",null,"Track"),i.a.createElement(ve.a,{track:t[n.get()],onSelectTrack:function(e){return n.set(e&&e.trackNumber)},sequencerEngine:e.props.sequencerEngine}))})}},{key:"getCheckboxVariables",value:function(){return this.props.effect.checkboxVariables.map(function(e){return i.a.createElement(C.a,{name:e.name,parameter:e})})}},{key:"getParamVariables",value:function(){var e=this;return this.props.effect.parameterVariables.map(function(t){return i.a.createElement("div",{className:"parameter-dropdown"},i.a.createElement("div",{className:"parameter-dropdown-name"},t.name),i.a.createElement(mt,{parameter:t.get(),parameters:["transpose","velocity","chop","duration"],onSelectParameter:function(e){return t.set(e)},placeholder:t.name,sequencerEngine:e.props.sequencerEngine}))})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,this.getTrackVariables(),this.getParamVariables(),this.getCheckboxVariables(),this.props.effect.variables.map(function(t){return i.a.createElement(o.a,{name:t.name,min:t.min,max:t.max,step:Math.abs(t.min-t.max)<=1?.01:1,parameter:t,lfoEnabled:!0,sequencerEngine:e.props.sequencerEngine,isParameter:!0,effectNumber:e.props.effectNumber})}))}}]),n}(a.Component),gt=Object(s.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(L.ub)(t))}}})(bt),yt=n(373),kt=n(274),Ot=n(167),jt=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.note,o=Object(a.useState)(t.offsets[n]),s=Object(r.a)(o,2),c=s[0],u=s[1],l=Object(a.useCallback)(function(){c||u(t.newNoteOffset(n,0))},[c,u,n]);return c?i.a.createElement("div",{className:"offset-control"},i.a.createElement(Ot.a,{stopPropagation:!1,width:120,parameter:c,root:1.00001})):i.a.createElement("div",{onClick:l,className:"offset-control"},i.a.createElement("div",{className:"hidden-text"},"Click to control offset"))}),wt=n(63),Et=wt.a.fromTranspose,St=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.note,n=e.effect,r=Et(t),a=r.isBlackNote();return i.a.createElement("div",{className:"micro-tuning-note"},i.a.createElement("div",{className:a?"black micro-piano-note":"micro-piano-note"},t%12===0?r.toString():""),i.a.createElement(jt,{note:t,effect:n}))}),Pt=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=Object(a.useState)(t.scriptParameter.get()),o=Object(r.a)(n,2),s=o[0],c=o[1],u=Object(a.useState)(!1),l=Object(r.a)(u,2),f=l[0],h=l[1],p=(Object(a.useCallback)(function(){t.scriptParameter.set(s)},[s]),Object(a.useCallback)(function(e){var n=e.target.value;t.executeScript(n)?(t.scriptParameter.set(n,!0,!1),h(!1)):h(!0),c(n)},[c,h]));return i.a.createElement("div",{className:f?"micro-tuning-function error":"micro-tuning-function"},i.a.createElement("input",{className:"micro-script-input",value:s,type:"text",onChange:p}))}),xt=(n(2552),Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){for(var t=e.effect,n=Object(a.useState)(-32),o=Object(r.a)(n,2),s=o[0],c=(o[1],Object(a.useRef)(void 0)),u=Object(kt.a)({ref:c,effect:t}).preventDragging,l=[],f=s;f<s+64;f++)l.push(f);return i.a.createElement("div",{onMouseDown:function(){return u(!1)},onMouseUp:function(){return u(!0)},ref:c,className:"micro-tuning"},i.a.createElement("div",{className:"notes-container"},l.map(function(e){return i.a.createElement(St,{effect:t,note:e})})),i.a.createElement(Pt,{effect:t}))})),Tt=Object(s.b)(function(e,t){return{step:t.sequencerEngine.trackStep}},function(e){return{}})(function(e){for(var t=e.effect.notes,n=Object.keys(t),r={},a=0,o=n;a<o.length;a++){var s=o[a];r[wt.a.fromTranspose(parseFloat(s)).note]=parseFloat(parseFloat(s)+32)}return i.a.createElement("div",{className:"note-display"},wt.a.NOTES.map(function(e){var t="note";return e.isBlackNote()&&(t+=" black"),r[e.note]&&(t+=" playing"),i.a.createElement("div",{style:{filter:"hue-rotate("+2*r[e.note]+"deg)"},className:t})}))}),Ct=n(5),Nt=n.n(Ct),Rt=n(14),Mt=n(70),At=n(40),qt=n(31),Dt=n(760),It=n(44),_t=n(36),Ft=function(){var e=Object(Rt.a)(Nt.a.mark(function e(t){var n;return Nt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new At.a((new Dt.a).contractAddress).from(qt.h).select("ccNumber").select("parameterName").where("deviceName",t),e.next=3,n.executeQuery();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Lt=Object(s.b)(function(e,t){return{lastMidiCCPlayed:t.effect.id===e.effects.selectedEffect?e.midi.lastMidiCCPlayed:void 0,ccNumber:t.effect.midiCCNumberParameter.get()}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,s=e.effectNumber,c=e.lastMidiCCPlayed,u=Object(a.useState)(t.deviceName),l=Object(r.a)(u,2),f=l[0],h=l[1],p=Object(a.useState)([]),d=Object(r.a)(p,2),m=d[0],v=d[1],b=Object(a.useState)(""),g=Object(r.a)(b,2),y=g[0],k=g[1],j=Object.keys(t.midi.deviceToMidiCC).map(function(e){return{label:e,value:e}});Object(a.useEffect)(function(){f?Ft(f.value||f).then(function(e){return v(e.map(function(e){var t=e.parameterName,n=e.ccNumber;return{label:t+" ("+n+")",value:n}}))}):v([])},[f,v]),Object(a.useEffect)(function(){h(t.deviceName)},[t,h]);var w=Object(a.useCallback)(function(e){t.deviceNameParameter.set(e.value),h(e)},[h]),E=Object(a.useCallback)(function(){c&&(t.midiCCNumberParameter.set(c.number),t.midiCCValueParameter.set(c.value))},[c]),S=Object(a.useCallback)(function(){var e=t.midiCCNumberParameter.get();!function(e,t,n){new Mt.a(It.n,"newMidiCCParameter",[_t.a.utils.fromAscii(e),t,_t.a.utils.fromAscii(n)]).execute()}(t.deviceName,e,y),v([].concat(Object(I.a)(m),[{label:y+" ("+e+")",value:e}]))},[t,y,m,v]),P=Object(a.useCallback)(function(e){t.midiCCNumberParameter.set(e.value)},[]),x=m.find(function(e){return e.value===t.midiCCNumberParameter.get()});return i.a.createElement("div",{className:"midi-cc-effect"},i.a.createElement(O.a,{className:"delay-time-dropdown",options:j,onChange:w,value:f,placeholder:"Device"}),m.length>0?i.a.createElement(O.a,{className:"delay-time-dropdown",options:m,onChange:P,value:x,placeholder:"Choose Midi CC Param"}):"",i.a.createElement(o.a,{effectNumber:s,name:"CC Number",sequencerEngine:n,parameter:t.midiCCNumberParameter,lfoEnabled:!0,isParameter:!0,onParameterChanged:function(){return[]},step:1,max:119,min:0}),i.a.createElement(o.a,{effectNumber:s,name:"Value",sequencerEngine:n,parameter:t.midiCCValueParameter,isParameter:!0,onParameterChanged:function(){return[]},lfoEnabled:!0,step:1,max:128,min:0}),void 0===x&&null!==t.midiCCNumberParameter.get()&&void 0!==t.midiCCNumberParameter.get()?i.a.createElement("div",{className:"midi-cc-name-container"},i.a.createElement("input",{placeholder:"Type parameter name",value:y,type:"text",className:"midi-cc-name",onChange:function(e){return k(e.target.value)}}),i.a.createElement("div",{onClick:S,className:"label-button"},"Save")):"",c?i.a.createElement("div",{onClick:E,className:"midi-cc-info"},i.a.createElement("div",{className:"midi-cc-number"},"Midi CC: ",c.number),i.a.createElement("div",{className:"midi-cc-value"},"Value: ",c.value)):"")}),Bt=n(1505),zt=[3,4,5,6,7,8,9,10,11,12],Vt=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=Object(a.useRef)(void 0),s=Object(a.useState)(t.scale),c=Object(r.a)(s,2),u=c[0],l=c[1],f=Object(a.useState)(t.annotation||""),h=Object(r.a)(f,2),p=h[0],d=h[1],m=Object(a.useCallback)(function(e){var n=e.value,r=u;if(n<u.length)r=r.slice(0,n);else if(n>u.length)for(var a=u.length;a<n;a++)r.push("2/1");l(r),t.scale=r},[l,u,t]),v=Object(a.useCallback)(function(e){var n=e.target.value;d(n),t.annotation=n},[d,t]),b=Object(a.useCallback)(function(e,n){var r=Object(I.a)(u);r[n]=e.target.value,l(r),t.scale=r},[l,t,u]),g=Object(a.useCallback)(function(e){var n=Object(I.a)(t.subset);n[e]?n[e]=!1:n[e]=!0,t.subset=n,l(Object(I.a)(u))},[l,u,t]);return Object(Bt.a)({ref:n,effect:t,setScale:l,setAnnotation:function(e){return v({target:{value:e}})}}),i.a.createElement("div",{ref:n,className:"scale-component"},i.a.createElement("div",{className:"scale-data"},i.a.createElement(O.a,{onChange:m,value:{value:u.length,label:u.length},options:zt.map(function(e){return{label:e,value:e}})}),i.a.createElement(o.a,{parameter:t.referencePitchParameter,isParameter:!0,root:1,min:150,max:400,name:"Reference Pitch",units:"Hz"}),i.a.createElement("div",{className:"scale-notes"},u.map(function(e,n){return i.a.createElement("div",{className:"note-row"},i.a.createElement("div",{onClick:function(){return g(n)},className:t.subset[n]?"note on dot":"note off dot"}),i.a.createElement("input",{className:"scale-note",onChange:function(e){return b(e,n)},value:e}))}))),i.a.createElement(xe.g,{type:"textarea",value:p,className:"comment-text",placeholder:"Write a comment here",onChange:v}))}),Ht=n(187),Ut=Object(s.b)(function(e,t){return{steps:t.effect.stepsParameter.get()}},function(e){return{}})(function(e){var t=e.effect,n=e.steps;"number"===typeof n&&(n=Object(Ht.c)(n));var r=Object(a.useCallback)(function(e,r){var a=Object(I.a)(n);a[e]=!r,t.stepsParameter.set(Object(Ht.b)(a))},[t,n]);return i.a.createElement("div",{className:"gate-steps"},n.map(function(e,t){return i.a.createElement("div",{key:t,onClick:function(){return r(t,e)},className:e?"on gate-step":"gate-step"})}))}),Jt=n(545),Gt=n(638),Wt=n(543),Kt=n(539),Xt=(n(2554),Object(s.b)(function(e,t){return{tidals:t.effect.tidals}},function(e){return{}})(function(e){var t=e.effect,n=e.track,o=e.sequencerEngine,s=Object(a.useState)(void 0),c=Object(r.a)(s,2),u=c[0],l=c[1];return i.a.createElement("div",{onClick:function(){return l(void 0)},className:"jaki"},i.a.createElement("div",null,i.a.createElement(Jt.a,{setChosen:l,chosen:u,effect:t,track:n,sequencerEngine:o}),i.a.createElement(Kt.a,{setChosen:l,chosen:u,effect:t})),i.a.createElement("div",null,i.a.createElement(Wt.a,{setChosen:l,chosen:u,effect:t}),t.tidals&&i.a.createElement(Gt.a,{tidals:t.tidals})))})),Qt=n(393);function Yt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $t=[{label:"==",value:Qt.a},{label:"<=",value:Qt.c},{label:">=",value:Qt.b}],en=Object(s.b)(function(e,t){return{mode:t.effect.conditionalType,parameter:t.effect._parameters[0]}},function(e){return{}})(function(e){var t,n=e.mode,s=e.sequencerEngine,c=e.effect,u=e.isDraggable,l=Object(a.useState)(c._parameters),h=Object(r.a)(l,2),p=h[0],d=(h[1],1),m=0,v=Yt(p.slice(1));try{for(v.s();!(t=v.n()).done;){var b=t.value;b&&(b.min<m&&(m=b.min),b.max>d&&(d=b.max))}}catch(y){v.e(y)}finally{v.f()}var g=c._parameters[0];return i.a.createElement("div",{className:"control-parameters accumulator"},i.a.createElement("div",{className:"acc-column"},i.a.createElement(f.a,{element:c.modeParameter,className:"synced-parameter"},i.a.createElement("span",null,"Condition: "),i.a.createElement(O.a,{placeholder:"C",options:$t,value:$t.find(function(e){return e.value===n}),onChange:function(e){return c.conditionalTypeParameter.set(e.value)}}),i.a.createElement(o.a,{name:"Cond. Value",parameter:c.conditionalValueParameter,isParameter:!0,sequencerEngine:s,lfoEnabled:!0,step:.001,min:g?g.min:0,max:g?g.max:1}),i.a.createElement(o.a,{name:"Then. Value",parameter:c.thenValueParameter,isParameter:!0,sequencerEngine:s,lfoEnabled:!0,step:.001,min:m,max:d}))),i.a.createElement(T.a,{isDraggable:u,effect:c},i.a.createElement(o.a,{name:"Ramp Time",parameter:c.rampTimeParameter,isParameter:!0,sequencerEngine:s,lfoEnabled:!0,unit:"ms",step:1,min:1,max:3e3}),i.a.createElement(C.a,{name:"Reset on step 1",parameter:c.resetAtZeroParameter})))}),tn=n(140),nn=n(395),rn=n(523),an=(n(614),[{label:"1st",value:1},{label:"2nd",value:2},{label:"3rd",value:3},{label:"4th",value:4},{label:"5th",value:5},{label:"6th",value:6},{label:"7th",value:7},{label:"8th",value:8},{label:"9th",value:9},{label:"10th",value:10},{label:"11th",value:11},{label:"12th",value:12},{label:"13th",value:13}]),on=[{label:"Alternate",value:"Alternate"},{label:"Split",value:"Split"}],sn=[{label:"Thick",value:"Thick"},{label:"Flat",value:"Flat"},{label:"Octave",value:"Octave"}],cn=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=Object(a.useState)(void 0),o=Object(r.a)(n,2),s=o[0],c=o[1],u=Object(a.useCallback)(function(e){var n=function(e,t){switch(t){case"Alternate":return new rn.a(e);case"Split":return new nn.b(e)}}(t.track,e.value);h(n)},[t,c]),l=Object(a.useCallback)(function(e){var n,r,a=(n=t.track,r=e.value,new tn.f(n,r));h(a)},[t,c]),f=Object(a.useCallback)(function(e){var n=function(e,t){switch(t){case"Octave":return new tn.c(e);case"Flat":return new nn.a(e);case"Thick":return new nn.c(e)}}(t.track,e.value);h(n)},[t,c]),h=Object(a.useCallback)(function(e){t.chordProgression.addEffect(e),c(e)},[t,c]);return Object(a.useEffect)(function(){s&&c(null)},[c,s]),i.a.createElement("div",{className:"chord-effect-chooser"},i.a.createElement(O.a,{options:an,onChange:l,value:s,placeholder:"Voices"}),i.a.createElement(O.a,{options:sn,onChange:f,value:s,placeholder:"Transforms"}),i.a.createElement(O.a,{options:on,onChange:u,value:s,placeholder:"Flow"}))}),un=n(453),ln=[{label:"Major",value:un.b},{label:"Minor",value:un.c},{label:"Harmonic Minor",value:un.a}],fn=Object(s.b)(function(e,t){return{scale:t.effect.scale}},function(e){return{}})(function(e){var t=e.effect,n=e.scale,r=Object(a.useCallback)(function(e){t.scale=e.value},[t]);return i.a.createElement("div",{className:"scale-chooser"},i.a.createElement("div",{className:"scale-label"},"Scale: "),i.a.createElement(O.a,{className:"osc-type-dropdown float-left",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:ln,onChange:r,value:ln.find(function(e){return e.value===n}),placeholder:"Rate"}))}),hn=(Object(s.b)(function(e,t){return{currentCycles:t.effect.tidals&&t.effect.tidals[0]&&t.effect.tidals[0].currentCycles}},function(e){return{}})(function(e){var t=e.effect,n=e.currentCycles,o=Object(a.useState)(void 0),s=Object(r.a)(o,2),c=s[0],u=s[1],l=Object(a.useState)(void 0),f=Object(r.a)(l,2),h=f[0],p=f[1],d=[];for(var m in n)if(t.tidals[0]){var v=t.tidals[0].cycle.flat(16).map(function(e){return e.id});d.push(v.indexOf(m)%t.expressionSeries.length)}Object(a.useEffect)(function(){return window.addEventListener("keydown",b),function(){return window.removeEventListener("keydown",b)}},[h,u]);var b=Object(a.useCallback)(function(e){"Enter"===e.key&&(t.expressionSeries[c]=h,u(void 0))},[h,u,c]);return Object(a.useEffect)(function(){void 0!==c&&p(t.expressionSeries[c])},[c,p]),void 0!==c?i.a.createElement("div",{className:"expression-series"},i.a.createElement("input",{value:h,onChange:function(e){return p(e.target.value)},type:"text"})):i.a.createElement("div",{className:"expression-series"},t.expressionSeries.map(function(e,t){return i.a.createElement("div",{onClick:function(){return u(t)},className:d.includes(t)?"expression selected":"expression"},e,"th")}))}),Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.chord,r=(e.setNoteSelected,t.getCurrentChordNotes());return i.a.createElement("div",{className:"current-chord-viewer"},"Current Chord: ",i.a.createElement("div",{className:"current-chord"},n.prettyName),r.map(function(e){return i.a.createElement("div",{className:"chord-note"},i.a.createElement("div",{className:"note-name"},wt.a.fromTranspose(e).toString()),i.a.createElement("div",{className:"degree"},t.getNoteDegree(e)))}))})),pn=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.position,n=e.effect,o=(e.chosen,e.currentChord,Object(a.useState)(void 0)),s=Object(r.a)(o,2),c=s[0],u=s[1],l=[],f=n.chordProgression,h=f.getStartingChord(),p=f.getChord(h);l.push(p);for(var d=0;d<n.progressionLength-1;d++)if(void 0!==h){var m=f.getNextChordEffect(h,d);m&&(l.push(m),h=m.numeral)}Object(a.useEffect)(function(){t===c&&u(void 0)},[t,u,c]);var v=Object(a.useCallback)(function(e,t){n.position=t-1,n.position<0&&(n.position=n.progressionLength-1),n.currentChord=e.numeral,u(t)},[u,n]),b=Object(a.useCallback)(function(e){var n="chord-part";return void 0===c&&t===e&&(n+=" current"),c===e&&(n+=" selected"),n},[t,c]);return i.a.createElement("div",{className:"progression"},l.map(function(e,t){return i.a.createElement("div",{onClick:function(){return v(e,t)},className:b(t)},e.prettyName)}))}),dn=(Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=Object(a.useState)(t.tidalString),o=Object(r.a)(n,2),s=o[0],c=o[1];Object(a.useEffect)(function(){return window.addEventListener("keydown",u),function(){return window.removeEventListener("keydown",u)}},[s,t]);var u=Object(a.useCallback)(function(e){"Enter"===e.key&&f()},[s,t]),l=Object(a.useCallback)(function(e){c(e.target.value)},[c]),f=Object(a.useCallback)(function(){t.tidalString=s},[s,t]);return i.a.createElement("div",{className:"tidal-string"},i.a.createElement("input",{value:s,onChange:l,type:"text",className:"tidal-input"}),i.a.createElement("div",{className:"Enter",onClick:f},"Enter"))}),function(e){var t=e.onClick,n=(e.currentChord,e.isSelected),r=e.possibleChord,a="possible-next";return n&&(a+=" selected"),i.a.createElement("div",{onClick:t,className:a},r.prettyName)}),mn=Object(s.b)(function(e,t){return{position:t.effect.position,currentChord:t.effect.currentChord}},function(e){return{}})(function(e){var t=e.effect,n=e.position,s=e.currentChord,c=t.chordProgression,u=t.getPossibleNextChords().map(function(e){return c.getChord(e)}),l=c.getChord(s),f=Object(a.useState)(c.getNextChordEffect(s,n)),h=Object(r.a)(f,2),p=h[0],d=h[1];Object(a.useEffect)(function(){var e=c.getNextChordEffect(s,n);d(e)},[s,n,u,d]);var m=Object(a.useCallback)(function(e){l.nextChords[n]=e,d(e)},[l,n,d]);return i.a.createElement("div",{draggable:"true",onDragStart:function(e){return e.preventDefault()},className:"chord-chooser"},i.a.createElement(pn,{position:n,effect:t,currentChord:s,chosen:p}),i.a.createElement(hn,{effect:t,chord:l}),i.a.createElement("div",{className:"possibilities"},i.a.createElement("div",{className:"possibility-label"},"Next Chord: "),u.map(function(e){return i.a.createElement(dn,{isSelected:p===e,onClick:function(){return m(e)},currentChord:l,possibleChord:e})})),i.a.createElement(o.a,{parameter:t.progressionLengthParameter,min:1,max:16,step:1,name:"Length",isParameter:!0,lfoEnabled:!0,sequencerEngine:t.track.sequencerEngine}),i.a.createElement(o.a,{parameter:t.chordProgression.progressionStartParameter,min:1,max:7,step:1,name:"Start",isParameter:!0,lfoEnabled:!0,sequencerEngine:t.track.sequencerEngine}))}),vn=(n(2555),Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=t.track,r=t.chordProgression;return i.a.createElement("div",{className:"generative-chords"},i.a.createElement("div",null,i.a.createElement(fn,{effect:t}),i.a.createElement(ft.a,{effect:r,track:n,sequencerEngine:n.sequencerEngine}),i.a.createElement(cn,{effect:t})),i.a.createElement(mn,{effect:t}))})),bn=(n(247),Object(a.memo)(function(e){var t=Object(a.useState)(!1),n=Object(r.a)(t,2),o=n[0],s=n[1],p=Object(a.useRef)(void 0),d=Object(a.useCallback)(function(){return"Arpeggiator"===e.effect.name?i.a.createElement(x,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Parameterizer"===e.effect.name?i.a.createElement(re,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Accumulator"===e.effect.name?i.a.createElement(D,{isDraggable:e.isDraggable,effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Control Parameters"===e.effect.name?i.a.createElement(F,{isDraggable:e.isDraggable,effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Conditional Parameters"===e.effect.name?i.a.createElement(en,{isDraggable:e.isDraggable,effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Plane Parameters"===e.effect.name?i.a.createElement(Z,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Every"===e.effect.name?i.a.createElement(Fe,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Timing"===e.effect.name?i.a.createElement(se,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi Outputter"===e.effect.name?i.a.createElement(ge,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi Interface"===e.effect.name?i.a.createElement(je,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Harmony"===e.effect.name?i.a.createElement(Se,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Alternate Tuning"===e.effect.name?i.a.createElement(Re,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Micro Tuning"===e.effect.name?i.a.createElement(xt,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Warp"===e.effect.name?i.a.createElement(pe,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Flush"===e.effect.name?i.a.createElement(c,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Message"===e.effect.name?i.a.createElement(u.a,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi Delay"===e.effect.name?i.a.createElement(qe,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Chord Rhythm"===e.effect.name?i.a.createElement(ze,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Chord Sculptor"===e.effect.name?i.a.createElement(lt,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Tidal"===e.effect.name?i.a.createElement(de.a,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Linked Tidal"===e.effect.name?i.a.createElement(me,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Scale"===e.effect.name?i.a.createElement(Vt,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi Effect Rack"===e.effect.name?i.a.createElement(pt,{isDraggable:e.isDraggable,effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Limit"===e.effect.name?i.a.createElement(le,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi Gate"===e.effect.name?i.a.createElement(Ut,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"User Script"===e.effect.name?i.a.createElement(yt.a,{isDraggable:e.isDraggable,setExpanded:s,expanded:o,effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,doc:l.a,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi CC"===e.effect.name?i.a.createElement(Lt,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Note Display"===e.effect.name?i.a.createElement(Tt,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Jaki"===e.effect.name?i.a.createElement(Xt,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Generative Chords"===e.effect.name?i.a.createElement(vn,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Stats"===e.effect.name?i.a.createElement(dt,Object.assign({effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect},e)):e.effect.isScript?i.a.createElement(gt,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):[]},[o,s,e.effect]);return i.a.createElement(f.a,{refObj:p,className:"midi-effect-container",element:e.effect},i.a.createElement(h.a,Object.assign({},e,{onDeleteEffect:e.onDeleteEffect,isMidiEffect:!0,effectNumber:e.effectNumber,onToggle:function(){return[]},track:e.track,effect:e.effect,automation:e.automation}),d()))}));t.a=bn},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r="PIANO_ROLL",a="EFFECTS"},function(e,t,n){"use strict";n.d(t,"d",function(){return y}),n.d(t,"e",function(){return k}),n.d(t,"c",function(){return O}),n.d(t,"b",function(){return j}),n.d(t,"a",function(){return w}),n.d(t,"f",function(){return x});var r=n(5),a=n.n(r),i=n(14),o=n(15),s=n.n(o),c=n(219),u=n(198),l=n(6),f=(n(30),n(254)),h=n(349),p=n(898),d=(n(447),n(661)),m=n(183);n(75);function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=["A","B","C","D"],y=function(e,t){return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return 48,n.t0=r,n.next=4,E({sequencerEngine:e,lenInBars:48,track:t,numPatterns:t.patterns.length,bounceType:"BOUNCE_INSTRUMENT",download:!1});case 4:n.t1=n.sent,(0,n.t0)(n.t1),e.subSequences.forEach(function(e){return e.mix.updateAllTypeRedux()});case 7:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())},k=function(e,t){return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(s in o=0,t.patterns)o+=x(e,parseInt(s),[t])/32;return o*=e.state.freeze.loops,n.t0=r,n.next=6,E({sequencerEngine:e,lenInBars:o,track:t,numPatterns:t.patterns.length,bounceType:"BOUNCE_PATTERNS",download:!1});case 6:n.t1=n.sent,(0,n.t0)(n.t1),e.subSequences.forEach(function(e){return e.mix.updateAllTypeRedux()});case 9:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())},O=function(e,t){return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s,c;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(c in o=0,s=t.slots.filter(function(e){return e}),console.log("bouncepad tracks = ",s),s[0].patterns)o+=x(e,parseInt(c),s)/32;return o*=e.state.freeze.loops,n.t0=r,n.next=8,E({sequencerEngine:e,lenInBars:o,pad:t.id,numPatterns:s[0].patterns.length,subSequence:e.currentSubSequence,bounceType:"BOUNCE_PATTERNS",download:!1,includeSends:!0,tracks:s});case 8:n.t1=n.sent,(0,n.t0)(n.t1),e.subSequences.forEach(function(e){return e.mix.updateAllTypeRedux()});case 11:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())},j=function(e,t){return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(s in o=0,t.tracks[0].patterns)o+=x(e,parseInt(s),t.tracks)/32;return o*=e.state.freeze.loops,n.t0=r,n.next=6,E({sequencerEngine:e,lenInBars:o,group:t.groupNumber.toString(),numPatterns:t.tracks[0].patterns.length,subSequence:e.currentSubSequence,bounceType:"BOUNCE_PATTERNS",download:!1,includeSends:!0,tracks:t.tracks});case 6:n.t1=n.sent,(0,n.t0)(n.t1),e.subSequences.forEach(function(e){return e.mix.updateAllTypeRedux()});case 9:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.b,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise(function(){var o=Object(i.a)(a.a.mark(function i(o,s){var c,u,f,p,d,m,b,y,k,O,j,w;return a.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(c=e.state.sequencer.sequenceName,n!==h.b){i.next=6;break}return i.next=4,E({title:c,sequencerEngine:e,lenInBars:t,uploadToIpfs:r});case 4:return o(),i.abrupt("return");case 6:u=e.sends.sends.length,f=v(e.subSequences);try{for(f.s();!(p=f.n()).done;)d=p.value,u+=d.groups.groups.length}catch(s){f.e(s)}finally{f.f()}m=0,b=v(e.subSequences),i.prev=11,b.s();case 13:if((y=b.n()).done){i.next=27;break}k=y.value,O=k.groups,i.t0=a.a.keys(O.groups);case 17:if((i.t1=i.t0()).done){i.next=25;break}return j=i.t1.value,e.dispatch(Object(l.yb)("Group "+(parseInt(j)+1)+" ("+k.name+")",m,u)),i.next=22,E({title:c,sequencerEngine:e,lenInBars:t,subSequence:k,group:j,uploadToIpfs:r});case 22:m++,i.next=17;break;case 25:i.next=13;break;case 27:i.next=32;break;case 29:i.prev=29,i.t2=i.catch(11),b.e(i.t2);case 32:return i.prev=32,b.f(),i.finish(32);case 35:i.t3=a.a.keys(e.sends.sends);case 36:if((i.t4=i.t3()).done){i.next=44;break}return w=i.t4.value,e.dispatch(Object(l.yb)("Send "+g[w],m,u)),i.next=41,E({title:c,sequencerEngine:e,lenInBars:t,send:parseInt(w),uploadToIpfs:r});case 41:m++,i.next=36;break;case 44:o();case 45:case"end":return i.stop()}},i,null,[[11,29,32,35]])}));return function(e,t){return o.apply(this,arguments)}}())},E=function(e){var t=e.title,n=e.sequencerEngine,r=e.lenInBars,o=void 0===r?4:r,c=e.subSequence,u=e.group,h=e.pad,b=e.numPatterns,y=e.send,k=e.download,O=void 0===k||k,j=e.track,w=e.bounceType,E=e.includeSends,x=void 0!==E&&E,R=e.tracks,M=e.uploadToIpfs;return new Promise(function(e){var r,k=o*new s.a.Time("1n").toMilliseconds()/1e3;n.stop(),s.a.Offline(function(e){(r=new p.default(n.store,!0,e,n.aubio,!0,!0)).isOffline=!0,console.log("offline",r),n.store.dispatch(Object(l.Bd)(r)),window.sequencerEngine=r,n.store.dispatch(Object(l.Hc)(!0));var t=new d.a(r);for(var a in w||(r.mix=n.mix),r.setScripting(t),r.bpm=n.bpm,r.bpmParameter.id=n.bpmParameter.id,r.bpmParameter.min=n.bpmParameter.min,r.bpmParameter.max=n.bpmParameter.max,r.sends.copyFrom(n.sends),w||r.channelMixer.masterChannel.copyFrom(n.channelMixer.masterChannel),void 0!==y&&r.sends.sends.filter(function(e,t){return t!==y}).forEach(function(e){e.outputVolume.disconnect()}),void 0===u&&void 0===j||x||r.sends.sends.forEach(function(e){return e.outputVolume.disconnect()}),n.switchToSubSequence(n.subSequences[0].id),r.subSequences[0].id=n.subSequences[0].id,n.subSequences)if((!c||c.id===n.subSequences[a].id)&&(!j||n.subSequences[a].tracks.some(function(e){return e.id===j.id}))){if(a>0){var i=r.newSubSequence();i.id=n.subSequences[a].id,r.switchToSubSequence(i.id),n.switchToSubSequence(i.id)}r.currentSubSequence.midiEffects.fromJson(n.currentSubSequence.midiEffects.getJson()),r.lfos.forEach(function(e,t){return e.lfo.fromJson(n.lfos[t].lfo.getJson())}),r.envelopes.forEach(function(e,t){return e.fromJson(n.envelopes[t].getJson())}),"BOUNCE_PATTERNS"===w?T(n,b,r.currentSubSequence.mix,u||h?R:[j]):"BOUNCE_INSTRUMENT"===w?N(n,b,r.currentSubSequence.mix,u?R:[j]):r.currentSubSequence.mix=n.currentSubSequence.mix;var o=n.groups;for(var s in o.groups){var f=o.groups[s];if(void 0!==y&&f.tracks.every(function(e){return e.sendNodeVolumeParameters[y].get()<=-80&&Object.values(e.sendNodeVolumeParameters[y]).every(function(e){return e<=-80})}),void 0===u||s===u||!f.tracks.every(function(e){return 0===e.connectedEnvelopes.length})){var m=r.groups.newGroup();if(m.setVolume(f.volume),m.setPanning(f.panning),void 0===j||f===j.group||!f.tracks.every(function(e){return 0===e.connectedEnvelopes.length})){var g=f.effectsChain.effects.map(function(e){return e.getEffectCopy(r,!1)});for(var k in m.effectsChain.updateEffects(g),f.tracks){var O=f.tracks[k].getCopy(void 0,r,!1);!h||f.tracks[k].pad&&f.tracks[k].pad.id===h?j&&f.tracks[k]!==j&&0==f.tracks[k].connectedEnvelopes.length||(console.log("ADDING TRACK TO BOUNCE ENGINE =",O),r.setupNewTrack(O,void 0,void 0,!1,!0),O.setupEffects(),m.addTrack(O),O.trackNumber=f.tracks[k].trackNumber,j&&f.tracks[k]!==j&&O.gainNode.disconnect(),"BOUNCE_INSTRUMENT"===w&&C(O)):(console.log("BOUNCE PAD NOT MATCH"),console.log("track.pad=",f.tracks[k].pad,h))}void 0!==y&&m.outputNode.disconnect(),void 0!==u&&(r.currentSubSequence.id===c.id&&u===s||m.outputNode.disconnect())}}}r.tracks.sort(function(e,t){return e.trackNumber-t.trackNumber}),r.currentSubSequence.loadPadsJson(n.currentSubSequence.getPadsJson())}r.loadInletConnections(n.state.windows.inletConnections),r.higherOrderSequencer.fromJson(n.higherOrderSequencer.getJson());var E,S=v(r.subSequences);try{for(S.s();!(E=S.n()).done;){E.value.loadLostParameters(!0)}}catch(P){S.e(P)}finally{S.f()}console.log("PLAYING"),r.loadNewSequence(),r.play()},k).then(function(){var o=Object(i.a)(a.a.mark(function i(o){var s,h;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(new m.a(2,function(t,n,a){e(r),window.open("http://zequencer.io:8080/ipfs/"+n,"_blank")}),s="Exported Song.wav",void 0!==y&&(s="Send "+g[y]+".wav"),void 0!==u&&(s="Group "+(parseInt(u)+1)+" ("+c.name+").wav"),t&&(s=t+" "+s),!M){a.next=10;break}return a.next=8,P(o);case 8:a.next=16;break;case 10:if(!O){a.next=16;break}return h=[o.getChannelData(0),o.getChannelData(1)],a.next=14,Object(f.a)(h);case 14:h=a.sent,S(h,s);case 16:n.store.dispatch(Object(l.Hc)(!1)),r.stop(),window.sequencerEngine=n,n.store.dispatch(Object(l.Bd)(void 0)),r.dispose(),n.updateSteps(),e(o);case 23:case"end":return a.stop()}},i)}));return function(e){return o.apply(this,arguments)}}())})},S=function(){var e=document.createElement("a");return document.body.appendChild(e),e.style="display: none",function(t,n){var r=new Blob([t],{type:"audio/wav"}),a=window.URL.createObjectURL(r);e.href=a,e.download=n,e.click(),window.URL.revokeObjectURL(a)}}(),P=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new m.a(2,function(e,t,n){return[]}),e.next=3,n.uploadBufferToIpfs(t);case 3:r=e.sent,window.exportIpfsHash=r;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),x=function(e,t,n){var r,a=-10,i=v(n);try{for(i.s();!(r=i.n()).done;){var o,s=v(r.value.patterns);try{for(s.s();!(o=s.n()).done;){var c=o.value.length();c>a&&(a=c)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){i.e(u)}finally{i.f()}return a},T=function(e,t,n,r){for(var a=e.state.freeze.loops,i=0,o=0;o<t;o++){var s=x(e,o,r)*a,l=new u.a(o);l.step=i,n.dispatch(Object(c.h)(l,s)),i+=s}},C=function(e){var t=e.pattern;t.doubleTrackLength(),e.patterns=[];for(var n=0;n<24;n++){var r=t.getCopy();r.clear(),r.addNote(0,16,3*n-12),e.patterns.push(r)}e.pattern=e.patterns[0]},N=function(e,t,n,r){e.state.freeze.loops;for(var a=0,i=0;i<32;i++){var o=new u.a(i);o.step=a,n.dispatch(Object(c.h)(o,64)),a+=64}}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),a=function(e){var t=e.containerRef;return{getXY:Object(r.useCallback)(function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];window._scale;if(!t||!t.current)return{x:0,y:0};var r=t.current.getBoundingClientRect(),a=n?t.current.scrollLeft:0,i=n?t.current.scrollTop:0;return{x:e.clientX-r.left+a,y:e.clientY-r.top+i}},[])}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"f",function(){return u});var r=n(111),a=function(e,t){var n=e.trackNumber+1+e.subSequence.name.toLowerCase()+".trigger";Object(r.b)(n,t.stepData)},i=function(e,t,n){Object(r.b)("roll",{rolling:e,resolution:t,isTriplet:n})},o=function(e,t){var n="pattern-switch."+e.name;Object(r.b)(n,t+1),n="pattern-switch",Object(r.b)(n,t+1)},s=function(e){Object(r.b)("planar-bounce",e)},c=function(e){Object(r.b)("notes-down",e)},u=function(e){Object(r.b)("trigger-count",e)}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(535);n(1373);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"parameterMods",get:function(){var e=[];return this.props.parameters.forEach(function(t){return e=e.concat(t.parameterMods)}),e}},{key:"render",value:function(){return u.a.createElement("div",null,this.parameterMods.map(function(e,t){return u.a.createElement(l.a,{key:"mod-"+t+"-"+e.parameter.id,parameterMod:e})}))}}]),n}(c.Component);t.a=h},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(9),s=n(2),c=n(4),u=n(75),l=n(30),f=(n(311),n(346)),h=n(420),p=n(45),d=function(){function e(t,n){Object(s.a)(this,e),this.id=Object(p.uuid)(),this.sample=t,this.sequencerEngine=n,this.searcher=new h.a(n.ethereumCache,n),this.nextSounds=[],this.previousSounds=[],this.counter=0,this._tagSounds=void 0}return Object(c.a)(e,[{key:"length",get:function(){return this._sounds&&this._sounds.length}},{key:"sounds",get:function(){return this._tagSounds||this._sounds},set:function(e){this._sounds=e}},{key:"tagSounds",set:function(e){this.nextSounds=[],this.previousSounds=[],this._tagSounds=e}},{key:"getCopy",value:function(){var t=new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sample,this.sequencerEngine);return t.searcher=this.searcher,this.sounds&&(t.sounds=Object(o.a)(this.sounds)),t.tags=this.tags,t.initBuffers(),t}},{key:"fetch",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sample&&this.sample.tags){e.next=2;break}return e.abrupt("return");case 2:return t=this.sample.tags,e.next=5,l.a.getGuildsWithAccess();case 5:return n=e.sent,e.next=8,Object(f.a)(t,n);case 8:r=e.sent,this.sounds=r,this.tags=t;case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"hasNext",value:function(){return void 0===this.sounds||this.nextSounds.length>0}},{key:"hasPrevious",value:function(){return void 0===this.sounds||this.previousSounds.length>0}},{key:"dispose",value:function(){this.nextSounds&&this.nextSounds.forEach(function(e){return e.dispose(!0)}),this.previousSounds&&this.previousSounds.forEach(function(e){return e.dispose(!0)}),this.sounds=void 0,this.nextSounds=void 0,this.previousSounds=void 0,this.sample&&(this.sample.dispose(!0),this.sample=void 0),this.searcher=void 0}},{key:"search",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.sample.tags,this.tags=t,this.searcher.selectedTags=t,e.next=5,Object(f.a)(t);case 5:this.sounds=e.sent.slice(1),this.counter=0,this.initBuffers();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initBuffers",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.sounds&&void 0!==this.nextSounds){e.next=2;break}return e.abrupt("return");case 2:this.loading=!0,this.sounds.length,t=0;case 5:if(!(this.nextSounds.length<1)){e.next=25;break}return e.prev=6,e.next=9,this.loadNextForInitialBuffer(t);case 9:n=e.sent,r=n.next,i=n.previous,this.nextSounds.push(r),this.previousSounds.push(i),e.next=20;break;case 16:if(e.prev=16,e.t0=e.catch(6),!(t>=12)){e.next=20;break}return e.abrupt("break",25);case 20:if(t++,void 0!==this.nextSounds){e.next=23;break}return e.abrupt("break",25);case 23:e.next=5;break;case 25:this.loading=!1;case 26:case"end":return e.stop()}},e,this,[[6,16]])}));return function(){return e.apply(this,arguments)}}()},{key:"loadNextForInitialBuffer",value:function(e){var t=this;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s,c,l,f;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return setTimeout(function(){i()},7e3),n.prev=1,o=t.sounds.length,s=(t.counter+e)%o,c=t.sounds[s],l=new u.a(c),n.next=8,l.load();case 8:return s=((t.counter-e-1)%o+o)%o,c=t.sounds[s],f=new u.a(c),n.next=13,f.load().catch(i);case 13:r({next:l,previous:f}),n.next=19;break;case 16:n.prev=16,n.t0=n.catch(1),i();case 19:case"end":return n.stop()}},n,null,[[1,16]])}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"sleep",value:function(e){return new Promise(function(){var t=Object(i.a)(a.a.mark(function t(n,r){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:setTimeout(function(){return n()},e);case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getNext",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.sounds){e.next=3;break}return e.next=3,this.search();case 3:if(!this.loading){e.next=8;break}return e.next=6,this.sleep(50);case 6:e.next=3;break;case 8:return t=this.nextSounds.shift(),setTimeout(function(){n.loadNext(t)},100),e.abrupt("return",t);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getPrevious",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.sounds){e.next=3;break}return e.next=3,this.search();case 3:if(!this.loading){e.next=8;break}return e.next=6,this.sleep(50);case 6:e.next=3;break;case 8:return t=this.previousSounds.shift(),this.loadPrevious(t),e.abrupt("return",t);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"seek",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.counter=t,e.next=3,this.loadNextAvailableSample();case 3:return n=e.sent,this.nextSounds=[n],e.next=7,this.getNext();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadNext",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,s,c=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,setTimeout(function(){n||(c.loading=!1)},7e3),this.loading=!0,(r=this.previousSounds.pop())&&r.dispose(!0),this.previousSounds=[this.sample].concat(Object(o.a)(this.previousSounds)),this.sample=t,!0,i=void 0,s=0;case 10:if(void 0!==i){e.next=26;break}return e.prev=11,e.next=14,this.loadNextAvailableSample();case 14:i=e.sent,e.next=23;break;case 17:if(e.prev=17,e.t0=e.catch(11),!(s>=12)){e.next=23;break}return this.loading=!1,n=!0,e.abrupt("return");case 23:s++,e.next=10;break;case 26:this.nextSounds.push(i),this.loading=!1,n=!0;case 29:case"end":return e.stop()}},e,this,[[11,17]])}));return function(t){return e.apply(this,arguments)}}()},{key:"loadNextAvailableSample",value:function(){var e=this;return new Promise(function(){var t=Object(i.a)(a.a.mark(function t(n,r){var i,o,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.counter=(e.counter+1)%e.sounds.length,i=(e.counter+1)%e.sounds.length,o=e.sounds[i],s=new u.a(o),setTimeout(function(){r()},7e3),t.prev=5,t.next=8,s.load();case 8:n(s),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),r();case 14:case"end":return t.stop()}},t,null,[[5,11]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"loadPrevious",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,(n=this.nextSounds.pop())&&n.dispose(!0),this.nextSounds=[this.sample].concat(Object(o.a)(this.nextSounds)),this.sample=t,this.counter=this.mod(this.counter-1,this.sounds.length),r=this.mod(this.counter-1,this.sounds.length),i=this.sounds[r],s=new u.a(i),e.next=11,s.load();case 11:this.previousSounds.push(s),this.loading=!1;case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"mod",value:function(e,t){return(e%t+t)%t}}]),e}();t.a=d},function(e,t,n){"use strict";function r(e){return Math.pow(10,.05*e)}function a(e){return 20*Math.log(e)/Math.LN10}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a})},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return o});var r="NW",a="NE",i="SE",o="SW"},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r="POST_FX",a="PRE_FX"},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r="MASTER",a="SENDS_ONLY"},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r="RANDOMIZE",a="ACCUMULATE",i="NONE"},,,function(e,t,n){"use strict";n.d(t,"h",function(){return a}),n.d(t,"i",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"k",function(){return l}),n.d(t,"m",function(){return f}),n.d(t,"c",function(){return h}),n.d(t,"e",function(){return p}),n.d(t,"j",function(){return d}),n.d(t,"o",function(){return m}),n.d(t,"l",function(){return v}),n.d(t,"d",function(){return b}),n.d(t,"n",function(){return g});var r=n(133),a=function(e,t){return{type:r.h,payload:{event:e,duration:t}}},i=function(e,t){return{type:r.i,payload:{event:e,duration:t}}},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:r.b,payload:{event:e,inPlace:t}}},s=function(e,t){return{type:r.a,payload:{event:e,subEvent:t}}},c=function(e,t){return{type:r.g,payload:{event:e,resolution:t}}},u=function(e,t){return{type:r.f,payload:{event:e,pattern:t}}},l=function(e,t){return{type:r.k,payload:{event:e,newStep:t}}},f=function(e,t,n,a){return{type:r.m,payload:{step:e,selection:t,eventType:n,track:a}}},h=function(e){return{type:r.c,payload:{selection:e}}},p=function(e,t){return{type:r.e,payload:{selection:e,eventType:t}}},d=function(e,t,n){return{type:r.j,payload:{track:e,pattern:t,startStep:n}}},m=function(e,t,n){return{type:r.o,payload:{track:e,pattern:t,step:n}}},v=function(e,t,n){return{type:r.l,payload:{track:e,pattern:t,step:n}}},b=function(e,t){return{type:r.d,payload:{track:e,pattern:t}}},g=function(e,t,n){return{type:r.n,payload:{pattern:e,direction:t,resizedStep:n}}}},function(e,t,n){"use strict";var r=n(0),a=n.n(r);n(12);t.a=function(e){for(var t=e.markerEnd,n=void 0===t?"url(#arrowhead)":t,r=e.points,i=e.onMouseOver,o=e.onMouseDown,s=e.className,c=void 0===s?"":s,u=e.onMouseLeave,l=(e.fill,e.opacity),f=(e.stroke,e.strokeWidth),h=e.segmentation,p=function(e){return Math.floor(e)},d="M "+p(r[0])+" "+p(r[1]),m="",v=2;v<r.length-1;v+=2)m+=p(r[v])+" "+p(r[v+1])+" ";var b=d+" "+(h?"Q":"C")+" "+m;return a.a.createElement("path",{className:c,onMouseDown:o,onMouseOver:i,onMouseLeave:u,d:b,strokeWidth:f,opacity:l,markerEnd:n})}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(15),a=n.n(r),i=new(n(33).a)(32,!1),o={};function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=o[e];if(void 0!==r){var s=r[t.toString()];if(void 0!==s)return s}else o[e]={};var c=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.transformStepAtResolution2(e,i),o=t.transformStepAtResolution2(e+1,i),s=new Set;Math.floor(r)==r?s.add(r):o-r>1&&s.add(Math.ceil(r));n?Math.floor(o)>=Math.floor(r)&&Math.floor(o)!=o&&s.add(Math.floor(o)):Math.floor(o)>Math.floor(r)&&Math.floor(o)!=o&&s.add(Math.floor(o));s=Array.from(s);for(var c=[],u=0;u<s.length;u++){var l=s[u],f=i.transformStepAtResolution2(l,t),h=f-e;c.push({step:l,time:new a.a.Time("32n")*h})}return c}(e,t,n);return o[e][t.toString()]=c,c}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="NOT_UPLOADED_YET"},function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return u});n(9);var r=Math.pow(2,-32),a=32557,i=new Uint16Array(4),o=new DataView(i.buffer),s=function(){var e=i[0],t=i[1],n=i[2],o=i[3],s=33103+a*e|0,c=63335+a*t+(19605*e+(s>>>16))|0,u=31614+a*n+19605*t+(62509*e+(c>>>16))|0,l=5125+a*o+(19605*n+62509*t)+(22609*e+(u>>>16));i[0]=s,i[1]=c,i[2]=u,i[3]=l;var f=(o<<21)+((o>>2^n)<<5)+((n>>2^t)>>11);return r*((f>>>(o>>11)|f<<(31&-(o>>11)))>>>0)},c=function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=16,a=1540483477,i=e.length,o=n^i,s=0;i>=4;)t=(65535&(t=255&e[s]|(255&e[++s])<<8|(255&e[++s])<<16|(255&e[++s])<<24))*a+(((t>>>r)*a&65535)<<r),o=(65535&o)*a+(((o>>>r)*a&65535)<<r)^(t=(65535&(t^=t>>>24))*a+(((t>>>r)*a&65535)<<r)),i-=4,++s;switch(i){case 3:o^=(255&e[s+2])<<r;case 2:o^=(255&e[s+1])<<8;case 1:o=(65535&(o^=255&e[s]))*a+(((o>>>r)*a&65535)<<r)}return o=(65535&(o^=o>>>13))*a+(((o>>>r)*a&65535)<<r),(o^=o>>>15)>>>0},u=function(e){!1,null;for(var t=~~((e.length-2)/2),n=[],r=0;r<t;r++){var a=2+2*r;n.push(parseInt(e.slice(a,a+2),16))}var i=c(n,1690382925),s=c(n,72970470);o.setUint32(0,i),o.setUint32(4,s)}},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return i});var r="MIX",a="ALTERNATE",i="ROUND_ROBIN"},function(e,t,n){"use strict";n.d(t,"i",function(){return r}),n.d(t,"h",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"f",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"g",function(){return l}),n.d(t,"a",function(){return f});var r="PADS",a="KEYBOARD",i=118,o=119,s=117,c=116,u=115,l=64,f=1},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i});var r="ALL",a="COMPUTER_KEYBOARD",i="CUSTOM"},,,,,,function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(56),f=n(32),h=n(15),p=n.n(h),d=n(41);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Delay",function(){return new p.a.FeedbackDelay(new p.a.Time("16n"),.5)},e)).delayTime="16n",r.rateParameter=new d.a("Delay Rate",r.effectNode.delayTime,function(e,t){r.rawDelayRate=t,"number"===typeof t&&(t/=1e3),t._val&&(t="object"==typeof t._val?new p.a.Time(t._val._val):new p.a.Time(t._val)),r.effectNode.delayTime.linearRampToValueAtTime(new p.a.Time(t),.001)},{documentation:"The time between each individual echo",min:1e-4,max:1,unit:"",defaultValue:new p.a.Time("8n")}),r.rawDelayRate="8n",r.isSynced=!0,r.registerParameter(r.rateParameter),r.feedbackParameter=new d.b("Feedback",r.effectNode.feedback),r.registerParameter(r.feedbackParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"documentation",get:function(){return"A basic echo effect."}},{key:"rate",get:function(){return this.rateParameter.get(!0)},set:function(e){this.rateParameter.set(e)}},{key:"setFeedback",value:function(e){this.feedbackParameter.set(e)}},{key:"getFeedback",value:function(){return this.effectNode?this.effectNode.feedback.value:0}},{key:"onBPMUpdated",value:function(){this.isSynced&&this.rateParameter.set(this.rawDelayRate,!0)}},{key:"getDelayTime",value:function(){return this.delayTime}},{key:"getJson",value:function(){var e=this.rate;"object"===typeof e&&e.toSeconds&&(e=this.rate.toSeconds());var t=Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{name:this.name,enabled:this.enabledParameter.get(),feedback:this.effectNode.feedback.value,isSynced:this.isSynced,rate:e,rawDelayRate:this.rawDelayRate});return t=this.saveParameterToJson(t,"feedbackParameter",this.feedbackParameter),t=this.saveParameterToJson(t,"rateParameter",this.rateParameter)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return"feedback"in e&&Object(f.a)(this.feedbackParameter,e.feedback,a),"delayTime"in e&&Object(f.a)(this.rateParameter,e.delayTime,a),"rate"in e&&Object(f.a)(this.rateParameter,e.rate,a),"rawDelayRate"in e&&(this.rawDelayRate=e.rawDelayRate),"isSynced"in e&&(this.isSynced=e.isSynced),Object(r.a)({},a,this.loadParameterFromJson(e,"feedbackParameter",this.feedbackParameter,t),this.loadParameterFromJson(e,"rateParameter",this.rateParameter,t))}}]),n}(l.a.Effect);t.a=v},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=(n(15),n(890)),l=n(324),f=n(33),h=n(61),p=n(128),d=n(103);n(8);var m=function(e,t){for(var n in e){var r=e[n];if(r)for(var a in r.steps){if(r.steps[a].hasStep(t))return{stepNumber:parseInt(n),position:a}}}return{stepNumber:void 0,position:void 0}};function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var k=function(e,t,n){var a=Object(r.a)(e.steps),i=function(e,t){var n=e.steps.map(function(e){return m(t,e)});return Math.min.apply(Math,Object(r.a)(n.map(function(e){return e.stepNumber})))}(e,t);a.reverse();var o,s=g(a);try{for(s.s();!(o=s.n()).done;){var c=o.value,u=m(t,c),l=u.stepNumber,f=(u.position,l-i),h=Math.floor(i+f*n);if(t[l]){var d=t[l].steps,v=t[l].track;h!==l&&(t[l]=new p.a(v),t[h]=new p.a(v),t[h].steps=d)}}}catch(b){s.e(b)}finally{s.f()}return t};function O(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=n(178);n(443);function E(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var x=function(e,t,n){switch(n.thenType){case d.a:return function(e,t,n){var a=Object(r.a)(e.steps);a.reverse();var i,o=Object(r.a)(t),s=v(a);try{for(s.s();!(i=s.n()).done;){var c=i.value,u=m(o,c),l=u.stepNumber,f=(u.position,Math.round((l+n)%t.length));if(o[l]){var h=o[l].steps,d=t[l].track;t[l]=new p.a(d),t[f]=new p.a(d),t[f].steps=h}}}catch(b){s.e(b)}finally{s.f()}return t}(t,e,n.thenValue.get());case d.d:return k(t,e,n.thenValue.get());case d.m:return function(e,t){var n,a=Object(r.a)(e.steps),i=O(a.slice(0,a.length-1));try{for(i.s();!(n=i.n()).done;)for(var o=n.value,s=m(t,o).stepNumber,c=t[s],u=s+2;u<t.length&&!t[u].anyOn();u+=2)t[u]=c}catch(l){i.e(l)}finally{i.f()}return t}(t,e);case d.f:return function(e,t){for(var n=Object(r.a)(e.steps),a=0;a<n.length-1;a++){var i=n[a],o=n[a+1],s=m(t,i),c=m(t,o),u=t[s.stepNumber],l=new p.a(u.track);for(var f in u.steps){var h=u.steps[f].getCopy(),d=(c.stepNumber-s.stepNumber)/2;h.duration=d,l.steps[f]=h}t[s.stepNumber]=l}return t}(t,e)}return e},T=function(){function e(t){Object(a.a)(this,e),this.children=t}return Object(i.a)(e,[{key:"getAllLeaves",value:function(){if(void 0===this.children)return[this];var e=[];for(var t in this.children)e=e.concat(this.children[t].getAllLeaves());return e}},{key:"getLeftMostLeaf",value:function(){var e=this.getAllLeaves();if(e.length>0)return e[0]}}]),e}();n(45);function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var N=function(e){Object(o.a)(n,e);var t=C(n);function n(e,r,i,o){var s;return Object(a.a)(this,n),(s=t.call(this,o)).pattern=e,s.stepNumber=r,s.resolution=i,s}return Object(i.a)(n,[{key:"track",get:function(){return this.pattern.track}},{key:"state",get:function(){return this.track.sequencerEngine.state}},{key:"stepBuckets",get:function(){return this.resolution.isTriplet?this.pattern.tripletStepBuckets:this.pattern.stepBuckets}},{key:"search",value:function(e,t){if(void 0!==this.stepNumber){void 0===this.resolution||this.resolution.toString();if(this.stepNumber===e&&t.equals(this.resolution))return this;if(void 0!==this.children)for(var n in this.children){var r=this.children[n].search(e,t);if(void 0!==r)return r}}else for(var a in this.children){var i=this.children[a].search(e,t);if(void 0!==i)return i}}},{key:"toggle",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this.on){var n=this.getAllLeaves().filter(function(e){return e.on}),r=[];for(var a in n){var i=n[a];r.push({stepBucket:this.stepBuckets[i.stepNumber],stepNumber:i.stepNumber});var o=function(t){var n=e.stepBuckets[i.stepNumber];n.group&&(n.group.steps=n.group.steps.filter(function(e){return e!=n}))};for(var s in this.stepBuckets[i.stepNumber])o();var c=t||this.stepBuckets[i.stepNumber].getAllOnSteps()[0].id;this.stepBuckets[i.stepNumber]=new p.a(this.pattern.track,this.resolution.isTriplet),this.stepBuckets[i.stepNumber].steps[0]=new h.a(void 0,void 0,void 0,this.track),this.stepBuckets[i.stepNumber].steps[0].id=c}return r}var u=this.getLeftMostLeaf();this.on=!0,this.stepBuckets[u.stepNumber].steps[0]||(this.stepBuckets[u.stepNumber].steps[0]=new h.a(void 0,void 0,void 0,this.track)),t=t||this.stepBuckets[u.stepNumber].steps[0].id,this.getLeftMostBucket().steps[0].id=t;var l=new p.a(this.pattern.track,this.resolution.isTriplet);return l.steps[0]=new h.a(void 0,void 0,void 0,this.track),l.steps[0].id=t,[{stepBucket:l,stepNumber:u.stepNumber}]}},{key:"on",get:function(){return void 0===this.children?this.stepBuckets[this.stepNumber].anyOn():this.getAllLeaves().some(function(e){return e.on})},set:function(e){var t=this.getLeftMostBucket();if(!t.steps[0]){var n=new h.a;n.track=this.pattern.track,t.steps[0]=n}t.steps[0].on=e;var r=this.state.effects.selectedPalettes[this.track.id];void 0!==r&&(t.steps[0].palette=r)}},{key:"getLeftMostBucket",value:function(){var e=this.getLeftMostLeaf();return this.stepBuckets[e.stepNumber]}},{key:"getJson",value:function(){return void 0===this.children?{stepNumber:this.stepNumber,resolution:this.resolution}:{stepNumber:this.stepNumber,resolution:this.resolution,children:this.children.map(function(e){return e.getJson()})}}}]),n}(T);function R(e,t){for(var n=new f.a(1,t),r=e.length(n),a=[],i=0;i<r;i++){var o=new N(e,i,n,void 0);a.push(M(o,e,t))}return new N(e,void 0,void 0,a)}function M(e,t,n){var r=e.resolution;if(32===r.resolution)return e;var a=new f.a(2*r.resolution,r.isTriplet);if(n){var i=new N(t,3*e.stepNumber,a,void 0),o=new N(t,3*e.stepNumber+1,a,void 0),s=new N(t,3*e.stepNumber+2,a,void 0);e.children=[M(i,t),M(o,t),M(s,t)]}else{var c=new N(t,2*e.stepNumber,a,void 0),u=new N(t,2*e.stepNumber+1,a,void 0);e.children=[M(c,t),M(u,t)]}return e}var A=n(6);function q(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var _=new f.a(32,!1),F=new f.a(32,!0),L=(new f.a(16,!1),0),B=function(e){Object(o.a)(n,e);var t=I(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this)).steps=[],i.id=L++,i.sequencerEngine=e,i.store=e.store,i.track=r,i.frozenPatternPlaying=void 0,i.mix=new l.a(e),i.stepBuckets=[],i.tripletStepBuckets=[],i.stepBucketsMatrix={},i.tripletStepBucketsMatrix={},i.transformBucketsIntoStepsCache={},i.stepFills=[],i.tripletStepFills=[],i.volume=0,i.panning=0,i.muted=!1,i.initBlankPattern(),i.color=void 0,i.loopsPlaying={},i.sequencerEngine.multiSequencerEngine||i.updateStepResolutionTree(),i.needsSync=!1,i._startStep=void 0,i.repeats=void 0,i}return Object(i.a)(n,[{key:"startStep",get:function(){return this._startStep},set:function(e){e<0||(this._startStep=e,void 0!==e&&this.sequencerEngine.store.dispatch(Object(A.N)(this.track.subSequence.id,this.id,e)))}},{key:"step",get:function(){return this._startStep}},{key:"duration",get:function(){return this.length()}},{key:"endStep",get:function(){return this._startStep+this.length()}},{key:"updateStepResolutionTree",value:function(){this.stepResolutionTree=R(this,!1),this.tripletStepResolutionTree=R(this,!0)}},{key:"getStepResolutionTree",value:function(e){return e?this.tripletStepResolutionTree:this.stepResolutionTree}},{key:"getBucketsForStepAtResolution",value:function(e,t){for(var n=this.getRangeOfStepsAtResolution(t),r=t.isTriplet?this.tripletStepBuckets:this.stepBuckets,a=t.isTriplet?F.transformStepAtResolution(e,t):_.transformStepAtResolution(e,t),i=[],o=a=Math.floor(a);o<n+a;o++)i.push(r[o%r.length]);return i}},{key:"deleteStepNumber",value:function(e){this.stepBuckets[e]=new p.a(this.track)}},{key:"getRangeOfStepsAtResolution",value:function(e){return e.isTriplet?F.numSteps()/e.numSteps():_.numSteps()/e.numSteps()}},{key:"getAllOnStepAtResolutionBeforePosition",value:function(e,t,n){return this.getBucketsForStepAtResolution(e,t)[0].getAllOnStepsBefore(n)}},{key:"getAllOnStepAtResolutionAtAnyPosition",value:function(e,t,n){this.getRangeOfStepsAtResolution(t);var r=this.getBucketsForStepAtResolution(e,t),a=[];for(var i in r)a=a.concat(r[i].getAllOnSteps(n));return a}},{key:"getStepAtResolution",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=this.getBucketsForStepAtResolution(e,t);for(var i in a)if(void 0!==a[i]){var o=a[i].getStep(r);if(o&&o.getPolyphony().some(function(e){return e.on&&n(e)}))return o}a.length}},{key:"getPolyphonicStepsAtResolution",value:function(e,t){var n=t.isTriplet?F.numSteps()/t.numSteps():_.numSteps()/t.numSteps(),r=[];if(t.isTriplet){var a=F.transformStepAtResolution(e,t);this.tripletStepBuckets[a%this.tripletStepBuckets.length];for(var i=a;i<n+a;i++){var o=this.tripletStepBuckets[i%this.tripletStepBuckets.length].steps,s=function(e){var t=o[e].getPolyphony().filter(function(e){return e.on}).map(function(t){return{position:e,step:t}});r=r.concat(t)};for(var c in o)s(c)}}else{var u=_.transformStepAtResolution(e,t);this.stepBuckets[u%this.stepBuckets.length];for(var l=u;l<n+u;l++){var f=this.stepBuckets[l%this.stepBuckets.length].steps,h=function(e){var t=f[e].getPolyphony().filter(function(e){return e.on}).map(function(t){return{position:parseFloat(e),step:t}});r=r.concat(t)};for(var p in f)h(p)}}return r}},{key:"setStepAtResolution",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(void 0===t||isNaN(t))&&(t=0),(void 0===r||isNaN(r))&&(r=0),t=n.isTriplet?F.transformStepAtResolution2(t,n):_.transformStepAtResolution2(t,n);var a=Math.floor(t);if((r+=t-a)>=1){var i=Math.floor(r);a+=i,r-=i}n.isTriplet?this.tripletStepBuckets[a%this.tripletStepBuckets.length].setStepAtPosition(e,r):this.stepBuckets[a%this.stepBuckets.length].setStepAtPosition(e,r)}},{key:"addNote",value:function(e,t,n){var r=new h.a;r.on=!0,r.duration=t,r.transpose=n,r.stepNumber=e,this.stepBuckets[e].setStep(0,r)}},{key:"clearCache",value:function(){this.transformBucketsIntoStepsCache={}}},{key:"loadStepBuckets",value:function(e){e&&(this.stepBuckets=e),this.tripletStepBuckets=F.transformBucketsAtResolution(this.stepBuckets,_),this.updateStepResolutionTree(),this.transformBucketsIntoStepsCache={},this.syncMatrix()}},{key:"syncBuckets",value:function(e){(e=void 0!==e&&e)?this.stepBuckets=_.transformBucketsAtResolution(this.tripletStepBuckets,F):this.tripletStepBuckets=F.transformBucketsAtResolution(this.stepBuckets,_),this.syncMatrix()}},{key:"syncBucketsAtStep",value:function(e,t){var n=this.getRangeOfStepsAtResolution(t),r=t.isTriplet?F.transformStepAtResolution(e,t):_.transformStepAtResolution(e,t),a=(r=Math.floor(r))+n;t.isTriplet?this.stepBuckets=_.transformBucketsAtResolution(this.tripletStepBuckets,F,r,a,this.stepBuckets):this.tripletStepBuckets=F.transformBucketsAtResolution(this.stepBuckets,_,r,a,this.tripletStepBuckets),this.syncMatrix()}},{key:"syncMatrixBySteps",value:function(e,t){this.needsSync=!1;var n=t.isTriplet?this.tripletStepBuckets:this.stepBuckets,r=t.isTriplet?this.tripletStepBucketsMatrix:this.stepBucketsMatrix;for(var a in e){var i=e[a];a=_.transformStepAtResolution(a,t),i=_.transformStepAtResolution(i,t);var o=n[a],s=n[i];o&&o.anyOn()?r[a]=o:delete r[a],s&&s.anyOn()?r[i]=s:delete r[i]}}},{key:"syncMatrix",value:function(){this.stepBucketsMatrix={},this.tripletStepBucketsMatrix={};for(var e=0;e<this.stepBuckets.length;e++){var t=this.stepBuckets[e];t.anyOn()&&(this.stepBucketsMatrix[e]=t)}for(var n=0;n<this.tripletStepBuckets.length;n++){var r=this.tripletStepBuckets[n];r.anyOn()&&(this.tripletStepBucketsMatrix[n]=r)}this.needsSync=!1}},{key:"getBucket",value:function(e,t){e=(t=t||_).isTriplet?F.transformStepAtResolution2(e,t):_.transformStepAtResolution2(e,t);var n=this.isTransformed?this.transformedStepBuckets:this.stepBuckets;return t.isTriplet?this.tripletStepBuckets[e]:n[e]}},{key:"clear",value:function(){this.stepBuckets.map(function(e){return e.clear()}),this.syncBuckets(),this.clearCache()}},{key:"changeLength",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=Math.ceil(e),this.stepBuckets=this.stepBuckets.slice(0,e);for(var n=this.stepBuckets.length;n<e;n++)this.stepBuckets.push(new p.a(this.track));this.updateStepResolutionTree(),this.clearCache(),t&&this.syncBuckets()}},{key:"length",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_;if(e===_)return e.isTriplet?this.tripletStepBuckets.length:this.stepBuckets.length;var t=e.isTriplet?this.tripletStepBuckets.length:this.stepBuckets.length;return e.isTriplet?Math.ceil(e.transformStepAtResolution2(t,F)):Math.ceil(e.transformStepAtResolution2(t,_))}},{key:"initBlankPattern",value:function(){for(var e=0;e<_.numSteps();e++)this.stepBuckets.push(new p.a(this.track)),this.stepFills.push(!1);if(!this.sequencerEngine.multiSequencerEngine)for(e=0;e<F.numSteps();e++)this.tripletStepBuckets.push(new p.a(this.track,!0)),this.tripletStepFills.push(!1)}},{key:"getFillsAtResolution",value:function(e){return e.isTriplet?e.transformList(this.tripletStepFills):e.transformList(this.stepFills)}},{key:"getStepsAtResolution",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=e.isTriplet?this.tripletStepBuckets:this.stepBuckets;if(!(e in this.transformBucketsIntoStepsCache)){var n=e.transformBucketsIntoSteps(t);return this.transformBucketsIntoStepsCache[e]=n,n}return this.transformBucketsIntoStepsCache[e]}},{key:"getAnyStep",value:function(e){for(var t in this.stepBuckets[e].steps){var n=this.stepBuckets[e].steps[t];if(n.on)return n}return this.stepBuckets[e].steps[0]}},{key:"getBucketsAtResolution",value:function(e){var t=e.isTriplet?this.tripletStepBuckets:this.stepBuckets;return e.transformList(t)}},{key:"setLength",value:function(e){this.stepBuckets=[];for(var t=0;t<e;t++)this.stepBuckets.push(new p.a(this.track));this.syncBuckets(!1)}},{key:"doubleTrackLength",value:function(){for(var e=this.stepBuckets.length,t=0;t<e;t++)this.stepBuckets.push(new p.a(this.track)),this.stepFills.push(!1);e=this.tripletStepBuckets.length;for(var n=0;n<e;n++)this.tripletStepBuckets.push(new p.a(this.track,!0)),this.tripletStepFills.push(!1);this.clearCache(),this.updateStepResolutionTree()}},{key:"halfTrackLength",value:function(){var e=this.length()/2;e<=1||(this.stepBuckets=this.stepBuckets.slice(0,e),this.stepFills=this.stepFills.slice(0,e),e=this.tripletStepBuckets.length/2,this.tripletStepBuckets=this.tripletStepBuckets.slice(0,e),this.tripletStepFills=this.tripletStepFills.slice(0,e),this.clearCache(),this.updateStepResolutionTree())}},{key:"loadFromJson",value:function(e){if(void 0===e.newVolume){var t=e.volume+40;this.volume=128*t/60}else this.volume=e.volume;this.panning="panning"in e?e.panning:0,this.muted=e.muted,this.loopsPlaying="loopsPlaying"in e?e.loopsPlaying:{},"startStep"in e&&(this.startStep=e.startStep),"repeats"in e&&(this.repeats=e.repeats),this.frozenPatternPlaying=e.frozenPatternPlaying}},{key:"calculateFillsHelper",value:function(e,t,n){n.isTriplet?this.tripletStepFills.fill(!1):this.stepFills.fill(!1);for(var r=t.length,a=0;a<r;a++){var i=-16;for(var o in t[a].steps){var s=t[a].getStep(o);if(s.on){var c=null==s.duration?e.duration:s.duration;i<(c=2*Math.floor(c))&&(i=c)}}if(!(i<1))for(var u=0;u<i;u++){var l=(a+u)%r;n.isTriplet?this.tripletStepFills[l]=!0:this.stepFills[l]=!0}}}},{key:"calculateFills",value:function(e){this.calculateFillsHelper(e,this.stepBuckets,_),this.calculateFillsHelper(e,this.tripletStepBuckets,F)}},{key:"getJson",value:function(){return{newVolume:!0,automations:this.mix.getJson(),volume:this.volume,panning:this.panning,muted:this.muted,loopsPlaying:this.loopsPlaying,startStep:this.startStep,repeats:this.repeats,frozenPatternPlaying:this.frozenPatternPlaying}}},{key:"getCopy",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.stepBuckets.length,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.track,i=new n(this.sequencerEngine,a);i.frozenPatternPlaying=this.frozenPatternPlaying,i.stepBuckets=[],i.mix=this.mix,i.tripletStepBuckets=[],i.volume=this.volume,i.panning=this.panning,i.muted=this.muted,i.steps=[],i.loopsPlaying={},Object.keys(this.loopsPlaying).map(function(t){return i.loopsPlaying[t]=e.loopsPlaying[t]});for(var o=this.getAllGroups(),s=t;s<r;s++){var c=this.stepBuckets[s].getCopy(a);i.stepBuckets.push(c),i.stepFills.push(this.stepFills[s])}var u,l=i.getAllSteps(),f=q(o);try{var h=function(){var t=u.value,n=l.filter(function(e){return e.group===t}),r=Object(w.e)(n,e.track,!0);Object(w.a)(t,r,a)};for(f.s();!(u=f.n()).done;)h()}catch(p){f.e(p)}finally{f.f()}return i.startStep=void 0===this.startStep?void 0:this.startStep+t,i.syncBuckets(),i.updateStepResolutionTree(),i}},{key:"chooseColor",value:function(e){this.color=e}},{key:"getUpdateStepsAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.store.getState().sequencer.displayResolution,r=this.length(n),a=new Array(r).fill(!1),i={},o={},s={},c={},u={},l=new Array(r),h=this.getEasyPattern();e&&h.update(t);var p=n.isTriplet?this.tripletStepBucketsMatrix:this.stepBucketsMatrix;n.isTriplet?this.tripletStepBuckets:this.stepBuckets;if(this.track.sequencerEngine.state.groups.stepsGroupMode&&this.isTransformed)for(var d in p={},this.transformedStepBuckets){var m=this.transformedStepBuckets[d];if(m.anyOn()){var v=m.getAllOnSteps().find(function(e){return e.group});if(v&&Object(w.h)(v))continue;p[d]=m}}var b=n.isTriplet?new f.a(32,!0):new f.a(32,!1);for(var g in p){var y=Math.floor(n.transformStepAtResolution2(g,b));a[y]=!0;var k=b.resolution/n.resolution,O=(g-y*k)/k,j=[];if(void 0!==p[g]){for(var E in p[g].steps){var S=p[g].steps[E].getPolyphony();for(var P in S){var x=S[P];if(x.on){var T=Math.round(x.transpose),C=parseFloat(E)/k+O,N=new f.a(16,!1),R=n.transformStepAtResolution2(x.duration,N);T in i||(i[T]={},o[T]={},s[T]={}),j.push(x);var M=parseInt(y)+C;i[T][M]=!0,o[T][M]=0,s[T][M]=R}}}var A=p[g].getAllOnSteps()[0];for(var q in l[y]=A,u[y]=A&&A.group?A.group.id:void 0,j){var D=j[q];if(D.on){var I=D.transpose;null==I&&(I=this.trackData.transpose);for(var _=n.transformStepAtResolution2(D.duration,new f.a(16,!1)),F=0;F<_;F++){var L=(parseInt(y)+parseInt(F))%r;c[parseInt(L)]=!0}}}}}return this.sequencerEngine.midi&&this.sequencerEngine.cursor.track===this.trackNumber&&this.sequencerEngine.midi.updateSteps(a),{id:this.subSequence.isTrack?this.subSequence.id:this.track.id,trackNumber:this.subSequence.isTrack?this.subSequence.id:this.trackNumber,steps:a,pianoRollSteps:i,trackFills:c,stepToId:l,pianoRollPositions:o,pianoRollDurations:s,muted:this.track.muted,groups:u}}},{key:"getTrackStepsAction",value:function(){var e=this.store.getState().sequencer.displayResolution,t=this.length(e),n=new Array(t).fill(!1),r=e.isTriplet?this.tripletStepBucketsMatrix:this.stepBucketsMatrix,a=e.isTriplet?new f.a(32,!0):new f.a(32,!1);for(var i in r){n[Math.floor(e.transformStepAtResolution2(i,a))]=!0}return n}},{key:"trackPatternSteps",get:function(){var e=this.subSequence.isTrack?this.subSequence.id:this.trackNumber;return this.sequencerEngine.state.tracks.trackPatternSteps[e]||{}}},{key:"subSequence",get:function(){return this.track.subSequence}},{key:"trackNumber",get:function(){return this.track.trackNumber}},{key:"trackData",get:function(){return this.track.trackData}},{key:"getEasyPattern",value:function(){return new u.a(this,this.trackData)}},{key:"split",value:function(e){var t=e-this.startStep,r=(this.length(),new n(this.sequencerEngine,this.track));return r.stepBuckets=this.stepBuckets.slice(t),this.stepBuckets=this.stepBuckets.slice(0,t),r.startStep=e,this.syncBuckets(),r.syncBuckets(),r}},{key:"overlapsStep",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e>=this.startStep&&e<=this.startStep+this.length():e>=this.startStep&&e<this.startStep+this.length()}},{key:"addToStart",value:function(e){for(var t=[],n=0;n<e;n++)t.push(new p.a(this.track));this.stepBuckets=[].concat(t,Object(r.a)(this.stepBuckets)),this.syncBuckets()}},{key:"cutFromStart",value:function(e){this.stepBuckets=this.stepBuckets.slice(e),this.syncBuckets()}},{key:"dispose",value:function(){this.stepBuckets=void 0,this.tripletStepBuckets=void 0,this.stepBucketsMatrix=void 0,this.tripletStepBucketsMatrix=void 0,this.stepFills=void 0,this.tripletStepFills=void 0,this.mix=void 0,this.track=void 0}},{key:"getAllSteps",value:function(){var e=[],t=this.stepBuckets;for(var n in t){var r=t[n];for(var a in r.steps){var i=r.steps[a];e=e.concat(i.getPolyphony().filter(function(e){return e.on}))}}return e}}]),n}(function(e){Object(o.a)(n,e);var t=P(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).transformedStepBuckets=[],e.isTransformed=!1,e}return Object(i.a)(n,[{key:"stepGroups",get:function(){return this.track.stepGroups}},{key:"transform",value:function(){this.isTransformed=!0;var e,t=Object(r.a)(this.stepBuckets),n=E(this.getAllGroups());try{for(n.s();!(e=n.n()).done;){var a,i=e.value,o=E(i.transformations);try{for(o.s();!(a=o.n()).done;){var s=a.value;Object(w.i)(s)&&(t=x(t,i,s))}}catch(c){o.e(c)}finally{o.f()}}}catch(c){n.e(c)}finally{n.f()}this.transformedStepBuckets=t}},{key:"getAllGroups",value:function(){return Array.from(new Set(this.getAllSteps().map(function(e){return e.group}))).filter(function(e){return e})}}]),n}(function(){return function e(){Object(a.a)(this,e)}}()));t.a=B},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(9),f=n(20),h=n(165),p=n(645);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var m=function(e){Object(s.a)(n,e);var t=d(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this)).initialSubEvent=e,r.initialSubEvent.parentEvent=Object(f.a)(r),r.subEvents=[],r.cache={},r}return Object(i.a)(n,[{key:"setTime",value:function(e,t){Object(o.a)(Object(u.a)(n.prototype),"setTime",this).call(this,e,t),this.initialSubEvent.setTime(e,t)}},{key:"getNextSubEvent",value:function(e){for(var t in this.subEvents)if(e.step<this.subEvents[t].step)return this.subEvents[t]}},{key:"getPreviousSubEvent",value:function(e){var t;for(var n in this.subEvents){if(e===this.subEvents[n])return t;t=this.subEvents[n]}}},{key:"isLastSubEvent",value:function(e){return this.subEvents.indexOf(e)===this.subEvents.length-1}},{key:"deleteSubEvent",value:function(e){if(this.initialSubEvent===e)return 0===this.subEvents.length?(this.initialSubEvent=void 0,0):(this.initialSubEvent=this.subEvents[0],this.subEvents=this.subEvents.slice(1),this.initialSubEvent.step=this.step,void 0===this.initialSubEvent&&(this.subEvents=[]),0);var t=this.subEvents.indexOf(e);return t<0?t:(this.subEvents.splice(t,1),t)}},{key:"isEmpty",value:function(){return void 0===this.initialSubEvent&&0===this.subEvents.length}},{key:"events",get:function(){return this.getSubEvents()},set:function(e){this.restart(),this.initialSubEvent=e[0],this.subEvents=e.slice(1),this.calculateDurations()}},{key:"restart",value:function(){this.cache={}}},{key:"getSubEvents",value:function(){var e=[this.initialSubEvent].concat(Object(l.a)(this.subEvents)),t=e[e.length-1];return void 0!==t&&(t.duration=this.step+this.duration-t.step),e}},{key:"addSubEvent",value:function(e){e.parentEvent=this,this.subEvents.push(e),this.subEvents.sort(function(e,t){return e.step-t.step});var t=this.initialSubEvent;for(var n in this.subEvents)void 0!==t&&(t.duration=this.subEvents[n].step-t.step),t=this.subEvents[n];var r=this.subEvents[this.subEvents.length-1];r.duration=this.step+this.duration-r.step}},{key:"getSubEvent",value:function(e){if(e in this.cache)return this.cache[e];for(var t=this.initialSubEvent,n=0;n<this.subEvents.length&&!(this.subEvents[n].step>e);n++)t=this.subEvents[n];return this.cache[e]=t,t}},{key:"getSubType",value:function(){}},{key:"fromJson",value:function(e,t){for(var r in Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t),this.initialSubEvent=Object(p.a)(e.initialSubEvent,this.getSubType(),t),void 0===this.initialSubEvent.step&&(this.initialSubEvent.step=this.step),this.initialSubEvent.parentEvent=this,e.subEvents)this.addSubEvent(Object(p.a)(e.subEvents[r],this.getSubType(),t))}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{subType:this.getSubType(),initialSubEvent:this.initialSubEvent.getJson(),subEvents:this.subEvents.map(function(e){return e.getJson()})})}},{key:"calculateDurations",value:function(){if(this.isEmpty())this.duration=0;else{var e=this.getSubEvents(),t=void 0;for(var n in e)t&&(t.duration=e[n].step-t.step),t=e[n];t.duration=this.step+this.duration-t.step}}}]),n}(h.a),v=(n(15),n(43)),b=n(238);n(33);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var y=function(e){Object(s.a)(n,e);var t=g(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this,new b.a(r))).rolling=e,i}return Object(i.a)(n,[{key:"getValue",value:function(){return this.rolling?1:0}},{key:"isDeterministic",value:function(){return!0}},{key:"isSkippable",value:function(){return!0}},{key:"isPrunable",value:function(){return!this.rolling}},{key:"executeEvent",value:function(e){e.sequenceRolling=this.rolling}},{key:"getCopy",value:function(){var e=new n(this.rolling,this.initialSubEvent.resolution);return e.fromJson(this.getJson()),e}},{key:"getType",value:function(){return v.k}},{key:"getSubType",value:function(){return v.j}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{rolling:this.rolling})}},{key:"fromJson",value:function(e,t){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.rolling=e.rolling,this.initialSubEvent.step=this.step,this}}]),n}(m);t.a=y},function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(33);function a(e){var t={};for(var n in e){var r=e[n];t[n]=i(r)}return t}function i(e){return null===e?e:("object"===typeof e&&e.resolution&&(e=new r.a(16,!1).fromJson(e)),e)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(9),a=n(111),i=n(45),o=[],s=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(a.c)(e).slice(0,1),s=(Object(i.uuid)(),function(e){n=[e].concat(Object(r.a)(n))});return Object(a.d)(e,s,t),function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return Object(a.e)(e,s);if(0===n.length)return o;var t=Object(r.a)(n);return n=[],t}}},,function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=(n(15),n(43)),h=n(33);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var d=function(e){Object(s.a)(n,e);var t=p(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this)).resolution=e,r}return Object(i.a)(n,[{key:"getValue",value:function(){return this.resolution}},{key:"isDeterministic",value:function(){return!0}},{key:"isSkippable",value:function(){return!0}},{key:"executeEvent",value:function(e){}},{key:"getType",value:function(){return f.j}},{key:"getCopy",value:function(){var e=new n;return e.fromJson(this.getJson()),e}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{resolution:this.resolution.getJson()})}},{key:"fromJson",value:function(e,t){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.resolution=new h.a,this.resolution.fromJson(e.resolution),this}},{key:"isEquivalent",value:function(e){return e.resolution.equals(this.resolution)}}]),n}(l.a);t.a=d},function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c});var r=n(9),a=n(154),i=function(e,t,n,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))},o=function(e,t){return i(e.x,e.y,t.x,t.y)},s=function(e){var t=Object(a.f)(e);return e.sort(u),function(e,t,n){if(e.length<=3)return e;var a=window.api.create_geometry_buffer(e.length),i=window.api.create_geometry_buffer(e.length);window.Module.HEAPF32.set(e,a/e.BYTES_PER_ELEMENT),window.api.getConvexHullFlat(a,e.length,i,t.x,t.y,n);for(var o=new Uint32Array(window.Module.HEAP32.buffer,i,3*e.length+1),s=o[0],c=[],u=0;u<s;u++){var l=o[2*u+1],f=o[2*u+2];c.push({x:l,y:f})}window.api.destroy_buffer(i),window.api.destroy_buffer(a);var h=c.slice(1,c.length);return h.reverse(),[c[0]].concat(Object(r.a)(h)).flatMap(function(e){return[e.x,e.y]})}(e,t,12)};function c(e,t,n){var a=e.slice();a.sort(u);var i=function(e,t,n){if(e.length<=3)return e;var a=window.api.create_geometry_buffer(e.length),i=window.api.create_geometry_buffer(e.length),o=window.api.create_geometry_buffer(3*e.length+1),s=new Uint32Array(e.map(function(e){var t=e.x;e.y;return t})),c=new Uint32Array(e.map(function(e){e.x;var t=e.y;return t}));window.Module.HEAP32.set(s,a/s.BYTES_PER_ELEMENT),window.Module.HEAP32.set(c,i/c.BYTES_PER_ELEMENT),window.api.getConvexHull(a,i,e.length,o,t.x,t.y,n);for(var u=new Uint32Array(window.Module.HEAP32.buffer,o,3*e.length+1),l=u[0],f=[],h=0;h<l;h++){var p=u[2*h+1],d=u[2*h+2];f.push({x:p,y:d})}window.api.destroy_buffer(o),window.api.destroy_buffer(a),window.api.destroy_buffer(i);var m=f.slice(1,f.length);return m.reverse(),[f[0]].concat(Object(r.a)(m))}(a,t,n);return i}function u(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}},,function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r="FIGURE",a="TRACK"},,,function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=(n(2426),0);t.a=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.children,n=e.dropdownPos,i=e.setDropdownPos,s=e.className,c=Object(r.useRef)(void 0),u=Object(r.useRef)(!1),l=Object(r.useRef)(0);Object(r.useRef)(++o);Object(r.useEffect)(function(){return c.current&&c.current.addEventListener("mousewheel",f),function(){c.current&&c.current.removeEventListener("mousewheel",f)}},[n]);var f=Object(r.useCallback)(function(e){e.stopPropagation()},[]);Object(r.useEffect)(function(){return window.addEventListener("mouseup",h),function(){window.removeEventListener("mouseup",h)}},[i,n]);var h=Object(r.useCallback)(function(){l.current++,1===l.current&&u.current?u.current=!1:i&&(u.current=!1,i(void 0))},[i,n]);return Object(r.useEffect)(function(){n?(l.current=0,u.current=!0):(l.current=0,u.current=!1)},[n]),n?a.a.createElement("div",{onMouseDown:function(e){},ref:c,style:{left:n.x-10,top:n.y-10},onMouseUp:function(e){},onClick:function(){},className:"context-menu "+s},t):(l.current=0,[])})},,,function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),a=function(e){Object(r.useEffect)(function(){return e.current&&e.current.addEventListener("mousewheel",t),function(){e.current&&e.current.removeEventListener("mousewheel",t)}},[]);var t=function(e){return e.stopPropagation()}}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(21),l=n(235);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var h=function(e){Object(o.a)(n,e);var t=f(n);function n(e,a,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object(r.a)(this,n),t.call(this,e,a,i,o)}return Object(a.a)(n,[{key:"options",get:function(){return this.config.options}},{key:"getOptionFromNumber",value:function(e){if((e=parseFloat(e))in this.fromCache)return this.fromCache[e];var t=1e4,n=void 0;for(var r in this.options){var a=Math.abs(e-parseFloat(r));a<t&&(t=a,n=this.options[r])}return this.fromCache[e]=n,n}},{key:"getNumberFromOption",value:function(e){if(void 0!==e){if(e.toString()in this.toCache)return this.toCache[e.toString()];for(var t in this.options)if(e.equals&&e.equals(this.options[t])||this.options[t]===e)return this.toCache[e.toString()]=parseFloat(t),parseFloat(t)}}},{key:"convertValue",value:function(e){Object(l.b)(e);return this.getOptionFromNumber(e)}},{key:"set",value:function(e,t,r,a){if(null===e||void 0===e)return Object(i.a)(Object(c.a)(n.prototype),"set",this).call(this,void 0,t,r);var o=a?e:this.config.isNumber||"number"!==typeof e?this.getNumberFromOption(e):e;return void 0===o&&(o=Object.values(this.options)[0]),Object(i.a)(Object(c.a)(n.prototype),"set",this).call(this,o,t,r)}},{key:"getNumber",value:function(e){return Object(i.a)(Object(c.a)(n.prototype),"get",this).call(this,e)}},{key:"get",value:function(e){var t=Object(i.a)(Object(c.a)(n.prototype),"get",this).call(this,e);return t in this.options?this.options[t]:this.getOptionFromNumber(t)}},{key:"updateRedux",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];arguments.length>1&&arguments[1];for(var t in this.patternToAutomation)this.patternToAutomation[t].clear();if(this.unlockedAutomation.clear(),this.automation.clear(),this.automation.store=this.store,this.mixAutomation.store=this.store,this.automation.updateRedux(),null!==this.value&&void 0!==this.value)return this.set(this.value,!0,e,!0)}}]),n}(u.a);t.a=h},function(e,t,n){"use strict";var r=n(28),a=n(8),i=n(9),o=n(11),s=n(0),c=n.n(s),u=n(99),l=n(6),f=n(62),h=n(45),p=n(81),d=n(71),m=n(314);function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=function(e){var t=e.rack,n=e.selectedEdge,r=e.selectedNodes,o=e.setEdges,c=e.setEffects,b=e.selectedNode,g=e.connectEdge,y=e.setCopiedNodes,k=e.copiedNodes,O=e.setSelectedNodes,j=e.setLfoEdges,w=e.setEnvelopeEdges,E=e.getLastNode,S=e.setMacros,P=e.setMacroEdges,x=Object(u.a)(e,["rack","selectedEdge","selectedNodes","setEdges","setEffects","selectedNode","connectEdge","setCopiedNodes","copiedNodes","setSelectedNodes","setLfoEdges","setEnvelopeEdges","getLastNode","setMacros","setMacroEdges"]);Object(s.useEffect)(function(){return window.addEventListener("keydown",T),function(){return window.removeEventListener("keydown",T)}},[n,O,b,o,c,x.isSelected]);var T=Object(s.useCallback)(function(e){if(console.log("on key down happend presiod"),t.getEffectType()!==d.d||"Backspace"===e.key)if(("INPUT"===e.target.tagName.toUpperCase()||t.getEffectType()!==d.d&&"Rules Rack"!==t.name&&"Chords Rack"!==t.name&&!x.isSelected)&&console.log("bruh input"),e.stopPropagation(),"Backspace"===e.key){if(console.log("backspace in rack selected=",r),n){if(t.getEffectType()===d.d&&void 0===n.modulator)return;t.deleteEdge(n),o(Object(a.a)({},t.adjacencyLists)),j(Object(a.a)({},t.lfoAdjacencyLists)),w(Object(a.a)({},t.envelopeAdjacencyLists))}else if(r.length>0){if(t.getEffectType()===d.d)return;var s,u=v(r);try{for(u.s();!(s=u.n()).done;){var k=s.value;t.isMacro(k)?(t.deleteMacro(k),S(Object(i.a)(t.macros)),P(Object(a.a)({},t.macroAdjacencyLists))):(console.log("deleting effect = ",k),t.deleteEffect(k))}}catch(A){u.e(A)}finally{u.f()}x.setContextualHelp(void 0),O([]),j(Object(a.a)({},t.lfoAdjacencyLists)),w(Object(a.a)({},t.envelopeAdjacencyLists)),o(Object(a.a)({},t.adjacencyLists)),c(Object(i.a)(t.effects))}}else if("l"===e.key&&(e.metaKey||e.ctrlKey)){var T=E(r);T&&r[0]&&(t.connectNodes(T,r[0]),o(Object(a.a)({},t.adjacencyLists)))}else{if("d"===e.key&&(e.metaKey||e.ctrlKey)){if(e.preventDefault(),e.stopPropagation(),b&&void 0===b.getType){var C=b.getEffectCopy();C.id=Object(h.uuid)(),t.addEffect(C);var N=Object(m.a)(b.x,b.y,t),R=N.x,M=N.y;C.x=R,C.y=M,c(Object(i.a)(t.effects))}return!1}if("c"===e.key&&(e.metaKey||e.ctrlKey))return e.stopPropagation(),e.preventDefault(),y(Object(i.a)(r)),!1;if("v"===e.key&&(e.metaKey||e.ctrlKey))return e.stopPropagation(),e.preventDefault(),t.pasteNodes(x.sequencerEngine.state.effects.copiedNodesForRack),c(Object(i.a)(t.effects)),o(Object(a.a)({},t.adjacencyLists)),!1;if("o"===e.key&&(e.metaKey||e.ctrlKey))return e.stopPropagation(),e.preventDefault(),r.forEach(function(e){return g(e,p.h,{mode:p.b,node:t.outputNode})}),!1;if("i"===e.key&&(e.metaKey||e.ctrlKey))return e.stopPropagation(),e.preventDefault(),r.forEach(function(e){return g(e,p.b,{mode:p.h,node:t.inputNode})}),!1;"-"===e.key?(e.stopPropagation(),r.length>0&&(r.forEach(function(e){return e.value=-e.value}),x.sequencerEngine.dispatch(Object(l.Vb)({})))):Object(f.a)(e.key)&&(e.stopPropagation(),r.length>0&&(r.forEach(function(t){return t.value=parseInt(e.key)}),x.sequencerEngine.dispatch(Object(l.Vb)({}))))}},[g,x.isSelected,y,k,n,O,r,o,c,j,w])},y=n(12),k=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.mouseSelection;return void 0===t?[]:c.a.createElement("rect",{className:"mouse-selection",x:t.x1,y:t.y1,width:t.x2-t.x1,fill:"red",opacity:.5,height:Math.abs(t.y2-t.y1)})}),O=n(29),j=(n(733),n(536),n(544)),w=n(22),E=(new O.a,Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setSelectedNode,n=e.oscillator,r=e.sequencerEngine,a=e.instrument,i=e.color;return c.a.createElement("div",{className:"fm-operator-component"},c.a.createElement(j.a,{color:i,setSelectedOsc:t,oscillator:n,sequencerEngine:r,instrument:a}))})),S=n(261),P=function(e){var t=e.macros,n=e.setShowMacrosView,r=e.sequencerEngine,a=Object(s.useCallback)(function(){n(!1)},[n]);return c.a.createElement("div",{className:"effect-rack macros-view"},t.map(function(e){return c.a.createElement(w.a,{effectNumber:0,automation:void 0,name:e.name,selectedParameter:void 0,sequencerEngine:r,lfoEnabled:!0,root:3,parameter:e.macroParameter,isParameter:!0,onParameterChanged:function(){return[]},step:.01,max:1,min:0})}),c.a.createElement("div",{onClick:a,className:"expand-macros-button"},"Expand"))},x=n(508),T=n(741),C=n(205),N=n(210);function R(e){var t=e.edge,n=e.sequencerEngine;return e.rack.getEffectType()===d.c?c.a.createElement("div",{className:"edge-properties"},c.a.createElement("div",null,"Edge Properties:"),c.a.createElement(w.a,{effectNumber:0,automation:void 0,name:"Probability",selectedParameter:void 0,sequencerEngine:n,lfoEnabled:!0,parameter:t.probabilityParameter,isParameter:!0,onParameterChanged:function(){return[]},step:.01,max:100,min:0})):c.a.createElement("div",{className:"edge-properties"},c.a.createElement("div",null,"Edge Properties:"),c.a.createElement(w.a,{effectNumber:0,automation:void 0,name:"Gain",selectedParameter:void 0,sequencerEngine:n,lfoEnabled:!0,parameter:t.gainParameter,isParameter:!0,onParameterChanged:function(){return[]},step:.01,min:0,max:1}))}n(42);var M=n(34),A={INPUT:"Input for node",OUTPUT:"Output for node"};function q(e){var t=e.x,n=e.y,r=e.mode,a=e.parameter,i=e.isRule,o=e.number,s=(p.b,A[r]);a&&a.name&&(s=a.name+": "+a.get()),n=r===p.b?n-5:n+5;var u=8*s.length;return i&&(r===p.b?(s="Then",n-=20):s=1===o?"Before":2===o?"When":"After"),c.a.createElement("g",null,c.a.createElement("rect",{className:"rack-tooltip",x:t,y:n-15,height:15,width:u}),c.a.createElement("text",{className:"tooltip-text",fontSize:12,fill:"white",x:t+5,y:n-3},s))}var D=300;var I=Object(y.b)(null,function(e){return{setContextualHelp:function(t,n){return e(Object(l.ub)(t,n))},setParameterToMap:function(t){return e(Object(l.Td)(t))}}})(function(e){var t=e.x,n=e.y,r=e.number,a=e.mode,i=e.parameter,u=e.startDrawingEdge,l=(e.drawingEdge,e.rack),f=e.effect,h=e.isModulator,d=e.selectedEdge,m=e.connectEdge,v=e.setContextualHelp,b=e.isMacroMapping,g=e.setParameterToMap,y=Object(s.useState)(!1),k=Object(o.a)(y,2),O=k[0],j=k[1],w=Object(s.useState)(!1),E=Object(o.a)(w,2),S=E[0],P=E[1],x=Object(s.useState)(null),T=Object(o.a)(x,2),C=T[0],N=T[1];n=a===p.b?n:h?n+p.e:n+p.f[l.getEffectType()];var R=Object(s.useCallback)(function(){j(!0),N(setTimeout(function(){P(!0)},D)),v(a===p.b?M.tb:h?M.sb:M.ub)},[j,O,N,P]),A=Object(s.useCallback)(function(e){clearTimeout(C),P(!1),j(!1),v(void 0)},[j,P,C]),I=Object(s.useCallback)(function(e){b&&(e.stopPropagation(),g(i)),u(f,a,t+8*r,n,r-1)},[u,P,f,a,r,t,n,b]);return d&&d.effect&&(d.effect.id===f.id||d.fromNode===f)?[]:c.a.createElement("g",null,c.a.createElement("circle",{className:b?"node-io mapping":"node-io",strokeWidth:O?2:0,stroke:O?"yellow":"black",cx:t+8*r,onMouseDown:I,onMouseOver:O?function(){return[]}:R,onMouseLeave:A,onMouseUp:function(){return m(i||f,a)},cy:n,r:3,fill:"#626363"}),S?c.a.createElement(q,{isRule:"Rules Rack"===l.name,number:r,parameter:i,mode:a,x:t+8*r,y:n+20}):c.a.createElement("rect",{x:0,y:0,width:0,height:0}))}),_=Object(s.memo)(function(e){var t=e.effect,n=e.x,r=e.y,a=(e.setDragging,e.rack),o=e.connectEdge,s=e.startDrawingEdge,u=e.drawingEdge,l=e.selectedEdge,f=(e.setSelectedEdge,e.edges,e.isMacroMapping),h=Math.floor(t.numberOfOutputs);isNaN(h)&&(h=1);var m=new Array(h).fill(void 0),v=[void 0];return t.parameters&&(v=a.getEffectType()===d.d?Object(i.a)(v):[].concat(Object(i.a)(v),Object(i.a)(t.parameters.filter(function(e){return e.automatable}).filter(function(e){return"enabled"!==e.name})))),v.length>15&&(v=v.slice(0,15)),c.a.createElement("g",null,v.map(function(e,i){return c.a.createElement(I,{x:n,y:r,key:"intput-"+i,number:i+1,mode:p.b,selectedEdge:l,parameter:e,effect:t,isMacroMapping:f,rack:a,connectEdge:o,drawingEdge:u,startDrawingEdge:s})}),m.map(function(e,i){return c.a.createElement(I,{key:"output-"+i,x:n,y:r,parameter:e,drawingEdge:u,rack:a,selectedEdge:l,number:i+1,mode:p.h,connectEdge:o,startDrawingEdge:s,effect:t})}))}),F=Object(y.b)(function(e,t){return void 0!==t.x?{}:{x:t.effect.x,y:t.effect.y,isMacroMapping:e.effects.isMacroMapping,numberOfOutputs:t.effect.numberOfOutputs}},null)(_),L=n(104),B=(n(38),n(39)),z=n.n(B),V=n(86),H=1;function U(e){var t=e.effect,n=e.sequencerEngine,r=e.track,a=e.isMidiEffect,i=e.handleChooseEffect,u=e.options,l=e.placeholder,f=Object(s.useState)(1),h=Object(o.a)(f,2),p=h[0],d=h[1],m=Object(s.useCallback)(function(e){var t=a?Object(V.c)(e,r):Object(V.b)(e,n);i(t),d(++H),setTimeout(function(){return d(void 0)},50)},[d,t]),v=u||(a?V.e:V.a);return c.a.createElement("div",null,c.a.createElement(z.a,{className:"effect-dropdown",options:v,option:1===p?void 0:p,value:1===p?void 0:p,onChange:function(e){return m(e.value)},placeholder:l||"Add FX"}))}var J=n(76),G=["A","B","C","D","E","F","G"],W=function(e){var t=e.rack,n=e.routingNumber,r=Object(s.useCallback)(function(e){e.target.blur();var n=parseInt(e.target.value);t.currentConfiguration=n},[]),a=t.configurations.map(function(e,t){return{label:G[t],value:parseInt(t)}});return c.a.createElement(J.a,{element:M.rb,className:"routing-chooser"},c.a.createElement("form",null,a.map(function(e){return c.a.createElement("label",{key:e.label},e.label,c.a.createElement("input",{type:"radio",value:e.value,onChange:r,checked:n===e.value}))})))},K=function(e){var t=e.rack,n=e.macrosDisabled,r=e.sequencerEngine,o=e.handleChooseEffect,u=e.setEdges,l=e.setShowMacrosView,f=e.selectedNodes,h=e.setMacros,p=Object(s.useCallback)(function(){t.newMacro(),h(Object(i.a)(t.macros))},[h]),m=Object(s.useCallback)(function(){t.connectNodesInSeries(f),u(Object(a.a)({},t.adjacencyLists))},[u,f,t]),v=t.getEffectType()===d.c?V.e:V.a;return"Rules Rack"===t.name&&(v=V.f),"Chords Rack"===t.name?"":c.a.createElement("div",{className:"rack-toolbar"},c.a.createElement(U,{effect:t,track:t.track,options:v,placeholder:"Rules Rack"===t.name?"+":"Add FX",isMidiEffect:t.getEffectType()===d.c,sequencerEngine:r,handleChooseEffect:o}),t.getEffectType()===d.c&&"Rules Rack"!==t.name?c.a.createElement(U,{track:t.track,isMidiEffect:t.getEffectType()===d.c,effect:t,placeholder:"Flow",options:V.d,sequencerEngine:r,handleChooseEffect:o}):"",n?"":[c.a.createElement("div",{key:1,onClick:p,className:"add-macro-button"},"Add Macro"),c.a.createElement("div",{key:2,onClick:function(){return l(!0)},className:"show-macros-button"},"Macros")],f.length>1?c.a.createElement("div",{onClick:m,className:"add-macro-button"},"Connect Nodes"):"")},X=function(e){var t=e.rack,n=e.routingNumber,r=(e.sequencerEngine,e.setRoutingNumber),a=Object(s.useCallback)(function(){t.newConfiguration()},[]);return c.a.createElement(J.a,{element:M.U,className:"rack-toolbar"},c.a.createElement("div",{onClick:a,className:"new-routing-button"},"New Routing"),c.a.createElement(W,{routingNumber:n,setRoutingNumber:r,rack:t}))},Q=n(220);function Y(e){var t=e.drawingEdge;if(void 0===t)return c.a.createElement("rect",{x:0,y:0,width:0,height:0});var n=t.x1,r=t.y1,a=t.x2,i=t.y2;return c.a.createElement(Q.a,{pointerLength:6,pointerWidth:4,points:[n,r,(n+a)/2,(r+i)/2,a,i,a,i],strokeWidth:2,stroke:"red"})}new O.a;window.dist=4,window.x=1,window.tension=.4,window.baseColor="#2653d173";var Z=function(e,t,n,r){return Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))};function $(e,t){if(void 0!==e){var n=e.context&&(e.context.macro||e.context.subDevice);if(void 0===n||void 0===n.parameters)return 0;var r=n.parameters.filter(function(e){return e.automatable});t.getEffectType()===d.d&&(r=[n.harmonicityParameter,n.modulationIndexParameter]);var a=r.indexOf(e);if(-1!==a)return n.x+8+8*a}}var ee=Object(y.b)(function(e,t){if(t.modulator){var n=t.edge.context&&(t.edge.context.macro||t.edge.context.subDevice);return n?{x2:n.x,y2:n.y}:{x2:0,y2:0}}return t.macro&&t.edge.parameter.context?{x1:t.macro.x,y1:t.macro.y,x2:t.edge.parameter.context.subDevice.x,y2:t.edge.parameter.context.subDevice.y}:t.effect?{x1:t.effect.x,y1:t.effect.y,x2:t.edge.effect.x,y2:t.edge.effect.y}:{x1:0,y1:0,x2:0,y2:0}},null)(function(e){e.width;var t=e.rack,n=e.effect,r=e.edge,a=e.setSelectedEdge,i=e.selected,u=e.modulator,l=e.macro,f=e.startDrawingEdge,h=e.playing,m=e.triggerCount,v=(e.avgTranspose,Object(s.useState)(!1)),b=Object(o.a)(v,2),g=b[0],y=b[1],k=Object(s.useCallback)(function(){t.deleteEdge(r);var e=r.effect.x+8;f(r.effect,p.b,e,r.effect.y,0)},[r]),O=Object(s.useCallback)(function(){t.deleteEdge(r),f(r.fromNode,p.h,r.fromNode.x+8+8*r.outputNumber,r.fromNode.y+p.f[t.getEffectType()],0)},[r]),j=function(e,t,n){if(void 0===t)return{x1:void 0,y1:void 0,x2:void 0,y2:void 0};var r=8+(t.getType()===L.a?4+t.number:t.number)/(e.modulators.length+1)*p.j[e.getEffectType()],a=p.f[e.getEffectType()],i=$(n,e),o=n.context&&(n.context.macro||n.context.subDevice),s=void 0===o?void 0:o.y;return{x1:r,y1:a,x2:i,y2:s}}(t,u,r),w=j.x1,E=j.y1,S=j.x2,P=j.y2;if(l){var x=function(e,t,n){if(void 0===t)return{x1:void 0,y1:void 0,x2:void 0,y2:void 0};var r=t.x+8,a=t.y+p.f[e.getEffectType()],i=$(n,e),o=n.context&&n.context.subDevice.y;return{x1:r,y1:a,x2:i,y2:o}}(t,l,r.parameter);w=x.x1,E=x.y1,S=x.x2,P=x.y2}else u||(w=n.x+8+8*r.outputNumber,E=n.y+p.f[t.getEffectType()],S=r.effect.x+8,P=r.effect.y);var T="edge ";u&&(u.getType()===L.a?T+=" env-edge":T+=" lfo-edge"),l&&(T+=" macro-edge"),i&&(T+=" selected"),t.getEffectType()===d.d&&void 0===u&&(T+=" oscillator-edge",r.operator.synth||(T+=" fm-output-edge")),g&&(T+=" hovered");var C=Object(s.useCallback)(function(){y(!0)},[y]),N=Object(s.useCallback)(function(){y(!1)},[y]),R=Object(s.useCallback)(function(){a(u?{modulator:u,edge:r}:r)},[a,r,u]);if(void 0===S||void 0===P)return[];if(!u&&!l&&void 0===r.gainParameter&&void 0===r.modulation)return[];var M=1;!h||t.getEffectType()!==d.c||g||i?l||u||i||(M=Math.max(.2,r.getWeight(t))):0===m&&(M=.4);var A=[];i&&(A=[c.a.createElement("circle",{strokeWidth:1,onMouseDown:k,stroke:"red",cx:w,cy:E,r:3,fill:"white"}),c.a.createElement("circle",{strokeWidth:1,onMouseDown:O,stroke:"red",cx:S,cy:P,r:3,fill:"white"})]);var q=Math.sqrt(Z(w,E,S,P))*window.dist,D=(Math.abs(P-E),Math.abs(S-w)),I=Math.sqrt(D);S-w<0&&(I*=-1),D<20&&t.getEffectType()!==d.d&&(I+=20-D);var _=[w,E,w+window.x*I,E+q,S-window.x*I,P-q,S,P];return n===r.effect&&(_=[w,E,w-50,E+q,S-50,P-q,S,P]),c.a.createElement("g",null,c.a.createElement(Q.a,{className:T,onMouseOver:C,onMouseLeave:N,tension:window.tension,onMouseDown:R,pointerLength:6,opacity:M,pointerWidth:4,points:_,markerEnd:"",strokeWidth:2}),c.a.createElement(Q.a,{onMouseOver:C,markerEnd:"",onMouseLeave:N,onMouseDown:R,pointerLength:6,pointerWidth:4,tension:window.tension,className:T,opacity:0,points:_,strokeWidth:8}),A)}),te=Object(s.memo)(function(e){var t=e.edges,n=e.rack,r=e.setSelectedEdge,a=e.selectedEdge,o=e.startDrawingEdge,s=(e.stepNumber,e.playing),u=t[-1]||[],l=[],f=function(e){var u=n.effects[e],f=t[u.id];if(void 0===f)return"continue";l=[].concat(Object(i.a)(l),Object(i.a)(f.map(function(e,t){return c.a.createElement(ee,{triggerCount:e.triggerCount,playing:s,effect:u,key:"input-edge- "+t+"-"+u.id,startDrawingEdge:o,edge:e,rack:n,setSelectedEdge:r,selected:a===e})})))};for(var h in n.effects)f(h);return c.a.createElement("g",null,u.map(function(e,t){return c.a.createElement(ee,{key:"edge- "+t,effect:n.inputNode,startDrawingEdge:o,edge:e,rack:n,setSelectedEdge:r,selected:a===e})}),l)}),ne=Object(y.b)(function(e,t){return{stepNumber:t.isMidiEffect?t.rack.sequencerEngine.trackStep:0,playing:t.rack.sequencerEngine.playing}},null)(te);function re(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ie=function(e){var t=Object(s.useRef)([]);return Object(s.useEffect)(function(){e&&(t.current=[].concat(Object(i.a)(t.current),Object(i.a)(e)))},[e]),{getLastNode:function(e){var n=Object(i.a)(t.current);n.reverse();var r,a=re(n);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(e&&!e.includes(o))return o}}catch(s){a.e(s)}finally{a.f()}}}};function oe(e){var t=e.lfoEdges,n=e.envelopeEdges,r=e.rack,a=e.setSelectedEdge,o=e.selectedEdge,s=e.width,u=[],l=function(e){var l=r.modulators[e],f="LFO"===l.getType()?t[l.number]:n[l.number];if(void 0===f)return"continue";var h={};f.forEach(function(e){return h[e.id]=e}),u=[].concat(Object(i.a)(u),Object(i.a)(Object.keys(h).map(function(e){return c.a.createElement(ee,{key:l.getType()+"-"+l.number+"-edge-"+e,modulator:l,edge:h[e],setSelectedEdge:a,width:s,rack:r,selected:!!o&&(o.modulator===l&&o.edge===h[e])})})))};for(var f in r.modulators)l(f);return c.a.createElement("g",null,u)}function se(e){var t=e.macroEdges,n=e.rack,r=e.setSelectedEdge,a=e.selectedEdge,o=[],s=function(e){var s=n.macros[e],u=t[s.id];if(void 0===u)return"continue";o=[].concat(Object(i.a)(o),Object(i.a)(u.map(function(e){return c.a.createElement(ee,{rack:n,macro:s,edge:e,setSelectedEdge:r,selected:a===e})})))};for(var u in n.macros)s(u);return c.a.createElement("g",null,o)}var ce=Object(s.memo)(function(e){var t=e.numberOfModulators,n=e.number,r=(e.startDrawing,e.rack),a=e.setDragging,i=e.connectEdge,o=e.startDrawingEdge,u=e.setSelectedNodes,l=e.drawingEdge,f=e.width,h=(e.height,e.modulator),d=e.selected,m=1*(n+1)/(t+1)*f,v=h.getType()===L.b?"LFO "+h.number:"Env "+h.number,b=Object(s.useCallback)(function(){u([h])},[u,h]);return c.a.createElement("g",null,c.a.createElement("rect",{onMouseDown:b,fill:d?"red":p.c,x:m,y:0,width:35,height:p.e}),c.a.createElement("text",{onMouseDown:b,className:"modulator-node",fill:"white",fontSize:10,fontFamily:"Arial",x:m+3,y:10},v),c.a.createElement(I,{x:m,y:0,number:1,mode:p.h,effect:h,setDragging:a,connectEdge:i,isModulator:!0,rack:r,drawingEdge:l,startDrawingEdge:o}))}),ue=(n(2572),n(274));function le(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fe(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var he=Object(s.memo)(function(e){var t=e.rack,n=e.effect,r=e.x,a=e.y,i=e.text,o=e.hasInput,u=e.hasOutput,l=(e.feedbackParam,e.setDragging),f=e.active,h=e.color,m=e.rackRef,v=e.connectEdge,b=e.startDrawingEdge,g=e.drawingEdge,y=e.selected,k=e.selectedEdge,O=e.setSelectedEdge,j=(e.edges,Object(ue.a)({ref:m,effect:t}).preventDragging);i||(i=n.prettyName||n.name,n.getText&&n.getText()&&(i+=": "+n.getText()),o=!0,u=!0);var w=i?6*i.length:0;w<40&&(w=40);var E=u?[void 0]:[],S=o?[void 0]:[],P=Object(s.useCallback)(function(e){if(j(!1),l){var t=m.current.getBoundingClientRect();l({effect:n,x:e.clientX-t.left-r,y:e.clientY-t.top-a,origX:n.x,origY:n.y})}},[l,r,a]),x=y?"red":h||(t.getEffectType()===d.d?"#ff0076":p.d);y||"Rules Rack"!==t.name&&"Chords Rack"!==t.name||(x="#515151");var T=[];if(!n)return[];n.feedback&&(T=c.a.createElement(Q.a,{strokeWidth:2,className:"oscillator-edge",pointerLength:6,pointerWidth:8,stroke:window.baseColor,fill:window.baseColor,points:[r+8,a+p.f[t.getEffectType()],r-8,a+p.f[t.getEffectType()],r-8,a,r+8,a]}));var C=0,N=y?"selected node":"node";"Rules Rack"!==t.name&&"Chords Rack"!==t.name||(n.action?(C=6,N+=" action"):n.aux&&(N+=" aux"));var R=y?"selected node-text":"node-text";return n.getChordEffectType&&n.getChordEffectType()&&(N+=" chord-"+n.getChordEffectType(),R+=" chord-"+n.getChordEffectType()),c.a.createElement("g",null,c.a.createElement("rect",{className:N,onMouseDown:function(e){return P(e)},fill:x,opacity:void 0===n.enabledParameter?1:n.enabledParameter.get()?1:.2,rx:C,x:r,y:a,width:w,height:p.f[t.getEffectType()]}),f?c.a.createElement("circle",{cx:r+w-5,cy:a+10,r:2,fill:"green",className:"active"}):"",c.a.createElement("text",{onMouseDown:function(e){return P(e)},className:R,fill:"white",fontSize:9,fontFamily:"Arial",x:r+3,y:t.getEffectType()===d.d?a+15:a+12},i),S.map(function(e,i){return c.a.createElement(I,{x:r,y:a,key:"intput-"+i,number:i+1,mode:p.b,parameter:e,effect:n,connectEdge:v,rack:t,drawingEdge:g,selectedEdge:k,startDrawingEdge:b})}),E.map(function(e,i){return c.a.createElement(I,{key:"output-"+i,x:r,y:a,parameter:e,setSelectedEdge:O,selectedEdge:k,rack:t,drawingEdge:g,number:i+1,mode:p.h,connectEdge:v,startDrawingEdge:b,effect:n})}),T)}),pe=Object(y.b)(function(e,t){if(void 0!==t.x)return{};var n={};if(t.effect.getVisualizedParameters){var r,i=le(t.effect.getVisualizedParameters());try{for(i.s();!(r=i.n()).done;){var o=r.value;n[o.id]=o.get(!0)}}catch(s){i.e(s)}finally{i.f()}}return Object(a.a)({},n,{x:t.effect.x,active:t.effect.active,y:t.effect.y,value:t.effect.value,feedbackParam:t.effect.feedback,enabled:t.effect.enabledParameter&&t.effect.enabledParameter.get()})},null)(he),de=Object(s.memo)(function(e){var t=e.macro,n=e.x,r=e.y,a=e.rack,i=e.setDragging,o=e.connectEdge,u=e.startDrawingEdge,l=e.drawingEdge,f=e.selected,h=e.selectedEdge,d=e.setSelectedEdge,m=e.rackRef,v=(e.edges,t.name),b=8+6*v.length,g=Object(s.useCallback)(function(e){if(i){var a=m.current.getBoundingClientRect();i({effect:t,x:e.clientX-a.left-n,y:e.clientY-a.top-r})}},[i,n,r]),y=f?"red":"#0e2474b8";return c.a.createElement("g",null,c.a.createElement("rect",{className:f?"macro selected node":"macro",onMouseDown:function(e){return g(e)},fill:y,x:n,y:r,width:b,height:p.e}),c.a.createElement("text",{className:f?"macro selected node-text":"macro-text",onMouseDown:function(e){return g(e)},fill:"white",fontSize:10,fontFamily:"Arial",x:n+3,y:r+10},v),[0].map(function(e,i){return c.a.createElement(I,{key:"output-"+i,x:n,y:r,rack:a,parameter:e,setSelectedEdge:d,selectedEdge:h,drawingEdge:l,number:i+1,mode:p.h,connectEdge:o,startDrawingEdge:u,effect:t})}))}),me=Object(y.b)(function(e,t){return{x:t.macro.x,y:t.macro.y}},null)(de),ve=n(847),be=(n(1382),function(e){var t=e.macro,n=e.sequencerEngine,r=Object(s.useState)(t.name),a=Object(o.a)(r,2),i=a[0],u=a[1],l=t.subMacros,f=Object(s.useCallback)(function(e){t.name=e.target.value,u(t.name)},[u]);return c.a.createElement("div",{className:"macro-details"},c.a.createElement("input",{type:"text",className:"name-editor",value:i,onChange:f,placeholder:"Enter macro's name"}),c.a.createElement(w.a,{effectNumber:0,automation:void 0,name:t.name,selectedParameter:void 0,sequencerEngine:n,lfoEnabled:!0,parameter:t.macroParameter,isParameter:!0,onParameterChanged:function(){return[]},step:.01,max:1,min:0}),l.map(function(e){return c.a.createElement(ve.a,{macro:t,subMacro:e})}))});function ge(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}window.rackColor="#0e24741f";t.a=Object(y.b)(function(e,t){var n;return n={loaded:t.effect.loaded,isSelected:e.effects.selectedEffect===t.effect.id,routingNumber:t.effect.currentConfiguration,algorithm:t.effect.algorithmParameter&&t.effect.algorithmParameter.get(),copiedNodes:e.effects.copiedNodesForRack,numEffects:t.effect&&t.effect.effects?t.effect.effects.length:0,effects:t.effect.effects,adjacencyLists:t.effect.adjacencyLists,selectedParameter:e.effects.accumulatorParameterSelected},Object(r.a)(n,"isSelected",e.effects.selectedEffect===t.effect.id),Object(r.a)(n,"pulledEffects",e.effects.pulledEffects),n},function(e,t){return{setNodePosition:function(n,r,a){return e(Object(l.Xb)(t.effect.id,n,r,a))},setCopiedNodes:function(t){return e(Object(l.vb)(t))},setContextualHelp:function(t){return e(Object(l.ub)(t))}}})(function(e){var t=e.effect,n=Object(s.useRef)(void 0),r=e.routingNumber,u=e.macrosDisabled,f=Object(s.useState)(void 0),h=Object(o.a)(f,2),v=h[0],b=h[1],O=Object(s.useState)(void 0),j=Object(o.a)(O,2),w=j[0],M=j[1],A=Object(s.useState)(t.effects),q=Object(o.a)(A,2),D=q[0],I=q[1],_=Object(s.useState)(void 0),B=Object(o.a)(_,2),z=B[0],V=B[1],H=Object(s.useState)(t.adjacencyLists),U=Object(o.a)(H,2),J=U[0],G=U[1],W=Object(s.useState)(t.lfoAdjacencyLists),Q=Object(o.a)(W,2),Z=Q[0],$=Q[1],ee=Object(s.useState)(t.envelopeAdjacencyLists),te=Object(o.a)(ee,2),re=te[0],ae=te[1],ue=Object(s.useState)(t.macroAdjacencyLists),le=Object(o.a)(ue,2),fe=le[0],he=le[1],de=Object(s.useState)(t.modulators),ve=Object(o.a)(de,2),ye=ve[0],ke=ve[1],Oe=Object(s.useState)(t.macros),je=Object(o.a)(Oe,2),we=je[0],Ee=je[1],Se=Object(s.useState)(t.macros&&t.macros.length>0),Pe=Object(o.a)(Se,2),xe=Pe[0],Te=Pe[1],Ce=Object(s.useState)(void 0),Ne=Object(o.a)(Ce,2),Re=Ne[0],Me=Ne[1],Ae=Object(s.useState)([]),qe=Object(o.a)(Ae,2),De=qe[0],Ie=qe[1],_e=ie(De).getLastNode,Fe=e.copiedNodes,Le=e.setCopiedNodes,Be=De[0];void 0===e.isDraggable||e.isDraggable,Object(s.useEffect)(function(){G(t.adjacencyLists)},[t.adjacencyLists]);var ze=t.getEffectType()===d.d?200:p.i,Ve=t.getEffectType()===d.d?90:p.a;Object(s.useEffect)(function(){e.selectedParameter&&e.selectedParameter.context&&(e.selectedParameter.context.effect===t&&Ie([e.selectedParameter.context.subDevice]),t.effects.includes(e.selectedParameter.isMapped)&&Ie([e.selectedParameter.isMapped]))},[e.selectedParameter,t,Ie]),Object(s.useEffect)(function(){I(t.effects)},[t.effects,I]);var He=Object(s.useCallback)(function(n){console.log("rack.id = ",t.id);var r=100,a=Ve/3;Be&&void 0===Be.getType&&(r=Be.x,a=Be.y);var o=Object(m.a)(r,a,t),s=o.x,c=o.y;t.addEffect(n),n.x=s,n.y=c,e.setNodePosition(n.id,s,c),Ie([n]),I(Object(i.a)(t.effects)),setTimeout(function(){e.setContextualHelp(n)},25)},[I,Ie,Be,t]);Object(s.useEffect)(function(){t.setSize(ze,Ve,p.g,p.e),I(Object(i.a)(t.effects))},[I,t]),Object(s.useEffect)(function(){ke(t.modulators),$(t.lfoAdjacencyLists),ae(t.envelopeAdjacencyLists)},[t.loaded,ke,$,ae]),Object(s.useEffect)(function(){},[De]),Object(s.useEffect)(function(){w&&(-1===De.indexOf(w.effect)&&(Ie([w.effect]),e.setContextualHelp(w.effect)),Me(void 0))},[w,Ie,b,De,Me]),Object(s.useEffect)(function(){e.setSelectedOscillator&&e.setSelectedOscillator(De[0])},[De]),Object(s.useEffect)(function(){return function(){Le([])}},[]);var Ue=Object(s.useCallback)(function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:z;if(void 0!==r){if(n===p.b){if(r.mode===p.b)return;t.connectNodes(r.node,e,r.outputNumber)}else{if(r.mode===p.h)return;t.connectNodes(e,r.node,r.outputNumber)}G(Object(a.a)({},t.adjacencyLists)),$(Object(a.a)({},t.lfoAdjacencyLists)),ae(Object(a.a)({},t.envelopeAdjacencyLists)),he(Object(a.a)({},t.macroAdjacencyLists))}},[z,G,ae,$,he]);g({rack:t,selectedEdge:v,selectedNodes:De,selectedNode:Be,setContextualHelp:e.setContextualHelp,setEdges:G,setEffects:I,sequencerEngine:e.sequencerEngine,isSelected:e.isSelected,connectEdge:Ue,setCopiedNodes:Le,copiedNodes:Fe,setSelectedNodes:Ie,setLfoEdges:$,setEnvelopeEdges:ae,getLastNode:_e,setMacros:Ee,setMacroEdges:he}),Object(s.useEffect)(function(){Be&&b(void 0)},[Be,b]),Object(s.useEffect)(function(){v&&(e.setContextualHelp(void 0),Ie([]))},[v,Ie]);var Je=function(e){var t=n.current.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},Ge=Object(s.useCallback)(function(t){t.stopPropagation(),e.isSelected;var n=Je(t),r=n.x,a=n.y;Me({x1:r,y1:a,x2:r,y2:2})},[Me,e.isSelected,t]),We=Object(s.useCallback)(function(t){if(w){var n=Je(t),r=n.x-w.x,i=n.y-w.y,o=w.effect;o.x=r,o.y=i,e.setNodePosition(o.id,r,i);var s,c=ge(De);try{for(c.s();!(s=c.n()).done;){var u=s.value;if(u!==o){void 0===u._x&&(u._x=u.x),void 0===u._y&&(u._y=u.y);var l=u._x+(r-w.origX),f=u._y+(i-w.origY);u.x=l,u.y=f,e.setNodePosition(u.id,l,f)}}}catch(d){c.e(d)}finally{c.f()}Me(void 0)}else{if(z){var h=Je(t);return V(Object(a.a)({},z,{x2:h.x,y2:h.y})),void Me(void 0)}if(Re){var p=Je(t);Me(Object(a.a)({},Re,{x2:p.x,y2:p.y}))}}},[w,D,De,I,z,V,Re,Me]),Ke=Object(s.useCallback)(function(n){if(M(void 0),V(void 0),Re){var r=Re.x1,a=Re.x2,i=Re.y1,o=Re.y2,s=t.effects.filter(function(e){var t=e.x,n=e.y;return t>=r&&t<=a&&n>=i&&n<=o});s.forEach(function(e){e._x=void 0,e._y=void 0}),e.setContextualHelp(s[0]),Ie(s),Me(void 0)}De.forEach(function(e){e._x=void 0,e._y=void 0}),e.isSelected},[M,V,Me,Re,Ie,t,De,e.isSelected]),Xe=Object(s.useCallback)(function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;V({node:e,mode:t,x1:n,y1:r,x2:n,y2:r,outputNumber:a}),b(void 0)},[V,b]),Qe="";if(v||t.getEffectType()!==d.d||(Qe=c.a.createElement(E,{color:e.color,oscillator:Be,setSelectedNode:function(e){return Ie(e?[e]:[])},instrument:t,sequencerEngine:e.sequencerEngine})),Be&&"Rules Rack"!==t.name&&"Chords Rack"!==t.name&&(t.isMacro(Be)?Qe=c.a.createElement(be,{sequencerEngine:e.sequencerEngine,macro:Be}):Be.getType?Qe=Be.getType()===L.b?c.a.createElement(x.a,{hideSelection:!0,sequencerEngine:e.sequencerEngine,lfo:Be.context.lfoTrack}):c.a.createElement(T.a,{hideSelection:!0,sequencerEngine:e.sequencerEngine,envelopeTrack:Be.context.envelopeTrack}):Be&&Be.getEffectType&&(Be.getEffectType()===d.c?Qe=c.a.createElement(C.a,{isPulled:e.pulledEffects.includes(Be),hideBarButtons:!0,sequencerEngine:e.sequencerEngine,onDeleteEffect:function(){return[]},scrollContainer:e.scrollContainer,effect:Be,track:e.track,send:e.send}):Be.getEffectType()===d.a&&(Qe=c.a.createElement(S.a,{isPulled:e.pulledEffects.includes(Be),hideBarButtons:!0,sequencerEngine:e.sequencerEngine,onDeleteEffect:function(){return[]},scrollContainer:e.scrollContainer,effect:Be,track:e.track,send:e.send})))),v)if(v.effect&&"Rules Rack"!==t.name&&"Chords Rack"!==t.name)Qe=c.a.createElement(R,{rack:t,edge:v,sequencerEngine:e.sequencerEngine});else if(v.modulator){var Ye=v.edge;Qe=c.a.createElement("div",{className:"edge-properties"},c.a.createElement("div",null,"Parameter Mod Properties: "),c.a.createElement(N.a,{parameters:[Ye]}))}var Ze={setSelectedEdge:b,setSelectedNodes:Ie,selectedEdge:v,setDragging:M,rack:t,startDrawingEdge:Xe,drawingEdge:z,connectEdge:Ue};return xe?c.a.createElement(P,{macros:we,setShowMacrosView:Te,sequencerEngine:e.sequencerEngine}):J&&D?c.a.createElement("div",{className:"effect-rack"},c.a.createElement(K,{macrosDisabled:u,setEdges:G,selectedNodes:De,rack:t,setMacros:Ee,sequencerEngine:e.sequencerEngine,setShowMacrosView:Te,handleChooseEffect:He}),c.a.createElement("div",{className:"horizontal"},c.a.createElement("div",{draggable:"true",onDragStart:function(e){return e.preventDefault()},onMouseLeave:function(){return Object(l.ub)(void 0)},className:"draw-component"},c.a.createElement("svg",{className:"rack-canvas",ref:n,width:ze,height:Ve,onMouseDown:Ge,onMouseUp:Ke,onMouseMove:We},c.a.createElement(y.a,{store:e.sequencerEngine.store},c.a.createElement("g",null,t.getEffectType()!==d.d&&c.a.createElement(oe,{width:ze,envelopeEdges:re,lfoEdges:Z,rack:t,setSelectedEdge:b,selectedEdge:v}),c.a.createElement(se,{macroEdges:fe,rack:t,setSelectedEdge:b,selectedEdge:v}),t.getEffectType()!==d.d&&"Rules Rack"!==t.name&&"Chords Rack"!==t.name&&ye.map(function(e,n){return c.a.createElement(ce,Object.assign({number:n,key:n},Ze,{width:ze,rack:t,height:Ve,modulator:e,selected:Be===e,numberOfModulators:ye?ye.length:0}))}),we.map(function(e,r){return c.a.createElement(me,Object.assign({rackRef:n,key:r,number:r},Ze,{width:p.i,rack:t,height:p.a,macro:e,selected:Be===e,numberOfModulators:ye?ye.length:0}))}),c.a.createElement(ne,{edges:J,rack:t,isMidiEffect:t.getEffectType()===d.c,startDrawingEdge:Xe,setSelectedEdge:b,selectedEdge:v}),D.filter(function(e){return De.indexOf(e)>-1}).map(function(e,r){return c.a.createElement(pe,Object.assign({},Ze,{rackRef:n,selected:!0,key:"node-"+e.id+"-"+r,rack:t,edges:J[e.id],effect:e}))})),c.a.createElement("g",null,D.filter(function(e){return-1===De.indexOf(e)}).map(function(r,a){return c.a.createElement(pe,Object.assign({},Ze,{rackRef:n,color:e.color,selected:!1,key:"node-"+r.id,rack:t,edges:J[r.id],effect:r}))})),c.a.createElement("g",null,c.a.createElement(Y,{drawingEdge:z}),we.map(function(e){return c.a.createElement(F,{key:"macro-"+e.id,setSelectedEdge:b,selectedEdge:v,rack:t,setDragging:M,startDrawingEdge:Xe,drawingEdge:z,connectEdge:Ue,edges:fe[e.id],effect:e})}),D.filter(function(e){return Be===e}).map(function(e,n){return c.a.createElement(F,{key:"node-"+e.id,setSelectedEdge:b,selectedEdge:v,rack:t,setDragging:M,startDrawingEdge:Xe,drawingEdge:z,connectEdge:Ue,edges:J[e.id],effect:e})}),D.filter(function(e){return Be!==e}).map(function(e,n){return c.a.createElement(F,{key:"node-"+e.id,setSelectedEdge:b,selectedEdge:v,rack:t,setDragging:M,startDrawingEdge:Xe,drawingEdge:z,connectEdge:Ue,edges:J[e.id],effect:e})}),t.getEffectType()!==d.d&&"Rules Rack"!==t.name&&"Chords Rack"!==t.name?c.a.createElement(pe,{hasOutput:!0,effect:t.inputNode,rackRef:n,rack:t,text:"Input",x:0,startDrawingEdge:Xe,setSelectedEdge:b,selectedEdge:v,edges:J[-1],connectEdge:Ue,y:Ve/2-p.e/2}):[],t.outputNodeX?[c.a.createElement(pe,{key:1,hasInput:!0,color:e.color,rackRef:n,text:"X",startDrawingEdge:Xe,setSelectedEdge:b,rack:t,selectedEdge:v,effect:t.outputNodeX,x:ze-32,connectEdge:Ue,y:10}),c.a.createElement(pe,{key:2,hasInput:!0,text:"Y",color:e.color,rackRef:n,startDrawingEdge:Xe,setSelectedEdge:b,rack:t,selectedEdge:v,effect:t.outputNodeY,x:ze-32,connectEdge:Ue,y:45})]:"Rules Rack"!==t.name&&"Chords Rack"!==t.name&&c.a.createElement(pe,{hasInput:!0,text:"Output",rackRef:n,startDrawingEdge:Xe,key:3,setSelectedEdge:b,rack:t,selectedEdge:v,effect:t.outputNode,x:ze-p.g,connectEdge:Ue,y:Ve/2-p.e/2}),c.a.createElement(k,{mouseSelection:Re}))))),Qe),c.a.createElement(X,{routingNumber:r,rack:t})):[]})},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(85),h=n(32),p=n(221),d=n(6),m=n(15),v=n.n(m);function b(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var g=n(33),y=n(101),k=n(21),O=n(248);function j(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var S=function(e){Object(c.a)(n,e);var t=E(n);function n(e){var r,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2?arguments[2]:void 0;return Object(a.a)(this,n),(r=t.call(this,"Warp",e,s)).stepsWhileInReverse=0,window.warp=Object(o.a)(r),r.lastForwardPercentage=0,i&&(r.enabledParameter=new k.a("enabled",Object(o.a)(r),function(e,t){return r.onEnable(t)},{min:!1,max:!0,unit:"",defaultValue:!0,automatable:!1}),r.registerParameter(r.enabledParameter)),r.warpLengthParameter=new k.a("warpLength",Object(o.a)(r),function(e,t){return[]},{documentation:"Controls the tempo of the sample in proportion to the project tempo. A higher number makes the sample slower, and more time-stretched.",defaultValue:1,min:.05,max:16,unit:"bars",prettyName:"Warp Length"}),r.registerParameter(r.warpLengthParameter),r.warpFactorParameter=new k.a("warpFactor",Object(o.a)(r),function(e,t){return[]},{documentation:"Multiples the Warp Speed by this whole number. A quick way to double or half the sample tempo",defaultValue:2,min:1,max:8,unit:"",prettyName:"Warp Factor"}),r.registerParameter(r.warpFactorParameter),r.glideParameter=new k.a("glide",Object(o.a)(r),function(e,t){return[]},{defaultValue:1,min:0,max:4,unit:"",automatable:!1}),r.registerParameter(r.glideParameter),r.resolutionParameter=new O.a("resolution",Object(o.a)(r),function(e,t){return t},{documentation:"The rate at which we trigger each warped grain.",min:0,max:1,unit:"",prettyName:"Rate",options:{0:new g.a(4,!1),.1:new g.a(4,!0),.2:new g.a(8,!1),.3:new g.a(8,!0),.4:new g.a(16,!1),.5:new g.a(16,!0),.6:new g.a(32,!1),.7:new g.a(32,!0)},defaultValue:new g.a(16,!1)}),r.registerParameter(r.resolutionParameter),r.loopLengthParameter=new k.a("loopLength",Object(o.a)(r),function(e,t){return[]},{documentation:"The % of the sample-loop we will go through before looping back.",defaultValue:100,min:0,max:100,unit:"%",prettyName:"Loop Length"}),r.registerParameter(r.loopLengthParameter),r.durationFactorParameter=new k.a("durationFactor",Object(o.a)(r),function(e,t){return[]},{documentation:"The duration of each grain to be triggered (according to the warp-rate).",defaultValue:1,min:0,max:2,unit:"",prettyName:"Grain Size"}),r.registerParameter(r.durationFactorParameter),r.smoothnessParameter=new k.a("smoothness",Object(o.a)(r),function(e,t){return[]},{documentation:"Controls the attack/release of each grain, smoothing them out. Higher numbers mean smoother transitions (higher attack/release)",defaultValue:1,min:.1,max:20,unit:"",prettyName:"Smoothness"}),r.registerParameter(r.smoothnessParameter),r.sliceRetriggerParameter=new k.a("sliceRetrigger",Object(o.a)(r),function(e,t){return[]},{defaultValue:!0,min:!1,max:!0,unit:"",automatable:!1}),r.registerParameter(r.sliceRetriggerParameter),r.noteToDuration={},r.noteToOriginalDuration={},r.noteToTrigger={},r.stepNumberTriggered=0,r.notes={},r.times=[],r}return Object(i.a)(n,[{key:"documentation",get:function(){return["Syncs a sample to the project tempo, dividing the \nsample into many pieces (according to the warp-rate), and triggering them at this rate.","Track needs to be playing to work."]}},{key:"getVisualizedParameters",value:function(){return[this.resolutionParameter].concat(Object(r.a)(Object(s.a)(Object(l.a)(n.prototype),"getVisualizedParameters",this).call(this)))}},{key:"getText",value:function(){return this.resolutionParameter.get().toString()}},{key:"onEnable",value:function(e){(this.track.sequencerEngine.store.getState().tracks.trackWarps[this.track.subSequence.id]||{})[this.track.trackNumber]!==e&&this.track.sequencerEngine.store.dispatch(Object(d.nh)(this.track.subSequence.id,this.track.trackNumber,e))}},{key:"releaseAll",value:function(e){this.notes={},this.noteToTrigger={},this.noteToDuration={}}},{key:"isNothingPlaying",value:function(){return b(this.noteToTrigger)&&b(this.notes)}},{key:"input",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(s.a)(Object(l.a)(n.prototype),"input",this).call(this,e,t);var r=e.stepNumber,a=e.stepData.transpose,i=e.stepData.slice,o=e.time;if(this.isNothingPlaying()&&this.sliceRetrigger&&(this.stepNumberTriggered=void 0,this.lastLeaf=void 0,this.lastLeafStep=void 0),t)if(this.gated){var c=this.notes[a]||[];c.push({slice:i,time:o}),this.notes[a]=c}else(this.isNothingPlaying()||0==r||this.sliceRetrigger)&&(this.stepNumberTriggered=r,this.stepsWhileInReverse=0),this.releaseAll(),this.notes[a]=[{slice:i,time:o}];else{var u=2*e.stepData.duration;(!this.gated||this.track.rolling&&this.sequencerEngine.isSequenceRolling)&&(this.clear(!1),(this.sliceRetrigger||0===r)&&(this.stepNumberTriggered=r,this.stepsWhileInReverse=0)),void 0===this.noteToDuration[a]&&(this.noteToDuration[a]=0),this.noteToDuration[a]=u,this.noteToOriginalDuration[a]=u,this.noteToTrigger[a]=e}}},{key:"getLastTime",value:function(e){for(var t=this.times.length-1;t>=0;t--){var n=this.times[t];if(n<e)return n}return this.times[this.times.length-1]}},{key:"getDurationElapsed",value:function(e){var t=e-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.stepNumberTriggered);return t<0&&(t+=this.track.length),t}},{key:"output",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v.a.Master.context.currentTime,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,o=[];a||this.times.push(t),this.currentStep=n;var s=this.getDurationElapsed(n);s=isNaN(s)?0:s;var c=Object(p.a)(s,this.resolution);for(var u in this.noteToTrigger){var l=this.noteToTrigger[u];for(var f in void 0===l.offset&&(l.offset=l.time-t),c)this.getTrigger(l.stepData,u,t+c[f].time+l.offset,n,r,l.stepData.slice).forEach(function(e){o.push(e)})}var h=function(s){var u=e.notes[s],l=function(l){var f=u[l],h=f.slice,d=f.offset;if(void 0===d){var m=e.getLastTime(t);d=t-m,u[l].offset=d}if(a){var b,g=j(i);try{var y=function(){var r=b.value,a=r-n,i=Object(p.a)(a,e.resolution),c=a*(new v.a.Time("32n").toMilliseconds()/1e3);i.forEach(function(n){return e.getTrigger(e.track.trackData,s,0===a?void 0:t+c+n.time,r,r,h).forEach(function(t){e.sampler&&0===a&&!e.gated&&e.sampler.releaseAll(v.a.Master.context.currentTime),e.lastTriggerTime=t.time,o.push(t)})})};for(g.s();!(b=g.n()).done;)y()}catch(O){g.e(O)}finally{g.f()}}else for(var k in c)e.getTrigger(e.track.trackData,s,t+c[k].time+d,n,r,h).forEach(function(t){t.time,e.lastTriggerTime;e.lastTriggerTime=t.time,t.stepData.track=e.track,o.push(t)})};for(var f in u)l(f)};for(var d in this.notes)h(d);for(var m in this.noteToDuration)this.gated&&(this.noteToDuration[m]=Math.max(0,this.noteToDuration[m]-1),this.noteToDuration[m]<=0&&(this.track.rolling&&this.sequencerEngine.isSequenceRolling||delete this.noteToTrigger[m]));return o}},{key:"addNote",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,a=this.getStep(this.track.trackData,e,null,!1);a.velocity=this.track.trackData.velocity,a.duration=null,a.transpose=e,a.slice=t,this.input(new y.a(a,r,n+1),!0)}},{key:"removeNote",value:function(e,t){if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:!this.gated)&&void 0!==this.notes[e]){var n=this.notes[e];this.notes[e].map(function(e){return e.slice}).indexOf(t);n=n.filter(function(e){return e.slice!==t}),this.notes[e]=n,0===this.notes[e].length&&delete this.notes[e]}}},{key:"getStepPercentage",value:function(e,t,n){return 100*this.getDurationElapsed(e,n)/(32*this.getSliceWarpLength(t))/(this.warpLength*this.warpFactor)}},{key:"getSliceWarpLength",value:function(){var e=this.track.tempo,t=this.track.sequencerEngine.bpm;return void 0===e||null===e||0===e?1:e/t}},{key:"getSliceLoopLength",value:function(e,t){var n=void 0;if(this.track.isFrozen||this.track.isAudioTrack){var r,a=j(this.track.frozenColumns);try{for(a.s();!(r=a.n()).done;){var i=r.value;i.frozenSamplers[i.playing]&&(n=i.frozenSamplers[i.playing])}}catch(u){a.e(u)}finally{a.f()}}else if(this.track.instrument&&this.track.instrument.getSampler){var o=this.track.instrument.getSampler(e);o.samplers&&(n=o.samplers[0])}else n=this.track.getSamplers()[0];if(void 0===n)return 8;var s=n.getSlice(t),c=s.endTime-s.startTime;return 100*this.getBarInSeconds()/c}},{key:"getBarInSeconds",value:function(){return 64*new v.a.Time("32n").toMilliseconds()/1e3}},{key:"getTrigger",value:function(e,t,n,r,a,i){var o;this.track&&(r+=this.track.sequencerEngine.stepNumberOffset||0,a+=this.track.sequencerEngine.stepNumberOffset||0),void 0===this.stepNumberTriggered&&(this.gated||this.sliceRetrigger||this.isNothingPlaying())&&(this.stepNumberTriggered=r,this.stepsWhileInReverse=0),t=parseFloat(t);var s=this.gated&&e.duration<1?e.duration:1,c=this.getStep(e,t,s,!0);if(this.track.sequencerEngine.reverse){var u=this.getSliceLoopLength(t,i);o=this.getStepPercentage(r,i,this.lastForwardStepNumber);var l=100-this.lastForwardStart,f=(this.getSliceWarpLength(),l+o/100*u);c.start=f%this.loopLength,this.lastReverseStart=c.start,this.stepsWhileInReverse+=2}else{if(o=this.getStepPercentage(r,i),this.stepsWhileInReverse>0)o-=2*this.getStepPercentage(this.stepsWhileInReverse,i);this.getSliceLoopLength(t,i);this.lastForwardStepNumber=r,c.start=o*this.getSliceLoopLength(t,i)/100%this.loopLength,this.lastForwardStart=c.start}return c.slice=i,c.duration*=this.durationFactor,c.attack+=8*this.smoothness,0===o?c.attack/=2:c.attack*=2,void 0===this.track.instrument&&(c.release+=2*this.smoothness),[new y.a(c,n,a)]}},{key:"sampler",get:function(){return this.track.getSamplers()[0]}},{key:"gated",get:function(){return!this.track.isFrozen&&!this.track.isAudioTrack&&this.track.gated}},{key:"isRealTime",value:function(){return!0}},{key:"onNewStep",value:function(){}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.noteToDuration={},this.noteToTrigger={},e&&(this.stepNumberTriggered=void 0,this.stepsWhileInReverse=0),this.notes={},this.times=[]}},{key:"durationFactor",get:function(){return this.durationFactorParameter.get()},set:function(e){return this.durationFactorParameter.set(e)}},{key:"glide",get:function(){return this.glideParameter.get()},set:function(e){return this.glideParameter.set(e)}},{key:"warpFactor",get:function(){return this.warpFactorParameter.get()},set:function(e){return this.warpFactorParameter.set(e)}},{key:"warpLength",get:function(){return this.warpLengthParameter.get()},set:function(e){return this.warpLengthParameter.set(e)}},{key:"loopLength",get:function(){return this.loopLengthParameter.get()},set:function(e){return this.loopLengthParameter.set(e)}},{key:"smoothness",get:function(){return this.smoothnessParameter.get()},set:function(e){return this.smoothnessParameter.set(e)}},{key:"resolution",get:function(){return(new g.a).fromJson(this.resolutionParameter.get())},set:function(e){return this.resolutionParameter.set(e)}},{key:"sliceRetrigger",get:function(){return this.sliceRetriggerParameter.get()},set:function(e){return this.sliceRetriggerParameter.set(e)}},{key:"getNextTriggerStep",value:function(e){var t=32/this.resolution.resolution;return e+(t-e%t)}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"fromJson",value:function(e,t){var r=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(h.a)(this.resolutionParameter,new g.a(16,!1).fromJson(e.resolution),r),r}}]),n}(f.a);t.a=S},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(130),u=n(434),l=n(527);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e,a,i){var o;return Object(r.a)(this,n),(o=t.call(this,e,a.getType())).event=a,o.duration=i,o}return Object(a.a)(n,[{key:"addEvent",value:function(e,t,n){e.isDeterministic()?new l.a(this.mix,e,t,n).execute():new u.a(this.mix,e,t,n).execute()}},{key:"execute",value:function(){if(!isNaN(this.event.step)){for(var e in this.events){var t=this.events[e];if(!t.isPrunable()&&void 0!==t.duration&&t.step<this.event.step&&t.step+t.duration>this.duration+this.event.step){var n=t.getCopy(this.mix.sequencerEngine);return n.step=this.event.step,void this.addEvent(n,0,n.step)}}this.addEvent(this.event,0,this.event.step)}}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(9),a=n(0),i=n.n(a),o=n(39),s=n.n(o),c=10;function u(e){function t(e){var t=e.getName();return void 0===t?"":t.length>=c?t.slice(0,c)+"...":t}function n(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.track;if(n)return{value:n,label:n.trackNumber+1+". "+t(n)}}var a=e.className?e.className+" tracks-dropdown-container":"tracks-dropdown-container";return i.a.createElement("div",{className:a},i.a.createElement(s.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:function(){var t=e.sequencerEngine.tracks.filter(function(t){return void 0===e.trackToSkip||t!==e.trackToSkip}).map(n);return[{label:"None",value:null}].concat(Object(r.a)(t))}(),onChange:function(t){return e.onSelectTrack(t.value)},value:n(),placeholder:"Track"}))}},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(6),s=n(22),c=n(29),u=n(106),l=n(835),f=n(12),h=Object(f.b)(function(e,t){return{value:t.parameter.get(),automations:t.parameter.automations&&t.parameter.automations.length>0}},function(e){return{setShowPianoRoll:function(t){return e(Object(o.Wf)(t))},setShowAutomation:function(t){return e(Object(o.Hf)(t))},setTrackAutomationParameter:function(t,n){return e(Object(o.Ng)(t,n))},setBottomMode:function(t){return e(Object(o.D)(t))}}})(function(e){var t=e.parameter,n=e.value,o=e.fullText,s=e.automations,c=e.setShowAutomation,f=e.setShowPianoRoll,h=e.setBottomMode,p=e.setTrackAutomationParameter,d=e.setParameter,m=e.selectedParameter,v=Object(a.useState)(!1),b=Object(r.a)(v,2),g=(b[0],b[1],"Attack"===t.name?o?"Atk":"A":"Decay"===t.name?o?"Dec":"D":"Sustain"===t.name?o?"Sus":"S":"Level"===t.name?"L":o?"Rel":"R"),y="env-param";return"Sustain"===t.name&&(y+=" sustain"),t===m&&(y+=" selected"),i.a.createElement("div",{onClick:function(){return d(t===m?void 0:t)},className:y},i.a.createElement(l.a,{parameter:t}),g,": ",i.a.createElement("span",{className:"param-val"},"Sustain"===t.name||"L"===g?Math.round(10*n)/10:Math.round(n)),s?i.a.createElement("img",{onClick:function(){if(c(!0),f(!0),h(u.d),t.track){var e=t.track.instrumentRack?t.track.instrumentRack:t.track;p(e.id,t)}},className:"automation-icon",src:"/automation-icon-disabled.png"}):"")}),p=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.selectedParameter,n=e.setParameter,r=e.envelope,a=e.hasRelease,o=e.hasLevel,s=e.fullText,c=[r.attackParameter,r.decayParameter,r.sustainParameter];return a&&c.push(r.releaseParameter),o&&c.push(r.levelParameter),i.a.createElement("div",{className:"env-params"},c.map(function(e,r){return i.a.createElement(h,{key:"param-"+r,selectedParameter:t,setParameter:n,parameter:e,fullText:s})}))}),d=n(34),m=n(76),v=Math.sqrt(8e3),b=Math.sqrt(1e4),g=function(e,t,n){return 5+.8*n*Math.sqrt(e)/Math.max(v,t)},y=new c.a,k=function(e,t,n,r,a){for(var o=[],s=function(s){var c=2===s?a?[t.attackParameter,t.levelParameter]:[t.attackParameter]:4===s?[t.decayParameter,t.sustainParameter]:6===s?[t.sustainParameter,t.releaseParameter]:[t.releaseParameter],u=e[s],l=e[s+1],f=(e[s+2],e[s+3],!1);n&&(f=n[0]===c[0]),o.push(i.a.createElement("circle",{key:s,onMouseDown:function(e){e.stopPropagation(),r(c)},cx:u,cy:l,r:3,className:f?"selected point":"point",fill:"#2fffec",strokeWidth:2}))},c=2;c<e.length-3;c+=2)s(c);return o},O=function(e,t,n,r){for(var a=[],o=0;o<e.length-3;o+=2){var s=e[o],c=e[o+1],u=e[o+2],l=e[o+3];a.push(i.a.createElement("polygon",{key:"poly-"+o,points:[s,t,s,c,u,l,u,t],fill:r||"red",strokeWidth:1})),a.push(i.a.createElement("line",{key:"line-"+o,x1:s,y1:c,x2:u,y2:l,strokeWidth:2,stroke:n||"red"}))}return a};t.a=Object(f.b)(function(e,t){var n=t.envelope;return{attack:n.attackParameter.get(),decay:n.decayParameter.get(),sustain:n.sustainParameter.get(),release:n.releaseParameter.get(),level:n.levelParameter&&n.levelParameter.get(),selectedParameter:e.effects.accumulatorParameterSelected}},function(e){return{setParameterSliderDown:function(t){return e(Object(o.Sd)(t))},setPullablePartDragging:function(t){return e(Object(o.ve)(t))}}})(function(e){var t=e.draggable,n=void 0===t||t,o=e.fullText,c=e.sequencerEngine,u=e.instrument,l=e.envelope,f=e.width,h=void 0===f?180:f,j=e.height,w=void 0===j?60:j,E=e.name,S=e.hasRelease,P=e.hasLevel,x=e.backgroundColor,T=e.fillColor,C=e.lineColor,N=e.selectedParameter,R=e.setParameterSliderDown,M=e.setPullablePartDragging,A=Object(a.useState)(void 0),q=Object(r.a)(A,2),D=q[0],I=q[1],_=Object(a.useState)(void 0),F=Object(r.a)(_,2),L=F[0],B=F[1],z=Object(a.useRef)(void 0),V=function(e,t,n,r,a){t-=10;var i=e.attackParameter.get(),o=e.decayParameter.get(),s=e.sustainParameter.get(),c=e.releaseParameter.get(),u=Math.sqrt(i+o+c),l=g(i,u,t),f=g(o,u,t),h=r&&c>0?g(c,u,t):0,p=Math.max(10,t-(l+f+h)),d=a?5+n-Math.sqrt((e.level+1)/2)*n:5;d=Math.min(n-5,d);var m=Math.min(n-Math.sqrt(s)*n+5,n-5);return[5,a?n/2-5:n,l,d,l+f,m,l+f+p,m,l+f+p+h,n]}(l,h,w,S,P);Object(a.useEffect)(function(){N!==l.attackParameter&&N!==l.decayParameter&&N!==l.sustainParameter&&N!==l.releaseParameter||B(N)},[B,N,l]),Object(a.useEffect)(function(){R(D)},[D]);var H=Object(a.useCallback)(function(e){if(D){var t=z.current.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top;D.forEach(function(e){var t=function(e,t,n,r,a,i){var o=t.attackParameter.get(),s=t.decayParameter.get(),c=t.sustainParameter.get(),u=t.releaseParameter.get(),l=Math.sqrt(o+s+u);if(n<5)return e.get();var f=1;if("Attack"===e.name)f=Math.min(b,Math.max(v,l)*(n-5)/(.8*a));else if("Decay"===e.name)s=Math.max(v,l)*(n-5)/(.8*a)-Math.sqrt(o),f=Math.min(b,Math.max(0,s));else if("Sustain"===e.name)c=(r=i-r)/i,f=Math.min(b,Math.max(0,c));else{if("Level"===e.name){var h=(r=i-r)/i;return 2*Math.pow(h,2)-1}"Release"===e.name&&(u=Math.max(v,l)*Math.max(0,a-n-5)/a,f=Math.min(b,Math.max(0,u)))}return Math.pow(f,2)}(e,l,n,r,h,w);e.set(t,!1)})}},[D,h,w]),U={};return x&&(U.backgroundColor=x),T&&(T=y.transparent(y.saturate(T,1),.2)),i.a.createElement(m.a,{draggable:n,onDragOver:function(e){return e.preventDefault()},onDragStart:function(){return M(u?{type:"SYNTH_ENVELOPE",id:l.id,track:u.track,subType:E,instrument:u}:{type:"MODULE_ENVELOPE",id:l.id,subType:l.number,instrument:l})},element:d.Fb,arg:E,className:"graphical-envelope"},i.a.createElement("div",{className:"env-toolbar"},i.a.createElement("div",{style:U,className:"env-name"},E),i.a.createElement(p,{fullText:o,setParameter:B,selectedParameter:L,envelope:l,hasLevel:P,hasRelease:S})),L?i.a.createElement(s.a,{name:L.name,isParameter:!0,lfoEnabled:!0,sequencerEngine:c,parameter:L,min:L.min,max:L.max,step:.001}):"",i.a.createElement("div",{draggable:!0,onDragStart:function(e){return e.preventDefault()},className:"graphics-container"},i.a.createElement("svg",{ref:z,style:U,onMouseMove:H,onMouseUp:function(){return I(void 0)},onMouseLeave:function(){return I(void 0)},width:h,height:w},O(V,w,C,T),k(V,l,D,I,P)),i.a.createElement("div",{className:"env-slider"})))})},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return i});var r=n(15),a=n.n(r),i=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.a.Master.context.sampleRate,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(a,i){new FormData;var o=new Worker(window.isNFT?"recorderWorker.js":"/recorderWorker.js");o.postMessage({command:"init",config:{sampleRate:n,numChannels:t.length}}),o.onmessage=function(t){var n,i=t.data,o=new FileReader;o.onload=function(){n=this.result,a(r?n:new e(n))},o.readAsArrayBuffer(i)},o.postMessage({command:"record",buffer:t}),o.postMessage({command:"exportWAV",type:"audio/wav"})})}}).call(this,n(27).Buffer)},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return c});var r=n(17),a=n(72);Object(a.a)("and",{a:"Argument 1",b:"Argument 2"},"Returns true if a && b");var i=function(e,t){return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=r.A.apply(void 0,[e].concat(a)),s=r.A.apply(void 0,[t].concat(a));return Object(r.w)(o&&s)}};Object(a.a)("eq",{a:"Argument 1",b:"Argument 2"},"Returns true if a >= b");var o=function(e,t){return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=r.A.apply(void 0,[e].concat(a)),s=r.A.apply(void 0,[t].concat(a));return Object(r.w)(o===s)}};Object(a.a)("gte",{a:"Argument 1",b:"Argument 2"},"Returns true if a >= b");var s=function(e,t){return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=r.A.apply(void 0,[e].concat(a)),s=r.A.apply(void 0,[t].concat(a));return Object(r.w)(o>=s)}};Object(a.a)("lte",{a:"Argument 1",b:"Argument 2"},"Returns true if a <= b");var c=function(e,t){return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return Object(r.w)(r.A.apply(void 0,[e].concat(a))<=r.A.apply(void 0,[t].concat(a)))}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r="DOWN",a="UP"},function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return f});var r=n(8),a=n(9),i=n(17),o=n(105),s=n(45);function c(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e){return function(){for(var t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];for(var u=Object(o.l)(e,.5).apply(void 0,n),l=Object(a.a)(i.A.apply(void 0,[e].concat(n))),f=Object(s.uuid)(),h=0;h<l.length;h++)l[h]=Object(r.a)({},l[h],{figure:u,nth:h,figureId:f});return l}},f=function(e,t,n){return function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];var u,l=i.A.apply(void 0,[e].concat(o)),f=i.A.apply(void 0,[t].concat(o)),h=void 0,p=[],d=[],m=0,v=c(l);try{for(v.s();!(u=v.n()).done;){var b=u.value;if(m===f?d.push(b):p.push(b),h&&b.figureId!==h.figureId){if(m===f){var g=n(d);"function"===typeof g&&(g=g.apply(void 0,o)),p=[].concat(Object(a.a)(p),Object(a.a)(g)),d=[]}m++}h=b}}catch(k){v.e(k)}finally{v.f()}if(d.length>0){var y=n(d);"function"===typeof y&&(y=y.apply(void 0,o)),p=[].concat(Object(a.a)(p),Object(a.a)(y))}return p}}},,,function(e,t,n){"use strict";var r=n(28),a=n(8),i=n(9),o=n(11),s=n(0),c=n(6),u=n(839),l=n(448);function f(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t=e.element,n=e.skipPlacement,r=e.setWindowScale,a=e.sequencerEngine,o=e.ref,h=e.setSize,p=e.sizeRef,d=e.containerRef,m=e.setCoords,v=e.handleScroll,b=e.elements;Object(s.useEffect)(function(){if(d&&!n){if(t&&void 0!==t.x&&(m({x:t.x,y:t.y}),void 0!==t.width&&r({x:t.width,y:t.height}),y(t.x,t.y,!0)),t&&void 0===t.x&&(a&&a.state.windows.windowPositions[t.id]||g(t)),t&&b.current&&(b.current[t.id]=o),t.needsPlacement){var e=t.x,i=t.y,s=t.id,l=Object(u.b)(e,i,s,o.current,b.current);a.dispatch(Object(c.gb)(l))}}else t&&void 0!==t.width&&r&&r({x:t.width,y:t.height})},[]);var g=Object(s.useCallback)(function(e){if(d){var t=Object(l.d)(function(e){if(!e)return{current:{}};var t=Object(i.a)(a.state.zobject.zobjectsStack);t.reverse();var n,r={},o=f(t);try{for(o.s();!(n=o.n()).done;){var s=n.value;r[s.id]=e.current[s.id]}}catch(u){o.e(u)}finally{o.f()}for(var c in e.current)r[c]=e.current[c];return{current:r}}(b)),n=t.tops,r=t.lefts,s=t.widths,c=t.heights;for(var u in n){var h=n[u],p=r[u],v=s[u],g=p+5,k=h-c[u];if(g+o.current.offsetWidth<=d.current.offsetWidth&&!Object(l.a)(g,k,o.current.offsetWidth,o.current.offsetHeight,t))return m({x:g,y:k}),void y(g,k,!0);if(g=p-v,k=h+5,!Object(l.a)(g,k,o.current.offsetWidth,o.current.offsetHeight,t))return e.id,m({x:g,y:k}),void y(g,k,!0)}}},[]),y=Object(s.useCallback)(function(e,n,r){if(p&&o.current){var i=p.current;if(i){if(e+o.current.offsetWidth>i.width||n+o.current.offsetHeight>i.height){var s={width:Math.max(i.width,e+o.current.offsetWidth),height:Math.max(i.height,n+o.current.offsetHeight)};return p.current=s,void h(s)}if(r)return;var u=Object(l.c)(b),f=u.minTop,d=u.minLeft,m=Object(l.b)(b),g=m.maxTop,y=m.maxLeft;if(f-=100,d-=100,a&&t.subSequence&&!t.subSequence.getRootSubSequence){var k=a.state.spatial,O=k.edgesSize,j=k.edgesPadding,w={width:y-d,height:g-f};w.width===O.width&&w.height===O.height||a.dispatch(Object(c.Rb)(w.width+300,w.height+300)),j.x===d&&j.y===f||a.dispatch(Object(c.Qb)(d,f))}if(y<i.width||g<i.height){if(!(y>i.width||g>i.height))return;var E={width:Math.max(i.width,y),height:Math.max(i.height,g)};if(p.current=E,h(E),a)a.state.spatial.mainScrollRef&&v(e,n,p)}}}},[h,b]);return{adjust:y,placeWindow:g}},d=n(213);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",function(){return b});var b=function(e){var t,n=e.isSimple,u=void 0!==n&&n,l=e.sizeRef,f=e.sequencerEngine,h=e.initialCoords,v=e.expand,b=e.ref,g=e.containerRef,y=e.size,k=e.basicContainerRef,O=e.setSize,j=e.element,w=e.elements,E=(e.isPad,e.ordering),S=e.setOrdering,P=e.windowPosition,x=e.skipPlacement,T=Object(s.useRef)(void 0),C=Object(s.useState)(!1),N=Object(o.a)(C,2),R=N[0],M=N[1],A=Object(s.useRef)(void 0),q=Object(s.useRef)(void 0),D=Object(s.useState)({x:0,y:0}),I=Object(o.a)(D,2),_=I[0],F=I[1],L=Object(s.useState)(void 0),B=Object(o.a)(L,2),z=B[0],V=B[1],H=Object(s.useState)({x:0,y:0}),U=Object(o.a)(H,2),J=U[0],G=U[1],W=Object(s.useState)(h),K=Object(o.a)(W,2),X=K[0],Q=K[1],Y=Object(s.useCallback)(function(e){Q(e),f&&e&&j&&(f.state.spatial.presentationMode?f.dispatch(Object(c.qe)(j.id,e)):f.dispatch(Object(c.Kh)(j.id,e)))},[f,j,Q]),Z=function(e){e.sequencerEngine;return{handleScroll:Object(s.useCallback)(function(e,t,n){},[])}}({sequencerEngine:f}).handleScroll,$=p({element:j,skipPlacement:x,setWindowScale:G,sequencerEngine:f,ref:b,setSize:O,size:y,sizeRef:l,containerRef:g,setCoords:Y,handleScroll:Z,elements:w}),ee=$.adjust,te=($.placeWindow,Object(s.useCallback)(function(){if(E&&!(E.length>0&&E.indexOf(j)===E.length-1)){var e=E.filter(function(e){return e!==j});e=[].concat(Object(i.a)(e),[j]),S(e)}},[E,S,j])),ne=Object(s.useCallback)(function(e,t){var n=e.clientX,r=e.clientY;if(g){var a=g.current.getBoundingClientRect();n=e.clientX-a.left-_.x,r=e.clientY-a.top-_.y;var i=window._scale||1;t||(n/=i,r/=i)}return{x:n,y:r}},[g,_]),re=function(e){var t=e.ref,n=e.setCoords,r=e.sequencerEngine,a=e.setWindowScale,i=e.windowScale,o=e.adjust,u=e.updateOrdering,l=e.setIsResizing,f=e.getXY,h=Object(s.useRef)({width:0,height:0}),p=Object(s.useRef)({x:0,y:0}),m=Object(s.useCallback)(function(e,t,i,s){var u=t-p.current.x,l=i-p.current.y,f=h.current,m=f.width,v=f.height;e===d.b?n({x:Math.max(0,t),y:Math.max(0,i)}):e===d.d?(i=s.y,l*=-1):e===d.a?(u*=-1,t=s.x):e===d.c&&(u*=-1,l*=-1,t=void 0,i=void 0);var b=m-u,g=v-l;s.height=g,s.width=b,r&&(r.dispatch(Object(c.Yh)(s.id,{width:b,height:v,newHeight:g})),s.effect&&s.effect.pad&&s.effect.pad.onSizeChange(b,g)),a({x:b,y:g}),o(s.x,s.y),void 0!==t&&void 0!==i&&(t=Math.max(0,t),i=Math.max(0,i),n({x:t,y:i}))},[i,a,n]),v=Object(s.useCallback)(function(e,t){t.stopPropagation(),h.current=b(),p.current=f(t),l(e),u()},[i,l]),b=Object(s.useCallback)(function(){return{width:t.current.offsetWidth,height:t.current.offsetHeight}},[]);return{resizeWindow:m,startResizing:v}}({ref:b,setCoords:Y,sequencerEngine:f,setWindowScale:G,windowScale:J,adjust:ee,updateOrdering:te,setIsResizing:V,getXY:ne}),ae=re.startResizing,ie=re.resizeWindow;Object(s.useEffect)(function(){P&&(ee(P.x,P.y),j.x=P.x,j.y=P.y)},[P,O]),Object(s.useEffect)(function(){te()},[]);var oe=function(){if(f){var e=f.state.windows.selectedElements;return Object.keys(e)}return[]};Object(s.useEffect)(function(){j&&void 0!==j.x&&setTimeout(function(){ee(j.x,j.y)},50)},[v]),Object(s.useEffect)(function(){return window.addEventListener("mousemove",fe),window.addEventListener("mousedown",se),window.addEventListener("mouseup",le),function(){window.removeEventListener("mousemove",fe),window.removeEventListener("mousedown",se),window.removeEventListener("mouseup",le)}},[F,Y,j,R,_,O,z,R,V,J,G]);var se=Object(s.useCallback)(function(e){},[]),ce=Object(s.useCallback)(function(e){e.stopPropagation();var t=b.current.getBoundingClientRect();if(q.current={x:e.pageX,y:e.pageY},f){if(T.current=Object(a.a)({},f.state.spatial.editorPadding),f.state.zobject.uxLocked||f.state.spatial.lockedObjects[j.id])return;var n={},r=f.state.spatial.presentationMode,i=f.state.windows.windowPositions,o=f.state.windows.presentationWindowPositions;for(var s in w.current){var u=r&&o[s]||i[s];n[s]=Object(a.a)({},u)}A.current=n}f&&(oe().includes(j.id)||f.dispatch(Object(c.mf)({}))),F({x:e.clientX-t.left,y:e.clientY-t.top}),M(!0),te()},[F,M,E,S]),ue=Object(s.useCallback)(function(e){e.stopPropagation(),te()},[E,S]),le=Object(s.useCallback)(function(){(R||z)&&(V(!1),M(!1),F({x:0,y:0}))},[M,V,F,z,R]),fe=Object(s.useCallback)(function(e){if(R||z){var t=ne(e),n=t.x,r=t.y;if(f&&T.current){var a=f.state.spatial.editorPadding;n+=a.x-T.current.x,r+=a.y-T.current.y}if(!g&&!z){var i={x:e.pageX-_.x,y:e.pageY-_.y};if(k){var o=k.current.getBoundingClientRect();i.x-=o.left,i.y-=o.top}return j&&j.subSequence&&j.subSequence.getRootSubSequence&&(i.y=Math.max(0,i.y)),void Y(i)}if(R){var s=oe(),u={x:e.pageX,y:e.pageY};if(n+=g.current.scrollLeft,r+=g.current.scrollTop,s.length>0&&u&&q.current){var h,p=u.x-q.current.x,d=u.y-q.current.y,v={},b=m(s);try{for(b.s();!(h=b.n()).done;){var y=h.value;if(y!==j.id){var O=A.current[y],w=window._scale||1;O&&(v[y]={x:O.x+p/w,y:O.y+d/w})}}}catch(E){b.e(E)}finally{b.f()}f.state.spatial.presentationMode?f.dispatch(Object(c.fb)(v)):f.dispatch(Object(c.gb)(v))}j&&j.subSequence&&j.subSequence.getRootSubSequence&&(n=Math.max(0,n),r=Math.max(0,r)),ee(n,r),Y({x:n,y:r}),Z(n,r,l),j.x=n,j.y=r}else z&&ie(z,n,r,j)}},[R,j,F,Y,_,O,w,G,J,z]),he={};if(E&&E.includes(j)){var pe=E.indexOf(j);he.zIndex=10*(1+pe)}return u?{isDragging:R,zIndex:he.zIndex,onContextMenu:ue,onMouseDown:ce,onMouseUp:le,startResizing:ae}:(X&&(he.top=X.y,he.left=X.x),t={adjust:ee,onContextMenu:ue,setWindowScale:G,style:he,isDragging:R,onMouseDown:ce,windowScale:J,onMouseUp:le,setCoords:Y},Object(r.a)(t,"isDragging",R),Object(r.a)(t,"startResizing",ae),Object(r.a)(t,"coords",X),Object(r.a)(t,"zIndex",he.zIndex),t)}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(76),o=n(377),s=n(339),c=n(110),u=n(22),l=n(889),f=n(12),h=n(879),p=(n(2556),Object(f.b)(function(e,t){return{formant:e.instruments.showFormantEffect,showPresets:e.instruments.showFormantPresets}},function(e){return{}})(function(e){var t=e.showPresets,n=e.formant,r=e.effect,i=e.sequencerEngine,o=t?a.a.createElement(s.a,{isPianoRoll:!1,initialSize:10,oscillator:r,track:r,content:r.preset,searchText:"",type:"formants"}):n&&a.a.createElement(l.a,{sequencerEngine:r.sequencerEngine,formant:n});return a.a.createElement("div",{className:"multi-filter"},a.a.createElement("div",{className:"multi-inner"},a.a.createElement(h.a,{oscillator:r}),o),a.a.createElement(u.a,{name:"Gain",sequencerEngine:i,lfoEnabled:!0,parameter:r.gainParameter,isParameter:!0,step:.1,max:6,min:.1}),a.a.createElement(c.a,{sequencerEngine:i,effect:r}))})),d=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){return a.a.createElement("div",null,a.a.createElement(u.a,{effectNumber:e.effectNumber,automation:e.automation,name:"Amount",selectedParameter:e.selectedParameter,sequencerEngine:e.sequencerEngine,lfoEnabled:!0,parameter:e.effect.amountParameter,isParameter:!0,onParameterChanged:e.onParameterChanged,step:.01,max:4,min:.01}))}),m=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine;return a.a.createElement("div",null,a.a.createElement(u.a,{name:"Gain",sequencerEngine:n,lfoEnabled:!0,parameter:t.gainParameter,isParameter:!0,step:.1,max:6,min:.1}))}),v=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){return a.a.createElement("div",null,"Grains")}),b=n(848),g=n(851),y=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){return a.a.createElement("div",null,"Grains")}),k=n(632),O=n(114),j=n(148),w=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=(e.scrollContainer,e.sequencerEngine),r=e.effectNumber;return a.a.createElement("div",null,a.a.createElement(O.a,{parameter:t.overSampleParameter,name:"Oversample"}),a.a.createElement(u.a,{effectNumber:r,name:"Drive",sequencerEngine:n,lfoEnabled:!0,parameter:t.driveParameter,isParameter:!0,step:.01,max:32,min:.01}),a.a.createElement(k.a,{group:t}))}),E=(n(627),n(742)),S=n(852),P=n(853),x=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine;return a.a.createElement("div",null,a.a.createElement(u.a,{parameter:t.frequencyParameter,min:1,lfoEnabled:!0,max:1e4,name:"Frequency",sequencerEngine:n,isParameter:!0}))}),T=n(894),C=n(854),N=n(855),R=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect;e.sequencerEngine;return a.a.createElement("div",null,a.a.createElement(u.a,{name:"Attack",parameter:t.attackParameter,isParameter:!0,step:.01,max:4,min:-4}),a.a.createElement(u.a,{name:"Sustain",parameter:t.sustainParameter,isParameter:!0,step:.01,max:.5,min:0}),a.a.createElement(u.a,{name:"Output Gain",parameter:t.outputGainParameter,isParameter:!0,step:.01,max:2,min:0}))}),M=(n(38),n(560),n(739),n(856)),A=n(857),q=n(858),D=n(859),I=n(860),_=n(895),F=n(861),L=n(862),B=n(863),z=n(864),V=n(865),H=n(866),U=n(867),J=n(252),G=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine;return a.a.createElement("div",null,a.a.createElement(J.a,{track:t.getTrack(),onSelectTrack:function(e){e?t.trackParameter.set(e.trackNumber):t.trackParameter.set(-1)},sequencerEngine:n}),a.a.createElement(u.a,{name:"Roughness",lfoEnabled:!0,parameter:t.roughnessParameter,isParameter:!0,step:.1,max:100,min:.1}))}),W=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine;return a.a.createElement("div",null,a.a.createElement(J.a,{track:t.getTrack(),onSelectTrack:function(e){e?t.trackParameter.set(e.trackNumber):t.trackParameter.set(-1)},sequencerEngine:n}),a.a.createElement(u.a,{name:"Roughness",sequencerEngine:n,lfoEnabled:!0,parameter:t.roughnessParameter,isParameter:!0,step:.1,max:100,min:.1}),a.a.createElement(u.a,{name:"Q",sequencerEngine:n,lfoEnabled:!0,parameter:t.qParameter,isParameter:!0,step:.1,max:150,min:.1}),a.a.createElement(u.a,{name:"Frequency",sequencerEngine:n,lfoEnabled:!0,parameter:t.frequencyParameter,isParameter:!0,step:1,max:5e3,min:0}))}),K=n(881),X=n(868),Q=n(869),Y=n(870),Z=n(871),$=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=(e.scrollContainer,e.sequencerEngine),r=e.effectNumber;return a.a.createElement("div",{className:"wave-folder"},a.a.createElement(u.a,{effectNumber:r,name:"Amount",sequencerEngine:n,root:4,lfoEnabled:!0,parameter:t.amountParameter,isParameter:!0,step:.01,max:4,min:.01}))}),ee=n(5),te=n.n(ee),ne=n(14),re=n(11),ae=n(75),ie=n(1010),oe=Object(f.b)(function(e,t){return{convolverSample:t.effect.convolver.convolverSample,wet:t.effect.convolver.wetParameter.get()}},function(e){return{}})(function(e){var t=e.effect,n=e.effectNumber,i=(e.sequencerEngine,Object(r.useState)(void 0)),o=Object(re.a)(i,2),s=o[0],c=o[1],l=Object(r.useState)([]),f=Object(re.a)(l,2),h=f[0],p=f[1],d=Object(r.useState)(t.convolver.convolverSample),m=Object(re.a)(d,2),v=m[0],b=m[1];Object(r.useEffect)(function(){t.convolver.convolverSample!==v&&b(t.convolver.convolverSample)},[t.convolver.convolverSample,b,v]),Object(r.useEffect)(function(){if(void 0!==v){var e=new ae.a(t.convolver.convolverSample);e.load(!1).then(function(){c(e)})}},[t,v,c]),Object(r.useEffect)(function(){Object(ie.b)("guitar amp").then(function(e){Object(ie.e)(e).then(function(e){return p(e)})})},[p]);var g=Object(r.useCallback)(function(){var e=Object(ne.a)(te.a.mark(function e(n){return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.convolver.setConvolverSample(n);case 2:b(n);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[t,b]);if(void 0===s)return[];var y=s.tags||[];return a.a.createElement("div",{className:"guitar-amp"},a.a.createElement("div",{className:"amp-name"},s.name),a.a.createElement("div",{className:"amp-tags"},y.map(function(e){return a.a.createElement("div",{key:e,className:"amp-tag"},e)})),a.a.createElement(u.a,{effectNumber:n,automation:void 0,name:"Tone",parameter:t.convolver.pitchParameter,isParameter:!0,onParameterChanged:function(){return[]},step:.1,max:24,min:-24}),a.a.createElement("div",{className:"amps-list"},h.map(function(e,t){return a.a.createElement("div",{key:t,onClick:function(){return g(e.ipfsHash)},className:e.ipfsHash===s.ipfsHash?"amp-option selected":"amp-option"},e.title)})))}),se=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.scrollContainer,r=e.sequencerEngine,i=e.effectNumber;return a.a.createElement("div",null,a.a.createElement("div",{className:"wave-folder"},a.a.createElement(j.a,{scrollContainer:n,name:"Stages",parameter:t.stagesParameter,step:1,max:20,min:1}),a.a.createElement(j.a,{scrollContainer:n,name:"Smoothness",parameter:t.smoothnessParameter,step:.1,max:12,min:1})),a.a.createElement(O.a,{parameter:t.overSampleParameter,name:"Oversample"}),a.a.createElement(u.a,{effectNumber:i,name:"Drive",sequencerEngine:r,root:4,lfoEnabled:!0,parameter:t.driveParameter,isParameter:!0,step:.01,max:32,min:.01}),a.a.createElement(c.a,{effect:t,sequencerEngine:r}))}),ce=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effectNumber,n=e.effect,r=e.sequencerEngine;return a.a.createElement("div",{className:"ring-modulator"},a.a.createElement(u.a,{effectNumber:t,name:"Frequency",sequencerEngine:r,lfoEnabled:!0,parameter:n.frequencyParameter,isParameter:!0,step:.01,max:3e3,min:20}),a.a.createElement(u.a,{effectNumber:t,name:"Distortion",sequencerEngine:r,lfoEnabled:!1,parameter:n.distortionParameter,isParameter:!0,step:.01,max:3,min:.01}),a.a.createElement(c.a,{effectNumber:t,sequencerEngine:r,effect:n}))}),ue=n(39),le=n.n(ue),fe=[{value:4,label:4},{value:6,label:6},{value:8,label:8},{value:10,label:10},{value:16,label:16},{value:32,label:32}],he=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,i=Object(r.useState)(t.numBanks),o=Object(re.a)(i,2),s=(o[0],o[1]),c=Object(r.useCallback)(function(e){var n=e.value;t.numBanks=n,s({value:n,label:n})},[s,t]);return a.a.createElement("div",null,a.a.createElement("div",{className:"bands-toolbar"},a.a.createElement("div",{className:"bands-label"},"Number of Banks: "),a.a.createElement(le.a,{options:fe,onChange:c,value:fe.find(function(e){return e.value===t.numBanks})})),a.a.createElement(u.a,{parameter:t.frequencyParameter,min:1,lfoEnabled:!0,max:1e3,name:"Frequency",sequencerEngine:n,isParameter:!0}),a.a.createElement(u.a,{parameter:t.delaySpreadParameter,min:0,lfoEnabled:!0,max:1,step:1e-4,name:"Delay Spread",sequencerEngine:n,isParameter:!0}),a.a.createElement(O.a,{name:"Reverse delay",parameter:t.delayDirectionParameter}))}),pe=(n(1405),n(247),Object(r.memo)(function(e){var t=Object(r.useRef)(void 0),n=a.a.createElement(o.a,Object.assign({},e,{onDeleteEffect:e.onDeleteEffect,effectNumber:e.effectNumber,onToggle:function(){return[]},track:e.track,group:e.group,showDelete:e.showDelete,send:e.send,noSelect:e.noSelect,effect:e.effect,automation:e.automation}),function(e){return"Filter"===e.effect.name?a.a.createElement(E.a,Object.assign({},e,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,filterEffect:e.effect})):"Auto Filter"===e.effect.name?a.a.createElement(S.a,Object.assign({},e,{sequencerEngine:e.sequencerEngine,effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,filterEffect:e.effect})):"Gain"===e.effect.name?a.a.createElement(m,Object.assign({},e,{sequencerEngine:e.sequencerEngine,effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,filterEffect:e.effect})):"Delay"===e.effect.name?a.a.createElement(M.a,Object.assign({},e,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,delayEffect:e.effect})):"Tremolo"===e.effect.name?a.a.createElement(N.a,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,tremoloEffect:e.effect})):"Chorus"===e.effect.name?a.a.createElement(C.a,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,chorusEffect:e.effect})):"Reverb"===e.effect.name?a.a.createElement(P.a,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,reverbEffect:e.effect})):"Convolver Reverb"===e.effect.name?a.a.createElement(T.a,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,reverbEffect:e.effect})):"Compressor"===e.effect.name?a.a.createElement(A.a,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Distortion"===e.effect.name?a.a.createElement(B.a,Object.assign({},e,{sequencerEngine:e.sequencerEngine,effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"EQ 3"===e.effect.name?a.a.createElement(D.a,Object.assign({},e,{sequencerEngine:e.sequencerEngine,effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"EQ 10"===e.effect.name?a.a.createElement(I.a,Object.assign({},e,{sequencerEngine:e.sequencerEngine,effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Bit Crusher"===e.effect.name?a.a.createElement(z.a,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Ultra Phaser"===e.effect.name?a.a.createElement(F.a,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,sequencerEngine:e.sequencerEngine,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Multi Filter"===e.effect.name?a.a.createElement(p,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,sequencerEngine:e.sequencerEngine,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Auto Wah"===e.effect.name?a.a.createElement(L.a,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Granular"===e.effect.name?a.a.createElement(y,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Gate"===e.effect.name?a.a.createElement(g.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Pitch Shift"===e.effect.name?a.a.createElement(H.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Panner"===e.effect.name?a.a.createElement(U.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"EQ8"===e.effect.name?a.a.createElement(K.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Chebyshev"===e.effect.name?a.a.createElement(q.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Multiband Compressor"===e.effect.name?a.a.createElement(_.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Stereo Widener"===e.effect.name?a.a.createElement(X.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Saturator"===e.effect.name?a.a.createElement(V.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Soft Clipper"===e.effect.name?a.a.createElement(d,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Tape Delay"===e.effect.name?a.a.createElement(Q.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Stereo Delay"===e.effect.name?a.a.createElement(Y.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Oscilloscope"===e.effect.name?a.a.createElement(b.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Effect Rack"===e.effect.name?a.a.createElement(Z.a,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Guitar Amp"===e.effect.name?a.a.createElement(oe,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Wave Folder"===e.effect.name?a.a.createElement(se,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Wave Folder 2"===e.effect.name?a.a.createElement($,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Granulator"===e.effect.name?a.a.createElement(v,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Ring Modulator"===e.effect.name?a.a.createElement(ce,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Follower"===e.effect.name?a.a.createElement(G,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Vocoder"===e.effect.name?a.a.createElement(W,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Frequency Shifter"===e.effect.name?a.a.createElement(he,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Transient Shaper"===e.effect.name?a.a.createElement(R,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Genetic WaveShaper"===e.effect.name?a.a.createElement(w,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):"Freak Shifter"===e.effect.name?a.a.createElement(x,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect})):null}(e));return a.a.createElement("div",{ref:t,className:"audio-effect-container"},a.a.createElement(i.a,{element:e.effect},n))}));t.a=Object(f.b)(function(e,t){return{linkedParameterSelected:e.effects.accumulatorParameterSelected,preset:t.effect.preset}},function(e){return{}})(pe)},,,,,,,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{internalType:"bytes32[16]",name:"sampleHashes",type:"bytes32[16]"},{internalType:"bytes32[16]",name:"titles",type:"bytes32[16]"},{internalType:"bytes32[16]",name:"youtubeVideoIds",type:"bytes32[16]"},{internalType:"bytes32[16]",name:"coverArtHashes",type:"bytes32[16]"},{internalType:"uint256[16]",name:"discogIds",type:"uint256[16]"},{internalType:"bytes32[4][16]",name:"tagsToAdd",type:"bytes32[4][16]"},{internalType:"bytes32[4][16]",name:"stylesToAdd",type:"bytes32[4][16]"},{internalType:"bytes32[16]",name:"countries",type:"bytes32[16]"},{internalType:"int16[16]",name:"sampleYears",type:"int16[16]"},{internalType:"uint32",name:"guildId",type:"uint32"},{internalType:"bytes32[9]",name:"encryptedContentKey",type:"bytes32[9]"},{internalType:"bytes32[6]",name:"publicKey",type:"bytes32[6]"}],name:"newEncryptedSamples",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32[16]",name:"sampleHashes",type:"bytes32[16]"},{internalType:"bytes32[16]",name:"titles",type:"bytes32[16]"},{internalType:"bytes32[16]",name:"youtubeVideoIds",type:"bytes32[16]"},{internalType:"bytes32[16]",name:"coverArtHashes",type:"bytes32[16]"},{internalType:"uint256[16]",name:"discogIds",type:"uint256[16]"},{internalType:"bytes32[4][16]",name:"tagsToAdd",type:"bytes32[4][16]"},{internalType:"bytes32[4][16]",name:"stylesToAdd",type:"bytes32[4][16]"},{internalType:"bytes32[16]",name:"countries",type:"bytes32[16]"},{internalType:"int16[16]",name:"sampleYears",type:"int16[16]"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"newSamplesWithMetadata",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"sampleHash",type:"bytes32"},{internalType:"string",name:"title",type:"string"},{internalType:"bytes32",name:"youtubeVideoId",type:"bytes32"},{internalType:"bytes32[4]",name:"tagsToAdd",type:"bytes32[4]"},{internalType:"bytes32[4]",name:"stylesToAdd",type:"bytes32[4]"},{internalType:"bytes32",name:"country",type:"bytes32"},{internalType:"int16",name:"year",type:"int16"},{internalType:"uint256",name:"discogsId",type:"uint256"},{internalType:"bytes32",name:"coverArtHash",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"newSampleWithMetadata",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"sampleHash",type:"bytes32"},{internalType:"bytes32",name:"country",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"setSampleCountry",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"sampleHash",type:"bytes32"},{internalType:"bytes32[4]",name:"stylesToAdd",type:"bytes32[4]"},{internalType:"bytes32",name:"country",type:"bytes32"},{internalType:"int16",name:"year",type:"int16"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"setSampleDiscogsMetadata",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"sampleHash",type:"bytes32"},{internalType:"bytes32",name:"style",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"setSampleStyle",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"sampleHash",type:"bytes32"},{internalType:"bytes32",name:"tag",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"setSampleTag",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"sampleHash",type:"bytes32"},{internalType:"bytes32[4]",name:"tagsToAdd",type:"bytes32[4]"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"setSampleTags",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"sampleHash",type:"bytes32"},{internalType:"int16",name:"year",type:"int16"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"setSampleYear",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"sampleHash",type:"bytes32"},{internalType:"bytes32",name:"youtubeVideoId",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"setSampleYoutubeVideoId",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"guildsAddress",type:"address"},{internalType:"address",name:"encryptionAddress",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"},{indexed:!1,internalType:"string",name:"title",type:"string"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SampleCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"youtubeVideoId",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SampledYoutube",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"tag",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SampleTagged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"style",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SampleStyle",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"},{indexed:!0,internalType:"int16",name:"year",type:"int16"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SampleYear",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"country",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"SampleCountry",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"discogsId",type:"uint256"},{indexed:!0,internalType:"bytes32",name:"coverArtHash",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"NewDiscogsSample",type:"event"}],this.contractAddress="0xc77d4e72dF7D0Bf96488eF543253af537fEb8737"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=12;function a(e){return Math.exp(1-1/Math.pow(e,1.01))}function i(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-200,o=e/n;if(o>=.75){var s=a*(1-Math.log(.75)/Math.log(.6));return s+=(a-s)*(o-.75)/.25}var c=a*(1-Math.log(o)/Math.log(.6));return isNaN(c)?i:c}window.q=.5,window.maxVolume=6},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(20),u=n(7),l=n(10),f=n(1),h=n(15),p=n.n(h);function d(){if(!(this instanceof d))return arguments.length>1||"number"!==typeof arguments[0]?d.apply(new d(arguments.length),arguments):new d(arguments[0]);if(0===arguments.length)throw new Error("Missing Argument: You must pass a valid buffer length");return this.size=this.start=0,this.overflow=null,arguments.length>1||"number"!==typeof arguments[0]?(this.data=new Array(arguments.length),this.end=(this.length=arguments.length)-1,this.push.apply(this,arguments)):(this.data=new Array(arguments[0]),this.end=(this.length=arguments[0])-1),this}function m(e,t){return e==t?0:e>t?1:-1}d.prototype={constructor:d,pop:function(){var e;if(0!==this.size)return e=this.data[this.end],delete this.data[this.end],this.end=(this.end-1+this.length)%this.length,this.size--,e},push:function(){var e=0;if(this.overflow&&this.size+arguments.length>this.length)for(;e<this.size+arguments.length-this.length;e++)this.overflow(this.data[(this.end+e+1)%this.length],this);for(e=0;e<arguments.length;e++)this.data[(this.end+e+1)%this.length]=arguments[e];return this.size<this.length&&(this.size+e>this.length?this.size=this.length:this.size+=e),this.end=(this.end+e)%this.length,this.start=(this.length+this.end-this.size+1)%this.length,this.size},reverse:function(){for(var e,t=0;t<~~(this.size/2);t++)e=this.data[(this.start+t)%this.length],this.data[(this.start+t)%this.length]=this.data[(this.start+(this.size-t-1))%this.length],this.data[(this.start+(this.size-t-1))%this.length]=e;return this},rotateLeft:function(e){if("undefined"===typeof e&&(e=1),"number"!==typeof e)throw new Error("Argument must be a number");for(;--e>=0;)this.push(this.shift());return this},rotateRight:function(e){if("undefined"===typeof e&&(e=1),"number"!==typeof e)throw new Error("Argument must be a number");for(;--e>=0;)this.unshift(this.pop());return this},shift:function(){var e;if(0!==this.size)return e=this.data[this.start],this.start=(this.start+1)%this.length,this.size--,e},sort:function(e){return this.data.sort(e||m),this.start=0,this.end=this.size-1,this},unshift:function(){var e=0;if(this.overflow&&this.size+arguments.length>this.length)for(;e<this.size+arguments.length-this.length;e++)this.overflow(this.data[this.end-e%this.length],this);for(e=0;e<arguments.length;e++)this.data[(this.length+this.start-e%this.length-1)%this.length]=arguments[e];return this.length-this.size-e<0&&(this.end+=this.length-this.size-e,this.end<0&&(this.end=this.length+this.end%this.length)),this.size<this.length&&(this.size+e>this.length?this.size=this.length:this.size+=e),this.start-=arguments.length,this.start<0&&(this.start=this.length+this.start%this.length),this.size},indexOf:function(e,t){for(t||(t=0);t<this.size;t++)if(this.data[(this.start+t)%this.length]===e)return t;return-1},lastIndexOf:function(e,t){for(t||(t=this.size-1);t>=0;t--)if(this.data[(this.start+t)%this.length]===e)return t;return-1},sortedIndex:function(e,t,n){t=t||m;var r=this.start,a=this.size-1;for(r&&t.call(n,e,this.data[a])>0&&(r=0,a=this.end);r<a;){var i=r+a>>>1;t.call(n,e,this.data[i])>0?r=i+1:a=i}return((r-this.start)%this.size+this.size)%this.size},every:function(e,t){for(var n=0;n<this.size;n++)if(!e.call(t,this.data[(this.start+n)%this.length],n,this))return!1;return!0},forEach:function(e,t){for(var n=0;n<this.size;n++)e.call(t,this.data[(this.start+n)%this.length],n,this)},some:function(e,t){for(var n=0;n<this.size;n++)if(e.call(t,this.data[(this.start+n)%this.length],n,this))return!0;return!1},avg:function(){return 0==this.size?0:this.sum()/this.size},sum:function(){for(var e=this.size,t=0;e--;)t+=this.data[e];return t},median:function(){if(0===this.size)return 0;var e=this.slice().sort(m),t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2},empty:function(){return this.size=this.start=0,this.end=this.length-1,this},fill:function(e){var t=0;if("function"===typeof e)for(;this.data[t]=e(),++t<this.length;);else for(;this.data[t]=e,++t<this.length;);return this.start=0,this.end=this.length-1,this.size=this.length,this},first:function(){return this.data[this.start]},last:function(){return this.data[this.end]},get:function(e){return this.data[(this.start+e)%this.length]},isFull:function(e){return this.length===this.size},set:function(e,t){return this.data[(this.start+e)%this.length]=t},toArray:function(){return this.slice()},slice:function(e,t){var n=this.size;if((e=+e||0)<0){if(e>=t)return[];e=-e>n?0:n+e}null==t||t>n?t=n:t<0?t+=n:t=+t||0,n=e<t?t-e:0;for(var r=Array(n),a=0;a<n;a++)r[a]=this.data[(this.start+e+a)%this.length];return r}};var v=d;var b=function(e,t){this.timestretch=function(e){for(var t=e.getChannelData(0),n=e.getChannelData(1),r=[],a=[],i=0;i<100;i++)this.process(t[i],r),this.process(n[i],a);t=new Float32Array(r),n=new Float32Array(a),e.set(p.a.Buffer.fromArray([t,n]))},this.process=function(e,t){var n=function(e){for(var t=new Float32Array(e.length),n=0;n<e.length;n++)t[n]=i[n]*e[n];return t}(e);return function(e,t,n,r,a,i,o){for(var s,c=0,u=0;u<e;u++)s=a.shift()||0,c=r.shift()||0,o.push(c/(s<.01?1:s)),r.push(0),a.push(0);for(var u=0;u<i;u++)c=r.shift(),r.push(t[u]+c),s=a.shift(),a.push(n[u]+s)}(a,n,o,h,d,c,t),b=!1,a},this.beta_fn=function(e){return n<=1?2:n<=1.2?2:n<=1.4?2:n<=1.8?2.5:3},this.overlap_fn=function(e){return e<1.25?e+.15:e>=1.25&&e<1.5?e+.2:e>=1.5&&e<1.8?e+.6:e>=1.8&&e<2?e+.9:e+2.2},this.get_hs=function(){return a},this.get_ha=function(){return r},this.get_alpha=function(){return n},this.get_real_alpha=function(){return a/r},this.get_overlap_factor=function(){return l},this.clear_buffers=function(){h=new v(c),d=new v(c),b=!0},this.set_window_type=function(e){f=s[e]?e:f},this.set_alpha=function(e,t,i){n=e,void 0==i?this.set_beta(this.beta_fn(n)):this.set_beta(i),l=void 0==t?this.overlap_fn(n):t,r=Math.round(c/l),a=Math.round(n*r)},this.set_beta=function(e){i=function(e,t,n){for(var r=new Float32Array(e),a=0;a<e;a++)r[a]=s[n](e,a,t);return r}(c,u=e,f),o=new Float32Array(i.length);for(var t=0;t<o.length;t++)o[t]=Math.pow(i[t],1)};var n,r,a,i,o,s={Lanczos:function(e,t,n){var r=2*t/(e-1)-1;return Math.pow(Math.sin(Math.PI*r)/(Math.PI*r),n)},Triangular:function(e,t,n){return Math.pow(2/e*(e/2-Math.abs(t-(e-1)/2)),n)},Bartlett:function(e,t,n){return Math.pow(2/(e-1)*((e-1)/2-Math.abs(t-(e-1)/2)),n)},BartlettHann:function(e,t,n){return Math.pow(.62-.48*Math.abs(t/(e-1)-.5)-.38*Math.cos(2*Math.PI*t/(e-1)),n)},Blackman:function(e,t,n){var r=n/2;return(1-n)/2-.5*Math.cos(2*Math.PI*t/(e-1))+r*Math.cos(4*Math.PI*t/(e-1))},Cosine:function(e,t,n){return Math.pow(Math.cos(Math.PI*t/(e-1)-Math.PI/2),n)},Gauss:function(e,t,n){return Math.pow(Math.E,-.5*Math.pow((t-(e-1)/2)/(n*(e-1)/2),2))},Hamming:function(e,t,n){return Math.pow(.54-.46*Math.cos(2*Math.PI*t/(e-1)),n)},Hann:function(e,t,n){return Math.pow(.5*(1-Math.cos(2*Math.PI*t/(e-1))),n)},Rectangular:function(e,t,n){return n},SinBeta:function(e,t,n){return Math.pow(Math.sin(Math.PI*t/e),n)},Trapezoidal:function(e,t,n){var r=Math.round(e/4),a=r-1,i=9*r-1;return t<=a?Math.pow(t/a,n):t>=i?Math.pow(i/t,n):1}},c=e,u=1,l=1.1,f="Lanczos";this.set_alpha(1),this.set_beta(u);for(var h=new v(c),d=new v(c),m=0;m<c;m++)h.push(0),d.push(0);var b=!0;this.is_clean=function(){return b}};var g=function(e){var t,n=e||4096,r=new b(n),a=new b(n),i=0,o=1,s=new v(Math.round(1.2*n)),c=new v(Math.round(1.2*n)),u=new Float32Array(e);this.process=function(e){if(t){for(var l=0,f=t.getChannelData(0),h=t.getChannelData(1),p=e.getChannelData(0),d=e.getChannelData(1);c.size>0&&l<e.length;)p[b=l++]=s.shift(),d[b]=c.shift();if(l!=e.length)do{var m=f.subarray(i,i+n),v=h.subarray(i,i+n);void 0!=o&&o!=r.get_alpha()&&(r.set_alpha(o),a.set_alpha(o),o=void 0),m.length<n?(u.set(0,m),r.process(u,s),u.set(0,v),a.process(u,c),u.fill(0)):(r.process(m,s),a.process(v,c));for(var b=l;s.size>0&&b<e.length;b++)p[b]=s.shift(),d[b]=c.shift();l+=r.get_hs(),i+=r.get_ha()}while(l<e.length)}},this.set_audio_buffer=function(e){t=e},Object.defineProperties(this,{position:{get:function(){return i},set:function(e){i=new Number(e)}},alpha:{get:function(){return r.get_alpha()},set:function(e){o=new Number(e)}}})},y=n(295),k=(n(1035),n(147),n(6)),O=n(762),j=n(79),w=n(532),E=(n(106),n(21)),S=n(131),P=n(57),x=n(41);function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var C=8,N=new p.a.Time("16n"),R=new p.a.Time("32n"),M=p.a.Frequency("C3");window.initSamplers=0;var A=0,q=function(e){Object(u.a)(n,e);var t=T(n);function n(e,r,a,i,s){var u,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5];Object(o.a)(this,n),(u=t.call(this)).id=A++,u.isChosen=!0,window.initSamplers++,u.store=e.store,u.parameters=[],u.counter=0,u.baseTranspose=0,u.sample=r,u.tempo=r.tempo||s.tempo,u.samplerData=s,u.onsets=r.onsets||[],u.sliceData=i,u.track=e,u.note=null,u.slices=[],u.transposeParameter=new E.a("transpose",Object(c.a)(u),function(e,t){return[]},{defaultValue:0,min:-32,max:32}),u.registerParameter(u.transposeParameter),l||(u.gainNode=new p.a.Volume,u.volumeParameter=new x.c("volume",u.gainNode.volume,{min:-100,max:0,unit:"db",defaultValue:0}),u.registerParameter(u.volumeParameter)),u.alpha=1,u.tempoSynced=!1,u.audioBuffer=r.audioBuffer,u.offset=s.offset,u.transpose=s.transpose,u.onNewSampler=a,u.baseBuffer=new p.a.Buffer(r.audioBuffer),i=void 0===i?[{startTime:0,endTime:u.getDuration()}]:i,u.sliceData=i,u.pitchEnvelopes=[];for(var f=l?1:C,h=0;h<f;h++){var d=new p.a.ScaledEnvelope({attack:.01,decay:.01,min:0,max:1,sustain:1,release:.01,curve:"linear"});d._releaseCurve="linear",d._decayCurve="linear",u.pitchEnvelopes.push(d)}return u.pitchEnvelopeIndex=0,u.detuneSignal=new p.a.Signal(0),u.detuneParameter=new x.c("detune",u.detuneSignal,{min:-5e3,max:5e3,automationRate:S.a}),u.registerParameter(u.detuneParameter),s.detuneId&&(u.detuneParameter.id=s.detuneId),u.setupSlide(),u}return Object(s.a)(n,[{key:"replaceBuffer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.release(),this._buffer=e,this.sample.audioBuffer=e,this.baseBuffer=new p.a.Buffer(e),this.slices.slice(1).map(function(e){return e.dispose()}),this.slices=[this.slices[0]],t&&(this.tempo=this.analyze()),this.slice(0,void 0,void 0,void 0,void 0,!0),t&&this.sliceFirstOnset()}},{key:"sequencerEngine",get:function(){return this.track.sequencerEngine}},{key:"registerParameter",value:function(e){e.setStore(this.store),e.setContext((new P.a).forInstrument(this).forTrack(this.track)),this.parameters.push(e)}},{key:"transpose",get:function(){return this.transposeParameter.get()},set:function(e){this.transposeParameter.set(e)}},{key:"init",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.samplerData;var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sliceData,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0!==this.tempo||t||(this.tempo=this.analyze()),0==this.slices.length&&this.loadSlices(e),this}},{key:"sleep",value:function(e){return new Promise(function(t,n){setTimeout(function(){return t()},e)})}},{key:"analyze",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.baseBuffer;if(!window.isNFT){(new Date).getTime();var t=this.track.sequencerEngine.aubio,n=this.state.waveform.onsetThreshold,r=Object(O.a)(e,t,n),a=r.tempo,i=r.onsets,o=r.onsetToPitch;this.onsets=i,this.onsetToPitch=o;(new Date).getTime();return a}}},{key:"loadSlices",value:function(e){var t=this;e.map(function(e){return t.newSlice(e.startTime,e.endTime)})}},{key:"getVolume",value:function(){return this.volumeParameter.get()}},{key:"volume",get:function(){return this.volumeParameter.get()},set:function(e){this.volumeParameter.set(e,!0,!0)}},{key:"setVolume",value:function(e){void 0!==this.volumeParameter&&this.volumeParameter.set(e,!0,!0)}},{key:"getJson",value:function(){return{slices:this.slices.map(function(e){return e.getJson()}),tempoSynced:this.tempoSynced,detuneId:this.detuneParameter.id,tempo:this.tempo,transpose:this.transpose,alpha:this.alpha,offset:this.offset,reversed:this.isReversed(),sampleId:this.sample.getId()}}},{key:"release",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=this.get(e),r=p.a.Master.context.currentTime,a=void 0!==t?this.getNoteFromTranspose(t):this.lastNote;n.triggerRelease(a,r),this.triggerReleaseWaveformAnimation()}},{key:"getNoteFromTranspose",value:function(e){return e+=this.track.sequencerEngine.transpose,e+=this.baseTranspose,M.transpose(e).transpose(this.transpose)}},{key:"releaseAll",value:function(e){var t=this;this.slices.map(function(n){n.sampler.triggerRelease(t.lastNote,e)}),e||(this.clearSlide(),this.releaseSlide(),this.detuneSignal.value=this.detuneParameter.get(!0),this.lastTranspose=0)}},{key:"trigger",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var r,i,o,s,c,u,l,f,h,d,m,v,b,g,y,k;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.getDefaultTriggerConfig(t),r=t.stepData,i=t.time,void 0===t.transpose&&(t.transpose=t.stepData.transpose||0),o=t.noDuration?null:t.stepData.duration,s=this.getSlice(t.sliceNumber),void 0!==(c=s&&s.sampler)&&null!==c&&c.loaded){e.next=9;break}return e.abrupt("return");case 9:if(u=null,null==o?(this.liveNote=t.transpose+s.transpose,this.release(t.sliceNumber,this.liveNote)):"number"===typeof o?(u=N*o,void 0!==this.liveNote&&this.release(t.sliceNumber,this.liveNote),this.liveNote=void 0):(u=new p.a.Time(o),void 0!==this.liveNote&&this.release(t.sliceNumber,this.liveNote),this.liveNote=void 0),(l=this.getNoteFromTranspose(t.transpose+s.transpose))._val=Math.min(31608,l._val),window.isNFT&&(l*=44100/p.a.Master.context.sampleRate),f=t.velocity||r.velocity,h=r.chop,d=(null==u?N:u)/h,i=i||p.a.Master.context.currentTime,i=R*this.offset+i,m=i,c.attack=new p.a.Time(r.attack/1e3),c.release=new p.a.Time(r.release/1e3),(v=r.reverse||this.sequencerEngine.reverse)!==this.isReversed(t.sliceNumber)&&this.reverse(v,t.sliceNumber),(void 0!==this.lastSlideTranspose||this.hasSlide)&&this.releaseSlide(i),!u||!r.slide){e.next=31;break}return this.triggerSlide(t.transpose,i,u),e.abrupt("return");case 31:void 0!==this.lastSlideTranspose&&(this.triggerSlide(t.transpose,i,o,!1),this.hasSlide=!0);case 32:for(i&&(b=this.detuneParameter.get(!0),this.detuneSignal.setValueAtTime(b,Math.max(0,i-.001))),this.lastSlideTranspose=void 0,this.lastSlideMax=void 0,g=m,y=0;y<h;y++)t.gated||null==this.lastNote||(this.releaseAll(m),this.triggerReleaseWaveformAnimation(m)),k=this.getPitchEnvelope(c,l,i,f,r),t.gated&&u?this.triggerAttackRelease(c,l,u,m,f,[k],this.convertToStartTime(t.sliceNumber,t.start||r.start)):this.triggerAttack(c,l,m,f,[k],this.convertToStartTime(t.sliceNumber,t.start||r.start)),m+=d;this.lastNote=l,this.lastTranspose=t.transpose,this.triggerWaveformAnimation(t.skipRelease?void 0:g,t.gated&&!t.skipRelease?u:void 0,t.sliceNumber,t.transpose,this.convertToStartTime(t.sliceNumber,r.start));case 40:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"convertToStartTime",value:function(e){var t=0,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/100;this.track&&this.track.isAudioTrack&&(n=n*(this.track.getMaxDuration()/this.getDuration())%1);var r=n*this.getSlice(e).buffer.duration;return I(t+r)}},{key:"getPitchEnvelope",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.a.Master.context.currentTime,r=(arguments.length>3&&arguments[3],arguments.length>4?arguments[4]:void 0),a=(p.a.Frequency(t).toMidi(),this.pitchEnvelopes[this.pitchEnvelopeIndex]);a.cancel(Math.max(0,n-.001)),this.pitchEnvelopeIndex=(this.pitchEnvelopeIndex+1)%this.pitchEnvelopes.length;var i=null===r.pitchSustain?1:r.pitchSustain;return a.attack=null==r.pitchAttack?0:r.pitchAttack/1e3,a.attack+=.001,a.decay=null==r.pitchDecay?0:r.pitchDecay/1e3,a.decay+=.001,a.min=0,a.max=6*i*100,a.sustain=i,a.sustain+=.001,a.release=null==r.pitchRelease?0:r.pitchRelease/1e3,a.release+=.001,a}},{key:"triggerAttack",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.get(0),n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0,u=arguments.length>6?arguments[6]:void 0;return new Promise(function(){var l=Object(i.a)(a.a.mark(function i(l,f){var h,d;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:h=function(t){e.triggerReleaseWaveformAnimation(),setTimeout(function(){void 0===t||void 0===t._source||e.sequencerEngine.context.isOffline||e.isDisposed()||(e.detuneSignal.disconnect(t._source.detune),s.forEach(function(e){return e.disconnect(t._source.detune)}))},4e3),l()};try{void 0!==(d=t.triggerAttack(n,r+1/p.a.Master.context.sampleRate,o,c,h,u))&&void 0!==d._source&&(s.forEach(function(e){return e.connect(d._source.detune)}),e.detuneSignal.connect(d._source.detune),s.forEach(function(t){return t.triggerAttack(e.isSimple?void 0:r)}))}catch(i){console.log(i)}e.lastNote=n;case 3:case"end":return a.stop()}},i)}));return function(e,t){return l.apply(this,arguments)}}())}},{key:"triggerAttackRelease",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.get(0),n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0,u=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0;return new Promise(function(){var f=Object(i.a)(a.a.mark(function i(f,h){var p,d;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:p=1===c.length?function(){return f()}:function(t){setTimeout(function(){void 0===t||void 0===t._source||e.sequencerEngine.context.isOffline||e.isDisposed()||(e.detuneSignal.disconnect(t._source.detune),c.forEach(function(e){return e.disconnect(t._source.detune)}))},4e3),f()};try{o<0&&(o=0),void 0!==(d=t.triggerAttackRelease(n,r,o,s,u,p,l))&&void 0!==d._source&&(c.forEach(function(e){return e.connect(d._source.detune)}),e.detuneSignal.connect(d._source.detune),c.length>1?c.forEach(function(e){0===e.release?e.triggerAttack(o):e.triggerAttackRelease(r,o)}):c[0]&&c[0].triggerAttackRelease(r,o))}catch(i){console.log(i)}e.lastNote=n;case 3:case"end":return a.stop()}},i)}));return function(e,t){return f.apply(this,arguments)}}())}},{key:"getDuration",value:function(){return this.baseBuffer?this.baseBuffer.duration:1}},{key:"sliceFirstOnset",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!(void 0===this.onsets||0===this.onsets.length||this.slices.length>1)){var e=this.getSlice(0);if(0===e.startTime){var t=this.onsets[0]/1e3;t<e.endTime&&this.slice(0,t,e.endTime,!0)}}}},{key:"autoSlice",value:function(e){for(var t=void 0,n=this.slices[this.slices.length-1],r=1,a=0;a<this.onsets.length;a++)if(this.onsets[a]/1e3>n.endTime){r=a;break}for(var i=Math.max(1,Math.floor(this.onsets.length/8)),o=0;o<Math.min(e,this.onsets.length);o++){var s=this.onsets[r+o*i]/1e3,c=this.onsets[r+(o+1)*i];if(void 0===t||s-t>=.1){var u=this.getDuration();c&&(u=c/1e3),s<u&&this.newSlice(s,u),t=s}}}},{key:"slice",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5]),o=this.getSlice(e);r=void 0==r?this.getDuration():r,o.startTime=n,o.endTime=r,this.slices.forEach(function(e){return e.buffer.originalCopy=void 0}),this.slices.forEach(function(e){return e.buffer.reversedCopy=void 0});this.alpha;var s=++this.counter;if(p.a.Master.context.isOffline||i){if(this.baseBuffer){var c=this.baseBuffer.slice(n,r);o.buffer.set(c),o.refreshReverse(),this.onNewSampler(this)}}else setTimeout(function(){if((s===t.counter||a)&&t.baseBuffer){var e=t.baseBuffer.slice(n,r);o.buffer.set(e),o.refreshReverse(),t.onNewSampler(t)}},50);this.sliceData[e]={startTime:n,endTime:r},this.updateSlicesState()}},{key:"state",get:function(){return this.store.getState()}},{key:"updateSlicesState",value:function(){this.store.dispatch(Object(k.Ke)(this.id,this.slices.map(function(e){return e.getJson()})))}},{key:"syncTempo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];null!=this.tempo&&(t?(this.alpha=this.tempo/e,this.timestretch()):this.baseTranspose=12*(e/this.tempo-1)),this.tempoSynced=!0}},{key:"unsyncTempo",value:function(){this.alpha=1,this.tempoSynced=!1,this.baseTranspose=0}},{key:"timestretch",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(1!=this.alpha){e.next=3;break}return this.unsyncTempo(),e.abrupt("return");case 3:t=this.getDuration(),n=new g(4096),r=this.alpha,n.alpha=r,i=t*r*p.a.context.sampleRate-4096*this.alpha,o=p.a.context.createBuffer(2,i,p.a.context.sampleRate),n.set_audio_buffer(this.baseBuffer.get()),n.process(o);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"reverse",value:function(e,t){void 0===t?(this.baseBuffer.reverse=e,this.slices.forEach(function(t){return t.sampler._buffers.isReversed=e})):this.slices[t%this.slices.length].sampler._buffers.isReversed=e}},{key:"isReversed",value:function(e){return void 0===e?void 0!==this.baseBuffer&&this.baseBuffer.reverse:this.slices[e%this.slices.length].sampler._buffers.isReversed}},{key:"deleteSlice",value:function(e){1!==this.slices.length&&(this.slices.splice(e,1),this.sliceData.splice(e,1),this.updateSlicesState())}},{key:"newSlice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.slices[0]&&this.slices[0].startTime,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.slices[0]&&this.slices[0].endTime;if(void 0!==e||void 0!==t){var n;t=t||this.getDuration(),n=window.isNFT&&t===this.getDuration()&&0===e?this.baseBuffer:this.baseBuffer.slice(e,t);var r=new p.a.Sampler({C3:n},{curve:"linear"}),a=new D(n,r,e,t);return a.sampler.connect(this.gainNode),this.slices.push(a),this.sliceData.push({startTime:e,endTime:t}),this.slice(this.slices.length-1,e,t,!0),this.slices[this.slices.length-1]}}},{key:"getStartTime",value:function(e){return this.slices[e].startTime}},{key:"getEndTime",value:function(e){return null==this.slices[e].endTime&&(this.slices[e].endTime=this.slices[0].buffer._buffer.duration),this.slices[e].endTime}},{key:"getNumberOfSlices",value:function(){return this.slices.length}},{key:"dispose",value:function(){this.audioBuffer=void 0,this.isCopied||(this.baseBuffer.dispose(),this.slices.forEach(function(e){return e.dispose()})),this.gainNode.dispose(),this.pitchEnvelopes.forEach(function(e){return e.dispose()}),this.baseBuffer=void 0,this.slices=void 0,this.gainNode=void 0,this.pitchEnvelopes=void 0}},{key:"get",value:function(e){return this.slices[e%this.slices.length].sampler}},{key:"getSlice",value:function(e){return this.slices[e%this.slices.length]}},{key:"isLoaded",value:function(){return this.slices.length>0&&this.slices[0].sampler.loaded}},{key:"triggerWaveformAnimation",value:function(e,t,n,r,a){if(this.showWaveformAnimation()){var i=this.getSlice(n),o=i.startTime+a,s=new Event(y.d);s.trackNumber=this.track.trackNumber,s.subSequenceId=this.track.subSequence.id,s.startTime=o,s.duration=t||0,s.soundId=this.sample.getId(),s.sliceStartTime=a,s.sliceDuration=i.getDuration(),s.sliceNumber=n,s.transpose=r,s.time=Math.max(0,void 0===e?0:this.track.sequencerEngine.getMilliseconds(e)),window.dispatchEvent(s)}}},{key:"triggerReleaseWaveformAnimation",value:function(e){if(this.showWaveformAnimation()){var t=new Event(y.c);t.trackNumber=this.track.trackNumber,t.subSequenceId=this.track.subSequence.id,t.soundId=this.sample.getId(),t.time=Math.max(0,void 0===e?0:this.track.sequencerEngine.getMilliseconds(e)),window.dispatchEvent(t)}}},{key:"showWaveformAnimation",value:function(){return this.track.sequencerEngine.isSampler||this.isMixViewShown()||this.isWaveformShown()}},{key:"isMixViewShown",value:function(){var e=this.track.subSequence.id;return this.track.sequencerEngine.currentSubSequence.id===e&&this.state.sequencer.viewMode===j.b}},{key:"isWaveformShown",value:function(){return!!this.showingPrettyWaveform||this.track.subSequence.id===this.track.sequencerEngine.currentSubSequence.id&&this.state.sequencer.waveformShowing&&this.track.sequencerEngine.cursor.track===this.track.trackNumber}},{key:"getCopy",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.track,a={volume:this.volume,offset:this.offset,transpose:this.transpose,reversed:this.isReversed()},i=new n(r,this.sample,e,this.sliceData,a);return i.tempo=this.tempo,i.onsets=this.onsets,i.init(),this.isCopied=!0,i.slices.forEach(function(e,n){t.slices[n]&&(e.buffer.originalCopy=t.slices[n].buffer.originalCopy,e.buffer.reversedCopy=t.slices[n].buffer.reversedCopy)}),i}},{key:"isDisposed",value:function(){return void 0===this.audioBuffer}}],[{key:"getDefaultTriggerConfig",value:function(e){return void 0===e.gated&&(e.gated=!0),void 0===e.sliceNumber&&(e.sliceNumber=0),void 0===e.skipRelease&&(e.skipRelease=!1),e}}]),n}(Object(w.a)(function(){return function e(){Object(o.a)(this,e)}}())),D=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Object(o.a)(this,e),this.buffer=t,this.transpose=i,this.sampler=n,this.startTime=void 0==r?0:r,this.endTime=a,this.slice=void 0}return Object(s.a)(e,[{key:"getDuration",value:function(){return this.endTime-this.startTime}},{key:"dispose",value:function(){this.buffer.dispose(),this.sampler.dispose(),this.buffer=void 0,this.sampler=void 0,this.startTime=void 0,this.endTime=void 0}},{key:"getJson",value:function(){return{startTime:this.startTime,endTime:this.endTime,transpose:this.transpose}}},{key:"getCopy",value:function(){return new e(this.buffer,this.sampler,this.startTime,this.endTime,this.transpose)}},{key:"refreshReverse",value:function(){var e=this.sampler._buffers;e.isReversed=!1,e._reversedBuffers[48]=e.getReversed(e._buffers[48])}}]),e}();t.a=q;var I=function(e){return window.isNFT?e*(44100/p.a.Master.context.sampleRate):e}},function(e,t,n){"use strict";n.d(t,"c",function(){return j}),n.d(t,"a",function(){return w}),n.d(t,"b",function(){return E}),n.d(t,"d",function(){return T});var r=n(5),a=n.n(r),i=n(9),o=n(8),s=n(14),c=n(47),u=n(94),l=n(30),f=n(511),h=n(65),p=n(36),d=n(44),m=n(70),v=n(31),b=n(641),g=n(40);function y(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var O={},j=function(e,t,n,r,u,v){return new Promise(function(){var b=Object(s.a)(a.a.mark(function s(b){var g,y,k,O;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return g=Object(o.a)({samples:n,presets:r,description:t,title:e},v),a.next=3,c.a.addJson(g);case 3:if(y=a.sent,b(y),console.log("saving pack PREVIOUS HASH =",u),k=p.a.utils.padLeft("0x0",64),u&&(k=Object(h.c)(u)),g.type!==f.a){a.next=11;break}return a.next=11,l.a.xanadu.syncPadType(y,f.a);case 11:O=[].concat(Object(i.a)(n),Object(i.a)(r)).filter(function(e){return e}),new m.a(d.p,"newPack",[Object(h.c)(y),k,O.map(h.c),p.a.utils.fromAscii(e)]).execute();case 13:case"end":return a.stop()}},s)}));return function(e){return b.apply(this,arguments)}}())},w=function(){var e=Object(s.a)(a.a.mark(function e(){var t,n,r,o,s,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new g.a((new b.a).contractAddress).select("packHash").select("previousHash").select("title").from(v.D),e.next=3,t.executeQuery();case 3:n=e.sent,r=x(n,P()),o=S([].concat(Object(i.a)(r),Object(i.a)(n))),s=y(o);try{for(s.s();!(c=s.n()).done;)c.value.matchingContent=void 0}catch(a){s.e(a)}finally{s.f()}return e.abrupt("return",o);case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(s.a)(a.a.mark(function e(t){var n,r,i,o,s,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in O)){e.next=2;break}return e.abrupt("return",O[t]);case 2:return e.next=4,w();case 4:return n=e.sent,r=new g.a((new b.a).contractAddress).select("packHash").where("contentHash",t).whereIn("packHash",n.map(function(e){return e.packHash})).from(v.L),e.next=8,r.executeQuery();case 8:i=e.sent,o=y(i);try{for(c=function(){var e=s.value,t=n.find(function(t){return e.packHash===t.packHash});t&&(e.title=t.title)},o.s();!(s=o.n()).done;)c()}catch(a){o.e(a)}finally{o.f()}return O[t]=i,e.abrupt("return",i);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),S=function(e){var t=e.filter(function(e){return e.previousHash}).map(function(e){return e.previousHash});return e.filter(function(e){return!t.includes(e.packHash)})},P=function(){var e=u.a.getItem("local_packs");return e=e?JSON.parse(e):[]},x=function(e,t){var n=t.filter(function(t){return!e.some(function(e){return e.packHash===t.packHash})});return u.a.setItem("local_packs",JSON.stringify(n)),n},T=function(e,t){var n,r=[],a=[],i=y(t.slotTracks);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.sample?r.push(o.sample.getId()):o.preset&&o.preset.contentHash&&a.push(o.preset.contentHash)}}catch(c){i.e(c)}finally{i.f()}var s={type:f.a,pad:t.getJsonForPack(),fx:t.effectRack.getJson()};j(e,"",r,a,void 0,s)}},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=(n(85),n(95)),h=n(50),p=n(87),d=n(521),m=n(33),v=n(102),b=n(522),g=n(83),y=n(21),k=n(101),O=n(250),j=n(15),w=n.n(j);function E(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}window.tidalTimes=[],window.lazyTidals=0,window.nolazyTidals=0;new w.a.Time("16n");var x=new w.a.Time("32n"),T=function(e){Object(c.a)(n,e);var t=P(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,e,!1,5)).zObject=i,s.tidalCache={},s.scriptEffect=r,s.name="Tidal",s.cycleParameter=new y.a("cycle",Object(o.a)(s),function(e,t){if(t){var n=e.clearVariables();e.handleVariables(t,n),s.tidalCache={},s.needsUpdate=!0}},{defaultValue:void 0,min:!1,max:!0,unit:"",automatable:!1}),s.registerParameter(s.cycleParameter),s.warpLengthParameter.automatable=!1,s.warpFactorParameter.automatable=!1,s.loopLengthParameter.automatable=!1,s.resolutionParameter.automatable=!1,s.resolutionParameter.hide=!0,s.warpLengthParameter.hide=!0,s.warpFactorParameter.hide=!0,s.loopLengthParameter.hide=!0,s.durationFactorParameter.hide=!0,s.smoothnessParameter.hide=!0,s.cycleLengthParameter=new y.a("cycleLength",Object(o.a)(s),function(e,t){s.tidalCache={}},{documentation:"The number of 1/32th steps per cycle",prettyName:"Cycle Length",defaultValue:32,min:4,max:64,unit:""}),s.registerParameter(s.cycleLengthParameter),s.lengthFactorParameter=new y.a("lengthFactor",Object(o.a)(s),function(e,t){return[]},{documentation:"Multiplies the speed of the cycle",defaultValue:1,prettyName:"Speed Factor",min:.25,max:8,unit:""}),s.registerParameter(s.lengthFactorParameter),s.accentParameter="velocity",s.accentFactorParameter=new y.a("accentFactor",Object(o.a)(s),function(e,t){return[]},{documentation:"Multiplies the speed of the cycle",defaultValue:2,prettyName:"Accent Factor",min:0,max:2,unit:""}),s.registerParameter(s.accentFactorParameter),s.staccatoFactorParameter=new y.a("staccatoFactor",Object(o.a)(s),function(e,t){return[]},{documentation:"Multiplies the speed of the cycle",defaultValue:.2,prettyName:"Staccato Factor",min:0,max:2,unit:""}),s.registerParameter(s.staccatoFactorParameter),s.cycleRetrigger=!0,s.resolution=new m.a(32,!1),s.cycle=Object(g.g)("[0 12 ~ 12]"),s.numberOfOutputs=2,s.lastLeaf=void 0,s.newInlet("cycle length",function(e){return s.onCycleLength(e[0])}),s.newInlet("set variable",function(e){return s.onVariableSet(e[0])}),s.newOutlet(h.c),s}return Object(i.a)(n,[{key:"lockGroove",value:function(e){this.cycleParameter.immutable=e,this.cycleLengthParameter.immutable=e}},{key:"onCycleLength",value:function(e){isNaN(e)||this.cycleLengthParameter.set(e)}},{key:"onVariableSet",value:function(e){e=e.split(" ").map(function(e){return e.trim()});var t=parseFloat(e[1]);if(!isNaN(t)){var n=e[0];this[n+"Parameter"]&&(n=this[n+"Parameter"]).set(t)}}},{key:"clear",value:function(){Object(s.a)(Object(l.a)(n.prototype),"clear",this).call(this),this.lastLeaf=void 0,this.lastLeafStep=void 0,this.stepNumberTriggered=void 0}},{key:"output",value:function(e,t,r){return this.scriptEffect&&(r=this.scriptEffect.actualStepNumber),Object(s.a)(Object(l.a)(n.prototype),"output",this).call(this,e,t,r)}},{key:"accentFactor",get:function(){return this.accentFactorParameter.get()},set:function(e){this.accentFactorParameter.set(e)}},{key:"staccatoFactor",get:function(){return this.staccatoFactorParameter.get()},set:function(e){this.staccatoFactorParameter.set(e)}},{key:"documentation",get:function(){return["A tidal-cycles inspired scripting effect. Write expressions for cyclic beats using tidal notation.","Type or press enter to execute"]}},{key:"isRealTime",value:function(){return!1}},{key:"cycleLength",get:function(){return this.cycleLengthParameter.get()},set:function(e){return this.cycleLengthParameter.set(e)}},{key:"lengthFactor",get:function(){return this.lengthFactorParameter.get()},set:function(e){return this.lengthFactorParameter.set(e)}},{key:"cycle",get:function(){return this.cycleParameter.get()},set:function(e){return this.cycleParameter.set(e,!0,!0)}},{key:"removeNote",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!this.gated;Object(s.a)(Object(l.a)(n.prototype),"removeNote",this).call(this,e,t,r)}},{key:"handleVariables",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=E(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;Array.isArray(a)?this.handleVariables(a):(a.cycle&&this.handleVariables(a.cycle),a.transpose&&"object"===typeof a.transpose&&this.newVar(a.transpose.name,0,-32,32),a.operand&&"object"===typeof a.operand&&this.newVar(a.operand.name,2,1,16))}}catch(c){r.e(c)}finally{r.f()}var i=this.scriptEffect||this;for(var o in n){var s=i[o+"Parameter"];s&&(s.copyFrom(n[o],this.track.sequencerEngine),s.isMapped&&s.isMapped.replaceParameter(s))}i.updateVariablesRedux()}},{key:"cycleString",get:function(){return Object(g.e)(this.cycle)}},{key:"getText",value:function(){return this.cycleString}},{key:"replaceOperandVariables",value:function(e){var t=[];if(t.cycleLength=e.cycleLength,!e)return t;for(var n=0;n<e.length;n++){var a=e[n];if(Array.isArray(a))t.push(this.replaceOperandVariables(a));else{var i=Object(r.a)({},a);i.cycle&&(i.cycle=this.replaceOperandVariables(a.cycle)),a.operand&&"object"===typeof a.operand&&(this.newVar(a.operand.name,2,1,16),i.operand=this.var(a.operand.name)()),t.push(i)}}return t}},{key:"getTrigger",value:function(e,t,n,r,a,i){var o=(new Date).getTime();if(this.cycleRetrigger||(r=this.sequencerEngine.isSequenceRolling?r:this.track.sequencerEngine.trackStep),void 0===this.stepNumberTriggered&&(this.gated||this.sliceRetrigger||this.isNothingPlaying())&&(this.stepNumberTriggered=r),void 0!==this.cycle){var s=this.stepNumberTriggered;if(this.track&&this.track.length){var c=this.track.sequencerEngine.stepNumberOffset||0;c%=this.track.length,s=Object(f.a)(s-c,this.track.length)}var u=r-s;u<0&&(u+=this.track.length);var l=u%this.cycleLength;if(this.scriptEffect)this.scriptEffect.tidals.indexOf(this);if(0===l)if(this.scriptEffect&&this.scriptEffect.isOutletConnected&&this.scriptEffect.isOutletConnected(h.c)){var d=this.scriptEffect.tidals.indexOf(this);this.scriptEffect.sendMessage(h.c,d)}else this.sendMessage(h.c,h.a);var m,v=this.replaceOperandVariables(this.cycle),g=Math.floor(this.cycleLength/this.lengthFactor);0===this.variables.length&&this.tidalCache[l]?m=this.tidalCache[l]:(m=Object(b.c)({cycle:v,stepNumber:u,length:g}),this.tidalCache[l]=m),m.length>0&&(this.currentLeaves=m.filter(function(e){return e.cycle}),this.currentCycles=m.filter(function(e){return e.cycle}).reduce(function(e,t){return e[t.cycle]=!0,e},{}));var y=[];for(var O in m){var j=m[O],w=j.accent,E=j.pianissimo,S=j.staccato,P=j.legato,T=j.factor,C=j.outputNumber,N=j.transpose,R=j.offset,M=j.duration,A=j.flam,q=j.piano,D=!1;if(j.rules&&j.rules.some(function(e){return e.always&&(Array.isArray(e.always)?e.always.some(function(e){return"double"===e.type}):"double"===e.always.type)||e.series&&e.series.some(function(e){return"double"===e.type})})&&(D=!0),null!==N&&"object"===typeof N&&(N=this.var(N.name)()),(e=this.getStep(e,t,1,!0)).slice=i,e.transpose=parseFloat(e.transpose)+parseFloat(N),e.duration=M*this.durationFactor,u%this.cycleLength===0&&(e.isNewCycle=!0),null!==N){if(e.isDouble=D,this.lastLeaf){if(j.figureId!==this.lastLeaf.figureId){var I=this.scriptEffect.tidals.indexOf(this);this.scriptEffect.sendMessage("figure-change",I)}if(j.type){var _=j.type,F=_.type,L=_.value;if(F===p.b){if(this.lastLeaf.type&&this.lastLeaf.type.type===p.b){var B=this.lastLeafStep.velocity;this.isSequenceRolling&&(B=Math.min(2,B)),e.velocity=.7*B}e.hand=!this.lastLeafStep.hand}else F===p.a&&(0===L?e.hand=!this.lastLeafStep.hand:1===L&&(e.hand=this.lastLeafStep.hand))}}w&&(e.velocity*=this.accentFactor),T&&(e.velocity*=Math.pow(T,2)),E?e.velocity*=.05:q&&(e.velocity*=.45),S&&(e.duration*=this.staccatoFactor,e.release=5,e.attack=3),P&&(e.duration=Object(b.b)(v,j.leaf,g)),e.on=!0,e.leafNumber=Object(b.a)(v,j.leaf,g);var z=new k.a(e,x*R+n,a,C);if(z.offsetTime=x*R,y.push(z),this.lastLeaf=j,this.lastLeafStep=e,e.velocity=Math.min(2,e.velocity),A){var V=this.getStep(e);V.velocity*=.8,V.duration*=.6;var H=new k.a(V,z.time+-.4*x,a,C);y.push(H)}}else this.lastLeafStep&&(e.hand=!this.lastLeafStep.hand),this.lastLeaf=j,this.lastLeafStep=e}var U=(new Date).getTime();return window.tidalTimes.push(U-o),y}}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"getJson",value:function(e){return Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this,e),{cycleRetrigger:this.cycleRetrigger})}},{key:"fromJson",value:function(e,t){this.cycleParameter.set(e.cycle);var r=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t);return void 0!==e.cycleRetrigger&&(this.cycleRetrigger=e.cycleRetrigger),r}},{key:"hasAccent",value:function(){var e,t=E(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.cycle);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(Array.isArray(n)){if(this.hasAccent(n))return!0}else{if(n.cycle&&this.hasAccent(n.cycle))return!0;if(n.accent)return!0}}}catch(r){t.e(r)}finally{t.f()}return!1}}]),n}(Object(v.a)(Object(d.a)(O.a)));t.a=T},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){var t=e.ref;e.effect;return{preventDragging:function(e){for(var n=t.current.parentNode,r=0;r<20&&n;r++)!n.className||!n.className.includes("effect")||n.className.includes("inner-effect")||n.className.includes("effects-view")||n.className.includes("effect-rack")||n.setAttribute("draggable",e),n=n.parentNode}}}},,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(21);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}t.a=function(e){return function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"initDisabledParameters",value:function(){var e=this;this.parametersDisabledParameter=new c.a("parametersDisabled",this,function(t,n){return e.parametersDisabledChanged(n)},{defaultValue:[]}),this.registerParameter(this.parametersDisabledParameter)}},{key:"parametersDisabled",get:function(){return this.parametersDisabledParameter.get(!0)}},{key:"parametersDisabledChanged",value:function(e){var t,n={},r=u(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=this.initialParameterValues[a];if(void 0!==i&&this._parameters[a])n[this._parameters[a].set(i,!0,!0,void 0,this.rampTime/1e3).id]=i}}catch(o){r.e(o)}finally{r.f()}this.setEffectParameterValues(n)}}]),n}(e)}},,function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r="RECORD",a="PLAY"},function(e,t,n){"use strict";n.d(t,"e",function(){return h}),n.d(t,"f",function(){return p}),n.d(t,"a",function(){return d}),n.d(t,"c",function(){return m}),n.d(t,"d",function(){return v}),n.d(t,"b",function(){return b});var r=n(9),a=n(8),i=n(17),o=(n(63),n(343)),s=(n(153),n(444),n(95)),c=n(105),u=n(300);function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}window.scaleLazies=0,window.scaleNoLazies=0;var h=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return function(){for(var o=Object(i.A)(r),s=Object(i.A)(a),c=arguments.length,u=new Array(c),f=0;f<c;f++)u[f]=arguments[f];var h=i.A.apply(void 0,[e].concat(u));if(h===n)return t;n=h;var p,d=0,m=[d],v=l(h.flat(16));try{for(v.s();!(p=v.n()).done;){var b=p.value;if(m.length>=7)break;if(b.type){var g=b.type,y=g.type,k=g.value;if("-"===y&&0===k)d+=s;else{if("."!==y)continue;d+=o}m.push(d)}}}catch(O){v.e(O)}finally{v.f()}return t=m}},p=function(e,t,n){var r,o,l,f;return function(){for(var h=arguments.length,p=new Array(h),d=0;d<h;d++)p[d]=arguments[d];var m=i.A.apply(void 0,[e].concat(p)),v=i.A.apply(void 0,[t].concat(p)),b=i.A.apply(void 0,[n].concat(p));if(m===f&&v===o&&l===b)return window.scaleLazies++,r;window.scaleNoLazies++,l=b,o=v,f=m;for(var g=m.flat(16).length,y=0,k=function(e){m=Object(c.v)(m,e,function(t){if(null!==(t=Object(a.a)({},t)).transpose){if(b&&b[e]){var n=b[e],r=n.type,i=n.value;switch(r){case u.d:y=Object(s.a)(y-i,v.length);break;case u.a:y=Object(s.a)(y+i,v.length);break;case u.c:y=0}}t.transpose=v[y%v.length],b&&b[e]&&b[e].type===u.b||y++}return t},!0).apply(void 0,p)},O=0;O<g;O++)k(O);return r=m}},d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var s,c=i.A.apply(void 0,[e].concat(a)),u=i.A.apply(void 0,[t].concat(a)),f=i.A.apply(void 0,[n].concat(a)),h=[],p=0,d=void 0,m=l(u);try{for(m.s();!(s=m.n()).done;){var v=s.value;v=i.A.apply(void 0,[v].concat(a)),v--;var b=f[p%f.length];void 0!==b?b*=12:b=0,(v>c.length||void 0!==d&&d>c[v])&&(b+=12,v%=c.length);var g=c[v]+b;d=g,h.push(g),p++}}catch(y){m.e(y)}finally{m.f()}return h}},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];for(var c=Object(r.a)(i.A.apply(void 0,[e].concat(o))),u=[],l=0;l<t;l++)u.push(c.shift()+12);return[].concat(Object(r.a)(c.map(function(e){return e+12*n})),u)}},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=i.A.apply(void 0,[e].concat(r)),s=i.A.apply(void 0,[t].concat(r)),c=0;return s>=o.length&&(c=12,s%=o.length),o[s]+c}},b=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(){for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];var u,f=s[0],h=i.A.apply(void 0,[e].concat(s)),p=i.A.apply(void 0,[n].concat(s)),d=[],m=l(i.A.apply(void 0,[t].concat(s)));try{for(m.s();!(u=m.n()).done;){var v=u.value,b=i.A.apply(void 0,[v].concat(s)),g=b.thick,y=b.flat,k=b.time,O=b.voice,j=b.octave,w=O-1,E=j;void 0!==E?E*=12:E=0,w>=h.length&&(E+=12);var S=h[w%h.length]+E+p;if(y&&(S-=y),S,d.push({note:S,time:k}),void 0!==g)for(var P=1;P<=g;P++)d.push({note:S-12*P,time:k});0}}catch(x){m.e(x)}finally{m.f()}return i.D.apply(void 0,Object(r.a)(d.map(function(e){var t=e.note,n=e.time;return Object(o.a)(f,t,f.duration,n)})))}}},function(e,t,n){"use strict";function r(e,t,n,r){var a=e.x,i=e.y,o=t.x,s=t.y,c=n.x,u=n.y,l=r.x,f=r.y;if(a===o&&i===s||c===l&&u===f)return!1;var h=(f-u)*(o-a)-(l-c)*(s-i);if(0===h)return!1;var p=((l-c)*(i-u)-(f-u)*(a-c))/h,d=((o-a)*(i-u)-(s-i)*(a-c))/h;return!(p<0||p>1||d<0||d>1)&&{x:a+p*(o-a),y:i+p*(s-i)}}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o});var r=1,a=2,i=3,o=5},,,,,,,,,function(e,t,n){"use strict";n.d(t,"c",function(){return v}),n.d(t,"b",function(){return y}),n.d(t,"a",function(){return k});var r=n(5),a=n.n(r),i=n(14),o=n(40),s=n(52),c=n(30),u=n(764),l=n(362),f=n(31);n(36);function h(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=new l.a,m={},v=function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var c,l,p,v,y,k,O,j,w,E,S,P,x,T,C,N,R=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=R.length>3&&void 0!==R[3]?R[3]:0,l=R.length>4?R[4]:void 0,p=R.length>5?R[5]:void 0,v=R.length>6?R[6]:void 0,y=R.length>7?R[7]:void 0,k=n+"."+c+"."+p+v,e.abrupt("return",new Promise(function(){var e=Object(i.a)(a.a.mark(function e(t){var r,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.getAccount();case 2:r=e.sent,o={instrumentType:n,guildId:c,contentHashes:v,user:r,filterFavorites:p},y&&(o.searchTerm=y),fetch("/presetSearch/",{method:"POST",body:JSON.stringify(o),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(){var e=Object(i.a)(a.a.mark(function e(n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0==c){e.next=4;break}return e.next=3,Object(u.a)(n,c);case 3:n=e.sent;case 4:t(n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 11:if(O=e.sent.map(function(e){return e.contentHash}),v&&(O=O.filter(function(e){return v.includes(e)})),!p){e.next=17;break}return e.next=16,g(O);case 16:O=e.sent;case 17:return j=new o.a(d.contractAddress).from(f.F).select("user").select("encryptedName").select("contentHash").select("encryptedContentKey").select("publicKey").select("guildId").whereIn("contentHash",O).where("guildId",c),l&&j.fromBlock(l),e.next=21,j.executeQuery();case 21:return w=e.sent,e.next=24,Object(u.a)(w,c);case 24:return E=(E=e.sent).filter(function(e){return e.title}),e.next=28,b(E.map(function(e){return e.contentHash}));case 28:S=e.sent,[],P={},x=h(E);try{for(C=function(){var e=T.value;e.tags=Array.from(new Set(S.filter(function(t){return t.contentHash===e.contentHash}).map(function(e){return e.tag}))),P[e.contentHash]=e},x.s();!(T=x.n()).done;)C()}catch(t){x.e(t)}finally{x.f()}return N=Object.values(P),m[k]=N,e.abrupt("return",N);case 36:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),b=function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new o.a(d.contractAddress).from(f.P).select("contentHash").select("tag").whereIn("contentHash",t),e.next=3,n.executeQuery();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.getAccount();case 2:return n=e.sent,e.next=5,c.a.xanadu.getSoundsWithRating(t,5,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,s=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:0,r=new o.a(d.contractAddress).from(f.F).whereIn("contentHash",t),e.t0=u.a,e.next=5,r.executeQuery();case 5:return e.t1=e.sent,e.t2=n,e.next=9,(0,e.t0)(e.t1,e.t2);case 9:return i=e.sent,e.abrupt("return",i);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),k=function(){return m={}}},function(e,t,n){"use strict";n.d(t,"d",function(){return d}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return b}),n.d(t,"a",function(){return g});var r=n(5),a=n.n(r),i=n(14),o=n(47),s=n(36),c=n(65),u=n(44),l=n(70),f=n(31),h=n(642),p=n(40),d=function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.addJson(t);case 2:return i=e.sent,e.next=5,new l.a(u.t,"newScript",[Object(c.c)(i),s.a.utils.fromAscii(n),s.a.utils.fromAscii(r)]).execute();case 5:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),m=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new p.a((new h.a).contractAddress).select("scriptHash").select("scriptType").select("title").where("scriptType",t).from(f.H),e.next=3,n.executeQuery();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),v={},b=function(e){return e in v?v[e]:(g(e),"")},g=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in v)){e.next=2;break}return e.abrupt("return",v[t]);case 2:return n=new p.a((new h.a).contractAddress).select("scriptHash").from(f.H).where("title",t),e.next=5,n.executeQuery();case 5:if(!(r=e.sent)[0]){e.next=12;break}return e.next=9,o.a.getJson(r[0].scriptHash);case 9:return i=e.sent,v[t]=i,e.abrupt("return",i);case 12:return e.abrupt("return",void 0);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();window.getScripts=m,window.getScriptForTitle=g},function(e,t,n){"use strict";var r=n(8),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(20),l=n(16),f=n(7),h=n(10),p=n(1),d=n(56),m=n(254),v=n(32),b=n(75),g=n(30),y=n(591),k=(n(457),n(15)),O=n.n(k),j=n(423),w=n(21),E=n(47);function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(p.a)(e);if(t){var a=Object(p.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(h.a)(this,n)}}O.a.Frequency("C3");var P={Hangar:"/convolverHangar.wav","Giant Cave":"/convolver/GiantCave.wav","Airport Terminal":"/convolver/AirportTerminal.wav","Outdoor Blastoff":"/convolver/OutdoorBlastOff.wav","Outdoor Stadium":"/convolver/OutdoorStadium.wav","Plate Large":"/convolver/PlateLarge.wav","Plate Medium":"/convolver/PlateMedium.wav","Plate Small":"/convolver/PlateSmall.wav","Plate Super Dry":"/convolver/PlateSuperDry.wav","Prime Long":"/convolver/PrimeLong.wav","Prime Medium":"/convolver/PrimeMed.wav","Prime Short":"/convolver/PrimeShort.wav","Prime Extra Long":"/convolver/PrimeXtraLong.wav","Room Concert Hall":"/convolver/RoomConcertHall.wav","Room Huge":"/convolver/RoomHuge.wav","Room Large":"/convolver/RoomLarge.wav","Room Medium":"/convolver/RoomMedium.wav","Room Pool":"/convolver/RoomPool.wav"},x=function(e){Object(f.a)(n,e);var t=S(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.a.DEFAULT_BUFFER;return Object(s.a)(this,n),(r=t.call(this,"Convolver Reverb",function(){return new O.a.Convolver(a)},e)).rawBuffer=new O.a.Buffer(a),r.convolverSample="QmcdpaZe62u6p47s2Nmi7jYLpgTbmz6MxVnwvndNFi53Sf",r.startParameter=new w.a("start",Object(u.a)(r),function(e,t){return r.start=t},{defaultValue:0,documentation:"Change the start point of the impulse",automatable:!1}),r.pitchParameter=new w.a("Pitch",Object(u.a)(r),function(e,t){return r.pitch=t},{documentation:"Change the pitch of the impulse",automatable:!1}),r.durationParameter=new w.a("duration",Object(u.a)(r),function(e,t){return r.release=t},{defaultValue:100,documentation:"Change the length of the impulse",automatable:!1}),r.attackParameter=new w.a("attack",Object(u.a)(r),function(e,t){return r.attack=t},{defaultValue:0,documentation:"Change the attack, or fade-in, of the impulse",automatable:!1}),r.registerParameter(r.attackParameter),r.registerParameter(r.startParameter),r.registerParameter(r.pitchParameter),r.registerParameter(r.durationParameter),r.updateInitialValues(),r}return Object(c.a)(n,[{key:"documentation",get:function(){return["Uses an impulse sample to create a realistic reverb.","Drag any sample into this effect to change the impulse sample."]}},{key:"start",get:function(){return this.startParameter.get(!0)},set:function(e){100!==e&&this.renderBuffer()}},{key:"release",set:function(e){100!==e&&e>.01&&this.renderBuffer()}},{key:"attack",get:function(){return this.attackParameter.get(!0)},set:function(e){0!==e&&this.renderBuffer()}},{key:"pitch",get:function(){return this.pitchParameter.get(!0)},set:function(e){0!==e?this.renderBuffer():this.effectNode&&(this.effectNode.buffer=this.rawBuffer)}},{key:"getBouncedSample",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.renderedBuffer,n=[t.getChannelData(0)],t.numberOfChannels>1&&n.push(t.getChannelData(1)),e.next=5,Object(m.a)(n);case 5:return r=e.sent,e.next=8,E.a.addArrayBuffer(r);case 8:return a=e.sent,e.abrupt("return",a);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"duration",get:function(){return this.durationParameter.get(!0)}},{key:"renderBuffer",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r,a,o,s,c,u,l,f,h,p;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.rawBuffer&&null!==this.rawBuffer){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==this.startParameter&&void 0!==this.durationParameter&&void 0!==this.pitchParameter){e.next=4;break}return e.abrupt("return");case 4:if(this.effectNode){e.next=6;break}return e.abrupt("return");case 6:if(t=new O.a.Buffer(this.rawBuffer),this.effectNode){e.next=9;break}return e.abrupt("return");case 9:if(!window.isNFT){e.next=12;break}return this.effectNode.buffer=t,e.abrupt("return");case 12:if(n=t.duration*this.start/100,r=t.duration-n,this.effectNode){e.next=16;break}return e.abrupt("return");case 16:if(a=r*this.duration/100,o=a*this.attack/100,this.effectNode){e.next=20;break}return e.abrupt("return");case 20:if(this.sequencerEngine.hasConvolver=!0,this.effectNode){e.next=23;break}return e.abrupt("return");case 23:return s=O.a.Master.context.sampleRate,c=new OfflineAudioContext(2,s*a*2,s),u=c.createBufferSource(),(l=c.createGain(1)).connect(c.destination),o>0&&(l.gain.value=0,l.gain.linearRampToValueAtTime(1,o)),l.gain.linearRampToValueAtTime(0,a),u.connect(l),f=O.a.intervalToFrequencyRatio(this.pitch),u.playbackRate.value=f,u.buffer=t._buffer,u.start(0,n),e.next=37,c.startRendering();case 37:h=e.sent,p=0;case 39:if(void 0!==this.effectNode){e.next=47;break}return e.next=42,this.sleep(100);case 42:if(!(++p>10)){e.next=45;break}return e.abrupt("return");case 45:e.next=39;break;case 47:this.renderedBuffer=new O.a.Buffer(h),this.effectNode.buffer=new O.a.Buffer(h);case 49:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sleep",value:function(e){return new Promise(function(t,n){setTimeout(function(){return t()},e)})}},{key:"setConvolverSample",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===this.encryptedIpfs&&(this.encryptedIpfs=new j.a(this.sequencerEngine.store,this.sequencerEngine.ethereum.guilds,this.sequencerEngine.ethereum.encryption,this.sequencerEngine.ethereum.crypto)),e.next=3,this.encryptedIpfs.getSound(t);case 3:if(void 0!==(n=e.sent)){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,O.a.Master.context.decodeAudioData(n.buffer);case 8:if(r=e.sent,this.effectNode){e.next=11;break}return e.abrupt("return");case 11:return this.convolverType=void 0,this.convolverSample=t,this.rawBuffer=r,e.next=16,this.renderBuffer();case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setConvolverType",value:function(e){var t=this;return new Promise(function(n,r){if(e in P){var a=window.installation?"/public"+P[e]:P[e];t.effectNode.load(a,Object(o.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.rawBuffer=new O.a.Buffer(t.effectNode.buffer),e.next=3,t.renderBuffer();case 3:n();case 4:case"end":return e.stop()}},e)}))),t.samplePitch=0,t.convolverType=e,t.convolverSample=void 0}})}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var r=new n(e);return r.fromJson(this.getJson()),r}var a=new n(e,new O.a.Buffer(this.effectNode.buffer));return a.wetParameter.fromJson(this.wetParameter.getJson(),e),t||(a.id=this.id,a.wetParameter.id=this.wetParameter.id),a}},{key:"makePublicIfNeeded",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.convolverSample){e.next=12;break}return e.next=3,g.a.guildSamples.getGuildIdForSound(this.convolverSample);case 3:if(void 0===(t=e.sent)||0===t){e.next=12;break}return n=new b.a(this.convolverSample),e.next=8,n.load();case 8:return e.next=10,g.a.guildSamples.saveSample(n);case 10:r=e.sent,this.convolverSample=r;case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getJson",value:function(e){var t=Object(r.a)({},Object(l.a)(Object(p.a)(n.prototype),"getJson",this).call(this,e),{name:this.name,enabled:this.enabledParameter.get(!0),convolverType:this.convolverType,convolverSample:this.convolverSample,start:this.start,pitch:this.pitch,attack:this.attack,duration:this.duration});return t=this.saveParameterToJson(t,"wetParameter",this.wetParameter)}},{key:"fromJson",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var a,o,s=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]&&s[1],e.next=3,this.sleep(50);case 3:if(o=Object(l.a)(Object(p.a)(n.prototype),"fromJson",this).call(this,t,a),void 0===t.convolverType){e.next=10;break}if("Prime Extra Long"===t.convolverType){e.next=8;break}return e.next=8,this.setConvolverType(t.convolverType);case 8:e.next=15;break;case 10:if(void 0===t.convolverSample){e.next=15;break}return e.next=13,this.sleep(150);case 13:return e.next=15,this.setConvolverSample(t.convolverSample,t);case 15:if(!("pitch"in t)){e.next=20;break}if(Object(v.a)(this.pitchParameter,t.pitch,o),0===t.pitch){e.next=20;break}return e.next=20,this.sleep(50);case 20:if(!("duration"in t)){e.next=25;break}if(Object(v.a)(this.durationParameter,t.duration,o),100===t.duration){e.next=25;break}return e.next=25,this.sleep(50);case 25:return"attack"in t&&Object(v.a)(this.attackParameter,t.attack,o),"start"in t&&Object(v.a)(this.startParameter,t.start,o),e.abrupt("return",Object(r.a)({},o));case 28:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){Object(l.a)(Object(p.a)(n.prototype),"dispose",this).call(this,!1),this.rawBuffer&&this.rawBuffer.dispose&&this.rawBuffer.dispose(),this.rawBuffer=void 0,this.attackParameter=void 0,this.pitchParameter=void 0,this.durationParameter=void 0}}]),n}(d.a.Effect);t.a=x},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(15),h=n.n(f),p=n(56),d=n(21),m=n(41),v=n(23),b=n(397);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var y="peaking",k=function(e){Object(c.a)(n,e);var t=g(n);function n(e){var r,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var s in Object(a.a)(this,n),(r=t.call(this,"EQ8",function(){return new h.a.Gain(1)},e)).store=e.store,r.equalizerPoints=[new O(e,Object(o.a)(r),80,0,1,1,!0,"lowshelf"),new O(e,Object(o.a)(r),300,0,1,2,!1),new O(e,Object(o.a)(r),500,0,1,3,!1),new O(e,Object(o.a)(r),800,0,1,4,!1),new O(e,Object(o.a)(r),1e3,0,1,5),new O(e,Object(o.a)(r),2e3,0,1,6,!1),new O(e,Object(o.a)(r),4e3,0,1,7),new O(e,Object(o.a)(r),8e3,0,1,8,!0,"highshelf")],r.updateRate=b.b,i&&(r.analyser=new h.a.Analyser("fft",256)),r.outputNode=new h.a.Gain(1),r.setupEqualizer(),r.equalizerPoints)r.parameters=r.parameters.concat(r.equalizerPoints[s].parameters);return r.updateInitialValues(),r}return Object(i.a)(n,[{key:"dispose",value:function(){Object(s.a)(Object(l.a)(n.prototype),"dispose",this).call(this),this.analyser&&(this.analyser.dispose(),this.analyser=void 0),this.equalizerPoints.forEach(function(e){return e.dispose()}),this.equalizerPoints=void 0,this.outputNode.dispose(),this.outputNode=void 0}},{key:"disconnectAllFilters",value:function(){this.effectNode.disconnect(),this.equalizerPoints.filter(function(e){return e.enabled}).forEach(function(e){return e.filter.disconnect()})}},{key:"setupEqualizer",value:function(){var e,t=this.equalizerPoints.filter(function(e){return e.enabled}).map(function(e){return e.filter});t.push(this.outputNode),(e=this.effectNode).chain.apply(e,Object(r.a)(t))}},{key:"getSpectrum",value:function(){return this.analyser.getValue()}},{key:"connect",value:function(e){this.outputNode.connect(e),this.analyser&&this.outputNode.connect(this.analyser)}},{key:"disconnect",value:function(e){this.outputNode.disconnect(e),this.analyser&&this.analyser.disconnect()}},{key:"getJson",value:function(){var e=Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this);return e.updateRate=this.updateRate,e.equalizerPoints=this.equalizerPoints.map(function(e){return e.getJson()}),e}},{key:"fromJson",value:function(e,t){for(var r in Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t),"updateRate"in e&&(this.updateRate=e.updateRate),this.equalizerPoints)this.equalizerPoints[r].fromJson(e.equalizerPoints[r]);return this}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(p.a.Effect),O=function(){function e(t,n,r,i,o,s){var c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:y;Object(a.a)(this,e),this.eq=n,this.name="EQ Frequency "+s,this.number=s,this.type=u,this.sequencerEngine=t,this.store=t.store,this.filter=new h.a.Filter(r,u),this.filter.Q.value=o,this.filter.gain.value=i,this.frequencyParameter=new m.c(this.name+" frequency",this.filter.frequency,{min:0,max:1e4,unit:"hz",defaultValue:r}),this.gainParameter=new m.c(this.name+" gain",this.filter.gain,{min:-16,max:16,unit:"db",defaultValue:i}),this.qParameter=new m.c(this.name+" q",this.filter.Q,{min:0,max:16,unit:"Q",defaultValue:o}),this.enabledParameter=new d.a(this.name+" enabled",this,function(e,t){},{min:0,max:1,unit:"boolean",defaultValue:c}),this.parameters=[],this.registerParameter(this.enabledParameter),this.registerParameter(this.frequencyParameter),this.registerParameter(this.gainParameter),this.registerParameter(this.qParameter)}return Object(i.a)(e,[{key:"dispose",value:function(){this.filter._param&&this.filter.dispose(),this.filter=void 0,this.parameters.forEach(function(e){return e.dispose()}),this.gainParameter=void 0,this.frequencyParameter=void 0,this.qParameter=void 0,this.sequencerEngine=void 0,this.eq=void 0,this.name=void 0,this.store=void 0,this.parameters=void 0,this.type=void 0}},{key:"getJson",value:function(){var e={number:this.number,frequency:this.frequency,gain:this.gain,q:this.q,enabled:this.enabled};return e=Object(v.b)(e,"frequencyParameter",this.frequencyParameter),e=Object(v.b)(e,"qParameter",this.qParameter),e=Object(v.b)(e,"gainParameter",this.gainParameter),e=Object(v.b)(e,"enabledParameter",this.enabledParameter)}},{key:"fromJson",value:function(e){this.enabled=e.enabled,this.frequency=e.frequency,this.frequencyParameter.unlockedValue=e.frequency,this.q=e.q,this.qParameter.unlockedValue=e.q,this.gain=e.gain,this.gainParameter.unlockedValue=e.gain,Object(v.a)(e,"frequencyParameter",this.frequencyParameter,this.sequencerEngine),Object(v.a)(e,"qParameter",this.qParameter,this.sequencerEngine),Object(v.a)(e,"gainParameter",this.gainParameter,this.sequencerEngine),Object(v.a)(e,"enabledParameter",this.enabledParameter)}},{key:"registerParameter",value:function(e){void 0!==e&&(e.name=e.name,e.effectName=this.name,e.setStore(this.store),this.parameters.push(e))}},{key:"enabled",get:function(){return this.enabledParameter.get()},set:function(e){return this.enabledParameter.set(e)}},{key:"frequency",get:function(){return this.frequencyParameter.get()},set:function(e){this.frequencyParameter.set(e)}},{key:"gain",get:function(){return this.gainParameter.get()},set:function(e){this.gainParameter.set(e)}},{key:"q",get:function(){return this.qParameter.get()},set:function(e){this.qParameter.set(e)}},{key:"frequencyToGain",value:function(e){return"peaking"===this.type?this.frequencyToGainPeaking(e):"highshelf"===this.type?this.frequencyToGainHighShelf(e):this.frequencyToGainLowShelf(e)}},{key:"frequencyToGainPeaking",value:function(e){var t=200/this.q,n=e-t/2,r=e+t/2;return e<=n||e>=r?0:e<this.frequency?this.gain*((e-n)/(this.frequency-n)):this.gain*((r-e)/(r-this.frequency))}},{key:"frequencyToGainHighShelf",value:function(e){var t=e-100;return(e+=100)<=t?0:e>=this.frequency?this.gain:this.gain*((e-t)/(this.frequency-t))}},{key:"frequencyToGainLowShelf",value:function(e){var t=e+100;return e>=t?0:e<=this.frequency?this.gain:this.gain*((e-t)/(this.frequency-t))}}]),e}();t.a=k},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(16),s=n(7),c=n(10),u=n(1),l=n(381),f=n(163),h=n(89),p=n(248),d=n(21);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Playhead",h.e,e)).system5Objects=[],a.directionParameter=new p.a("direction",Object(i.a)(a),function(e,t){return t},{min:0,max:1,isNumber:!0,unit:"",options:{.1:f.b,.25:f.d,.5:f.c,.75:f.a},defaultValue:f.b}),a.registerParameter(a.directionParameter),a.speedFactorParameter=new d.a("speedFactor",Object(i.a)(a),function(e,t){return t},{min:0,max:16,unit:"x",defaultValue:1,onChange:function(e){return a.system5Objects.forEach(function(e){return e.sendSpeeds()})}}),a.registerParameter(a.speedFactorParameter),a.offsetParameter=new d.a("offset",Object(i.a)(a),function(e,t){return t},{min:0,max:32,unit:"x",defaultValue:0}),a.registerParameter(a.offsetParameter),a.walkParameter=new d.a("walk",Object(i.a)(a),function(e,t){return t},{min:1,max:16,defaultValue:8}),a.registerParameter(a.walkParameter),a}return Object(a.a)(n,[{key:"getParameters",value:function(){return this.parameters}},{key:"offset",get:function(){return this.offsetParameter.get()}},{key:"direction",get:function(){return this.directionParameter.get()}},{key:"speedFactor",get:function(){return this.speedFactorParameter.get()}},{key:"walk",get:function(){return Math.round(this.walkParameter.get())}},{key:"fromJson",value:function(e,t){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t)}},{key:"getCopy",value:function(e){var t=new n(e);return t.fromJson(this.getJson()),t}}]),n}(l.a);t.a=v},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return o});var r="AUDITION_NEXT_SAMPLE",a="AUDITION_PREVIOUS_SAMPLE",i="TRIGGER_SAMPLE",o="RELEASE_SAMPLE"},function(e,t,n){"use strict";n.d(t,"d",function(){return l}),n.d(t,"a",function(){return f}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return d}),n.d(t,"c",function(){return m});var r=n(5),a=n.n(r),i=n(14),o=n(9);function s(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function e(t){var n=[];if(t.tracks&&Array.isArray(t.tracks)&&(n=[].concat(Object(o.a)(n),Object(o.a)(t.tracks.map(function(t){return e(t.track)})))),t.samplers&&(n=[].concat(Object(o.a)(n),Object(o.a)(Object.keys(t.samplers)))),t.instrument&&t.instrument.getSamples){var r=t.instrument.getSamples().map(function(e){return e.getId()});n=[].concat(Object(o.a)(n),Object(o.a)(r))}if(t.frozenColumns){var a,i=s(t.frozenColumns);try{for(i.s();!(a=i.n()).done;){var c=a.value;n=[].concat(Object(o.a)(n),Object(o.a)(c.frozenSamples.map(function(e){return e.getId()})))}}catch(h){i.e(h)}finally{i.f()}}var u,l=s(t.effects);try{for(l.s();!(u=l.n()).done;){var f=u.value;"Convolver Reverb"===f.name&&n.push(f.convolverSample)}}catch(h){l.e(h)}finally{l.f()}return n},l=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,c,l,f,h,p,d,m,v,b,g,y,k,O;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=s(t.subSequences);try{for(r.s();!(i=r.n()).done;){c=i.value,l=s(c.tracks);try{for(l.s();!(f=l.n()).done;)h=f.value,n=[].concat(Object(o.a)(n),Object(o.a)(u(h)))}catch(a){l.e(a)}finally{l.f()}}}catch(a){r.e(a)}finally{r.f()}n=[].concat(Object(o.a)(n),Object(o.a)(u(t.metronome))),p=s(t.sends.sends);try{for(p.s();!(d=p.n()).done;){m=d.value,v=s(m.effects);try{for(v.s();!(b=v.n()).done;)"Convolver Reverb"===(g=b.value).name&&n.push(g.convolverSample)}catch(a){v.e(a)}finally{v.f()}}}catch(a){p.e(a)}finally{p.f()}y=s(t.channelMixer.masterChannel.effectsChain.effects);try{for(y.s();!(k=y.n()).done;)"Convolver Reverb"===(O=k.value).name&&n.push(O.convolverSample)}catch(a){y.e(a)}finally{y.f()}return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,c,u,l,f,h,p,d;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=s(t.sends.sends),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=27;break}i=r.value,o=s(i.effects),e.prev=6,o.s();case 8:if((c=o.n()).done){e.next=17;break}if("Convolver Reverb"!==(u=c.value).name){e.next=15;break}return e.next=13,u.getBouncedSample();case 13:l=e.sent,u.convolverSample=l;case 15:e.next=8;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(6),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:e.next=3;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(1),n.e(e.t1);case 32:return e.prev=32,n.f(),e.finish(32);case 35:f=s(t.channelMixer.masterChannel.effectsChain.effects),e.prev=36,f.s();case 38:if((h=f.n()).done){e.next=47;break}if("Convolver Reverb"!==(p=h.value).name){e.next=45;break}return e.next=43,p.getBouncedSample();case 43:d=e.sent,p.convolverSample=d;case 45:e.next=38;break;case 47:e.next=52;break;case 49:e.prev=49,e.t2=e.catch(36),f.e(e.t2);case 52:return e.prev=52,f.f(),e.finish(52);case 55:case"end":return e.stop()}},e,null,[[1,29,32,35],[6,19,22,25],[36,49,52,55]])}));return function(t){return e.apply(this,arguments)}}(),h=function e(t){var n=[];if(t.tracks)return t.tracks.flatMap(function(t){return e(t)});if(t.samplers)for(var r in t.samplers)n.push(t.samplers[r].sample);if(t.instrument&&t.instrument.getSamples){var a=t.instrument.getSamples();n=[].concat(Object(o.a)(n),Object(o.a)(a))}return n},p=function(e){var t,n=[],r=s(e.subSequences);try{for(r.s();!(t=r.n()).done;){var a,i=s(t.value.tracks);try{for(i.s();!(a=i.n()).done;){var c=a.value;n=[].concat(Object(o.a)(n),Object(o.a)(h(c)))}}catch(l){i.e(l)}finally{i.f()}}}catch(l){r.e(l)}finally{r.f()}var u={};return n.forEach(function(e){return u[e.getId()]=e.getJson()}),u},d=function(e){var t,n={},r=s(e.subSequences);try{for(r.s();!(t=r.n()).done;){var a,i=s(t.value.tracks);try{for(i.s();!(a=i.n()).done;){var o=a.value;n[o.id]=h(o)}}catch(c){i.e(c)}finally{i.f()}}}catch(c){r.e(c)}finally{r.f()}return n},m=function(e){return e.subSequences.flatMap(function(e){return v(e)})},v=function e(t){var n,r=t.zObjects.filter(function(e){return"three.textureLoader"===e.name}).map(function(e){return e.effect.imageHash}).filter(function(e){return e}),a=s(t.zObjects);try{for(a.s();!(n=a.n()).done;){var i=n.value;"subpatch"===i.name&&(r=[].concat(Object(o.a)(r),Object(o.a)(e(i.effect))))}}catch(c){a.e(c)}finally{a.f()}return r}},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(9),o=n(14),s=n(2),c=n(4),u=n(242),l=n.n(u),f=n(259),h=n.n(f),p=16384,d=256,m={name:"AES-CTR",counter:new h.a.Counter(5)._counter,length:64};function v(e,t){return b.apply(this,arguments)}function b(){return(b=Object(o.a)(a.a.mark(function e(t,n){var r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length<p)){e.next=4;break}return e.next=3,k(t,n);case 3:return e.abrupt("return",e.sent);case 4:return r=y(t),e.next=7,k(r,n);case 7:return i=e.sent,o=g(t,new Uint8Array(i)),e.abrupt("return",o);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e,t){for(var n=Math.ceil(p/d),r=Math.floor(e.length/d),a=0;a<d;a++){var i=a*r,o=a*n;e.set(t.subarray(o,o+n),i)}return e}function y(e){for(var t=Math.ceil(p/d),n=Math.floor(e.length/d),r=new Uint8Array(p),a=0;a<d;a++){var i=a*n;r.set(e.subarray(i,i+t),a*t)}return r}function k(e,t){return O.apply(this,arguments)}function O(){return(O=Object(o.a)(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.importKey("raw",new Uint8Array(n).buffer,{name:"AES-CTR"},!1,["encrypt","decrypt"]);case 2:return r=e.sent,e.next=5,window.crypto.subtle.encrypt(m,r,new Uint8Array(t));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(e,t){return w.apply(this,arguments)}function w(){return(w=Object(o.a)(a.a.mark(function e(t,n){var r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length<p)){e.next=5;break}return e.next=3,E(t,n);case 3:return r=e.sent,e.abrupt("return",new Uint8Array(r));case 5:return i=y(t),e.t0=Uint8Array,e.next=9,E(i,n);case 9:return e.t1=e.sent,o=new e.t0(e.t1),s=g(t,o),e.abrupt("return",s);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function E(e,t){return S.apply(this,arguments)}function S(){return(S=Object(o.a)(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.importKey("raw",new Uint8Array(n).buffer,{name:"AES-CTR"},!1,["decrypt"]);case 2:return r=e.sent,e.next=5,window.crypto.subtle.decrypt(m,r,t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var P=n(30);function x(e,t){console.log("sound shuffle content=",e);for(var n=Math.ceil(e.length/256),r=Object(i.a)(t),a=void 0,o=0;o<256;o++){var s=o*n,c=(o+r[o%r.length])%256*n,u=e.subarray(s,s+n);a=Object(i.a)(e.subarray(c,c+n)),c+n>e.length||s+n>e.length||(e.set(u,c),e.set(a,s))}return e}function T(e,t){for(var n=Math.ceil(e.length/256),r=Object(i.a)(t),a=void 0,o=255;o>=0;o--){var s=o*n,c=(o+r[o%r.length])%256*n;if(!(s+n>e.length||c+n>e.length)){var u=e.subarray(s,s+n);a=new Uint8Array(e.subarray(c,c+n)),e.set(u,c),e.set(a,s)}}return e}var C=n(386),N=(new h.a.Counter(5)._counter,function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.a.generateAESKey();Object(s.a)(this,e),this.contentKey="string"===typeof t?h.a.utils.hex.toBytes(t):t,this.publicKey=void 0}return Object(c.a)(e,[{key:"encryptKey",value:function(e){this.publicKey=e;var t=h.a.utils.hex.fromBytes(this.contentKey),n=l.a.encrypt(t,e).cipher,r=P.a.web3.utils.toHex(n);this.encryptedContentKey=r,this.eck=n}},{key:"convertForEthereum",value:function(){return Object(C.a)(this.encryptedContentKey)}},{key:"encryptContent",value:function(){var e=Object(o.a)(a.a.mark(function e(t){var n,r,o,s,c,u,l,f=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]&&f[1],void 0!==t){e.next=3;break}return e.abrupt("return","");case 3:if(r=new Uint8Array(this.contentKey).buffer,console.log("encrypt content= ",t),o=n?t:h.a.utils.utf8.toBytes(t),s=n?x(o,new Uint8Array(this.contentKey)):o,!n){e.next=14;break}return e.next=10,v(s,r);case 10:return c=e.sent,e.abrupt("return",c);case 14:return e.next=16,k(o,this.contentKey);case 16:return u=e.sent,l=h.a.utils.hex.fromBytes(Object(i.a)(new Uint8Array(u))),e.abrupt("return",l);case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"decryptContent",value:function(e){var t=this;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?new Promise(function(){var n=Object(o.a)(a.a.mark(function n(r,i){var o;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,j(e,t.contentKey);case 2:o=T(o=n.sent,new Uint8Array(t.contentKey)),r(o);case 5:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()):new Promise(function(){var n=Object(o.a)(a.a.mark(function n(r,o){var s,c,u;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,s="string"===typeof e?h.a.utils.hex.toBytes(e):e,n.next=4,E(new Uint8Array(s),t.contentKey);case 4:c=n.sent,u=h.a.utils.utf8.fromBytes(Object(i.a)(new Uint8Array(c))),r(u),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.log("error=",n.t0),r("");case 13:case"end":return n.stop()}},n,null,[[0,9]])}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getPublicKeyAsBytes32",value:function(){var e=P.a.web3.utils.toHex(this.publicKey);return Object(C.a)(e)}}]),e}());t.a=N},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(222),u=function(){function e(t,n){Object(o.a)(this,e),this.index=0,this.width=t,this.height=n,this.idToWaveform={},this.idToBasicWaveform={},this.reversedIdToWaveform={}}return Object(s.a)(e,[{key:"getBasicWaveform",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e!==c.a;return new Promise(function(a,i){r&&e in n.idToBasicWaveform?a(n.idToBasicWaveform[e]):n.computeBasicWaveform(t).then(function(t){r&&(n.idToBasicWaveform[e]=t),a(t)})})}},{key:"getWaveform",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e!==c.a,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.height;return new Promise(function(o,s){n.computeWaveformPoints(t,0,[],function(t){r&&(n.idToWaveform[e]=t),o(t)},a,i)})}},{key:"getReversedWaveform",value:function(e,t){var n=this;return new Promise(function(r,a){e in n.reversedIdToWaveform?r(n.reversedIdToWaveform[e]):n.computeWaveformPoints(t,0,[],function(t){n.reversedIdToWaveform[e]=t,r(t)})})}},{key:"computeWaveformPoints",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r,i){var o,s,c,u,l,f,h,p,d,m,v,b,g=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=g.length>4&&void 0!==g[4]?g[4]:1,s=g.length>5?g[5]:void 0,o=1,c=this.width,!((n+1)*c>this.width)){e.next=7;break}return i([]),e.abrupt("return");case 7:for(u=Math.floor(t.length/this.width),l=(l=t.getChannelData(0)).subarray(c*n*u,c*(n+1)*u),f=window.api.create_buffer(l.length),Math.min((n+1)*c,this.width),window.Module.HEAPF32.set(l,f>>2),window.api.getColoredWaveform(f,c,s,l.length,u,c*n,o),h=window.api.get_result_pointer(),p=new Uint16Array(window.Module.HEAP16.buffer,h,7*c/o),d=[],m=0;m<7*c/o;m+=7)v=[p[m+4],p[m+5],p[m+6]],d.push({x:p[m],y:p[m+1],width:p[m+2],height:p[m+3],rgb:v});b=this,window.api.destroy_buffer(f),setTimeout(function(){b.computeWaveformPoints(t,n+1,r.concat(d),function(e){i(d.concat(e))})},2);case 21:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"computeBasicWaveform",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.index++,n=this.index,r=Math.floor(t.length/this.width),i=t.getChannelData(0),o=window.api.create_buffer(i.length),this.width,window.Module.HEAPF32.set(i,o>>2),window.api.getWaveform(o,parseInt(this.width),parseInt(this.height),i.length,r),s=window.api.get_result_pointer(),c=new Uint16Array(window.Module.HEAP16.buffer,s,3*this.width),u=[],!(n<this.index)){e.next=13;break}return e.abrupt("return",void 0);case 13:for(l=0,f=0;f<3*this.width;f+=3)u.push({x:l,y:c[f+1],rmsY:c[f+2]}),l++;return window.api.destroy_buffer(o),e.abrupt("return",u);case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}();t.a=u},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"creator",type:"address"},{indexed:!0,internalType:"uint256",name:"projectId",type:"uint256"},{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"maxInvocations",type:"uint256"},{indexed:!1,internalType:"string",name:"title",type:"string"}],name:"NewCreatorProject",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"projectId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"bytes32",name:"seedHash",type:"bytes32"}],name:"NewTokenSeed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"projectId",type:"uint256"},{internalType:"uint256",name:"n",type:"uint256"}],name:"getProjectTokenId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"idToProject",outputs:[{internalType:"address payable",name:"creator",type:"address"},{internalType:"bytes32",name:"contentHash",type:"bytes32"},{internalType:"uint256",name:"maxInvocations",type:"uint256"},{internalType:"uint256",name:"pricePerTokenInWei",type:"uint256"},{internalType:"uint256",name:"fromTokenId",type:"uint256"},{internalType:"uint256",name:"toTokenId",type:"uint256"},{internalType:"uint256",name:"invocations",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"projectId",type:"uint256"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"contentHash",type:"bytes32"},{internalType:"string",name:"title",type:"string"},{internalType:"uint16",name:"maxInvocations",type:"uint16"},{internalType:"bool",name:"shouldMint",type:"bool"},{internalType:"uint256",name:"pricePerTokenInWei",type:"uint256"}],name:"newProject",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"payable",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"tokenIdToHash",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_base",type:"string"}],name:"updateBaseTokenURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"percentage",type:"uint256"}],name:"updateFoundationPercentage",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"projectId",type:"uint256"},{internalType:"uint256",name:"price",type:"uint256"}],name:"updateProjectPrice",outputs:[],stateMutability:"nonpayable",type:"function"}],this.contractAddress="0x12DB0cE2da04E449550194587bC350aB8b3189d9"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"h",function(){return l}),n.d(t,"g",function(){return f});var r="FORWARD",a="REWIND",i="PAUSE",o="RESTART",s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{name:"Forward",type:r,value:e}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{name:"Rewind",type:a,value:e}},u=function(){return{name:"Pause",type:i}},l=function(){return{name:"Restart",type:o}},f=function(){return{name:"Play",type:"PLAY"}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r=1,a=2},,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(9);function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var o=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.state,o=Object(r.a)(t.zMessages);if(t.tracks){o=[].concat(Object(r.a)(o),Object(r.a)(t.midiEffects.effects));var s,c=a(t.tracks);try{for(c.s();!(s=c.n()).done;){var u=s.value;o=[].concat(Object(r.a)(o),Object(r.a)(u.midiEffects.effects)),o=[].concat(Object(r.a)(o),Object(r.a)(u.effects))}}catch(d){c.e(d)}finally{c.f()}}var l,f=a(t.zObjects);try{for(f.s();!(l=f.n()).done;){var h=l.value;if(!n||!i.spatial.hiddenObjects[h.id]){o.push(h);var p=h.effect;p&&(o.push(p),p.zObjects&&(o=[].concat(Object(r.a)(o),Object(r.a)(e(p)))))}}}catch(d){f.e(d)}finally{f.f()}return o}},function(e,t,n){"use strict";function r(e){for(var t,n,r=e.length;0!==r;)n=Math.floor(Math.random()*r),t=e[r-=1],e[r]=e[n],e[n]=t;return e}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(9),a=n(8),i=n(2),o=n(4),s=n(16),c=n(7),u=n(10),l=n(1),f=n(21),h=n(50),p=n(774),d=n(311),m=n(379),v=n(6);function b(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}t.a=function(e){return function(e){Object(c.a)(n,e);var t=y(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a)))._parameters=[],e.initialParameterValues=[],e.initialParameterDepths=[],e.depthParameters=[],e}return Object(o.a)(n,[{key:"setupNodeMessaging",value:function(){var e=this;this.newInlet(h.h,function(){e.stop(),e.clear()})}},{key:"newDepthParameter",value:function(e){var t=new f.a("depth",this,function(e,t){return t},{units:"%",min:0,max:100,defaultValue:100});return this.context&&t.setContext(this.context),this.registerParameter(t),t}},{key:"getDepth",value:function(e){return this.depthParameters[e]?this.depthParameters[e].get():0}},{key:"setupRampParameters",value:function(){this.rampTimeParameter=new f.a("rampTime",this,function(e,t){return t},{documentation:"Time it takes (in ms) to reach the value its adding",min:0,max:1e4,defaultValue:80}),this.registerParameter(this.rampTimeParameter),this.resetAtZeroParameter=new f.a("resetAtZero",this,function(e,t){return t},{documentation:"Should the accumulator reset to 0 upon reaching step 1 in the pattern",min:0,max:1,defaultValue:!1}),this.registerParameter(this.resetAtZeroParameter),this.initDisabledParameters()}},{key:"getInitialValueForParameter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._parameters.indexOf(e);return this.initialParameterValues[t]}},{key:"setInitialValueForParameter",value:function(e,t){var n=this._parameters.indexOf(e);this.initialParameterValues[n]=t}},{key:"shouldSkipParameter",value:function(e){return!1}},{key:"resetValues",value:function(){var e={};for(var t in this._parameters)if(!this.shouldSkipParameter(t)){var n=this._parameters[t];if(void 0!==this.initialParameterValues[t]){var r=this.initialParameterValues[t];if((r<n.min||r>n.max)&&(r=(n.min+n.max)/2),n._wasDisposed)continue;var a=n.set(r,!0,!0);if(e[a.id]=a.value,n.depthParameter){var i=n.depthParameter,o=this.initialParameterDepths[t];if(void 0===o)continue;(o<i.min||o>i.max)&&(o=(i.min+i.max)/2),e[(a=i.set(o,!0,!0)).id]=a.value}else n.depth=this.initialParameterDepths[t]}}this.setEffectParameterValues(e)}},{key:"setEffectParameterValues",value:function(e){this.track.sequencerEngine.dispatch(Object(v.Vb)(e))}},{key:"stop",value:function(){this.resetValues()}},{key:"unmap",value:function(e){var t=this._parameters.indexOf(e);this.unmapParameter(t)}},{key:"unmapParameter",value:function(e){var t=this._parameters[e];if(t){t.locked=void 0,this._parameters.splice(e,1);var n=this.depthParameters[e];this.depthParameters.splice(e,1);var r=this.parameters.indexOf(n);this.parameters.splice(r,1),this.onParameterUnmapped(t);var a=this.initialParameterValues[e];return this.initialParameterValues.splice(e,1),void 0!==a&&t.set(a,!0,!1),t[this.key]=void 0,t}}},{key:"onParameterUnmapped",value:function(){}},{key:"key",get:function(){return"isMapped"}},{key:"setParameter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._parameters.length;this._parameters[t]=e,this.initialParameterValues[t]=e.get(!0),this.depthParameters[t]||(this.depthParameters[t]=this.newDepthParameter(e)),e[this.key]=this}},{key:"_clear",value:function(){for(var e in this.initialParameterValues=[],this._parameters)if(!this.shouldSkipParameter(e)){var t=this._parameters[e];this.clearParameter(t)}}},{key:"clearParameter",value:function(e,t){this._clearParameter(e,t)}},{key:"_clearParameter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._parameters.indexOf(e);if(e){var n=e.get(!0);if(n>=e.max?e.max=n:n<=e.min&&(e.min=n),this.initialParameterValues[t]=n,e.depthParameter){var r=e.depthParameter.get(!0);isNaN(r)?this.initialParameterDepths[t]=1:this.initialParameterDepths[t]=r}else this.initialParameterDepths[t]=e.depth}}},{key:"resetAtZero",get:function(){return this.resetAtZeroParameter.get()}},{key:"rampTime",get:function(){return this.rampTimeParameter.get()}},{key:"onNewStep",value:function(){this.triggers.length>0&&(this.triggers.length=0)}},{key:"clear",value:function(){Object(s.a)(Object(l.a)(n.prototype),"clear",this).call(this),this._clear()}},{key:"getParameterValueToSet",value:function(e){return 0}},{key:"setParameterValues",value:function(e){var t={};for(var n in this._parameters)if(n=parseInt(n),!this.parametersDisabled.includes(n)){var r=this.getParameterValueToSet(n),i=this._parameters[n];if(!isNaN(r)&&i.get(!0)!==r){var o=i.max,s=i.min,c=i.set(Math.min(o,Math.max(s,r)),!0,!0,e,this.rampTime/1e3),u=c.id,l=c.value;t[u]=l}}this.track.sequencerEngine.parametersToUpdate=Object(a.a)({},this.track.sequencerEngine.parametersToUpdate,t)}},{key:"loadParameters",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={},i=this.track&&this.track.subSequence;if(!e||this.subSequence&&!this.subSequence.tracks){if(!this.subSequence.getRootSubSequence)return{lostParameters:[],newMappings:a};i=this.subSequence.getRootSubSequence()}var o,s=this.track.sequencerEngine,c=[],u=b(e);try{var l=function(){var e=o.value,u="object"===typeof e?e.id:e,l=void 0;"BPM"===e.name&&(l=s.bpmParameter);var f=s.parameters.find(function(e){return e.id===u});f&&(l=f);var h,d=b(t.track.getAllParameters?[t.track].concat(Object(r.a)(i.tracks.filter(function(e){return e!==t.track}))):i.tracks);try{var m=function(){var e=h.value.getAllParameters(),t=[];e.forEach(function(e){t.push(e),e.depthParameter&&t.push(e.depthParameter)});var n=t.find(function(e){return u===e.id});if(n)return l=n,"break"};for(d.s();!(h=d.n()).done;){if("break"===m())break}}catch(Q){d.e(Q)}finally{d.f()}var v=i.pattr.getNestedParameters().find(function(e){return e.id===u});v&&(l=v);for(var g=0,y=[].concat(Object(r.a)(i.zObjects),Object(r.a)(i.zMessages));g<y.length;g++){var k=y[g].getAllParameters().find(function(e){return u===e.id});if(k){l=k;break}}if(!l){var O,j=b(i.lfos);try{for(j.s();!(O=j.n()).done;){var w=O.value,E=(w=w.lfo).parameters.find(function(e){return u===e.id});if(E){l=E;break}}}catch(Q){j.e(Q)}finally{j.f()}if(!l){var S,P=b(i.tracks);try{for(P.s();!(S=P.n()).done;){var x=S.value;if(x.lfosTrack){var T,C=b(x.lfosTrack.lfos);try{for(C.s();!(T=C.n()).done;){var N=T.value,R=(N=N.lfo).parameters.find(function(e){return u===e.id});if(R){l=R;break}}}catch(Q){C.e(Q)}finally{C.f()}}}}catch(Q){P.e(Q)}finally{P.f()}}}if(!l){var M,A=b(t.track.sequencerEngine.subSequences);try{for(A.s();!(M=A.n()).done;){var q=M.value,D=[].concat(Object(r.a)(q.midiEffects.shadowEffects),Object(r.a)(q.midiEffects.effects),[q.playhead]),I=[].concat(Object(r.a)(D.flatMap(function(e){return e.getParameters()})),[q.midiEffects.transposeParameter],Object(r.a)(q.pads.filter(function(e){return e.fxMacro}).map(function(e){return e.fxMacro.macroParameter})));if(l=I.find(function(e){return u===e.id}))break}}catch(Q){A.e(Q)}finally{A.f()}}if(!l){var _=s.sends.sends.flatMap(function(e){return e.effects}).flatMap(function(e){return e.getParameters()});l=_.find(function(e){return u===e.id})}if(!l){var F,L=b(i.envelopes);try{for(L.s();!(F=L.n()).done;){var B=F.value.parameters.find(function(e){return u===e.id});if(B){l=B;break}}}catch(Q){L.e(Q)}finally{L.f()}var z,V=b(i.tracks);try{for(V.s();!(z=V.n()).done;){var H=z.value;if(H.envelopesTrack){var U,J=b(H.envelopesTrack.envelopes);try{for(J.s();!(U=J.n()).done;){var G=U.value,W=(G=G.envelope).parameters.find(function(e){return u===e.id});if(W){l=W;break}}}catch(Q){J.e(Q)}finally{J.f()}}}}catch(Q){V.e(Q)}finally{V.f()}}if(!l){var K=s.channelMixer.masterChannel.effectsChain.effects.flatMap(function(e){return e.getParameters().flatMap(function(e){return e.depthParameter?[e,e.depthParameter]:e})}).find(function(e){return u===e.id});K&&(l=K)}if(!l&&!n&&"object"===typeof e&&(l=Object(p.a)(e,t.track,t.track.sequencerEngine))){a[u]=l;var X=e.coordinates;X.x,X.y}if(l&&l.name.includes("Phase"))return"continue";l?t.setParameter(l):c.push(e)};for(u.s();!(o=u.n()).done;)l()}catch(f){u.e(f)}finally{u.f()}return this.sortParameters(),{lostParameters:c,newMappings:a}}},{key:"sortParameters",value:function(){var e=this;if(this.parametersJson){var t=this.parametersJson.map(function(t,n){var r=t.id;return e._parameters.find(function(e){return e&&e.id===r})}).filter(function(e){return e});this._parameters=t}}},{key:"loadDepthJson",value:function(e,t){if(e.depthParameters){var n,r=0,a=b(e.depthParameters);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=this.newDepthParameter();o.fromJson(i,this.track.sequencerEngine,t),this.depthParameters[r++]=o}}catch(s){a.e(s)}finally{a.f()}}}},{key:"getMappableJson",value:function(e){return{parameters:this._parameters.map(function(t){return{id:t.id,context:e?t.context&&t.context.getJson():void 0,name:e?t.name:void 0,coordinates:t.getCoordinates()}}),depthParameters:this.depthParameters.map(function(e){return e.getJson()})}}},{key:"getJson",value:function(e){return Object(a.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this,e),this.getMappableJson(e))}},{key:"fromJson",value:function(e,t){delete e.depth,this.parametersJson=e.parameters;var r=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t);return this.lostParameters=this.loadParameters(e.parameters,!0).lostParameters,this.loadDepthJson(e,t),r}},{key:"randomlyMapParameters",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,a=[],i=b(arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(m.c)(e,this));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(o.context&&o.context.formant)if(!o.context.formant.enabledParameter.get())continue;a.push(o)}}catch(s){i.e(s)}finally{i.f()}return Object(d.a)(a),(a=(a=Array.from(new Set(a))).slice(0,r)).forEach(function(e){return n.setParameter(e)}),a}},{key:"dispose",value:function(){for(;this._parameters.length>0;)this.unmapParameter(0);Object(s.a)(Object(l.a)(n.prototype),"dispose",this)&&Object(s.a)(Object(l.a)(n.prototype),"dispose",this).call(this)}},{key:"replaceParameter",value:function(e){for(var t in this._parameters)if(this._parameters[t].id===e.id)return void(this._parameters[t]=e)}},{key:"shouldOutputSkip",value:function(e,t){return 0===t&&this.resetAtZero?(this.stop(),this.clear(),!0):0===this.triggers.length}}]),n}(e)}},function(e,t,n){"use strict";var r=n(8),a=n(9),i=n(2),o=n(4),s=n(16),c=n(7),u=n(10),l=n(1),f=n(104),h=n(314),p=n(23),d=n(57),m=n(432);function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}t.a=function(e){return function(e){Object(c.a)(n,e);var t=g(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).effects=[],e.adjacencyLists={},e.inputNode={id:-1,x:0,y:200},e.outputNode={id:-2,x:600,y:200},e}return Object(o.a)(n,[{key:"nodes",get:function(){return this.effects}},{key:"getSubDevices",value:function(){return this.effects.map(function(e){return{value:e,label:e.name}})}},{key:"getSubDeviceIndex",value:function(e){return this.effects.indexOf(e)}},{key:"getSubDevice",value:function(e){return this.effects[e]}},{key:"getParameters",value:function(){if(!this.parameters)return[];var e=Object(a.a)(this.parameters);for(var t in this.effects)e=[].concat(Object(a.a)(e),Object(a.a)(this.effects[t].getParameters()));return e}},{key:"lfoAdjacencyLists",get:function(){return this.getModAdjacencyLists(f.b)}},{key:"envelopeAdjacencyLists",get:function(){return this.getModAdjacencyLists(f.a)}},{key:"getModAdjacencyLists",value:function(e){var t=this,n=[].concat(Object(a.a)(this.sequencerEngine.lfos.map(function(e){return e.lfo})),Object(a.a)(this.sequencerEngine.envelopes)).filter(function(t){return t.getType()===e}),r={},i=function(a){var i=n[a],o=t.getParameters().filter(function(e){return e.lfos&&e.envelopes}).filter(function(t){return e===f.b?t.lfos.indexOf(i)>-1:t.envelopes.indexOf(i)>-1});if(0===o.length)return"continue";r[i.number]=o};for(var o in n)i(o);return r}},{key:"registerContext",value:function(e){var t=this;Object(s.a)(Object(l.a)(n.prototype),"registerContext",this).call(this,e),this.effects.forEach(function(n){return n.registerContext(e,t)})}},{key:"modulators",get:function(){return[].concat(Object(a.a)(this.sequencerEngine.lfos.map(function(e){return e.lfo})),Object(a.a)(this.sequencerEngine.envelopes))}},{key:"setSize",value:function(e,t,n,r){this.inputNode.x=0,this.inputNode.y=t/2-r/2,this.outputNode.x=e-n,this.outputNode.y=t/2-r/2}},{key:"addEffect",value:function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.x||(e.x=200,e.y=200);var t=(this.context||new d.a).getCopy();t.forEffect(this),e.registerContext(t,this),this.effects=[].concat(Object(a.a)(this.effects),[e]),e.rack=this}},{key:"deleteEffect",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.adjacencyLists[e.id]||[];for(var i in Object(a.a)(r).forEach(function(e){return t.deleteEdge(e)}),delete this.adjacencyLists[e.id],this.adjacencyLists)(r=this.adjacencyLists[i].filter(function(t){return t.effect===e})).forEach(function(e){return t.deleteEdge(e)});for(var o in this.lfoAdjacencyLists)void 0!==this.lfoAdjacencyLists[o]&&(r=this.lfoAdjacencyLists[o].filter(function(t){return e.parameters.indexOf(t)>-1})).forEach(function(e){return t.deleteEdge(e)});for(var s in this.envelopeAdjacencyLists)void 0!==this.envelopeAdjacencyLists[s]&&(r=this.envelopeAdjacencyLists[s].filter(function(t){return e.parameters.indexOf(t)>-1})).forEach(function(e){return t.deleteEdge(e)});n&&e.dispose(),this.effects.splice(this.effects.indexOf(e),1)}},{key:"deleteEdge",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.macro){var n=e.parameter;e.macro.unmapParameter(n,!1)}else if(e.modulator){var r=e.edge,a=e.modulator;a.getType()===f.b?r.disconnectFromLFO(a):r.disconnectFromEnvelope(a)}else for(var i in this.adjacencyLists){var o=this.adjacencyLists[i],s=o.indexOf(e);s>-1&&o.splice(s,1)}e.dispose&&t&&e.dispose()}},{key:"getLFO",value:function(e){return this.modulators.filter(function(e){return e.getType()===f.b}).find(function(t){return t.number===e})}},{key:"getEnvelope",value:function(e){return this.modulators.filter(function(e){return e.getType()===f.a}).find(function(t){return t.number===e})}},{key:"connectEdge",value:function(e,t){var n=void 0;return t.fromNode=e,n=e.effectNode||e.track?e.id:-1,void 0===this.adjacencyLists[n]&&(this.adjacencyLists[n]=[]),this.adjacencyLists[n].push(t),t}},{key:"connectNodes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.inputNode,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.outputNode,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this.isMacro(e))this.connectNodeToMacro(t,e);else if(e.getType)t.isAudioParamEnabled&&!t.isAudioParamEnabled()&&t.enableAudioParam(),e.getType()===f.b&&t.connectToLFO?t.connectToLFO(e):t.connectToEnvelope&&t.connectToEnvelope(e);else if(!t.isAudioParamEnabled){if(this.adjacencyLists[e.id]&&this.adjacencyLists[e.id].some(function(e){return e.effect===t}))return;var r=this.newEdge(t,n);return this.connectEdge(e,r),r}}},{key:"newEdge",value:function(e,t){return new m.a(e,this.sequencerEngine,t)}},{key:"getRackJson",value:function(){var e=this,t={},a=function(n){var r=e.adjacencyLists[n].map(function(t){return t.getJson(e)});if(-1===parseInt(n))t[n]=r;else{var a=e.effects.find(function(e){return e.id===n});t[e.effects.indexOf(a)]=r}};for(var i in this.adjacencyLists)a(i);this.saveCurrentConfiguration();var o=Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this),o,{configurations:this.getConfigurationJson(),outputPosition:{x:this.outputNode.x,y:this.outputNode.y},currentConfiguration:this.currentConfiguration,macros:this.macros.map(function(e){return e.getJson()}),adjacencyLists:t,effects:this.effects.map(function(e){return Object(r.a)({},e.getJson(),{_x:e.x,_y:e.y})})});return o=Object(p.b)(o,"configurationParameter",this.configurationParameter)}},{key:"fromRackJson",value:function(e,t){this.loaded=!1,e.outputPosition&&(this.outputNode.x=e.outputPosition.x,this.outputNode.y=e.outputPosition.y),e.configurations&&this.loadConfigurationJson(e.configurations);var n=e.adjacencyLists;for(var r in n){var a=this.effects[r];for(var i in a||(a=this.inputNode),n[r]){var o=this.newEdge(void 0);o.fromJson(n[r][i],this),this.connectEdge(a,o)}}if(void 0!==e.currentConfiguration&&(this.currentConfiguration=e.currentConfiguration),this.loadParameterFromJson(e,"configurationParameter",this.configurationParameter,t),e.macros){var s=this.getParameters();for(var c in e.macros){var u=this.context||new d.a;this.newMacro(u.getCopy().forEffect(this)).fromJson(e.macros[c],s)}}this.loaded=!0}},{key:"pasteNodes",value:function(e){var t,n=e.map(function(e){return e.getEffectCopy()}),r=v(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;this.addEffect(a);var i=Object(h.a)(e[0].x,e[0].y,this),o=i.x,s=i.y;a.x=o,a.y=s}}catch(b){r.e(b)}finally{r.f()}for(var c in e){var u=this.adjacencyLists[e[c].id];if(u){var l,f=n[c],p=v(u);try{for(p.s();!(l=p.n()).done;){var d=l.value,m=e.indexOf(d.effect);m>-1?this.connectNodes(f,n[m]):this.connectNodes(f,d.effect)}}catch(b){p.e(b)}finally{p.f()}}}}},{key:"connectNodesInSeries",value:function(e){e.sort(function(e,t){return e.x-t.x});var t,n=void 0,r=v(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n&&this.connectNodes(n,a),n=a}}catch(i){r.e(i)}finally{r.f()}}},{key:"clearRack",value:function(){var e=this;this.effects.forEach(function(t){return e.deleteEffect(t,!1)})}}]),n}(e)}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(81);function a(e,t,n){for(var a=0;i(e,t,n)&&a<40;)(e+=r.g)>=r.i-r.g&&(e=r.g,(t=t+r.e+20)>=r.a-r.e&&(t=r.e+40)),a++;return{x:e,y:t}}function i(e,t,n){for(var a in n.effects){var i=n.effects[a],o=i.x,s=i.y;if(e>=o&&t>=s&&e<=o+r.g&&t<=s+r.e)return!0}return!1}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(322);function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}t.a=function(e){return function(e){Object(i.a)(n,e);var t=u(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).macros=[],e}return Object(a.a)(n,[{key:"connectNodeToMacro",value:function(e,t){e&&e.isParameter&&t.addParameter(e)}},{key:"isMacro",value:function(e){return this.macros.indexOf(e)>-1}},{key:"deleteMacro",value:function(e){var t=this.macros.indexOf(e);this.macros.splice(t,1),e.dispose()}},{key:"newMacro",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.context,t="Macro "+(this.macros.length+1),n=new c.a(t,this.sequencerEngine,e);return this.macros.push(n),n}},{key:"macroAdjacencyLists",get:function(){var e={};for(var t in this.macros){var n=this.macros[t],r=n.subMacros;e[n.id]=r}return e}}]),n}(e)}},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(32),l=n(23);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}t.a=function(e){return function(e){Object(o.a)(n,e);var t=f(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).parameters=[],e}return Object(i.a)(n,[{key:"registerParameter",value:function(e){this.store&&e.setStore(this.store),this.parameters.push(e)}},{key:"getParameters",value:function(){return this.parameters.filter(function(e){return e})}},{key:"getJson",value:function(){var e={name:this.name,id:this.id,x:this.x,y:this.y};for(var t in this.parameters){var n=this.parameters[t];if(n){e[n.name]=n.get();var r=n.name+"Parameter";e=Object(l.b)(e,r,n,this.sequencerEngine)}}return e}},{key:"fromJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];void 0===e.id||t||(this.id=e.id),void 0!==e.x&&(this.x=e.x,this.y=e.y);var n={};for(var a in this.parameters){var i=this.parameters[a];if(i){var o=e[i.name];void 0!==o&&null!==o&&Object(u.a)(i,o,n),n=Object(r.a)({},n,Object(l.a)(e,i.name+"Parameter",i,this.sequencerEngine,t))}}return n}}]),n}(e)}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(15),a=n.n(r);function i(e){return new a.a.Time(e).toMilliseconds()-new a.a.Time(a.a.Master.context.currentTime).toMilliseconds()}},function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return m});var r=n(5),a=n.n(r),i=n(14),o=n(36),s=n(70),c=n(40),u=n(714),l=n(31),f=n(44),h=n(47),p=n(65),d=function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,c,u=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]?u[2]:0,i=t.name,e.t0=p.c,e.next=5,h.a.addJson(t);case 5:e.t1=e.sent,c=(0,e.t0)(e.t1),new s.a(f.c,"newEffect",[c,o.a.utils.fromAscii(i),n,r]).execute();case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new c.a((new u.a).contractAddress).from(l.o).select("title").select("ipfsHash").select("effectType").select("user"),t&&n.where("effectType",t),e.next=4,n.executeQuery();case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=n(6);t.a=Object(i.b)(function(e,t){return{}},function(e){return{setPullablePartDragging:function(t){return e(Object(o.ve)(t))}}})(function(e){var t=Object(r.useCallback)(function(t){var n=e.effect,r=e.instrument,a={instrument:r,effect:n,id:e.id||(r||n).id,type:e.type};r&&r.track?a.track=r.track:n&&(a.track=n.track),e.setPullablePartDragging(a)},[]);return a.a.createElement("div",Object.assign({onMouseDown:function(t){e.isDraggable&&t.stopPropagation()},draggable:e.isDraggable?"true":"false",onDragStart:t,onDragOver:function(e){e.preventDefault()},className:e.className},e),e.skipDiv?e.children:a.a.createElement("div",null,e.children))})},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(9),s=n(2),c=n(4),u=n(387),l=(n(92),n(644)),f=n(6),h=n(45),p=n(15),d=n.n(p),m=n(131);n(62);function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=function(){function e(t,n,r){Object(s.a)(this,e),this.id=Object(h.uuid)(),this._sequencerEngine=r,this.parameter=t,this.automations=[],this.nextCache={},this.previousCache={},this.getValueCache={},this.distanceCache={},this.isMix=n,this.eventIds=[],this.counter=0,this.stepToValues={}}return Object(c.a)(e,[{key:"length",get:function(){return this.automations.length}},{key:"sequencerEngine",get:function(){return this._sequencerEngine||this.parameter.sequencerEngine}},{key:"getPoint",value:function(e){return this.automations.find(function(t){return t.id===e.id})}},{key:"getSelectedPoints",value:function(e,t,n,r){return this.automations.filter(function(a){var i=a.step,o=a.value;return e<=i&&t<=o&&n>=i&&r>=o})}},{key:"getClosestBefore",value:function(e){var t=void 0;for(var n in this.automations){var r=this.automations[n];if(r.step>e)return t;t=r}return t}},{key:"getDistanceToClosest",value:function(e){var t=void 0;if(e.step in this.distanceCache)return this.distanceCache[e.step];var n=void 0;for(var r in this.automations){var a=this.automations[r],i=Math.abs(a.step-e.step);(void 0===t||i<t)&&(t=i,n=a)}return this.distanceCache[e.step]={distance:t,point:n},this.distanceCache[e.step]}},{key:"quantizePoint",value:function(e){if(void 0!==(e=this.getPoint(e))){var t;for(var n in e.step=(t=e.step,Math.round(2*t)/2),e.value=function(e,t){if(void 0===t)return t;if(e.quantize)return e.quantize(t);var n=e.min,r=e.max,a=(r-n)/80,i=e.config.defaultValue;if(Math.abs(i-t)<a/8)return i;if(r<20)return Math.round(10*t)/10;var o=t%a;return o>a/2?t+a-o:t-o}(this.parameter,e.value),this.automations)this.automations[n]===e&&(this.automations[n]=e.getCopy());this.automations=Object(o.a)(this.automations),this.updateRedux()}}},{key:"movePoints",value:function(e,t,n){for(var r in e){var a=e[r],i=a.step,o=a.value;i+=t,o+=n,this.movePoint(a,i,o,!1)}this.schedule(),this.updateRedux(),this.clearCache()}},{key:"movePoint",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(void 0!==e){e=this.getPoint(e);var a=this.getNextEvent(e),i=this.getPreviousEvent(e);for(var o in(void 0===a||t<a.step)&&(void 0===i||t>i.step)?(e.step=t,e.value=Math.min(Math.max(n,this.parameter.min),this.parameter.max)):e.value=Math.min(Math.max(n,this.parameter.min),this.parameter.max),this.automations)if(this.automations[o]===e){this.automations[o]=e.getCopy();break}r&&(this.schedule(),this.updateRedux(),this.clearCache())}}},{key:"updateRedux",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.length>0&&void 0!==n[0]&&n[0],n.length>1&&void 0!==n[1]&&n[1],this.store&&(t||this.automations.length>0)&&(this.isMix?this.store.dispatch(Object(f.Rd)(this.parameter,Object(o.a)(this.automations),this)):this.store.dispatch(Object(f.Nd)(this.parameter,Object(o.a)(this.automations),this)));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"hasEventsAfterStep",value:function(e){var t=this.automations[this.automations.length-1];return t&&t.step>e}},{key:"getNextEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.automations;if(e.id in this.nextCache)return this.nextCache[e.id];for(var n=0;n<t.length;n++)if(e.id===t[n].id)return this.nextCache[e.id]=t[n+1],t[n+1];return this.nextCache[e.id]=t[0],t[0]}},{key:"getPreviousEvent",value:function(e){var t=void 0;if(e.id in this.previousCache)return this.previousCache[e.id];for(var n=0;n<this.automations.length-1;n++){if(this.automations[n]===e)return t;t=this.automations[n]}this.previousCache[e.id]=void 0}},{key:"getValueAtStep",value:function(e){this.parameter.track&&!this.isMix&&(e%=(this.parameter.track.instrumentRack?this.parameter.track.instrumentRack:this.parameter.track).length);return e in this.getValueCache?this.getValueCache[e]:(this.getValueCache[e]=Object(l.b)(e,this.parameter,this.automations),this.getValueCache[e])}},{key:"removeBreakPoints",value:function(e){var t,n=v(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.removeBreakPoint(r,!1)}}catch(a){n.e(a)}finally{n.f()}this.updateRedux(!0)}},{key:"removeAtStep",value:function(e){this.parameter.track&&!this.isMix&&(e%=(this.parameter.track.instrumentRack?this.parameter.track.instrumentRack:this.parameter.track).length);var t,n=(new Date).getTime(),r=[],a=this.isMix?1200:300,i=v(this.automations);try{for(i.s();!(t=i.n()).done;){var o=t.value;Math.floor(o.step)===e&&(void 0===o.addedAt||n-o.addedAt>a)||r.push(o)}}catch(s){i.e(s)}finally{i.f()}this.automations=r}},{key:"removeBreakPoint",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0!==e){e=this.getPoint(e);var n=this.automations.indexOf(e);n>-1&&this.automations.splice(n,1),this.clearCache(),t&&this.updateRedux(!0)}}},{key:"clearCache",value:function(){this.cache={},this.getValueCache={},this.nextCache={},this.distanceCache={},this.previousCache={}}},{key:"record",value:function(e,t){if(this.sequencerEngine&&this.parameter.context&&this.parameter.context.track){var n=this.sequencerEngine.lastTrackStep;if(this.parameter.track&&!this.isMix)n%=(this.parameter.track.instrumentRack?this.parameter.track.instrumentRack:this.parameter.track).length;var r=n;if(this.parameter.audioParam||this.parameter.audioParams){var a=n===this.lastStep?this.lastTime:new d.a.Time(this.sequencerEngine.currentStepTime).toMilliseconds();this.lastStep=n,this.lastTime=a;new d.a.Time(d.a.Master.context.currentTime).toMilliseconds(),new d.a.Time("32n").toMilliseconds()}var i=[];0===this.automations.length&&this.isMix&&this.parameter.config.exactAutomation&&i.push(this.addBreakPoint(0,t,void 0,!0,!0)),this.isMix&&!this.parameter.config.exactAutomation&&this.lastEvent&&Math.abs(r-this.lastEvent.step)>4&&i.push(this.addBreakPoint(r-1,t,void 0,!0,!0)),i.push(this.addBreakPoint(r,e,void 0,!0,!0));var o=Math.floor(r);return this.stepToValues[o]||(this.stepToValues[o]=[]),this.stepToValues[o].push(e),i}}},{key:"lastEvent",get:function(){return this.automations[this.automations.length-1]}},{key:"addBreakPoint",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(h.uuid)(),r=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4]);e<0&&(e=0),this.clearCache(),this.parameter.audioParam&&this.parameter.automationRate!==m.a&&(this.parameter.automationRate=m.a);var a=new u.a(e,t);return a.id=n,this.sequencerEngine&&(a.addedAt=(new Date).getTime()),this.automations.push(a),this.automations.sort(function(e,t){return e.step-t.step}),this.schedule(),this.updateRedux(void 0,r),a}},{key:"isRecording",get:function(){return this.store&&this.store.getState().sequencer.isRecording}},{key:"isSliderDown",get:function(){if(!this.store)return!1;var e=this.store.getState().automation.parameterSliderDown;return Array.isArray(e)?e.indexOf(this.parameter)>-1:e===this.parameter}},{key:"clear",value:function(){this.eventIds&&(this.eventIds.forEach(function(e){return d.a.Transport.clear(e)}),this.eventIds=[])}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lastStartTime,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastTimeToSchedule,r=(arguments.length>2&&arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001);if((void 0!==this.parameter.audioParams||void 0!==this.parameter.audioParam)&&(this.clear(),void 0!==t)){this.lastStartTime=t,this.lastTimeToSchedule=n;var a=this.automations;if(a.length>0){var i=a[0].getCopy();i.step=0,i.id=Object(h.uuid)(),a=[i].concat(Object(o.a)(a))}this.getValueAtStep(this.sequencerEngine.trackStep);this.eventIds=a.map(function(i){return d.a.Transport.schedule(function(t){if(!e.isSliderDown)try{if(e.parameter.audioParam||e.parameter.audioParams){var n=d.a.Master.context.isOffline?d.a.Master.context._currentTime:d.a.Master.context.currentTime,o=e.getNextEvent(i,a);if(!o)return;var s=o.value;if("function"===typeof s&&(s=s()),s.toFrequency&&(s=s.toFrequency()),o){var c=new d.a.Time("32n")*(o.step-i.step)-.01;c=Math.max(c,.001),e.parameter.audioParams?e.parameter.audioParams.forEach(function(e){return e.rampTo(s,c,t+.001)}):e.parameter.audioParam&&(e.parameter.audioParam._param&&e.parameter.audioParam.rampTo?e.parameter.audioParam.rampTo(s,c+r,t+r):e.parameter.audioParam.linearRampToValueAtTime(s||1e-5,n+c-.001))}}}catch(u){console.log("error while doing automation for parameter=",u,e.parameter)}},function(e,t,n){var r=d.a.Transport.getTicksAtTime(n),a=new d.a.Time("32n");return new d.a.TransportTime(r+e*a.toTicks(),"i")}(e.isMix?i.step-t:i.step,0,n))})}}},{key:"start",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.001,r=this.getValueAtStep(this.sequencerEngine.trackStep);(this.isMix||t)&&("function"===typeof r&&(r=r()),this.setParameterValue(r,e,n))}},{key:"setParameterValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.001;this.parameter.audioParams?this.parameter.audioParams.forEach(function(r){return r.rampTo(e,n,t)}):this.parameter.audioParam&&(this.parameter.audioParam._param&&this.parameter.audioParam.rampTo?this.parameter.audioParam.rampTo(e,n,t):this.parameter.audioParam.linearRampToValueAtTime(e||1e-5,d.a.Master.context.currentTime+.01))}},{key:"getJson",value:function(){return{id:this.id,automations:this.automations.map(function(e){return e.getJson()})}}},{key:"fromJson",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return this;var r=e.id,a=e.automations;if(n||(this.id=r),void 0===a||0===a.length)return this;for(var i in a){var o=a[i],s=o.step,c=o.value,l=o.id,f=(new u.a).fromJson(a[i]);void 0!==l&&(f.id=l);var h=Math.floor(s);this.stepToValues[h]||(this.stepToValues[h]=[]),this.stepToValues[h].push(c),this.automations.push(f)}return t&&this.schedule(),this.updateRedux(),this}},{key:"getCopy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.store,n=new e(this.parameter);return n.fromJson(this.getJson(),!1,!0),n.store=t,n}},{key:"dispose",value:function(){this.clear(),this.automations=[],this.eventIds=[]}},{key:"deleteAutomations",value:function(){this.clear(),this.automations=[],this.stepToValues={},this.updateRedux(!0)}},{key:"smoothen",value:function(){var e,t=.03*(this.parameter.max-this.parameter.min),n=[],r=void 0,a=[],i=v(this.automations);try{for(i.s();!(e=i.n()).done;){var o=e.value;if(r){var s=(o.value-r.value)/(o.step-r.step);if(n.length>0){var c=Math.abs(s-y(n));Math.abs(o.step-r.step)>16||c>t&&Math.floor(o.step)!==Math.floor(r.step)?a.push(o):a[a.length-1]=o}else a.push(o);n.push(s)}else a.push(o);r=o}}catch(u){i.e(u)}finally{i.f()}this.automations=a,this.updateRedux()}}]),e}(),y=function(e){return e[e.length-1]};t.a=g},function(e,t,n){"use strict";var r=n(9),a=n(8),i=n(2),o=n(4),s=n(7),c=n(10),u=n(1),l=n(432),f=n(21);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}t.a=function(e){return function(e){Object(s.a)(n,e);var t=h(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).configurations=[],e}return Object(o.a)(n,[{key:"currentConfiguration",get:function(){return this.configurationParameter.get()},set:function(e){this.configurationParameter.set(e)}},{key:"initializeConfigurations",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.loaded=!0,this.oldConfiguration=0,this.configurations=[],this.configurations[0]=e,n&&(this.configurationParameter=new f.a("Configuration",this,function(e,n){t.switchToConfiguration(n)},{documentation:"",defaultValue:0,uxAutomatable:!1}),this.registerParameter(this.configurationParameter))}},{key:"saveCurrentConfiguration",value:function(){var e=void 0===this.currentConfiguration?1:this.currentConfiguration;return this.configurations[e]=Object(a.a)({},this.adjacencyLists),e}},{key:"newConfiguration",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.currentConfiguration,r=e?this.copyAdjacencyLists(this.adjacencyLists):{};return this.configurations.push(r),this.currentConfiguration=this.configurations.length-1,t&&(this.adjacencyLists=r),n}},{key:"switchToConfiguration",value:function(e){if(void 0!==this.configurationParameter&&this.oldConfiguration!==e){this.clearConfiguration(this.oldConfiguration);var t=this.configurations[e];this.loadConfig(t),this.oldConfiguration=this.currentConfiguration}}},{key:"configNames",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.adjacencyLists,n={},r=0,a=function(a){var i=e.effects.find(function(e){return e.id===a});n[i.name+"-"+r]=t[a],r++};for(var i in t)a(i);return n}},{key:"loadConfig",value:function(e){var t=this;this.adjacencyLists={};var n=function(n){for(var r in e[n]){var a=-1===parseInt(n)?t.inputNode:t.effects.find(function(e){return e.id===n}),i=e[n][r];void 0!==a&&t.connectEdge(a,i)}};for(var r in e)n(r)}},{key:"clearConfiguration",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.oldConfiguration,n=this.copyAdjacencyLists(this.adjacencyLists,!0),a=function(t){e.effects.find(function(e){return e.id===t});Object(r.a)(e.adjacencyLists[t]).forEach(function(t){e.deleteEdge(t)})};for(var i in this.adjacencyLists)a(i);this.loaded&&(this.configurations[t]=n)}},{key:"copyAdjacencyLists",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.adjacencyLists,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};for(var a in e)n[a]=t?Object(r.a)(e[a]):e[a].map(function(e){return e.getCopy()});return n}},{key:"getConfigurationJson",value:function(){var e=this,t=[];for(var n in this.configurations){var r=this.configurations[n],a={};for(var i in r)a[i]=r[i].map(function(t){return t.getJson(e)});t.push(a)}return t}},{key:"loadConfigurationJson",value:function(e){var t=[];for(var n in e){var r=e[n],a={};for(var i in r){var o=[];for(var s in r[i]){var c=new l.a(void 0,this.sequencerEngine);c.fromJson(r[i][s],this),o.push(c)}a[i]=o}t.push(a)}this.configurations=t}}]),n}(e)}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=(n(21),n(775)),o=n(6),s=n(57),c=n(23),u=n(41),l=n(131),f=n(15),h=n.n(f),p=n(45),d=function(){function e(t,n,a){var i=this,c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Object(r.a)(this,e),this.id=Object(p.uuid)(),this.context=a?a.getCopy().forMacro(this):(new s.a).forMacro(this),this.sequencerEngine=n,this.name=t,this.subMacros=[],this.x=100,this.y=110,this.signal=new h.a.Signal(0),this.macroParameter=new u.a("macro",this.signal,function(e,t){i.signal.value=t;var n={};for(var r in i.subMacros){var a=i.subMacros[r],s=a.updateRedux(t,c);n[a.parameter.id]=s.value}i.sequencerEngine.store.dispatch(Object(o.Vb)(n))},{min:0,max:1,defaultValue:f,automationRate:l.a}),this.macroParameter.enableAudioParam(),this.parameters=[],this.registerParameter(this.macroParameter)}return Object(a.a)(e,[{key:"registerParameter",value:function(e){void 0!==e&&(e.name=e.name,e.setStore(this.sequencerEngine.store),e.setContext(this.context),this.parameters.push(e))}},{key:"addParameter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.min,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.max,r=new i.a(e,t,n,this);(e.audioParam||e.audioParams)&&this.signal.connect(r.scaler),this.subMacros.push(r),this.macroParameter.set(this.macroParameter.get(!0)),e.hasMacro=this}},{key:"unmapAllParameters",value:function(){var e=this;this.subMacros.map(function(e){return e.parameter}).forEach(function(t){return e.unmapParameter(t)})}},{key:"ripMods",value:function(){this.macroParameter.disconnectFromAllModulators()}},{key:"isParameterMapped",value:function(e){return this.subMacros.some(function(t){return t.parameter===e})}},{key:"normalizeParameterValue",value:function(e,t){return this.subMacros.find(function(t){return t.parameter===e}).normalizeValue(t)}},{key:"unmapParameter",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.subMacros.find(function(t){return t.parameter===e});if(void 0!==n){e.hasMacro=void 0,(n.parameter.audioParam||n.parameter.audioParams)&&this.signal.disconnect(n.scaler);var r=this.subMacros.indexOf(n);t&&n.dispose(),this.subMacros.splice(r,1),e.set(e.get(),!0,!0)}}},{key:"dispose",value:function(){this.unmapAllParameters(),this.subMacros=void 0,this.macroParameter.dispose(),this.signal=void 0,this.macroParameter=void 0}},{key:"getJson",value:function(){var e={id:this.id,x:this.x,y:this.y,name:this.name,subMacros:this.subMacros.map(function(e){return e.getJson()}),macroValue:this.macroParameter.get(!0)};return e=Object(c.b)(e,"macroParameter",this.macroParameter,!0)}},{key:"getParameters",value:function(){return this.parameters}},{key:"fromJson",value:function(e,t){var n=this;e.id&&(this.id=e.id),this.name=e.name,this.x=e.x,this.y=e.y;var r=function(r){var a=e.subMacros[r],i=a.parameter,o=a.min,s=a.max;if(void 0===(i=t.find(function(e){return e.id===i})))return"continue";n.addParameter(i,o,s)};for(var a in e.subMacros)r(a);this.macroParameter.set(e.macroValue),Object(c.a)(e,"macroParameter",this.macroParameter,this.sequencerEngine)}}]),e}();t.a=d},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:256,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10;r=Math.log(r);var i=((a=Math.log(a))-r)/(n-t);return Math.exp(r+i*(e-t))}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(7),l=n(10),f=n(1),h=n(15),p=n.n(h),d=n(43),m=n(198),v=(n(501),n(363),n(424),n(364),n(601),n(502),n(603),n(604),n(433)),b=n(16);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var y=function(e){Object(u.a)(n,e);var t=g(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e)).sequencerEngine=r,i.subSequence=a,i}return Object(c.a)(n,[{key:"getMixType",value:function(){return d.f}},{key:"getValueAtStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.getNextEvent({step:e},!0),r=this.getPreviousEvent({step:e},!1,!0);if(void 0===r){if(void 0===n)return t;var a=e/n.step;return t*(1-a)+n.value*a}if(void 0===n)return r.volume;var i=(e-r.step)/(n.step-r.step);return r.volume*(1-i)+n.volume*i}},{key:"deleteEvent",value:function(e){var t=this.events.indexOf(e);t>-1&&this.events.splice(t,1),this.updateRedux(this.subSequence,this.sequencerEngine)}},{key:"loadFromJson",value:function(e,t,r){Object(b.a)(Object(f.a)(n.prototype),"loadFromJson",this).call(this,e,t,r),this.updateRedux(r,t)}}]),n}(v.a),k=n(396),O=n(238),j=n(234),w=n(33),E=n(599),S=n(434),P=n(528),x=n(445),T=n(527),C=n(251),N=n(130);function R(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var M=function(e){Object(u.a)(n,e);var t=R(n);function n(e,r,a,i){var o;return Object(s.a)(this,n),(o=t.call(this,e,r.getType())).event=r,o.difference=a,o.inPlace=i,o}return Object(c.a)(n,[{key:"execute",value:function(){this.event.duration=this.getDuration(this.event);this.events.map(function(e){return e.step});if(0!==this.differeence){for(var e=void 0,t=0;t<this.events.length;t++){var n=this.events[t];if(n.step>this.event.step){n.step+=this.difference;var r=this.events[t+1];if(r&&r.step<=n.step&&(e=t),this.inPlace)break}}void 0!==e&&this.events.splice(e,1),this.events.map(function(e){return e.step}),this.calculateDurations()}}}]),n}(N.a);function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var q=function(e){Object(u.a)(n,e);var t=A(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e,r[0].getType())).eventsToPaste=r,i.stepNumber=a,i}return Object(c.a)(n,[{key:"insertEvent",value:function(e,t){new C.a(this.mix,e,t).execute()}},{key:"execute",value:function(){var e=this.eventsToPaste[0].step;for(var t in this.eventsToPaste){var n=this.eventsToPaste[t];n.step=n.step-e+this.stepNumber,this.insertEvent(n,n.duration)}}}]),n}(N.a);function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var I=function(e){Object(u.a)(n,e);var t=D(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,void 0,d.j)).sequenceRollEvent=e,i.event=r,i.difference=a,i}return Object(c.a)(n,[{key:"events",get:function(){return this.sequenceRollEvent.events},set:function(e){this.sequenceRollEvent.events=e}},{key:"execute",value:function(){for(var e=void 0,t=0;t<this.events.length;t++){var n=this.events[t];if(n.step>this.event.step){n.step+=this.difference;var r=this.events[t+1];r&&r.step<=n.step&&(e=t),n.duration+this.difference<0&&(e=t);break}}void 0!==e&&this.sequenceRollEvent.subEvents.splice(e-1,1),this.sequenceRollEvent.calculateDurations()}}]),n}(N.a);function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var F="LEFT",L=function(e){Object(u.a)(n,e);var t=_(n);function n(e,r,a,i,o){var c;return Object(s.a)(this,n),(c=t.call(this,e,r.getType())).sequenceRollEvent=r,c.resolutionChangeEvent=a,i===F?c.newStart=o:c.difference=o,c.direction=i,c}return Object(c.a)(n,[{key:"execute",value:function(){this.direction===F?this.resizeLeftSide():this.resizeRightSide()}},{key:"resizeLeftSide",value:function(){0===this.sequenceRollEvent.getSubEvents().indexOf(this.resolutionChangeEvent)&&(this.sequenceRollEvent.step=this.newStart),this.resolutionChangeEvent.step=this.newStart,this.sequenceRollEvent.calculateDurations()}},{key:"resizeRightSide",value:function(){this.sequenceRollEvent.step,this.sequenceRollEvent.duration;var e=this.sequenceRollEvent.getSubEvents(),t=-1;for(var n in e)e[n].step===this.resolutionChangeEvent.step&&(t=parseInt(n));t===e.length-1?new M(this.mix,this.sequenceRollEvent,this.difference,!0).execute():new I(this.sequenceRollEvent,this.resolutionChangeEvent,this.difference).execute()}},{key:"getResolutionDuration",value:function(e){var t=e.step+e.duration,n=this.mix.getValuesBetweenSteps(d.k,e.step,t);for(var r in n)if(!n[r].value)return n[r].step-e.step;return e.duration}}]),n}(N.a),B=function(){function e(t,n){Object(s.a)(this,e),this.sequencerEngine=t,this.subSequence=void 0===n?d.g:n}return Object(c.a)(e,[{key:"getTimeForEventToAdd",value:function(e){if(this.sequencerEngine.playing){var t=new p.a.Time(p.a.Master.currentTime).toMilliseconds()-new p.a.Time(this.sequencerEngine.automationTime).toMilliseconds(),n=this.sequencerEngine.automationStep||0;return e.isDeterministic()||n--,{time:t,step:n}}}},{key:"seekToTrackStep",value:function(e){}},{key:"resizeEvent",value:function(e,t,n){}},{key:"deleteEvent",value:function(e,t){}},{key:"deleteCompoundEvent",value:function(e,t){}},{key:"insertEvent",value:function(e,t){}},{key:"pasteEvents",value:function(e,t){}},{key:"restart",value:function(){}},{key:"addEvent",value:function(e){}},{key:"holdEvent",value:function(e){}},{key:"scheduleNext",value:function(e,t){}},{key:"schedule",value:function(){}},{key:"getValue",value:function(e,t){}},{key:"getEvent",value:function(e,t){}}]),e}(),z=n(1095),V=n(6);n(602);function H(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var U=function(e){Object(u.a)(n,e);var t=H(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).mixesByType={},a.mixesByType[d.l]=new y(d.l,e,r),a.deterministicMixesByType={},a.deterministicMixesByType[d.j]=new k.a(d.j,new O.a(new w.a),a.subSequence),a.deterministicMixesByType[d.k]=new k.a(d.k,new j.a(!1,new w.a),a.subSequence),a.deterministicMixesByType[d.i]=new k.a(d.i,new m.a(0),a.subSequence),r&&a.updateAllTypeRedux(),a}return Object(c.a)(n,[{key:"getValue",value:function(e,t){var n=this.deterministicMixesByType[e];if(void 0!==n)return n.getValue(t,!0)}},{key:"getEvent",value:function(e,t){var n=this.deterministicMixesByType[e];if(void 0!==n)return n.getEvent(t)}},{key:"getValuesBetweenSteps",value:function(e,t,n){var r=this.deterministicMixesByType[e];if(void 0!==r)return r.getValuesBetweenSteps(t,n)}},{key:"holdEvent",value:function(e){if(e.isDeterministic()){var t=e.getType();!t in this.deterministicMixesByType&&(this.deterministicMixesByType[t]=new k.a),this.deterministicMixesByType[t].holdEvent(e)}}},{key:"dispatch",value:function(e){Object(E.a)(this,e)}},{key:"addEvent",value:function(e){var t=this.getTimeForEventToAdd(e);if(void 0!==t){e.subSequence=this.subSequence;e.cancel(),e.isDeterministic()?new T.a(this,e,t.time,t.step).execute():new S.a(this,e,t.time,t.step).execute(),setTimeout(function(){e.canceled=!1},5e3),e.isDeterministic()&&this.updateAllTypeRedux()}}},{key:"getNextEvent",value:function(e){var t=e.getType();return this.deterministicMixesByType[t].getNextEvent(e)}},{key:"getPreviousEvent",value:function(e){var t=e.getType();return this.deterministicMixesByType[t].getPreviousEvent(e)}},{key:"resizeEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];new M(this,e,t,n).execute(),this.updateAllTypeRedux()}},{key:"resizeSequenceRoll",value:function(e,t,n,r){new L(this,e,t,n,r).execute(),this.updateAllTypeRedux()}},{key:"insertEvent",value:function(e,t){new C.a(this,e,t).execute(),this.updateAllTypeRedux()}},{key:"pasteEvents",value:function(e,t){new q(this,e,t).execute(),this.updateAllTypeRedux()}},{key:"deleteEvent",value:function(e,t){new P.a(this,e,t).execute(),this.updateAllTypeRedux()}},{key:"deleteCompoundEvent",value:function(e,t){new x.a(this,e,t).execute(),this.updateAllTypeRedux()}},{key:"seekToTrackStep",value:function(e){for(var t in this.mixesByType)this.mixesByType[t].seekToTrackStep(e);for(var n in this.deterministicMixesByType)this.deterministicMixesByType[n].seekToTrackStep(e)}},{key:"restart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var t in this.mixesByType)this.mixesByType[t].restart(e);for(var n in this.deterministicMixesByType)this.deterministicMixesByType[n].restart(e)}},{key:"scheduleNext",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in r=new p.a.Time(p.a.Master.context.currentTime).toMilliseconds(),a=new p.a.Time(n).toMilliseconds()-r,this.mixesByType)this.mixesByType[o].scheduleNext(t,a,this.sequencerEngine);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"eraseEventsAtStep",value:function(e){for(var t in this.mixesByType)this.mixesByType[t].eraseEventsAtStep(e)}},{key:"schedule",value:function(){for(var e in this.mixesByType)this.mixesByType[e].schedule()}},{key:"getJson",value:function(){var e={};for(var t in this.mixesByType)e[t]=this.mixesByType[t].getJson();var n={};for(var r in this.deterministicMixesByType)n[r]=this.deterministicMixesByType[r].getJson();return{name:this.name,mixesByType:e,deterministicMixesByType:n}}},{key:"getCopy",value:function(){var e=new n(this.name);return e.mixesByType=this.mixesByType,e.deterministicMixesByType=this.deterministicMixesByType,e}},{key:"getFirstEvent",value:function(e){return this.deterministicMixesByType[e].defaultValue}},{key:"loadFromJson",value:function(e,t){if(void 0!==e){for(var n in t=this.sequencerEngine,e.mixesByType)this.mixesByType[n]=new y(parseInt(n),t,this.subSequence),this.mixesByType[n].loadFromJson(e.mixesByType[n],t,this.subSequence);for(var r in e.deterministicMixesByType){var a=void 0;(r=parseInt(r))===d.i?a=new m.a(0):r===d.k?a=new j.a(!1,new w.a):r===d.j&&(a=new O.a(new w.a)),this.deterministicMixesByType[r]=new k.a(parseInt(r),a),this.deterministicMixesByType[r].loadFromJson(e.deterministicMixesByType[r],t)}this.updateAllTypeRedux()}}},{key:"updateTypeRedux",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V.md,n=this.deterministicMixesByType[e],r=[],a=this.getFirstEvent(e);a.subSequence=this.subSequence,a.step=0;for(var i=0;i<n.events.length;i++)a.subSequence=this.subSequence,a.duration=n.events[i].step-a.step,r.push(a),a=n.events[i];var o=n.events[n.events.length-1]||a;o&&(o.duration=void 0,o.subSequence=this.subSequence,r.push(o)),this.sequencerEngine.store.dispatch(t(this.subSequence.id,e,r))}},{key:"updateAllTypeRedux",value:function(){for(var e in this.mixesByType)this.mixesByType[e].updateRedux(this.subSequence,this.sequencerEngine);this.updateTypeRedux(d.i,V.md),this.updateTypeRedux(d.k,V.md),this.sequencerEngine.dispatch(Object(V.Lg)(Object(z.a)(this.sequencerEngine)))}},{key:"clear",value:function(){for(var e in this.deterministicMixesByType)this.deterministicMixesByType[e].clear();for(var t in this.mixesByType)this.mixesByType[t].clear();this.updateAllTypeRedux()}},{key:"length",get:function(){var e=[];for(var t in this.deterministicMixesByType){var n=this.deterministicMixesByType[t];e=[].concat(Object(r.a)(e),Object(r.a)(n.events.map(function(e){return e.step})))}for(var a in this.mixesByType){var i=this.mixesByType[a];e=[].concat(Object(r.a)(e),Object(r.a)(i.events.map(function(e){return e.step})))}var o=Math.max.apply(Math,Object(r.a)(e.filter(function(e){return void 0!==e&&!isNaN(e)})));return o===-1/0?0:o}},{key:"prune",value:function(e){e in this.deterministicMixesByType&&this.deterministicMixesByType[e].prune(),e in this.mixesByType&&this.deterministicMixesByType[e].prune()}}]),n}(B);t.a=U},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(56),h=n(32),p=n(15),d=n.n(p),m=n(21);n(41),n(212);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}new Float32Array(65536);var b=function(e){Object(c.a)(n,e);var t=v(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Diode",function(){return new d.a.WaveShaper([-1,1])},e)).vb=.2,r.vl=.4,r.distortionParameter=new m.a("distortion",Object(o.a)(r),function(e,t){r.recomputeCurve()},{documention:"Controls the level of saturation.",min:2,max:10,unit:"",defaultValue:.1,constantAutomationRate:!0}),r.registerParameter(r.distortionParameter),r}return Object(i.a)(n,[{key:"distortion",get:function(){return this.distortionParameter?this.distortionParameter.get():1}},{key:"recomputeCurve",value:function(){for(var e=new Float32Array(1024),t=0;t<1024;t++){var n=(t-512)/512,r=0;r=(n=Math.abs(n))<=this.vb?0:this.vb<n&&n<=this.vl?this.distortion*(Math.pow(n-this.vb,2)/(2*this.vl-2*this.vb)):this.distortion*n-this.distortion*this.vl+this.distortion*(Math.pow(this.vl-this.vb,2)/(2*this.vl-2*this.vb)),e[t]=r}this.effectNode.curve=e}},{key:"documentation",get:function(){return"Saturates the sound, making it more distorted."}},{key:"getJson",value:function(){var e=Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{distortionParameter:this.distortionParameter.get()});return e=this.saveParameterToJson(e,"distortion",this.distortionParameter)}},{key:"fromJson",value:function(e,t){var a=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(h.a)(this.distortionParameter,e.distortion,a),Object(r.a)({},a,this.loadParameterFromJson(e,"distortionParameter",this.distortionParamet,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(f.a.Effect);t.a=b},function(e,t,n){"use strict";n.d(t,"g",function(){return r}),n.d(t,"f",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"d",function(){return u});var r="SOUNDS",a="SEQUENCES",i="PRESETS",o="INSTRUMENTS",s="NOTES",c="EXTERNAL",u="PACKS"},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){if(!e)return"";e=e.trim();for(var t="",n=0;n<e.length;n++)e.charCodeAt(n)>=32&&(t+=e[n]);return t}},,,function(e,t,n){"use strict";var r=n(8),a=n(9),i=n(11),o=(n(173),n(203),n(995),n(996),n(0)),s=n.n(o),c=(n(244),n(139),n(426),n(6)),u=n(182),l=n(213),f=n(838),h=n(12),p=n(260),d=n(371),m=n(372),v=n(840),b=Object(h.b)(function(e,t){return{url:t.zobject.effect.url}},function(e){return{}})(function(e){var t=e.url;return s.a.createElement("img",{className:"z-icon-image",src:window.isNFT?t:"/"+t})}),g=n(87),y=n(48),k=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.cell,n="";switch(t.type||t){case g.b:n=s.a.createElement("div",{className:"symbol dot"});break;case g.a:n=s.a.createElement("div",{className:"symbol dash"});break;case!1:break;default:var r=t.type||t;n=s.a.createElement("div",{className:"symbol "+r.toLowerCase()})}return n}),O=(n(2428),function(e){var t=e.probabilities,n=e.mouseDown,r=e.setMouseDown,a=e.type,c=e.jtypes,u=e.height,l=void 0===u?80:u,f=Object(o.useState)(c.probabilities[a]||0),h=Object(i.a)(f,2),p=h[0],d=h[1],m=Object(o.useRef)();Object(o.useEffect)(function(){d(t[a])},[d,t]);var v=Object(o.useCallback)(function(e){if(!n)return!1;var t=m.current.getBoundingClientRect(),r=(l-(e.clientY-t.top))/l;d(r),c.setProbability(a,r)},[d,n,l]);return s.a.createElement("div",{ref:m,className:"j-type"},s.a.createElement("div",{onMouseUp:function(){return r(!1)},onMouseDown:function(e){e.stopPropagation(),r(!0)},onMouseMove:v,className:"j-slider"},s.a.createElement("div",{style:{height:l*p},className:"j-slider-inner"})),s.a.createElement("div",{className:"cell"},s.a.createElement(k,{cell:{type:a}})))}),j=Object(h.b)(function(e,t){return{probabilities:t.jtypes.probabilities}},function(e){return{}})(function(e){var t=e.jtypes,n=e.probabilities,r=Object(o.useState)(!1),a=Object(i.a)(r,2),c=a[0],u=a[1];Object(o.useEffect)(function(){return window.addEventListener("mouseup",l),function(){return window.removeEventListener("mouseup",l)}},[u]);var l=Object(o.useCallback)(function(){u(!1)},[u]);return t&&t.probabilities?s.a.createElement("div",{className:"jaki-grid j-types"},s.a.createElement(O,{probabilities:n,mouseDown:c,setMouseDown:u,type:"rest",jtypes:t}),s.a.createElement(O,{probabilities:n,mouseDown:c,setMouseDown:u,type:"pianissimo",jtypes:t}),s.a.createElement(O,{probabilities:n,mouseDown:c,setMouseDown:u,type:"piano",jtypes:t}),s.a.createElement(O,{probabilities:n,mouseDown:c,setMouseDown:u,type:"regular",jtypes:t}),s.a.createElement(O,{probabilities:n,mouseDown:c,setMouseDown:u,type:"accent",jtypes:t}),s.a.createElement(O,{probabilities:n,mouseDown:c,setMouseDown:u,type:"staccato",jtypes:t}),s.a.createElement(O,{probabilities:n,mouseDown:c,setMouseDown:u,type:"legato",jtypes:t}),s.a.createElement(O,{probabilities:n,mouseDown:c,setMouseDown:u,type:"double",jtypes:t}),s.a.createElement(O,{probabilities:n,mouseDown:c,setMouseDown:u,type:"flam",jtypes:t})):""}),w=n(50),E=(n(2429),Object(h.b)(function(e,t){return{width:t.zobject.width,height:t.zobject.height,attributes:t.zobject.attributes}},function(e){return{}})(function(e){var t=e.zobject,n=e.attributes,r={width:t.width-10,height:t.width-10,borderRadius:t.width-10,borderColor:n["secondary-color"],backgroundColor:n["button-color"]};return s.a.createElement("div",{style:r,onMouseLeave:function(){return t.effect.sendMessage("on released",w.a)},onMouseDown:function(){return t.effect.sendMessage("on pressed",w.a)},onMouseUp:function(){return t.effect.sendMessage("on released",w.a)},className:"z-button-presser"})})),S=(n(1375),Object(h.b)(function(e,t){var n=t.zobject;return n.effect?{width:n.width,height:n.height,x:n.effect.x,y:n.effect.y,attributes:n.attributes}:{}},function(e){return{}})(function(e){var t=e.zobject,n=e.attributes,r=e.width,a=e.height,c=e.x,u=e.y,l=Object(o.useRef)(void 0),f=Object(o.useState)({x:c,y:u}),h=Object(i.a)(f,2),p=h[0],d=h[1],m=Object(o.useState)(!1),v=Object(i.a)(m,2),b=v[0],g=v[1];Object(o.useEffect)(function(){d({x:c,y:u})},[c,u,d]);var y=Object(o.useCallback)(function(e,n){if(b||n){n&&g(!0);var i=l.current.getBoundingClientRect(),o=(e.clientX-i.left)/r,s=1-(e.clientY-i.top)/a;t.effect.setXY(o,s),d({x:o,y:s})}},[b,g,d,r,a]),k=n["secondary-color"]||"white",O={backgroundColor:n["primary-color"]||"black"};return s.a.createElement("svg",{style:O,ref:l,onMouseUp:function(e){return g(!1)},onMouseDown:function(e){return y(e,!0)},onMouseMove:y,width:r,height:a,className:"xy-interface"},s.a.createElement("circle",{fill:k,onMouseDown:function(e){e.stopPropagation(),g(!0)},cx:p.x*r,cy:(1-p.y)*a,r:10}))})),P=Object(h.b)(function(e,t){var n=t.zobject;return n.effect?{width:n.width,height:n.height,coordinates:n.effect.coordinates,attributes:n.attributes}:{}},function(e){return{}})(function(e){var t=e.zobject,n=e.attributes,r=e.width,c=e.height,u=(e.x,e.y,Object(o.useRef)(void 0)),l=Object(o.useState)(t.effect.coordinates),f=Object(i.a)(l,2),h=f[0],p=f[1],d=Object(o.useState)(!1),m=Object(i.a)(d,2),v=m[0],b=m[1],g=Object(o.useCallback)(function(e,n){if(void 0!==v||n){n&&b(!0);var i=u.current.getBoundingClientRect(),o=(e.clientX-i.left)/r,s=1-(e.clientY-i.top)/(c-40);t.effect.setXY(o,s,v),p(Object(a.a)(t.effect.coordinates))}},[v,b,p,r,c]),y={backgroundColor:n["primary-color"]||"black"};if(!h)return"";for(var k=[],O=[],j=0;j<t.effect.numberOfCoordinates;j++)k.push(t.attributes["coordinate-name-"+(j+1)]),O.push(t.attributes["coordinate-color-"+(j+1)]);var w=t.attributes["x-axis"],E=t.attributes["y-axis"];return s.a.createElement("div",{className:"multi-xy"},s.a.createElement("div",{className:"x-axis"},w),s.a.createElement("div",{className:"y-axis"},E),s.a.createElement("svg",{style:y,ref:u,onMouseUp:function(e){return b(void 0)},onMouseLeave:function(e){return b(void 0)},onMouseDown:function(e){return g(e,!0)},onMouseMove:g,width:r,height:c-40,className:"xy-interface"},h.map(function(e,t){return s.a.createElement("circle",{fill:n["coordinate-color-"+(t+1)],onMouseDown:function(e){e.stopPropagation(),b(t)},cx:e.x*r,cy:(1-e.y)*(c-40),r:10})})),s.a.createElement("div",{className:"legend"},k.map(function(e,t){return s.a.createElement("div",{className:"legend-type"},s.a.createElement("div",{style:{backgroundColor:O[t]},className:"dot"}),s.a.createElement("div",{className:"legend-name"},e))})))}),x=n(39),T=n.n(x),C=n(537),N=Object(h.b)(function(e,t){return{drawingEdge:t.object&&t.object.subSequence&&e.pads.drawingEdges[t.object.subSequence.id],movingEdge:e.pads.movingEdge}},function(e){return{}})(function(e){var t=e.children,n=e.object,r=e.inlet,a=e.movingEdge,i=e.drawingEdge,c=Object(o.useCallback)(function(){i&&i.type?n.connectInlet(r,i.node,i.type):a&&Object(C.a)(n,r,a)},[n,r,i,a]);return s.a.createElement("div",{className:"inlet-field"},s.a.createElement("div",{className:n.isInletConnected(r)?"inlet connected":"inlet",id:n.getFullType(r),onMouseUp:c}),t)}),R=n(734),M=n(180),A=n(828),q=(n(2430),Object.keys(A.a).map(function(e){return{value:e,label:e[0].toUpperCase()+e.slice(1)}})),D=function(e){var t=e.name,n=e.onChange,r=e.get,a=e.builder;return s.a.createElement(N,{object:a,inlet:t},s.a.createElement("div",{className:"sdf-field"},s.a.createElement("div",{className:"field-name"},t),s.a.createElement(R.a,{onChange:n,znumber:r})))},I=Object(h.b)(function(e,t){return{xComponent:t.builder.x,_type:t.builder.type}},function(e){return{}})(function(e){var t=e._type,n=e.builder,r=Object(o.useState)(n.type),a=Object(i.a)(r,2),c=a[0],u=a[1];Object(o.useEffect)(function(){t&&u(t)},[t,u]);var l=Object(o.useCallback)(function(){n.sendObject()},[n]),f=Object(o.useCallback)(function(e){u(e.value),n.type=e.value,n.sendObject()},u,n),h=Object(M.f)(c);return n.x?s.a.createElement("div",{className:"sdf-builder"},s.a.createElement(T.a,{value:c,onChange:f,options:q}),s.a.createElement(D,{builder:n,onChange:l,name:"x",get:n.x}),s.a.createElement(D,{builder:n,onChange:l,name:"y",get:n.y}),h&&s.a.createElement(D,{builder:n,onChange:l,name:"z",get:n.z}),s.a.createElement(D,{builder:n,onChange:l,name:"width",get:n.w}),s.a.createElement(D,{builder:n,onChange:l,name:"height",get:n.h}),h&&s.a.createElement(D,{builder:n,onChange:l,name:"depth",get:n.d}),s.a.createElement(D,{builder:n,onChange:l,name:"corner",get:n.c}),!h&&s.a.createElement(D,{builder:n,onChange:l,name:"rotation",get:n.r}),h&&s.a.createElement(D,{builder:n,onChange:l,name:"repeat x",get:n.repeatCountX}),h&&s.a.createElement(D,{builder:n,onChange:l,name:"repeat y",get:n.repeatCountY}),h&&s.a.createElement(D,{builder:n,onChange:l,name:"repeat z",get:n.repeatCountZ}),h&&s.a.createElement(D,{builder:n,onChange:l,name:"repeat spread",get:n.repeatSpread})):""}),_=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.vec3,n=Object(o.useCallback)(function(){t.sendObject()},[t]);return s.a.createElement("div",{className:"sdf-builder"},s.a.createElement(D,{builder:t,onChange:n,name:"x",get:t.x}),s.a.createElement(D,{builder:t,onChange:n,name:"y",get:t.y}),s.a.createElement(D,{builder:t,onChange:n,name:"z",get:t.z}))}),F=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.vec2,n=Object(o.useCallback)(function(){t.sendObject()},[t]);return s.a.createElement("div",{className:"sdf-builder"},s.a.createElement(D,{builder:t,onChange:n,name:"x",get:t.x}),s.a.createElement(D,{builder:t,onChange:n,name:"y",get:t.y}))}),L=n(253),B=Object(h.b)(function(e,t){return{envelope:t.zenvelope.envelope,width:t.zobject.width,height:t.zobject.height,lineColor:t.zobject.attributes["primary-color"],fillColor:t.zobject.attributes["primary-color"],backgroundColor:t.zobject.attributes["secondary-color"]}},function(e){return{}})(function(e){e.zobject;var t=e.height,n=e.width,r=e.zenvelope,a=e.lineColor,i=e.fillColor,o=e.backgroundColor;return r.envelope?s.a.createElement(L.a,{fillColor:i,lineColor:a,width:n,height:t,backgroundColor:o,name:"Env",draggable:!1,hasRelease:!0,envelope:r.envelope}):""}),z=n(97),V=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.variable,n=e.pattr.getVariableContext(t);return""===n?"":s.a.createElement("div",{className:"variable-context"},n)}),H=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.variable,n=e.pattr,r=t.getObjectType()!==z.d;return s.a.createElement("div",{className:"variable-name"},r?s.a.createElement("div",{style:{backgroundColor:t.attributes["secondary-color"]||"gray"},className:"v-color"}):s.a.createElement("img",{src:"/znumber-light.svg"}),s.a.createElement(V,{variable:t,pattr:n}))}),U=Object(h.b)(function(e,t){return{value:t.variable.effect?t.variable.effect.value:t.variable.message}},function(e){return{}})(function(e){e.variable;var t=e.value;return s.a.createElement("div",{className:"variable-value"},t)}),J=(n(2431),function e(t){var n=t.pattr,r=t.planeMapping,u=Object(o.useRef)(),l=Object(o.useState)([]),f=Object(i.a)(l,2),h=f[0],p=f[1],d=Object(o.useState)(n.hiddenObjects),m=Object(i.a)(d,2),v=(m[0],m[1]);Object(o.useEffect)(function(){p(n.getOptionsAtLevel())},[p,n]);var b=!n.subpatch.zObject;Object(o.useEffect)(function(){if(u.current)return b&&u.current.addEventListener("mousewheel",O),function(){u.current&&u.current.removeEventListener("mousewheel",O)}},[b]);var g=Object(o.useCallback)(function(e){n.hideObject(e),v(Object(a.a)(n.hiddenObjects))},[v,n]),y=Object(o.useCallback)(function(){n.createParameters()},[n]),k=Object(o.useCallback)(function(){r&&(y(),n.parameters,r.randomlyMapParameters(n))},[n,r]),O=function(e){return e.stopPropagation()};return s.a.createElement("div",{ref:u,className:b?"varz base":"varz"},s.a.createElement("div",{onClick:k,className:r?"varz-level plane-mapping":"varz-level"},s.a.createElement("div",{className:"varz-name"},n.subpatch.zObject?n.subpatch.zObject.args[0]:""),s.a.createElement("div",{onClick:y,className:"create-parameters"},"Create Parameters")),s.a.createElement("div",{className:b?"varz-options base-level":"varz-options"},h.filter(function(e){return!n.hiddenObjects.includes(e)}).map(function(e){return s.a.createElement("div",{key:e.id,onClick:function(){return n.subpatch.dispatch(Object(c.uf)(e))},className:"varz-option"},s.a.createElement(H,{variable:e,pattr:n}),s.a.createElement(U,{variable:e}),s.a.createElement("div",{onClick:function(t){return g(e)},className:"hide"},"Hide"))}),n.getNextLevels().filter(function(e){return e.getOptionsAtLevel().length>0||e.getNextLevels().length>0}).map(function(t){return s.a.createElement(e,{planeMapping:r,key:t.subpatch.id,pattr:t})})))}),G=Object(h.b)(function(e,t){return{planeMapping:e.effects.planeMapping}},function(e){return{}})(function(e){var t=e.zobject,n=e.pattr,r=e.planeMapping,a=e.containerRef;return s.a.createElement(J,{planeMapping:r,zobject:t,pattr:n,containerRef:a})}),W=n(368),K=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.textureLoader,n=Object(o.useState)(t.imageHash),r=Object(i.a)(n,2),a=r[0],c=r[1];return Object(o.useEffect)(function(){a&&t.loadImage(a)},[a]),s.a.createElement("div",{className:"texture-loader"},s.a.createElement(W.a,{placeholder:"Drag new image here",imageHash:a,setImageHash:c}))}),X=n(660),Q=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.zobject;return s.a.createElement(X.a,{sequencerEngine:t.sequencerEngine})}),Y=n(503),Z=n(665),$=Object(h.b)(function(e,t){return{pad:t.padWrapper.pad,styling:e.zobject.objectStylings[t.zobject.id],width:t.zobject.width,height:t.zobject.height}},function(e){return{}})(function(e){var t=e.scrollContainer,n=e.pad,r=e.zobject,a=(e.padWrapper,e.styling,e.width),i=e.height;return n?s.a.createElement("div",{className:"z-pad"},s.a.createElement(Z.a,{zobject:r,width:a-10,height:i,attributes:r.attributes,scrollContainer:t,isPulled:!0,pad:n}),s.a.createElement(d.a,{subSequence:r.subSequence,effect:n}),s.a.createElement(m.a,{subSequence:r.subSequence,containerRef:t,effect:n}),s.a.createElement(Y.a,{isRoot:!0,useClick:!0,hideNumber:!0,sequencerEngine:n.sequencerEngine,node:n})):""}),ee=Object(h.b)(function(e,t){return{implements:t.instance&&t.instance.implements}},function(e){return{}})(function(e){var t=e.instance;if(!t)return"empty";var n=t.implements;if(!n)return"not found";var r=n.instances.indexOf(t)+1,a=n.zObject.args[0],i=Math.max(n.inletObjects.length,n.outletObjects.length),o={};return o.minWidth=26*i+"px",o.width=Math.max(120,26*i)+"px",s.a.createElement("div",{style:o,className:"instance-sub-patch"},s.a.createElement("span",{className:"implement-name"},a)," instance #",r)}),te=n(1087),ne=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.zobject,n=t.subSequence.getRootSubSequence?t.subSequence.getRootSubSequence():t.subSequence;return s.a.createElement(te.a,{subSequence:n})}),re=(n(2562),n(1474)),ae=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.zobject;return s.a.createElement(re.a,{sequencerEngine:t.sequencerEngine})}),ie=(n(1413),Object(h.b)(function(e,t){return{updates:t.zobject.updates}},function(e){return{}})(function(e){var t=e.zobject;e.updates;return s.a.createElement("div",{className:"z-matrix"},t.matrix.map(function(e){return s.a.createElement("div",{className:"z-row"},e.map(function(e){return s.a.createElement("div",{className:"z-value"},e)}))}))})),oe=n(1101),se=(n(2564),Object(h.b)(function(e,t){return{secondaryColor:t.zobject.attributes["secondary-color"]}},function(e){return{}})(function(e){var t=e.zobject,n=(e.attributes,e.secondaryColor);return s.a.createElement("div",null,t.sequencerEngine&&s.a.createElement(oe.a,{color:n,engine:t.sequencerEngine,sequencerEngine:t.sequencerEngine}))})),ce=n(1102),ue=(n(2565),Object(h.b)(function(e,t){return{}},function(e){return{setKeyboardContext:function(t){return e(Object(c.Rc)(t))}}})(function(e){var t=e.zobject,n=e.setKeyboardContext,r=t.subSequence;return r.getRootSubSequence&&(r=r.getRootSubSequence()),s.a.createElement("div",{onMouseEnter:function(){return n(t)},onClick:function(){return n(t)},className:"z-tracker"},s.a.createElement(ce.a,{group:r}))})),le=n(634),fe=n(874),he=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.tidal,n=e.zobject;return t?s.a.createElement("div",{className:"z-tidal"},s.a.createElement(fe.a,{noUI:!0,effect:t,sequencerEngine:n.sequencerEngine})):""}),pe=n(334),de=(n(2566),Object(h.b)(function(e,t){return{_samples:t.sampleBank&&t.sampleBank.samples,sampleDragging:e.selector.sampleDragging,_lastSampleSent:t.sampleBank&&t.sampleBank.lastSampleSent}},function(e){return{}})(function(e){var t=e.sampleBank,n=e.sampleDragging,r=e._lastSampleSent,c=e._samples,u=Object(o.useState)(t.samples),l=Object(i.a)(u,2),f=l[0],h=l[1],p=Object(o.useState)(t.lastSampleSent),d=Object(i.a)(p,2),m=d[0],v=d[1];Object(o.useEffect)(function(){c&&h(c)},[c,h]),Object(o.useEffect)(function(){v(r)},[r,v]);var b=Object(o.useCallback)(function(e){e.stopPropagation(),n&&(t.addSample(n),h(Object(a.a)(t.samples)))},[t,n,h]),g=Object(o.useCallback)(function(e){t.deleteSample(e),h(Object(a.a)(t.samples))},[t,h]);return s.a.createElement("div",{onDrop:b,className:"sample-bank"},s.a.createElement("div",{className:"samples"},f&&f.map(function(e){return s.a.createElement("div",{onClick:function(){t.sendSample(e),v(e)},className:e===m?"current sample-option":"sample-option"},s.a.createElement("div",{className:"sample-name"},Object(pe.a)(e.name)),e.tags.map(function(e){return s.a.createElement("div",{className:"sample-tag"},Object(pe.a)(e))}),s.a.createElement("div",{onClick:function(){return g(e)},className:"delete-btn"},"x"))})),(!f||0===f.length)&&s.a.createElement("div",{className:"drop-here"},s.a.createElement("span",{className:"drop-text"},"Drop Samples Here")))})),me=Object(h.b)(function(e,t){return{uxLocked:e.zobject.uxLocked,width:t.toggle.zObject.width,height:t.toggle.zObject.height,_value:t.toggle.value}},function(e){return{setSelectedZObject:function(t){return e(Object(c.uf)(t))}}})(function(e){var t=e.setSelectedZObject,n=e.uxLocked,r=e.toggle,a=e._value,c=(e.height,Object(o.useState)(a)),u=Object(i.a)(c,2),l=u[0],f=u[1];Object(o.useEffect)(function(){f(a)},[a]);var h="ztoggle ";l&&(h+=" toggled");var p=Object(o.useCallback)(function(){t(r.zObject),n&&f(r.toggle())},[r,f,n]);return s.a.createElement("div",{onClick:p,className:h},s.a.createElement("div",{className:"inner-x"}))}),ve=n(29),be=n(507),ge=new ve.a,ye=Object(h.b)(function(e,t){if(!t.object||!t.object.sequencerEngine)return{};var n=t.object.sequencerEngine.getSelectedTrack();return{styling:e.zobject.objectStylings[t.zobject.id],track:n,id:void 0===n?0:void 0!==n.sample&&void 0!==n.sample.getId()?n.sample.getId():n.presetName||n.getName()}},function(e){return{setKeyboardContext:function(t){return e(Object(c.Rc)(t))}}})(function(e){var t=e.track,n=(e.styling,e.zobject),r=e.setKeyboardContext;return s.a.createElement("div",{onMouseEnter:function(){return r(n)},onClick:function(){return r(n)}},t&&s.a.createElement(be.a,{styling:n.attributes,track:t,color:ge.getColorForTrack(t)}))}),ke=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.dpad,n=Object(o.useCallback)(function(e,n){e.stopPropagation(),t.sendMessage(n,w.a)},[t]);return s.a.createElement("div",{className:"dpad"},s.a.createElement("div",{className:"arrows-row"},s.a.createElement("div",{onClick:function(e){return n(e,"up")},className:"g-btn"},s.a.createElement("div",{className:"arrow-up"}))),s.a.createElement("div",{className:"arrows-row"},s.a.createElement("div",{onClick:function(e){return n(e,"left")},className:"g-btn"},s.a.createElement("div",{className:"arrow-left"})),s.a.createElement("div",{onClick:function(e){return n(e,"right")},className:"g-btn"},s.a.createElement("div",{className:"arrow-right"}))),s.a.createElement("div",{className:"arrows-row"},s.a.createElement("div",{onClick:function(e){return n(e,"down")},className:"g-btn"},s.a.createElement("div",{className:"arrow-down"}))))}),Oe=Object(h.b)(function(e,t){return{tidals:t.jrepl.tidals}},function(e){return{}})(function(e){var t=e.tidals;return t?s.a.createElement("div",{className:"jrepl"},t.map(function(e){return s.a.createElement(le.a,{key:e.id,tidal:e})})):s.a.createElement("div",{className:"jrepl"},"Not connnected to jaki...")}),je=n(208),we=Object(h.b)(function(e,t){return{number:t.macro?t.macro.value:0}},function(e){return{}})(function(e){var t=e.macro,n=e.number,r=e.styling,a=Object(o.useRef)(),c=Object(o.useRef)(),u=Object(o.useState)(n),l=Object(i.a)(u,2),f=l[0],h=l[1],p=Object(o.useState)(!1),d=Object(i.a)(p,2),m=d[0],v=d[1],b=Object(je.a)({containerRef:a}).getXY;Object(o.useEffect)(function(){return window.addEventListener("mouseup",k),window.addEventListener("touchend",g),window.addEventListener("mousemove",y),function(){window.removeEventListener("mouseup",k),window.removeEventListener("mousemove",y),window.removeEventListener("touchend",g)}},[v,m,h]);var g=Object(o.useCallback)(function(e){(e.target===a.current||e.target===c.current)&&m&&v(!1)},[m,v]);Object(o.useEffect)(function(){h(n)},[n,h]);var y=Object(o.useCallback)(function(e){if(m){var n=m.y,r=m.number,a=(n-e.pageY)/n*(t.max-t.min)+r;if(a=Math.max(t.min,Math.min(t.max,a)),isNaN(a))return;a!==t.value&&(t.setValue(a),h(a))}},[v,m,h]),k=Object(o.useCallback)(function(e){m&&v(!1)},[v,m]),O=Object(o.useCallback)(function(e){if(m){e.stopPropagation();var n=b(e),r=(n.x,(120-n.y)/120);t.setValue(r),h(r),v({number:r,y:e.pageY})}},[m,h,v]),j=Object(o.useCallback)(function(e){if(m){e.stopPropagation();var n=function(e){for(var t=void 0,n=0;n<e.touches.length;n++)e.touches[n].target!==a.current&&e.touches[n].target!==c.current||(t=e.touches[n]);return t}(e);if(n){var r=b(n),i=(r.x,(120-r.y)/120);i=Math.min(1,Math.max(0,i)),t.setValue(i),h(i),v({number:i,y:e.pageY})}}},[m,h,v]);if(!t)return"";var w={height:120*(f-t.min)/(t.max-t.min),backgroundColor:r["secondary-color"]};return s.a.createElement("div",{style:{backgroundColor:r["primary-color"]},ref:a,onMouseMove:O,onTouchMove:j,onTouchStart:function(e){e.stopPropagation(),console.log("on touch start outter"),v({number:n,y:e.pageY})},onMouseDown:function(e){e.stopPropagation(),v({number:n,y:e.pageY})},className:"macro-slider"},s.a.createElement("div",{ref:c,onTouchMove:j,onTouchStart:function(e){console.log("on touch start inner"),e.stopPropagation(),v({number:n,y:e.pageY})},style:w,className:"slider-indicator"}))}),Ee=n(340),Se=Object(h.b)(function(e,t){return{styling:e.zobject.objectStylings[t.zobject.id]}},function(e){return{}})(function(e){var t=e.macro,n=(e.styling,e.zobject),r=Object(o.useState)(!1),a=Object(i.a)(r,2),c=a[0],u=a[1];return t?s.a.createElement("div",{className:"zmacro"},s.a.createElement("div",null,s.a.createElement(we,{styling:n.attributes,macro:t}),s.a.createElement("div",{onClick:function(){return u(!c)},className:c?"more-info-btn show":"more-info-btn"},s.a.createElement("div",{className:"dot"}),s.a.createElement("div",{className:"dot"}),s.a.createElement("div",{className:"dot"}))),c&&s.a.createElement(Ee.a,{isDraggable:!1,effect:t})):""}),Pe=n(656),xe=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.object,n=e.primaryColor,r=e.secondaryColor;return t.sequencerEngine?s.a.createElement("div",{style:{backgroundColor:n}},s.a.createElement(Pe.a,{secondaryColor:r,primaryColor:n,sequencerEngine:t.sequencerEngine})):""}),Te=Object(h.b)(function(e,t){return{viewableSubPatches:e.zobject.viewableSubPatches,_name:t.subpatch.zObject.args[0]}},function(e){return{setViewableSubPatches:function(t){return e(Object(c.Eh)(t))},setWindowPosition:function(t,n){return e(Object(c.Kh)(t,n))},setSelectedZObject:function(t){return e(Object(c.uf)(t))}}})(function(e){var t=e.subpatch,n=e.viewableSubPatches,r=e.setWindowPosition,l=e._name,f=e.setSelectedZObject,h=Object(o.useRef)(void 0),p=Object(o.useState)(t.zObject.args[0]||""),d=Object(i.a)(p,2),m=d[0],v=d[1],b=Object(o.useState)(!m||""===m),g=Object(i.a)(b,2),y=g[0],k=g[1],O=function(e){var t=e.zobject,n=e.text,r=0;if(n.length>0){var a=n.length+6;r=n.length+6+"ch";var i=t.numInlets;t.effect&&t.effect.numInlets&&(i+=t.effect.numInlets),4*i>a&&(a=4*i,r=4*i+"ch");var o=t.numOutlets;t.effect&&t.effect.numOutlets&&(o+=t.effect.numOutlets),4*o>a&&(r=4*o+"ch")}return r}({zobject:t.zObject,text:t.zObject._text});Object(o.useEffect)(function(){v(l)},[v,l]),Object(o.useEffect)(function(){m!==t.zObject.args[0]&&(t.zObject.text="subpatch "+m)},[m]),Object(o.useEffect)(function(){y&&h.current&&h.current.focus()},[y]);var j=Object(o.useCallback)(function(){var e=t.zObject,n=e.sequencerEngine.state,i=e.subSequence;if(i.inletObjects){var o=n.windows.windowPositions[i.id];r(t.id,o)}var s=n.zobject.viewableSubPatches;Object(c.Eh)([].concat(Object(a.a)(s),[t]))},[t]),w=Object(u.a)(j),E={};y||(E.width=O);var S="closed-subpatch";return n.includes(t)&&(S+=" viewing"),s.a.createElement("div",{onMouseDown:function(e){return f(t.zObject)},style:E,onClick:w,className:S},"subpatch ",y?s.a.createElement("input",{ref:h,placeholder:"type name",onBlur:function(e){return k(!1)},onChange:function(e){return v(e.target.value)},value:m,type:"text",className:"subpatch-name-input"}):s.a.createElement("div",{onClick:function(e){return k(!0)},className:"subpatch-name"},m))}),Ce=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.zobject,n=t.width,r=t.height,a=Object(o.useRef)(void 0),i=Object(o.useRef)(void 0);return Object(o.useEffect)(function(){return i.current=a.current.getContext("2d"),t.effect.ctxt=i.current,function(){return t.effect.ctxt=void 0}},[]),Object(o.useEffect)(function(){i.current&&i.current.scale(window.devicePixelRatio,window.devicePixelRatio)},[n,r]),s.a.createElement("canvas",{height:r*window.devicePixelRatio,width:n*window.devicePixelRatio,style:{width:n,height:r},ref:a})}),Ne=n(559),Re=n(204),Me=(n(2567),Object(h.b)(function(e,t){if(!t.track)return{};var n={showSequencer:t.zobject.attributes["show-sequencer"]},r=e.tracks.triggers[t.track.trackNumber];return n.playing=r&&Object.keys(r).some(function(e){return r[e]})||t.track.notesTriggered&&Object.keys(t.track.notesTriggered).length>0,n.notesTriggered=t.track.notesTriggered,n},function(e){return{}})(function(e){var t=e.track,n=e.playing,r=e.showSequencer,a=e.containerRef,i=Object(o.useRef)(),c="ztrack-component";return n&&(c+=" playing"),t?s.a.createElement("div",{onClick:function(){return t.sequencerEngine.selectTrack(t.trackNumber)},ref:i,className:c},r?s.a.createElement(Ne.a,{forceShow:!0,scrollContainer:a,track:t}):[s.a.createElement(Re.a,{key:0,track:t,draggable:!1}),s.a.createElement("div",{key:1,className:"trigger-indicator"})]):""})),Ae=n(538),qe=n(335),De=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.zcolor,n=Object(o.useState)({hex:t.color}),r=Object(i.a)(n,2),a=r[0],c=r[1];return Object(o.useEffect)(function(){t.color=a.hex},[a]),s.a.createElement("div",{className:"z-color"},s.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"picker-container"},s.a.createElement(qe.a,{color:a,onChange:c})))}),Ie=n(373),_e=Object(h.b)(function(e,t){return{width:t.zobject.width,height:t.zobject.height}},function(e){return{}})(function(e){var t=e.zobject,n=e.width,r=e.height;return s.a.createElement(Ie.a,{isDraggable:!0,setExpanded:function(){return[]},width:n-5,height:r-40,disableSyntaxHelper:!0,expanded:!1,doc:t.effect.doc,sequencerEngine:t.sequencerEngine,effect:t.effect})}),Fe=(n(2568),function(e){return"number"===typeof e||"string"===typeof e?e:JSON.stringify(e)}),Le=Object(h.b)(function(e,t){return{fragmentShader:t.zobject.effect.fragmentShader,vertexShader:t.zobject.effect.vertexShader}},function(e){return{}})(function(e){var t=e.zobject,n=e.fragmentShader,a=e.vertexShader,c=Object(o.useState)(t.effect.uniforms),u=Object(i.a)(c,2),l=u[0],f=u[1],h=Object(o.useState)(!1),p=Object(i.a)(h,2),d=p[0],m=p[1],v=Object(o.useState)(""),b=Object(i.a)(v,2),g=b[0],y=b[1],k=Object(o.useState)(0),O=Object(i.a)(k,2),j=O[0],w=(O[1],Object.keys(l||{})),E=Object(o.useCallback)(function(){t.effect.createUniform(g,j),f(Object(r.a)({},t.effect.uniforms)),m(!1)},[f,m,j,g,m]);return s.a.createElement("div",{className:"zshader-material"},d&&s.a.createElement("div",{className:"creating-uniform"},s.a.createElement("div",{className:"create-row"},s.a.createElement("div",{className:"label"},"Name"),s.a.createElement("input",{type:"text",value:g,onChange:function(e){return y(e.target.value)}})),s.a.createElement("div",{onClick:E,className:"done-btn"},"Done")),s.a.createElement("div",{className:"material-title"},"Shader Material"),s.a.createElement("div",{onClick:function(){return m(!0)},className:"new-uniform-button"},"New Uniform"),s.a.createElement("div",{className:"uniforms"},w.map(function(e){return s.a.createElement("div",{className:"uniform"},e,": ",Fe(l[e].value))})),s.a.createElement("div",{className:"shaders"},s.a.createElement("div",{className:a?"enabled shader":"shader"},"Vertex ",s.a.createElement("div",{className:"dot"})),s.a.createElement("div",{className:n?"enabled shader":"shader"},"Fragment ",s.a.createElement("div",{className:"dot"}))))}),Be=n(628),ze=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.zobject.sequencerEngine;return s.a.createElement("div",{className:"z-nft"},s.a.createElement(Be.a,{seedHash:t.seedHash}),"NFT")});function Ve(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return He(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return He(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ue=Object(h.b)(function(e,t){var n=[t.grid.getConnectedTidal(0),t.grid.getConnectedTidal(1),t.grid.getConnectedTidal(2),t.grid.getConnectedTidal(3),t.grid.getConnectedTidal(4),t.grid.getConnectedTidal(5)];return{currentCycles1:n[0]&&n[0].currentLeaves,currentCycles2:n[1]&&n[1].currentLeaves,currentCycles3:n[2]&&n[2].currentLeaves,currentCycles4:n[3]&&n[3].currentLeaves,currentCycles5:n[4]&&n[4].currentLeaves,currentCycles6:n[5]&&n[5].currentLeaves}},function(e){return{}})(function(e){var t=e.currentCycles1,n=e.currentCycles2,r=e.currentCycles3,i=e.currentCycles4,o=e.currentCycles5,c=e.currentCycles6,u=e.grid,l=[];return[t,n,r,i,o,c].filter(function(e){return e}).flatMap(function(e){return e}).forEach(function(e){var t,n=Ve(e.rules);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(u.rules&&u.rules.includes(r)){var i=r.block;if(i&&"continue"===function(){var e=Math.min.apply(Math,Object(a.a)(i.map(function(e){return e.x}))),t=Math.min.apply(Math,Object(a.a)(i.map(function(e){return e.y}))),n=Math.max.apply(Math,Object(a.a)(i.map(function(e){return e.x}))),r=Math.max.apply(Math,Object(a.a)(i.map(function(e){return e.y})));if(l.some(function(n){return n.x===20*e&&n.y===20*t}))return"continue";l.push({x:20*e,y:20*t,w:20*(1+n-e),h:20*(1+r-t)})}())continue}}}catch(o){n.e(o)}finally{n.f()}}),s.a.createElement("svg",null,l.map(function(e){return s.a.createElement("rect",{x:e.x,y:e.y,width:e.w,height:e.h})}))}),Je=(n(83),[y.i,y.f,y.g,y.h,y.c,y.d]),Ge={};Ge[g.b]="Dot",Ge[g.a]="Dash",Ge[y.a.type]="Accent",Ge[y.j.type]="Staccato",Ge[y.e.type]="Legato",Ge[y.g.type]="Piano (soft)",Ge[y.h.type]="Default strength",Ge[y.f.type]="Pianissimo (softest)",Ge[y.i.type]="Rest (doesnt play)",Ge[y.c.type]="Double (play faster)",Ge[y.d.type]="2 notes almost at the same time";var We=function(e){var t=e.option,n=e.mode,r=e.setMode,a=e.noTooltip,c=Object(o.useState)(!1),u=Object(i.a)(c,2),l=u[0],f=u[1],h="option ";t===n&&(h+=" selected");var p=s.a.createElement(k,{cell:t});return s.a.createElement("div",{onMouseOver:function(){return f(!0)},onMouseLeave:function(){return f(!1)},className:h,onClick:function(){return r(t)}},p,!a&&l&&s.a.createElement("div",{className:"option-tooltip"},Ge[t.type||t]))},Ke=function(e){var t=e.mode,n=e.setMode,r=Object(o.useState)(!1),a=Object(i.a)(r,2),c=a[0],u=a[1];return Object(o.useEffect)(function(){Je.includes(t)||u(!1)},[t,u]),s.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"grid-toolbar"},s.a.createElement(We,{option:g.b,mode:t,setMode:n}),s.a.createElement(We,{option:g.a,mode:t,setMode:n}),s.a.createElement(We,{option:y.a,mode:t,setMode:n}),s.a.createElement(We,{option:y.j,mode:t,setMode:n}),s.a.createElement(We,{option:y.e,mode:t,setMode:n}),s.a.createElement("div",{onClick:function(){return u(!c)},className:c?"show more-options":"more-options"},Je.includes(t)?s.a.createElement(We,{noTooltip:!0,option:t,mode:t,setMode:n}):"...",c&&s.a.createElement("div",{className:"options-overlay"},s.a.createElement(We,{option:y.i,mode:t,setMode:n}),s.a.createElement(We,{option:y.f,mode:t,setMode:n}),s.a.createElement(We,{option:y.g,mode:t,setMode:n}),s.a.createElement(We,{option:y.h,mode:t,setMode:n}),s.a.createElement(We,{option:y.c,mode:t,setMode:n}),s.a.createElement(We,{option:y.d,mode:t,setMode:n}))))},Xe=Object(h.b)(function(e,t){return{cell:t.grid.cells[t.y][t.x]}},function(e){return{}})(function(e){var t=e.mode,n=e.selected,a=e.cell,c=e.odd,u=e.x,l=e.y,f=e.grid,h=e.selection,p=e.setSelection,d=e.dragging,m=e.setDragging,v=Object(o.useState)(a),b=Object(i.a)(v,2),y=b[0],O=b[1],j=c?"cell odd":"cell";y&&(j+=" on"),Object(o.useEffect)(function(){O(a)},[a,O]);var w=Object(o.useCallback)(function(){var e=void 0;y?(e=!1,f.set(u,l,!1)):(e=t,f.set(u,l,t)),O(e)},[t,O,y,u,l]),E=Object(o.useCallback)(function(){y?m({x:u,y:l}):p({x1:u,y1:l,x2:u,y2:l})},[y,h,p,m]),S=Object(o.useCallback)(function(){d?f.drag(d.x,d.y,u,l)&&m({x:u,y:l}):h&&p(Object(r.a)({},h,{x2:u,y2:l}))},[h,d,m,p]);return h&&u>=h.x1&&u<=h.x2&&l>=h.y1&&l<=h.y2&&(j+=" selection"),n&&(j+=" selected"),y===g.a&&(j+=" dash"),y===g.b&&(j+=" dot"),s.a.createElement("div",{onMouseUp:function(){return m(void 0)},onMouseDown:E,onMouseOver:S,onClick:w,className:j},y===g.a?s.a.createElement("div",{className:"dash-inner"},s.a.createElement(k,{cell:y})):s.a.createElement(k,{cell:y}))}),Qe=(n(2569),Object(h.b)(function(e,t){return{mode:e.toolbar.jakiGridMode}},function(e){return{setMode:function(t){return e(Object(c.Pc)(t))}}})(function(e){var t=e.grid,n=e.mode,r=e.setMode,a=Object(o.useState)(void 0),c=Object(i.a)(a,2),u=c[0],l=c[1],f=Object(o.useState)(void 0),h=Object(i.a)(f,2),p=h[0],d=h[1],m=Object(o.useState)({}),v=Object(i.a)(m,2),b=v[0],g=v[1];Object(o.useEffect)(function(){return window.addEventListener("mouseup",k),window.addEventListener("keydown",y),function(){window.removeEventListener("mouseup",k),window.removeEventListener("keydown",y)}},[l,u,g,b]);var y=Object(o.useCallback)(function(e){if("Backspace"===e.key){for(var n in b){var r=n.split(",").map(function(e){return parseInt(e)}),a=Object(i.a)(r,2),o=a[0],s=a[1];t.set(o,s,!1)}g({})}},[b,g]),k=Object(o.useCallback)(function(){u&&(g(t.getSelected(u)),l(void 0)),p&&d(void 0)},[u,p,d,l,g]);return s.a.createElement("div",{className:"jaki-grid"},s.a.createElement(Ke,{setMode:r,mode:n}),s.a.createElement(Ue,{grid:t}),t.cells.map(function(e,r){return s.a.createElement("div",{onClick:function(e){return e.stopPropagation()},onMouseDown:function(e){return e.stopPropagation()},className:r%2===0?"jaki-row":"jaki-row odd"},e.map(function(e,a){return s.a.createElement(Xe,{mode:n,setDragging:d,dragging:p,selected:b[a+","+r],setSelection:l,selection:u,x:a,y:r,grid:t,odd:a%2===1})}))}))})),Ye=n(241),Ze=n(545),$e=Object(h.b)(function(e,t){return{_figures:t.effect&&t.effect.figures._figures}},function(e){return{}})(function(e){var t=e.effect,n=e.setOverflow,r=e._figures,a=Object(o.useState)(void 0),c=Object(i.a)(a,2),u=c[0],l=c[1],f=Object(o.useState)(r),h=Object(i.a)(f,2),p=h[0],d=h[1],m=Object(o.useCallback)(function(){t.figures.newFigure(),d(t.figures._figures)},[t,d]);return Object(o.useEffect)(function(){p&&r&&p.length!==r.length&&(l(void 0),n(void 0)),d(p)},[p,r,d]),t?s.a.createElement("div",{className:"core-jaki jaki"},s.a.createElement("div",{className:"name"},"Jaki"),s.a.createElement("div",{className:"core-figures"},t.figures.figures.map(function(e){return s.a.createElement("div",{onClick:function(){u&&u.type===Ye.a&&u.figure===e?(n(!1),l(void 0)):(l({type:Ye.a,figure:e}),n(!0))},className:u&&u.figure===e?"selected fig":"fig"},e.figureLength)}),s.a.createElement("div",{onClick:m,className:"fig add-fig"},"+")),u&&s.a.createElement(Ze.a,{setChosen:l,chosen:u,effect:t})):0}),et=n(543),tt=n(875),nt=n(1475),rt=n(657),at=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.subpatch,n=e.forceShow,r=Object(rt.a)(),a=r.sizeRef,i=r.ordering,c=r.setOrdering,u=Object(o.useRef)({});return s.a.createElement("div",{className:"custom-subpatch"},s.a.createElement(nt.a,{isInsideWindow:!0,sizeRef:a,elements:u,isInstrumentView:!0,forceShow:n,customMode:"custom",setOrdering:c,ordering:i,subpatch:t}))});n(59);var it=Object(h.b)(null,function(e,t){return{setAnnotationDragging:function(t){return e(Object(c.A)(t))}}})(function(e){var t=e.attributes,n=e.annotation,r=e.color,a=e.onDelete,c=e.setAnnotationDragging,u=Object(o.useState)(n.text),l=Object(i.a)(u,2),f=l[0],h=l[1],p=Object(o.useCallback)(function(e){e.stopPropagation(),n.text=e.target.value,h(e.target.value)},[h]),d={left:n.x,top:n.y,backgroundColor:r},m={backgroundColor:r};t&&t["secondary-color"]&&(m.color=t["secondary-color"]);var v=Object(o.useCallback)(function(e){c(n)},[c]);return s.a.createElement("div",{style:d,className:"annotation"},s.a.createElement("div",{onMouseDown:v,className:"draggable-header"},s.a.createElement("div",{className:"delete-button",onClick:a},"x")),s.a.createElement("textarea",{style:m,onChange:p,type:"textarea",value:f,placeholder:"Write a note",className:"annotation-text"}))}),ot=n(539),st=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.zobject,n=e.effect,r=e.setOverflow,a=Object(o.useState)(void 0),c=Object(i.a)(a,2),u=c[0],l=c[1];return Object(o.useEffect)(function(){r(u)},[u,r]),s.a.createElement("div",{onClick:function(){return l(void 0)},className:"jaki jfigures"},s.a.createElement(ot.a,{zobject:t,setChosen:l,chosen:u,effect:n}),u&&s.a.createElement(Ze.a,{setChosen:l,chosen:u,effect:n}))}),ct=n(638),ut=Object(h.b)(function(e,t){return{tidals:t.jgraphics&&t.jgraphics.tidals,color:t.jgraphics&&t.jgraphics.color,backgroundColor:t.jgraphics&&t.jgraphics.backgroundColor,fillColor:t.jgraphics&&t.jgraphics.fillColor,dotColor:t.jgraphics&&t.jgraphics.dotColor}},function(e){return{}})(function(e){var t=e.jgraphics,n=e.tidals,r=e.width,a=e.height;return n?(r<=0?(r=280,a=280):(r*=1,a*=1),s.a.createElement(ct.a,{color:t.color,fillColor:t.fillColor,backgroundColor:t.backgroundColor,dotColor:t.dotColor,tidals:n,WIDTH:r,HEIGHT:a})):""}),lt=Object(h.b)(function(e,t){return{snapshots:t.jsnapshot&&t.jsnapshot.snapshots}},function(e){return{}})(function(e){var t=e.jsnapshot;return t&&t.snapshots?s.a.createElement("div",{className:"jsnapshot"},s.a.createElement("div",{onClick:function(){return t.takeSnapshot()},className:"take-snapshot-btn"},"Save"),s.a.createElement("div",{className:"snapshots"},t.snapshots.map(function(e,n){return s.a.createElement("div",{onClick:function(){return t.useSnapshot(n)},className:"snapshot-option"},n+1)}))):""}),ft=n(19),ht=n(876);n(899),t.a=Object(h.b)(function(e,t){var n=e.spatial.presentationMode||t.isInstrumentView,r=e.spatial.hiddenObjects[t.zobject.id];return n&&!t.zobject.attributes["Include in Presentation"]&&(r=!0),{presentationMode:n,includeInPresentation:!n&&t.zobject.attributes["Include in Presentation"],outerWidth:t.zobject.subSequence.zObject&&t.zobject.subSequence.zObject.width,outerHeight:t.zobject.subSequence.zObject&&t.zobject.subSequence.zObject.height,function:t.zobject.function,name:t.zobject.name,isSelected:e.windows.selectedElements[t.zobject.id],isSelectedZObject:e.zobject.selectedZObject===t.zobject||e.zobject.selectedZObject&&t.zobject.effect===e.zobject.selectedZObject,width:t.zobject.width,height:t.zobject.height,fillColor:t.zobject.effect&&t.zobject.effect.fillColor,hidden:r,styling:e.zobject.objectStylings[t.zobject.id],flashTimestamp:e.zobject.zobjectsFlashing[t.zobject.id],isLocked:e.spatial.lockedObjects[t.zobject.id],isBackground:e.zobject.zobjectBackground&&e.zobject.zobjectBackground.id===t.zobject.id}},function(e,t){return{setViewableSubPatches:function(t){return e(Object(c.Eh)(t))},setSelectedPulledElements:function(t){return e(Object(c.mf)(t))},setSelectedZObject:function(t){return e(Object(c.uf)(t))},setFullScreenZObject:function(t){return e(Object(c.rc)(t))},setZObjectInputText:function(t){return e(Object(c.Vh)(t))},setLocked:function(n){return e(Object(c.vh)(t.zobject.id,n))},setPluginToSave:function(t){return e(Object(c.me)(t))},setZObjectBackground:function(t){return e(Object(c.Sh)(t))},setZObjectsStack:function(t){return e(Object(c.ci)(t))},setZObjectContextMenu:function(t,n,r){return e(Object(c.Th)(t,n,r))}}})(function(e){var t=e.setZObjectContextMenu,n=e.setZObjectsStack,h=e.presentationMode,g=e.isInstrumentView,y=e.isBackground,k=(e.setZObjectBackground,e.forceShow),O=(e.setPluginToSave,e.zobject),w=e.setLocked,x=e.flashTimestamp,T=e.isLocked,C=(e.coords,e.isMainNFT),N=e.isStatic,R=e.setSelectedZObject,M=e.sequencerEngine,A=(e.fillColor,e.customMode),q=e.isSelectedZObject,D=e.scale,L=e.planeMapping,V=e.sizeRef,H=e.containerRef,U=e.elements,J=e.setOrdering,W=e.isSelected,X=e.ordering,Y=e.size,Z=e.setSize,te=e.setViewableSubPatches,re=e.setSelectedPulledElements,oe=e.setFullScreenZObject,ce=e.includeInPresentation,le=e.hidden,fe=e.setZObjectInputText,pe=Object(o.useRef)(void 0),ve=Object(o.useRef)(void 0),be=(Object(o.useRef)({}),Object(o.useCallback)(function(e){e.preventDefault(),e.stopPropagation();var n=H.current.getBoundingClientRect(),r=e.clientX-n.left,a=e.clientY-n.top;t(O.subSequence.id,{x:r,y:a},O)},[O])),ge=Object(o.useState)(!1),je=Object(i.a)(ge,2),we=je[0],Ee=je[1],Pe=Object(o.useState)(!1),Ne=Object(i.a)(Pe,2),Re=Ne[0],qe=Ne[1],Ie=Object(o.useState)(O._text||""),Fe=Object(i.a)(Ie,2),Be=Fe[0],Ve=Fe[1],He=Object(o.useState)(!1),Ue=Object(i.a)(He,2),Je=Ue[0],Ge=Ue[1],We=Object(o.useState)(!1),Ke=Object(i.a)(We,2),Xe=Ke[0],Ye=Ke[1],Ze=Object(o.useCallback)(function(){var e=O;O.pluginViewerFor&&(e=O.pluginViewerFor);var t=e.sequencerEngine.state.zobject.viewableSubPatches;if(e.subSequence&&e.subSequence.zObject){e.effect.width=e.subSequence.width,e.effect.height=e.subSequence.height;var n=O.sequencerEngine.state.windows.windowPositions[O.subSequence.id];O.sequencerEngine.dispatch(Object(c.Kh)(e.effect.id,n))}te([].concat(Object(a.a)(t),[e.effect]))},[]),nt=Object(o.useRef)(A);Object(o.useEffect)(function(){nt.current=A},[A]);var rt=Object(o.useCallback)(function(e){if(e.stopPropagation(),"subpatch"!==O.name||O.effect.isCustom){var t={};t[O.id]=!0,re(t)}else Ze();R(O)},[A]),ot=Object(o.useState)(!1),ct=Object(i.a)(ot,2),pt=ct[0],dt=ct[1],mt=Object(o.useRef)(0);Object(o.useEffect)(function(){mt.current++;var e=mt.current;x&&(new Date).getTime()-x<5e3&&(dt(!0),setTimeout(function(){mt.current===e&&dt(!1)},4e3))},[x,dt]);var vt=Object(o.useCallback)(function(e){if(e.stopPropagation(),!q){if(O.state.spatial.lockedObjects[O.id]||O.state.spatial.lockedObjects[O.effect&&O.effect.id])return;O.effect&&O.effect.getObjectType&&O.effect.getObjectType()===z.c?R(O.effect):"cirklon"===O.name?R(O.sequencerEngine.getSelectedTrack()):R(O)}},[q]),bt=Object(o.useCallback)(function(e){},[O]),gt=Object(u.a)(rt,250,bt),yt=Object(o.useCallback)(function(){Ge(!0),L.randomlyMapParameters(O.effect)},[Ge,L]);Object(o.useEffect)(function(){!O._text&&ve.current&&(Ee(!0),ve.current.focus())},[]),Object(o.useEffect)(function(){Be!==O._text&&Ve(O._text)},[O._text,Be,Ve]);var kt=Object(o.useCallback)(function(e){var t=e.target.value;O.text=t,Ve(t),fe(t)},[Ve]),Ot=Object(v.a)({code:Be,skipMouse:!0,ref:ve,timeout:40,onChange:kt,doc:ft.a}),jt=Ot.possibilities,wt=Ot.selectedChoice,Et=Ot.choosePossibility,St=Ot.setPossibilities,Pt=Object(p.a)({scale:D,ref:pe,sequencerEngine:M,sizeRef:V,containerRef:H,size:Y,setSize:Z,elements:U,element:O,setOrdering:J,ordering:X}),xt=Pt.zIndex,Tt=Pt.setWindowScale,Ct=(Pt.isDragging,Pt.onMouseDown),Nt=Pt.onMouseUp,Rt=(Pt.setCoords,Pt.startResizing),Mt=Pt.windowScale,At={zIndex:xt},qt=Object(o.useCallback)(function(){var e=O.state.zobject.fullScreenZObject;Array.isArray(e)||(e=[e]),oe(e.filter(function(e){return e!==O}))},[O]);Object(o.useEffect)(function(){O.effect&&O.width&&Tt({x:O.width,y:O.height})},[O.effect,Tt,O.width,O.height]);var Dt=Object(r.a)({},At),It={};if(Be.length>0){var _t=Be.length+1;It.width=Be.length+1+"ch";var Ft=O.numInlets;O.effect&&O.effect.numInlets&&(Ft+=O.effect.numInlets),4*Ft>_t&&(_t=4*Ft,It.width=4*Ft+"ch");var Lt=O.numOutlets;O.effect&&O.effect.numOutlets&&(Lt+=O.effect.numOutlets),4*Lt>_t&&(It.width=4*Lt+"ch")}Dt=Object(r.a)({},Dt,It);var Bt="z-object",zt=!1;!W||"custom"===A&&O.subSequence.zObject||(Bt+=" resizable",zt=!0),pt&&(Bt+=" flashing"),Xe&&(Bt+=" overflow");var Vt=!1;q&&(Bt+=" selected",Array.isArray(O.state.zobject.fullScreenZObject)&&O.state.zobject.fullScreenZObject.includes(O)&&(Vt=!0));var Ht=function(e,t,n,a,i){switch(e.name){case"jparams":return s.a.createElement(et.a,{isDraggable:!1,sequencerEngine:e.sequencerEngine,effect:{jakiParams:e.effect}});case"gl.sdfBuilder":case"sdf.builder":return e.effect&&s.a.createElement(I,{sequencerEngine:e.sequencerEngine,builder:e.effect});case"submix":return s.a.createElement(ae,{zobject:e});case"mixbuttons":return s.a.createElement(Q,{zobject:e});case"icon":return s.a.createElement(b,{zobject:e});case"system5":return s.a.createElement(ne,{zobject:e});case"macro":return s.a.createElement(Se,{zobject:e,macro:e.effect});case"jsnapshot":return s.a.createElement(lt,{jsnapshot:e.effect});case"interface.xy":return s.a.createElement(S,{zobject:e});case"interface.multiXY":return s.a.createElement(P,{zobject:e});case"buttonPresser":return s.a.createElement(E,{zobject:e});case"jrules":return s.a.createElement(tt.a,{effect:Object(r.a)({},e,{rules:[e.effect]}),sequencerEngine:e.sequencerEngine,track:e.subSequence});case"jtypes":return s.a.createElement(j,{jtypes:e.effect,sequencerEngine:e.sequencerEngine,track:e.subSequence});case"envelope":return s.a.createElement(B,{zobject:e,zenvelope:e.effect});case"vec3":return s.a.createElement(_,{zobject:e,vec3:e.effect});case"vec2":return s.a.createElement(F,{zobject:e,vec2:e.effect});case"jfigures":return s.a.createElement(st,{zobject:e,effect:Object(r.a)({},e,{figures:e.effect}),setOverflow:i,sequencerEngine:e.sequencerEngine,track:e.subSequence});case"matrix":return s.a.createElement(ie,{zobject:e});case"ztracker":return s.a.createElement(ue,{zobject:e});case"roll":return s.a.createElement(se,{zobject:e});case"toggle":return s.a.createElement(me,{toggle:e.effect});case"jgraphics":return s.a.createElement(ut,{height:n,width:t,jgraphics:e.effect,sequencerEngine:e.sequencerEngine,track:e.subSequence});case"comment":return s.a.createElement(it,{attributes:e.attributes,annotation:e.effect});case"sampleBank":return s.a.createElement(de,{sampleBank:e.effect});case"jgrid":return s.a.createElement(Qe,{grid:e.effect});case"dpad":return s.a.createElement(ke,{dpad:e.effect});case"jrepl":return s.a.createElement(Oe,{jrepl:e.effect});case"jaki":return s.a.createElement($e,{setOverflow:i,effect:e.effect});case"pad":return s.a.createElement($,{zobject:e,scrollContainer:a,padWrapper:e.effect});case"nft":return s.a.createElement(ze,{zobject:e});case"color":return s.a.createElement(De,{zcolor:e.effect});case"canvas":return s.a.createElement(Ce,{zobject:e});case"three.canvas":return s.a.createElement(Ae.a,{zobject:e});case"three.shaderMaterial":return s.a.createElement(Le,{zobject:e});case"script":return s.a.createElement(_e,{zobject:e});case"instancedSubpatch":return s.a.createElement(ee,{instance:e.effect});case"subpatch":if(e.effect&&e.effect.isCustom)return s.a.createElement(at,{subpatch:e.effect});if(e.effect)return s.a.createElement(Te,{subpatch:e.effect});break;case"track":return s.a.createElement(Me,{zobject:e,track:e.effect,containerRef:a});case"cirklon":return s.a.createElement(ye,{zobject:e,object:e.effect,containerRef:a});case"three.textureLoader":return s.a.createElement(K,{zobject:e,textureLoader:e.effect,containerRef:a});case"varz":return s.a.createElement(G,{zobject:e,pattr:e.subSequence.pattr,containerRef:a});case"tidal":return s.a.createElement(he,{tidal:e.effect,zobject:e});case"patterns":return s.a.createElement(xe,{object:e,containerRef:a,primaryColor:e.attributes["primary-color"],secondaryColor:e.attributes["secondary-color"]})}}(O,Mt&&Mt.x,Mt&&Mt.y,H,Ye);if(Ht&&(Bt+=" custom",delete Dt.width),C&&(Bt+=" main-nft"),Ht&&O.effect&&O.effect.zObjects&&!O.effect.isCustom&&(Bt+=" subpatch-zobject"),Ht&&O.effect&&O.effect.isCustom&&(Bt+=" custom-subpatch-container"),"comment"===O.name&&(Bt+=" comment"),"script"===O.name&&(Bt+=" script"),"track"===O.name&&O.attributes["show-sequencer"]&&(Bt+=" showing-sequencer"),O.hasInletFields&&(Bt+=" has-inlet-fields"),"pad"===O.name&&(Bt+=" z-object-pad"),"sampleBank"===O.name&&(Bt+=" z-sample-bank"),"icon"===O.name&&(Bt+=" z-icon"),"cirklon"===O.name&&(Bt+=" zcirklon",O.attributes["secondary-color"]&&(Dt.backgroundColor=O.attributes["secondary-color"])),"ztracker"===O.name&&(Bt+=" ztracker-object"),"patterns"===O.name&&(Bt+=" zpatterns"),Mt&&Mt.x>0&&Mt.y>0&&Ht&&("subpatch"!==O.name||O.effect.isCustom)&&(Dt.width=Mt.x,Dt.height=Mt.y),O.attributes["fill subpatch"]){var Ut=O.subSequence;if(Ut.zObject){var Jt=Ut.zObject,Gt=Jt.width,Wt=Jt.height;Dt.width=Gt,Dt.height=Wt}}y&&(Dt.width=window.innerWidth-240,Dt.height=window.innerHeight-80),L&&O.effect&&(Je||(Bt+=" plane-mapping")),O.effect&&O.effect.zObjects&&O.effect.isCustom&&(O.attributes&&(Dt.backgroundColor=O.attributes["primary-color"],O.attributes["secondary-color"]&&(Dt.borderColor=O.attributes["secondary-color"])),Bt+=" custom-fill"),O.attributes["primary-color"]&&(Dt.backgroundColor=O.attributes["primary-color"]),"macro"===O.name&&(Dt.backgroundColor=void 0),Dt.borderRadius=O.attributes["border-radius"]+"px",Object(o.useEffect)(function(){return window.addEventListener("click",Kt),function(){return window.addEventListener("click",Kt)}},[Ee]);Object(o.useCallback)(function(){var e=!0===O.attributes["Include in Presentation"];O.setAttribute("Include in Presentation",!e)},[O]);var Kt=Object(o.useCallback)(function(){Ee(!1)},[Ee]),Xt=(Object(o.useCallback)(function(){w(!T)},[T]),Object(o.useCallback)(function(e){e.stopPropagation(),O.effect||vt(e),Ct(e)},[q]));Object(o.useEffect)(function(){if(q){var e=O.state.zobject.zobjectsStack.filter(function(e){return e!==O});e.push(O),n(e)}},[q]);var Qt=O.state.windows,Yt=h&&Qt.presentationWindowPositions[O.id]||Qt.windowPositions[O.id];if(Yt&&(Dt.left=Yt.x,Dt.top=Yt.y),"custom"===A){var Zt=[O.subSequence.zObject.width,O.subSequence.zObject.height],$t=Zt[0],en=Zt[1];if(Yt&&(Yt.x>$t||Yt.y>en))return""}if("track"===O.name&&(Bt+=" z-track"),le&&!k)return"";var tn={};return O.attributes["border-radius"]&&(tn.borderRadius=O.attributes["border-radius"]-3+"px"),we||(Bt+=" not-editing"),y&&(Bt+=" is-background"),ce&&(Bt+=" include-in-presentation"),s.a.createElement("div",{onMouseDown:C||N||Xe||"custom"===A?function(e){return C?e.stopPropagation():0}:Xt,onContextMenu:function(e){O.subSequence.inletObjects&&!O.sequencerEngine.state.zobject.viewableSubPatches.includes(O.subSequence)||(e.stopPropagation(),be(e))},onClick:function(e){var t=O.state.zobject.fullScreenZObject;t?Array.isArray(t)||(t=[t]):t=[];var n=t.length;if(C&&"three.canvas"!==O.name&&n<=1)e.stopPropagation();else if(L)yt(e);else{if("custom"===A&&O.subSequence.zObject)return;gt(e)}},onMouseUp:function(e){Nt(e)},ref:pe,style:Dt,className:Bt},Vt&&s.a.createElement("div",{onClick:qt,className:"pushable remove-from-fullscreen"},"Remove From Screen"),s.a.createElement("div",{style:tn,className:"inner-custom"},Ht),s.a.createElement("div",{className:Ht?"hide-basic":"basic"},s.a.createElement("input",{onMouseDown:function(e){var t=O.sequencerEngine.state.windows.windowPositions[O.id];we&&e.stopPropagation(),qe(t)},onClick:function(e){var t=O.sequencerEngine.state.windows.windowPositions[O.id];e.stopPropagation(),t===Re&&Ee(!0)},spellcheck:"false",style:It,ref:ve,readOnly:!we,type:"text",className:we?"z-object-input editing":"z-object-input no-select",onChange:kt,value:Be}),s.a.createElement(ht.a,{isInstrumentView:g,windowRef:pe,zobject:O}),s.a.createElement(f.a,{doc:ft.a,selectedChoice:wt,choosePossibility:Et,scrollTop:0,input:ve,setPossibilities:St,possibilities:jt})),s.a.createElement(d.a,{doc:ft.a,numInlets:O.numInlets,effect:O}),!Xe&&s.a.createElement(m.a,{numOutlets:O.numOutlets,subSequence:O.subSequence,containerRef:H,scale:D,effect:O}),zt&&Ht&&[s.a.createElement("div",{onMouseDown:function(e){return Rt(l.b,e)},className:"top-left-edge"}),s.a.createElement("div",{onMouseDown:function(e){return Rt(l.a,e)},className:"top-right-edge"}),s.a.createElement("div",{onMouseDown:function(e){return Rt(l.d,e)},className:"bottom-left-edge"}),s.a.createElement("div",{onMouseDown:function(e){return Rt(l.c,e)},className:"bottom-right-edge"})])})},,function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(11),s=n(0),c=n.n(s),u=n(9),l=n(659),f=(n(991),n(29)),h=n(179),p=n(663),d=n(728),m=(n(52),n(30),n(138)),v=n(1033),b=n(76),g=n(34),y=n(12),k=(n(1081),new f.a),O=["koto","perc","hi-hat","kick","snare","clap","poly","mellotron","clavinet","arp","bass","bells","drums","flute","guitar","keys","lead","organ","pad","piano","pluck","stab","strings","rhodes","electric-piano"],j=function(e){return e=e.toLowerCase(),O.filter(function(t){return e.includes(t)})},w=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.scrollRef,n=e.currentPreset,r=e.preset,a=e.setPresetDragging,i=e._auditionPreset,f=e.type,y=(void 0===f&&m.b,e.isPianoRoll),O=Object(s.useState)(void 0),w=Object(o.a)(O,2),E=w[0],S=w[1],P=r.packs,x=Object(s.useState)(!1),T=Object(o.a)(x,2),C=T[0],N=T[1],R=Object(s.useRef)(void 0);Object(l.a)({isCurrent:n&&r.contentHash===n.contentHash,ref:R,scrollRef:t,subtractContainer:!0,topOffset:20});var M=Object(s.useCallback)(function(e){e.stopPropagation();var t=e.clientX-R.current.getBoundingClientRect().left,n=e.clientY-R.current.getBoundingClientRect().top;t>200&&(t-=200),y&&(t=e.clientX,n=e.clientY),t=Math.max(0,t),S({x:t,y:n}),e.preventDefault()},[S,y]),A=r.contentHash===n.contentHash?"preset-option selected":"preset-option";E&&(A+=" showing-dropdown");var q=[].concat(Object(u.a)(r.tags),Object(u.a)(j(r.title)));return c.a.createElement("div",{onContextMenu:M,ref:R},c.a.createElement(b.a,{element:g.o,draggable:!0,onDragStart:function(){return a(r)},onClick:function(e){e.ctrlKey||i(r)},className:A},c.a.createElement(d.a,{setIsTagging:N,dropdownPos:E,setDropdownPos:S,type:m.b,content:r,setPackToSearch:function(){return[]},contentHash:r&&r.contentHash}),c.a.createElement(v.a,{preset:r}),c.a.createElement("span",{className:"preset-name"},r.title&&r.title.trim()," "),Array.from(new Set(P)).map(function(e){return c.a.createElement("div",{style:{color:"red",backgroundColor:k.getColorForHash(e)},className:"pack-thumb"})}),c.a.createElement("span",{className:"preset-tags"},q.map(function(e,t){return c.a.createElement("span",{key:t,className:"preset-tag"},e)})),r.favorited?c.a.createElement("div",{className:"favorited heart"}):""),C?c.a.createElement(p.a,{content:(new h.a).fromJson(r,!1),onTag:function(e){r.tags.push(e),N(!1)}}):"")}),E=n(290),S=new f.a,P=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.isPianoRoll,n=e.pack,r=e.instrumentType,a=e.filterFavorites,i=e.guildId,u=e.scrollRef,l=e.content,f=e._auditionPreset,h=e.setPresetDragging,p=e.searchTerm,d=Object(s.useState)(!1),m=Object(o.a)(d,2),v=m[0],b=m[1],g=Object(s.useState)([]),y=Object(o.a)(g,2),k=y[0],O=y[1];Object(s.useEffect)(function(){b(!(!p||""===p))},[p,b]),Object(s.useEffect)(function(){v&&Object(E.c)(void 0,r,[],i,void 0,a,n.matchingContent).then(function(e){O(e)})},[v,O,n]);var j=S.getColorForHash(n.title),P={};return P.backgroundColor=j,c.a.createElement("div",{className:"pack-presets"},c.a.createElement("div",{onClick:function(){return b(!v)},className:"pack-header"},c.a.createElement("div",{style:P,className:"pack-thumb"}),c.a.createElement("div",{className:"pack-name"},n.title)),v?k.map(function(e,n){return c.a.createElement(w,{key:n,isPianoRoll:t,preset:e,scrollRef:u,currentPreset:l,setPresetDragging:h,_auditionPreset:f})}):"")}),x=n(730),T=n(69);function C(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=0,M=n(367),A=n(6),q=(n(39),n(55)),D=(T.g,q.c,T.f,Object(y.b)(function(e,t){return{}},function(e){return{setSearchText:function(t){return e(Object(A.ye)(t))}}})(function(e){e.type,e.instrumentType,e.setInstrumentType;var t=e.tags,n=e.setSearchTerm,r=e.setPresetsToShow,a=(e.searchTerm,e.onChange),i=(e.setSearchText,e.filterFavorites),o=e.setFilterFavorites,u=e.setGroupByPacks,l=e.groupByPacks;t.map(function(e){return{label:e,value:e}}),Object(s.useCallback)(function(e){console.log("_onChange=",e.value),a(void 0,e.value)},[a,n,r]);return c.a.createElement("div",{className:"presets-toolbar"},c.a.createElement("div",{onClick:function(){return o(!i)},className:i?"heart favorited":"heart"}),c.a.createElement("div",{onClick:function(){return u(!l)},className:l?"packs-btn selected":"packs-btn"}),l&&c.a.createElement("div",{className:"packs-text"},"Packs"))})),I=n(46),_=n(355),F=n(362);n(40),n(31),n(36),new F.a,t.a=Object(y.b)(function(e,t){return{guildId:e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0,sampleExplorerSelected:e.selector.sampleExplorerSelected,isLoading:t.track&&t.track.trackIsLoading,explorerMaximized:e.selector.explorerMaximized,groupByPacks:e.presets.groupByPacks}},function(e){return{setGroupByPacks:function(t){return e(Object(A.tc)(t))},setPresetDragging:function(t){return e(Object(A.re)(t))},setSampleExplorerSelected:function(t){return e(Object(A.Ie)(t))}}})(function(e){var t=e.track,n=e.content,r=e.isLoading,u=e.oscillator,l=e.setGroupByPacks,f=e.groupByPacks,h=e.explorerMaximized,p=e.children,d=e.type,m=void 0===d?T.f:d,v=e.hideTags,y=void 0!==v&&v,k=(e.searchText,e.setPresetDragging),O=e.guildId,j=e.setSampleExplorerSelected,S=e.zobject,N=e.sampleExplorerSelected,A=e.initialSize,q=void 0===A?30:A,F=e.isPianoRoll,L=Object(s.useRef)(void 0),B=Object(s.useState)(!0),z=Object(o.a)(B,2),V=z[0],H=z[1],U=Object(s.useState)([]),J=Object(o.a)(U,2),G=J[0],W=J[1],K=Object(s.useState)(q),X=Object(o.a)(K,2),Q=X[0],Y=X[1],Z=Object(s.useState)(""),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ne=Object(_.a)(L,Q,!0,ee).size,re=Object(s.useState)(!0),ae=Object(o.a)(re,2),ie=ae[0],oe=(ae[1],Object(s.useState)(!1)),se=Object(o.a)(oe,2),ce=se[0],ue=se[1],le=Object(s.useState)(!1),fe=Object(o.a)(le,2),he=fe[0],pe=fe[1],de=function(e){var t=e.type,n=e.guildId,r=e.filterFavorites,a=e.track,i=e.searchTerm,c=e.groupByPacks,u=e.setGroupByPacks,l=Object(s.useState)(void 0),f=Object(o.a)(l,2),h=f[0],p=f[1],d=Object(s.useState)([]),m=Object(o.a)(d,2),v=m[0],b=m[1],g=Object(s.useState)([]),y=Object(o.a)(g,2),k=y[0],O=y[1],j=Object(s.useState)([]),w=Object(o.a)(j,2),S=w[0],P=w[1],N=Object(s.useState)(t),M=Object(o.a)(N,2),A=M[0],q=M[1];return A&&(A.startsWith("zobject")||"formants"===A)&&(c=!1),Object(s.useEffect)(function(){(t.startsWith("zobject")||"formants"===t)&&u(!1)},[t]),Object(s.useEffect)(function(){t===T.f?P(["bass","bells","drums","flute","guitar","keys","lead","organ","pad","piano","pluck","stab","strings"]):P(["bass","flute","korg","keys","moog","pad","prophet","piano","vibraphone"])},[P,t]),Object(s.useEffect)(function(){if(c){var e=++R;setTimeout(function(){e===R&&Object(x.a)(i,!0,"PRESET").then(function(t){if(e===R){p(i);var n,r={},a=C(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;r[o.title]=o}}catch(s){a.e(s)}finally{a.f()}b(Object.keys(r).map(function(e){return r[e]}))}})},200)}},[i,p,b,c,O,A,r,n]),Object(s.useEffect)(function(){var e=!1;return c||(console.log("searching presets by instrumentType =",A),Object(E.c)(void 0,A,[],n,A===T.f?8359897:void 0,r).then(function(t){e||(a&&(a.browsedPresets=t),O(t))})),function(){return e=!0}},[r,A,O,n,c]),Object(s.useEffect)(function(){q(t)},[t,q]),{presetsByPack:v,presets:k,instrumentType:A,tags:S,setInstrumentType:q,searchTermExecuted:h}}({guildId:O,setGroupByPacks:l,filterFavorites:he,type:m,track:t,searchTerm:ee,groupByPacks:f}),me=de.searchTermExecuted,ve=de.presets,be=de.tags,ge=de.instrumentType,ye=de.setInstrumentType,ke=de.presetsByPack;Object(s.useEffect)(function(){he&&l(!1)},[he,l]),Object(s.useEffect)(function(){""!==ee&&l(!1)},[ee,l]),Object(s.useEffect)(function(){setTimeout(function(){if(L.current){var e=L.current.offsetHeight/15;Y(e)}},100)},[L.current&&L.current.offsetHeight,Y,h]),Object(s.useEffect)(function(){H(!r)},[r,H]),Object(M.a)({clear:function(){return j(!1)},selected:N}),Object(s.useEffect)(function(){return function(){return j(!1)}},[]);var Oe=Object(s.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(H(!1),!u){e.next=5;break}u.loadFormantsPreset(n),e.next=11;break;case 5:if(!t){e.next=10;break}return e.next=8,t.sequencerEngine.operationManager.dispatch(Object(I.d)(n,t,ie,ce));case 8:e.next=11;break;case 10:S&&S.loadPreset(n);case 11:H(!0);case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[u,S,t,ce,ie,H]);Object(s.useEffect)(function(){W(ve)},[ve,W]),Object(s.useEffect)(function(){t&&(t.browsedPresets=G)},[t,G]),Object(s.useEffect)(function(){if(!f){var e=ee.toLowerCase();if(e.trim(),""===e)return void W(ve);W(ve.filter(function(t){return t.title.toLowerCase().includes(e)||t.tags.some(function(t){return t.toLowerCase().includes(e)})}))}},[f,ee,W,ve]);var je=Object(s.useCallback)(function(e,t){var n=void 0===t&&e?e.target.value:t;te(n)},[te,W,ve]),we=Object(s.useCallback)(function(){te(""),W(ve)},[te,W,ve]),Ee="sample-explorer";V||(Ee+=" loading-bull-shit-fuck"),N&&(Ee+=" selected");var Se=G.length;if(f&&(""!==ee?Se=ke.reduce(function(e,t){return t.matchingContent.length+e},0):Se=ke.length),S&&""===ee&&0===Se)return"";var Pe=G.slice(0,Math.floor(ne));return c.a.createElement("div",{onMouseDown:function(e){j(!0)},className:S?"zobject-presets presets-explorer-container":"presets-explorer-container"},c.a.createElement("div",{className:Ee},p,c.a.createElement("div",{className:"explorer-top"},c.a.createElement("div",{className:"explorer-row"},c.a.createElement(D,{type:m,groupByPacks:f,setGroupByPacks:l,setFilterFavorites:pe,filterFavorites:he,setInstrumentType:ye,instrumentType:ge,setSearchTerm:te,setPresetsToShow:W,searchTerm:ee,tags:be,onChange:je}),c.a.createElement("div",{className:"override-label"},"Override"),c.a.createElement(b.a,{element:g.M,onClick:function(){return ue(!ce)},className:ce?"explorer-option selected":"explorer-option"},"FX")),c.a.createElement("div",{className:"presets-search-container"},c.a.createElement("input",{value:ee,type:"text",onChange:je,placeholder:S?"Search for presets":"Search for synths"}),c.a.createElement("div",{onClick:we,className:"search-clear-button"},"x"))),c.a.createElement("div",{ref:L,className:"presets-list"},f?ke.map(function(e,t){return c.a.createElement(P,{searchTerm:me,guildId:O,content:n,setPresetDragging:k,scrollRef:L,_auditionPreset:Oe,isPianoRoll:F,filterFavorites:he,instrumentType:ge,pack:e,key:e.packHash})}):Pe.map(function(e,t){return c.a.createElement(w,{key:t,isPianoRoll:F,preset:e,scrollRef:L,currentPreset:n,setPresetDragging:k,_auditionPreset:Oe})}))),y?c.a.createElement("div",{className:"preset-tags-chooser"},be.map(function(e){return c.a.createElement(b.a,{element:g.I,arg:e,onClick:function(){return je(void 0,e===ee?"":e)},className:ee===e?"preset-tag selected ":"preset-tag"},e)})):"")})},function(e,t,n){"use strict";var r=n(9),a=n(11),i=n(0),o=n.n(i),s=n(547),c=n(12);t.a=Object(c.b)(function(e,t){return{len:t.effect._parameters.length,_parameters:t.effect._parameters}},function(e){return{}})(function(e){var t=e.effect,n=e.children,c=e.len,u=e._parameters,l=e.isDraggable,f=Object(i.useState)(t._parameters),h=Object(a.a)(f,2),p=h[0],d=h[1];return Object(i.useEffect)(function(){d(u)},[c,d,t]),o.a.createElement("div",{className:"acc-column mappings parameters-list"},p.map(function(e,n){return o.a.createElement(s.a,{isDraggable:l,key:n,onMapped:function(){return d(Object(r.a)(t._parameters))},i:n,effect:t})}),o.a.createElement(s.a,{isDraggable:l,key:p.length,onMapped:function(){return d(Object(r.a)(t._parameters))},effect:t,i:p.length}),n)})},function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"b",function(){return p});var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(75),c=n(147),u=n(6);function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e){var t=[];if("subSequences"in e)for(var n in e.subSequences){var r=e.subSequences[n];for(var a in r.tracksData){var i=r.tracksData[a];t=t.concat(Object.keys(i.samplers))}}else for(var o in e.tracksData){var s=e.tracksData[o];t=t.concat(Object.keys(s.samplers))}return Array.from(new Set(t))}function p(e,t,n,r){return d.apply(this,arguments)}function d(){return(d=Object(o.a)(i.a.mark(function e(t,n,a,o){var s,f,h,p,d,v;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s={},(new Date).getTime(),o.dispatch(Object(u.Ge)(0,t.length)),!c.isMobile){e.next=24;break}f=l(t),e.prev=5,f.s();case 7:if((h=f.n()).done){e.next=14;break}return p=h.value,e.next=11,m(n,p,o);case 11:s[p]=e.sent;case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),f.e(e.t0);case 19:return e.prev=19,f.f(),e.finish(19);case 22:e.next=34;break;case 24:return d=t.slice(0,3).map(function(e){return m(n,e,o)}),e.next=27,Promise.all(d);case 27:return d=e.sent,v=t.slice(3).map(function(e){return m(n,e,o)}),e.next=31,Promise.all(v);case 31:v=e.sent,(new Date).getTime(),[].concat(Object(r.a)(d),Object(r.a)(v)).forEach(function(e){return s[e.ipfsHash]=e});case 34:return e.abrupt("return",s);case 35:case"end":return e.stop()}},e,null,[[5,16,19,22]])}))).apply(this,arguments)}function m(e,t,n){return new Promise(function(){var r=Object(o.a)(i.a.mark(function r(a,o){var c,l,f,h;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return c=new s.a(t,e),r.prev=1,r.next=4,c.load();case 4:l=n.state.sequencer.sampleDownloadProgress,f=l.downloaded,h=l.total,n.dispatch(Object(u.Ge)(f+1,h)),a(c),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(1),o();case 12:case"end":return r.stop()}},r,null,[[1,9]])}));return function(e,t){return r.apply(this,arguments)}}())}},function(e,t,n){"use strict";var r=n(8),a=(n(9),n(2)),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(85),f=n(313),h=n(321),p=n(315),d=n(186),m=n(776);function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var y=function(e){Object(s.a)(n,e);var t=g(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Midi Effect Rack",e)).initializeConfigurations(r.adjacencyLists),r.initCache(128),r}return Object(i.a)(n,[{key:"stop",value:function(){this.effects.forEach(function(e){return e.stop()})}},{key:"output",value:function(e,t,n){return this.runFlow(e,t,n,this.inputNode,this.triggers,this.adjacencyLists)}},{key:"documentation",get:function(){return["Patch Midi Effects together in non-linear ways. ","The edges control the probability that a trigger is passed through to the next effect."]}},{key:"onNewStep",value:function(){this.triggers.length>0&&(this.triggers.length=0),this.effects.forEach(function(e){return e.onNewStep()})}},{key:"clear",value:function(){this.counter=0,this.effects.forEach(function(e){return e.clear()}),this.triggers=[]}},{key:"isRack",get:function(){return!0}},{key:"isRealTime",value:function(){return void 0===this.adjacencyLists[-1]||!this.adjacencyLists[-1].some(function(e){return e.effect&&e.effect.isRealTime&&!e.effect.isRealTime()})}},{key:"addNote",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.adjacencyLists[-1].filter(function(e){return e.effect&&e.effect.isRealTime&&!e.effect.isRealTime()}).forEach(function(r){return r.effect.addNote(e,t,n)})}},{key:"removeNote",value:function(e,t){this.effects.filter(function(e){return e.isRealTime&&!e.isRealTime()}).forEach(function(n){return n.removeNote(e,t)})}},{key:"getJson",value:function(){return this.getRackJson()}},{key:"fromJson",value:function(e,t,a,i){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t;this.adjacencyLists={},this.initializeConfigurations(this.adjacencyLists,!1),this.effects=[],this.loaded=!1;var c=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t),l=e.effects;for(var f in l){var h=l[f],p=Object(d.a)(h,this.track);if(c=Object(r.a)({},c,p.fromJson(h,s)),p.id!==h.id){var m,b=v(e.configurations);try{for(b.s();!(m=b.n()).done;){var g=m.value,y=g[h.id];g[p.id]=y,delete g[h.id]}}catch(k){b.e(k)}finally{b.f()}}this.addEffect(p,!1),p.x=h._x||h.x,p.y=h._y||h.y}return this.fromRackJson(e,t),this.loaded=!0,c}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"deleteEdge",value:function(e){Object(o.a)(Object(u.a)(n.prototype),"deleteEdge",this).call(this,e,!1)}}]),n}(Object(m.a)(Object(f.a)(Object(h.a)(Object(p.a)(l.a)))));t.a=y},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(11),a=n(17),i=function(e){var t=Object(r.a)(e,3),n=t[0],i=t[1],o=t[2];return Object(a.Q)({stepData:n,stepNumber:i,time:o})},o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.duration,r=arguments.length>3?arguments[3]:void 0;return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];o[0];var c=o[1],u=o[2],l=o[3];r&&(u=r);var f=l.getStep(e);return f.transpose=a.A.apply(void 0,[t].concat(o)),f.duration=a.A.apply(void 0,[n].concat(o)),Object(a.Q)({stepData:f,time:u,stepNumber:c})}}},function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o});var r=n(17),a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return t.reduce(function(e,t){return r.A.apply(void 0,[t].concat(n))+e},0)}},i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return t.reduce(function(e,t){return r.A.apply(void 0,[t].concat(n))*e},1)}},o=function(e,t){return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=r.A.apply(void 0,[e].concat(a)),s=r.A.apply(void 0,[t].concat(a));return(o%s+s)%s}}},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"a",function(){return s});var r=18e3,a=22e3,i=26040,o=32500,s=44100},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(5),a=n.n(r),i=n(14),o=n(52),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(){var r=Object(i.a)(a.a.mark(function r(i,s){var c;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!window.isNFT){r.next=3;break}return i([]),r.abrupt("return");case 3:return r.next=5,o.a.getAccount();case 5:c=r.sent,fetch("/samplesStream/",{method:"POST",body:JSON.stringify({andTags:e,guildIds:t,isFavorited:n,user:c}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){i(e.ids)});case 7:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e,t,n,r,a){var i=40;return r<t&&(i=80),a?[e,t,e,t+i,n-40,r,n,r]:[e,t,e,t+i,n,r-40,n,r]}},function(e,t,n){"use strict";n.d(t,"b",function(){return f}),n.d(t,"d",function(){return h}),n.d(t,"c",function(){return p}),n.d(t,"a",function(){return d});var r=n(111),a=n(255),i=n(72),o=n(17),s=n(82),c=n(105);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(i.a)("triggerAttack",{trackNumber:"",transpose:"",velocity:""},"Triggers an attack (note on) for a given tracks instrument");var f=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];var c=i[0],u=(i[1],i[2]),l=i[3].track.subSequence.name.toLowerCase(),f=o.A.apply(void 0,[e].concat(i)),h=o.A.apply(void 0,[n].concat(i)),p=f+l+".triggerAttack";if(c){var d=void 0;d=void 0===t?c.transpose:o.A.apply(void 0,[t].concat(i)),Object(r.b)(p,{trackNumber:e,time:u,transpose:d,velocity:h})}return Object(o.w)(!0)}};Object(i.a)("triggerRelease",{trackNumber:"",transpose:""},"Triggers a release (note off) for a given tracks instrument");var h=function(e,t){return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=a[0],c=(a[1],a[2]),u=a[3].track.subSequence.name.toLowerCase(),l=e+u+".triggerRelease";if(s){var f=0;void 0===t&&(f=s.transpose),Object(r.b)(l,{trackNumber:e,time:c,transpose:f})}return Object(o.w)(!0)}};Object(i.a)("triggerAttackRelease",{trackNumber:""},"Triggers an attack release for a differennt track");var p=function(e){return function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];var i=n[0],s=n[1],c=n[2],l=n[3],f=l.track.subSequence.name.toLowerCase(),h=o.A.apply(void 0,[e].concat(n));if(Array.isArray(h)){var p,d=u(h);try{for(d.s();!(p=d.n()).done;){var m=p.value,v=m+f+".triggerAttackRelease";i&&l.track.trackNumber+1!==m&&Object(r.b)(v,{trackNumber:e,time:c,stepData:i,stepNumber:s})}}catch(g){d.e(g)}finally{d.f()}}else{var b=h+f+".triggerAttackRelease";i&&h!==l.track.trackNumber+1&&Object(r.b)(b,{trackNumber:e,time:c,stepData:i,stepNumber:s})}return Object(o.w)(!0)}},d=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return Object(s.e)(e,Object(c.l)(e),6,!1)},i=arguments.length>3?arguments[3]:void 0;return Object(o.J)(r(e),Object(o.q)(Object(a.b)(function(e,t,n,r){return r.track.trackNumber+1},t),Object(o.w)(!0),Object(o.J)(Object(o.q)((n=i,function(){return Object(o.w)(void 0===n)}),Object(o.J)(p(t),Object(o.w)(!1)),Object(o.O)(t)))))}},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r="GROUPS",a="MASTER"},function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u});var r=n(0),a=n(6);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(e){var t=e.root,n=e.stepData,o=e.track,s=e.shouldRound,u=e.min,f=e.max,h=e.height,p=e.ref,d=e.setEffectParameterValue,m=e.setEffectParameterValues,v=e.parameter,b=e.selectedSteps,g=e.cirklonMode,y=function(){return v.id};Object(r.useEffect)(function(){return p.current.addEventListener("touchmove",O,{capture:!0}),p.current.addEventListener("touchstart",k,{capture:!0}),function(){p.current&&(p.current.removeEventListener("touchmove",O),p.current.removeEventListener("touchstart",k))}},[p,o,v]);Object(r.useCallback)(function(e){o.sequencerEngine.dispatch(Object(a.n)(!1))},[o]);var k=Object(r.useCallback)(function(e){if(e.stopPropagation(),p.current){var n=c(e,y(),u,f,h,t,p.current);s&&(n=Math.round(n)),v.set(n,!0),d(v.id,n),o.sequencerEngine.dispatch(Object(a.n)(!0))}},[v,g,b,o,n]),O=Object(r.useCallback)(function(e){if(e.stopPropagation(),e.preventDefault(),o.sequencerEngine.state.keyboard.isMouseDown&&p.current){var r=c(e,y(),u,f,h,t,p.current);if(s&&(r=Math.round(r)),"GANG"===g&&b.length>0){var a,k={},O=i(b);try{for(O.s();!(a=O.n()).done;){var j=a.value,w=l(j.parameters,v).set(r,!0,!0),E=w.id,S=w.value;k[E]=S}}catch(Y){O.e(Y)}finally{O.f()}m(k)}else if("SLOPE"===g&&b.length>0){var P={},x=o.getEasyPattern();b.forEach(function(e){return P[e.id]=x.findStepNumber(e)}),b.sort(function(e,t){return P[e.id]-P[t.id]});var T,C=l(o.trackData.parameters,v),N=l(b[0].parameters,v),R=null===N.get()?C.get():N.get(),M=l(b[b.length-1].parameters,v),A=null===M.get()?C.get():M.get(),q=0,D={},I=b.indexOf(n),_=r-R,F=A-r,L=i(b);try{for(L.s();!(T=L.n()).done;){var B=T.value,z=l(B.parameters,v);if(q<I){var V=R+q/I*_,H=z.set(V,!0,!0),U=H.id,J=H.value;D[U]=J}else{var G=(q-I)/(b.length-1-I);isNaN(G)&&(G=0);var W=r+G*F,K=z.set(W,!0,!0),X=K.id,Q=K.value;D[X]=Q}q++}}catch(Y){L.e(Y)}finally{L.f()}m(D)}else v.set(r,!0),d(v.id,r)}},[v,g,b,o,n]);return{onMouseMove:O,onMouseDown:k}};function c(e,t,n,r,a,i,o){var s=o.getBoundingClientRect(),c=e.clientY;e.touches&&(c=e.touches[0].clientY);var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=(e=Math.min(Math.max(0,e),r))/r,o=Math.pow(i,a);return t+(n-t)*o}(a-(c-s.top),n,r,a,i);return isNaN(u)?-100:u}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;return(e-t)/(n-t)}(e,t,n,r);return r*Math.pow(i,1/a)+4}var l=function(e,t){return e.find(function(e){return e.name===t.name})}},,function(e,t,n){"use strict";function r(e){for(var t=e.length-1;t>=0;t--)if("0"!==e.slice(t,t+1))return e.slice(0,t+1)}function a(e){for(var t=0;t<e.length;t++)if("0"!==e.slice(t,t+1))return e.slice(t)}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},function(e,t,n){"use strict";n.d(t,"j",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"k",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"f",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"g",function(){return h}),n.d(t,"i",function(){return p});var r=100,a="IS_TRACK",i="IS_GROUP",o="IS_SEND",s="HIDE",c="TRACK",u="EFFECTS",l="LFOS",f="PARAMETERS",h="ALL",p="SUBSEQUENCE"},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(15),o=n.n(i),s=(n(47),n(588),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.a.Master.context;Object(r.a)(this,e),this.duration=0,this.source=void 0,this.buffer=void 0,this.playbackRate=1,this.looping=!1,this.playSound.bind(this),this.context=t,this.seek.bind(this),this.stopSound.bind(this)}return Object(a.a)(e,[{key:"dispose",value:function(){void 0!==this.source&&this.source.disconnect(),this.buffer=void 0,this.source=void 0}},{key:"getContext",value:function(){return this.context}},{key:"playSound",value:function(e,t){void 0==e&&(e=0),void 0!=this.source&&this.source.stop(),this.source=o.a.Master.context.createBufferSource(),this.source.connect(o.a.Master.context.destination),this.source.buffer=this.buffer,this.source.playbackRate.value=this.playbackRate,this.source.loop=!1,this.source.start(0,Math.max(0,e),t)}},{key:"seek",value:function(e){this.stopSound(),this.playSound(e)}},{key:"stopSound",value:function(){void 0!=this.source&&this.source.stop()}},{key:"loadRawBuffer",value:function(e){this.buffer=e,this.duration=e.duration}},{key:"setBuffer",value:function(e){this.buffer=e,this.duration=e.duration}}]),e}());t.a=s},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(11),a=n(0),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,c=(arguments.length>6&&arguments[6],arguments.length>7?arguments[7]:void 0),u=(arguments.length>8&&arguments[8],Object(a.useState)(t)),l=Object(r.a)(u,2),f=l[0],h=l[1],p=Object(a.useRef)(0);Object(a.useEffect)(function(){e.current&&e.current.scrollTo(0,0),h(t)},[o,i,h,s,t]),Object(a.useEffect)(function(){c+5>f&&h(c+20)},[c,f]),Object(a.useEffect)(function(){if(n&&e.current)return e.current.addEventListener("scroll",d),function(){return e.current&&e.current.removeEventListener("scroll",d)}},[h,f,n,e.current,e.initialSize]);var d=Object(a.useCallback)(function(n){var r=e.current;r&&(p.current=r.scrollTop,r.scrollTop+r.offsetHeight>=r.scrollHeight&&h(f+t))},[h,f,e,t]);return{size:f,scrollPosition:p}}},,,,,,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{internalType:"bytes32",name:"contentHash",type:"bytes32"}],name:"favoritePreset",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"contentHash",type:"bytes32"},{internalType:"bytes32",name:"title",type:"bytes32"},{internalType:"bytes32",name:"sampleHash",type:"bytes32"},{internalType:"bytes32",name:"instrumentType",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"},{internalType:"bytes32[9]",name:"encryptedContentKey",type:"bytes32[9]"},{internalType:"bytes32[6]",name:"publicKey",type:"bytes32[6]"}],name:"newPreset",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"contentHash",type:"bytes32"},{internalType:"bytes32[4]",name:"tags",type:"bytes32[4]"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"tagPreset",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"guildsContractAddress",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"},{indexed:!1,internalType:"bytes32",name:"title",type:"bytes32"},{indexed:!1,internalType:"bytes32[9]",name:"encryptedContentKey",type:"bytes32[9]"},{indexed:!1,internalType:"bytes32[6]",name:"publicKey",type:"bytes32[6]"}],name:"NewPreset",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"PresetSample",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"tag",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"PresetTagged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"}],name:"PresetFavorited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"instrumentType",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"}],name:"PresetInstrumentType",type:"event"}],this.contractAddress="0x45aC8aCbEba84071D4e549d4dCd273E01E5a8daF"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=(n(15),n(43));function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(e){Object(s.a)(n,e);var t=h(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this)).groupNumber=e,i.volume=r,i}return Object(i.a)(n,[{key:"executeEvent",value:function(e){this.subSequence.groups.groups[this.groupNumber]&&this.subSequence.groups.groups[this.groupNumber].setVolume(this.volume)}},{key:"getType",value:function(){return f.e}},{key:"getCopy",value:function(){return(new n).fromJson(this.getJson())}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{groupNumber:this.groupNumber,volume:this.volume})}},{key:"fromJson",value:function(e){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.groupNumber=e.groupNumber,this.volume=e.volume,this}}]),n}(l.a);t.a=p},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=(n(15),n(43));function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(e){Object(s.a)(n,e);var t=h(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this)).groupNumber=e,i.mute=r,i}return Object(i.a)(n,[{key:"getValue",value:function(){return this.mute?0:1}},{key:"isSkippable",value:function(){return!1}},{key:"executeEvent",value:function(e){this.subSequence.groups.groups[this.groupNumber].mute(this.mute)}},{key:"getType",value:function(){return f.d}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{groupNumber:this.groupNumber,mute:this.mute})}},{key:"fromJson",value:function(e){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.groupNumber=e.groupNumber,this.mute=e.mute,this}}]),n}(l.a);t.a=p},function(e,t,n){"use strict";n.d(t,"d",function(){return m}),n.d(t,"b",function(){return v}),n.d(t,"a",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"c",function(){return y});var r=n(8),a=n(5),i=n.n(a),o=n(14),s=(n(70),n(40)),c=n(6),u=n(223),l=n(31),f=n(120),h=n(65),p=(n(44),n(299)),d=n(141),m=function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o,s,c,u,l,m,v,b=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=b.length>2&&void 0!==b[2]?b[2]:10,b.length>3&&void 0!==b[3]?b[3]:1200,e.next=4,t.save(n,d.c,!1);case 4:if(a=e.sent,o=[Object(h.c)(a),n,r,!0,18e8],!window.ethereum){e.next=15;break}return s=new f.ethers.providers.Web3Provider(window.ethereum,"any"),e.next=10,s.send("eth_requestAccounts",[]);case 10:return c=s.getSigner(),u=new p.a,l=u.contractAddress,m=u.abi,v=new f.ethers.Contract(l,m,c),e.next=15,v.newProject.apply(v,o);case 15:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new s.a((new p.a).contractAddress).from(l.l).select("projectId").select("title").executeQuery();case 2:return t=e.sent,e.next=5,new s.a((new p.a).contractAddress).from(l.J).whereIn("projectId",t.map(function(e){return e.projectId})).executeQuery();case 5:return n=e.sent,r={},t.forEach(function(e){return r[e.projectId]=e}),n.forEach(function(e){r[e.projectId].mints||(r[e.projectId].mints=[]),r[e.projectId].mints.push(e)}),e.abrupt("return",t);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(o.a)(i.a.mark(function e(t){var n,a,o,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new s.a((new p.a).contractAddress).from(l.l).select("projectId").select("title").where("contentHash",t.sequenceId).executeQuery();case 2:if(n=e.sent,a=n[0]){e.next=6;break}return e.abrupt("return");case 6:return o=a.projectId,e.next=9,new s.a((new p.a).contractAddress).from(l.J).where("projectId",o).executeQuery();case 9:u=e.sent,console.log(a),console.log("mintss",u),(u=u.map(function(e){return Object(r.a)({},e,a)})).forEach(function(e){e.projectId=e.projectId||0,e.tokenId=e.tokenId||0}),t.dispatch(Object(c.jd)(u));case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=9;break}return n=new f.ethers.providers.Web3Provider(window.ethereum,"any"),e.next=4,n.send("eth_requestAccounts",[]);case 4:return r=n.getSigner(),a=new p.a,o=a.contractAddress,s=a.abi,c=new f.ethers.Contract(o,s,r),e.next=9,c.mint(t);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(o.a)(i.a.mark(function e(t,n,r){var a,o,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loaded minted project =",n,r),n=parseInt(n),r=parseInt(r),e.next=5,new s.a((new p.a).contractAddress).from(l.l).select("contentHash").where("projectId",n).executeQuery();case 5:return a=e.sent,e.next=8,new s.a((new p.a).contractAddress).from(l.J).select("seedHash").where("tokenId",r).where("projectId",n).executeQuery();case 8:if(0!==(o=e.sent).length&&0!==a.length){e.next=11;break}return e.abrupt("return");case 11:for(o=o[0],a=a[0],t.tokenId=r,t.projectId=n,t.seedHash=o.seedHash,t.loadSequence(a.contentHash),Object(u.a)(o.seedHash),c=0;c<100;c++)console.log(Object(u.b)());console.log("found the project+token pair",a,o);case 20:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(38),u=n(0),l=n.n(u);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e="small_checkmark ";return this.props.className&&(e+=this.props.className),l.a.createElement(c.a,{condition:this.props.condition},l.a.createElement("span",{className:e},l.a.createElement("div",{className:"small_checkmark_stem"}),l.a.createElement("div",{className:"small_checkmark_kick"})))}}]),n}(u.Component);t.a=h},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),a=function(e){var t=e.clear,n=e.selected;Object(r.useEffect)(function(){return window.addEventListener("mousedown",a),function(){return window.removeEventListener("mousedown",a)}},[t]);var a=Object(r.useCallback)(function(){n&&t()},[t,n])}},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(0),s=n.n(o),c=n(47),u=n(12),l=function(e){return new Promise(function(t,n){var r=new FileReader;r.readAsArrayBuffer(e),r.onloadend=function(){var e=Object(i.a)(a.a.mark(function e(n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout(Object(i.a)(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.addArrayBuffer(r.result);case 2:n=e.sent,t(n);case 4:case"end":return e.stop()}},e)})),1e3);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()})};t.a=Object(u.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.imageHash,n=e.setImageHash,r=e.placeholder,u=void 0===r?"Drag thumbnail":r,f=Object(o.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(t){var r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.dataTransfer){e.next=2;break}return e.abrupt("return");case 2:if(t.stopPropagation(),t.preventDefault(),t.dataTransfer.effectAllowed="none",t.dataTransfer.dropEffect="none",!t.dataTransfer.items){e.next=19;break}r=t.dataTransfer.items.length,i=0;case 9:if(!(i<r)){e.next=19;break}if("file"!==t.dataTransfer.items[i].kind){e.next=16;break}return e.next=13,l(t.dataTransfer.items[i].getAsFile());case 13:return o=e.sent,n(o),e.abrupt("return");case 16:i++,e.next=9;break;case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[n]),h="";return h=t?s.a.createElement("div",{className:"inner"},s.a.createElement("img",{src:c.a.getHashUrl(t)}),s.a.createElement("span",{className:"drag-placeholder"},u)):s.a.createElement("span",null,u),s.a.createElement("div",{className:"image-handler"},s.a.createElement("div",{onDragOver:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.effectAllowed="none"},onDragEnter:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.effectAllowed="none",e.dataTransfer.dropEffect="none"},onDrop:f,className:t?"drop-here loaded":"drop-here"},h))})},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return u});n(289);var r=n(36),a={A:"a","A#":"A",B:"b",C:"c","C#":"C",D:"d","D#":"D",E:"e",F:"f","F#":"F",G:"g","G#":"G"},i={A:r.a.utils.asciiToHex("a"),"A#":r.a.utils.asciiToHex("A"),B:r.a.utils.asciiToHex("b"),C:r.a.utils.asciiToHex("c"),"C#":r.a.utils.asciiToHex("C"),D:r.a.utils.asciiToHex("d"),"D#":r.a.utils.asciiToHex("D"),E:r.a.utils.asciiToHex("e"),F:r.a.utils.asciiToHex("f"),"F#":r.a.utils.asciiToHex("F"),G:r.a.utils.asciiToHex("g"),"G#":r.a.utils.asciiToHex("G")},o={};for(var s in i)o[i[s]]=s;for(var c in o={},a)o[a[c]]=c;var u=o},function(e,t,n){"use strict";n.d(t,"b",function(){return f}),n.d(t,"c",function(){return h}),n.d(t,"d",function(){return p}),n.d(t,"a",function(){return m});var r=n(9),a=n(11),i=n(33),o=n(6),s=n(46);function c(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=new i.a(32,!1),f=function(e,t){for(var n=e.getEasyPattern().getStepNumbers(t,l),r=e.sequencerEngine.operationManager,i=0;i<n.length;i++){var o=Object(a.a)(n[i],2),c=o[0],u=o[1],f=m(e,u);if(void 0!==f){var h=(f-u)/2;r.dispatch(Object(s.w)(e,c,c.durationParameter,h))}}},h=function(e,t){for(var n=e.getEasyPattern(),i=n.getStepNumbers(t,l),o=e.sequencerEngine.state.sequencer.displayResolution.getNumberOfStepsAtBaseResolution(),s=(e.sequencerEngine.operationManager,[]),c=0;c<i.length;c++){var u=Object(a.a)(i[c],2),f=u[0],h=u[1],p=m(e,h);if(void 0!==p)for(var v=h+o;v<p;v+=o)s=[].concat(Object(r.a)(s),Object(r.a)(n.pasteSteps([f],{stepNumber:v},n,l)))}d(e,[].concat(Object(r.a)(t),Object(r.a)(s))),e.updateSteps()},p=function(e,t){var n=e.getEasyPattern(),r=e.sequencerEngine.state.sequencer.displayResolution,i=r.getCopy(),u=n.getStepNumbers(t,r);i.isTriplet=!i.isTriplet,e.sequencerEngine.dispatch(Object(o.Ce)(i));var l=e.sequencerEngine.operationManager;l.dispatch(Object(s.h)(e,t));var f,h=c(u);try{for(h.s();!(f=h.n()).done;){var p=f.value,d=Object(a.a)(p,2),m=d[0],v=d[1],b=i.isTriplet?1.5:2/3;l.dispatch(Object(s.c)(e,m,Math.round(v*b),i))}}catch(g){h.e(g)}finally{h.f()}e.sequencerEngine.dispatch(Object(o.Ce)(r)),e.updateSteps(!0,void 0,i.isTriplet)},d=function(e,t){e.sequencerEngine.dispatch(Object(o.jf)(t))},m=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;t=l.transformStepAtResolution2(t,n);for(var r=e.pattern,a=r.stepBuckets,i=t+1;i<a.length;i++)if(a[i].anyOn())return n.transformStepAtResolution2(i,l);return n.transformStepAtResolution2(r.stepBuckets.length,l)}},function(e,t,n){"use strict";var r=n(9),a=n(11),i=n(0),o=n.n(i),s=(n(50),n(12)),c=n(29),u=n(6),l=n(537),f=new c.a;t.a=Object(s.b)(function(e,t){var n=t.subSequence||t.effect.subSequence||t.effect.track&&t.effect.track.subSequence;if(n){var r=t.effect.numInlets;return t.effect.effect&&(r+=t.effect.effect.numInlets),{drawingEdge:e.pads.drawingEdges[n.id],numInlets:r,movingEdge:e.pads.movingEdge}}return{}},function(e){return{setZObjectTooltip:function(t,n,r){return e(Object(u.Zh)(t,n,r))}}})(function(e){var t=e.doc,n=e.effect,s=e.drawingEdge,c=e.movingEdge,u=e.setZObjectTooltip,h=Object(i.useState)(void 0),p=Object(a.a)(h,2),d=p[0],m=p[1],v=Object(i.useCallback)(function(e,t){s&&s.type?(m(void 0),t.connectInlet(e,s.node,s.type)):c&&(m(void 0),Object(l.a)(t,e,c))},[s,c,m]);Object(i.useEffect)(function(){if(d){var e=n.zObject?n.zObject.id:n.id,t=n.state.windows.windowPositions[e];if(!t)return;u(n.subSequence.id,{x:t.x+20*d.i,y:t.y-30},d.text)}else u(void 0)},[d,n]);var b=Object(i.useCallback)(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("instancedSubpatch"!==n.name&&void 0!==r&&t&&t(n.name)&&t(n.name).params){var a=t(n.name),i=Object.keys(t(n.name).params),o=Object.values(t(n.name).params);isNaN(a.inlets)?Array.isArray(a.inlets)&&(i=a.inlets):i.length<a.inlets&&(r-=a.inlets-i.length);var s=n.name+": "+(i[r]||e);o[r]&&""!==o[r]&&(s+=" "+o[r]),n.effect&&n.effect.inletObjects&&n.effect.inletObjects[r]&&""===(s=n.effect.inletObjects[r]._text)&&(s=Object.keys(n.effect.inlets)[r]),m({text:s,i:r})}else m({text:e,i:r})},[m]);if(!n.inlets)return"";var g=Object.keys(n.inlets);g.includes("Input")&&(g=["Input"].concat(Object(r.a)(g.filter(function(e){return"Input"!==e}))));var y=[],k=[];n.effect&&n.effect.inlets&&function(){for(var e=Object.keys(n.effect.inlets).filter(function(e){return!g.includes(e)}),t=n.effect,r=[],a=(n.name,function(n){t.inletObjects&&t.inletObjects[n]&&""!==t.inletObjects[n]._text?k[n]=t.inletObjects[n]._text:k[n]=e[n],t.inletObjects&&t.inletObjects[n]&&t.inletObjects[n].isDeleted?k.splice(-1):t.inletObjects&&t.inletObjects[n]&&t.implements&&!t.implements.instanceInlets.find(function(e){return e.inletNumber===t.inletObjects[n].inletNumber})?k.splice(-1):t.inletObjects&&t.inletObjects[n]&&t.hasInstances&&t.instanceInlets.includes(t.inletObjects[n])?k.splice(-1):(t.implements&&t.implements.inletObjects&&t.implements.inletObjects[n]&&""!==t.implements.inletObjects[n]._text&&(k[n]=t.implements.inletObjects[n]._text),r.push(e[n]))}),i=0;i<e.length;i++)a(i);y=r}(),k=k.filter(function(e){return e}),n.isOutlet&&(g=g.slice(0,1));var O=function(e){return s&&s.type===e?{backgroundColor:f.getColorForHash(e)}:{}};return o.a.createElement("div",{className:"inlets"},g.map(function(e,t){return o.a.createElement("div",{key:e,onMouseLeave:function(){return m(void 0)},onMouseOver:function(){return b(e,t)},style:O(e),onMouseUp:function(){return v(e,n)},id:n.getFullType(e),className:n.isInletConnected(e)?"inlet connected":"inlet"})}),y.map(function(e,t){return o.a.createElement("div",{key:e,onMouseLeave:function(){return m(void 0)},style:O(e),onMouseOver:function(){return b(k[t],t+g.length)},onMouseUp:function(){return v(e,n.effect)},id:n.effect.getFullType(e),className:n.effect.isInletConnected(e)?"inlet connected":"inlet"})}))})},function(e,t,n){"use strict";var r=n(8),a=n(11),i=n(0),o=n.n(i),s=n(6),c=n(537),u=n(208),l=n(12),f=n(29),h=(n(2427),new f.a);t.a=Object(l.b)(function(e,t){var n=t.effect.subSequence||t.effect.track&&t.effect.track.subSequence;return t.effect.effect?{numOutlets:t.effect.numOutlets+t.effect.effect.numOutlets,drawingEdge:n&&e.pads.drawingEdges[n.id]}:{numOutlets:t.effect.numOutlets,movingEdge:e.pads.movingEdge,drawingEdge:n&&e.pads.drawingEdges[n.id]}},function(e){return{setDrawingPadEdge:function(t,n){return e(Object(s.Nb)(t,n))},setZObjectTooltip:function(t,n,r){return e(Object(s.Zh)(t,n,r))}}})(function(e){var t=e.subSequence,n=e.drawingEdge,s=e.setDrawingPadEdge,l=e.effect,f=e.containerRef,p=e.setZObjectTooltip,d=e.scale,m=Object(i.useState)(void 0),v=Object(a.a)(m,2),b=v[0],g=v[1];Object(u.a)({containerRef:f,scale:d}).getXY;Object(i.useEffect)(function(){if(b){var e=l.zObject?l.zObject.id:l.id,t=l.state.windows.windowPositions[e],n=l.zObject?l.zObject.height||25:l.height||25;if(!t)return;p(l.subSequence.id,{x:t.x+20*b.i,y:t.y+n+10},b.text)}else p(void 0)},[b,l]);var y=Object(i.useCallback)(function(e,n){var r=t.state.pads.movingEdge;r&&(g(void 0),Object(c.b)(n,e,r))},[]),k=Object(i.useCallback)(function(e,t){g({text:l.name?l.name+": "+e:e,i:t})},[g]),O=Object(i.useCallback)(function(e,n,a,i){e.stopPropagation(),i.getFullType(n);var o={x:e.clientX,y:e.clientY},c=t||i.subSequence||i.track&&i.track.subSequence;c.state.spatial.edgesPadding,s(c.id,Object(r.a)({},o,{effect:i,type:n,outputNumber:a,node:i,x1:o.x*(window._scale||1),y1:o.y*(window._scale||1),x2:o.x*(window._scale||1),y2:o.y*(window._scale||1)}))},[t]);if(!l.outlets)return"";var j=Object.keys(l.outlets),w=[],E=[];if(l.effect&&l.effect.inlets&&(!l.effect.hasInstances||l.effect.showAllOutlets)){var S=Object.keys(l.effect.outlets).filter(function(e){return!j.includes(e)});w=S;for(var P=l.effect,x=0;x<S.length;x++)P.outletObjects&&P.outletObjects[x]&&""!==P.outletObjects[x]._text?E[x]=P.outletObjects[x]._text:E[x]=S[x]}var T=function(e){return n&&n.type===e?{backgroundColor:h.getColorForHash(e)}:{}};return o.a.createElement("div",{className:"outlets"},j.map(function(e,t){return o.a.createElement("div",{key:e,onMouseLeave:function(){return g(void 0)},style:T(e),onMouseOver:function(){return k(e,t)},onMouseDown:function(n){return O(n,e,t,l)},onMouseUp:function(){return y(e,l)},id:l.getFullType(e),className:l.isOutletConnected(e)?"outlet connected":"outlet"})}),w.map(function(e,t){return o.a.createElement("div",{key:e,onMouseLeave:function(){return g(void 0)},onMouseOver:function(){return k(E[t],j.length+t)},onMouseUp:function(){return y(e,l.effect)},style:T(e),onMouseDown:function(n){return O(n,e,t,l.effect)},id:l.effect.getFullType(e),className:l.effect.isOutletConnected(e)?"outlet connected":"outlet"})}))})},function(e,t,n){"use strict";var r=n(28),a=n(11),i=n(0),o=n.n(i),s=n(12);function c(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e){return e.automations&&e.automations.length},f=function(e){return e.mixAutomation&&e.mixAutomation.automations&&e.mixAutomation.automations.length},h=Object(s.b)(function(e,t){var n=t.force;return{hasAutomations:l(n[0])||l(n[1])||l(n[2])||l(n[3])||f(n[0])||f(n[1])||f(n[2])||f(n[3])}},function(e){return{}})(function(e){var t=e.force,n=e.name,r=e.hasAutomations,a=Object(i.useCallback)(function(){var e,n=c(t);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=r.mixAutomation;r.automation.deleteAutomations(),a.deleteAutomations()}}catch(i){n.e(i)}finally{n.f()}},[t]);return o.a.createElement("div",{className:"script-force"},n,r?o.a.createElement("img",{onClick:a,src:"/automation-icon-disabled.png",className:"automation-icon"}):"")}),p=Object(s.b)(function(e,t){return{forces:t.effect.forces}},function(e){return{}})(function(e){var t=e.forces,n=Object.keys(t).length;return o.a.createElement("div",{className:"script-forces"},n>0&&o.a.createElement("div",{className:"forces-label"},"Forces"),Object.keys(t).map(function(e){return o.a.createElement(h,{name:e,force:t[e]})}))}),d=n(22),m=Object(s.b)(function(e,t){return{variables:e.effects.scriptVariables[t.effect.id]}},function(e){return{}})(function(e){var t=e.effect,n=e.variables,r=e.sequencerEngine;return n?o.a.createElement("div",{className:"script-variables"},n.filter(function(e){return e&&e.name}).filter(function(e){return!e.hide}).sort(function(e,t){return e.name.localeCompare(t.name)}).map(function(e){return o.a.createElement(d.a,{name:e.name,key:e.id,min:e.min,max:e.max,step:e.max-Math.floor(e.max)!==0||e.min-Math.floor(e.min)!==0||Math.abs(e.max-e.min)<2?.01:1,parameter:e,lfoEnabled:!0,sequencerEngine:r,isParameter:!0,effectNumber:0})}),t.forces&&o.a.createElement(p,{effect:t})):[]}),v=n(247),b=(n(638),Object(s.b)(function(e,t){return{variables:e.effects.scriptVariables[t.tidal.id]}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.variables,r=void 0===n?[]:n;return o.a.createElement("div",{className:"tidal-variables"},(r||[]).map(function(e){return o.a.createElement(d.a,{name:e.name,min:e.min,max:e.max,step:e.max-Math.floor(e.max)!==0||e.min-Math.floor(e.min)!==0||Math.abs(e.max-e.min)<2?.01:1,parameter:e,lfoEnabled:!0,sequencerEngine:t,isParameter:!0,effectNumber:0})}))}),n(291)),g=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.code,n=e.setCode,r=e.isLoading,s=e.setIsLoading,c=e.scriptType,u=Object(i.useState)([]),l=Object(a.a)(u,2),f=l[0],h=l[1];Object(i.useEffect)(function(){Object(b.c)(c).then(h)},[h,c]);var p=Object(i.useCallback)(function(e){n('const fn = load("'+e.title+'");\n'+t),s(!1)},[t,n,s]);return r?o.a.createElement("div",{className:"load-script-flow"},f.map(function(e){return o.a.createElement("div",{onClick:function(){return p(e)},className:"script-option"},e.title)}),o.a.createElement("div",{className:"load-toolbar"},o.a.createElement("div",{onClick:function(){return s(!1)},className:"cancel-btn"},"Cancel"))):[]});var y=Object(s.b)(function(e,t){return{graphics:t.effect.graphics}},function(e){return{}})(function(e){e.effect,e.graphics;return""}),k=n(450),O=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.matchingParenthesis;if(!t)return[];var n={top:t.y,left:t.x};return o.a.createElement("div",{style:n,className:"matching-parenthesis"})}),j=n(5),w=n.n(j),E=n(14),S=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.scriptType,n=e.isSaving,r=e.setIsSaving,s=e.code,c=Object(i.useState)(""),u=Object(a.a)(c,2),l=u[0],f=u[1],h=Object(i.useCallback)(Object(E.a)(w.a.mark(function e(){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.d)(s,t,l);case 2:r(!1);case 3:case"end":return e.stop()}},e)})),[s,l,r,t]);return n?o.a.createElement("div",{className:"save-script-flow"},o.a.createElement("input",{placeholder:"Type name for script",type:"text",value:l,onChange:function(e){return f(e.target.value)}}),o.a.createElement("div",{className:"save-toolbar"},o.a.createElement("div",{onClick:function(){return r(!1)},className:"cancel-btn"},"Cancel"),o.a.createElement("div",{onClick:h,className:"done-btn"},"Done")),o.a.createElement("div",{className:"info"},"To load use ",o.a.createElement("br",null),o.a.createElement("code",null,'const fn = load("NAME YOU CHOSE HERE");'))):[]}),P=(n(1404),Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.code,n=(e.doc,e.scrollTop),r=t.replace(/[^0-9\n\s]/g," "),a=t.replace(/[^a-zA-Z\n\s]/g," "),i={top:-n};return[o.a.createElement("pre",{style:i,className:"syntax-highlighter number"},r),o.a.createElement("pre",{style:i,className:"syntax-highlighter letter"},a)]}),n(838)),x=n(274),T=n(29),C=(n(59),n(840)),N=function(e,t){for(var n=0,r=0;r<e.length;r++)e[r]==t&&n++;return n},R=function(e,t){for(var n="",r=0;r<t;r++)n+=e;return n},M=n(1504),A=n.n(M),q=n(1061);n(2545),n(2546),n(2547),n(2548);window.startColor="#ff4d24",window.hueShift=4;var D=new T.a,I=0,_=function(e){var t=e.syntaxErrors,n=e.code,r=e.lineNumber,a=e.running,i=e.syntaxError,s=e.scrollTop;if(!t||0===t.length)return"";var c=(n||"").split("\n"),u="highlighter";a&&(u+=" running");D.saturate(window.startColor,1);return c.map(function(e,n){return o.a.createElement("div",{key:n,style:{width:.5*e.length+"em",top:19*n-2-s,height:19},className:t&&t.some(function(e){return e.lineNumber===n+1})||i&&n+1===r?"syntax-error "+u:u})})};t.a=Object(s.b)(function(e,t){return{syntaxErrorLine:t.effect.syntaxErrorLine,code:t.effect.code,tidals:t.effect.tidals,variables:e.effects.scriptVariables[t.effect.id],logs:t.effect.logs,logNum:t.effect.logs&&t.effect.logs.length,syntaxErrors:t.effect.syntaxErrors}},null)(function(e){e.tidals,e.isDraggable;var t,n=e.logs,s=e.scriptType,c=void 0===s?k.b:s,u=e.effect,l=e.sequencerEngine,f=(e.variables,e.lang),h=void 0===f?q.languages.js:f,p=e.doc,d=e.setExpanded,b=e.disableSyntaxHelper,j=e.expanded,w=e.width,E=e.height,T=Object(i.useRef)(void 0),M=Object(i.useRef)(void 0),D=Object(i.useState)(!1),F=Object(a.a)(D,2),L=F[0],B=F[1],z=Object(i.useRef)(void 0),V=(Object(i.useRef)(void 0),Object(i.useState)(!1)),H=Object(a.a)(V,2),U=H[0],J=H[1],G=Object(i.useState)(u.code),W=Object(a.a)(G,2),K=W[0],X=W[1],Q=Object(i.useRef)(0),Y=Object(i.useRef)(!1),Z=Object(i.useRef)(!1),$=Object(i.useState)(!1),ee=Object(a.a)($,2),te=ee[0],ne=ee[1],re=Object(i.useState)(!1),ae=Object(a.a)(re,2),ie=ae[0],oe=ae[1],se=Object(i.useState)(0),ce=Object(a.a)(se,2),ue=ce[0],le=ce[1];Object(x.a)({ref:T}).preventDragging;Object(i.useEffect)(function(){X(u.code)},[u,u.code,X]),Object(i.useEffect)(function(){u&&u.expanded&&c===k.b&&d(!0)},[]),Object(v.a)(T);var fe=Object(i.useCallback)(function(e){var t=M.current;t&&le(t.scrollTop),X(e.target.value);var n=++I;setTimeout(function(){n===I&&(u.hasSyntaxError(e.target.value)?oe(!0):oe(!1))},1e3)},[X,oe,le]),he=Object(C.a)({ref:M,code:K,onChange:fe,doc:p,disable:b}),pe=he.library,de=he.setLibrary,me=he.choosePossibility,ve=he.possibilities,be=he.setPossibilities,ge=he.selectedChoice,ye=he.matchingParenthesis;Object(i.useEffect)(function(){if((Y.current||Z.current)&&M.current){if(Y.current){Y.current=!1;var e=function(e,t){var n="",r=e.split("\n"),a=0,i=0,o=0,s=0;for(var c in r){var u=r[c],l=N(u,"("),f=N(u,")"),h=N(u,"{"),p=N(u,"}"),d=a-i-p,m=u.trimStart();n+=R("  ",d)+m,parseInt(c)<r.length-1&&(n+="\n"),a+=l+h,i+=f+p,o<=t&&t<=o+u.length+1&&(s=t+2*d),o+=u.length+1}return{indented:n,caret:s}}(K,Q.current+1);if(e.indented===K)return;ke(e.indented,e.caret)}if(Z.current){var t=Z.current;Z.current=void 0;var n=Q.current+1,r=function(e,t,n){return t.slice(0,n)+e+t.slice(n)}(t,K,Q.current+1);ke(r,n)}}},[K,X]);var ke=Object(i.useCallback)(function(e,t){var n=z.current.scrollTop,r=M.current.style.resize,a=M.current.style.overflow;M.current.style.resize="none",z.current.style.overflow="hidden",M.current.style.overflow="hidden",M.current.blur(),X(e),setTimeout(function(){M.current.setSelectionRange(t,t),z.current.scrollTo(0,n),M.current.style.resize=r,M.current.focus(),z.current.style.overflow="scroll",M.current.style.overflow=a},10)},[X]);function Oe(){var e=document.getElementById(u.id+"-script");e&&e.removeEventListener("scroll",je)}Object(i.useEffect)(function(){X(u.code);var e=M.current;return e&&e.addEventListener("scroll",je),Oe},[u,X]);var je=Object(i.useCallback)(function(){var e=document.getElementById(u.id+"-script");e&&le(e.scrollTop)},[le]),we=(Object(i.useCallback)(function(){},[K]),Object(i.useCallback)(function(){u.eval(K,void 0,!0),ne(!0),setTimeout(function(){return ne(!1)},100)},[K,ne])),Ee=Object(i.useCallback)(function(e){M.current&&(Q.current=M.current.selectionStart),"Enter"===e.key&&e.ctrlKey?(e.stopPropagation(),e.preventDefault(),we()):"Enter"===e.key?Y.current=!0:"{"===e.key?Z.current="}":"("===e.key||'"'===e.key||e.key},[we]),Se="execute-button",Pe="user-script-component";te&&(Se+=" running",Pe+=" running"),Object(i.useEffect)(function(){M.current=document.getElementById(u.id+"-script")},[u]),j&&(Pe+=" expanded");var xe="";n&&(xe=n[n.length-1]);var Te="script-and-tidal";return j&&"User Script"===u.name&&(Te+=" expanded"),ie&&(Pe+=" syntax-error"),o.a.createElement("div",{className:Te},o.a.createElement("div",{ref:T,className:Pe},d?o.a.createElement("img",{onClick:function(){u.expanded=!j,d(j?void 0:u)},className:"expanded-icon",src:"/expand-icon.svg"}):"",o.a.createElement("div",{draggable:!0,ref:z,onDragStart:function(e){return e.preventDefault()},onMouseDown:function(){be([]),de(void 0)},style:j?{height:340}:E?{height:E,width:w}:{},className:"script-box"},o.a.createElement(S,{scriptType:c,setIsSaving:B,code:K,isSaving:L}),o.a.createElement(g,(t={setCode:X,code:K,scriptType:c,setIsLoading:J},Object(r.a)(t,"code",K),Object(r.a)(t,"isLoading",U),t)),o.a.createElement(A.a,{textareaId:u.id+"-script",value:K||"",onValueChange:function(e){return fe({target:{value:e}})},highlight:function(e){return Object(q.highlight)(e,h)},onKeyDown:Ee,onMouseDown:function(e){e.stopPropagation()},spellCheck:"false",className:"user-script-code"}),o.a.createElement(_,{scrollTop:ue,running:te,lineNumber:u.syntaxErrorLine,syntaxErrors:u.syntaxErrors,syntaxError:ie,code:K}),o.a.createElement(O,{matchingParenthesis:ye}),o.a.createElement(P.a,{library:pe,setLibrary:de,doc:p,effect:u,selectedChoice:ge,choosePossibility:me,scrollTop:ue,input:M,setPossibilities:be,possibilities:ve})),U||L?"":o.a.createElement("div",{className:"script-toolbar"},o.a.createElement("div",{className:"load-script-btn",onClick:function(){return J(!0)}},"Load"),o.a.createElement("div",{className:"save-script-btn",onClick:function(){return B(!0)}},"Save"),o.a.createElement("div",{className:Se,onClick:we},o.a.createElement("div",{className:"arrow-right"}),o.a.createElement("span",null,"Run"))),o.a.createElement(y,{effect:u}),o.a.createElement(m,{sequencerEngine:l,effect:u}),o.a.createElement("div",{className:"log-display"},xe)))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(846),f=n(377),h=n(39),p=n.n(h),d=n(89);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var v=function(e){Object(i.a)(n,e);var t=m(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"handleModeChange",value:function(e){this.state.effect.mode=e.value,this.setState(this.state)}},{key:"handleFactorChange",value:function(e){this.state.effect.rollFactor=e.value,this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){var e,t=this;void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"lfo-rate-dropdown roll-factor"},u.a.createElement("div",{className:"lfo-rate-label"},"Mode:"),u.a.createElement(p.a,{className:"osc-type-dropdown roll-factor-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:y,onChange:function(e){return t.handleModeChange(e)},value:(e=this.state.effect.mode,y.filter(function(t){return t.value===e})[0]),placeholder:"Rate"}),u.a.createElement("div",{className:"clear-fix"})),u.a.createElement("div",{className:"lfo-rate-dropdown roll-factor"},u.a.createElement("div",{className:"lfo-rate-label"},"Roll Factor:"),u.a.createElement(p.a,{className:"osc-type-dropdown roll-factor-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:b,onChange:function(e){return t.handleFactorChange(e)},value:g(this.state.effect.rollFactor),placeholder:"Rate"}),u.a.createElement("div",{className:"clear-fix"}))):"")}}]),n}(c.Component),b=[{value:.125,label:"1/8"},{value:.25,label:"1/4"},{value:.5,label:"1/2"},{value:1,label:"1"},{value:2,label:"2"},{value:4,label:"4"},{value:8,label:"8"}];function g(e){return b.filter(function(t){return t.value===e})[0]}var y=[{value:d.g,label:"Sync"},{value:d.b,label:"On"},{value:d.a,label:"Off"}];var k=v,O=n(11),j=n(90),w=n.n(j),E=n(12),S=(Object(E.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=Object(c.useState)(t.randomness),r=Object(O.a)(n,2),a=r[0],i=r[1],o=Object(c.useCallback)(function(e){var n=e.target.value;t.randomness=n,i(n)},[i]);return u.a.createElement("div",{className:"auto-map-settings"},u.a.createElement("div",{className:"randomness"},"Randomness: ",a),u.a.createElement(w.a,{value:a,change:o,step:.1,max:100,min:0,orientation:"horizontal",reversed:!1}))}),n(847)),P=Object(E.b)(function(e,t){return{len:t.macro.subMacros.length}},function(e){return{}})(function(e){var t=e.macro,n=Object(c.useState)(t.name),r=Object(O.a)(n,2),a=r[0],i=r[1],o=Object(c.useState)(!1),s=Object(O.a)(o,2),l=s[0],f=s[1],h=Object(c.useCallback)(function(e){i(e.target.value),t.name=e.target.value},[i,t]),p=Object(c.useCallback)(function(e){"Enter"===e.key&&f(!1)},[f]);return u.a.createElement("div",{className:"macro-details"},l?u.a.createElement("input",{type:"text",value:a,onKeyUp:p,onChange:h}):u.a.createElement("div",{onClick:function(){return f(!0)},className:"macro-name"},t.name),t.subMacros.map(function(e){return u.a.createElement(S.a,{macro:t,subMacro:e})}))});function x(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e){var t,n=e.effect,r=0,a=x(n.macros);try{for(a.s();!(t=a.n()).done;){r+=t.value.subMacros.length}}catch(i){a.e(i)}finally{a.f()}return u.a.createElement("div",{className:"effect-details"},0===r?u.a.createElement("div",{className:"macros-details-title"},"Macros"):"",0===r?u.a.createElement("div",{className:"no-macros-text"},"You haven't set any macros yet."):"",n.macros.filter(function(e){return e.subMacros.length>0}).map(function(e){return u.a.createElement(P,{macro:e})}))},N=n(887),R=n(6),M=n(148),A=new(n(29).a),q=Object(E.b)(function(e){return{isMacroMapping:e.effects.isMacroMapping,parameterToMap:e.effects.isMacroMapping&&e.effects.parameterToMap}},function(e){return{setIsMacroMapping:function(t){return e(Object(R.Ec)(t))}}})(function(e){var t=e.macro,n=e.parameterToMap,r=e.isMacroMapping,a=e.setIsMacroMapping,i=e.scrollContainer,o=t.macroParameter,s=t.name,l=Object(c.useState)(n&&t.isParameterMapped(n)),f=Object(O.a)(l,2),h=f[0],p=f[1];Object(c.useEffect)(function(){p(!!n&&t.isParameterMapped(n))},[n,p]);var d=Object(c.useCallback)(function(){r&&n&&(h?t.unmapParameter(n):t.addParameter(n),p(!h),a(!1),a(!0))},[n,p,h,r]);return u.a.createElement("div",{className:"macro-knob"},u.a.createElement("div",{className:"macro-name"},s),u.a.createElement(M.a,{scrollContainer:i,color:A.getColorForHash(t.id),parameter:o}),r?u.a.createElement("div",{onClick:d,className:h?"unmap map-button":"map-button"},h?"Unmap":"Map"):"")}),D=(n(1382),Object(E.b)(function(e,t){return{isMacroMapping:e.effects.isMacroMapping}},function(e){return{}})(function(e){var t=e.effect,n=e.scrollContainer,r=e.isMacroMapping,a=Object(c.useState)(!1),i=Object(O.a)(a,2);i[0],i[1],Object(c.useCallback)(function(){t.generateMappings()},[t]);if(!t.isEnabled())return u.a.createElement("div",null);var o=t.macros.map(function(e){return e.macroParameter});return u.a.createElement("div",{className:"macros-effect"},u.a.createElement("div",{className:"macros-container"},t.macros.map(function(e){return u.a.createElement(q,{key:e.id,scrollContainer:n,macro:e})})),u.a.createElement(N.a,{effect:t,width:280,sequencerEngine:t.track.sequencerEngine,color:"red",parameters:o}),r?u.a.createElement(C,{effect:t}):"")})),I=n(22),_=n(163),F=Object(E.b)(function(e,t){return{direction:t.effect.direction}},function(e){return{}})(function(e){var t=e.effect,n=e.direction,r=e.sequencerEngine,a=[{label:"Forward",value:_.b},{label:"Reverse",value:_.d},{label:"Forward-Reverse",value:_.c},{label:"Brownian",value:_.a}],i=Object(c.useCallback)(function(e){t.directionParameter.set(e.value,void 0,void 0)},[t]);return u.a.createElement("div",null,u.a.createElement("div",{className:"direction-parameter"},u.a.createElement("div",{className:"parameter-label"},"Direction:"),u.a.createElement(p.a,{className:"osc-type-dropdown float-left",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:a,onChange:i,value:a.find(function(e){return e.value===n}),placeholder:"Direction"})),n!==_.a?u.a.createElement("div",null,u.a.createElement(I.a,{name:"Speed",parameter:t.speedFactorParameter,onParameterChanged:function(){return[]},isParameter:!0,sequencerEngine:r,lfoEnabled:!0,unit:"x",step:.25,min:.25,max:window.isNFT?1:4}),u.a.createElement("div",{className:"offset-parameter"},u.a.createElement(I.a,{name:"Offset",parameter:t.offsetParameter,onParameterChanged:function(){return[]},isParameter:!0,sequencerEngine:r,lfoEnabled:!0,unit:"x",step:1,min:0,max:16}))):u.a.createElement(I.a,{name:"Walk",parameter:t.walkParameter,onParameterChanged:function(){return[]},isParameter:!0,sequencerEngine:r,lfoEnabled:!0,unit:"Steps (1/32th)",step:1,min:1,max:16}))}),L=n(9),B=n(1383),z=(Object(E.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.palette,r=t.track.getAllParameters().filter(function(e){return n in e.paletteToValue});return u.a.createElement("div",{className:"palette-details"},r.map(function(e){return u.a.createElement(I.a,{key:e.id,name:Object(B.a)(e),min:e.min,max:e.max,sequencerEngine:t.track.sequencerEngine,step:.01,isParameter:!0,parameter:e})}))}),n(383)),V=function(e){var t=e.selectedPalette,n=e.palette,r=e.onChoose,a=t===n?"selected palette-option":"palette-option",i={backgroundColor:z.a[n]};return u.a.createElement("div",{style:i,onClick:function(){return r(n)},className:a},n+1)},H=Object(E.b)(function(e,t){var n=e.effects.sequencedPalettes[t.effect.track.id],r=e.effects.selectedPalettes[t.effect.track.id];return{selectedPalette:void 0!==r?r:n}},function(e){return{setSelectedPalette:function(t,n){return e(Object(R.gf)(t,n))}}})(function(e){var t=e.effect,n=e.selectedPalette,r=(e.setSelectedPalette,Object(c.useState)(Object(L.a)(t.palettes))),a=Object(O.a)(r,2),i=a[0],o=a[1],s=Object(c.useCallback)(function(){t.newPalette(),o(Object(L.a)(t.palettes))},[o]),l=Object(c.useCallback)(function(e){e===n&&(e=void 0),t.switchToPalette(e,n,void 0,!0)},[t,n]);return u.a.createElement("div",{className:"palettes-effect"},u.a.createElement("div",{className:"palettes-container"},i.map(function(e){return u.a.createElement(V,{onChoose:l,selectedPalette:n,palette:e})}),u.a.createElement("div",{onClick:s,className:"new-palette-btn"},"+")))});function U(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var J=function(e){Object(i.a)(n,e);var t=U(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"getEffectChild",value:function(){switch(this.props.effect.effect){case d.f:return u.a.createElement(k,this.props);case d.c:return u.a.createElement(D,this.props);case d.d:return u.a.createElement(H,this.props);case d.e:return u.a.createElement(F,this.props);default:return""}}},{key:"getMacroMapButton",value:function(){return u.a.createElement(l.a,null)}},{key:"render",value:function(){var e=this;return u.a.createElement(f.a,Object.assign({},this.props,{onDeleteEffect:this.props.onDeleteEffect,effectClass:this.props.effect.name,sequencerEngine:this.props.sequencerEngine,isLiveEffect:!0,alternateButton:this.props.effect.effect===d.c?this.getMacroMapButton():void 0,effectNumber:this.props.effectNumber,onToggle:function(){return e.setState(e.state)},track:this.props.track,effect:this.props.effect,automation:this.props.automation}),this.getEffectChild())}}]),n}(c.Component);t.a=J},function(e,t,n){"use strict";var r=n(8),a=n(9),i=n(2),o=n(4),s=n(16),c=n(7),u=n(10),l=n(1),f=n(15),h=n.n(f),p=n(45),d=new(function(){function e(){Object(i.a)(this,e),this.lfos=[]}return Object(o.a)(e,[{key:"useLFO",value:function(){return 0!==this.lfos.length&&window.explore?this.lfos.pop():new h.a.LFO(0,-100,100)}},{key:"releaseLFO",value:function(e){window.explore?(e.disconnect(),this.lfos.push(e)):e.dispose()}}]),e}()),m=new(function(){function e(){Object(i.a)(this,e),this.chains=[]}return Object(o.a)(e,[{key:"useChain",value:function(e,t){var n=void 0;this.chains.length>0&&!t.isOffline?n=this.chains.pop():n=[new h.a.Normalize(-100,100),new h.a.Scale(e.min,e.max),new h.a.Gain(1)];return n[1].min=e.min,n[1].max=e.max,n}},{key:"disposeChain",value:function(e){e.forEach(function(e){return e.dispose()})}},{key:"releaseChain",value:function(e,t){if(t.isOffline)this.disposeChain(e);else{if(this.chains.length>=50){var n=this.chains[0];this.disposeChain(n),this.chains=this.chains.slice(1)}this.chains.push(e)}}}]),e}()),v=n(23),b=n(32),g=n(131),y=n(162),k=n(41);function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var j=[{value:"1n",label:"1"},{value:"2n",label:"1/2"},{value:"4n",label:"1/4"},{value:"4t",label:"1/4t"},{value:"8n",label:"1/8"},{value:"8n.",label:"1/8."},{value:"8t",label:"1/8t"},{value:"16n",label:"1/16"},{value:"16t",label:"1/16t"},{value:"32n",label:"1/32"}],w=function(e){Object(c.a)(n,e);var t=O(n);function n(e,r,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object(i.a)(this,n),t.call(this,e,r,a,o)}return Object(o.a)(n,[{key:"toSeconds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new h.a.Time(this.get(t,e)).toSeconds()}},{key:"toFrequency",value:function(){return new h.a.Time(this.get()).toFrequency()}},{key:"toString",value:function(){return new h.a.Time(this.get()).toString()}},{key:"quantize",value:function(e){e=new h.a.Frequency(e);var t=1e5,n=void 0;for(var r in j){var a=new h.a.Time(j[r].value),i=Math.abs(a.toFrequency()-e.toFrequency());i<t&&(t=i,n=a)}return n}}]),n}(k.a),E=n(819),S=n(21);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var x=n(62),T=n(820),C=n(6);function N(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var A=function(e){Object(c.a)(n,e);var t=M(n);function n(e,r,a,o){var s;return Object(i.a)(this,n),(s=t.call(this,e,r,a,o)).id=Object(p.uuid)(),s.lastValue=void 0,s.lastStep=void 0,s.number=o,s.rawLFORate=void 0,s.mixSession=r,s.lfo=d.useLFO(),s.setupLFOParameters(),s.isSynced=!0,s.state="stopped",e.dispatch(Object(C.Vb)(s.initialBulkValues)),s}return Object(o.a)(n,[{key:"getType",value:function(){return"LFO"}},{key:"dispose",value:function(){if(this.lfo){for(var e in d.releaseLFO(this.lfo),this.parameterIdToVoiceToNode){var t=this.parameterIdToVoiceToNode[e];for(var n in t){var r=t[n];r.slice(0,r.length-1).filter(function(e){return e.dispose&&e.input}).forEach(function(e){e.dispose()})}}this.parameterIdToVoiceToNode=void 0,this.lfo=void 0,this.lfoRateParameter=void 0,this.lfoMinParameter=void 0,this.lfoMaxParameter=void 0,this.lfoPhaseParameter=void 0,this.lfoAmpParameter=void 0}}},{key:"getDepthFromChain",value:function(e){return e[2]}},{key:"getScaleFromChain",value:function(e){return e[1]}},{key:"startTime",get:function(){return this._startTime},set:function(e){this._startTime=e}},{key:"start",value:function(e){this.stop(),h.a.Master.context.isOffline?void 0!==e?this.lfo.start(h.a.Master.context._currentTime+e+1e-5):this.lfo.start(h.a.Master.context._currentTime+1e-5):this.lfo.start(h.a.Master.context.isOffline?h.a.Master.context._currentTime+e:e),this.state="started",this.lfo.lfoType=this.lfoType,this.startTime=e||h.a.Master.context.currentTime,this.stoppedTime=void 0}},{key:"stop",value:function(){this.lfo.stop(),this.state="stopped",this.stoppedTime=h.a.Master.context.isOffline?h.a.Master.context._currentTime:h.a.Master.context.currentTime}},{key:"getModulator",value:function(){return this.lfo}},{key:"getChain",value:function(e,t){return[].concat(Object(a.a)(m.useChain(e,this.sequencerEngine)),[t])}},{key:"releaseChain",value:function(e){m.releaseChain(e.slice(0,e.length-1),this.sequencerEngine)}},{key:"connect",value:function(e,t,r){if(void 0!==e){var a=e;e.input&&!Array.isArray(e.input)&&(a=e.input);Object(s.a)(Object(l.a)(n.prototype),"connect",this).call(this,a,t,r);"stopped"===this.state&&this.start()}else{var i=new E.a(t.min,t.max);this.parameterToScaler[t.id]=i}}},{key:"setupLFOParameters",value:function(){var e=this;this.lfoTypeParameter=new S.a("LFO Type",this,function(t,n){e.stop(),e.lfo.type=n||"sine",e.start()},{min:0,max:1,defaultValue:"sine",automatable:!1}),this.registerParameter(this.lfoTypeParameter);this.number;this.lfoRateParameter=new w("LFO Rate",this.lfo.frequency,function(t,n){e.lfo.frequency.input&&(e.lfo.frequency.value=new h.a.Frequency(n))},{min:0,max:800,unit:"",defaultValue:Math.pow(2,5-this.number)+"n"}),this.registerParameter(this.lfoRateParameter),this.lfoMinParameter=new k.a("LFO Min",this.lfo._scaler._add,function(t,n){e.lfo._scaler._add.input&&(e.lfo.min=n)},{min:-100,max:100,unit:"",defaultValue:-100}),this.registerParameter(this.lfoMinParameter),this.lfoMaxParameter=new k.a("LFO Max",this.lfo._scaler._scale,function(t,n){e.lfo._scaler._scale.input&&(e.lfo.max=n)},{min:-100,max:100,unit:"",defaultValue:100}),this.registerParameter(this.lfoMaxParameter),this.lfoAmpParameter=new k.a("LFO Amplitude",this.lfo.amplitude,function(t,n){e.lfo.amplitude.input&&(e.lfo.amplitude.value=n)},{min:0,max:1,unit:"",defaultValue:1,automationRate:g.a}),this.registerParameter(this.lfoAmpParameter),this.lfoPhaseParameter=new S.a("LFO Phase",this,function(t,n){e.lfo.frequency.input&&(e.lfo.phase=n)},{min:0,max:360,unit:"",defaultValue:0}),this.registerParameter(this.lfoPhaseParameter)}},{key:"registerParameter",value:function(e){this.initialBulkValues=Object(r.a)({},this.initialBulkValues,e.setStore(this.store)),e.setMixSession(this.mixSession),e.setContext(this.context),this.parameters.push(e)}},{key:"name",get:function(){return"LFO "+this.number}},{key:"lfoType",get:function(){return void 0===this.lfoTypeParameter?"sine":this.lfoTypeParameter.get()},set:function(e){this.lfoTypeParameter.set(e,!1)}},{key:"lfoRate",get:function(){return this.lfoRateParameter.get(!0)},set:function(e){this.lfoRateParameter.set(e,!1),this.rawLFORate=e}},{key:"lfoMin",get:function(){return this.lfoMinParameter.get()},set:function(e){this.lfoMinParameter.set(e)}},{key:"parameterHasCycle",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(a>6)return!0;if(t){if(e.lfos.includes(this)||e.lfos.includes(n))return!0}else t=e;var i,o=N(e.lfos);try{var s=function(){var e=i.value;if(e.parameters.some(function(n){return r.parameterHasCycle(n,t,e,a++)}))return{v:!0}};for(o.s();!(i=o.n()).done;){var c=s();if("object"===typeof c)return c.v}}catch(u){o.e(u)}finally{o.f()}return!1}},{key:"lfoMax",get:function(){return this.lfoMaxParameter.get()},set:function(e){this.lfoMaxParameter.set(e)}},{key:"lfoPhase",get:function(){return this.lfoPhaseParameter.get()},set:function(e){this.lfoPhaseParameter.set(e)}},{key:"onBPMUpdated",value:function(){var e=this.lfoRateParameter.get(!0);this.lfoRateParameter.set(e,!0,!0)}},{key:"getJson",value:function(e){var t=this.lfoRate;return"number"!==typeof t&&void 0!==this.rawLFORate&&(t=this.rawLFORate),{id:this.id,lfoRateParameter:this.lfoRateParameter.getJson(e),lfoRate:t,lfoMinParameter:this.lfoMinParameter.getJson(e),lfoMaxParameter:this.lfoMaxParameter.getJson(e),lfoTypeParameter:this.lfoTypeParameter.getJson(e),lfoAmpParameter:this.lfoAmpParameter.getJson(e),lfoPhaseParameter:this.lfoPhaseParameter.getJson(e),isSynced:this.isSynced}}},{key:"fromJson",value:function(e,t){var n="started"===this.lfo.state;n&&this.stop(),!t&&e.id&&(this.id=e.id);var a=Object(r.a)({},Object(v.a)(e,"lfoRateParameter",this.lfoRateParameter,this.sequencerEngine,t));return"isSynced"in e&&(this.isSynced=e.isSynced),"lfoRate"in e&&(Object(x.a)(e.lfoRate)&&this.isSynced?Object(b.a)(this.lfoRateParameter,new h.a.Time(1/e.lfoRate).toNotation(),a):Object(b.a)(this.lfoRateParameter,e.lfoRate,a)),"lfoMinParameter"in e&&(a=Object(r.a)({},a,Object(v.a)(e,"lfoMinParameter",this.lfoMinParameter,this.sequencerEngine,t))),"lfoMin"in e&&Object(b.a)(this.lfoMinParameter,e.lfoMin,a),"lfoMaxParameter"in e&&(a=Object(r.a)({},a,Object(v.a)(e,"lfoMaxParameter",this.lfoMaxParameter,this.sequencerEngine,t))),"lfoMax"in e&&Object(b.a)(this.lfoMaxParameter,e.lfoMax,a),a=Object(r.a)({},a,Object(v.a)(e,"lfoTypeParameter",this.lfoTypeParameter,this.sequencerEngine,t),Object(v.a)(e,"lfoAmpParameter",this.lfoAmpParameter,this.sequencerEngine,t)),"lfoType"in e&&Object(b.a)(this.lfoTypeParameter,e.lfoType,a),"lfoPhaseParameter"in e&&(a=Object(r.a)({},a,Object(v.a)(e,"lfoPhaseParameter",this.lfoPhaseParameter,this.sequencerEngine,t))),"lfoPhase"in e&&Object(b.a)(this.lfoPhaseParameter,e.lfoPhase,a),n&&this.start(),a}},{key:"copyFrom",value:function(e){this.lfoType=e.lfoType,this.lfoRate=e.lfoRate,this.lfoMin=e.lfoMin,this.lfoMax=e.lfoMax,this.lfoPhase=e.lfoPhase,this.isSynced=e.isSynced}},{key:"mateJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;Object(y.a)(t)&&(this.lfoTypeParameter.disconnectFromAllModulators(),this.lfoTypeParameter.fromJson(e.lfoTypeParameter,this.sequencerEngine)),Object(y.a)(t)&&(this.lfoRateParameter.disconnectFromAllModulators(),this.lfoRate=e.lfoRate,this.lfoRateParameter.fromJson(e.lfoRateParameter,this.sequencerEngine)),Object(y.a)(t)&&(this.lfoMinParameter.disconnectFromAllModulators(),this.lfoMinParameter.fromJson(e.lfoMinParameter,this.sequencerEngine)),Object(y.a)(t)&&(this.lfoMaxParameter.disconnectFromAllModulators(),this.lfoMaxParameter.fromJson(e.lfoMaxParameter,this.sequencerEngine)),Object(y.a)(t)&&(this.lfoPhaseParameter.disconnectFromAllModulators(),this.lfoPhaseParameter.fromJson(e.lfoPhaseParameter,this.sequencerEngine))}},{key:"getCopy",value:function(){var e=new n(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,this.mixSession,this.context,this.number);return e.fromJson(this.getJson()),e}}]),n}(function(e){Object(c.a)(n,e);var t=P(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getValue",value:function(e){var t=this.lfoRateParameter.toSeconds(e+1),n=this.sequencerEngine.nextTimeScheduled;if(this.stoppedTime)return 0;var r=t*(this.lfoPhaseParameter.get(!1,e+1)/360),a=((n-=this.startTime)-r)/t,i=this.lfoMaxParameter.get(!1,e+1),o=this.lfoMinParameter.get(!1,e+1),s=(i-o)/2,c=(i+o)/2,u=0;switch(this.lfoType){case"sine":u=this.getSineValue(a,s,c);break;case"square":u=this.getSquareValue(a);break;case"triangle":u=this.getTriangleValue(a,s,c);break;case"sawtooth":u=this.getSawtoothValue(a,s,c)}return isNaN(u)?0:u}},{key:"getSineValue",value:function(e,t,n){return t*Math.sin(e*(2*Math.PI))+n}},{key:"getTriangleValue",value:function(e,t,n){return n+t*Math.asin(Math.sin(e*(Math.PI/2)*Math.PI))}},{key:"getSawtoothValue",value:function(e,t,n){return this.lfoMin+t*(.5*function(e){return Math.PI/2-Math.atan(e)}((r=e*Math.PI,1/Math.tan(r))));var r}},{key:"getSquareValue",value:function(e){return Math.sin(e*(2*Math.PI))<=0?this.lfoMin:this.lfoMax}}]),n}(T.a));t.a=A},function(e,t,n){"use strict";var r=n(11),a=n(99),i=n(0),o=n.n(i),s=n(12),c=n(129),u=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.color,n=e.onChange,r=(e.instrument,e.option),a=e.isSelected,i={};return a&&(i.backgroundColor=t),o.a.createElement("div",{style:i,onClick:function(){return n(r)},className:a?"envelope-option selected":"envelope-option"},r)}),l=n(253),f=n(22),h=(n(733),n(39),n(2)),p=n(4),d=n(7),m=n(10),v=n(1);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(v.a)(e);if(t){var a=Object(v.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}i.Component;var g=n(38),y=n(1049);function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(v.a)(e);if(t){var a=Object(v.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}i.Component,t.a=Object(s.b)(function(e,t){return{selectedParameter:e.effects.accumulatorParameterSelected,selectedFMEnvelopeType:e.instruments.selectedFMEnvelopeType}},null)(function(e){var t=e.selectedFMEnvelopeType,n=Object(a.a)(e,["selectedFMEnvelopeType"]),s=Object(i.useState)(t||"Amp"),c=Object(r.a)(s,2),h=c[0],p=c[1];Object(i.useEffect)(function(){t&&p(t)},[p,t]);var d=n.instrument,m={};if(void 0===d.oscillatorNodes[1]||void 0===d.oscillatorNodes[2]||void 0===d.oscillatorNodes[3])return o.a.createElement("div",null);switch(h){case"Amp":m.Amp=d.ampEnvelope,m.hasRelease=!0;break;case"Mods":d.oscillatorNodes[1].enabled&&(m.A=d.oscillatorNodes[1].ampEnvelope),d.oscillatorNodes[2].enabled&&(m.B1=d.oscillatorNodes[2].ampEnvelope),d.oscillatorNodes[3].enabled&&(m.B2=d.oscillatorNodes[3].ampEnvelope),m.hasRelease=!1;break;case"Filter":m["Low-pass"]=d.filterEnvelope,m["Hi-pass"]=d.hpFilterEnvelope,m.hasRelease=!0,m.hasDepth=!0;break;case"Pitch":m.Pitch=d.pitchEnvelope,m.hasRelease=!0,m.hasDepth=!0}return Object(i.useEffect)(function(){if(n.selectedParameter){var e=n.selectedParameter.context;if(!e)return;if(e.subDevice){var t=e.subDevice;t===d.pitchEnvelope?p("Pitch"):t===d.filterEnvelope||t===d.hpFilterEnvelope?p("Filter"):d.oscillatorNodes.slice(1).some(function(e){return e.ampEnvelope===t})?p("Mods"):d.ampEnvelope===t&&p("Amp")}}},[n.selectedParameter,p]),o.a.createElement("div",{className:"envelopes-component"},o.a.createElement("div",{className:"envelope-options"},["Amp","Mods","Filter","Pitch"].map(function(e){return o.a.createElement(u,{key:e,instrument:d,onChange:function(e){return p(e)},option:e,isSelected:h===e})})),o.a.createElement("div",{className:"clear-fix"}),Object.keys(m).filter(function(e){return"hasRelease"!==e&&"hasDepth"!==e}).map(function(e,t){return o.a.createElement("div",{key:e+t},o.a.createElement(l.a,{instrument:d,key:e+t,width:200,fillColor:n.color,lineColor:n.color,sequencerEngine:n.sequencerEngine,envelope:m[e],name:e,hasRelease:m.hasRelease,hasLevel:!1}),m.hasDepth?o.a.createElement(f.a,{parameter:m[e].levelParameter,sequencerEngine:n.sequencerEngine,isParameter:!0,name:"Env Depth",max:1,min:-1,step:.01}):"")}))})},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(20),s=n(7),c=n(10),u=n(1),l=n(0),f=n.n(l),h=n(699),p=n(844),d=n(34),m=n(76),v=n(12),b=Object(v.b)(function(e,t){return{locked:t.effect.locked}},function(e){return{}})(function(e){var t=e.togglePresets,n=(e.setContextualHelp,e.showPresets),r=e.effect,a=e.locked,i=Object(l.useCallback)(function(){r.lock=!a},[r,a]);return f.a.createElement(m.a,{element:n?d.x:d.w,className:"bottom-effect-toolbar"},f.a.createElement("img",{onClick:i,src:a?"/closed-padlock.png":"/opened-padlock.png",className:"effect-lock"}),f.a.createElement("img",{onClick:t,src:"/floppy-disk.svg",className:n?"load-preset-button selected":"load-preset-button"}))}),g=n(29),y=(n(71),n(6)),k=(n(2440),n(845)),O=n(46),j=n(210),w=(n(897),n(38));n(2444);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var S=new g.a,P=function(e){Object(s.a)(n,e);var t=E(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={showMods:!1,isCollapsed:e.isMixCollapsed||e.isCollapsed,isDraggable:void 0===e.isDraggable||e.isDraggable,showPresets:!1},r.togglePresets=r.togglePresets.bind(Object(o.a)(r)),r}return Object(i.a)(n,[{key:"togglePresets",value:function(){this.setState({showPresets:!this.state.showPresets})}},{key:"shouldComponentUpdate",value:function(e){return e.isCollapsed!==this.props.isCollapsed&&(this.state.isCollapsed=e.isCollapsed),!0}},{key:"toggleCollapsed",value:function(){this.props.effect.isEnabled()&&this.props.setEffectCollapsed(this.props.effect.id,!this.state.isCollapsed)}},{key:"deleteEffect",value:function(){(!this.props.instrument&&!this.props.isPulled||this.props.effect.track&&this.props.effect.track.tracks)&&this.operationManager.dispatch(Object(O.e)(this.props.effect,this.props.track,this.props.group,this.props.send)),this.props.onDeleteEffect&&this.props.onDeleteEffect(this.props.effect)}},{key:"handleToggle",value:function(){this.operationManager.dispatch(Object(O.s)(this.props.effect,this.props.track,this.props.group,this.props.send)),this.props.onToggle()}},{key:"getTrackOrGroup",value:function(){return this.props.send||this.props.track||this.props.group}},{key:"operationManager",get:function(){return this.props.sequencerEngine.operationManager}},{key:"getContextNumber",value:function(){return void 0!==this.props.track?this.props.track.trackNumber:void 0!==this.props.group?this.props.group.groupNumber:1}},{key:"onDragStart",value:function(e){if(this.state.isDraggable&&!this.props.automation&&this.getTrackOrGroup()){var t=this.getTrackOrGroup().getEffectNumber(this.props.effect,this.props.isMidiEffect);this.props.isLiveEffect||this.props.isMidiEffect?(this.props.clearDragDrop(),this.props.dragMidiEffect({number:this.getContextNumber(),effectNumber:t,effect:this.props.effect})):(this.props.clearDragDrop(),this.props.dragEffect({number:this.getContextNumber(),effectNumber:t,effect:this.props.effect}))}}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"onDragOver",value:function(e){this.state.isDraggable&&e.preventDefault()}},{key:"onDrop",value:function(e){if(this.props.featured){var t=this.props.effectDragging||this.props.midiEffectDragging;if(!t)return;return function(e,t,n){if(e!==t){var a,i=n.state.effects.pulledEffects,o=n.state.effects.pulledEffects.indexOf(e),s=n.state.effects.pulledEffects.indexOf(t);s>o?(a=[].concat(Object(r.a)(i.slice(0,o)),[t],Object(r.a)(i.slice(o,s))),i.length>s+1&&(a=[].concat(Object(r.a)(a),Object(r.a)(i.slice(s+1))))):(a=[].concat(Object(r.a)(i.slice(0,s)),Object(r.a)(i.slice(s+1,o)),[e,t]),i.length>o+1&&(a=[].concat(Object(r.a)(a),Object(r.a)(i.slice(o+1))))),n.dispatch(Object(y.we)(a))}}(this.props.effect,t.effect,this.props.sequencerEngine),this.props.dragEffect(void 0),void this.props.dragMidiEffect(void 0)}if(this.state.isDraggable&&!this.props.automation&&this.getTrackOrGroup()){if(void 0!==this.props.effectDragging){var n=this.getTrackOrGroup().getEffectNumber(this.props.effect,this.props.isMidiEffect);if(this.props.isMidiEffect)return void this.props.dragEffect(void 0);this.props.effectDragging.number===this.getContextNumber()&&this.operationManager.dispatch(Object(O.l)(this.props.effectDragging.effectNumber,n,!1,this.props.track,this.props.group,this.props.send)),this.props.dragEffect(void 0)}else{if(void 0===this.props.midiEffectDragging)return;var a=this.getTrackOrGroup().getEffectNumber(this.props.effect,this.props.isMidiEffect);this.props.isMidiEffect&&this.props.midiEffectDragging.number===this.getContextNumber()&&this.operationManager.dispatch(Object(O.l)(this.props.midiEffectDragging.effectNumber,a,!0,this.props.track,this.props.group,this.props.send)),this.props.dragMidiEffect(void 0),this.props.dragEffect(void 0)}this.props.onDeleteEffect()}}},{key:"getClassName",value:function(e){return this.props.effect.isEnabled()?e:e+" disabled"}},{key:"detachEffect",value:function(e){var t=this.props.sequencerEngine.state,n=[].concat(Object(r.a)(t.effects.pulledEffects),[this.props.effect]);this.props.setPulledEffects(n)}},{key:"selectEffect",value:function(e){if(e.stopPropagation(),this.props.linkingEffects)return this.props.linkingEffects.effect.linkedEffect=this.props.effect,void this.props.setLinkingEffects(void 0);this.props.planeMapping&&this.props.planeMapping!==this.props.effect&&(this.setState({isMapped:!0}),this.props.planeMapping.randomlyMapParameters(this.props.effect))}},{key:"render",value:function(){var e=this;if(!this.props.effect.name)return"";var t=this.props.isTall?"tall-effect effect":"effect";this.props.effectClass&&(t+=" "+this.props.effectClass);var n=void 0!==this.props.automation?"enabled "+t+" effect-automation":this.props.effect.isEnabled()?t+" enabled":"effect disabled";this.props.isSelectedZObject&&(n+=" selected-zobject");var r=!1;this.props.effect&&this.props.effect.track&&this.props.effect.track.tracks&&(r=!0),n+=" "+this.props.effect.name.split(" ").join("_")+" ",this.state.isCollapsed&&(n+=" collapsed"),this.props.isSelected&&(n+=" selected"),this.props.isMidiEffect&&(n+=" midi"),this.props.isLiveEffect&&(n+=" live"),"Midi Effect Rack"!==this.props.effect.name&&"Effect Rack"!==this.props.effect.name||(n+=" racked"),"Jaki"===this.props.effect.name&&(n+=" Jaki");var a="effect-header";if(this.props.hideBarButtons&&(a+=" hide-buttons"),this.props.planeMapping&&this.props.planeMapping!==this.props.effect&&(this.state.isMapped||(n+=" plane-mapping")),this.props.linkingEffects&&this.props.effect.name===this.props.linkingEffects.name&&(n+=" plane-mapping"),"Message"===this.props.effect.name)return f.a.createElement(p.a,{effect:this.props.effect});if(this.props.isPulled)return n+=" pulled",f.a.createElement("div",{onDragStart:function(t){return e.onDragStart(t)},onDragOver:function(t){return e.onDragOver(t)},onDrop:function(t){e.onDrop(t)},draggable:this.state.isDraggable,className:n},f.a.createElement("div",{className:"effect-header"},this.props.effect.name),f.a.createElement("div",{className:"effect-inner"},f.a.createElement("img",{src:"/detached.svg",className:"detached-icon"}),f.a.createElement("div",{className:"detached-label"},"Detached")));var i=function(){var t=e.props.effect,n=Object(h.a)(t);return n?f.a.createElement("div",{style:{backgroundColor:n.color||S.getColorForTrack(n)},className:"effect-from"},n.envelopesTrack?n.name:n.getName()):""};return this.props.showStar&&(a+=" showing-star"),f.a.createElement("div",{onClick:function(t){return e.selectEffect(t)},onDragStart:function(t){return e.onDragStart(t)},onDragOver:function(t){return e.onDragOver(t)},onDrop:function(t){e.onDrop(t)},draggable:!this.props.noSelect&&this.state.isDraggable,className:n},f.a.createElement("div",{className:a},f.a.createElement(w.a,{condition:!this.props.hideBarButtons},f.a.createElement("div",{onMouseOver:function(t){return e.setContextualHelp(t,d.y)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.handleToggle()},className:"effect-toggle"},f.a.createElement("div",{className:"toggle-icon"})),f.a.createElement("div",{onMouseOver:function(t){return e.setContextualHelp(t,d.t)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.toggleCollapsed()},className:"collapse-toggle"},f.a.createElement(w.a,{condition:this.state.isCollapsed},f.a.createElement("div",{className:"arrow-down"})),f.a.createElement(w.a,{condition:!this.state.isCollapsed},f.a.createElement("div",{className:"arrow-right"})))),f.a.createElement(w.a,{condition:this.props.effect.isEnabled()&&!this.state.isCollapsed},f.a.createElement("div",{className:"effect-name"},this.props.effect.name)),this.props.featured&&i(),this.props.featured?"":f.a.createElement("img",{onClick:function(){return e.detachEffect()},src:"/detached.svg",className:"detach-effect-icon"}),this.props.alternateButton||"",f.a.createElement(w.a,{condition:!this.props.hideBarButtons&&void 0===this.props.automation&&!this.state.isCollapsed},this.props.showStar&&f.a.createElement("div",{onClick:function(){return e.props.setStarred(!e.props.isStarred)},className:this.props.isStarred?"starred star":"star"},f.a.createElement("span",null,"\u2606")),f.a.createElement("div",{onMouseOver:function(t){return e.setContextualHelp(t,d.u)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"effect-delete-btn delete-button",onClick:function(){return e.deleteEffect()}},r||!this.props.featured||this.props.showDelete?"x":"-"))),f.a.createElement(w.a,{condition:this.state.showPresets},f.a.createElement(k.a,{sequencerEngine:this.props.sequencerEngine,trackNumber:this.props.track&&this.props.track.trackNumber,hide:function(){return e.setState({showPresets:!1})},effect:this.props.effect})),f.a.createElement(w.a,{condition:!this.state.showPresets},f.a.createElement("div",{className:"inner-effect"},f.a.createElement(w.a,{condition:!this.props.effect.isEnabled()||this.state.isCollapsed},f.a.createElement("div",{className:"effect-name"},this.props.name||this.props.effect.name),i()),f.a.createElement("div",{className:"clear-fix"}),f.a.createElement(w.a,{condition:this.state.showMods},f.a.createElement(j.a,{parameters:this.props.effect.parameters})),f.a.createElement(w.a,{condition:!this.state.showMods&&!this.state.isCollapsed&&!this.state.showPresets},this.props.children),f.a.createElement("div",{className:"clear-fix"}))),!this.props.isLiveEffect&&f.a.createElement(b,{effect:this.props.effect,togglePresets:this.togglePresets,setContextualHelp:this.props.setContextualHelp,showPresets:this.state.showPresets}))}}]),n}(l.Component);t.a=Object(v.b)(function(e,t){return{planeMapping:e.effects.planeMapping,effectDragging:e.sequencer.effectDragging,midiEffectDragging:e.effects.midiEffectDragging,isCollapsed:e.effects.effectCollapsed[t.effect.id],isSelected:e.effects.selectedEffect===t.effect.id,isEnabled:t.effect.isEnabled(),linkingEffects:e.effects.linkingEffects,isStarred:e.effects.effectStarred[t.effect.id],isSelectedZObject:t.effect===e.zobject.selectedZObject,preset:t.effect.preset}},function(e,t){return{setContextualHelp:function(t){return e(Object(y.ub)(t))},dragEffect:function(t){return e(Object(y.h)(t))},dragMidiEffect:function(t){return e(Object(y.hd)(t))},setEffectCollapsed:function(t,n){return e(Object(y.Tb)(t,n))},setSelectedEffect:function(t){return e(Object(y.Se)(t))},setPulledEffects:function(t){return e(Object(y.we)(t))},setLinkingEffects:function(t){return e(Object(y.Yc)(t))},setStarred:function(n){return e(Object(y.Yb)(t.effect.id,n))},clearDragDrop:function(t){return e(Object(y.b)(t))}}})(P)},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(85),h=n(21),p=n(101);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var m=function(e){Object(c.a)(n,e);var t=d(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Parameterizer",e)).parameter=void 0,r.factorParameter=new h.a("factor",Object(o.a)(r),function(e,t){return t},{documentation:"Multiplies the current value of the parameter by this number",min:0,max:1,unit:"",defaultValue:1}),r.registerParameter(r.factorParameter),r.offsetParameter=new h.a("offset",Object(o.a)(r),function(e,t){return t},{documentation:"Adds the current value of the parameter with this number",min:-100,max:100,unit:"",defaultValue:0}),r.registerParameter(r.offsetParameter),r.probabilityParameter=new h.a("probability",Object(o.a)(r),function(e,t){return t},{documentation:"The probability that a parameter change will occur on a given trigger.",min:0,max:100,unit:"",defaultValue:100}),r.registerParameter(r.probabilityParameter),r}return Object(i.a)(n,[{key:"documentation",get:function(){return["Alters the step parameters for triggers that pass through this effect. "]}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"getVisualizedParameters",value:function(){return[this.offsetParameter]}},{key:"getText",value:function(){var e=Math.round(100*this.offsetParameter.get(!0))/100;return e>0&&(e="+"+e),this.parameter?this.parameter.name+" "+e:e}},{key:"getAvailableParameters",value:function(){return[this.track.trackData.durationParameter,this.track.trackData.chopParameter,this.track.trackData.velocityParameter,this.track.trackData.transposeParameter,this.track.trackData.paletteParameter,this.track.trackData.startParameter,this.track.trackData.attackParameter,this.track.trackData.releaseParameter,this.track.trackData.pitchAttackParameter,this.track.trackData.pitchDecayParameter,this.track.trackData.pitchSustainParameter,this.track.trackData.pitchReleaseParameter]}},{key:"factor",get:function(){return this.factorParameter.get()},set:function(e){this.factorParameter.set(e)}},{key:"offset",get:function(){return this.offsetParameter.get()},set:function(e){this.offsetParameter.set(e)}},{key:"probability",get:function(){return this.probabilityParameter.get()},set:function(e){this.probabilityParameter.set(e)}},{key:"output",value:function(){var e=this;if(void 0===this.parameter)return this.triggers;var t=[],n=function(n){var r=e.triggers[n],a=e.getStep(r.stepData,void 0,void 0,!0),i=a.parameters.filter(function(t){return t.name===e.parameter.name});if(i.length>0){var o=i[0].get();if(null===o)o=e.track.trackData.parameters.find(function(e){return e.name===i[0].name}).get();Math.random()<e.probability/100&&i[0].set(o*e.factor+e.offset)}r=new p.a(a,r.time,r.stepNumber),t.push(r)};for(var r in this.triggers)n(r);return t}},{key:"getJson",value:function(){return Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{parameter:void 0===this.parameter?void 0:this.parameter.name})}},{key:"fromJson",value:function(e,t){var r=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t),a=this.getAvailableParameters();if(void 0!==e.parameter)return this.parameter=a.filter(function(t){return t.name===e.parameter})[0],r}}]),n}(f.a);t.a=m},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i});var r=["EQ Frequency 1 gain","type","EQ Frequency 5 gain","EQ Frequency 8 gain","Pulse Width","algorithm","Chop","Velocity","Slice","Chop Duration","Duration","Transpose","width","speed","Configuration","Feedback","list","Drive","enabled","parametersDisabled","Enabled","blur","pitchBend","Polyphony","phase","stages","smoothness","Custom Oscillator Type","lengthFactor","Curve","Release Curve","Decay Curve","Attack Curve","triplet1","triplet2","triplet3","triplet4","triplet5","triplet6","scale1","scale2","scale3","scale4","scale5","scale6","rule1","rule2","rule3","rule4","rule5","rule6","Oscillator Type","resolution","rolloff","Level","curve","Filter Cutoff (hi-pass)","Filter Q (hi-pass)","Partial Count","LFO Type"],a=["Sustain","Partials","Harmonics","steps","Resolution","Probability","Rate","lengthFactor","resolution","probability","Decay","Attack","Release"],i=function(e,t){return(e.getAllParameters?e.getAllParameters(!1):e.getParameters?e.getParameters():e.parameters).filter(function(e){return e.automatable&&!e.config.isDb}).filter(function(e){return!e.hasMacro}).filter(function(e){return!e.isMapped}).filter(function(e){return!r.includes(e.name)})}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(8),a=function(){var e={},t={};return function(n,a,i,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(void 0===n)return Object.keys(e);if(1===n)return t;var c=[n];s.altName&&c.push(s.altName);for(var u=function(){var n=f[l];if(n in e)return{v:e[n]};s.tags&&(Array.isArray(s.tags)?s.tags.forEach(function(e){t[e]||(t[e]=[]),t[e].push(n)}):(t[s.tags]||(t[s.tags]=[]),t[s.tags].push(n))),e[n]=Object(r.a)({params:a,description:i,outlets:o},s)},l=0,f=c;l<f.length;l++){var h=u();if("object"===typeof h)return h.v}}}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(520),l=n(71),f=n(519);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var p=function(e){Object(o.a)(n,e);var t=h(n);function n(e,a,i){var o;return Object(r.a)(this,n),(o=t.call(this,e,i)).effect=a,o}return Object(a.a)(n,[{key:"subSequence",get:function(){return this.track.tracks?this.track:this.track.subSequence}},{key:"isMidiEffect",value:function(){return!1}},{key:"dispose",value:function(){}},{key:"getParameters",value:function(){return[]}},{key:"getEffectType",value:function(){return l.b}},{key:"getJson",value:function(){var e=Object(i.a)(Object(c.a)(n.prototype),"getJson",this).call(this);return e.effect=this.effect,e}}]),n}(Object(f.a)(u.a));t.a=p},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(9),o=n(14),s=n(11),c=n(0),u=n.n(c),l=n(366),f=n(215),h=n(47),p=n(86),d=n(6),m=n(318),v=n(244),b=n(139),g=n(426),y=n(12);function k(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=Object(y.b)(function(e,t){return{padFXMode:t.node&&e.pads.padFXMode[t.node.id]}},function(e){return{setBulkEffectsCollapsed:function(t){return e(Object(d.db)(t))},setShowingContextMenu:function(t){return e(Object(d.lg)(t))},setWindowPositions:function(t){return e(Object(d.gb)(t))}}})(function(e){var t=e.setWindowPositions,n=e.setBulkEffectsCollapsed,r=e.effect,d=e.initializeEffect,y=e.setShowingContextMenu,O=e.effectOptions,j=e.outputNumber,w=e.addToBack,E=void 0===w||w,S=e.isRoot,P=e.dropdownPosRef,x=e.node,T=e.sequencerEngine,C=void 0===T?x.sequencerEngine:T,N=e.dropdownPos,R=e.scale,M=e.setDropdownPos,A=e.allowSendsOnly,q=e.padFXMode,D=e.isMidi,I=Object(c.useState)([]),_=Object(s.a)(I,2),F=_[0],L=_[1];Object(c.useEffect)(function(){Object(m.a)(D?"Midi Effect Rack":"Effect Rack").then(function(e){var t,n=[],r=k(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push({label:a.title,value:a})}}catch(i){r.e(i)}finally{r.f()}L(n)})},[]);var B=Object(c.useCallback)(function(){x.padFXMode=q===f.b?f.a:f.b},[x,q]),z=Object(c.useCallback)(function(){var e=d("Midi Effect Rack",x);return x.midiEffects.addEffect(e),e},[x]),V=Object(c.useCallback)(function(e){var n=x.effectRack;S&&(P.current.x+=50,P.current.y-=50),D&&((n=x.midiEffects.effects.find(function(e){return"Midi Effect Rack"===e.name}))||(n=z()));var a=d(e,D?x:C);n.x||(n.x=P.current.x-150,n.y=P.current.y,n.outputNode.x=P.current.x+170,n.outputNode.y=P.current.y),S&&(P.current.x-=60),a.x=P.current.x,a.y=P.current.y;var i={};i[a.id]={x:a.x,y:a.y},i[n.id]={x:n.x,y:n.y},t(i),a.needsPlacement=!0,x.addRackEffect(a,E,r,j),M(void 0)},[x,N,M,S]),H=Object(c.useCallback)(function(e){var t=window.prompt("Preset name"),n=x.effectRack.getJson();Object(m.b)(n,t)},[x]),U=Object(c.useCallback)(function(){var e=Object(o.a)(a.a.mark(function e(t){var r,o,s,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=x.effectRack)||(r=z()),Object(i.a)(r.effects),r.clearRack(),o=t.effectHash,e.next=7,h.a.getJson(o);case 7:return s=e.sent,x.updateEffectRedux([]),e.next=11,r.fromJson(s,x.sequencerEngine.tracks,0,!0,!1);case 11:D||x.linkEffectRackContext(),c={},r.effects.forEach(function(e){return c[e.id]=!0}),r.x=P.current.x-350,r.y=P.current.y-100,n(c),u=Math.max.apply(Math,Object(i.a)(r.effects.map(function(e){return e.x}))),r.outputNode.x=u+100,r.outputNode.y=P.current.y,x.updateEffectRedux();case 21:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[x]);return Object(c.useEffect)(function(){y(N)},[N]),u.a.createElement(v.a,{dropdownPos:N?{x:N.x/R,y:N.y/R}:void 0},A&&u.a.createElement(b.a,{onMouseDown:B},"Sends Only",u.a.createElement(l.a,{condition:q===f.b})),u.a.createElement(g.a,{name:"Presets"},u.a.createElement(b.a,{className:"save-preset-item",onClick:H},u.a.createElement("div",null,"Save Preset"),u.a.createElement("img",{src:"/floppy-disk.svg",className:"save-preset-icon"})),F.map(function(e){var t=e.label,n=e.value;return u.a.createElement(b.a,{onMouseDown:function(){return U(n)}},t)})),D?u.a.createElement("div",null,u.a.createElement(g.a,{name:"Standard Midi FX"},u.a.createElement("div",null,p.e.map(function(e){var t=e.label,n=e.value;return u.a.createElement(b.a,{onMouseDown:function(){return V(n)}},t)}))),u.a.createElement(g.a,{name:"Flow Midi FX"},u.a.createElement("div",null,p.d.map(function(e){var t=e.label,n=e.value;return u.a.createElement(b.a,{onMouseDown:function(){return V(n)}},t)})))):u.a.createElement("div",{className:"fx-options"},O.map(function(e){var t=e.label,n=e.value;return u.a.createElement(b.a,{onMouseDown:function(){return V(n)}},t)})))})},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["#ff7759","#ffc782","#f5ff60","#59e800","#ff78ff","#ff2f8f"]},function(e,t,n){"use strict";var r=n(8),a=n(28),i=n(2),o=n(4),s=n(16),c=n(7),u=n(10),l=n(1),f=n(116),h=n(343),p=n(257),d=n(1039),m=n(524),v=n(17),b=function(e,t){return(e%t+t)%t},g=function(){var e=[],t=void 0;return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=r[0],o=r[1],s=r[2],c=r[3];if(!i)return Object(v.w)(!0);t!==o&&(e=[]),t=o;var u=i.transpose,l=u;if(e.includes(b(u-1))&&(l=u-1),e.includes(b(u+1,12))&&(l=u+1),e.push(b(l,12)),u===l)return Object(v.w)(!0);var f=c.getStep(i);return f.transpose=l,Object(v.Q)({stepData:f,time:s,stepNumber:o})}},y=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=r[0],o=r[1],s=r[2],c=r[3];if(!i)return Object(v.w)(!1);var u=c.getStep(i);return u.slide=!0,u.transpose=i.transpose+v.A.apply(void 0,[e].concat(r)),void 0!==t&&(u.duration=v.A.apply(void 0,[t].concat(r))),Object(v.Q)([{stepData:i,stepNumber:o,time:s},{stepData:u,stepNumber:o,time:s}])}},k=n(83),O=n(9),j=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=v.A.apply(void 0,[e].concat(n));if(!n[3])return[0];var i=n[3].track.subSequence,o=i.tracks[a%i.tracks.length].pattern,s=[];for(var c in o.stepBucketsMatrix){var u=o.stepBucketsMatrix[c];for(var l in u.steps)s=[].concat(Object(O.a)(s),Object(O.a)(u.steps[l].getPolyphony().map(function(e){return e.transpose})))}return s}},w=n(551),E=n(389),S=n(48),P=n(390),x=n(105),T=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return v.A.apply(void 0,[e].concat(r))||v.A.apply(void 0,[t].concat(r))}},C=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return v.A.apply(void 0,[e].concat(r))&&v.A.apply(void 0,[t].concat(r))}},N=n(72);Object(N.a)("invert",{octaves:""},"inverts notes by an octave (high notes go down/low notes up)");var R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=0,n=0;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];var o=a[0];if(!o)return Object(v.w)(!1);t+=o.transpose,n++;var s=v.A.apply(void 0,[e].concat(a));return o.transpose<=t/n?Object(m.a)(12*s).apply(void 0,a):Object(m.a)(-12*s).apply(void 0,a)}},M=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var i=r[0],o=r[1],s=r[2];if(!i)return Object(v.w)(!1);var c=v.A.apply(void 0,[e].concat(r)),u=n.map(function(e){return v.A.apply(void 0,[e].concat(r))});return Object(v.Q)({stepData:i,stepNumber:o,time:s,graphics:{type:c,arg:u}})}},A=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return M.apply(void 0,["DRAW"].concat(t))},q=function(e){return M("ERASE",e)};function D(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(N.a)("augment",{delayTime:"",transpose:"",everyTime:"",scriptFunction:"optional",hold:""},"augmentation to theme");var _=function(e,t,n,r,a){var i=[],o=0,s=void 0;return function(){for(var c=arguments.length,u=new Array(c),l=0;l<c;l++)u[l]=arguments[l];var f=u[0],h=u[1],p=u[2],d=u[3];0!==s&&0===h&&(s=void 0);var m=[];if(f&&(s!==h&&void 0!==s&&o++,s=h,void 0===n||o%v.A.apply(void 0,[n].concat(u))===0)){var b=v.A.apply(void 0,[e].concat(u))+1,g={stepData:f,time:p-d.currentTime,delay:b,reference:{}};m.push(g),i.push(g)}var y,k=[],j=[],w=D(i);try{for(w.s();!(y=w.n()).done;){var E=y.value;if(E.delay--,E.delay<=0){var S=d.getStep(E.stepData);if(v.A.apply(void 0,[a].concat(u))?S.duration=1/0:S.duration*=2,void 0!==t){var P=v.A.apply(void 0,[t,S].concat(Object(O.a)(u.slice(1))));S.transpose+=P}var x={stepData:S,time:E.time+d.currentTime,stepNumber:h,reference:E.reference};E.reference.transpose=S.transpose,r?k.push(Object(v.J)(Object(v.Q)(x),r)):k.push(Object(v.Q)(x))}else j.push(E)}}catch(T){w.e(T)}finally{w.f()}return i=j,f&&(f.delays=m),k.push(Object(v.Q)({stepData:f,time:p,stepNumber:h})),v.D.apply(void 0,k)}},F=n(279),L=n(153);Object(N.a)("search",{name:"tag or name to search for"},'Filters out triggers to only tracks of given tag or name (ex: search("kick") returns only kick triggers');var B=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=v.A.apply(void 0,[e].concat(n)),i=n[0];n[1],n[2],n[3];if(i&&i.track){var o=i.track;if(o.instrument){if(o.getName().toLowerCase().includes(a.toLowerCase()))return Object(v.w)(!0)}else if(o.sample.tags.some(function(e){return e.toLowerCase().includes(a.toLowerCase())}))return Object(v.w)(!0)}return Object(v.w)(!1)}};Object(N.a)("loop",{length:"how long to loop",mode:"mode from 0-1"},"Loops triggers at a loop-size. Modes are 0=off 0.5=record 1=play");var z=function(e,t){var n=[],a=0;return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var c=o[2],u=o[1],l=o[3].currentTime,f=Math.round(v.A.apply(void 0,[e].concat(o)));switch(function(e){return e<.33?0:e<.66?.5:1}(v.A.apply(void 0,[t].concat(o)))){case.5:return function(e,t,r){n.push({stepData:e,time:t})}(o[0],c-l),Object(v.w)(!0);case 1:var h=n.length-f,p=a++%f,d=n[h+p];return d.stepData?Object(v.Q)(Object(r.a)({},d,{stepNumber:u,time:c+d.time})):Object(v.w)(!1);default:return Object(v.w)(!0)}}},V=n(790),H=n(15),U=n.n(H),J=n(172),G=new U.a.Time("32n"),W=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r in t)Array.isArray(t[r])&&(t[r]=J.a.apply(void 0,Object(O.a)(t[r])));var a=J.a.apply(void 0,t);return t[0]&&Array.isArray(t[0])&&(a=J.a.apply(void 0,Object(O.a)(t[0]))),function(e,t,n,r){var i=r.currentTime;return i+=G*Object(v.A)(a,e,t,n,r),Object(v.Q)({stepData:e,stepNumber:t,time:i})}},K=function(e){return function(t,n,r,a){return n%(32/e)===0?Object(v.w)(!0):Object(v.w)(!1)}},X=n(348),Q=n(291),Y=n(344),Z=n(789);Object(N.a)("once",{fn:"Function to run once",when:"When to run"},"Runs the function once, after a certain number of triggers (default of 0)");var $=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return a[0]&&n++===v.A.apply(void 0,[t].concat(a))?v.A.apply(void 0,[e].concat(a)):Object(h.b)(a)}},ee=function(){var e=0;return function(){return e++}},te=n(444),ne=new U.a.Time("32n").toSeconds();Object(N.a)("stretch",{amount:"Amount we wish to stretch notes"},"Streches patterns so they take longer to complete");var re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t={};return function(n,a,i,o){o.track.length;var s=Object(v.A)(e,n,a,i,o);if(1===s)return Object(v.Q)({stepData:n,stepNumber:a,time:i});var c=a*s,u=i-o.currentTime;if(n){var l=(c-Math.floor(c))*ne;t[Math.floor(c)]={stepData:n,time:u+l}}if(t[a]){var f=Object(v.Q)(Object(r.a)({},t[a],{stepNumber:a,time:i+t[a].time}));return delete t[a],f}return Object(v.Q)({stepNumber:a,time:i})}},ae=(n(6),n(115)),ie=n(236),oe=n(82),se=n(111),ce=new(n(61).a),ue=function(e,t){var n=void 0;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];a[0],a[1],a[2];var o=v.A.apply(void 0,[t].concat(a));if(!n||o!==n){var s=v.A.apply(void 0,[e].concat(a)),c=v.A.apply(void 0,[t].concat(a));Object(se.b)(s,c),n=c}return Object(v.w)(!0)}},le=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];var o=a[0];a[1],a[2];if(o||!n){var s=v.A.apply(void 0,[e].concat(a)),c=v.A.apply(void 0,[t].concat(a));Object(se.b)(s,c)}return Object(v.w)(!0)}};Object(N.a)("receive",{type:"",fn:"",skipEmpty:""},"Reads messages of given type returning the values");var fe=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=Object(ie.a)(e,!0),i=void 0;return function(){for(var e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];var c=o[0]&&o[0].track?o[0]:void 0;if(c||!n){var u=a();if(t){if(u.length>0&&void 0===c&&r){var l=o[3],f=l.getStep(ce);f.track=l.track,o=[f].concat(Object(O.a)(o.slice(1)))}return u.map(function(e){return"function"===typeof t?v.A.apply(void 0,[t(e)].concat(Object(O.a)(o))):t})[0]||Object(h.b)(o)}var p=0===u.length?i:u;return u.length>0&&(i=u),p[0]}}},he=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(oe.f)("[0]"),n=Object(ie.a)(e,!0),r=void 0;return function(){for(var e=n(),a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];var s=(0===e.length?r:e[0])||v.A.apply(void 0,[t].concat(i));return e.length>0&&(r=e[0]),s}},pe=n(788);function de(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(N.a)("delay",{rate:"The rate in 1/32th notes that it repeats",repeats:"Number of times it repeats"},"Simple midi delay function");var ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[];return function(r,a,i){var o,s=r&&{stepData:r,stepNumber:a,time:i,repeats:Object(v.A)(t,r,a,i)},c=Object(v.A)(e,r||n[0],a,i),u=[],l=[],f=de(n);try{for(f.s();!(o=f.n()).done;){var h=o.value;Math.abs(a-h.stepNumber)%c===0&&(h.repeats--,u.push({stepData:h.stepData,time:i,stepNumber:a})),h.repeats>0&&l.push(h)}}catch(p){f.e(p)}finally{f.f()}return n=l,s&&n.push(s),s||0!==u.length?(s&&(u=[].concat(Object(O.a)(u),[s])),u.length>0?Object(v.Q)(u):Object(v.w)(!1)):Object(v.w)(!1)}};Object(N.a)("range",{len:"The length of the list to be generated",min:"The min value to be used as the first element in the list",max:"The max value to be used as the last element in the list"},"Returns a list of a certain length rising from min to max");var be=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];var o=v.A.apply(void 0,[t].concat(a)),s=v.A.apply(void 0,[n].concat(a)),c=v.A.apply(void 0,[e].concat(a));return Array(e).fill(0).map(function(e,n){return o+n*(s-t)/c})}},ge=n(791),ye=n(255),ke=n(615),Oe=n(792),je=n(101),we=function(e){return function(t,n,r,a){if(!t)return Object(v.w)(!0);var i=a.copyTrigger(new je.a(t,r,n),!0),o=Object(v.A)(e,t,n,r,a),s=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:262,r=arguments.length>3?arguments[3]:void 0;n=new U.a.Frequency(n);var a=Math.floor(e/12),i=e<0?(12-Math.abs(e)%12)%12:e%12,o=r(t[Math.floor(t.length*i/12)]),s=n.transpose(12*a)._val;return Object(Oe.a)(s*o)}(t.transpose,o,void 0,function(e){return Object(v.A)(e,t,n,r,a)});return i.stepData.transpose=s,Object(v.Q)({stepData:i.stepData,stepNumber:n,time:r})}},Ee=n(187);Object(N.a)("acc",{parameterName:"The parameter to accumulate",value:"The value added to the accumulator on each trigger",limit:"The value at which the accumulator will reset to 0"},"Adds an accumulated value to a parameter every trigger, adding the passed-value to the accumulated value. When it reaches the limit, the accumulator resets to 0.");var Se=function(e,t,n){var r=0;return function(a,i,o){if(void 0===a)return Object(v.w)(!1);var s=Object(v.A)(e,a,i,o),c=a[s];return(r+=Object(v.A)(t,a,i,o))>Object(v.A)(n,a,i,o)&&(r=0),Object(v.K)(s,c+r)}};function Pe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var xe=n(2348).Parser,Te=function(e){Object(c.a)(n,e);var t=Pe(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,"User Script",e)).logs=[],r.code="",r.clear(),r.numberOfOutputs=2,r}return Object(o.a)(n,[{key:"isRealTime",value:function(){return!0}},{key:"documentation",get:function(){return["Write scripts for transforming triggers, and create your own custom midi-effects."]}},{key:"getContext",value:function(){var e,t=this;return e={setMacro:v.L,env1:v.s,search:B,sparse:V.a,once:$,time:W,and:C,or:T,resolution:K,env2:v.t,engine:this.track.sequencerEngine,env3:v.u,hand:oe.a,rules:S.q,env4:v.v,doc:N.a,choke:v.o,noDissonance:g,alt:J.a,r_alt:J.d,invert_chord:F.c,degree_chord:F.a,scale_degree:F.d,t_operator:x.p,dot:k.c,dash:k.b,when:S.r,before:S.o,otherwise:S.p,t_syncopate:E.d,t_leaf:x.k,t_transform_leaf:x.v,t_nth:x.o,t_swap:x.t,t_replace:x.q,t_accent:x.e,t_staccato:x.s,t_every:P.c,scl:F.e,t_put_scale:F.f,isLeaf:x.b,t_map:x.m,t_generate:E.b,t_append:x.f,t_cond:oe.c,t_splice:x.r,t_transform:x.u,t_multiply:x.n,t_keep_leaves:x.j,isRest:x.c,isStaccato:x.d,isAccent:x.a,jaki_accent:w.b,altn:J.b,t_reverse:L.m,t_variation:P.d,play_and_vary:P.b,tidal:oe.e,j_tidal:oe.b,tparse:oe.f,density:ke.a,decisions:E.a,augment:_,atranspose:m.a,gte:ye.c,lte:ye.d,every:J.c,lazy:v.A,nth:L.j,scale:we,t_insert:x.g,t_interleave:x.h,t_interleave_before:x.i,car:L.c,t_send:ue,t_receive:he,cdr:L.d,loop:z,len:L.g,t_len:x.l},Object(a.a)(e,"t_every",P.c),Object(a.a)(e,"t_double",d.a),Object(a.a)(e,"isNewCycle",P.a),Object(a.a)(e,"sublist",L.l),Object(a.a)(e,"t_sublist",L.n),Object(a.a)(e,"t_print",oe.d),Object(a.a)(e,"slide",y),Object(a.a)(e,"concat",L.e),Object(a.a)(e,"apply_rules",w.a),Object(a.a)(e,"cat",L.e),Object(a.a)(e,"t_altn",J.f),Object(a.a)(e,"t_alt",J.e),Object(a.a)(e,"list",L.h),Object(a.a)(e,"l",L.h),Object(a.a)(e,"vectorAdd",L.o),Object(a.a)(e,"append",L.b),Object(a.a)(e,"map",L.i),Object(a.a)(e,"stretch",re),Object(a.a)(e,"floor",Math.floor),Object(a.a)(e,"round",Math.round),Object(a.a)(e,"draw",A),Object(a.a)(e,"erase",q),Object(a.a)(e,"random",Math.random),Object(a.a)(e,"print",Z.a),Object(a.a)(e,"acc",Se),Object(a.a)(e,"reverse",v.H),Object(a.a)(e,"s",v.J),Object(a.a)(e,"pipe",ae.a),Object(a.a)(e,"set",v.K),Object(a.a)(e,"filter",v.w),Object(a.a)(e,"trigger",v.Q),Object(a.a)(e,"r_trig",h.a),Object(a.a)(e,"harmonize",te.b),Object(a.a)(e,"chord",te.a),Object(a.a)(e,"rconcat",L.k),Object(a.a)(e,"multiply",Y.c),Object(a.a)(e,"add",Y.a),Object(a.a)(e,"mod",Y.b),Object(a.a)(e,"t_simplify",E.c),Object(a.a)(e,"counter",ee),Object(a.a)(e,"start",v.M),Object(a.a)(e,"fetchMelody",j),Object(a.a)(e,"poly",ge.a),Object(a.a)(e,"receive",fe),Object(a.a)(e,"grab",v.y),Object(a.a)(e,"on",v.C),Object(a.a)(e,"patternSwitch",v.E),Object(a.a)(e,"send",le),Object(a.a)(e,"grabTime",v.z),Object(a.a)(e,"steps",v.N),Object(a.a)(e,"gate",Ee.d),Object(a.a)(e,"range",be),Object(a.a)(e,"shift",Ee.f),Object(a.a)(e,"beat",Ee.a),Object(a.a)(e,"notes",v.B),Object(a.a)(e,"rolling",v.I),Object(a.a)(e,"invert",R),Object(a.a)(e,"cond",v.q),Object(a.a)(e,"get",v.x),Object(a.a)(e,"repeat",Ee.e),Object(a.a)(e,"prob",v.F),Object(a.a)(e,"randomSelect",v.G),Object(a.a)(e,"threshold",pe.a),Object(a.a)(e,"transpose",v.P),Object(a.a)(e,"strum",te.c),Object(a.a)(e,"t_trigger",X.a),Object(a.a)(e,"triggerAttack",X.b),Object(a.a)(e,"triggerRelease",X.d),Object(a.a)(e,"triggerAttackRelease",X.c),Object(a.a)(e,"load",function(e){return t.loadScript(e)}),Object(a.a)(e,"library",function(e){return t.loadScript(e,"")}),Object(a.a)(e,"p",v.D),Object(a.a)(e,"switchOutput",v.O),Object(a.a)(e,"vel",v.R),Object(a.a)(e,"delay",ve),Object(a.a)(e,"dur",v.r),Object(a.a)(e,"chop",v.p),Object(a.a)(e,"altList",L.a),Object(a.a)(e,"f3",Object(oe.f)(". -")),Object(a.a)(e,"f4",Object(oe.f)(". . -")),Object(a.a)(e,"f5a",Object(oe.f)(". . . -")),Object(a.a)(e,"f5b",Object(oe.f)("- . -")),Object(a.a)(e,"f5c",Object(oe.f)(". - -")),Object(a.a)(e,"fig",p.a),Object(a.a)(e,"t_transform_fig",p.b),Object(a.a)(e,"before",S.o),Object(a.a)(e,"when",S.r),Object(a.a)(e,"after",S.l),Object(a.a)(e,"FLAM",S.d),Object(a.a)(e,"LEGATO",S.e),Object(a.a)(e,"ACCENT",S.a),Object(a.a)(e,"STACCATO",S.j),Object(a.a)(e,"PIANISSIMO",S.f),Object(a.a)(e,"REST",S.i),Object(a.a)(e,"PIANO",S.g),Object(a.a)(e,"DOUBLE",S.c),Object(a.a)(e,"knob",function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16;t.newVar(e,n,r,a);return function(){return t[e+"Parameter"].get()}}),e}},{key:"evalWithContext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pipe",n="";try{var r=e.split(";"),a=r[r.length-1],i=r.slice(0,r.length-1).join(";");return n=i+";\n\n\n "+t+"("+a+")",new Function("with(this) { "+i+"; return "+t+"("+a+")}").call(this.getContext())}catch(u){var o=u.stack.indexOf("<anonymous>:"),s=u.stack.slice(o+"<anonymous>:".length).split(":")[0],c=parseInt(s);if(isNaN(c))try{xe.parse(n)}catch(l){this.syntaxErrorLine=l.loc.line}else this.syntaxErrorLine=c-2;return}}},{key:"loadScript",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"s",n=Object(Q.b)(e),r=this.evalWithContext(n,t);return""===t?r:function(){return r}}},{key:"hasSyntaxError",value:function(e){return void 0===this.evalWithContext(e)}},{key:"eval",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&this.freeTidals();var r=this.clearVariables(),a=this.evalWithContext(e);for(var i in void 0===a?this.hasError=!0:(this.myScript=a,this.output(),this.myScript=this.evalWithContext(e),this.hasError=!1,this.code=e),r)this[i+"Parameter"]&&this[i+"Parameter"].copyFrom(r[i],this.track.sequencerEngine);n&&this.freeTidals(),this.updateVariablesRedux()}},{key:"clear",value:function(){this.tidals&&this.tidals.forEach(function(e){return e.clear()}),this.freeTidals()}},{key:"stop",value:function(){Object(s.a)(Object(l.a)(n.prototype),"stop",this).call(this),""!==this.code&&(this.eval(this.code),this.freeTidals())}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"getJson",value:function(){return Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{expanded:this.expanded,code:this.code})}},{key:"fromJson",value:function(e,t){this.code=e.code,this.expanded=e.expanded,""!==this.code&&(this.eval(this.code),this.freeTidals(),Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t))}}]),n}(f.a);t.a=Te},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(155),s=n(6),c=n(879),u=n(12),l=n(38),f=(n(114),n(22)),h=Object(u.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.oscillator,n=e.formantsExpanded,r=e.setFormantsExpanded;return i.a.createElement("div",{className:"operator-details"},!n&&i.a.createElement("div",{className:"volume-and-detune"},i.a.createElement(f.a,{sequencerEngine:t.sequencerEngine,name:"Volume",parameter:t.oscillatorLevelParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:0,max:1,step:.01}),i.a.createElement(f.a,{name:"Detune",sequencerEngine:t.sequencerEngine,lfoEnabled:!0,parameter:t.detuneParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}),i.a.createElement(f.a,{sequencerEngine:t.sequencerEngine,name:"Octave",parameter:t.oscillatorOctaveParameter,convertToRoot:2,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:-4,max:4,step:1})),!n&&i.a.createElement("div",{className:"volume-and-detune"},i.a.createElement(l.a,{condition:t.oscillatorTypeParameter.get()&&t.oscillatorTypeParameter.get().includes("fat")},i.a.createElement(f.a,{sequencerEngine:t.sequencerEngine,name:"Count",parameter:t.countParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:3,max:9,step:1}),i.a.createElement(f.a,{sequencerEngine:t.sequencerEngine,name:"Spread",parameter:t.spreadParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:1,max:200,step:.01})),i.a.createElement(l.a,{condition:"pulse"===t.oscillatorTypeParameter.get()},i.a.createElement(f.a,{sequencerEngine:t.sequencerEngine,name:"Pulse",parameter:t.pulseWidthParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:0,max:1,step:.01}))),i.a.createElement(c.a,{formantsExpanded:n,setFormantsExpanded:r,oscillator:t}))}),p=n(184),d={BASIC:["sine","triangle","square","sawtooth","pulse"],FAT:["fatsquare","fatsine","fattriangle","fatsawtooth"],CUSTOM:p.a},m=function(e){var t=e.type,n=e.name,r=e.setType,a=e.selectedType,o="type-option";return t===a&&(o+=" selected"),i.a.createElement("div",{onMouseDown:function(e){e.stopPropagation(),r(t)},className:o},n)},v=Object(u.b)(function(e,t){return{oscillatorType:t.oscillator.oscillatorType,customOscillatorType:t.oscillator.customOscillatorType}},function(e){return{}})(function(e){var t=e.oscillator,n=e.oscillatorType,o=e.customOscillatorType,s=e.hide,c=Object(a.useState)("BASIC"),u=Object(r.a)(c,2),l=u[0],h=u[1];Object(a.useEffect)(function(){o&&h("CUSTOM")},[o]),Object(a.useEffect)(function(){n&&(d.BASIC.includes(n)?h("BASIC"):h("FAT"))},[n]);var p=Object(a.useCallback)(function(e){"CUSTOM"===l?t.customOscillatorTypeParameter.set(e):t.oscillatorTypeParameter.set(e)},[t,l]);return Object(a.useEffect)(function(){return window.addEventListener("mousedown",s),function(){return window.removeEventListener("mousedown",s)}},[s]),i.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"waveform-selector"},t.customOscillatorType?i.a.createElement(f.a,{name:"Harmonics",sequencerEngine:t.sequencerEngine,isParameter:!0,parameter:t.harmonicsParameter,step:.001,min:-1,max:1}):i.a.createElement(f.a,{name:"Partials",sequencerEngine:t.sequencerEngine,isParameter:!0,parameter:t.partialCountParameter,step:1,min:0,max:64}),i.a.createElement("div",{className:"inner"},i.a.createElement("div",{className:"types"},i.a.createElement(m,{type:"BASIC",name:"Basic",setType:h,selectedType:l}),i.a.createElement(m,{type:"FAT",name:"Fat",setType:h,selectedType:l}),i.a.createElement(m,{type:"CUSTOM",name:"Custom",setType:h,selectedType:l})),i.a.createElement("div",{className:"waveforms"},d[l].map(function(e){return i.a.createElement("div",{key:e,onClick:function(){return p(e)},className:o===e||!o&&n===e?"osc-type selected":"osc-type"},e)}))))}),b=n(63),g=Object(u.b)(function(e,t){return{sampleDragging:e.selector.sampleDragging,oscillatorType:t.oscillator.customOscillatorType||t.oscillator.oscillatorType}},function(e){return{}})(function(e){var t=e.oscillatorType,n=e.oscillator,r=e.oscWaveforms,o=e.setOscWaveforms,s=e.sampleDragging,c=r===n,u="oscillator-waveform  ";u+=c?" showing":" pushable";var l=Object(a.useCallback)(function(e){e.stopPropagation(),n.setOscillatorSample(s)},[s]),f=Object(a.useCallback)(function(e){e.stopPropagation(),console.log("toggle wave"),o(c?void 0:n)},[c,n]);return"sine"===t?t=i.a.createElement("img",{src:"/sine-icon.svg",className:"osc-type-icon sine"}):"triangle"===t?t=i.a.createElement("img",{src:"/triangle-icon.svg",className:"osc-type-icon triangle"}):"sawtooth"===t?t=i.a.createElement("img",{src:"/sawtooth-icon.svg",className:"osc-type-icon sawtooth"}):"square"===t?t=i.a.createElement("img",{src:"/square-icon.svg",className:"osc-type-icon square"}):"pulse"===t&&(t=i.a.createElement("img",{src:"/pulse-icon.svg",className:"osc-type-icon pulse"})),i.a.createElement("div",{onDrop:l,onMouseDown:f,className:u},i.a.createElement("div",{className:"waveform-type"},t),c?i.a.createElement(v,{hide:function(){return o(void 0)},oscillator:n}):"")}),y=n(350),k=Object(u.b)(function(e,t){var n=t.oscillator.oscillatorLevelParameter;return{value:e.effects.effectParameters[n.id]}},function(e){return{}})(function(e){var t=e.oscWaveforms,n=e.setOscWaveforms,o=e.color,s=e.value,c=e.oscillator,u=e.height,l=void 0===u?75:u,f=e.setOscillatorDetails,h=e.oscillatorDetails,p=e.oscDragging,d=e.setOscDragging,m=Object(a.useRef)(void 0),v=Object(a.useRef)(0),b={height:Object(y.a)(s,0,1,l,1),backgroundColor:o},k=function(e){var t=e.parameter,n=e.min,i=e.max,o=e.height,s=e.root,c=void 0===s?1:s,u=e.ref,l=Object(a.useState)(!1),f=Object(r.a)(l,2),h=f[0],p=f[1],d=Object(a.useCallback)(function(e){e.stopPropagation();var r=Object(y.b)(e,"a",n,i,o,c,u.current);t.set(r,!1),p(!0)},[t,p]);return{onMouseMove:Object(a.useCallback)(function(e){if(e.stopPropagation(),h){var r=Object(y.b)(e,"a",n,i,o,c,u.current);t.set(r,!1)}},[t,h]),onMouseDown:d,onMouseClear:Object(a.useCallback)(function(e){p(!1)},[p])}}({height:l,parameter:c.oscillatorLevelParameter,min:0,max:1,ref:m}),O=k.onMouseDown,j=k.onMouseMove,w=k.onMouseClear,E="operator-name pushable ";h===c&&(E+=" selected");var S=!c.enabledParameter.get();S&&(E+=" disabled");var P,x=Object(a.useCallback)(function(){p&&p!==c&&c.fromJson(p.getJson(),!0),d(void 0)},[c,p,d]),T=Object(a.useCallback)(function(){n(void 0);var e=(new Date).getTime();if(e-v.current<250){var t=!c.enabledParameter.get();if(c.enabledParameter.set(t),!t)return void f(void 0)}v.current=e,c.enabledParameter.get()&&f(h===c?void 0:c)},[h,c,f,n]);return i.a.createElement("div",{className:"operator-mixer"},i.a.createElement("div",{draggable:!0,onDragStart:function(e){e.stopPropagation(),d(c)},onDragOver:function(e){return e.preventDefault()},onDrop:x,onClick:T,className:E},c.name),h||S?"":i.a.createElement("div",{draggable:!0,onDragStart:function(e){return e.preventDefault()},ref:m,style:{height:l+6},onClick:function(e){return e.stopPropagation()},onMouseLeave:w,onMouseUp:w,onMouseMove:j,onMouseDown:O,className:"volume-box"},i.a.createElement("div",{className:"rest"}),i.a.createElement("div",{style:b,className:"volume-indicator"}),i.a.createElement("div",{className:"value"},(P=s,Math.round(100*P)/100))),h&&h!==c||S?"":i.a.createElement(g,{oscWaveforms:t,setOscWaveforms:n,oscillator:c}))});t.a=Object(u.b)(function(e,t){return{}},function(e){return{setPullablePartDragging:function(t){return e(Object(s.ve)(t))}}})(function(e){var t=e.formantsExpanded,n=e.setFormantsExpanded,s=e.setPullablePartDragging,c=e.instrument,u=(e.isDraggable,e.sequencerEngine,e.setShowWaveform),l=e.setOscillatorDetails,p=e.oscillatorDetails,d=e.color,m=c.oscillatorNodes,v=Object(a.useState)(void 0),g=Object(r.a)(v,2),y=g[0],O=g[1],j=Object(a.useState)(void 0),w=Object(r.a)(j,2),E=w[0],S=w[1];Object(a.useCallback)(function(){s({instrument:c,id:c.id,track:c.track,type:o.e})},[c]);return i.a.createElement("div",{className:t?"operators-mixer expanded":"operators-mixer"},i.a.createElement("div",{className:"mixers"},m.map(function(e){return i.a.createElement(k,{key:e.id,setOscillatorDetails:l,color:d,oscWaveforms:y,setOscWaveforms:O,oscDragging:E,setOscDragging:S,oscillatorDetails:p,oscillator:e,setShowWaveform:u})})),p?i.a.createElement(h,{formantsExpanded:t,setFormantsExpanded:n,oscillator:p}):i.a.createElement("div",{className:"global-parameters"},i.a.createElement(f.a,{sequencerEngine:c.sequencerEngine,name:"Root Note",parameter:c.carrier.oscillatorFrequencyParameter,onParameterChanged:function(){return c.releaseAll()},displayFunction:function(e){return b.a.fromTranspose(e).toString()},isParameter:!0,min:-32,max:32,step:1}),i.a.createElement(f.a,{sequencerEngine:c.sequencerEngine,name:"Detune",parameter:c.detuneParameter,isParameter:!0,lfoEnabled:!0,min:-100,max:100,step:1})))})},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(30);function a(e){e=function(e){return 0===e.indexOf("0x")?e.slice(2):e}(e);for(var t=[],n=0;n<e.length;n+=64)e.length<n+64?t.push(i("0x"+e.slice(n))):t.push(i("0x"+e.slice(n,n+64)));return t}function i(e){return r.a.web3.utils.padRight(e,64)}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(45),o=n(15),s=n.n(o),c=function(){function e(t,n){Object(r.a)(this,e),this.step=t,this.value=n,this.id=Object(i.uuid)()}return Object(a.a)(e,[{key:"fromJson",value:function(e){return this.step=e.step,this.value="string"===typeof e.value?new s.a.Time(e.value):e.value,this.id=e.id,this}},{key:"getCopy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=(new e).fromJson(this.getJson());return n.id=t?this.id:Object(i.uuid)(),n}},{key:"getJson",value:function(){return{step:this.step,value:void 0===this.value?void 0:null===this.value?null:this.value.toNotation?this.value.toNotation():this.value,id:this.id}}}]),e}();t.a=c},function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c});var r=n(9),a=n(97);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;if(!window.noReload)return e.previousArgs&&void 0!==e.lastMessageReceived?(e.args=e.previousArgs,void e.refresh()):void 0},c=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;if(!window.noReload)if(t.skipHotReload)t.hotReload&&t.hotReload();else{var o=t.zObject&&"subpatch"===t.zObject.name;if(!n.has(t)){var s=[];if(o){n.add(t);var c,u=i(t.outletObjects);try{for(u.s();!(c=u.n()).done;){var l=c.value;e(l,n)}}catch(g){u.e(g)}finally{u.f()}}else{if(t.isInlet){var f=t.subSequence,h="Input "+t.inletNumber;if(f.inlets[h]){var p=f.inlets[h].connections;s=[].concat(Object(r.a)(s),Object(r.a)(p.map(function(e){return e.sourceNode}))),p.length}}else for(var d in t.inlets){var m=t.inlets[d].connections,v=Object(r.a)(m.map(function(e){return e.sourceNode}));s=[].concat(Object(r.a)(s),Object(r.a)(v)),m.length}var b=t.getObjectType&&t.getObjectType();if(n.size>0)if(b===a.d){if(t.lastSentMessage&&!t.isOutlet&&!t.isInlet)return void t.refresh()}else if(b===a.e&&t.lastMessageReceived)return void t.refresh();n.add(t),s.forEach(function(t){return e(t,n)})}}}}},function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return f});var r=n(8),a=n(17),i=(n(48),n(83),n(82)),o=n(153),s=n(105),c=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=a.A.apply(void 0,[e].concat(n)),o=(Math.round(i)>>>0).toString(2).split("").map(function(e){return parseInt(e)}),s=0,c=function(){return o[s++%o.length]};return{decide:c,decideNum:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;n>t;n--)if(c())return n;return t},decideUnique:function(e,t){t=Math.min(e,t);for(var n=new Array(t).fill(0).map(function(e,t){return t}),r=[];r.length<e;)for(var a=0;a<n.length;a++)if(c()){r.push(n[a]),n.splice(a,1);break}return r}}}},u=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length,l=new Array(u>4?u-4:0),f=4;f<u;f++)l[f-4]=arguments[f];var h=void 0,p=void 0,d=void 0;return function(){for(var u=arguments.length,f=new Array(u),m=0;m<u;m++)f[m]=arguments[m];var v=a.A.apply(void 0,[e].concat(f)),b=a.A.apply(void 0,[t].concat(f)),g=a.A.apply(void 0,[r].concat(f)),y=a.A.apply(void 0,[n].concat(f)),k=l.map(function(e){return a.A.apply(void 0,[e||2].concat(f))});if(v===h&&p===b)return d;h=v,p=b;var O=c(b).apply(void 0,f),j=O.decideNum,w=O.decide,E=12;return d=Object(s.m)(e,function(e,t){return function(e,t){var n=[e];w()?n=[Object(i.f)("~")()[0]]:w()&&(e.accent=!0);for(var r=g*j(k[t%k.length]||2,1),a=1;a<r;a++)n.push(Object(i.f)("~")()[0]);var s=j(r-1,1);E=w()?y:0;var c=w()?new String(E):new String(E)+"'";return n[s]=Object(i.f)(c)()[0],Object(o.e)(n)()}(e,t)}).apply(void 0,f)}},l=function(e,t){var n=void 0,r=void 0,o=void 0;return function(){for(var c=arguments.length,u=new Array(c),l=0;l<c;l++)u[l]=arguments[l];var f=a.A.apply(void 0,[e].concat(u)),p=a.A.apply(void 0,[t].concat(u));if(f===n&&r===p)return o||[];if(n=f,r=p,100===p)return f||[];p=100-p;for(var d=f.flat(10).filter(function(e){return null!==e.transpose}).length,m=d*p/100,v=0,b=0;v<=m&&b<=d;)f=Object(s.v)(f,h(d-v,b),function(e,t,n){return v++,Object(i.f)("~")()[0]},void 0,!0).apply(void 0,u),b++;return o=f[0]}},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=void 0,o=void 0,u=void 0;return function(){for(var l=arguments.length,f=new Array(l),h=0;h<l;h++)f[h]=arguments[h];var p=a.A.apply(void 0,[e].concat(f)),d=a.A.apply(void 0,[t].concat(f));if(o===d&&p===n)return u;o=d,n=p;var m=c(t).apply(void 0,f),v=m.decide,b=m.decideNum,g=m.decideUnique,y=function(e,t){if(v()&&v())return function(e){var t=b(4),n=g(t,4),a=0,o=0;return n.forEach(function(t){t%=e.length;var n=e[t];if(!Array.isArray(n)){var s=Object(r.a)({},n);!v()&&a++<1?null===s.transpose&&v()&&o++<1?s=Object(i.f)("0'")():s.accent=!0:null===s.transpose&&v()&&o++<1?s=Object(i.f)("0.")():s.staccato=!0,e[t]=s}}),e}(Object(s.t)(e,[null,Object(i.f)("0.")]));Array.isArray(e)||(e=Object(r.a)({},e));var n=e;n=Array.isArray(e)?[e[b(e.length-1)]]:[e];var a=Object(i.f)("~").apply(void 0,f)[0];null===e.transpose&&(e.transpose=0);var o=Array.isArray(e)?e[0]:e;if(v())n=[a,o];else{n=[a,o,o,o];var c=[v(),v()&&v(),v(),v()&&v()],u=c[0],l=c[1],h=c[2],p=c[3];u&&(n[0]=o),l&&(n[1]=a),l&&(n[2]=a),h&&(n[3]=a),u||l||h||p||(n[b(3)]=o);var d=b(4),m=g(d,4),y=0,k=0;m.forEach(function(e){var t=n[e];if(!Array.isArray(t)){var a=Object(r.a)({},t);!v()&&y++<1?null===a.transpose&&v()&&k++<1?a=Object(i.f)("0'")():a.accent=!0:null===a.transpose&&v()&&k++<1?a=Object(i.f)("0.")():a.staccato=!0,n[e]=a}})}return n};return u=Object(s.m)(e,function(e,t){return y(e)}).apply(void 0,f)}},h=function(e,t){var n=Math.ceil(e/2);e%2===0&&n++;var r=(t+1)%n;return t%2===0?r:(n+r)%e}},function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return f});var r=n(9),a=n(17),i=(n(105),n(82));function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(a.w)(!t[0]||t[0].isNewCycle)}},u=function(e,t,n){var r=0;return function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var s=a.A.apply(void 0,[e].concat(i));return i[0]&&i[0].isNewCycle&&++r%s===0?a.A.apply(void 0,[t].concat(i)):Object(a.w)(!0)}},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return function(){for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];var u,l=a.A.apply(void 0,[e].concat(s)),f=(a.A.apply(void 0,[t].concat(s)),a.A.apply(void 0,[n].concat(s)),[]),h=[],p=void 0,d=o(l);try{for(d.s();!(u=d.n()).done;){var m=u.value;p&&m.figureId!==p.figureId&&(f.push(h),h=[]),h.push(m),p=m}}catch(g){d.e(g)}finally{d.f()}f.push(h);var v=f.length,b=f[v-n];return f[v-n]=f[v-t],f[v-t]=b,f.reduce(function(e,t){return[].concat(Object(r.a)(e),Object(r.a)(t))},[])}},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||function(e){return function(){return e}};return{pattern:function(){return n(e())()},player:Object(a.J)(Object(i.b)(function(){return n(e())()},r),u(t,function(){return e=l(e),Object(a.w)(!0)}))}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e,t){var n=[];for(var r in e)n.push(e[r].x),n.push(e[r][t]);return n}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(6),f=n(29),h=n(12),p=new f.a,d=Object(c.memo)(function(e){var t=e.name,n=e.setParameterToMap,r=e.parameter,a=e.value,i=e.onClick,o=e.isMacroMapping,s=e.isParameterToMap,c="parameter-button";e.isSelected&&(c+=" selected");var l;return u.a.createElement("div",{onClick:function(){return i(r)},className:c},function(){var e=r.parameter;if(o&&e){var t="macro-overlay";s&&(t+=" parameter-to-map"),e.hasMacro&&(t+=" mapped");var a={};e.hasMacro&&(a={backgroundColor:p.getColorForHash(e.hasMacro.id)});var i=e.hasMacro&&e.hasMacro.name;return u.a.createElement("div",{onClick:function(){return n(e)},className:t},u.a.createElement("div",{className:"overlay-main"}),u.a.createElement("div",{className:"overlay-detail",style:a},i))}return""}(),u.a.createElement("div",{className:"parameter-name"},t),u.a.createElement("div",{className:"parameter-value"},(l=a,Math.floor(100*l)/100)))}),m=Object(h.b)(function(e,t){return void 0===t.parameter?{value:0}:{value:e.effects.effectParameters[t.parameter.parameter.id],isMacroMapping:e.effects.isMacroMapping,isParameterToMap:t.parameter&&e.effects.parameterToMap===t.parameter.parameter,hasMacro:t.parameter.parameter.hasMacro}},function(e){return{setParameterToMap:function(t){return e(Object(l.Td)(t))}}})(d),v=n(90),b=n.n(v),g=Object(h.b)(function(e,t){return void 0===t.parameter?{value:0}:{value:t.parameter.parameter.get()}},null)(function(e){var t=e.parameter.parameter,n=t.min,r=t.max,a=t.value;return a=Math.cbrt(a),void 0!==e.parameter.min&&(n=e.parameter.min),void 0!==e.parameter.max&&(r=e.parameter.max),u.a.createElement("div",{className:"simple-parameter-slider"},u.a.createElement(b.a,{value:a,change:function(t){return e.onChange(t)},step:.01,max:Math.cbrt(r),min:Math.cbrt(n),orientation:"horizontal",reversed:!1}))}),y=n(834);function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}n.d(t,"a",function(){return O});var O=function(e){Object(i.a)(n,e);var t=k(n);function n(e){var a;Object(r.a)(this,n),a=t.call(this,e);var i=e.parameters,o=i[Object.keys(i)[0]];return a.state={selectedParameter:o},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e){if(e.parameters!==this.props.parameters){var t=e.parameters,n=t[Object.keys(t)[0]];this.state.selectedParameter=n}return!0}},{key:"onSelect",value:function(e){this.setState({selectedParameter:e})}},{key:"onChangeValue",value:function(e){this.state.selectedParameter.parameter.set(Math.pow(e.target.value,3))}},{key:"render",value:function(){var e=this,t=this.props.parameters,n=void 0===this.props.showMods||this.props.showMods,r=Object.keys(t);return u.a.createElement("div",{className:"multiple-parameter-slider"},u.a.createElement("div",{className:"parameters"},r.map(function(n,r){return u.a.createElement(m,{key:"parameter-"+r,isSelected:t[n]===e.state.selectedParameter,onClick:function(t){return e.onSelect(t)},name:n,parameter:t[n]})})),u.a.createElement("div",{className:"slider-and-modulators"},u.a.createElement(g,{onChange:function(t){return e.onChangeValue(t)},parameter:this.state.selectedParameter}),n?u.a.createElement(y.a,{sequencerEngine:this.props.sequencerEngine,parameter:this.state.selectedParameter.parameter}):""))}}]),n}(c.Component)},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i});var r="EQ",a="LTE",i="GTE"},function(e,t,n){"use strict";n.d(t,"a",function(){return k});var r=n(8),a=n(2),i=n(4),o=n(20),s=n(7),c=n(10),u=n(1),l=n(21),f=n(57),h=n(32),p=n(23),d=n(257),m=n(82),v=n(316),b=n(117),g=n(83);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var k=function(e){Object(s.a)(n,e);var t=y(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this)).effect=r,i.sequencerEngine=r.sequencerEngine,i.figure=e,i._initialType=0,i._initialLength=e().flat(3).length,i.figureLengthParameter=new l.a("figureLength",Object(o.a)(i),function(e,t){return i.onLengthChanged(t)},{defaultValue:i._initialLength,min:3,max:5}),i.registerParameter(i.figureLengthParameter),i.figureTypeParameter=new l.a("figureType",Object(o.a)(i),function(e,t){return i.onTypeChanged(t)},{defaultValue:i._initialType,min:0,max:7}),i.registerParameter(i.figureTypeParameter),i.registerContext(),i}return Object(i.a)(n,[{key:"registerContext",value:function(){var e=this,t=this.parameters,n=(new f.a).forMidiEffect(this.effect);t.forEach(function(t){t.setContext(n),t.setStore(e.sequencerEngine.store)})}},{key:"updateFigure",value:function(e){var t=(e=e()).flat(3).length,n=b.b[t],r=Object(g.e)(e),a=n.indexOf(r.trim());this.figureLengthParameter.set(t),this.figureTypeParameter.set(a)}},{key:"figureLength",get:function(){return this.figureLengthParameter?this.figureLengthParameter.get():this._initialLength}},{key:"figureType",get:function(){return this.figureTypeParameter?this.figureTypeParameter.get():this._initialType}},{key:"onTypeChanged",value:function(e){e=Math.round(e);var t=Math.min(5,Math.max(3,Math.round(this.figureLength))),n=b.b[t],r=n[e%n.length];this.figure=Object(d.a)(Object(m.f)(r))(),this.effect.onFiguresChanged()}},{key:"onLengthChanged",value:function(e){e=Math.min(5,Math.max(3,Math.round(e)));var t=b.b[e],n=t[Math.round(this.figureType)%t.length];this.figure=Object(d.a)(Object(m.f)(n))(),this.effect.onFiguresChanged()}},{key:"toString",value:function(){return Object(g.e)(this.figure)}},{key:"getJson",value:function(){var e={figureLength:this.figureLength,figureType:this.figureType};return e=Object(p.b)(e,"figureLengthParameter",this.figureLengthParameter),e=Object(p.b)(e,"figureTypeParameter",this.figureTypeParameter)}},{key:"fromJson",value:function(e){var t={};return Object(h.a)(this.figureLengthParameter,e.figureLength,t),Object(h.a)(this.figureTypeParameter,e.figureType,t),Object(r.a)({},t,Object(p.a)(e,"figureLengthParameter",this.figureLengthParameter),Object(p.a)(e,"figureTypeParameter",this.figureTypeParameter))}}]),n}(Object(v.a)(function(){return function e(){Object(a.a)(this,e)}}()))},function(e,t,n){"use strict";n.d(t,"b",function(){return b}),n.d(t,"a",function(){return g}),n.d(t,"c",function(){return y});var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(85),f=n(140),h=n(15);function p(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=new(n.n(h).a.Time)("32n"),b=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Split",e)).numberOfOutputs=2,r}return Object(i.a)(n,[{key:"value",get:function(){return this.numberOfOutputs},set:function(e){e>0&&(this.numberOfOutputs=e)}},{key:"getText",value:function(){return this.numberOfOutputs}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{numberOfOutputs:this.numberOfOutputs})}},{key:"fromJson",value:function(e){Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),e.numberOfOutputs&&(this.numberOfOutputs=e.numberOfOutputs)}},{key:"output",value:function(e,t){var n,r=[],a=p(this.triggers);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=i.stepData,s=i.time,c=o.duration;o.duration=c/this.numberOfOutputs,r.push(i);for(var u=1;u<this.numberOfOutputs;u++){var l=this.copyTrigger(i);s+=v*(c/(this.numberOfOutputs/2)),l.time=s,l.outputNumber=u,r.push(l)}}}catch(f){a.e(f)}finally{a.f()}return r}}]),n}(l.a),g=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Flat",e)).value=1,r}return Object(i.a)(n,[{key:"output",value:function(){var e=this,t=this.triggers||[];this.active=t.length>0;var n,r=p(t);try{for(r.s();!(n=r.n()).done;){n.value.stepData.voices.forEach(function(t){return t.flat=e.value})}}catch(a){r.e(a)}finally{r.f()}return t}}]),n}(f.g),y=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Thick",e)).value=1,r}return Object(i.a)(n,[{key:"output",value:function(){var e=this,t=this.triggers||[];this.active=t.length>0;var n,r=p(t);try{for(r.s();!(n=r.n()).done;){n.value.stepData.voices.forEach(function(t){return t.thick=e.value})}}catch(a){r.e(a)}finally{r.f()}return t}}]),n}(f.g)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(433),l=n(43);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var h=function(e){Object(o.a)(n,e);var t=f(n);function n(e,a,i){var o;return Object(r.a)(this,n),(o=t.call(this,e,i)).defaultValue=a,o.heldEvent=void 0,o.currentEvent=a,o.cache={},o}return Object(a.a)(n,[{key:"getMixType",value:function(){return l.c}},{key:"restart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(i.a)(Object(c.a)(n.prototype),"restart",this).call(this),this.cache={},e||(this.heldEvent=void 0),this.currentEvent=this.defaultValue}},{key:"clear",value:function(){Object(i.a)(Object(c.a)(n.prototype),"clear",this).call(this),this.cache={}}},{key:"holdEvent",value:function(e,t){this.heldEvent=e}},{key:"getPreviousEvent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(i.a)(Object(c.a)(n.prototype),"getPreviousEvent",this).call(this,e,t,r)||this.defaultValue}},{key:"getValuesBetweenSteps",value:function(e,t){for(var n=[],r=void 0,a=e;a<t;a++){var i=this.getValue(a,!1,!1),o=i.getValue();this.type===l.j?void 0!==r&&o.equals(r)||n.push({step:a,value:o,event:i}):o!==r&&n.push({step:a,value:o,event:i}),r=o}for(var s=0;s<n.length;s++)void 0===n[s+1]?n[s].duration=t-n[s].step:n[s].duration=n[s+1].step-n[s].step,n[s].event.duration=n[s].duration;return n}},{key:"getValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.getEvent(e,t).getValue()}},{key:"getEvent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.heldEvent)return this.heldEvent;if(e in this.cache)return this.cache[e];0==e&&t&&this.restart();for(var n=t?this.counter:0,r=void 0;n<this.events.length&&!(this.events[n].step>e);n++)void 0!==this.heldEvent&&this.events[n].step!==e||(r=this.events[n]);return t&&(this.counter=Math.max(0,n-1)),void 0===r?(this.cache[e]=this.currentEvent,this.currentEvent):(this.currentEvent=r,this.heldEvent=void 0,this.cache[e]=r,r)}}]),n}(u.a);t.a=h},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"d",function(){return s});var r=100,a=180,i=350,o=1e3,s=1e4},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"b",function(){return o});var r=1,a=2,i=3,o=4},,function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return s});var r=n(33),a=140,i="RIGHT",o="LEFT",s=new r.a(16,!1)},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(455),a=n(400);function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.b,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=Object(r.a)(32,t,i);return Math.floor(32*(e-n)/o)}},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return o});var r="GRID",a="LIST",i="day",o="tag"},function(e,t,n){"use strict";var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(7),l=n(10),f=n(1),h=n(30),p=n(196),d=n.n(p),m=function(){function e(){Object(s.a)(this,e),this.selectedTags=[],this.selectedOrTags=[],this.selectedStyles=[],this.selectedCountries=[],this.selectedVideos=[],this.selectedDiscogs=[],this.filterFavorites=!1,this.year=void 0,this.chord=void 0}return Object(c.a)(e,[{key:"toString",value:function(){console.log("selectedTags = "+this.selectedTags.join(",")),console.log("selectedOrTags = "+this.selectedOrTags.join(",")),console.log("selectedStyles= "+this.selectedStyles.join(",")),console.log("selectedCountries = = "+this.selectedCountries.join(","))}},{key:"empty",value:function(){return 0==this.selectedTags.length&&0==this.selectedStyles.length&&0==this.selectedOrTags.length&&0==this.selectedCountries.length&&void 0===this.chord&&void 0==this.year}},{key:"getSearchQueryParameters",value:function(){var e="?tags="+this.selectedTags.join(",")+"&styles="+this.selectedStyles.join(",")+"&countries="+this.selectedCountries.join(",");return void 0!==this.year&&(e+="&year="+this.year),e}},{key:"getTopTags",value:function(){return this.getTopFields("/getTags")}},{key:"getTopStyles",value:function(){return this.getTopFields("/getStyles")}},{key:"getTopCountries",value:function(){return this.getTopFields("/getCountries")}},{key:"getTopFields",value:function(e){var t=this;return new Promise(function(n,r){var a=t.getSearchQueryParameters();e+=a,d.a.get(e).then(function(e){var t=e.data.data,r=[];for(var a in t)r.push(a);n(r)}).catch(function(e){r(e)})})}},{key:"getSounds",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="/filterSearch/"+t+"/"+n+this.getSearchQueryParameters(),e.next=3,d.a.get(r);case 3:return a=e.sent,e.abrupt("return",this.searchCallback(a));case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"searchCallback",value:function(e){for(var t=e.data.data,n=[],r=0;r<t.length;r++)n.push(t[r].id);return{sounds:n,total:e.data.total}}}]),e}(),v=n(1476),b=n(311),g=new v.a,y=function(){function e(){Object(s.a)(this,e),this.tagToLevel={},this.tagToParent={},this.tagToChildren={},this.loadHierarchy()}return Object(c.a)(e,[{key:"loadHierarchy",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r,a,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getClassifications();case 2:for(r in t=e.sent,n={},t)for(a in n[r]=this.getParentOfTag(r,t),t[r])o=t[r][a],n[o]=r;for(s in this.tagToChildren=t,this.tagToParent=n,this.tagToLevel={},n)this.tagToLevel[s]=this.getLevel(s,n);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAllChildren",value:function(e){var t=this.tagToChildren[e],n=[];for(var r in t)n=n.concat(this.getAllChildren(t[r]));return n.concat(t)}},{key:"reduce",value:function(e,t){if(e.length<=20)return e;var n=1,r=0===t.length,a=!0,i=[];for(var o in t){var s=t[o];i=i.concat(this.getAllChildren(s)),void 0===this.tagToLevel[s]?r=!0:a=!1,this.tagToLevel[s]>=n&&(n=this.tagToLevel[s])}return r&&(n+=2),a?this.filterReduction(e,2,i,r):this.filterReduction(e,n,i,r)}},{key:"filterReduction",value:function(e,t,n,r){var a=this;return e.filter(function(e){return n.indexOf(e.value)>-1||a.tagToLevel[e.value]<=t||r&&void 0===a.tagToLevel[e.value]})}},{key:"getLevel",value:function(e,t){return void 0===t[e]?0:t[e]===e?0:1+this.getLevel(t[e],t)}},{key:"getParentOfTag",value:function(e,t){for(var n in t){if(t[n].indexOf(e)>-1)return n}return null}}]),e}(),k="OR",O="AND",j=n(127);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function E(e){e=e.map(function(t){return{value:t.value,rank:Math.pow(.9,8*t.rank/e.length)}});var t=Math.max.apply(Math,e.map(function(e){return e.rank}));return e.map(function(e){return{value:e.value,rank:e.rank/t}})}function S(e,t){var n={};for(var r in e)r in t&&(n[r]=e[r].rank+t[r].rank);return n}var P=function(e){Object(u.a)(n,e);var t=w(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this)).cache=e,r.varietyReducer=new y,r}return Object(c.a)(n,[{key:"freeTextSearch",value:function(e){var t=this;return new Promise(function(n,r){n({TAG:E(t.cache.freeTextSearch(j.d,e)),STYLE:E(t.cache.freeTextSearch(j.c,e)),COUNTRY:E(t.cache.freeTextSearch(j.a,e)),YEAR:E(t.cache.freeTextSearch(j.e,e))})})}},{key:"getTopVideos",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.empty()){e.next=4;break}return e.abrupt("return",this.cache.getAllForField(j.f,0,1e7));case 4:return r=this.selectedOrTags.length>0?k:O,e.abrupt("return",this.getTopFields(0,1e7,j.f,r));case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTopDiscogs",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.empty()){e.next=4;break}return e.abrupt("return",this.cache.getAllForField(j.b,0,1e7));case 4:return r=this.selectedOrTags.length>0?k:O,e.abrupt("return",this.getTopFields(0,1e7,j.b,r));case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTopTags",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n,r){var a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=void 0===r?this.selectedTags:r,!this.filterFavorites){e.next=6;break}return e.next=4,h.a.getFavoritesForUser();case 4:return a=e.sent,e.abrupt("return",this.getTagsForSounds(a));case 6:return e.next=8,this.getTopFields(t,n,j.d);case 8:return o=e.sent,e.abrupt("return",this.varietyReducer.reduce(o,r));case 10:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getTopStyles",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.selectedOrTags.length>0?k:O,e.abrupt("return",this.getTopFields(void 0,void 0,j.c,t));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getTopCountries",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.selectedOrTags.length>0?k:O,e.abrupt("return",this.getTopFields(void 0,void 0,j.a,t));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getVideoInfo",value:function(e){var t=Array.from(this.cache.getFieldsForField(j.d,j.f,e)),n=Array.from(this.cache.getFieldsForField(j.c,j.f,e)),r=Array.from(this.cache.getFieldsForField(j.e,j.f,e));return{tags:t.map(function(e){return e.value}),styles:n.map(function(e){return e.value}),year:r.map(function(e){return e.value})[0]}}},{key:"getTopFields",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n,r){var a,o,s,c,u,l,f=this,h=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=h.length>3&&void 0!==h[3]?h[3]:O,o=this.getSelectedFields(a),!this.empty()){e.next=4;break}return e.abrupt("return",E(this.cache.getAllForField(r,t,n)));case 4:for(u in s=[],c=function(e){o[e].forEach(function(t){s.push(f.cache.getFieldsForField(r,e,t))})},o)c(u);return l=[],l=a==k?Array.from(this.unionAll(s)):Array.from(this.intersectAll(s)),e.abrupt("return",E(l));case 10:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getSelectedFields",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=void 0===this.year?[]:[this.year];return{TAG:e==k?this.selectedOrTags:this.selectedTags,STYLE:this.selectedStyles,COUNTRY:this.selectedCountries,YEAR:t}}},{key:"getTagsForSounds",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a in n={},r=[],t)r.push(h.a.getTagsForSound(t[a]));return e.next=5,Promise.all(r);case 5:for(s in o=e.sent)o[s].forEach(function(e){return n[e]=!0});return e.abrupt("return",Object.keys(n));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"unionAll",value:function(e){if(void 0===e||0==e.length)return[];var t={};return e.forEach(function(e){return e.forEach(function(e){e.value in t||(t[e.value]=0),t[e.value]+=e.rank})}),t}},{key:"intersectAll",value:function(e){if(void 0===e||0==e.length)return[];var t=[],n=function(n){a=e[n];var r={};a.forEach(function(e){return r[e.value]=e.rank}),t.push(r)};for(var r in e){var a;n(r)}for(var i=t[0],o=1;o<t.length;o++)i=S(i,t[o]);var s=new Set;for(var c in i)s.add({value:c,rank:i[c]/t.length});return s}}]),n}(m),x=n(531);function T(e,t){var n=new Set(e),r=new Set(t);return Array.from(n).every(function(e){return r.has(e)})&&Array.from(r).every(function(e){return n.has(e)})}var C=function(){function e(t){Object(s.a)(this,e),this.store=t,this.selectedTags=[],this.selectedOrTags=[],this.selectedStyles=[],this.selectedCountries=[],this.selectedVideos=[],this.filterFavorites=!1,this.chord=!1,this.year=void 0,this.unsortedResults=[],this.canceled=!1,this.mostRecentResults=void 0,this.mostPopularResults=void 0,this.shuffledResults=void 0}return Object(c.a)(e,[{key:"sortBy",get:function(){return this.store.getState().selector.sortBy}},{key:"addLazyResults",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.linkedPromiseList=t;case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getNext",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.linkedPromiseList&&!this.canceled){e.next=3;break}return this.canceled||this.setFinalResults(this.unsortedResults),e.abrupt("return",void 0);case 3:return e.next=5,this.linkedPromiseList.getCurrent();case 5:if(t=e.sent,(t=Array.from(new Set(t))).forEach(function(e){n.unsortedResults.push(e)}),this.setFinalResults(this.unsortedResults),void 0!==this.linkedPromiseList){e.next=11;break}return e.abrupt("return",void 0);case 11:return e.next=13,this.linkedPromiseList.getNext();case 13:return this.linkedPromiseList=e.sent,e.abrupt("return",this.linkedPromiseList);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addUnsortedResults",value:function(e){this.unsortedResults=e}},{key:"sort",value:function(){this.setFinalResults(this.unsortedResults)}},{key:"setFinalResults",value:function(e){this.unsortedResults=e,this.sortBy===x.a?this.mostPopularResults?this.results=this.mostPopularResults:(this.results=this.sortByRanking(Object(r.a)(this.unsortedResults)),this.mostPopularResults=this.results):this.sortBy===x.c?void 0===this.shuffledResults?(this.results=Object(b.a)(Object(r.a)(this.unsortedResults)),this.shuffledResults=this.results):this.results=this.shuffledResults:this.mostRecentResults?this.results=this.mostRecentResults:(this.results=this.unsortedResults,this.mostRecentResults=this.results)}},{key:"sortByRanking",value:function(e){var t=this;return void 0===this.sampleToRanking?e:(e.sort(function(e,n){var r=e in t.sampleToRanking?t.sampleToRanking[e]:0;return(n in t.sampleToRanking?t.sampleToRanking[n]:0)-r}),e)}},{key:"getAllSounds",value:function(){var e=this,t=void 0===this.favorites||void 0===this.results?this.results:this.results.filter(function(t){return e.favorites.indexOf(t)>-1});return Array.from(new Set(t))}},{key:"getResults",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=this.getAllSounds();return void 0!==r&&(void 0!==this.stylesSounds&&(r=r.filter(function(t){return e.stylesSounds.has(t)})),void 0!==this.yearSounds&&(r=r.filter(function(t){return e.yearSounds.has(t)})),void 0!==this.chordSounds&&(r=r.filter(function(t){return e.chordSounds.has(t)})),void 0!==this.videosSounds&&(r=r.filter(function(t){return e.videosSounds.has(t)}))),void 0===r?{sounds:[],total:0}:void 0!==t&&void 0!==n?t>=r.length?{sounds:[],total:0}:t+n>=r.length?{sounds:r.slice(t),total:r.length}:{sounds:r.slice(t,t+n),total:r.length}:{sounds:r,total:r.length}}},{key:"cancel",value:function(){this.canceled=!0}},{key:"empty",value:function(){return 0===this.selectedTags.length&&0===this.selectedStyles.length&&0===this.selectedOrTags.length&&-0==this.selectedCountries.length&&0===this.selectedVideos.length&&void 0===this.chord&&void 0===this.year}},{key:"equals",value:function(e){var t=!1;return this.chord===e.chord?t=!0:void 0===this.chord||void 0===e.chord?t=!1:this.chord.join(",")===e.chord.join(",")&&(t=!0),T(this.selectedTags,e.selectedTags)&&T(this.selectedOrTags,e.selectedOrTags)&&T(this.selectedStyles,e.selectedStyles)&&T(this.selectedVideos,e.selectedVideos)&&T(this.selectedDiscogs,e.selectedDiscogs)&&T(this.selectedCountries,e.selectedCountries)&&function(e,t){if(void 0!==e&&void 0===t)return!1;if(void 0!==t&&void 0===e)return!1;if(void 0===e&&void 0===t)return!0;e=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),t=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());var n=Math.abs(e-t);if(0===Math.floor(n/1e3/60/60/24))return!0;return!1}(this.fromDate,e.fromDate)&&this.filterFavorites===e.filterFavorites&&t&&this.year===e.year}}]),e}(),N=n(643),R=n(1036);function M(e,t){return new Set(Object(r.a)(e).filter(function(e){return t.has(e)}))}function A(e,t){return q.apply(this,arguments)}function q(){return(q=Object(o.a)(i.a.mark(function e(t,n){var r,a,o,s,c,u,l;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a in r=[],t)o=t[a],r.push(n(o));return e.next=4,Promise.all(r);case 4:s=e.sent,c=new Set(s[0]),e.t0=i.a.keys(s);case 7:if((e.t1=e.t0()).done){e.next=15;break}if(0!=(u=e.t1.value)){e.next=11;break}return e.abrupt("continue",7);case 11:l=new Set(s[u]),c=M(c,l),e.next=7;break;case 15:return e.abrupt("return",Array.from(c));case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var I=new(function(){function e(){Object(s.a)(this,e),this.recentQueries=[],this.guildId=0}return Object(c.a)(e,[{key:"setStore",value:function(e){var t=this;void 0===this.store&&e&&(this.store=e,this.store.subscribe(function(){return t.onChange()}))}},{key:"onChange",value:function(){var e=this.store.getState().guilds.selectedGuild,t=e?e.guildId:0;t!==this.guildId&&(console.log("guild changed to guildId = "+t),this.guildId=t,this.clear())}},{key:"clear",value:function(){this.recentQueries=[]}},{key:"createSearchQuery",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new C(this.store);return n.selectedTags=e.selectedTags,n.selectedOrTags=e.selectedOrTags,n.selectedStyles=e.selectedStyles,n.selectedVideos=e.selectedVideos,n.selectedDiscogs=e.selectedDiscogs,n.selectedCountries=e.selectedCountries,n.filterFavorites=e.filterFavorites,n.fromDate=e.fromDate,n.chord=void 0===e.chord?void 0:Object(r.a)(e.chord),n.year=e.year,t||(n.sampleToRanking=e.sampleToRanking),n}},{key:"getSearchQueryIfExists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.createSearchQuery(e),r=this.recentQueries.filter(function(e){return n.equals(e)&&!n.canceled});return void 0===(r=0==r.length?void 0:r[0])||t||(r.sampleToRanking=e.sampleToRanking,r.canceled=!1),void 0!==r&&r.sort(),r}},{key:"addNewQuery",value:function(e){this.recentQueries.push(e),this.recentQueries.length>25&&this.recentQueries.splice(0,1)}}]),e}()),_={},F=function(e){Object(u.a)(n,e);var t=D(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e)).store=r?r.store:void 0,a.cache=e,a.updateSoundRankings(),I.setStore(a.store),a}return Object(c.a)(n,[{key:"getNewIndex",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cache.loadNewIndex(t);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"clearCache",value:function(){I.clear(),_={}}},{key:"filterByMonth",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cache.filterByMonth(t.getMonth(),t.getFullYear());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"clearFilterByMonth",value:function(){this.cache.clearFilter()}},{key:"sortBy",get:function(){return I.sortBy},set:function(e){I.sortBy=e}},{key:"getAllSounds",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o,s,c,u,l,f;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(r=I.getSearchQueryIfExists(this,!0))){e.next=3;break}return e.abrupt("return",r);case 3:return r=I.createSearchQuery(this,!0),e.next=6,this.getSoundsWithVideos(this.selectedVideos);case 6:return a=e.sent,e.next=9,this.getSoundsWithDiscogs(this.selectedDiscogs);case 9:if(o=e.sent,r.videosSounds=L(a,o),s=[],!this.filterFavorites){e.next=18;break}return e.next=15,h.a.getFavoritesForUser();case 15:s=e.sent,e.next=32;break;case 18:if(c=void 0,void 0===a&&void 0===o){e.next=23;break}c=r.videosSounds,e.next=31;break;case 23:return(u=new Date(this.fromDate)).setDate(this.fromDate.getDate()+31),l=(new Date).getTime(),e.next=28,h.a.getAllSounds(this.fromDate,u);case 28:c=e.sent,f=(new Date).getTime(),f-l;case 31:c.forEach(function(e){-1==s.indexOf(e)&&s.push(e)});case 32:return r.setFinalResults(s),I.addNewQuery(r),e.abrupt("return",r);case 35:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSounds",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var a,o,s,c,u,l,f,p,d,m,v,b;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(a=I.getSearchQueryIfExists(this))){e.next=3;break}return e.abrupt("return",a);case 3:return a=I.createSearchQuery(this),(new Date).getTime(),e.next=7,this.getSoundsWithTags(this.selectedTags);case 7:return o=e.sent,e.next=10,this.getSoundsWithVideos(this.selectedVideos);case 10:return s=e.sent,e.next=13,this.getSoundsWithDiscogs(this.selectedDiscogs);case 13:return c=e.sent,e.next=16,this.getSoundsWithOrTags(this.sortTagsByPopularity(this.selectedOrTags));case 16:return u=e.sent,e.next=19,this.getSoundsWithStyles(this.selectedStyles);case 19:return l=e.sent,e.next=22,this.getSoundsWithCountries(this.selectedCountries);case 22:return f=e.sent,e.next=25,this.getSoundsWithYear(this.year);case 25:return p=e.sent,e.next=28,this.getSoundsWithChord(this.chord);case 28:if(d=e.sent,(new Date).getTime(),m=[d,o,l,f,p],v=this.intersectResultsForFilters(m),!this.filterFavorites){e.next=38;break}return e.next=35,h.a.getFavoritesForUser();case 35:e.t0=e.sent,e.next=39;break;case 38:e.t0=void 0;case 39:return b=e.t0,v=[].concat(Object(r.a)(v),Object(r.a)(u)),a.videosSounds=L(s,c),a.favorites=b,a.countriesSounds=f,a.stylesSounds=l,a.yearSounds=p,a.chordSounds=d,a.addUnsortedResults(v),I.addNewQuery(a),e.abrupt("return",a);case 50:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSoundsWithTags",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.t0=Set,e.next=5,A(t,function(e){return n.getSoundsWithTag(e)});case 5:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithTag",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in _)){e.next=2;break}return e.abrupt("return",_[t]);case 2:return e.next=4,h.a.getSoundsWithTag(t);case 4:return n=e.sent,_[t]=n,e.abrupt("return",n);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithVideos",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",void 0);case 2:for(r in n=[],t)n.push(h.a.getSoundsWithVideo(t[r]));return e.next=6,Promise.all(n);case 6:for(s in a=e.sent,o=[],a)o=o.concat(a[s]);return e.abrupt("return",new Set(o));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithDiscogs",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",void 0);case 2:for(r in n=[],t)n.push(h.a.getSoundsWithDiscogs(t[r]));return e.next=6,Promise.all(n);case 6:for(s in a=e.sent,o=[],a)o=o.concat(a[s]);return e.abrupt("return",new Set(o));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithOrTags",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,h.a.getSoundsWithOrTags(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"recursivelySearchOrTags",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=t.length){e.next=2;break}return e.abrupt("return",new Promise(function(e,t){return e(void 0)}));case 2:return n=t[0],e.abrupt("return",new N.a(function(){return h.a.getSoundsWithTag(n)},this.recursivelySearchOrTags(t.slice(1))));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithStyles",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.t0=Set,e.next=5,A(t,function(e){return h.a.getSoundsWithStyle(e)});case 5:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithCountries",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.t0=Set,e.next=5,A(t,function(e){return h.a.getSoundsWithCountry(e)});case 5:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithYear",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.t0=Set,e.next=5,h.a.getSoundsWithYear(this.year);case 5:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsWithChord",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.t0=Set,e.t1=Object,e.next=6,(new R.a).searchRankedNotes(this.chord);case 6:return e.t2=e.sent,e.t3=e.t1.keys.call(e.t1,e.t2),e.abrupt("return",new e.t0(e.t3));case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"intersectResultsForFilters",value:function(e){if(this.selectedOrTags.length>0)return[];var t=!1,n=new Set([]);for(var r in e){var a=e[r];if(void 0!==a)if(n.size>0){if(!(a.size>0))continue;n=M(n,a),t=!0}else!t&&a.size>0&&(n=a)}return Array.from(n)}},{key:"sortTagsByPopularity",value:function(e){var t=this.cache.getAllForField(j.d,0,2e3);return e.sort(function(e,n){return t.indexOf(e)-t.indexOf(n)}),e}},{key:"updateSoundRankings",value:function(){var e=Object(o.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.getOverallVotedRankings();case 2:this.sampleToRanking=e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(P);function L(e,t){if(void 0!==e||void 0!==t){var n=new Set;return e&&e.forEach(function(e){return n.add(e)}),t&&t.forEach(function(e){return n.add(e)}),n}}t.a=F},,function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){return{code:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",uniforms:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},variables:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},functions:arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},closure:arguments.length>4&&void 0!==arguments[4]?arguments[4]:{}}}},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(47),u=n(451),l=n(442),f=(n(15),n(588),function(){function e(t,n,r,a){Object(o.a)(this,e),this.store=t,this.guilds=n,this.encryption=r,this.crypto=a}return Object(s.a)(e,[{key:"addJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,l,f,h,p=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p.length>1&&void 0!==p[1]?p[1]:110,r=p.length>2?p[2]:void 0,i=p.length>3&&void 0!==p[3]?p[3]:u.a,o=p.length>4?p[4]:void 0,i!==u.b){e.next=8;break}return e.next=7,c.a.addJson(t);case 7:return e.abrupt("return",e.sent);case 8:return e.next=10,this.guilds.getGuildKey(o);case 10:return s=e.sent,l=s.rawPublicKey,e.next=14,this.crypto.encryptRawContent(JSON.stringify(t),r,l);case 14:return f=e.sent,e.next=17,c.a.addJson(f.encryptedContent);case 17:return h=e.sent,this.encryption.newEncryptedContent(h,f.encryptedName,f.encryptedContentKey,n,s.publicKey),e.abrupt("return",h);case 20:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,l,f=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:u.a,r=f.length>2?f[2]:void 0,i=f.length>3?f[3]:void 0,n!==u.b){e.next=7;break}return e.next=6,c.a.addBlob(t);case 6:return e.abrupt("return",e.sent);case 7:return e.next=9,this.guilds.getGuildKey(r);case 9:return o=e.sent,s=o.rawPublicKey,i.encryptKey(s),e.next=14,this.crypto.encryptRawContent(t,"",s,!0,i);case 14:return l=e.sent,e.next=17,c.a.addBytesArray(l.encryptedContent);case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addBlob",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,f=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:u.a,f.length>2?f[2]:void 0,n!==u.b){e.next=6;break}return e.next=5,c.a.addBlob(t);case 5:return e.abrupt("return",e.sent);case 6:return e.next=8,this.guilds.getGuildKey();case 8:return r=e.sent,i=r.rawPublicKey,e.next=12,this.crypto.encryptRawContent(t,"",i,!0);case 12:return o=e.sent,e.next=15,c.a.addJson(o.encryptedContent);case 15:return s=e.sent,this.encryption.newEncryptedContent(s,o.encryptedName,o.encryptedContentKey,l.b,r.publicKey),e.abrupt("return",s);case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getEncryptedContentMetadata",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o,s,c,u,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(new Date).getTime(),void 0!==r){e.next=5;break}return e.next=4,this.guilds.getContentGuildId(t,n);case 4:r=e.sent;case 5:if(0!==r){e.next=7;break}return e.abrupt("return",1);case 7:return e.next=9,this.guilds.hasAccessTo(r);case 9:if(e.sent){e.next=12;break}return e.abrupt("return",2);case 12:return o=(new Date).getTime(),o-i,e.next=16,this.guilds.getGuildKey(r);case 16:if(s=e.sent,c=(new Date).getTime(),c-o,u=void 0,!s){e.next=24;break}return e.next=23,this.encryption.getEncryptedContent(t,s.privateKey);case 23:u=e.sent;case 24:if(void 0!==u){e.next=28;break}return e.next=27,this.encryption.getEncryptedContent(t);case 27:u=e.sent;case 28:return l=(new Date).getTime(),l-c,e.abrupt("return",u);case 31:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getJson",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:"QmcfgECwvezrtmVGMywi6epaRMa8NE748V6UiGaBRALeQW",n=s.length>1?s[1]:void 0,r=s.length>2?s[2]:void 0,e.next=5,this.getEncryptedContentMetadata(t,n);case 5:if(1!==(i=e.sent)&&void 0!==i){e.next=12;break}return e.next=9,c.a.getJson(t,r);case 9:return e.abrupt("return",e.sent);case 12:if(2!==i){e.next=14;break}return e.abrupt("return",{});case 14:return e.next=16,this.crypto.fetchAndDecrypt(t,i,void 0,r);case 16:return o=e.sent,e.abrupt("return",JSON.parse(o));case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getSound",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s,u,f=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:"QmYPK9KSRnm5LRvZZkrhLD9HJNVoQpbPBkokF1gt8FwZv8",n=f.length>1?f[1]:void 0,r=new Date,e.next=5,this.getEncryptedContentMetadata(t,l.b,n);case 5:if(i=e.sent,o=new Date,o.getTime()-r.getTime(),1!==i&&void 0!==i){e.next=14;break}return e.next=11,c.a.getSound(t);case 11:return e.abrupt("return",e.sent);case 14:if(2!==i){e.next=16;break}return e.abrupt("return",void 0);case 16:return e.next=18,this.crypto.fetchAndDecrypt(t,i,!0);case 18:return s=e.sent,u=new Date,u.getTime()-r.getTime(),e.abrupt("return",s);case 22:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"guildId",get:function(){var e=this.store.getState().guilds.selectedGuild;return e?e.guildId:0}}]),e}());t.a=f},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=(n(15),n(43));function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(e){Object(s.a)(n,e);var t=h(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this)).track=e,i.mute=r,i}return Object(i.a)(n,[{key:"getValue",value:function(){return this.mute?0:1}},{key:"isSkippable",value:function(){return!1}},{key:"executeEvent",value:function(e){this.subSequence.tracks[this.track.trackNumber].mute(this.mute,!0)}},{key:"getType",value:function(){return f.m}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{trackNumber:this.track.trackNumber,mute:this.mute})}},{key:"fromJson",value:function(e,t){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.track=t.tracks[e.trackNumber],this.mute=e.mute,this}}]),n}(l.a);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(15),o=n.n(i),s=n(77),c=n(89),u=new o.a.Time("16n"),l=function(){function e(t,n,a,i,s){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;Object(r.a)(this,e),this.sequencerEngine=i,this.track=t,this._velocity=c,this.startTime=o.a.Master.context.currentTime,this.currentStep=i.getCurrentStep(a,t),this.currentGlobalStep=i.lastTrackStep,this.currentStepUnquantized=i.trackStepReal,this.ogCurrentStepUnquantized=this.currentStepUnquantized,this.currentStepTime=i.currentStepTime,t.subSequence.isTrack||(this.currentStepUnquantized=this.track.getPatternStep(this.currentStepUnquantized)),this.currentStep=this.track.getPatternStep(this.currentStep),this.currentGlobalStep=this.track.getPatternStep(this.currentGlobalStep),this.quantized=s,this.trackNumber=t?t.trackNumber:0,this.sliceNumber=n,this.resolution=a,this.rolling=!!t&&t.rolling}return Object(a.a)(e,[{key:"velocity",get:function(){return null===this._velocity?this.track.trackData.velocity:this._velocity}},{key:"getDuration",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.quantized,t=o.a.Master.context.currentTime,n=void 0,r=void 0,a=u.toMilliseconds()/1e3;if((void 0===this.currentStepTime||Math.abs(this.currentStepTime-this.startTime)>a)&&e){var i=Math.max(this.currentGlobalStep,0);n=(r=(this.sequencerEngine.lastTrackStep-i)/2)*u.toMilliseconds()}else r=(n=new o.a.Time(t).toMilliseconds()-new o.a.Time(e?this.currentStepTime:this.startTime).toMilliseconds())/u.toMilliseconds();return{duration:n,durationSixteenths:r}}},{key:"record",value:function(e,t,n){t=t||this.track,n=n||t.trackData.transpose,e=e||t.sequencerEngine;var r=this.getDuration(),a=r.duration,i=r.durationSixteenths,c=(new o.a.Time(this.startTime).toMilliseconds()-new o.a.Time(this.currentStepTime).toMilliseconds())/new o.a.Time("32n").toMilliseconds();if(this.quantized){c=Math.max(0,c);var u=this.currentStepUnquantized+c;u=this.resolution.transformStepAtResolution2(u,s.a.baseResolution),u=Math.round(u),t.subSequence.isTrack||(u%=this.track.pattern.length(this.resolution)),isNaN(u)&&(u=0),t.recordHit(u,this.resolution,this.sliceNumber,i,n,this.velocity,this.release)}else{new o.a.Time(this.startTime).toMilliseconds(),new o.a.Time(this.currentStepTime).toMilliseconds(),new o.a.Time("32n").toMilliseconds();if(this.rolling)for(var l=this.getNumberOfRollsForDuration(a,t),f=32/this.resolution.numSteps(),h=this.getDurationOfRollTime(t),p=this.currentStepUnquantized+c;p<=this.currentStepUnquantized+f*l;p+=f){var d=Math.floor(p),m=p-d;t.recordUnquantizedHit(d,this.sliceNumber,h,m,n,this.velocity)}else t.recordUnquantizedHit(this.ogCurrentStepUnquantized,this.sliceNumber,i,c,n,this.velocity,this.release)}}},{key:"getDurationOfRollTime",value:function(e){return this.resolution.getTimeInStep().toMilliseconds()/u.toMilliseconds()}},{key:"getStepsInRollTime",value:function(e){var t=this.resolution,n=t.numSteps()/t.baseResolution,r=t.numSteps();return 32===r?n:48===r?n:16===r?2*n:24==r?2*n:8===r?4*n:12===r?4*n:4===r?8*n:6==r?8*n:null}},{key:"getRollResolution",value:function(e){var t=e.liveEffects.getEffect(c.f),n=this.resolution;return t&&((n=n.getCopy()).resolution*=t.rollFactor),n}},{key:"getNumberOfRollsForDuration",value:function(e,t){return e/this.resolution.getTimeInStep().toMilliseconds()}}]),e}();t.a=l},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12);t.a=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.name,n=e.children;return a.a.createElement("div",{className:"sub-menu menu-item"},a.a.createElement("div",{className:"sub-menu-name"},t),a.a.createElement("div",{className:"arrow-right"}),a.a.createElement("div",{className:"sub-menu-children"},n))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.min,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.max;Object(r.a)(this,e),this.parameter=t,this.min=n,this.max=a}return Object(a.a)(e,[{key:"getJson",value:function(){return{min:this.min,max:this.max}}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=(n(15),function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(a.a)(this,e),this.effectNumber=t,this.parameter=n,this.value=r,this.automationContext=i}return Object(i.a)(e,[{key:"setAtTime",value:function(e,t){this.parameter.set(this.value,void 0,void 0,e)}},{key:"getJson",value:function(){return Object(r.a)({},this.automationContext,{effectNumber:this.effectNumber,parameterName:this.parameter.name,value:this.value})}},{key:"getCopy",value:function(){return new e(this.effectNumber,this.parameter,this.value,this.automationContext)}}]),e}());t.a=o},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(85),l=n(21),f=n(15),h=n.n(f);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var d=function(e){Object(o.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Timing",e)).oddOffsetParameter=new l.a("oddTiming",Object(i.a)(a),function(e,t){return t},{documentation:"The delay amount (in 1/32th notes) for even-triggers (according to the resolution)",min:0,max:4,unit:"1/32th",defaultValue:0}),a.registerParameter(a.oddOffsetParameter),a.evenOffsetParameter=new l.a("evenTiming",Object(i.a)(a),function(e,t){return t},{documentation:"The delay amount (in 1/32th notes) for odd-triggers (according to the resolution)",min:0,max:4,unit:"1/32th",defaultValue:0}),a.registerParameter(a.evenOffsetParameter),a.probabilityParameter=new l.a("probability",Object(i.a)(a),function(e,t){return t},{documentation:"The probability that this effect will occur on a given trigger.",min:0,max:100,unit:"",defaultValue:100}),a.registerParameter(a.probabilityParameter),a.resolutionParameter=new l.a("resolution",Object(i.a)(a),function(e,t){return t},{min:1,max:32,unit:"",defaultValue:2}),a.registerParameter(a.resolutionParameter),a}return Object(a.a)(n,[{key:"getVisualizedParameters",value:function(){return[this.oddOffsetParameter,this.evenOffsetParameter]}},{key:"getText",value:function(){return this.resolution.toString()+" "+this.evenOffset+", "+this.oddOffset}},{key:"documentation",get:function(){return"Controls the swing of a track by dividing triggers by a resolution and delaying them seperately"}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"needsStableLookAhead",value:function(){return!0}},{key:"oddOffset",get:function(){return this.oddOffsetParameter.get()},set:function(e){this.oddOffsetParameter.set(e)}},{key:"evenOffset",get:function(){return this.evenOffsetParameter.get()},set:function(e){this.evenOffsetParameter.set(e)}},{key:"probability",get:function(){return this.probabilityParameter.get()},set:function(e){this.probabilityParameter.set(e)}},{key:"resolution",get:function(){return this.resolutionParameter.get()},set:function(e){return this.resolutionParameter.set(e)}},{key:"output",value:function(){for(var e in this.triggers){var t=this.triggers[e],n=t.time;if(Math.random()<=this.probability/100){var r=Math.floor(t.stepNumber/this.resolution)%2==0?this.evenOffset:this.oddOffset;t.time=n+r*new h.a.Time("32n").toMilliseconds()/1e3}}return this.triggers}}]),n}(u.a);t.a=d},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(85),h=(n(61),n(101)),p=(n(221),n(21)),d=(n(33),n(256),n(15));function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var v=new(n.n(d).a.Time)("32n"),b=function(e){Object(c.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Chord Rhythm",e)).durationFactorParameter=new p.a("durationFactor",Object(o.a)(r),function(e,t){return[]},{defaultValue:1,min:0,max:2,unit:""}),r.registerParameter(r.durationFactorParameter),r.oddDelayTimeParameter=new p.a("oddDelayTime",Object(o.a)(r),function(e,t){return[]},{defaultValue:1,min:.01,max:16,unit:""}),r.registerParameter(r.oddDelayTimeParameter),r.evenDelayTimeParameter=new p.a("evenDelayTime",Object(o.a)(r),function(e,t){return[]},{defaultValue:1,min:.01,max:16,unit:""}),r.registerParameter(r.evenDelayTimeParameter),r.delayTimeFactorParameter=new p.a("delayTimeFactor",Object(o.a)(r),function(e,t){return[]},{defaultValue:1,min:.01,max:4,unit:""}),r.registerParameter(r.delayTimeFactorParameter),r.evenVelocityParameter=new p.a("evenVelocity",Object(o.a)(r),function(e,t){return[]},{defaultValue:1,min:.01,max:1,unit:""}),r.registerParameter(r.evenVelocityParameter),r.oddVelocityParameter=new p.a("oddVelocity",Object(o.a)(r),function(e,t){return[]},{defaultValue:1,min:.01,max:1,unit:""}),r.registerParameter(r.oddVelocityParameter),r.repeatsParameter=new p.a("repeats",Object(o.a)(r),function(e,t){return[]},{defaultValue:1,min:1,max:8,unit:""}),r.registerParameter(r.repeatsParameter),r.syncedParameter=new p.a("synced",Object(o.a)(r),function(e,t){return[]},{defaultValue:!0,min:!1,max:!0,unit:""}),r.registerParameter(r.syncedParameter),r.velocitySpreadParameter=new p.a("velocitySpread",Object(o.a)(r),function(e,t){return[]},{defaultValue:50,min:0,max:100,unit:""}),r.registerParameter(r.velocitySpreadParameter),r.velocityParameter=new p.a("velocity",Object(o.a)(r),function(e,t){return[]},{defaultValue:1,min:0,max:1,unit:""}),r.registerParameter(r.velocityParameter),r.delays=[],r.liveTriggers=[],r}return Object(i.a)(n,[{key:"onNewStep",value:function(){this.triggers=[]}},{key:"removeNote",value:function(e,t){arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gated;this.delays=this.delays.filter(function(t){return t.trigger.stepData.transpose!==e})}},{key:"input",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.liveTriggers.push(e):Object(s.a)(Object(l.a)(n.prototype),"input",this).call(this,e)}},{key:"clear",value:function(){this.triggers=[],this.delays=[]}},{key:"oddDelayTime",get:function(){return this.oddDelayTimeParameter.get()}},{key:"synced",get:function(){return this.syncedParameter.get()}},{key:"repeats",get:function(){return this.repeatsParameter.get()}},{key:"evenDelayTime",get:function(){return this.evenDelayTimeParameter.get()}},{key:"durationFactor",get:function(){return this.durationFactorParameter.get()}},{key:"delayTimeFactor",get:function(){return this.delayTimeFactorParameter.get()}},{key:"velocitySpread",get:function(){return this.velocitySpreadParameter.get()/100}},{key:"oddVelocity",get:function(){return Math.max(0,Math.sqrt(this.velocitySpread)-.2)}},{key:"velocity",get:function(){return this.velocityParameter.get()}},{key:"evenVelocity",get:function(){var e=1-this.velocitySpread;return Math.max(0,Math.sqrt(e)-.2)}},{key:"getDelayTrigger",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(e.time-t)/v;return r=n?0:r,{stepNumber:e.stepNumber,stepOffset:r,trigger:this.copyTrigger(e),duration:n?void 0:e.stepData.duration,repeats:1,elapsed:0,even:!0}}},{key:"copyTrigger",value:function(e){var t=this.getStep(e.stepData,void 0,void 0,!1);return new h.a(t,e.time,e.stepNumber,e.outputNumber)}},{key:"output",value:function(e,t,n){var a=this;for(var i in this.triggers){var o=this.triggers[i];this.delays.push(this.getDelayTrigger(o,e))}for(var s in this.liveTriggers){var c=this.liveTriggers[s];c.stepNumber=t,this.delays.push(this.getDelayTrigger(c,e,!0))}var u=[],l=void 0,f=void 0,h=function(n){var i=a.delays[n],o=i.repeats/a.repeats%2==0,s=o?a.evenDelayTime:a.oddDelayTime;s*=a.delayTimeFactor;var c=o?a.evenVelocity:a.oddVelocity;if(c*=a.velocity,0===i.elapsed||a.shouldPlayDelay(i,t,i.isEven?a.evenDelayTime:a.oddDelayTime)){var h=a.getTimesToPlay(i,e,s),p=h.map(function(e){return a.getTriggerToPlay(i.trigger,e.timeToPlay,t,c,s)});u=[].concat(Object(r.a)(u),Object(r.a)(p)),l=t,f=h[h.length-1].offset,i.isEven=o,i.stepNumber=t,i.stepOffset=f,i.repeats++}i.elapsed++};for(var p in this.delays)h(p);return this.synced&&void 0!==l&&this.delays.forEach(function(e){e.stepNumber=l,e.stepOffset=f}),this.delays=this.delays.filter(function(e){return void 0===e.duration||e.elapsed<2*e.duration}),this.liveTriggers=[],u}},{key:"getTriggerToPlay",value:function(e,t,n,r,a){var i=this.copyTrigger(e);return i.time=t,i.stepData.duration=this.durationFactor*(a/2),i.stepNumber=n,i.stepData.velocity*=r,i}},{key:"shouldPlayDelay",value:function(e,t,n){var r=t,a=t+1,i=((e.stepNumber+e.stepOffset)%this.patternLength+n)%this.patternLength;return r<=i&&i<a}},{key:"getTimesToPlay",value:function(e,t,n){for(var r=((e.stepNumber+e.stepOffset)%this.patternLength+n)%this.patternLength,a=r-Math.floor(r),i=[];a<1;a+=n)i.push({timeToPlay:t+a*v,offset:a});return i}},{key:"patternLength",get:function(){return this.track.length}},{key:"isRealTime",value:function(){return!1}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(f.a);t.a=b},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(85),l=n(646);n(610);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var h=function(e){Object(o.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Midi Interface",e)).ccParameters=[],a.midiOutput=void 0,a}return Object(a.a)(n,[{key:"setConfig",value:function(e,t){if(this.midiOutput=e,this.midiCC=this.track.sequencerEngine.midi.deviceToMidiCC[e.name],this.midiDeviceName=e.name,void 0!==this.midiCC)for(var n in t){var r=t[n],a={};for(var i in r){var o=r[i];for(var s in a[i]={},o){var c=o[s],u=new l.a(s,c,this.midiCC);this.registerParameter(u),a[i][s]=u}}this.ccParameters.push(a)}}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"output",value:function(e,t,n){return this.triggers}},{key:"getJson",value:function(){var e=Object(i.a)(Object(c.a)(n.prototype),"getJson",this).call(this);e.midiOutput=this.midiOutput.name;var t=[];for(var r in this.ccParameters){var a=this.ccParameters[r],o={};for(var s in a){var u=a[s],l={};for(var f in u){var h=u[f];l[h.name]=h.getJson()}o[s]=l}t.push(o)}return e.config=t,e}},{key:"fromJson",value:function(e,t){Object(i.a)(Object(c.a)(n.prototype),"fromJson",this).call(this,e,t);var r=this.track.sequencerEngine.midi;if(void 0!==r){var a=r.controllerOutputs.filter(function(t){return t.name===e.midiOutput})[0];if(void 0!==a){for(var o in this.midiOutput=a,this.track.addMidiOutput(a,!0),this.midiCC=this.track.sequencerEngine.midi.deviceToMidiCC[a.name],e.config){var s=e.config[o];for(var u in s){var f=s[u];for(var h in f){var p=f[h],d=new l.a(h,p.ccNumber,this.midiCC);d.fromJson(p,this.track.sequencerEngine),this.registerParameter(d),f[h]=d}}}this.ccParameters=e.config}}}}]),n}(u.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(15),o=n.n(i),s=n(29),c=n(71),u=n(41),l=n(21),f=n(23),h=(new s.a,function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(r.a)(this,e),this.parameters=[],this.effect=t,this.sequencerEngine=n,this.store=n.store,this.gain=new o.a.Gain(1),this.gainParameter=new u.c("Gain",this.gain.gain,{min:0,max:1,unit:"db",defaultValue:1}),this.registerParameter(this.gainParameter),this.probabilityParameter=new l.a("Probability",this,function(){return[]},{min:0,max:100,unit:"%",defaultValue:100}),this.registerParameter(this.probabilityParameter),t&&t.connect&&(t.effectNode?this.gain.connect(t.effectNode):this.gain.connect(t)),this.outputNumber=a}return Object(a.a)(e,[{key:"getWeight",value:function(e,t){return e.getEffectType()===c.c?this.probability/100:this.gainParameter.get()}},{key:"probability",get:function(){return this.probabilityParameter.get()}},{key:"registerParameter",value:function(e){void 0!==e&&(e.name=e.name,e.effectName=this.name,e.setStore(this.store),this.parameters.push(e))}},{key:"getCopy",value:function(){var t=new e(this.effect,this.sequencerEngine);return t.gainParameter.set(t.gainParameter.get()),t.outputNumber=this.outputNumber,t}},{key:"getJson",value:function(e){var t={effect:e.effects.indexOf(this.effect),gain:this.gainParameter?this.gainParameter.get():1,probability:this.probability,outputNumber:this.outputNumber};return this.gainParameter&&(t=Object(f.b)(t,"gainParameter",this.gainParameter)),t=Object(f.b)(t,"probabilityParameter",this.probabilityParameter)}},{key:"fromJson",value:function(e,t){this.gainParameter.set(e.gain),void 0!==e.probability&&this.probabilityParameter.set(e.probability),Object(f.a)(e,"gainParameter",this.gainParameter),Object(f.a)(e,"probabilityParameter",this.probabilityParameter),this.effect=t.effects[e.effect],this.outputNumber=void 0===e.outputNumber?0:e.outputNumber,this.effect||(this.effect=t.outputNode),void 0!==this.effect.connect&&(this.effect.effectNode?this.gain.connect(this.effect.effectNode):this.gain&&this.gain.connect(this.effect))}},{key:"dispose",value:function(){this.gainParameter&&(this.gainParameter.dispose(),this.gainParameter=void 0),this._disposed=!0}}]),e}());t.a=h},function(e,t,n){"use strict";var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=(n(15),n(43)),l=n(6),f=(n(33),n(198),n(501),n(363),n(424),n(364),n(601),n(502),n(603),n(604),n(234),n(238),n(645)),h=function(){function e(t,n){Object(s.a)(this,e),this.type=t,this.events=[],this.counter=0,this.subSequence=n}return Object(c.a)(e,[{key:"getMixType",value:function(){return u.b}},{key:"seekToTrackStep",value:function(e){this.events.length>0&&this.events[this.events.length-1].step<e||this.restart()}},{key:"restart",value:function(){this.counter=0,this.events.forEach(function(e){return e.restart()})}},{key:"scheduleNext",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n,r){var a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:0==t&&this.restart(),a=this.counter,o=this.events;case 3:if(!(a<o.length)){e.next=19;break}if(t!==o[a].step){e.next=8;break}o[a].scheduleEvent(n,r,o[a+1]),e.next=16;break;case 8:if(!(t>o[a].step)||o[a].isSkippable()){e.next=12;break}o[a].scheduleEvent(0-o[a].time,r,o[a+1]),e.next=16;break;case 12:if(!(t<o[a].step)){e.next=16;break}return e.abrupt("break",19);case 16:a++,e.next=3;break;case 19:this.counter=a;case 20:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"eraseEventsAtStep",value:function(e){this.events=this.events.filter(function(t){return t.step!=e})}},{key:"schedule",value:function(){this.events.forEach(function(e){return e.scheduleEvent()})}},{key:"getJson",value:function(){return{type:this.type,events:this.events.map(function(e){return e.getJson()}).filter(function(e){return void 0!==e})}}},{key:"getCopy",value:function(){var t=new e(this.type);return t.events=this.events,t}},{key:"loadFromJson",value:function(e,t,n){for(var r in e.events){var a=e.events[r],i=Object(f.a)(a,this.type,t,n);void 0!==i&&(this.events.length>0&&i.step<this.events[this.events.length-1].step&&e.length-r>=500&&(this.events=[]),this.events.push(i))}}},{key:"calculateDurations",value:function(){var e=void 0,t=[];for(var n in this.events){var r=this.events[n];void 0===r||r.isEmpty()||(void 0===e||e.rolling||r.rolling)&&(t.push(r),void 0!==e&&(e.duration=this.events[n].step-e.step),e=this.events[n])}this.events=t}},{key:"clear",value:function(){this.events=[],this.counter=0}},{key:"getNextEvent",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.counter:0;t<this.events.length;t++)if(e.step<this.events[t].step)return this.events[t]}},{key:"getPreviousEvent",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=void 0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?Math.max(0,this.counter-1):0;r<this.events.length;r++){if(t&&e.step<=this.events[r].step)return n;if(!t&&e.step<this.events[r].step)return n;n=this.events[r]}return n}},{key:"updateRedux",value:function(e,t){t.store.dispatch(Object(l.md)(e.id,this.type,Object(r.a)(this.events)))}},{key:"prune",value:function(){this.events.every(function(e){return e.isPrunable()})&&(this.events=[]);var e=void 0,t=[];for(var n in this.events){var r=this.events[n];void 0!==e&&r.isPrunable()&&e.isPrunable()||(void 0===e&&r.isPrunable()||(t.push(r),e=r))}this.events=t}},{key:"getEventsBetween",value:function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.events.filter(function(n){return n.step>=e&&n.step<=t}):this.events.filter(function(n){return n.step>=e&&n.step<t})}}]),e}();t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var u=function(e){Object(i.a)(n,e);var t=c(n);function n(e,a,i,o){var s;return Object(r.a)(this,n),(s=t.call(this,e,a.getType())).event=a,s.time=i,s.trackStep=o,s}return Object(a.a)(n,[{key:"events",get:function(){return this.mixByType.events},set:function(e){this.mixByType.events=e}},{key:"counter",get:function(){return this.mixByType.counter},set:function(e){this.mixByType.counter=e}},{key:"execute",value:function(){if(this.event.setTime(this.time,this.trackStep),0==this.events.length||this.events[this.events.length-1].step<=this.trackStep)this.events.push(this.event);else{for(var e=0,t=this.events.length-1,n=void 0;e<=t;){if(n=Math.floor((e+t)/2),this.events[n].step<this.trackStep)e=n+1;else{if(!(this.events[n].step>this.trackStep))break;t=n-1}if(n>=1&&this.events[n-1].step<=this.trackStep&&this.events[n].step>=this.trackStep)break}this.events[n].step===this.trackStep?this.events[n]=this.event:this.events=this.events.slice(0,n).concat([this.event]).concat(this.events.slice(n)),this.counter=n,this.event.subSequence=this.mix.subSequence}}}]),n}(n(130).a);t.a=u},function(e,t,n){"use strict";n.d(t,"a",function(){return r});n(232),n(56);function r(e){return[]}},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(56),f=n(32),h=n(15),p=n.n(h),d=n(41);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Ultra Phaser",function(){return new p.a.Gain(1)},e)).poles=8,r.generateAllPassFilters(),r.rateParameter=new d.c("Rate",r.lfo.frequency,{documentation:"The speed of the sweeping.",defaultValue:.25,min:0,max:16}),r.registerParameter(r.rateParameter),r.feedbackParameter=new d.c("Feedback",r.feedbackNode.gain,{documentation:"The amount of signal that is fed back into the effect.",defaultValue:.1,min:0,max:1}),r.registerParameter(r.feedbackParameter),r.wetParameter=new d.c("Wet",r.crossFade.fade,{documentation:"Controls the amount of (wet) effected signal, vs. dry (un-effected) signal.",defaultValue:.5,min:0,max:1}),r.registerParameter(r.wetParameter),r.depthParameter=new d.a("Depth",r.lfo._scaler._scale,function(e,t){r.lfo.max=t},{documentation:"The depth of the modulation, controlling how much it sweeps on each cycle.",min:0,max:1,unit:"",defaultValue:.5,automatable:!1}),r.registerParameter(r.depthParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"dispose",value:function(){Object(o.a)(Object(u.a)(n.prototype),"dispose",this).call(this),this.filters.forEach(function(e){return e.dispose()}),this.scalers.forEach(function(e){return e.dispose()}),this.crossFade.dispose(),this.lfo.dispose(),this.feedbackNode.dispose(),this.outputNode.dispose(),this.filters=void 0,this.scalers=void 0,this.crossFade=void 0,this.lfo=void 0,this.feedbackNode=void 0,this.outputNode=void 0,this.feedbackParameter=void 0,this.depthParameter=void 0,this.wetParameter=void 0,this.rateParameter=void 0}},{key:"generateAllPassFilters",value:function(){var e=this;this.filters=[],this.scalers=[];for(var t=100,n=0;n<this.poles;n++){var r=new p.a.Filter(t,"allpass");this.filters.push(r);var a=new p.a.Scale(t,t+4e3);a.connect(r.frequency),this.scalers.push(a),t+=1e3}this.outputNode=new p.a.Gain(1),this.lfo=new p.a.LFO("1n",0,1),this.filters.forEach(function(t,n){return e.lfo.connect(e.scalers[n])});var i=this.effectNode;for(var o in this.filters)i.connect(this.filters[o]),i=this.filters[o];this.lfo.start(),this.crossFade=new p.a.CrossFade(0),this.crossFade.connect(this.outputNode),this.effectNode.connect(this.crossFade,0,0),i.connect(this.crossFade,0,1),this.feedbackNode=new p.a.Gain(.2),i.connect(this.feedbackNode),this.feedbackNode.connect(this.filters[0])}},{key:"documentation",value:function(){return"Sweeping effect where signal is filtered, and the position of peaks and troughs are modulated and varying."}},{key:"connect",value:function(e){this.outputNode.connect(e)}},{key:"disconnect",value:function(e){this.outputNode.disconnect(e)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"getJson",value:function(){var e=Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{rate:this.rateParameter.get(),feedback:this.feedbackParameter.get(),wet:this.wetParameter.get(),depth:this.depthParameter.get()});return e=this.saveParameterToJson(e,"rateParameter",this.rateParameter),e=this.saveParameterToJson(e,"feedbackParameter",this.feedbackParameter),e=this.saveParameterToJson(e,"wetParameter",this.wetParameter),e=this.saveParameterToJson(e,"depthParameter",this.depthParameter)}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return!isNaN(e.rate)&&e.rate&&Object(f.a)(this.rateParameter,e.rate,a),Object(f.a)(this.feedbackParameter,e.feedback,a),Object(f.a)(this.wetParameter,e.wet,a),Object(f.a)(this.depthParameter,e.depth,a),Object(r.a)({},a,this.loadParameterFromJson(e,"rateParameter",this.rateParameter,t),this.loadParameterFromJson(e,"feedbackParameter",this.feedbackParameter,t),this.loadParameterFromJson(e,"wetParameter",this.wetParameter,t),this.loadParameterFromJson(e,"depthParameter",this.depthParameter,t))}}]),n}(l.a.Effect);t.a=v},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(56),f=n(32),h=n(15),p=n.n(h),d=n(41);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Compressor",function(){return new p.a.Gain(1)},e)).effectNode.gain.value=1,r.compressorNode=new p.a.Compressor(-24,3),r.effectNode.connect(r.compressorNode),r.gainParameter=new d.c("Gain",r.effectNode.gain,{documentation:"Controls the gain (or loudness) of the signal before it hits the compressor",min:0,max:1,unit:"db",defaultValue:1}),r.registerParameter(r.gainParameter),r.thresholdParameter=new d.c("Threshold",r.compressorNode.threshold,{documentation:"The threshold of volume at which the compressor begins to compress.",min:-80,max:0,unit:"",defaultValue:-4,constantAutomationRate:!0,automatable:!1}),r.registerParameter(r.thresholdParameter),r.ratioParameter=new d.c("Ratio",r.compressorNode.ratio,{documentation:"The amount of compression that occurs once the signal passes the threshold.",min:1,max:24,unit:"",defaultValue:3,constantAutomationRate:!0}),r.registerParameter(r.ratioParameter),r.attackParameter=new d.b("Attack",r.compressorNode.attack,{constantAutomationRate:!0}),r.registerParameter(r.attackParameter),r.releaseParameter=new d.b("Release",r.compressorNode.release,{constantAutomationRate:!0}),r.registerParameter(r.releaseParameter),r.releaseParameter.set(.15),r.kneeParameter=new d.c("Knee",r.compressorNode.knee,{min:0,max:40,unit:"db",defaultValue:1,constantAutomationRate:!0}),r.registerParameter(r.kneeParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"documented",get:function(){return"Reduces the volume of loud sounds or amplifies quiet sounds."}},{key:"dispose",value:function(){Object(o.a)(Object(u.a)(n.prototype),"dispose",this).call(this),this.compressorNode.dispose(),this.compressorNode=void 0}},{key:"connect",value:function(e){this.connectedNode=e,this.compressorNode.connect(e)}},{key:"disconnect",value:function(e){null!=this.connectedNode&&(this.compressorNode.disconnect(e),this.connectedNode=null)}},{key:"getJson",value:function(e){var t=Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this);return t.name=this.name,t.gain=this.gainParameter.get(),t.threshold=this.thresholdParameter.get(),t.ratio=this.ratioParameter.get(),t.release=this.releaseParameter.get(),t.attack=this.attackParameter.get(),t.knee=this.kneeParameter.get(),t.enabled=this.enabledParameter.get(),t=this.saveParameterToJson(t,"gainParameter",this.gainParameter),(this.thresholdParameter.isConnectedToAnyModulator()||Object.keys(this.thresholdParameter.patternToValue).length>0)&&(t.thresholdParameter=this.thresholdParameter.getJson()),(this.ratioParameter.isConnectedToAnyModulator()||Object.keys(this.ratioParameter.patternToValue).length>0)&&(t.ratioParameter=this.ratioParameter.getJson()),(this.releaseParameter.isConnectedToAnyModulator()||Object.keys(this.releaseParameter.patternToValue).length>0)&&(t.releaseParameter=this.releaseParameter.getJson()),(this.attackParameter.isConnectedToAnyModulator()||Object.keys(this.attackParameter.patternToValue).length>0)&&(t.attackParameter=this.attackParameter.getJson()),this.kneeParameter.isConnectedToAnyModulator()|Object.keys(this.kneeParameter.patternToValue).length>0&&(t.kneeParameter=this.kneeParameter.getJson()),t}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return"gain"in e&&Object(f.a)(this.gainParameter,e.gain,a),"threshold"in e&&Object(f.a)(this.thresholdParameter,e.threshold,a),"ratio"in e&&Object(f.a)(this.ratioParameter,e.ratio,a),"release"in e&&Object(f.a)(this.releaseParameter,e.release,a),"attack"in e&&Object(f.a)(this.attackParameter,e.attack,a),"knee"in e&&Object(f.a)(this.kneeParameter,e.knee,a),e.enabled&&this.enable(!0),Object(r.a)({},a,this.loadParameterFromJson(e,"gainParameter",this.gainParameter,t),this.loadParameterFromJson(e,"thresholdParameter",this.thresholdParameter,t),this.loadParameterFromJson(e,"ratioParameter",this.ratioParameter,t),this.loadParameterFromJson(e,"releaseParameter",this.releaseParameter,t),this.loadParameterFromJson(e,"attackParameter",this.attackParameter,t),this.loadParameterFromJson(e,"kneeParameter",this.kneeParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(l.a.Effect);t.a=v},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(16),s=n(7),c=n(10),u=n(1),l=n(381),f=n(21),h=n(89);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var d=function(e){Object(s.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Roll Effect",h.f,e)).rollFactorParameter=new f.a("Roll Factor",Object(i.a)(a),function(e,t){return t},{min:.125,max:8,unit:"x",defaultValue:1}),a.registerParameter(a.rollFactorParameter),a.modeParameter=new f.b("Mode",Object(i.a)(a),function(e,t){return t},{min:h.a,max:h.b,unit:"",defaultValue:h.g}),a.registerParameter(a.modeParameter),a}return Object(a.a)(n,[{key:"mode",get:function(){return this.modeParameter.get()},set:function(e){this.modeParameter.set(e)}},{key:"rollFactor",get:function(){return this.rollFactorParameter.get()},set:function(e){this.rollFactorParameter.set(e)}},{key:"getJson",value:function(){var e=Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this);return e.rollFactor=this.rollFactor,e.mode=this.mode,e=this.saveParameterToJson(e,"rollFactorParameter",this.rollFactorParameter),e=this.saveParameterToJson(e,"modeParameter",this.modeParameter)}},{key:"fromJson",value:function(e){Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.mode=e.mode,this.rollFactor=e.rollFactor,this.loadParameterFromJson(e,"rollFactorParameter",this.rollFactorParameter),this.loadParameterFromJson(e,"modeParameter",this.modeParameter)}},{key:"getCopy",value:function(e){var t=new n(e);return t.fromJson(this.getJson()),t}}]),n}(l.a);t.a=d},function(e,t,n){"use strict";function r(e){return parseInt(e.numSteps())/4}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(70),u=n(40),l=n(44),f=n(65),h=n(31),p=l.y.SEQUENCE_METADATA.options.address,d={},m={},v=new(function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,[{key:"tagSequence",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:0,e.abrupt("return",new c.a(l.u,"tagSequence",[Object(f.c)(t),Object(f.b)(n),r]).execute());case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"starSequence",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:0,e.abrupt("return",new c.a(l.u,"starSequence",[Object(f.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"favoriteSequence",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:0,e.abrupt("return",new c.a(l.u,"favoriteSequence",[Object(f.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"unstarSequence",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:0,e.abrupt("return",new c.a(l.u,"unstarSequence",[Object(f.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"unfavoriteSequence",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:0,e.abrupt("return",new c.a(l.u,"unfavoriteSequence",[Object(f.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"isSequenceFavorited",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=n.toLowerCase(),!((r=t+n)in d)){e.next=4;break}return e.abrupt("return",d[r]);case 4:return e.next=6,new u.a(p).from(h.jb).select("ipfsHash").where("ipfsHash",t).where("user",n).executeQuery();case 6:return i=e.sent,e.next=9,new u.a(p).from(h.mb).select("ipfsHash").where("ipfsHash",t).where("user",n).executeQuery();case 9:return o=e.sent,s=i.length-o.length,d[r]=s>0,e.abrupt("return",d[r]);case 13:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"isSequenceStarred",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in m)){e.next=2;break}return e.abrupt("return",m[t]);case 2:return e.next=4,new u.a(p).from(h.kb).select("ipfsHash").where("ipfsHash",t).executeQuery();case 4:return n=e.sent,e.next=7,new u.a(p).from(h.nb).select("ipfsHash").where("ipfsHash",t).executeQuery();case 7:return r=e.sent,m[t]=n.length-r.length>0,e.abrupt("return",m[t]);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTags",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new u.a(p).from(h.lb).select("tag").where("ipfsHash",t).executeQuery();case 2:return n=e.sent,e.abrupt("return",n.map(function(e){return e.tag}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getStarredSequences",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s,c,l=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.length>0&&void 0!==l[0]?l[0]:0,e.next=3,new u.a(p).from(h.kb).select("ipfsHash").where("guildId",0).executeQuery();case 3:return t=e.sent,e.next=6,new u.a(p).from(h.nb).select("ipfsHash").where("guildId",0).executeQuery();case 6:for(i in n=e.sent,r={},t)(o=t[i]).ipfsHash in r||(r[o.ipfsHash]=0),r[o.ipfsHash]++;for(s in n)(c=n[s]).ipfsHash in r||(r[c.ipfsHash]=0),r[c.ipfsHash]--;return e.abrupt("return",Object.keys(r).filter(function(e){return r[e]>0}));case 11:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getFavoritedSequences",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,l,f,d=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:0,t=t.toLowerCase(),e.next=4,new u.a(p).from(h.jb).select("ipfsHash").where("user",t).where("guildId",n).executeQuery();case 4:return r=e.sent,e.next=7,new u.a(p).from(h.mb).select("ipfsHash").where("user",t).executeQuery();case 7:for(s in i=e.sent,o={},r)(c=r[s]).ipfsHash in o||(o[c.ipfsHash]=0),o[c.ipfsHash]++;for(l in i)(f=i[l]).ipfsHash in o||(o[f.ipfsHash]=0),o[f.ipfsHash]--;return e.abrupt("return",Object.keys(o).filter(function(e){return o[e]>0}));case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getFavorites",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,l,f,d,m,v,b;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new u.a(p).from(h.jb).select("ipfsHash").select("user").where("ipfsHash",t).executeQuery();case 2:return n=e.sent,e.next=5,new u.a(p).from(h.mb).select("ipfsHash").select("user").where("ipfsHash",t).executeQuery();case 5:for(s in r=e.sent,i={},o={},n)c=n[s],(l=n[s].user)in i||(i[l]=0,o[l]=[]),i[l]++,o[l].push(c);for(f in r)r[f],(d=r[f].user)in i||(i[d]=0),i[d]--;m=[],e.t0=a.a.keys(i);case 12:if((e.t1=e.t0()).done){e.next=20;break}if(v=e.t1.value,!(i[v]<=0)){e.next=16;break}return e.abrupt("continue",12);case 16:b=o[v],m.push(b[b.length-1]),e.next=12;break;case 20:return e.abrupt("return",m);case 21:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),e}());t.a=v},function(e,t,n){"use strict";var r=n(8),a=n(9),i=n(2),o=n(4),s=n(7),c=n(10),u=n(1),l=n(101),f=n(542),h=n(162),p=n(6),d=n(57),m=(n(509),n(510),n(15)),v=n.n(m),b=n(206),g=n(186),y=n(214),k=(n(250),n(111)),O=n(61);function j(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var S=n(379),P=n(342),x=n(768);function T(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var R=function(e){Object(s.a)(n,e);var t=N(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this)).track=e,r.initCache(),r.receivedTriggers=[],r.effects=[],r.inputedTriggers=[],r.noteToTriggers={},r.stepNumber=0,r.times=[],r.setupMessageReader(),r}return Object(o.a)(n,[{key:"addEffect",value:function(e){e&&(this.effects=[].concat(Object(a.a)(this.effects),[e]),this.linkEffectParameters(),e.track=this.track||this._subSequence,e._subSequence=this._subSequence)}},{key:"getEffectById",value:function(e){return this.effects.find(function(t){return t.id===e})}},{key:"getCopy",value:function(e,t){var r=new n(e);return r.effects=this.effects.map(function(n){return n.getCopy(e,t)}),r.linkEffectParameters(),r}},{key:"linkEffectParameters",value:function(){var e=this;this.effects.forEach(function(t){t.registerContext((new d.a).forTrack(e.track)),t.registerMixSession(e.track.mixSession),t.registerTrack(e.track)});var t,n={},a=T(this.effects);try{for(a.s();!(t=a.n()).done;){var i,o=T(t.value.getParameters());try{for(o.s();!(i=o.n()).done;){var s=i.value;n=Object(r.a)({},n,s.setStore(this.track.store))}}catch(c){o.e(c)}finally{o.f()}}}catch(c){a.e(c)}finally{a.f()}this.track.store.dispatch(Object(p.Vb)(n))}},{key:"deleteEffect",value:function(e){var t=this.effects.map(function(e){return e.id}).indexOf(e.id);this.effects.splice(t,1),this.effects=Object(a.a)(this.effects),e.dispose()}},{key:"moveEffectTo",value:function(e,t){if(e!=t){var n=[];e>t?(n=this.effects.slice(0,t).concat([this.effects[e]]).concat(this.effects.slice(t,e)),this.effects.length>e+1&&(n=n.concat(this.effects.slice(e+1)))):(n=this.effects.slice(0,e).concat(this.effects.slice(e+1,t)).concat([this.effects[t],this.effects[e]]),this.effects.length>t+1&&(n=n.concat(this.effects.slice(t+1)))),this.effects=n}}},{key:"needsStableLookAhead",value:function(){return this.effects.some(function(e){return e.needsStableLookAhead()})}},{key:"input",value:function(e,t,n){this.inputedTriggers.push(new l.a(e,t,n))}},{key:"output",value:function(e,t,n){var r=this;this.times.push(e),this.stepNumber=t;var i=[].concat(Object(a.a)(this.inputedTriggers),Object(a.a)(this.receivedTriggers));for(var o in this.receivedTriggers.length=0,i.forEach(function(t){return r.triggerAttackReleasePreFXEnvelopes(e,t)}),this.setNotesDown(i),this.effects){var s=this.effects[o];if(s.isEnabled()){for(var c in i){var u=i[c];s.input(u)}i=s.output(e,t,n)}}return this.triggerAttackReleasePostFXEnvelopes(i),i}},{key:"getDuration",value:function(e){return new v.a.Time("16n")*e}},{key:"subSequence",get:function(){return this.track.subSequence}},{key:"state",get:function(){return this.track.sequencerEngine.state}},{key:"dispatch",value:function(e){this.track.sequencerEngine.dispatch(e)}},{key:"onNewStep",value:function(){this.inputedTriggers=[],this.effects.forEach(function(e){return e.onNewStep()})}},{key:"clear",value:function(){this.effects.forEach(function(e){return e.clear()}),this.receivedTriggers.length=0}},{key:"addEffectJson",value:function(e){var t={},n=Object(g.a)(e,this.track||{sequencerEngine:this.sequencerEngine});if(n)return this.addEffect(n),t=Object(r.a)({},t,n.fromJson(e)),{effect:n,bulk:t}}},{key:"fromJson",value:function(e){var t={};for(var n in e){var a=Object(g.a)(e[n],this.track||{sequencerEngine:this.sequencerEngine});a&&(this.addEffect(a),t=Object(r.a)({},t,a.fromJson(e[n])))}return t}},{key:"getEffectNumber",value:function(e){return this.effects.indexOf(e)}},{key:"getJson",value:function(){return this.effects.map(function(e){return e.getJson()})}},{key:"getAllParameters",value:function(){var e=[];return this.effects.forEach(function(t){return t.getParameters().forEach(function(t){return e.push(t)})}),e}},{key:"getAllPatternLockedParameters",value:function(){return this.getAllParameters().filter(function(e){return e.hasPatternLockedValues()})}},{key:"mate",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=Math.max(e.effects.length,this.effects.length),r=[],a=0;a<n;a++){var i=this.effects[a],o=e.effects[a];Object(h.a)(t)?o&&r.push(o.getCopy(this.track)):i&&r.push(i)}this.effects=r,this.linkEffectParameters()}},{key:"addNoteDown",value:function(e){var t=this.state.keyboard.notesDown||[];this.dispatch(Object(p.xd)([].concat(Object(a.a)(t),[e])))}},{key:"notesDown",get:function(){return this.state.keyboard.notesDown||[]}},{key:"removeNoteDown",value:function(e){var t=this.state.keyboard.notesDown||[],n=(t=Object(a.a)(t)).indexOf(e);t.splice(n,1),this.dispatch(Object(p.xd)(t))}},{key:"setNotesDown",value:function(e){var t=this;if(0!==e.length&&!v.a.Master.context.isOffline&&this.track.sequencerEngine.getSelectedTrack()===this.track&&(this.state.sequencer.showPianoRoll||this.state.spatial.showEditorBottom===b.b)){var n=e.map(function(e){return e.stepData.transpose}),r=this.state.keyboard.notesDown||[];this.dispatch(Object(p.xd)([].concat(Object(a.a)(r),Object(a.a)(n)))),e.forEach(function(e){return setTimeout(function(){e.stepData.trackData&&t.removeNoteDown(e.stepData.transpose)},e.stepData.duration*v.a.Time("16n").toSeconds()*1e3)})}}},{key:"stop",value:function(){this.times=[],this.effects.forEach(function(e){return e.stop()})}},{key:"dispose",value:function(){this._disposed||(this.effects.forEach(function(e){return e.dispose()}),this._disposed=!0)}},{key:"convertToRack",value:function(){var e=this.effects.map(function(e){return e.getEffectCopy()}),t=new P.a(this.track);e.forEach(function(e){return t.addEffect(e,!1)});var n,r=50,a=100,i=T(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.x=r,o.y=a,(r+=50)>300&&(r=50,a+=50)}}catch(c){i.e(c)}finally{i.f()}t.connectNodes(void 0,e[0]);for(var s=0;s<e.length;s++)t.connectNodes(e[s],e[s+1]);this.effects=[],this.addEffect(t)}},{key:"makePlanar",value:function(){var e=new f.a(this.track),t=this.track.effects.flatMap(function(e){return e.getParameters()});this.track.instrument&&(t=[].concat(Object(a.a)(t),Object(a.a)(this.track.instrument.getParameters()))),this.addEffect(e),t.filter(function(e){return!S.a.some(function(t){return e.name.toLowerCase().includes(t.toLowerCase())})}).filter(function(e){return!e.isMapped}).forEach(function(t){return e.setParameter(t)})}}]),n}(Object(x.a)(function(e){Object(s.a)(n,e);var t=E(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"liveInputTrigger",value:function(e,t,n){this.triggerAttackPreFXEnvelopes(void 0,e),this.addNoteDown(e.transpose),this.effects[0]&&this.effects[0].isRack?(this.liveInputTriggerRealTime(e,t,n),this.addNote(e,void 0,n)):this.isRealTime()?this.liveInputTriggerRealTime(e,t,n):this.addNote(e,void 0,n)}},{key:"liveInputTriggerRealTime",value:function(e,t,n){for(var r=this,i=e.transpose,o=this.stepNumber,s=new Set,c=n||v.a.Master.context.currentTime,u=this.times.length-1;u>=0&&c<this.times[u];u--)s.add(Math.max(0,o)),o--;o=Math.max(0,o),s.add(o),(s=Array.from(s)).reverse();var f=[new l.a(e,n,o)];for(var h in this.effects)if(this.effects[h].onNewStep(),this.effects[h].isEnabled()){for(var p in f)this.effects[h].input(f[p],!0);f=this.effects[h].output(n,o,void 0,!0,s)}this.triggerAttackPostFXEnvelopes(f),f.forEach(function(e){e.stepData&&(e.stepData.track=r.track,t?t.liveTrigger(e.stepData,e.stepData.slice,e.time):r.track.skipMidiMaster?r.track.liveTrigger(e.stepData,e.stepData.slice,e.time):r.subSequence.midiEffects.liveInputTrigger(e.stepData,r.track,e.time))});var d=this.noteToTriggers;f.forEach(function(e){e.stepData&&(e.transpose=e.stepData.transpose,e.slice=e.stepData.slice)}),t&&(d=this.noteToTriggers[t.trackNumber]||{},this.noteToTriggers[t.trackNumber]=d),void 0!==d[i]?d[i]=[].concat(Object(a.a)(d[i]),Object(a.a)(f)):d[i]=Object(a.a)(f)}},{key:"liveInputRelease",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;this.removeNoteDown(e),this.effects[0]&&this.effects[0].isRack?(this.liveInputReleaseRealTime(e,t,n),this.removeNote(e,t)):this.isRealTime()?(this.liveInputReleaseRealTime(e,t,n),this.removeNote(e,t)):this.removeNote(e,t),0===this.notesDown.length&&(this.triggerReleasePreFXEnvelopes(),this.triggerReleasePostFXEnvelopes())}},{key:"liveInputReleaseRealTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=this.noteToTriggers;n&&(r=this.noteToTriggers[n.trackNumber]||{},this.noteToTriggers[n.trackNumber]=r);var i=r[e];if(void 0===i){var o=Object.keys(r);i=r[o[0]]||[],e=o[0]}for(var s=0,c=Object(a.a)(i);s<c.length;s++){var u=c[s];if(u.stepData&&u.stepData.delays){var l,f=j(u.stepData.delays);try{for(f.s();!(l=f.n()).done;){var h=l.value;this.track&&this.track.liveTriggerRelease(h.reference.transpose,0)}}catch(m){f.e(m)}finally{f.f()}}}var p=[];for(var d in i)i[d].slice===t?n?n.liveTriggerRelease(i[d].transpose,i[d].slice):this.track.skipMidiMaster?this.track.liveTriggerRelease(i[d].transpose,i[d].slice):this.subSequence.midiEffects.liveInputRelease(i[d].transpose,i[d].slice,this.track):p.push(i[d]);void 0!==e&&(r[e]=p,0===r[e].length&&delete r[e])}},{key:"addNote",value:function(e,t){var n=[new l.a(e,t)],r=void 0;for(var a in this.effects){if(!(r=this.effects[a]).isRealTime())break;for(var i in this.effects[a].onNewStep(),n)r.input(n[i]);n=this.effects[a].output()}r.addNote(n[0].stepData.transpose,n[0].stepData.slice,this.stepNumber,t)}},{key:"removeNote",value:function(e,t){this.effects.forEach(function(n){return n.removeNote(e,t)})}},{key:"isRealTime",value:function(){return this.effects.filter(function(e){return e.isEnabled()}).every(function(e){return e.isRealTime()})}},{key:"isLiveRealTime",value:function(){return!!this.track.isEnabled&&this.effects.some(function(e){return"Arpeggiator"===e.name})}},{key:"setupMessageReader",value:function(){var e=this;if(this.track&&this.track.subSequence.name){var t=this.track.trackNumber+1+this.track.subSequence.name.toLowerCase(),n=t+".triggerAttack",r=t+".triggerAttackRelease",a=t+".triggerRelease",i=new O.a;i.slice=0,i.duration=null,this.triggerAttackReader&&this.triggerAttackReader(),this.triggerAttackReader=Object(k.d)(n,function(t){var n=void 0;if("object"===typeof t){var r=t.transpose,a=t.time,o=t.velocity;i.velocity=o,i.transpose=r,n=a}else i.transpose=t;e.liveInputTrigger(i,void 0,n)}),this.triggerReleaseReader&&this.triggerReleaseReader(),this.triggerReleaseReader=Object(k.d)(a,function(t){var n="object"===t?t.transpose:t;e.liveInputRelease(n)}),this.triggerAttackReleaseReader&&this.triggerAttackReleaseReader(),this.triggerAttackReleaseReader=Object(k.d)(r,function(t){var n=t.stepData,r=t.time,a=t.stepNumber;(n=e.getStep(n)).track=e.track,e.input(n,r,a),e.receivedTriggers=e.inputedTriggers})}}},{key:"getConnectedEnvelopes",value:function(e){return this.track.envelopesTrack?e===y.b?[]:this.track.envelopesTrack.envelopes.map(function(e){return e.envelope}):this.track.connectedEnvelopes.filter(function(t){return t.mode===e}).map(function(e){return e.envelope})}},{key:"triggerReleasePreFXEnvelopes",value:function(e){this.getConnectedEnvelopes(y.b).forEach(function(t){return t.triggerRelease(e)})}},{key:"triggerReleasePostFXEnvelopes",value:function(e){this.getConnectedEnvelopes(y.a).forEach(function(t){return t.triggerRelease(e)})}},{key:"triggerAttackPreFXEnvelopes",value:function(e,t){this.getConnectedEnvelopes(y.b).forEach(function(n){return n.triggerAttack(e,t.velocity)})}},{key:"triggerAttackReleasePreFXEnvelopes",value:function(e,t){var n=this,r=t.stepData;this.getConnectedEnvelopes(y.b).forEach(function(t){return t.triggerAttackRelease(n.getDuration(r.duration),e,r.velocity)})}},{key:"triggerAttackPostFXEnvelopes",value:function(e){var t=this;e.forEach(function(e){t.getConnectedEnvelopes(y.a).forEach(function(t){return t.triggerAttack(isNaN(e.time)?void 0:e.time,e.stepData?e.stepData.velocity:1)})})}},{key:"triggerAttackReleasePostFXEnvelopes",value:function(e){var t=this;e.filter(function(e){return e&&e.stepData}).forEach(function(e){t.getConnectedEnvelopes(y.a).forEach(function(n){return n.triggerAttackRelease(t.getDuration(e.stepData.duration),e.time,e.stepData.velocity)})})}}]),n}(function(){return function e(){Object(i.a)(this,e)}}())));t.a=R},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r=1,a=4},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="DELETE_STEP"},function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return h});var r=n(17),a=n(72),i=n(15),o=n.n(i),s=n(101);n(343);function c(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(a.a)("harmonize",{"...harmonies":"Transposes to harmonize"},"Harmonizes with the given transposees");var l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var i=t.flat().map(function(e){return r.A.apply(void 0,[e].concat(n))}).flat(),o=n[0],u=n[1],l=n[2],f=n[3];if(!o)return Object(r.w)(!1);var h,p=[],d=new s.a(o,l,u),m=c(i);try{for(m.s();!(h=m.n()).done;){var v=h.value,b=f.copyTrigger(d,!0).stepData;b.transpose+=v,p.push({stepData:b,stepNumber:u,time:l})}}catch(g){m.e(g)}finally{m.f()}return Object(r.Q)([{stepData:o,time:l,stepNumber:u}].concat(p))}},f=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var i=t.flat().map(function(e){return r.A.apply(void 0,[e].concat(n))}).flat(),o=n[0],u=n[1],l=n[2],f=n[3];if(!o)return Object(r.w)(!1);var h,p=[],d=new s.a(o,l,u),m=c(i);try{for(m.s();!(h=m.n()).done;){var v=h.value,b=f.copyTrigger(d,!0).stepData;b.transpose=v,p.push({stepData:b,stepNumber:u,time:l})}}catch(g){m.e(g)}finally{m.f()}return Object(r.Q)(p)}};Object(a.a)("strum",{spread:"Number from 1-10"},"Spreads out triggers on same step, so they strum");var h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=void 0,n=0,a=void 0;return function(){for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];var u=s[0],l=s[1],f=s[2];if(!f&&!a)return a=o.a.Master.context.currentTime+.05,n=1,t=l,Object(r.w)(!0);if(!u||t!==l)return n=1,t=l,a=void 0,Object(r.w)(!0);!f&&a&&(f=a),t=l;var h=r.A.apply(void 0,[e].concat(s)),p={stepData:u,stepNumber:l,time:f+n*h*.01};return n++,Object(r.Q)(p)}}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var u=function(e){Object(i.a)(n,e);var t=c(n);function n(e,a,i){var o;return Object(r.a)(this,n),(o=t.call(this,e,a.getType())).event=a,o.subEvent=i,o}return Object(a.a)(n,[{key:"execute",value:function(){var e=this.subEvent.step,t=this.subEvent.duration,n=this.event.deleteSubEvent(this.subEvent);if(!(n<0)){if(this.event.isEmpty())return n=this.mixByType.events.indexOf(this.event),this.mixByType.events.splice(n,1),this.mixByType.calculateDurations(),void this.mix.updateAllTypeRedux();var r=this.event.subEvents;for(var a in r)if(r[a].step>e){r[a].step-=t;break}this.mix.restart(),this.event.calculateDurations(),this.mixByType.calculateDurations(),this.mix.updateAllTypeRedux()}}}]),n}(n(130).a);t.a=u},function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});var r=n(229);function a(e){var t=r.decode(e).toString("hex").replace(/^1220/,"");return 64!=t.length?null:"0x"+t}function i(t){var n=new e(t.replace(/^0x/,"1220"),"hex");return r.encode(n)}}).call(this,n(27).Buffer)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(375),o=(n(15),n(57)),s=function(){function e(t,n,a,s,c){Object(r.a)(this,e),this.store=t.store,this.sequencerEngine=t,this.context=(c||new o.a).forLFOTrack(this,n).forSubSequence(n.subSequence),this.number=s,this.lfo=new i.a(t,a,(new o.a).forLFOTrack(this,n),s),this.lfo.lfoMin=-100,this.lfo.lfoMax=100}return Object(a.a)(e,[{key:"id",get:function(){return this.lfo.id}},{key:"start",value:function(e){this.lfo.start(e)}},{key:"stop",value:function(){this.lfo.stop()}},{key:"getName",value:function(){return"LFO "+this.number}},{key:"getJson",value:function(){return this.lfo.getJson()}}]),e}();t.a=s},function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return s});var r=n(9),a=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(arguments.length>2&&arguments[2],[]),r=[],a=[],i=[];for(var o in e.current)if(e.current[o]){var s=e.current[o].current;if(s)n.push(s.offsetLeft+(t?s.offsetWidth:0)),r.push(s.offsetTop+(t?s.offsetHeight:0)),i.push(s.offsetHeight),a.push(s.offsetWidth)}return{lefts:n,tops:r,widths:a,heights:i}},i=function(e,t,n,r,a){var i=a.lefts,o=a.tops,s=a.widths,c=a.heights;for(var u in i){var l=s[u],f=c[u],h=i[u]-l,p=o[u]-f;if(e>=h&&e<=h+l&&t>=p&&t<=p+f)return!0}return!1},o=function(e){var t=a(e,!0,!0),n=t.lefts,i=t.tops;return{maxLeft:Math.max.apply(Math,Object(r.a)(n)),maxTop:Math.max.apply(Math,Object(r.a)(i))}},s=function(e){var t=a(e,!1,!0),n=t.lefts,i=t.tops;return{minLeft:Math.min.apply(Math,Object(r.a)(n)),minTop:Math.min.apply(Math,Object(r.a)(i))}}},,function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r="USER_SCRIPT",a="PLANAR_SCRIPT"},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r=1,a=3},function(e,t,n){"use strict";n.d(t,"a",function(){return w});var r=n(8),a=n(9),i=n(2),o=n(4),s=n(16),c=n(7),u=n(10),l=n(1),f=n(85),h=n(186),p=n(313),d=n(321),m=n(315),v=n(48),b=n(88),g=n(102),y=n(50);function k(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function j(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var w=function(e){Object(c.a)(n,e);var t=j(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this,"Rules Rack",e)).zObject=r,a.initializeConfigurations(a.adjacencyLists),a.addInitialRules(),a.newOutlet(y.i),a}return Object(o.a)(n,[{key:"addInitialRules",value:function(){this.loaded=!1,this.addEffect(new b.e(this)),this.addEffect(new b.c(this)),this.addEffect(new b.d(this)),this.addEffect(new b.n(this)),this.addEffect(new b.s(this)),this.addEffect(new b.o(this)),this.addEffect(new b.p(this)),this.addEffect(new b.u(this)),this.addEffect(new b.a(this)),this.addEffect(new b.l(this)),this.addEffect(new b.f(this)),this.addEffect(new b.i(this)),this.addEffect(new b.r(this)),this.addEffect(new b.b(this)),this.addEffect(new b.v(this)),this.loaded=!0,this.updateRules(),this.coord(0,36,10),this.coord(1,92,10),this.coord(2,144,10),this.coord(3,203,10),this.coord(4,11,72),this.coord(5,60,72),this.coord(6,130,72),this.coord(7,177,72),this.coord(8,236,72),this.coord(9,199,129),this.coord(10,12,129),this.coord(11,63,129),this.coord(12,128,129),this.coord(12,200,129),this.coord(12,230,129)}},{key:"coord",value:function(e,t,n){this.effects[e].x=t,this.effects[e].y=n}},{key:"isRack",get:function(){return!0}},{key:"addEffect",value:function(e){Object(s.a)(Object(l.a)(n.prototype),"addEffect",this).call(this,e),e.rack=this,this.updateRules()}},{key:"updateRules",value:function(){var e=this;if(this.loaded){var t=[];t=[],["Dot","Dash 1","Dash 2","Accent","Any","Times","Double","Staccato","Legato","Piano","Rest","Pianissimo","Otherwise"].forEach(function(n){t=[].concat(Object(a.a)(t),Object(a.a)(e.generateRules(e.effects.find(function(e){return e.name===n}))))}),this.rules=t,this.publishRules()}}},{key:"publishRules",value:function(){this.sendMessage(y.i,this.rules)}},{key:"connectNodes",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];(e=Object(s.a)(Object(l.a)(n.prototype),"connectNodes",this)).call.apply(e,[this].concat(r)),this.updateRules()}},{key:"deleteEdge",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];(e=Object(s.a)(Object(l.a)(n.prototype),"deleteEdge",this)).call.apply(e,[this].concat(r)),this.updateRules()}},{key:"deleteEffect",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];(e=Object(s.a)(Object(l.a)(n.prototype),"deleteEffect",this)).call.apply(e,[this].concat(r)),this.updateRules()}},{key:"generateRules",value:function(e,t){if(!e)return[];var n=this.adjacencyLists[e.id];if(!n)return[];var r,i=[],o=k(n);try{for(o.s();!(r=o.n()).done;){var s=r.value,c=s.effect,u=s.outputNumber,l=t;t||(l="Otherwise"===e.name?Object(v.p)():E(u)(e.predicate||e.action)),c.aux?(l=c.aux(l,c.value),i=[].concat(Object(a.a)(i),Object(a.a)(this.generateRules(c,l)))):(c.action&&(l=l.always(c.action)),i.push(l))}}catch(f){o.e(f)}finally{o.f()}return i}},{key:"dot",get:function(){return this.effects.find(function(e){return"Dot"===e.name})}},{key:"dash1",get:function(){return this.effects.find(function(e){return"Dash 1"===e.name})}},{key:"dash2",get:function(){return this.effects.find(function(e){return"Dash 2"===e.name})}},{key:"getJson",value:function(){return this.getRackJson()}},{key:"fromJson",value:function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t;this.adjacencyLists={},this.initializeConfigurations(this.adjacencyLists,!1),this.effects=[],this.loaded=!1;var c=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t),u=e.effects;for(var f in u){var p=u[f],d=Object(h.a)(p,this.track);if(c=Object(r.a)({},c,d.fromJson(p,o)),d.id!==p.id){var m,v=k(e.configurations);try{for(v.s();!(m=v.n()).done;){var b=m.value,g=b[p.id];b[d.id]=g,delete b[p.id]}}catch(y){v.e(y)}finally{v.f()}}this.addEffect(d,!1),d.x=p._x||p.x,d.y=p._y||p.y}return this.fromRackJson(e,t),this.loaded=!0,this.updateRules(),c}}]),n}(Object(g.a)(Object(p.a)(Object(d.a)(Object(m.a)(f.a))))),E=function(e){switch(e){case 0:return v.o;case 1:return v.r;default:return v.l}}},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return o});var r=1,a=2,i=3,o={1:[0,2,4,5,7,9,11],2:[0,2,3,5,7,8,10],3:[0,2,3,5,7,8,11]}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=100;function a(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)*(t.resolution/8)*e/32*r}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0);function a(e,t){var n=Object(r.useRef)();Object(r.useEffect)(function(){n.current=e},[e]),Object(r.useEffect)(function(){if(null!==t){var e=setInterval(function(){n.current()},t);return function(){return clearInterval(e)}}},[t])}},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(6),f=n(34),h=n(12);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"lock-button-container"},u.a.createElement("img",{onMouseOver:function(t){return e.setContextualHelp(t,e.props.contextualHelp||f.Jb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.props.toggleLock()},className:"lock-button",src:this.props.patternLocked?"/closed-padlock.png":"/opened-padlock.png"}))}}]),n}(c.Component);t.a=Object(h.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(l.ub)(t))}}})(d)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"delegate",type:"address"},{name:"numTokens",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"contentHash",type:"bytes32"},{name:"user",type:"address"}],name:"approveContentOwner",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"numTokens",type:"uint256"}],name:"buyTokens",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!1,inputs:[{name:"contentHash",type:"bytes32"}],name:"claimContentBalance",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"previousSequence",type:"bytes32"},{name:"newSequence",type:"bytes32"},{name:"title",type:"string"},{name:"samples",type:"bytes32[]"}],name:"editSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"newPrice",type:"uint256"}],name:"setPrice",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"receiver",type:"address"},{name:"numTokens",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"user",type:"address"},{name:"buyer",type:"address"},{name:"numTokens",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{name:"total",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"tokenOwner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"tokens",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"tokens",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"user",type:"address"},{indexed:!0,name:"previousSequence",type:"bytes32"},{indexed:!0,name:"newSequence",type:"bytes32"},{indexed:!1,name:"title",type:"string"}],name:"SequenceEdited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"sequenceHash",type:"bytes32"},{indexed:!0,name:"sampleHash",type:"bytes32"}],name:"SampleInSequence",type:"event"},{constant:!0,inputs:[{name:"user",type:"address"},{name:"delegate",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"tokenOwner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"contentHash",type:"bytes32"}],name:"getContentBalance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getPrice",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],this.contractAddress="0x606f760c228cd5f11c6f79de64d3b299b11f1ed1"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=(n(15),n(43));function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(e){Object(s.a)(n,e);var t=h(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this)).track=e,i.volume=r,i}return Object(i.a)(n,[{key:"getCopy",value:function(){return(new n).fromJson(this.getJson())}},{key:"getValue",value:function(){return this.volume}},{key:"executeEvent",value:function(e){this.subSequence.tracks[this.track.trackNumber]&&this.subSequence.tracks[this.track.trackNumber].setVolume(this.volume,!0)}},{key:"getType",value:function(){return f.q}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{trackNumber:this.track.trackNumber,volume:this.volume})}},{key:"fromJson",value:function(e,t){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),void 0!==e.subSequence?this.track=t.getSubSequence(e.subSequence).tracks[e.trackNumber]:this.track=t.tracks[e.trackNumber],this.volume=e.volume,this}}]),n}(l.a);t.a=p},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=(n(15),n(43));function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(e){Object(s.a)(n,e);var t=h(n);function n(e,r,i){var o;return Object(a.a)(this,n),(o=t.call(this)).track=e,o.sendNumber=r,o.volume=i,o}return Object(i.a)(n,[{key:"executeEvent",value:function(e){this.subSequence.tracks[this.track.trackNumber].setSendVolume(this.sendNumber,this.volume,!0)}},{key:"getType",value:function(){return f.o}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{trackNumber:this.track.trackNumber,sendNumber:this.sendNumber,volume:this.volume})}},{key:"fromJson",value:function(e,t){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.track=t.tracks[e.trackNumber],this.sendNumber=e.sendNumber,this.volume=e.volume,this}}]),n}(l.a);t.a=p},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(76),o=n(34),s=n(6),c=n(86),u=n(182),l=n(382),f=n(203),h=n(12);n(2432);t.a=Object(h.b)(function(e,t){return{isCollapsed:e.effects.effectCollapsed[t.node.effectRack&&t.node.effectRack.id]}},function(e){return{setSelectedZObject:function(t){return e(Object(s.uf)(t))},setIsCollapsed:function(t,n){return e(Object(s.Tb)(t,n))},setDrawingPadEdge:function(t,n){return e(Object(s.Nb)(t,n))}}})(function(e){var t=e.setDrawingPadEdge,n=e.containerRef,s=(e.addToBack,e.node),h=(e.sequencerEngine,e.scale),p=void 0===h?1:h,d=e.number,m=e.hideNumber,v=e.sequencerScale,b=void 0===v?1:v,g=e.isMidi,y=e.trackPositions,k=(e.setSelectedZObject,e.isRoot),O=e.useClick,j=e.setIsCollapsed,w=e.isCollapsed,E=Object(r.useRef)(void 0),S=Object(f.a)({ref:E}),P=S.onContextMenu,x=S.dropdownPos,T=S.setDropdownPos,C=Object(r.useCallback)(function(e){e.stopPropagation();var t=s.effectRack;t&&j(t.id,!w)},[w]),N=Object(u.a)(C,250,function(e){O&&P(e)}),R=Object(r.useRef)({x:0,y:0}),M=Object(r.useCallback)(function(e){var r=e.pageX,a=e.pageY;if(R.current.x=g?r+100:r+250,R.current.y=a,g){e.stopPropagation(),s.trackNode&&s.sequencerEngine.selectTrack(s.trackNumber);var i=n.current.getBoundingClientRect(),o=e.clientX-i.left,c=e.clientY-i.top,u={effect:void 0,rack:s.effectRack,x1:o,y1:c,x2:o,y2:c};t(s.subSequence.id,u)}},[]),A="output-node-"+s.id;g&&s.effectRack&&(A="effect-output-0-"+s.effectRack.id);var q={};if(void 0!==d){var D=y[s.id];D&&D.current?(D=D.current,q.top=D.offsetTop+5,b&&(q.top*=b)):q.top=25*(d+1)*p}var I="output-node";return w&&(I+=" collapsed"),a.a.createElement(i.a,{element:k?o.cb:void 0,style:q,id:A,onClick:N,onMouseDown:M,refObj:E,onContextMenu:P,className:I},w&&!m&&a.a.createElement("div",{className:"num-effects"},s.effectRack.effects.length),a.a.createElement(l.a,{isMidi:g,addToBack:!g,isRoot:k,effectOptions:g?c.e:c.a,initializeEffect:g?c.c:c.b,setDropdownPos:T,dropdownPosRef:R,dropdownPos:x,node:s.effect||s}))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(76),f=n(29),h=n(38),p=n(39),d=n.n(p),m=n(33),v=n(12),b=n(6);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var y=new f.a,k=function(e){Object(i.a)(n,e);var t=g(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"hasAutomationSet",value:function(){return void 0!==this.props.automation&&void 0!==this.props.automation.get(this.props.parameter)}},{key:"deleteAutomation",value:function(){this.props.automation.delete(this.props.parameter)}},{key:"getMacroOverlayIfNeeded",value:function(){var e=this,t=this.props,n=t.isMacroMapping,r=t.parameter,a=t.isParameterToMap;if(n&&r){var i="macro-overlay";a&&(i+=" parameter-to-map"),r.hasMacro&&(i+=" mapped");var o={};this.props.parameter.hasMacro&&(o={backgroundColor:y.getColorForHash(r.hasMacro.id)});var s=r.hasMacro&&r.hasMacro.name;return u.a.createElement("div",{onClick:function(){return e.props.setParameterToMap(e.props.parameter)},className:i},u.a.createElement("div",{className:"overlay-main"}),u.a.createElement("div",{className:"overlay-detail",style:o},s))}return""}},{key:"render",value:function(){var e=this;j(this.props.value);return u.a.createElement(l.a,{element:this.props.parameter,onClick:function(){return e.props.setParameterToMap(e.props.parameter)},className:"lfo-rate-dropdown"},this.getMacroOverlayIfNeeded(),this.props.hideLabel?"":u.a.createElement("div",{className:"lfo-rate-label"},"Rate:"),u.a.createElement(d.a,{className:"osc-type-dropdown float-left",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:O,onChange:function(t){return e.props.onChange(t.value)},value:j(this.props.value),placeholder:"Rate"}),u.a.createElement(h.a,{condition:this.hasAutomationSet()},u.a.createElement("div",{onClick:function(){return e.deleteAutomation()},className:"automation-label float-right"},"AUTOMATION")),u.a.createElement("div",{className:"clear-fix"}))}}]),n}(c.Component),O=[{value:new m.a(4,!1),label:"1/4"},{value:new m.a(4,!0),label:"1/4t"},{value:new m.a(8,!1),label:"1/8"},{value:new m.a(8,!0),label:"1/8t"},{value:new m.a(16,!1),label:"1/16"},{value:new m.a(16,!0),label:"1/16t"},{value:new m.a(32,!1),label:"1/32"},{value:new m.a(32,!0),label:"1/32t"}];function j(e){for(var t=0;t<O.length;t++)if(O[t].value.resolution==e.resolution&&O[t].value.isTriplet==e.isTriplet)return O[t];return null}t.a=Object(v.b)(function(e,t){return{value:void 0===t.automation||void 0===t.automation.get(t.parameter)?t.parameter.get():t.automation.get(t.parameter).value,isMacroMapping:e.effects.isMacroMapping,isParameterToMap:t.parameter&&e.effects.parameterToMap===t.parameter}},function(e){return{setParameterToMap:function(t){return e(Object(b.Td)(t))}}})(k)},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(220),s=n(347),c=n(6),u=n(12);t.a=Object(u.b)(function(e,t){var n=t.fx&&t.fx.id,r=t.edge.effect.id;r=-1===r?t.pad.effectRack.id:r;var a=e.windows.windowPositions[t.fromWindow||t.fromId||n];return t.padZObject&&(a=e.windows.windowPositions[t.padZObject.id]),{fromPosition:a,isSourceCollapsed:e.effects.effectCollapsed[t.fx&&t.fx.id],isDestCollapsed:e.effects.effectCollapsed[r],isSelected:t.edge===e.pads.selectedEdge,toPosition:e.windows.windowPositions[r],hidden:e.spatial.hiddenObjects[t.pad.id],edgesPadding:e.spatial.edgesPadding}},function(e){return{setSelectedPadEdge:function(t){return e(Object(c.ff)(t))},setSelectedSteps:function(t){return e(Object(c.jf)(t))}}})(function(e){var t=e.scale,n=e.isSelected,c=e.outputPrefix,u=(e.fx,e.pad),l=e.edge,f=e.fromId,h=(e.containerRef,e.fromPosition),p=e.toPosition,d=e.isSourceCollapsed,m=e.isDestCollapsed,v=e.setSelectedPadEdge,b=e.setSelectedSteps,g=e.hidden,y=e.edgesPadding,k=e.sequencerEngine,O=e.edgesRef;c=c||"effect-output-";var j=Object(a.useState)([]),w=Object(r.a)(j,2),E=w[0],S=w[1];if(Object(a.useEffect)(function(){if("number"!==typeof l.effect){var e=l.effect.id;e=-1===e?u.effectRack.id:e;var t=void 0!==l.outputNumber?c+l.outputNumber+"-"+f:c+f,n=document.getElementById(t);e=l.effect===u.effectRack.outputNode?"effect-input-"+u.effectRack.id+"-speakers":"effect-input-"+e;var r=document.getElementById(e);if(n&&r){n=n.getBoundingClientRect(),r=r.getBoundingClientRect();var a=O.current.getBoundingClientRect(),i=a.top,o=a.left,s=[n.left-o,n.top-i,r.left-o,r.top-i];s=s.map(function(e){return e/(window._scale||1)}),S(s)}}},[t,y,h,p,S,m,d,k]),0===E.length)return[];var P=Object(r.a)(E,4),x=P[0],T=P[1],C=P[2],N=P[3],R="pad-effect-edge ";return n&&(R+=" selected"),g?"":i.a.createElement(o.a,{onMouseDown:function(e){e.stopPropagation(),v(l),b([])},className:R,points:Object(s.a)(x+3,T,C+3,N)})})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(12);t.a=Object(o.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.set,n=e.get,o=e.name,s=e.isTextArea,c=Object(a.useState)(!1),u=Object(r.a)(c,2),l=u[0],f=u[1],h="zora-field ";return(l||""!==n)&&(h+=" focused"),s&&(h+=" text-area"),i.a.createElement("div",{className:h},i.a.createElement("div",{className:"field-name"},o),s?i.a.createElement("textarea",{onFocus:function(e){return f(!0)},onBlur:function(e){return f(!1)},value:n,onChange:function(e){return t(e.target.value)},type:"text"}):i.a.createElement("input",{onFocus:function(e){return f(!0)},onBlur:function(e){return f(!1)},value:n,onChange:function(e){return t(e.target.value)},type:"text"}))})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(29),s=n(12),c=Object(s.b)(function(e,t){e.sequencer.displayResolution;var n=t.track.sequencerEngine.trackStep;return{currentStep:t.track.getPatternStep(n)}},function(e){return{}})(function(e){var t=e.track,n=e.currentStep,r=void 0===n?0:n,a=Math.min(t.pattern.length(),32),o={left:5+r%a/a*530+"px"};return i.a.createElement("div",{style:o,className:"cirklon-playhead"})}),u=n(664),l=n(204),f=n(6),h=(n(1381),n(114),n(46)),p=n(22),d=n(39),m=n.n(d),v=n(216),b=[{label:"None",value:v.b},{label:"Randomize",value:v.c},{label:"Accumulate",value:v.a}],g=[{label:"Transpose",value:"transpose"},{label:"Velocity",value:"velocity"},{label:"Duration",value:"duration"},{label:"Chop",value:"chop"},{label:"Panning",value:"panning"}],y=function(e){var t=e.track,n=e.parameter,o=e.name,s=e.limit,c=(e.mode,e.variableParameter),u=Object(a.useState)(n.get()),l=Object(r.a)(u,2),f=l[0],h=l[1],p=Object(a.useState)(c.get()),d=Object(r.a)(p,2),y=d[0],O=d[1],j=Object(a.useCallback)(function(e){var t=e.value;n.set(t),h(t)},[h,n]),w=Object(a.useCallback)(function(e){var t=e.value;c.set(t),O(t)},[O,n]);return i.a.createElement("div",{className:"aux-event-type"},i.a.createElement("div",{className:"event-type-label"},o),i.a.createElement(m.a,{options:b,onChange:j,value:b.find(function(e){return e.value===f})}),i.a.createElement(m.a,{options:g,onChange:w,value:g.find(function(e){return e.value===y})}),f===v.a?i.a.createElement(k,{type:f,track:t,limit:s,mode:s}):"")},k=function(e){var t=e.limit,n=(e.mode,e.track,e.type,e.parameter);return i.a.createElement("div",{className:"accumulator-options"},i.a.createElement(p.a,{isParameter:!0,name:"Limit",min:0,step:"velocity"===n||"duration"===n?.1:1,max:"transpose"===n?32:"chop"===n?16:n=32,parameter:t}))},O=(Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track;return i.a.createElement("div",{className:"aux-events"},i.a.createElement(y,{parameter:t.auxEventATypeParameter,name:"Aux Event A",limit:t.auxEventALimitParameter,variableParameter:t.auxEventAVariableParameter,mode:t.auxEventAModeParameter,track:t}),i.a.createElement(y,{parameter:t.auxEventBTypeParameter,variableParameter:t.auxEventBVariableParameter,name:"Aux Event B",auxEvent:"B",limit:t.auxEventBLimitParameter,mode:t.auxEventBModeParameter,track:t}))}),n(1533),n(95)),j=n(33),w=new j.a(32,!1),E=function(e){var t=e.bar,n=e.isSelected,r=e.onClick,a="bar";return n&&(a+=" selected"),e.isCurrent&&(a+=" current"),i.a.createElement("div",{onClick:r,className:a},i.a.createElement("div",{className:"bar-text"},t+1))},S=Object(s.b)(function(e,t){var n=e.sequencer.displayResolution,r=t.track.sequencerEngine.trackStep;return{patternStep:Math.floor(n.transformStepAtResolution2(t.track.getPatternStep(r),w))}},function(e){return{}})(function(e){var t=e.stepsRef,n=e.numberOfSteps,o=e.setSelectedBar,s=e.selectedBar,c=(e.resolution,e.isFollowing),u=e.setIsFollowing,l=e.patternStep,f=e.barLength,h=(e.cirklonRef,Object(a.useState)(0)),p=Object(r.a)(h,2),d=p[0],m=p[1],v=Math.floor(n/f);isNaN(v)&&(v=1);var b=Object(a.useRef)(void 0),g=Object(a.useRef)(void 0);Object(a.useEffect)(function(){return t.current.addEventListener("mousewheel",y,{passive:!1}),function(){t.current&&t.current.removeEventListener("mousewheel",y,{passive:!1})}},[s,o,u,v]);var y=Object(a.useCallback)(function(e){var t=(new Date).getTime();if(!(t-window.lastScrollTime<200)){e.stopPropagation(),e.preventDefault();var n=Math.abs(e.deltaX)<=Math.abs(g.current);if(g.current=e.deltaX,e.deltaX>0){if(t-b.current<200)return n||(b.current=t),!0;if(n)return!0;u(!1);var r=(s+1)%v;isNaN(s)||o(r),b.current=t}else if(e.deltaX<0){if(t-b.current<200)return n||(b.current=t),!0;if(n)return!0;u(!1);var a=Object(O.a)(s-1,v);isNaN(a)||o(a),b.current=t}return!0}},[s,u,o,v]);Object(a.useEffect)(function(){(isNaN(s)||s>=v)&&o(0)},[v,s,o]);var k=Array(v).fill(1),j=f*s,w=f*(s+1);return Object(a.useEffect)(function(){if(m(Math.floor(l/f)),l>=j&&l<w);else if(!isNaN(l)&&c){var e=Math.floor(l/f);o(e)}},[l,j,w,o,f,c,m]),1===v?[]:i.a.createElement("div",{className:"bars"},i.a.createElement("div",{className:"bar-label"},"Bar:"),k.map(function(e,t){return i.a.createElement(E,{bar:t,isCurrent:d===t,isSelected:s===t,onClick:function(){o(t),u(!1)}})}),i.a.createElement("div",{onClick:function(){return u(!c)},className:c?"following follow-btn":"follow-btn"},"FOLLOW"))}),P=n(885),x=new o.a,T=Object(s.b)(function(e,t){return t.stepData&&t.stepData.durationParameter&&t.stepData.trackData?{on:t.stepData.on,duration:t.stepData.duration,transpose:t.stepData.transpose,velocity:t.stepData.velocity,slice:t.stepData.slice,plocked:t.stepData.pLockedParameters.length}:{}},function(e){return{}})(function(e){e.plocked;var t=e.slice,n=e.on,r=e.color,a=e.transpose,o=(e.stepData,e.duration),s=e.velocity;if(!n)return"";var c={width:32.5*o,backgroundColor:r,opacity:s,top:-15-.25*a+"px"};if(t){var u=x.getColor(t);c.backgroundColor=u}return i.a.createElement("div",{style:c,className:"duration-indicator"})}),C=n(439),N=n(61),R=n(9),M=n(147),A=new j.a(32,!1),q=new o.a,D=Object(s.b)(function(e,t){var n=e.sequencer.displayResolution,r=t.track.sequencerEngine.trackStep,a=Math.floor(n.transformStepAtResolution2(t.track.getPatternStep(r),A));return t.stepData&&t.stepData.trackData?{resolution:n,isCurrentStep:a===t.stepNumber,selectedPianoRollSteps:e.keyboard.selectedPianoRollSteps,cirklonMode:e.cirklon.cirklonMode[t.track.id],slice:t.stepData.slice,plocked:t.stepData.pLockedParameters.length}:{}},function(e){return{setSelectedSteps:function(t){return e(Object(f.jf)(t))},mouseDown:function(t){return e(Object(f.n)(t))}}})(function(e){var t=e.track,n=e.color,r=e.on,o=e.stepNumber,s=e.resolution,c=e.stepData,u=(e.trackStep,e.isCurrentStep),l=e.selectedPianoRollSteps,f=void 0===l?[]:l,p=e.setSelectedSteps,d=e.cirklonMode,m=e.mouseDown,v=e.plocked,b=e.isSelected,g=(Object(a.useRef)(0),Object(a.useCallback)(function(e){M.isMobile||t.sequencerEngine.state.keyboard.isMouseDown&&((e.ctrlKey||e.metaKey)&&r?O(c):e.metaKey||e.ctrlKey||k())},[b,t,d,r,s,o,f])),y=Object(a.useCallback)(function(e,t){!e&&M.isMobile||(m(!0),(t.metaKey||t.ctrlKey)&&r?(t.stopPropagation(),O(c)):t.metaKey||t.ctrlKey||(t.stopPropagation(),k()))},[o,c,t,d,f,b,r,s]),k=Object(a.useCallback)(function(){t.pattern.clearCache(),t.sequencerEngine.cursor.setStep(o,s),t.sequencerEngine.operationManager.dispatch(Object(h.t)(t,o,s))},[t,o,s]),O=Object(a.useCallback)(function(e){if(b){var t=f.indexOf(c);f.splice(t,1),p(Object(R.a)(f))}else p([].concat(Object(R.a)(f),[c]))},[b,f,p,c]),j="step-toggle",w={},E={};r&&(j+=" on",w.backgroundColor=q.transparent(q.saturate(n,1),.7),E.backgroundColor=n);var S={};return b&&(w.backgroundColor=E.backgroundColor,E.color=E.backgroundColor,S.backgroundColor=E.backgroundColor,E.backgroundColor=null),u&&(j+=" current"),b&&(j+=" selected"),v&&(j+=" p-locked"),i.a.createElement("div",{"data-stepNumber":o,style:w,onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},onMouseOver:g,onMouseDown:function(e){e.stopPropagation(),y(!1,e)},onTouchStart:function(e){return y(!0,e)},className:j},i.a.createElement("div",{style:E,className:"step-inner"},v?i.a.createElement("div",{className:"p-lock-indicator"},i.a.createElement("div",{className:"inner-indicator",style:b?w:E})):"",o+1,i.a.createElement("div",{style:S,className:"step-bottom-tick"})))}),I=n(350),_=["Aux Event A","Aux Event B","Aux Event C","Aux Event D"],F=["Transpose"],L=M.isMobile?90:60,B={Duration:4,Velocity:1.5,"Aux Event A":1.5,"Aux Event B":1.5,"Aux Event C":1.5,"Aux Event D":1.5},z=function(e,t){var n=H(e,t)&&t.getAuxVariable(e.name);return F.includes(e.name)||["transpose","chop"].includes(n)};var V=function(e,t){return _.includes(e.name)?0:e.min},H=function(e,t){switch(e.name){case"Aux Event A":return t.auxEventAType;case"Aux Event B":return t.auxEventBType;case"Aux Event C":return t.auxEventCType;case"Aux Event D":return t.auxEventDType}},U=function(e,t){if(!_.includes(e.name)){if("Slice"===e.name){var n=t.getSamplers()[0];return n&&n.slices.length-1||0}return e.max}H(e,t);switch(t.getAuxVariable(e.name)){case"transpose":return 32;case"duration":return 8;case"velocity":return 1;case"chop":return 16;case"panning":return 1}},J=Object(s.b)(function(e,t){return{value:null===t.parameter.get()?t.trackParameter.get():t.parameter.get(),v:e.effects.effectParameters[t.parameter.id],cirklonMode:e.cirklon.cirklonMode[t.track.id],selectedSteps:e.keyboard.selectedPianoRollSteps}},function(e){return{setEffectParameterValue:function(t,n){return e(Object(f.Ub)(t,n))},setEffectParameterValues:function(t){return e(Object(f.Vb)(t))}}})(function(e){var t,n=e.setEffectParameterValue,r=e.setEffectParameterValues,o=e.track,s=e.name,c=e.value,u=e.parameter,l=(e.id,e.color),f=e.shouldRound,h=void 0===f?z(u,o):f,p=e.stepData,d=e.min,m=void 0===d?V(u,o):d,v=e.max,b=void 0===v?U(u,o):v,g=e.height,y=void 0===g?L:g,k=(e.units,e.cirklonMode),O=e.selectedSteps,j=void 0===O?[]:O,w=e.root,E=void 0===w?B[u.name]||1:w,S=Object(a.useRef)(void 0),P={height:Object(I.a)(c,m,b,y,E),backgroundColor:l},x={bottom:Object(I.a)(o.trackData.parameters.find(function(e){return e.name===u.name}).get(),m,b,y,E)},T=Object(I.c)({root:E,shouldRound:h,min:m,max:b,height:y,ref:S,setEffectParameterValue:n,track:o,stepData:p,setEffectParameterValues:r,parameter:u,cirklonMode:k,selectedSteps:j}),C=T.onMouseDown,N=T.onMouseMove;return i.a.createElement("div",{className:"p-box"},i.a.createElement("div",{className:"p-name"},s),i.a.createElement("div",{ref:S,style:{height:y+6},id:u.id,onClick:function(e){return e.stopPropagation()},onMouseMove:N,onMouseDown:C,className:"volume-box"},i.a.createElement("div",{className:"rest"}),i.a.createElement("div",{style:P,className:"volume-indicator"}),i.a.createElement("div",{style:x,className:"helper-line"}),i.a.createElement("div",{className:"value"},(t=c,Math.round(100*t)/100))))}),G=new N.a,W=Object(a.memo)(function(e){var t=e.track,n=e.resolution,r=e.parameter,a=e.stepData,o=void 0===a?G:a,s=e.on,c=e.i,u=e.stepNumber,l=e.isCursor,f=e.isSelected,h=e.color;if(void 0===o)return[];var p="";u%Object(C.a)(n)===0&&0!==c&&(p=i.a.createElement("div",{className:"bar-divider"}));var d=s?"cirklon-step on":"cirklon-step";return l&&(d+=" cursor"),[p,i.a.createElement("div",{"data-stepNumber":u,className:d},i.a.createElement(J,{color:h,trackParameter:t.trackData.parameters.find(function(e){return e.name===r})||t.trackData.velocityParameter,track:t,stepData:o,parameter:o.parameters.find(function(e){return e.name===r})||o.velocityParameter}),i.a.createElement(T,{color:h,stepData:o}),i.a.createElement(D,{color:h,isSelected:f,track:t,on:s,stepData:o,stepNumber:u}))]}),K=(Object(s.b)(function(e,t){return{cirklonMode:e.cirklon.cirklonMode[t.track.id]}},function(e,t){return{setCirklonMode:function(n){return e(Object(f.jb)(t.track.id,n))},setSelectedSteps:function(t){return e(Object(f.jf)(t))}}})(function(e){var t=e.mode,n=e.cirklonMode,r=e.setCirklonMode,o=(e.setSelectedSteps,"cirklon-mode-btn");t===n&&(o+=" selected");var s=Object(a.useCallback)(function(e){r(t===n?void 0:t)},[t,n]);return i.a.createElement("div",{onClick:s,className:o},t)}),Object(s.b)(function(e,t){return{parameter:e.cirklon.cirklonParameterSelected[t.track.id],stepParameterSelected:e.cirklon.stepParameterSelected}},function(e,t){return{setParameter:function(n){return e(Object(f.kb)(t.track.id,n))},setStepParameterSelected:function(t){return e(Object(f.Bg)(t))}}})(function(e){var t=e.color,n=e.parameter,o=e.setParameter,s=e.track,c=(e.stepDatas,e.setStepParameterSelected),u=e.stepParameterSelected,l=s.getStepDataParams(),f=Object(a.useState)(Object(R.a)(l)),h=Object(r.a)(f,2),p=h[0],d=h[1];l.map(function(e){return{label:e,value:e}});Object(a.useEffect)(function(){u&&o(u)},[u,o]);var m=Object(a.useCallback)(function(e){o(e.value),c(e.value)},[o,d,p]);Object(a.useEffect)(function(){return window.addEventListener("keydown",v),function(){return window.removeEventListener("keydown",v)}},[o]);var v=Object(a.useCallback)(function(e){"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&("D"===e.key?(o("Duration"),c("Duration")):"V"===e.key?(o("Velocity"),c("Velocity")):"S"===e.key?(o("Slice"),c("Slice")):"T"===e.key?(o("Transpose"),c("Transpose")):"C"===e.key?(o("Chop"),o("Chop")):"P"===e.key&&o("Panning"))},[o]),b={backgroundColor:t};return Object(a.useEffect)(function(){n||o("Velocity")},[n]),i.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"cirklon-parameter-chooser"},p.map(function(e,t){return i.a.createElement("div",{key:t,style:n===e?b:{},onClick:function(){return m({value:e})},className:(n===e?"param-btn selected":"param-btn")+" "+e.split(" ").join("")},e)}))})),X=(n(1085),new o.a);t.a=Object(s.b)(function(e,t){e.sequencer.displayResolution;return{resolution:e.sequencer.displayResolution,stepIds:e.tracks.trackStepIds[t.track.id],steps:e.tracks.trackSteps[t.track.id],parameter:e.cirklon.cirklonParameterSelected[t.track.id],cursorStep:e.mix.selectedStep,isFrozen:t.track.isFrozen,selectedSteps:e.keyboard.selectedPianoRollSteps}},function(e){return{mouseDown:function(t){return e(Object(f.n)(t))},setSelectedZObject:function(t){return e(Object(f.uf)(t))}}})(function(e){var t=e.isFrozen,n=e.mouseDown,o=e.stepIds,s=e.track,f=e.steps,p=e.parameter,d=e.resolution,m=e.color,v=e.cursorStep,b=e.selectedSteps,g=e.styling,y=e.setSelectedZObject,k=Object(a.useState)(0),O=Object(r.a)(k,2),j=O[0],w=O[1],E=Object(a.useState)(!0),x=Object(r.a)(E,2),T=x[0],C=x[1],N=Object(a.useState)(o),R=Object(r.a)(N,2),M=R[0],A=R[1],q=Object(a.useRef)(),D=Object(a.useRef)(),I=Object(a.useRef)(void 0),_=d.numSteps();32===d.resolution&&(_/=2);var F=_*j,L=_*(j+1);Object(a.useEffect)(function(){A(o)},[o,A]);var B=Object(a.useCallback)(function(){s.sequencerEngine.keyListener.legato()},[s]);f=f?f.slice(F,L):[];var z=Object(a.useCallback)(function(){if(s.sequencerEngine.state.selector.sampleTagDragging){var e=s.sequencerEngine,t=e.state.selector.sampleTagDragging;Array.isArray(t)||(t=[t]),e.searchForSounds(t,!0,s,void 0,!1)}},[s]),V=Object(a.useCallback)(function(e,t){var n=e.touches[0].clientX,r=e.touches[0].clientY,a=document.elementFromPoint(n,r);if(a&&void 0!==a.dataset.stepnumber){var i=parseInt(a.dataset.stepnumber);if(i===I.current)return;if(I.current=i,t)return;var o=a.className;(o.includes("step-toggle")||o.includes("cirklon-step"))&&(M[i],s.pattern.clearCache(),s.sequencerEngine.operationManager.dispatch(Object(h.t)(s,i,d)))}},[M,d]);if(!f||!M)return"";var H="cirklon-editor";return t&&(H+=" frozen"),g&&g["secondary-color"]&&X.getBrightness(g["secondary-color"])>120&&(H+=" light-mode"),t?i.a.createElement("div",{style:{backgroundColor:g&&g["secondary-color"]},ref:q,onMouseDown:function(e){return n(!0)},onMouseUp:function(e){return n(!1)},className:H},"Frozen"):i.a.createElement("div",{style:{backgroundColor:g&&g["secondary-color"]},onDrop:z,ref:q,onMouseDown:function(e){return n(!0)},onMouseUp:function(e){return n(!1)},className:H},i.a.createElement("div",{ref:D,onClick:function(e){return e.stopPropagation()},onMouseDown:function(e){return e.stopPropagation()},onTouchStart:function(e){return V(e,!0)},onTouchEnd:function(){return I.current=void 0},onTouchMove:V,className:"cirklon-steps"},i.a.createElement(c,{track:s}),f.map(function(e,t){return i.a.createElement(W,{color:m,isCursor:F+t===v,resolution:d,track:s,i:t,isSelected:b&&b.includes(M[F+t]),stepNumber:F+t,key:F+"."+t,stepData:M[F+t],parameter:p,on:e})})),i.a.createElement(K,{color:m,stepDatas:M,track:s}),i.a.createElement(P.a,{track:s,isSelectedTrack:!0,trackColor:m},i.a.createElement(S,{stepsRef:D,cirklonRef:q,track:s,isFollowing:T,setIsFollowing:C,numberOfSteps:M.length,barLength:_,resolution:d,setSelectedBar:w,selectedBar:j}),s&&i.a.createElement(u.a,{sequencerEngine:s.sequencerEngine}),i.a.createElement("div",{onClick:B,style:{backgroundColor:m},className:"legato-btn"},"Legato"),i.a.createElement(l.a,{onClickThumbnail:function(){return y(s)},track:s,hasInner:!0})),t&&i.a.createElement("div",{className:"frozen-overlay"},i.a.createElement("div",{className:"frozen-text"},"Frozen Track")))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(155),f=n(319),h=n(210),p=n(22),d=(n(39),n(1374),n(34)),m=n(38),v=n(884),b=n(893),g=(n(458),n(6)),y=n(12),k=n(42);function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}c.Component;function j(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var w=function(e){Object(i.a)(n,e);var t=j(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={showMods:!1,waveformData:[]},a}return Object(a.a)(n,[{key:"onChangeSynced",value:function(e){document.activeElement.blur(),this.props.lfo.lfo.isSynced="unsynced"===e,console.log("isSynced is now = "+this.props.lfo.lfo.isSynced),this.setState(this.state)}},{key:"onClickModsButton",value:function(){this.setState({showMods:!this.state.showMods})}},{key:"meter",get:function(){return this.props.lfo.lfo.meter}},{key:"isSelected",value:function(){return!this.props.hideSelection&&this.props.lfo.lfo.number===this.props.selectedLFO}},{key:"onClick",value:function(){this.props.setSelectedLFO(this.props.lfo.lfo.number),this.props.planeMapping&&this.props.planeMapping.randomlyMapParameters(this.props.lfo.lfo)}},{key:"render",value:function(){var e=this,t=this.props.lfo.lfo,n=this.isSelected()?"lfo-component selected":"lfo-component";return this.props.planeMapping&&(n+=" plane-mapping"),this.state.showMods&&(n+=" showing-mods"),u.a.createElement(f.a,{instrument:this.props.lfo,effect:this.props.lfo,id:this.props.lfo.lfo.id,isDraggable:void 0===this.props.isDraggable||this.props.isDraggable,type:l.d,onMouseOver:function(){return e.props.setContextualHelp(d.O)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.onClick()},className:n},!this.props.hideName&&u.a.createElement("div",{className:"instrument-subsection-name lfo-subsection-name lfo-track-foreground-"+this.props.lfo.number},this.props.lfo.getName()),u.a.createElement(m.a,{condition:this.state.showMods},u.a.createElement(h.a,{parameters:this.props.lfo.lfo.parameters})),u.a.createElement(m.a,{condition:!this.state.showMods},u.a.createElement(b.a,{lfo:t}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"refined-checkbox-preferences lfo-synced-checkbox"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:t.isSynced?"synced":"unsynced",checked:t.isSynced,onChange:function(t){return e.onChangeSynced(t.target.value)}}),"Synced")),t.isSynced?u.a.createElement(v.a,{lfo:t}):u.a.createElement(p.a,{effectNumber:0,name:"Rate",parameter:t.lfoRateParameter,onParameterChanged:function(){return[]},isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.1,min:0,max:32}),u.a.createElement("div",{className:"two-parameters"},u.a.createElement(p.a,{effectNumber:0,name:"Amount",parameter:t.lfoAmpParameter,contextualHelp:d.P,sequencerEngine:this.props.sequencerEngine,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,min:0,max:1,step:.01}))),u.a.createElement("div",{className:"mods-button",onClick:function(){return e.onClickModsButton()}},this.state.showMods?"BACK":"MODS"))}}]),n}(c.Component);t.a=Object(y.b)(function(e){return{selectedLFO:e.sequencer.selectedLFO,planeMapping:e.effects.planeMapping}},function(e,t){return{setContextualHelp:function(t){return e(Object(g.ub)(t))},setSelectedLFO:function(t){return e(Object(g.bf)(t))}}})(w)},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(85),h=n(32),p=(n(61),n(101)),d=n(221),m=n(21),v=n(33),b=n(248),g=n(256);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var k=function(e){Object(c.a)(n,e);var t=y(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Arpeggiator",e)).notesToRemove=[],r.arpRateParameter=new b.a("arpRate",Object(o.a)(r),function(e,t){return t},{documentation:"The rate or speed of the arpeggiation, synced to the project tempo.",min:0,prettyName:"Rate",max:1,unit:"",options:{0:new v.a(4,!1),.1:new v.a(4,!0),.2:new v.a(8,!1),.3:new v.a(8,!0),.4:new v.a(16,!1),.5:new v.a(16,!0),.6:new v.a(32,!1),.7:new v.a(32,!0)},defaultValue:new v.a(16,!1)}),r.registerParameter(r.arpRateParameter),r.arpOctavesParameter=new m.a("arpOctaves",Object(o.a)(r),function(e,t){return t},{documentation:"The number of octaves to cycle through.",prettyName:"Octaves",min:0,max:8,unit:"",defaultValue:1}),r.registerParameter(r.arpOctavesParameter),r.arpDirectionParameter=new m.a("arpDirection",Object(o.a)(r),function(e,t){return t},{min:g.a,documentation:"The direction we play notes in.",prettyName:"Direction",max:g.b,unit:"",defaultValue:g.a}),r.registerParameter(r.arpDirectionParameter),r.arpDurationFactorParameter=new m.a("arpDurationFactor",Object(o.a)(r),function(e,t){return t},{documentation:"Multiples the duration of each trigger by this number.",min:1e-4,prettyName:"Duration Factor",max:8,unit:"x",defaultValue:1}),r.registerParameter(r.arpDurationFactorParameter),r.arpRepeatParameter=new m.a("arpRepeatFactor",Object(o.a)(r),function(e,t){return t},{documentation:"The number of triggers per note in the cycle.",min:1,max:8,unit:"x",prettyName:"Repeats",defaultValue:1}),r.registerParameter(r.arpRepeatParameter),r.noteToDuration={},r.notes=[],r.index=0,r.repeatIndex=0,r.currentOctave=0,r}return Object(i.a)(n,[{key:"getVisualizedParameters",value:function(){return[this.arpRateParameter]}},{key:"getText",value:function(){return this.arpRateParameter.get().toString()}},{key:"documentation",get:function(){return"Cycle through notes in a chord at a rate set by the rate parameter."}},{key:"isRealTime",value:function(){return!1}},{key:"arpRate",get:function(){return this.arpRateParameter.get()},set:function(e){this.arpRateParameter.set(e)}},{key:"arpOctaves",get:function(){return this.arpOctavesParameter.get()}},{key:"arpDirection",get:function(){return this.arpDirectionParameter.get()}},{key:"arpDurationFactor",get:function(){return this.arpDurationFactorParameter.get()}},{key:"arpRepeat",get:function(){return this.arpRepeatParameter.get()}},{key:"onNewStep",value:function(){}},{key:"clear",value:function(){this.noteToDuration={},this.notesToRemove=[],this.notes=[],this.repeatIndex=0,this.index=0,this.arpDirection===g.a?this.currentOctave=this.arpOctaves:this.currentOctave=0}},{key:"input",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.stepData.duration,r=e.stepData.transpose;t||(r in this.noteToDuration?this.noteToDuration[r]=this.noteToDuration[r]+2*n:this.noteToDuration[r]=2*n),this.getIndexOfTrigger(e)<0&&(e.stepData=this.getStep(e.stepData,r,n,!1),this.notes.push(e),this.notes=this.notes.sort(function(e,t){return e.stepData.transpose-t.stepData.transpose}),this.arpDirection===g.a&&this.notes.reverse())}},{key:"output",value:function(e,t,n){var r=this,a=this.getNextTriggers(t).map(function(t){return t.time+=e,t.stepNumber=n,t});return this.notesToRemove.forEach(function(e){return r.actuallyRemoveNote(e)}),this.notesToRemove=[],a}},{key:"getIndexOfTrigger",value:function(e){for(var t in this.notes)if(this.notes[t].stepData.transpose===e.stepData.transpose)return t;return-1}},{key:"actuallyRemoveNote",value:function(e){var t=-1;for(var n in this.notes)if(e===this.notes[n].stepData.transpose){t=n;break}t>-1&&this.notes.splice(t,1),this.index>=this.notes.length&&(this.index=0,this.currentOctave=0),0===this.notes.length&&this.clear()}},{key:"removeNote",value:function(e){this.notesToRemove.push(e)}},{key:"nextNote",value:function(e){if(0!=this.notes.length){var t=this.notes[this.index],n=t.stepData.transpose;n+=12*this.currentOctave,this.repeatIndex++,this.repeatIndex>=this.arpRepeat&&(this.repeatIndex=0,this.index++),this.index>=this.notes.length&&(this.index=0,this.arpDirection===g.b?this.currentOctave=(this.currentOctave+1)%(e+1):this.arpDirection===g.a&&(this.currentOctave=(this.currentOctave-1)%(e+1),this.currentOctave<0&&(this.currentOctave=e)));var r=this.getStep(t.stepData,n,this.track.trackData.duration*this.arpDurationFactor);return new p.a(r,t.time,t.stepNumber)}}},{key:"getNextTriggers",value:function(e){var t=this,n=Object(d.a)(e,this.arpRate).map(function(e){var n=t.nextNote(t.arpOctaves);return void 0!==n&&(n.time=e.time),n}).filter(function(e){return void 0!==e});for(var r in void 0===window.timeB&&(window.timeB=0,window.timeBCount=0),this.noteToDuration)this.noteToDuration[r]-=1,this.noteToDuration[r]<=0&&(delete this.noteToDuration[r],this.removeNote(parseInt(r)));return 0===Object.keys(this.noteToDuration).length&&0===this.notes.length&&this.clear(),n}},{key:"getCopy",value:function(e){var t=new n(e);return t.fromJson(this.getJson(),!0),t}},{key:"getJson",value:function(){return Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{arpRate:this.arpRate.getJson()})}},{key:"fromJson",value:function(e,t){var r=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(h.a)(this.arpRateParameter,new v.a(16,!1).fromJson(e.arpRate),r),r}}]),n}(f.a);t.a=k},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(85),l=n(101),f=n(21),h=n(15),p=n.n(h);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var m=function(e){Object(o.a)(n,e);var t=d(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Harmony",e)).pitchParameter=new f.a("pitch",Object(i.a)(a),function(e,t){return t},{min:-32,documentation:"Gets added to the transpose of the trigger to be harmonized with",max:32,unit:"",defaultValue:5}),a.registerParameter(a.pitchParameter),a.timingOffsetParameter=new f.a("timingOffset",Object(i.a)(a),function(e,t){return t},{min:0,documentation:"The harmonizing trigger gets delayed by this amount of time (measured in 1/32th notes)",max:4,unit:"",defaultValue:0}),a.registerParameter(a.timingOffsetParameter),a.velocityParameter=new f.a("velocity",Object(i.a)(a),function(e,t){return t},{min:0,documentation:"The velocity of the harmonizing trigger",max:1,unit:"",defaultValue:1}),a.registerParameter(a.velocityParameter),a.probabilityParameter=new f.a("probability",Object(i.a)(a),function(e,t){return t},{min:0,documentation:"The probability that a harmonizing trigger will be created. This gets calculated for every trigger.",max:100,unit:"",defaultValue:100}),a.registerParameter(a.probabilityParameter),a}return Object(a.a)(n,[{key:"getVisualizedParameters",value:function(){return[this.pitchParameter]}},{key:"getText",value:function(){var e=Math.round(100*this.pitch)/100;return e>=0?"+"+e:e}},{key:"documentation",get:function(){return"Harmonizes by adding an additional trigger offsetted by pitch, for every trigger."}},{key:"pitch",get:function(){return this.pitchParameter.get()}},{key:"velocity",get:function(){return this.velocityParameter.get()}},{key:"timingOffset",get:function(){return this.timingOffsetParameter.get()}},{key:"probability",get:function(){return this.probabilityParameter.get()}},{key:"output",value:function(){var e=[];for(var t in this.triggers){var n=this.triggers[t];if(e.push(n),this.probability/100>=Math.random()){var r=n.stepData.getCopy(!0,!1,!0,!0,!1);r.transpose+=this.pitch,r.velocity=this.velocity;var a=n.time+this.timingOffset*new p.a.Time("32n").toMilliseconds()/1e3;e.push(new l.a(r,a,n.stepNumber))}}return e}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(u.a);t.a=m},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="PAD"},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(22),s=n(12),c="LP",u=function(e){var t=e.selectedType,n=e.setType,r=e.option,a=e.name,o=t===r?"selected option":"option";return i.a.createElement("div",{onClick:function(){return n(r)},className:o},a)};t.a=Object(s.b)(function(e,t){return{selectedParameter:e.effects.accumulatorParameterSelected}},function(e){return{}})(function(e){var t=Object(a.useState)(c),n=Object(r.a)(t,2),s=n[0],l=n[1];return Object(a.useEffect)(function(){e.selectedParameter&&(e.selectedParameter.name.includes("hi-pass")?l("HP"):l(c))},[e.selectedParameter,e.instrument,l]),i.a.createElement("div",{className:"instrument-subsection filter-section"},i.a.createElement("div",{className:"clear-fix"}),i.a.createElement("div",{className:"filter-types"},i.a.createElement(u,{name:"Low-pass",option:c,selectedType:s,setType:l}),i.a.createElement(u,{name:"Hi-pass",option:"HP",selectedType:s,setType:l})),i.a.createElement(o.a,{automation:e.automation,name:"Cutoff",sequencerEngine:e.sequencerEngine,lfoEnabled:!0,parameter:s===c?e.instrument.filterCutoffParameter:e.instrument.hpFilterCutoffParameter,onParameterChanged:function(){return[]},isParameter:!0,root:1.5,min:0,max:1e4,step:1}),i.a.createElement(o.a,{automation:e.automation,name:"Resonance",sequencerEngine:e.sequencerEngine,parameter:s===c?e.instrument.filterQParameter:e.instrument.hpFilterQParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:20,step:1}))})},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(129),a=[{value:r.a,label:"Amp"},{value:r.e,label:"Op. A"},{value:r.f,label:"Op. B1"},{value:r.g,label:"Op. B2"},{value:r.b,label:"Filter"},{value:r.h,label:"Pitch"}]},,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{internalType:"bytes32",name:"previousHash",type:"bytes32"},{internalType:"bytes32",name:"newHash",type:"bytes32"},{internalType:"bytes32",name:"encryptedTitle",type:"bytes32"},{internalType:"bytes32[9]",name:"encryptedContentKey",type:"bytes32[9]"},{internalType:"bytes32[6]",name:"publicKey",type:"bytes32[6]"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"editSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"guildsAddress",type:"address"},{internalType:"address",name:"encryptionAddress",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"sequenceHash",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"},{indexed:!1,internalType:"bytes32",name:"previousHash",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"encryptedTitle",type:"bytes32"},{indexed:!1,internalType:"bytes32[9]",name:"encryptedContentKey",type:"bytes32[9]"},{indexed:!1,internalType:"bytes32[6]",name:"publicKey",type:"bytes32[6]"}],name:"NewGuildSequence",type:"event"}],this.contractAddress="0x15Da2ef01D9F881f694Be962Db28b76110fa195C"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,[{key:"isCreated",value:function(){return void 0!==this.ipfsHash||void 0!==this.name}},{key:"getName",value:function(){}},{key:"getId",value:function(){}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(7),l=n(10),f=n(1),h=n(196),p=n.n(h),d=n(94),m=n(36),v=n(47),b=n(30);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var y=function(e){Object(u.a)(n,e);var t=g(n);function n(e,r,a,i,o){var c;return Object(s.a)(this,n),(c=t.call(this)).decentralized=e,c.ipfsHash=a,c.sequenceId=r,c.data=i,c.title=o,c}return Object(c.a)(n,[{key:"getName",value:function(){return this.title}},{key:"getId",value:function(){return this.ipfsHash}},{key:"save",value:function(e,t,n,r,a,s,c){var u=this;return new Promise(function(){var l=Object(o.a)(i.a.mark(function o(l,f){var h,p;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,v.a.addJson(t,void 0,s);case 2:h=i.sent,p=void 0;case 4:if(p){i.next=23;break}return i.prev=5,i.next=8,v.a.getJson();case 8:if(!(p=i.sent)){i.next=11;break}return i.abrupt("break",23);case 11:return console.log("getting json again cuz of error"),i.next=14,v.a.addJson(t,void 0,s);case 14:h=i.sent,i.next=21;break;case 17:i.prev=17,i.t0=i.catch(5),p=void 0,console.log("getting json again cuz of error");case 21:i.next=4;break;case 23:l({ipfsHash:h}),"export"!==e&&u.saveToLocalStorage(e,h),a&&b.a.saveNewSequence(n,h,e,r,c);case 26:case"end":return i.stop()}},o,null,[[5,17]])}));return function(e,t){return l.apply(this,arguments)}}())}},{key:"saveToLocalStorage",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&""!==t){e.next=2;break}return e.abrupt("return");case 2:return a=(a=d.a.getItem("sequences"))?JSON.parse(a):[],e.next=6,m.a.eth.getBlockNumber();case 6:o=e.sent,a=[{title:t,hash:n,blockNumber:o}].concat(Object(r.a)(a)),d.a.setItem("sequences",JSON.stringify(a));case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadTitle",value:function(){var e=this;return new Promise(function(t,n){console.log("loading title for ipfshash = "+e.ipfsHash),b.a.tokenizedSequences.getSequence(e.ipfsHash).then(function(e){return t(e[0]&&e[0].title)})})}},{key:"load",value:function(){var e=this;return console.log("load called with this =",this),new Promise(function(t,n){e.data?t(JSON.parse(e.data)):e.decentralized&&void 0!==e.ipfsHash?(console.log("ipfs hash = ",e.ipfsHash),v.a.getJson(e.ipfsHash).then(function(e){return t(e)})):p.a.get("/sequence/"+e.sequenceId).then(function(e){return t(e.data.data)})})}}]),n}(n(517).a);t.a=y},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(6);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}t.a=function(e){return function(e){Object(o.a)(n,e);var t=l(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"subSequence",get:function(){if(this._subSequence)return this._subSequence;if(this.context){if(this.context.subSequence)return this.context.subSequence;var e=this.track||this.context.track||this.context.group;return e&&e.subSequence}},set:function(e){this._subSequence=e}},{key:"dispatch",value:function(e){(this.sequencerEngine||this.track.sequencerEngine).dispatch(e)}},{key:"state",get:function(){var e=this.sequencerEngine||this.track;return e&&e.state}},{key:"currentPattern",get:function(){return this.state&&this.subSequence&&this.subSequence.tracks&&this.subSequence.tracks[0]?this.subSequence.tracks[0].currentPattern:0}},{key:"patternLocks",get:function(){return this.state&&this.state.effects.effectPatternLocks[this.id]||{}}},{key:"locked",get:function(){return this.patternLocks[this.currentPattern]}},{key:"lock",set:function(e){console.log("setting lock for current pattern = ",this.currentPattern),console.log(this),this.lockPattern(this.currentPattern,e)}},{key:"lockPattern",value:function(e,t){var n=Object(r.a)({},this.patternLocks);n[e]=t,this.dispatch(Object(u.Wb)(this.id,n))}}]),n}(e)}},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(21),s=n(97),c=n(32),u=n(23),l=n(45),f=function(){function e(t,n){Object(a.a)(this,e),this.id=Object(l.uuid)(),this.track=n,this.sequencerEngine=n.sequencerEngine,this.store=this.sequencerEngine.store,this.name=t,this.parameters=[],this.enabledParameter=new o.a("enabled",this,function(e,t){return[]},{min:!1,max:!0,unit:"",defaultValue:!0}),this.registerParameter(this.enabledParameter),this.numberOfOutputs=1}return Object(i.a)(e,[{key:"getObjectType",value:function(){return s.a}},{key:"enabled",get:function(){return this.enabledParameter.get()},set:function(e){this.enabledParameter.set(e)}},{key:"toggleEnabled",value:function(){this.enabled=!this.enabled}},{key:"isEnabled",value:function(){return this.enabled}},{key:"getJson",value:function(){var e={name:this.name,enabled:this.enabled,id:this.id,x:this.x,y:this.y};for(var t in e=this.saveParameterToJson(e,"enabledParameter",this.enabledParameter),this.parameters){var n=this.parameters[t];e[n.name]=n.get();var r=n.name+"Parameter";e=this.saveParameterToJson(e,r,n)}return e}},{key:"fromJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];void 0===e.id||t||(this.id=e.id,this.track.sequencerEngine&&(this.track.sequencerEngine.idToObject[this.id]=this)),void 0!==e.x&&(this.x=e.x,this.y=e.y);var n={};for(var a in Object(c.a)(this.enabledParameter,e.enabled,n),n=Object(r.a)({},n,this.loadParameterFromJson(e,"enabledParameter",this.enabledParameter)),this.parameters){var i=this.parameters[a],o=e[i.name];void 0!==o&&null!==o&&Object(c.a)(i,o,n),n=Object(r.a)({},n,this.loadParameterFromJson(e,i.name+"Parameter",i,t))}return n}},{key:"registerContext",value:function(e){e=e.forEffect(this),this.parameters.forEach(function(t){return t.setContext(e)})}},{key:"registerMixSession",value:function(e){this.parameters.forEach(function(t){return t.setMixSession(e)})}},{key:"registerTrack",value:function(e){this.parameters.forEach(function(t){return t.setTrack(e)})}},{key:"registerParameter",value:function(e){void 0!==e&&(e.effectName=this.name,e.setStore(this.store),this.parameters.push(e))}},{key:"saveParameterToJson",value:function(e,t,n){return Object(u.b)(e,t,n)}},{key:"loadParameterFromJson",value:function(e,t,n,r){return Object(u.a)(e,t,n,this.track.sequencerEngine,r)}},{key:"getEffectCopy",value:function(){return this.getCopy(this.track)}}]),e}();t.a=f},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(57),l=n(6),f=n(21);function h(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}t.a=function(e){return function(e){Object(o.a)(n,e);var t=d(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).parameterVariables=[],e.checkboxVariables=[],e.trackVariables=[],e.variables=[],e}return Object(i.a)(n,[{key:"var",value:function(e){var t=this;return this.scriptEffect?this.scriptEffect.var(e):function(){var n=t[e+"Parameter"];return n?n.get():0}}},{key:"newParamVar",value:function(e){var t=new f.a(e,this,function(e,t){return t},{min:0,max:16,unit:"",defaultValue:""});this[e+"Parameter"]=t,this.registerParameter(t),this.parameterVariables.push(t)}},{key:"newTrackVar",value:function(e){var t=new f.a(e,this,function(e,t){return t},{min:0,max:16,unit:"",defaultValue:0});this[e+"Parameter"]=t,this.registerParameter(t),this.trackVariables.push(t)}},{key:"newCheckboxVar",value:function(e,t){var n=new f.a(e,this,function(e,t){return t},{min:0,max:1,unit:"",defaultValue:t});this[e+"Parameter"]=n,this.registerParameter(n),this.checkboxVariables.push(n)}},{key:"newVar",value:function(e,t,n,r,a,i,o){if(this.scriptEffect)return this.scriptEffect.newVar(e,t,n,r,a,i);if(this[e+"Parameter"])return this.variables=this.variables.filter(function(t){return t.name!==e}),this.variables.push(this[e+"Parameter"]),this[e+"Parameter"];if(this.oldVariables){var s=this.oldVariables.find(function(t){return t.name===e});if(s)return this.variables=this.variables.filter(function(t){return t.name!==e}),this.variables.push(s),this[e+"Parameter"]=s,this.registerParameter(s),s}var c=new f.a(e,this,function(e,t){return t},{min:n,max:r,unit:"",defaultValue:t,documentation:a,hide:i,onChange:o});return this[e+"Parameter"]=c,this.registerParameter(c),void 0===this.context&&(this.context=(new u.a).forMidiEffect(this).forTrack(this.track)),c.setContext(this.context),this.variables.push(c),this.track.sequencerEngine.dispatch(Object(l.Ub)(c.i,t)),c}},{key:"updateVariablesRedux",value:function(){var e=this.track&&this.track.sequencerEngine||this.sequencerEngine;e&&e.dispatch(Object(l.Qe)(this.id,Object(r.a)(this.variables)))}},{key:"clearVariables",value:function(){var e=this,t={};if(this.scriptEffect)return t;var n,a=h(this.variables);try{var i=function(){var r=n.value;t[r.name]=r,delete e[r.name+"Parameter"],e.parameters=e.parameters.filter(function(e){return e.name!==r.name})};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return this.oldVariables=[].concat(Object(r.a)(this.oldVariables||[]),Object(r.a)(this.variables)),this.variables=[],t}}]),n}(e)}},function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"a",function(){return h}),n.d(t,"b",function(){return p});var r=n(9),a=n(8),i=n(83),o=function e(t,n,r){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=r/function(e){e.cycleLength;for(var t=0,n=0;n<e.length;n++){var r=e[n];Array.isArray(r)&&void 0!==r.cycleLength?t+=r.cycleLength:t++}return t}(t),l=0,f=[];l<t.length;l++){var h=u*(t[l].cycleLength||1);if(null!==t[l]&&Array.isArray(t[l]))n>=Math.floor(o)&&n<o+h&&e(t[l],n,h,o,s).forEach(function(e){return f.push(e)});else if(t[l]&&t[l].cycle){if(n>=o&&n<o+h){var p=!0;if("/"===t[l].operator&&(p=s%t[l].operand===0),p){var d="^"===t[l].operator?t[l].operand:0;e(t[l].cycle,n,h,o,s,d).forEach(function(e){return f.push(e)})}}}else if(n==Math.floor(o)){var m=!0;"/"===t[l].operator&&(m=s%t[l].operand===0),m&&f.push(Object(a.a)({},t[l],{outputNumber:t[l].operator===i.a?t[l].operand:c,offset:o-Math.floor(o),duration:h/2,cycle:t[l].id,leaf:t[l]}))}t[l].cycleLength;o+=h}return f},s=function(e){return e.stepNumber},c=function(e){return e.length},u=function(e){return o(l(e.cycle),s(e)%c(e),c(e),0,Math.floor(s(e)/c(e)))},l=function e(t){for(var n=[],a=t.cycleLength,i=0;i<t.length;i++)Array.isArray(t[i])?n.push(e(t[i])):n=[].concat(Object(r.a)(n),Object(r.a)(f(t[i])));return n.cycleLength=a,n},f=function(e){var t=void 0,n=e.operator,r=e.operand,i=(e.transpose,e.cycle);if(t=i?l(i):e,"*"===n){for(var o=[],s=0;s<r;s++)o.push(t);return o}if("^"===n){for(var c=[],u=0;u<r;u++)c.push(Object(a.a)({},t,{factor:(u+1)/(r+1)}));return c}return[e]},h=function(e,t,n){for(var r=e.flat(16),a=0;a<r.length;a++){if(r[a].id===t.id)return a}return-1},p=function(e,t,n){for(var r=e.flat(16),a=-1,i=-1,o=-1,s=0;s<r.length;s++){var c=r[s];if(-1===o&&null!==t.transpose&&(o=s),c.id!==t.id){if(null!==c.transpose&&-1!==a){i=s;break}}else a=s}return-1===i?o+r.length-a:(i-a)*(n/e.length/2)}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=n(172),f=n(17);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Alternate",e)).clear(),a.numberOfOutputs=2,a}return Object(a.a)(n,[{key:"documentation",get:function(){return["Alternates the 2 outputs every other trigger."]}},{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){this.myScript=Object(u.a)(Object(l.a)(Object(f.O)(0),Object(f.O)(1)))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=p},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(17),a=n(344),i=n(172),o=function(e){var t=Object(i.a)(e);return function(){if(!(arguments.length<=0?void 0:arguments[0]))return Object(r.w)(!1);var e=t.apply(void 0,arguments);return Object(r.P)(Object(a.a)(e,Object(r.P)()))}}},function(e,t,n){"use strict";var r=n(9),a=n(8),i=n(2),o=n(4),s=n(7),c=n(10),u=n(1),l=n(35),f=n(552),h=n(6),p=n(223);n(311);function d(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}t.a=function(e){return function(e){Object(s.a)(n,e);var t=v(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).variations=[],e.generation=0,e._bestSolutions=[],e}return Object(o.a)(n,[{key:"firstReproduction",value:function(e){var t=[];this._parameters.forEach(function(e){return t[e.id]=e.getCoordinates()}),this.variations=this.generateVariations(t,e)}},{key:"clearGenetic",value:function(){this.generation=0,this.variations=[],this.categories=void 0,this._bestSolutions=[],this.selectedVariation=void 0}},{key:"getBestCopy",value:function(){return this.bestSolutions.map(function(e){return Object(a.a)({},e)})}},{key:"reproduceSnapshots",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=Object(r.a)(this.effect.snapshots).slice(0,16),a=[],i=d(n);try{var o=function(){var t=e.value,n={};t.forEach(function(e){var t=e.parameter,r=e.coordinates;return n[t.id]=r}),a.push(n)};for(i.s();!(e=i.n()).done;)o()}catch(u){i.e(u)}finally{i.f()}var s=[];this._parameters.forEach(function(e){return s[e.id]=e.getCoordinates()});var c=this.generateVariations(s,t-a.length);this.variations=[].concat(a,Object(r.a)(c)),this.generation++,this._bestSolutions=[]}},{key:"unsupervised",value:function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,n=this.effect.snapshots.length||8,a=0;a<t;a++){if(0==a){if(this.effect.snapshots.length>0){this.reproduceSnapshots();for(var i=0;i<n;i++)this.selectBest(i);continue}this.reproduce(void 0,64,8)}else this.reproduce(void 0,64,8);Math.floor(n*Object(p.b)());for(var o=0;o<n;o++)this.selectBest(o);var s=n+Math.floor(53*Object(p.b)());this.selectBest(s),this.selectedVariation=s;var c=[],u=function(t){var n=e.variations[s][t],r=e._parameters.find(function(e){return e.id===t});c.push({parameter:r,coordinates:n,min:r.min,max:r.max})};for(var l in this.variations[s])u(l);this.effect.snapshots.push(c)}this.effect.snapshots=Object(r.a)(this.effect.snapshots),this.currentSnapshotParameter.set(this.snapshots.length-1),this.clearGenetic()}},{key:"reproduce",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.8125,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(0===this.generation)this.firstReproduction(t);else{var a=this.getBestCopy();if(0===a.length)return;for(var i=Object(r.a)(a),o=Object(r.a)(this.nonBestSolutions),s=[],c=i.length;c<o.length-n;c++){var u=b(a),l=b(o),f=this.breed(u,l);s.push(f),i.push(f)}for(var h=[],p=0;p<n;p++){var d=b(a),m=this.generateVariation(d,e);h.push(m),i.push(m)}this.categories={elite:a,children:s,mutations:h},this.variations=i}this.generation++,this._bestSolutions=[],1==this.generation&&(this.selectBest(0),this.reproduce())}},{key:"selectBest",value:function(e){this._bestSolutions.includes(e)?this._bestSolutions=this._bestSolutions.filter(function(t){return t!==e}):this._bestSolutions.push(e)}},{key:"selectVariation",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=this.variations[e],i={},o=function(e){var o=n._parameters.find(function(t){return t.id===e});if(!o)return"continue";var s=a[e],c=s.x,u=s.y,l=o.setCoordinates(c,u,t,r,!0),f=l.id,h=l.value;n.effect.clearParameter(o,void 0,!0),i[f]=h};for(var s in a)o(s);this.track.sequencerEngine.dispatch(Object(h.Vb)(i)),this.selectedVariation=e}},{key:"breed",value:function(e,t){var n,r={},i=d(this._parameters);try{for(i.s();!(n=i.n()).done;){var o=n.value.id,s=Object(p.b)();r[o]=s<.6?Object(a.a)({},e[o]):Object(a.a)({},t[o])}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"bestSolutions",get:function(){var e=this;return this._bestSolutions.map(function(t){return e.variations[t]})}},{key:"nonBestSolutions",get:function(){var e=[];for(var t in this.variations)this.bestSolutions.includes(t)||e.push(this.variations[t]);return e}},{key:"generateVariations",value:function(e,t){for(var n=1/8,r=[e],a=1;a<t;a++){var i=this.generateVariation(e,n);r.push(i),n+=1/32}return r}},{key:"generateVariation",value:function(e,t){var n,r={},a=d(this._parameters);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(e[i.id]){var o=e[i.id],s=o.x,c=o.y;r[i.id]={x:Object(f.a)(s,0,l.c,t),y:Object(f.a)(c,0,l.a,t)}}}}catch(u){a.e(u)}finally{a.f()}return r}}]),n}(e)};var b=function(e){return e[Math.floor(Object(p.b)()*e.length)]}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(35),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.length,a=new Float32Array(e.map(function(e){return e.toSeconds?e.toSeconds(!0):e.getNumber(!0)})),i=new Float32Array(e.map(function(e){return e.depth})),o=new Float32Array(e.map(function(e){return e.min})),s=new Float32Array(e.map(function(e){return e.max})),c=new Float32Array(e.map(function(e){return e.depthParameter?e.depthParameter.min:0})),u=new Float32Array(e.map(function(e){return e.depthParameter?e.depthParameter.max:1})),l=window.api.create_buffer(n),f=window.api.create_buffer(n),h=window.api.create_buffer(n),p=window.api.create_buffer(n),d=window.api.create_buffer(n),m=window.api.create_buffer(n);window.Module.HEAPF32.set(a,l>>2),window.Module.HEAPF32.set(i,f>>2),window.Module.HEAPF32.set(c,h>>2),window.Module.HEAPF32.set(u,p>>2),window.Module.HEAPF32.set(o,d>>2),window.Module.HEAPF32.set(s,m>>2);var v=window.api.create_geometry_buffer(n),b=window.api.create_geometry_buffer(n);window.api.getCoordinates(l,f,d,m,h,p,r.c,r.a,r.b,1,n,v,b);var g,y=new Uint32Array(window.Module.HEAP32.buffer,v,n),k=new Uint32Array(window.Module.HEAP32.buffer,b,n);if(t){g=new Float32Array(2*n);for(var O=0;O<n;O++)g[2*O]=y[O],g[2*O+1]=k[O]}else{g=[];for(var j=0;j<n;j++)g.push({x:y[j],y:k[j]})}return window.api.destroy_buffer(l),window.api.destroy_buffer(f),window.api.destroy_buffer(h),window.api.destroy_buffer(p),window.api.destroy_buffer(d),window.api.destroy_buffer(m),window.api.destroy_buffer(b),window.api.destroy_buffer(v),g}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1);n(130);function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var l=function(e){Object(o.a)(n,e);var t=u(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"currentEvent",set:function(e){this.mixByType.currentEvent=e}},{key:"execute",value:function(){Object(i.a)(Object(c.a)(n.prototype),"execute",this).call(this),this.currentEvent=this.event}}]),n}(n(434).a);t.a=l},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var u=function(e){Object(i.a)(n,e);var t=c(n);function n(e,a){var i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(r.a)(this,n),(i=t.call(this,e,a.getType())).event=a,i.inPlace=o,i}return Object(a.a)(n,[{key:"execute",value:function(){var e=this.events.indexOf(this.event);if(e>-1&&this.events.splice(e,1),!this.inPlace){var t=this.event.duration;for(var n in this.events)if(this.events[n].step>this.event.step&&(this.events[n].step-=t,this.inPlace))return}this.mix.restart()}}]),n}(n(130).a);t.a=u},function(e,t,n){"use strict";var r=n(8),a=n(9),i=n(2),o=n(4),s=n(16),c=n(7),u=n(10),l=n(1),f=n(56),h=(n(57),n(92),n(104),n(45),n(15)),p=n.n(h),d=(n(432),n(41),n(23),n(151)),m=(n(375),n(315)),v=n(321),b=n(313);function g(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var O=function(e){Object(c.a)(n,e);var t=k(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,"Effect Rack",function(){return new p.a.Gain(1)},e)).inputNode=r.effectNode,r.inputNode.x=0,r.inputNode.y=200,r.outputNode=new p.a.Gain(1),r.outputNode.id="speakers-"+r.id,r.outputNode.x=400,r.outputNode.y=200,r.initializeConfigurations(r.adjacencyLists),r}return Object(o.a)(n,[{key:"onBPMUpdated",value:function(){for(var e in this.effects)this.effects[e].onBPMUpdated&&this.effects[e].onBPMUpdated()}},{key:"getParameters",value:function(){var e=Object(s.a)(Object(l.a)(n.prototype),"getParameters",this).call(this);for(var t in this.macros)e=[].concat(Object(a.a)(e),Object(a.a)(this.macros[t].parameters));return e}},{key:"connect",value:function(e){this.outputNode.connect(e)}},{key:"disconnect",value:function(){this.outputNode.disconnect()}},{key:"addEffect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(s.a)(Object(l.a)(n.prototype),"addEffect",this).call(this,e,t),t&&e.enable(!0),t&&e.wetParameter&&e.wetParameter.set(1)}},{key:"dispose",value:function(){for(var e in this.macros.forEach(function(e){return e.dispose()}),this.macros=[],this.effects.forEach(function(e){return e.dispose()}),this.adjacencyLists)this.adjacencyLists[e]&&this.adjacencyLists[e].forEach(function(e){return e.dispose()});this.adjacencyLists=void 0,Object(s.a)(Object(l.a)(n.prototype),"dispose",this).call(this),this.outputNode.dispose(),this.outputNode=void 0,this.effects=void 0,this.macros=void 0}},{key:"deleteEdge",value:function(e){var t=this;if(!e.modulator){var r=function(n){if(t.adjacencyLists[n].indexOf(e)>-1)if(-1===parseInt(n))t.inputNode.disconnect(e.gain);else{var r=t.effects.find(function(e){return e.id===n});r&&r.disconnect(e.gain)}};for(var a in this.adjacencyLists)r(a)}Object(s.a)(Object(l.a)(n.prototype),"deleteEdge",this).call(this,e)}},{key:"connectEdge",value:function(e,t){return Object(s.a)(Object(l.a)(n.prototype),"connectEdge",this).call(this,e,t),e.connect(t.gain),t}},{key:"getJson",value:function(){return Object(r.a)({},this.getRackJson(),{isCollapsed:this.isCollapsed})}},{key:"muteRack",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.inputNode.gain.value=e?0:1,this.outputNode.gain.value=e?0:1}},{key:"fromJson",value:function(e,t,a,i){this.muteRack(!0),Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,i),this.isCollapsed=e.isCollapsed,this.adjacencyLists={},this.configurations=[],this.effects.forEach(function(e){return e.dispose()}),this.effects=[];var o=e.effects,c={};for(var u in o){var f=o[u],h=Object(d.a)(f,t,this.sequencerEngine,a),p=h.effect;this.addEffect(p,!1),p.id=f.id,p.x=f._x||f.x,p.y=f._y||f.y,c=Object(r.a)({},c,h.bulk)}return this.fromRackJson(e,i),this.muteRack(!1),this.outputNode.id="speakers-"+this.id,c}},{key:"fromJsonSync",value:function(e,t,r,a,i,o){Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,!0),this.adjacencyLists={},this.configurations=[],this.effects.forEach(function(e){return e.dispose()}),this.effects=[];for(var c in a){var u=a[c].getEffectCopy(i,o);this.addEffect(u,!1),u.x=e.effects[c].x,u.y=e.effects[c].y;var f=a[c];if(u.id!==f.id){var h,p=g(e.configurations);try{for(p.s();!(h=p.n()).done;){var d=h.value,m=d[f.id];d[u.id]=m,delete d[f.id]}}catch(v){p.e(v)}finally{p.f()}}}return this.fromRackJson(e,!0),{}}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e),a=this.context.track;return r.fromJsonSync(this.getJson(),this.sequencerEngine.tracks,void 0!==a?a.trackNumber:0,this.effects,e,t),r}}]),n}(Object(b.a)(Object(v.a)(Object(m.a)(f.a.Effect))));t.a=O},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(56),f=n(32),h=n(15),p=n.n(h),d=(n(21),n(41)),m=n(212);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var b=new Float32Array(65536),g=function(e){Object(s.a)(n,e);var t=v(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Saturator",function(){return new p.a.Gain(1)},e)).waveShaperNode=new p.a.WaveShaper([-1,1]),r.effectNode.connect(r.waveShaperNode),r.postGain=new p.a.Gain(1),r.waveShaperNode.connect(r.postGain),r.params=r.getParams(-10,20,30,6),r.driveParameter=new d.a("Drive",r.effectNode.gain,function(e,t){r.effectNode.gain.value=t,r.postGain.gain.value=Math.pow(1/t,.6)},{documention:"Controls the level of saturation.",min:.01,max:32,unit:"",defaultValue:1,constantAutomationRate:!0}),r.registerParameter(r.driveParameter),r.waveShaperNode.curve=r.generateCurve(),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"documentation",get:function(){return"Saturates the sound, making it more distorted."}},{key:"dispose",value:function(){this.driveParameter.dispose(!1),Object(o.a)(Object(u.a)(n.prototype),"dispose",this).call(this),this.postGain.dispose(),this.waveShaperNode.dispose(),this.postGain=void 0,this.waveShaperNode=void 0,this.driveParameter=void 0}},{key:"connect",value:function(e){this.postGain.connect(e)}},{key:"disconnect",value:function(e){this.postGain.disconnect(e)}},{key:"getParams",value:function(e,t,n,r){var a=Object(m.a)(e),i=(Object(m.a)(t),1/n),o=this.kAtSlope(1/n,e,t,a),s=e+t,c=Object(m.a)(s);return{linearThreshold:a,thresholdDb:e,kneeDb:t,ykneeThresholdDb:Object(m.b)(this.saturateBasic(c,o,a)),kneeThreshold:c,kneeThresholdDb:s,k:o,ratio:n,slope:i}}},{key:"slopeAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.params.linearThreshold;if(e<n)return 1;var r=1.001*e,a=Object(m.b)(e),i=Object(m.b)(r),o=Object(m.b)(this.saturateBasic(e,t,n));return(Object(m.b)(this.saturateBasic(r,t,n))-o)/(i-a)}},{key:"kAtSlope",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.params.thresholdDb,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.params.kneeDb,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.params.linearThreshold,a=t+n,i=Object(m.a)(a),o=.1,s=1e4,c=5,u=0;u<15;++u){this.slopeAt(i,c,r)<e?(s=c,c=Math.sqrt(o*s)):(o=c,c=Math.sqrt(o*s))}return c}},{key:"saturateBasic",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.params.linearThreshold;return e<n?e:n+(1-Math.exp(-t*(e-n)))/t}},{key:"saturate",value:function(e){var t;if(e<this.params.kneeThreshold)t=this.saturateBasic(e,this.params.k);else{var n=Object(m.b)(e),r=this.params.ykneeThresholdDb+this.params.slope*(n-this.params.kneeThresholdDb);t=Object(m.a)(r)}return t}},{key:"generateCurve",value:function(){for(var e=32768,t=0,n=0;n<e;++n)t=n/e,t=this.saturate(t),b[e+n]=t,b[e-n-1]=-t;return b}},{key:"getJson",value:function(){var e=Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{drive:this.driveParameter.get()});return e=this.saveParameterToJson(e,"driveParameter",this.driveParameter)}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(f.a)(this.driveParameter,e.drive,a),Object(r.a)({},a,this.loadParameterFromJson(e,"driveParameter",this.driveParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(l.a.Effect);t.a=g},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});var r="RANDOM",a="MOST_RECENT",i="MOST_POPULAR"},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(15),u=n.n(c);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}new u.a.Time("16n");t.a=function(e){return function(e){Object(i.a)(n,e);var t=l(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"setupSlide",value:function(){this.slideEnvelope=new u.a.ScaledEnvelope({attack:.1,decay:1e-4,sustain:1,release:1e-5,curve:"linear"}),this.slideEnvelope._releaseCurve="linear",this.slideEnvelope.connect(this.detuneSignal)}},{key:"triggerSlide",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=0,i=0,o=void 0!==this.lastTranspose?this.lastTranspose:e;r&&(void 0!==this.lastSlideTranspose?(a=this.lastSlideMax,i=100*(e-o)):i=100*(e-o)),this.slideEnvelope.min=a,this.slideEnvelope.max=i;var s=n;this.slideEnvelope.attack=s,t&&!isNaN(t)&&this.slideEnvelope.triggerAttack(t),r&&(this.lastSlideMax=i,this.lastSlideTranspose=e)}},{key:"releaseSlide",value:function(e){this.slideEnvelope.min=0,this.slideEnvelope.triggerRelease(e?Math.max(0,e-1e-4):void 0)}},{key:"clearSlide",value:function(){this.lastSlideTranspose=void 0,this.lastSlideMax=void 0,this.releaseSlide(u.a.Master.context.currentTime+.01)}}]),n}(e)}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){var t=[0,1,2],n=function(t){return e[2*t]},r=function(t){return e[2*t+1]};t.sort(function(e,t){return r(e)===r(t)?n(e)-n(t):r(e)-r(t)});var a=[];return t.forEach(function(e){a.push(n(e)),a.push(r(e))}),a}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(6),f=n(34),h=n(12);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"isToggled",value:function(){return void 0!==this.props.instrument?this.props.instrument.isParameterConnectedToLFO(this.props.parameter,this.props.lfo):this.props.parameter&&this.props.parameter.isConnectedToLFO(this.props.lfo)}},{key:"toggle",value:function(){void 0!==this.props.instrument?this.props.instrument.toggleParameterWithLFO(this.props.parameter,this.props.lfo):(this.props.parameter.isAudioParamEnabled()||this.props.parameter.enableAudioParam(),this.isToggled()?this.props.disconnectFromLFO?this.props.disconnectFromLFO(this.props.lfo,!0):this.props.parameter.disconnectFromLFO(this.props.lfo,!0):(this.props.connectToLFO?this.props.connectToLFO(this.props.lfo,!0):this.props.parameter.connectToLFO(this.props.lfo,!0),this.props.setSelectedLFO(this.props.lfo.number))),this.setState({toggled:this.isToggled()})}},{key:"showMods",value:function(e){this.props.setShowLFOs(!0)}},{key:"onMouseOver",value:function(e){e.stopPropagation(),this.props.setContextualHelp(f.Q)}},{key:"render",value:function(){var e=this,t=this.isToggled()?" toggled ":"",n=this.props.lfos.indexOf(this.props.lfo);return u.a.createElement("div",{onMouseOver:function(t){return e.onMouseOver(t)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.toggle()},className:"pushable parameter-lfo-toggle lfo-"+n+t},n+1)}}]),n}(c.PureComponent);t.a=Object(h.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(l.ub)(t))},setSelectedLFO:function(t){return e(Object(l.bf)(t))},setShowLFOs:function(t){return e(Object(l.Pf)(t))},setArrangementBottomMode:function(t){return e(Object(l.D)(t))},setShowPianoRoll:function(t){return e(Object(l.Wf)(t))}}})(d)},function(e,t,n){"use strict";var r=n(28),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=n(59),h=n(62);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var d=function(e){Object(o.a)(n,e);var t=p(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={minValue:r.min,maxValue:r.max},r}return Object(i.a)(n,[{key:"parameter",get:function(){return this.props.parameterMod.parameter}},{key:"mod",get:function(){return this.props.parameterMod}},{key:"min",get:function(){return this.mod.scale.min}},{key:"max",get:function(){return this.mod.scale.max}},{key:"onChangeMin",value:function(e){(Object(h.a)(e)||"."===e||""===e||"-"===e)&&(this.setState({minValue:e}),Object(h.a)(e)?(console.log("returning because = "+e),this.mod.min=e):"."!==e&&""!==e&&"-"!==e||(this.mod.min=0))}},{key:"onChangeMax",value:function(e){Object(h.a)(e)||"."===e||""===e||"-"===e?(this.setState({maxValue:e}),Object(h.a)(e)?this.mod.max=e:"."!==e&&""!==e&&"-"!==e||(this.mod.max=0)):console.log("returning because = "+e)}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"parameter-mod"},l.a.createElement("div",{className:"parameter-mod-pieces"},l.a.createElement("div",{className:"parameter-mod-modulator"},this.mod.type," ",this.mod.modulator.number," "),l.a.createElement("div",{className:"parameter-mod-text"},"mod"),l.a.createElement("div",{className:"parameter-mod-parameter"},this.parameter.name," ")),l.a.createElement("div",{className:"parameter-mod-min"},"Min:",l.a.createElement(m,{placeholder:"Min",onChange:function(t){return e.onChangeMin(t)},number:this.state.minValue})),l.a.createElement("div",{className:"parameter-mod-max"},"Max:",l.a.createElement(m,{placeholder:"Max",onChange:function(t){return e.onChangeMax(t)},number:this.state.maxValue})))}}]),n}(u.Component),m=function(e){Object(o.a)(n,e);var t=p(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"number-input-container"},l.a.createElement(f.g,Object(r.a)({onChange:function(t){return e.props.onChange(t.target.value)},value:this.props.number,className:"search-input",placeholder:this.props.placeholder},"className","number-input")))}}]),n}(u.Component);t.a=d},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12),f=n(39),h=n.n(f),p=n(46),d=n(184);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var g=function(e){Object(i.a)(n,e);var t=b(n);function n(e){var a;Object(r.a)(this,n),(a=t.call(this,e)).state={},a.options=[].concat(y);var i,o=m(d.a);try{for(o.s();!(i=o.n()).done;){var s=i.value;a.options.push({label:s,value:s})}}catch(c){o.e(c)}finally{o.f()}return a.options.push({label:"Custom",value:"custom"}),a}return Object(a.a)(n,[{key:"getOscillatorOption",value:function(e){return this.options.find(function(t){return t.value===e})}},{key:"getSelectedOscillatorType",value:function(){return this.props.oscillator.customOscillatorType||this.props.oscillator.oscillatorType}},{key:"onSelectOscillatorType",value:function(e){var t="none"===e.value?void 0:e.value,n=this.props.oscillator.oscillatorTypeParameter;d.a.indexOf(t)>-1&&(n=this.props.oscillator.customOscillatorTypeParameter),"custom"===t?this.props.oscillator.oscillatorType="custom":this.props.sequencerEngine.operationManager.dispatch(Object(p.v)(n,t,!0)),this.setState(this.state)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(h.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.options,onChange:function(t){return e.onSelectOscillatorType(t)},value:this.getOscillatorOption(this.getSelectedOscillatorType()),placeholder:"Osc. Type"})))}}]),n}(c.Component),y=[{value:"square",label:"Square"},{value:"sine",label:"Sine"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"},{value:"pwm",label:"PWM"},{value:"pulse",label:"Pulse"},{value:"fatsquare",label:"Fat Square"},{value:"fatsine",label:"Fat Sine"},{value:"fattriangle",label:"Fat Triangle"},{value:"fatsawtooth",label:"Fat Sawtooth"},{value:"fmsquare",label:"FM Square"},{value:"fmsine",label:"FM Sine"},{value:"fmtriangle",label:"FM Triangle"},{value:"fmsawtooth",label:"FM Sawtooth"}];t.a=Object(l.b)(function(e,t){return{type:t.oscillator.oscillatorType,customType:t.oscillator.customOscillatorType}},null)(g)},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r=function(e,t,n){var r=e.sequencerEngine.findNodeById(n.edge.destId),a=e.sequencerEngine.findNodeById(n.edge.sourceId);r&&a&&r.disconnectInlet(n.edge.destType,a,n.edge.sourceType),e.connectInlet(t,a,n.sourceType)},a=function(e,t,n){var r=e.sequencerEngine.findNodeById(n.edge.destId),a=e.sequencerEngine.findNodeById(n.edge.sourceId);console.log("move edge outlet outletType=",t,a,r),r&&a&&r.disconnectInlet(n.edge.destType,a,n.edge.sourceType),r.connectInlet(n.edge.destType,e,t)}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(147),o=n(208),s=n(49),c=n(12),u=Object(r.memo)(function(e){var t=e.isBackground,n=e.className,c=e.zobject,u=e.width,l=e.height;if(t&&(l=window.innerHeight-80,u=window.innerWidth-240),c.attributes["fill subpatch"]){for(var f=c.subSequence;f.subSequence&&!f.subSequence.tracks;)f=f.subSequence;console.log("top most subpatch=",f),f.zObject&&(u=f.zObject.width,l=f.zObject.height)}var h=Object(r.useRef)(!1),p=Object(r.useRef)(void 0),d=(Object(r.useRef)(void 0),Object(r.useRef)(void 0)),m=(Object(r.useRef)(void 0),Object(o.a)({containerRef:p,scale:1}).getXY),v=Object(r.useCallback)(function(e){if(h.current){e.touches&&(e=e.touches[0]);var t=m(e),n=t.x,r=t.y;c.effect.onMouseMove(n,r)}},[c]),b=Object(r.useCallback)(function(e){},[c]),g=Object(r.useCallback)(function(e){if(h.current=!0,!i.isMobile||e.touches){e.touches&&(e=e.touches[0]);var t=m(e),n=t.x,r=t.y;c.effect.onMouseDown(n,r)}},[c]),y=Object(r.useCallback)(function(e){i.isMobile&&!e.touches||(h.current=!1,c.effect.onMouseUp())},[c]);return Object(r.useEffect)(function(){d.current&&(d.current.setSize(u,l),d.current.setPixelRatio(window.devicePixelRatio)),c.effect&&(console.log("sending size to=",u,l),c.effect.sendMessage("size",[u,l]))},[u,l,c]),Object(r.useEffect)(function(){if(!c.effect.ctxt)return d.current=new s.S({antialias:!0,preserveDrawingBuffer:!0}),c.effect.ctxt=d.current,c.effect.renderer=d.current,d.current.setSize(u,l),d.current.setPixelRatio(2),p.current.appendChild(d.current.domElement),function(){return c.effect.ctxt=void 0}},[]),a.a.createElement("div",{className:n,onMouseMove:v,onMouseDown:g,onMouseUp:y,onTouchMove:v,onTouchStart:g,onTouchEnd:y,onClick:b,style:{width:u,height:l},ref:p})}),l=function(e){for(var t=e.subSequence;t.subSequence&&!t.subSequence.tracks;)t=t.subSequence;return t};t.a=Object(c.b)(function(e,t){var n=l(t.zobject);return{isBackground:e.zobject.zobjectBackground&&e.zobject.zobjectBackground.id===t.zobject.id,outerWidth:n&&n.zObject&&n.zObject.width,outerHeight:t.zobject.subSequence.zObject&&t.zobject.subSequence.zObject.height,width:t.width||t.zobject.width,height:t.height||t.zobject.height}},function(e){return{}})(u)},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(155),s=n(319),c=n(6),u=(n(22),n(241)),l=(n(83),n(12));t.a=Object(l.b)(function(e,t){return{_figures:t.effect.figures._figures}},function(e){return{setSelectedZObject:function(t){return e(Object(c.uf)(t))}}})(function(e){var t=e.isDraggable,n=e.effect,c=e.zobject,l=e.setChosen,f=e.chosen,h=(e._figures,e.setSelectedZObject),p=Object(a.useState)(n.figures.figures),d=Object(r.a)(p,2),m=d[0],v=d[1];Object(a.useEffect)(function(){m!==n.figures.figures&&v(n.figures.figures)},[n.figures,v,m]);var b=Object(a.useCallback)(function(){n.figures.newFigure(),v(n.figures.figures)},[v]);return i.a.createElement("div",null,i.a.createElement(s.a,{isDraggable:t,effect:n,skipDiv:!0,instrument:n.figuresComponent,type:o.b,className:"figures"},m.map(function(e){return i.a.createElement("div",{className:f&&f.figure===e?"figure selected":"figure"},i.a.createElement("div",{onClick:function(t){console.log("zobject=",c),c&&h(c),t.stopPropagation(),l&&(f&&f.type===u.a&&f.figure===e?l(void 0):l({type:u.a,figure:e}))},className:"figure-button"},Math.round(e.figureLength)),i.a.createElement("div",{className:"cycle-string"},e.toString()))}),i.a.createElement("dig",{className:"figure"},i.a.createElement("div",{onClick:b,className:"figure-button add"},"+"))))})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(6),o=n(12);t.a=Object(o.b)(function(e,t){return{drawingEdge:e.pads.drawingEdges[t.pad.subSequence.id]}},function(e){return{setDrawingPadEdge:function(t,n){return e(Object(i.Nb)(t,n))}}})(function(e){var t=e.setDrawingPadEdge,n=e.isSpeaker,i=e.drawingEdge,o=e.fx,s=e.pad,c=e.id,u="effect-input-"+(void 0===c?o.id:c),l=Object(r.useCallback)(function(e){if(i){var r=i.effect,a=i.rack,c=i.outputNumber;(a=a||s.effectRack).connectNodes(r,n?void 0:o,c),t(s.subSequence.id,void 0)}},[i]);return a.a.createElement("div",{onMouseUp:l,id:u,className:"effect-input"})})},,function(e,t,n){"use strict";var r=n(9),a=n(8),i=n(11),o=n(2),s=n(4),c=n(20),u=n(16),l=n(7),f=n(10),h=n(1),p=n(85),d=n(149),m={rotateForce:function(e){},forceStart:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n[0],i=n[1],o=n[2],s=Object.keys(e.groups[0].forces)[a],c=e.groups[0].forces[s];c[0].set(i),c[1].set(o)},forceDirection:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n[0],i=n[1],o=n[2],s=Object.keys(e.groups[0].forces)[a],c=e.groups[0].forces[s];c[2].set(i),c[3].set(o)}};function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}function b(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var k=n(525),O=n(35),j=n(154),w=n(102),E=n(107),S=n(152),P=n(68),x=n(552);function T(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(E.a)("random",{amount:"The degree of randomness"},"Randomizes the parameter values by ratio passed as an argument (0-1)");var N=function(e){var t=Object(S.b)();return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];n=Object(S.a)(t,n,a);var o={},s=P.a.apply(void 0,[e].concat(a));for(var c in n)if(n[c]){var u=n[c],l=u.x,f=u.y;o[c]={x:Object(x.a)(l,0,O.c,s),y:Object(x.a)(f,0,O.a,s),density:1}}return o}};Object(E.a)("part",{"...list":"List of functions that will each get a partition"},"Partitions the parameters, and executes different functions (the passed args) on each part");var R=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=M(e,t.length),r={},i=0,o=arguments.length,s=new Array(o>1?o-1:0),c=1;c<o;c++)s[c-1]=arguments[c];var u,l=T(n);try{for(l.s();!(u=l.n()).done;){var f=u.value;r=Object(a.a)({},r,t[i].apply(t,[f].concat(s))),i++}}catch(h){l.e(h)}finally{l.f()}return r}},M=function(e,t){for(var n=Object.keys(e),r=Math.floor(n.length/t),a=[],i=function(t){var i=n.slice(t*r,(t+1)*r),o={};i.forEach(function(t){return o[t]=e[t]}),a.push(o)},o=0;o<t;o++)i(o);return a};Object(E.a)("s",{"...list":"List of functions to execute"},"Executes the arguments sequentially, passing the transformed parameter values to each subsequent call");var A=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i,o=T(t);try{for(o.s();!(i=o.n()).done;){e=i.value.apply(void 0,[e].concat(r))}}catch(s){o.e(s)}finally{o.f()}return e}};Object(E.a)("p",{"...list":"List of functions to execute in parallel"},"Executes the arguments in parallel, passing the transformed parameter values to each subsequent call");var q=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n={},r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var s,c=T(t);try{for(c.s();!(s=c.n()).done;){var u=s.value;n=Object(a.a)({},n,u.apply(void 0,[e].concat(i)))}}catch(l){c.e(l)}finally{c.f()}return n}},D=n(526),I=n(112),_=function(e){return{coords:e[0],speed:e[1],width:e[2],stepNumber:e[3],history:e[4],effect:e[6],group:e[7]}};function F(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var B=j.c,z=Math.cos,V=Math.sin,H=void 0,U=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var o=r[0],s=P.a.apply(void 0,[t].concat(r)),c=B().apply(void 0,r),u=c.x,l=c.y,f=c.diameter,h={},p=Math.PI,d=f/2*P.a.apply(void 0,[e].concat(r)),m=Object.keys(o).length,v=Object.keys(o).map(function(e){return Object(a.a)({},o[e],{id:e})}),b=function(e){var t,n,r,a=2*p*(e/m),i={x:u+d*z(a),y:l+d*V(a)},c=v.sort(function(e,t){return U(e,i)-U(t,i)}),f=c[0].id;h[f]=(t=i,n=o[f],{x:(r=s)*t.x+(1-r)*n.x,y:r*t.y+(1-r)*n.y}),v=c.slice(1)},g=1;g<=m;g++)b(g);return h}},G=function(e,t){return function(){var n=arguments.length<=6?void 0:arguments[6];if(!H){var r=document.createElement("canvas");r.width=O.c,r.height=O.a,H=r.getContext("2d")}var i=n.macros.find(function(t){return t.number===e}),o=n.macros.find(function(e){return e.number===t});if(!i||!o)return arguments.length<=0?void 0:arguments[0];var s,c=new Path2D(i.getEasyBlob()),u=(new Path2D(o.getEasyBlob()),o.parameters.map(function(e){return e.id})),l=Object(a.a)({},arguments.length<=0?void 0:arguments[0]),f=F(u);try{for(f.s();!(s=f.n()).done;){var h=s.value,p=l[h];if(p){for(var d=p.x,m=p.y,v=0;H.isPointInPath(c,d,m)&&v++<25;)d=(d+5)%O.c,m=(m+5)%O.a;l[h]=Object(a.a)({},l[h],{x:d,y:m})}}}catch(b){f.e(b)}finally{f.f()}return l}};function W(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var X=function(e,t,n){return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];a[0];for(var o=P.a.apply(void 0,[e].concat(a)),s=P.a.apply(void 0,[t].concat(a)),c=n?P.a.apply(void 0,[n].concat(a)):s+1,u={},l=Object.keys(o),f=s;f<c;f++){var h=f%l.length;u[l[h]]=o[l[h]]}return u}},Q=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var o,s=n.map(function(e){return P.a.apply(void 0,[e].concat(r))}),c=P.a.apply(void 0,[e].concat(r)),u=Object(a.a)({},r[0]),l=W(s);try{var f=function(){var e=o.value,t=s[0];if(t===e)return"continue";var n=Object.keys(e),r=Object.keys(t);n.forEach(function(e,n){u[e]=Object(a.a)({},t[r[n%r.length]]),u[e].x=c*(u[e].x-O.b)+O.b,u[e].y=c*(u[e].y-O.b)+O.b})};for(l.s();!(o=l.n()).done;)f()}catch(h){l.e(h)}finally{l.f()}return u}},Y=function(){return function(){return{}}},Z=n(291),$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=P.a.apply(void 0,[e].concat(n)),i={},o=0;for(var s in n[0]){var c=n[0][s];c&&(i[s]={x:(c.x+o*a)%O.c,y:(c.y+o*a)%O.a},o++)}return i}};function ee(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return te(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(E.a)("navierStokes",{parameters:"",forceEmitters:"",diffusionParam:"",root:""},"Navier stokes simulationn. force=array of force parameters");var ne=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.95,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:64,o=void 0,s=.1*i,c=i/O.c,u=i/O.a,l=i+2,f=(i+2)*(i+2),h=new Float32Array(f),p=new Float32Array(f),d=new Float32Array(f),m=new Float32Array(f),v=new Float32Array(f),b=new Float32Array(f),g=new Float32Array(f),y=-.5/i*1,k=.5*i,j=i+.5,w=new Array(l),E=0;E<l;E++){w[E]=new Array(l);for(var x=0;x<l;x++)w[E][x]=E+x*l}for(E=0;E<f;E++)b[E]=m[E]=v[E]=d[E]=h[E]=p[E]=g[E]=0;var T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p;e.set(g),t.set(g),n.set(g)},C=function(e,t,n,r,a){var i;R(e,n,a),R(t,r,a),i=n,n=e,M(1,e=i,n,a),i=r,r=t,M(2,t=i,r,a),A(e,t,n,r),i=n,n=e,e=i,i=r,r=t,t=i,q(1,e,n,n,r,a),q(2,t,r,n,r,a),A(e,t,n,r)},N=function(e,t,n,r,a){R(e,t,a),M(0,t,e,a),q(0,e,t,n,r,a)},R=function(e,t,n){for(var r=0;r<f;r++)e[r]+=n*t[r]},M=function(e,t,n,r){for(var a=1;a<f;a++)t[a]=n[a]*o;D(e,t)},A=function(e,t,n,r){for(var a,o,s,c,u,l,f,h,p=1;p<=i;p++){a=w[0][p-1],s=w[0][p],c=w[0][p+1],f=s-1,u=i+(h=s+1);for(var d=h;d<u;d++)n[d]=0,r[d]=(e[++h]-e[++f]+t[++c]-t[++a])*y}D(0,r),D(0,n);for(var m=0;m<6;m++){for(var v=1;v<=i;v++)for(l=w[0][v-1],s=w[0][v],c=w[0][v+1],o=n[s],s++,E=1;E<=i;E++)n[s]=o=.25*(r[s]+n[++l]+n[++s]+n[++c]+o);D(0,n)}for(var b=1;b<=i;b++)for(l=w[0][b-1],s=w[0][b],c=w[0][b+1],f=s-1,h=s+1,E=1;E<=i;E++)e[++s]-=k*(n[++h]-n[++f]),t[s]-=k*(n[++c]-n[++l]);D(1,e),D(2,t)},q=function(e,t,n,r,a,o){for(var c=1;c<=i;c++)for(var u=c*l,f=1;f<=i;f++){var h=f-s*r[++u],p=c-s*a[u];h<.5&&(h=.5),h>j&&(h=j);var d=0|h,m=d+1;p<.5&&(p=.5),p>j&&(p=j);var v=0|p,b=v+1,g=h-d,y=1-g,k=p-v,O=1-k,E=w[0][v],S=w[0][b];t[u]=y*(O*n[d+E]+k*n[d+S])+g*(O*n[m+E]+k*n[m+S])}D(e,t)},D=function(e,t){var n;switch(e){case 1:for(n=1;n<=i;n++)t[n]=t[n+l],t[w[n][i+1]]=t[w[n][i]],t[w[0][n]]=-t[w[1][n]],t[w[i+1][n]]=-t[w[i][n]];break;case 2:for(n=1;n<=i;n++)t[n]=-t[n+l],t[w[n][i+1]]=-t[w[n][i]],t[w[0][n]]=t[w[1][n]],t[w[i+1][n]]=t[w[i][n]];break;default:for(n=1;n<=i;n++)t[n]=t[n+l],t[w[n][i+1]]=t[w[n][i]],t[w[0][n]]=t[w[1][n]],t[w[i+1][n]]=t[w[i][n]]}var r=w[0][i+1];t[0]=(t[1]+t[l])/2,t[r]=(t[1+r]+t[w[i][0]])/2,t[i+1]=(t[i]+t[i+1+l])/2,t[i+1+r]=t[i+r]+t[w[i+1][i]]},I=void 0,_=Object(S.b)();return function(){for(var s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];var g=l[0],y=l[1];o=P.a.apply(void 0,[n].concat(l)),g=Object(S.a)(_,g,l.slice(1));var k=l[6];k.smokeResolution=i,k.D=d,k.IX=w;var j=e&&P.a.apply(void 0,[e].concat(l));if(j&&0!==Object.keys(j).length){var x=Object.keys(j).map(function(e){return j[e]}).filter(function(e){return e});if(x[0]){var R=x[0],M=R.x,A=R.y;I||(I=[M,A]),T(b,m,v);var q=I[0]-M,D=I[1]-A,F=0|Math.pow(q*q+D*D,P.a.apply(void 0,[r].concat(l)));for(F=F<1?1:F,E=0;E<F;E++){var L=(I[0]-E/F*q)*c|0,B=(I[1]-E/F*D)*u|0;G=w[L][B],h[G]=-q/6,p[G]=-D/6,d[G]=50}I[0]=M,I[1]=A}}else I=void 0;var z,V=ee(P.a.apply(void 0,[t].concat(l)));try{for(V.s();!(z=V.n()).done;){var H=z.value,U=P.a.apply(void 0,[H[0]].concat(l))*c|0,J=P.a.apply(void 0,[H[1]].concat(l))*u|0,G=w[U][i-J];h[G]=P.a.apply(void 0,[H[2]].concat(l)),p[G]=-1*P.a.apply(void 0,[H[3]].concat(l))}}catch(ae){V.e(ae)}finally{V.f()}C(h,p,m,v,.1),N(d,b,h,p,.1);var W={};for(var K in g){var X=g[K],Q=X.x,Y=X.y;if(!isNaN(Q)&&!isNaN(Y)){var Z=Math.floor(Q*i/(O.c-O.b)),$=Math.floor(Y*i/(O.a-O.b)),te=(G=w[Math.min(Z,i)][Math.min($,i)],h[G]),ne=p[G],re=g[K].density||1;W[K]=Object(a.a)({},X,{x:Q+y/re*10*te,y:Y+y/re*10*ne})}}return W}};function re(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ie=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=n[0],i=n[6],o={},s=function(e){var r,s=!1,c=re(t);try{var u=function(){var t=r.value;return t=P.a.apply(void 0,[t].concat(n)),(t=i.macros.find(function(e){return e.number===t}))?t.parameters.some(function(t){return t.id===e})?(s=!0,"break"):void 0:"continue"};for(c.s();!(r=c.n()).done;){var l=u();if("continue"!==l&&"break"===l)break}}catch(f){c.e(f)}finally{c.f()}s&&(o[e]=a[e])};for(var c in a)s(c);return o}},oe=function(e,t,n){return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return P.a.apply(void 0,[e].concat(a))?P.a.apply(void 0,[t].concat(a)):void 0===n?a[0]:P.a.apply(void 0,[n].concat(a))}},se=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=P.a.apply(void 0,[e].concat(r));P.a.apply(void 0,[t].concat(r));return i<=t}},ce=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=P.a.apply(void 0,[e].concat(r));P.a.apply(void 0,[t].concat(r));return i>=t}},ue=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=P.a.apply(void 0,[e].concat(r));P.a.apply(void 0,[t].concat(r));return i===t}},le=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=P.a.apply(void 0,[e].concat(r));P.a.apply(void 0,[t].concat(r));return i!==t}},fe=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=P.a.apply(void 0,[e].concat(r));P.a.apply(void 0,[t].concat(r));return i&&t}},he=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=P.a.apply(void 0,[e].concat(r));P.a.apply(void 0,[t].concat(r));return i||t}},pe=function(){var e=void 0;return function(){var t=arguments.length<=0?void 0:arguments[0],n=Object.keys(t).map(function(e){return t[e]}).filter(function(e){return e});if(0===n.length)return e||0;var r=Object(j.e)(n),a=r.x,i=r.y;if(e){var o=Math.sqrt(Math.pow(a-e.x,2)+Math.pow(i-e.y,2));return e={x:a,y:i},o}return e={x:a,y:i},0}};Object(E.a)("source",{x:"",y:""},"Transforms parameter to (x,y) coordinate");var de=function(e,t){return function(n){for(var r={},i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];var c=P.a.apply(void 0,[e,n].concat(o)),u=P.a.apply(void 0,[t,n].concat(o));for(var l in n)r[l]=Object(a.a)({},n[l],{x:c,y:u});return r}},me=n(111);Object(E.a)("rewind",{distance:"how many triggers to rewind by"},"Rewinds the parameter values to distance-many triggers ago");var ve=function(e){return function(t,n,r,a,i){var o=i[i.length-e];return o||t}};Object(E.a)("reset",{},"Resets the parameter state to the initial values");var be=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(t,n,r,a,i,o,s){if(i[0]){if(e){var c={};return Object.keys(t).forEach(function(e){return c[e]=i[0][e]}),c}return s&&Object(me.b)("planarReset",s.id),i[0]}return t}},ge=function(e){var t=void 0,n=0;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];var o=_(a),s=o.coords,c=(o.stepNumber,o.history);void 0===t&&(t=c.length-1);var u=t-P.a.apply(void 0,[e].concat(a));if(u<0)return t=void 0,s;var l=c.slice(u,t);return l[++n%l.length]}};function ye(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ke(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(E.a)("snapshot",{snapNumber:""},"Go to snapshot given in argument");var Oe=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=_(n).effect,i=P.a.apply(void 0,[e].concat(n));return a.currentSnapshotParameter.set(i),{}}};Object(E.a)("nextSnapshot",{},"Go to next snapshot-- looping back to first snapshot if at the end.");var je=function(){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=_(t).effect,a=r.currentSnapshotParameter.get()||0;return r.currentSnapshotParameter.set((a+1)%r.snapshots.length),{}}};Object(E.a)("interpolateSnapshot",{snapshotNumber:"",percentage:"how much of the snapshot to use"},"Go to next snapshot-- looping back to first snapshot if at the end.");var we=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=_(r),s=o.coords,c=o.effect,u=P.a.apply(void 0,[e].concat(r)),l=P.a.apply(void 0,[t].concat(r)),f=c.snapshots[u%c.snapshots.length];if(!f)return s;var h,p=xe(f,s).slice(0,Math.floor(f.length*(l/50))),d=Object(a.a)({},s),m=ye(p);try{for(m.s();!(h=m.n()).done;){var v=h.value,b=v.parameter,g=v.coordinates,y=v.min,k=v.max;b.id in s&&(void 0!==y&&void 0!==k&&(b.min=y,b.max=k),d[b.id]=g)}}catch(O){m.e(O)}finally{m.f()}return d}},Ee=function(e){return e*e},Se=Math.sqrt,Pe=function(e,t){return Se(Ee(e.x-t.x)+Ee(e.y-t.y))},xe=function(e,t){return(e=Object(r.a)(e)).filter(function(e){return e.parameter.id in t}).sort(function(e,n){return Pe(n.coordinates,t[n.parameter.id])-Pe(e.coordinates,t[e.parameter.id])})};function Te(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ne=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Object(S.b)();return function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];var s=_(n).effect,c=(_(n).history,_(n).coords);c=Object(S.a)(i,c,n.slice(1));var u={};for(var l in c){var f=Re(l,s);if(f){var h=f.context,p=h.subDevice||h.subDevice||h.device||h.track||h.lfoTrack;if(p){var d=p.id||p.name||p.number;d&&(u[d]||(u[d]={}),u[d][l]=c[l])}}}var m={};for(var v in u)m=Object(a.a)({},m,t[0%t.length].apply(t,[u[v]].concat(Object(r.a)(n.slice(1)))));return m}},Re=function(e,t){var n,r=Te(t.groups);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(e in a.idToParameter)return a.idToParameter[e]}}catch(i){r.e(i)}finally{r.f()}},Me=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=_(n).coords,i=P.a.apply(void 0,[e].concat(n)),o={};for(var s in a)s in i||(o[s]=a[s]);return o}},Ae=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a={};return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var o=_(n).effect,s=_(n).history,c=_(n).coords;s.length<1&&(a={});var u,l=[],f=Te(t);try{for(f.s();!(u=f.n()).done;){var h=u.value;h in a||(a[h]=o._parameters.filter(qe(h))),l=[].concat(Object(r.a)(l),Object(r.a)(a[h]))}}catch(m){f.e(m)}finally{f.f()}var p=new Set(l.map(function(e){return e.id})),d={};return p.forEach(function(e){return d[e]=c[e]}),d}},qe=function(e){return function(t){return e=e.toLowerCase(),De(t).some(function(t){return t.includes(e)})}},De=function(e){var t=[];return e.context&&(e.context.subDevice&&e.context.subDevice.name&&t.push(e.context.subDevice.name.toLowerCase()),e.context.effect&&e.context.effect.name&&t.push(e.context.effect.name.toLowerCase()),e.context.midiEffect&&e.context.midiEffect.name&&t.push(e.context.midiEffect.name.toLowerCase())),e.name&&t.push(e.name.toLowerCase()),t},Ie=n(236);Object(E.a)("send",{type:"",value:""},"Publishes a message of a given type with a value");var _e=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=P.a.apply(void 0,[e].concat(r)),o=P.a.apply(void 0,[t].concat(r));return Object(me.b)(i,o),r[0]}};Object(E.a)("receive",{type:"",function:"","skipEmpty=true":""},"Receives a message and calls a function when it does");var Fe=function(e,t){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var n=Object(Ie.a)(e);return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];var i=n();return t&&i.map(function(e){return"function"===typeof t?P.a.apply(void 0,[t].concat(r)):t})[0]||r[0]}};Object(E.a)("translate",{x:"",y:""},"Translate parameters by (x,y) amount");var Le=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=P.a.apply(void 0,[e].concat(r)),s=P.a.apply(void 0,[t].concat(r)),c=r[0],u={};for(var l in c)if(c[l]){var f=o/(c[l].density||1),h=s/(c[l].density||1);u[l]=Object(a.a)({},c[l],{x:(c[l].x+f)%O.c,y:(c[l].y+h)%O.a})}return u}},Be=n(99),ze=n(209),Ve=n(795),He=Object.keys,Ue=Object.values;Object(E.a)("bounce",{degrees:"The direction that the bounce goes by"},"Moves the parameters by direction of the degrees, and bounces off any walls");var Je=function(e){var t=Object(S.b)(),n=1,i=1,o=Object(Ie.a)("planarReset");return function(s){for(var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,u=arguments.length,l=new Array(u>2?u-2:0),f=2;f<u;f++)l[f-2]=arguments[f];var h=l[4];o().some(function(e){return e===h.id})&&(n=1,i=1);var p=-1*(P.a.apply(void 0,[e,c].concat(l))-90),d=Object(Ve.a)(360-p),m=Math.tan(d),v=-1*i,b=n*m*v;90===p?(b=n,v=0):-90===p?(b=-1*n,v=0):0==p&&(v=-1*i,b=0);var g=Object(I.k)([c].concat(l)),y=!1,k=!1;if(function(e,t,n,a){var i=Math.min.apply(Math,Object(r.a)(e.map(function(e){var r=e.x,i=e.y,o=e.density;return r+t*n*10/a(r,i,{density:o})}))),o=Math.max.apply(Math,Object(r.a)(e.map(function(e){var r=e.x,i=e.y,o=e.density;return r+t*n*10/a(r,i,{density:o})})));return t>0?Math.ceil(o)>=O.c-O.b:Math.floor(i)<=O.b}(Ue(s),b,c,g)&&(n*=-1,b*=-1,y=!0),function(e,t,n,a){var i=Math.min.apply(Math,Object(r.a)(e.map(function(e){var r=e.x,i=e.y,o=Object(Be.a)(e,["x","y"]);return i+t*n*10/a(r,i,o)}))),o=Math.max.apply(Math,Object(r.a)(e.map(function(e){var r=e.x,i=e.y,o=Object(Be.a)(e,["x","y"]);return i+t*n*10/a(r,i,o)})));return t>0?Math.ceil(o)>=O.a-O.b:Math.floor(i)<=O.b}(Ue(s),v,c,g)&&(i*=-1,v*=-1,y||(n*=-1),k=!0),y||k)Object(ze.c)(y);else{var j=Object(S.a)(t,s,[c].concat(l));s=j}return He(s).map(function(e){var t=s[e],n=g(t.x,t.y,t),r=t.x+b*c*10/n,a=t.y+v*c*10/n,i={};return i[e]={x:r,y:a,density:n},i}).reduce(function(e,t){return Object(a.a)({},e,t)},{})}};Object(E.a)("vectorField",{"x-function":"(x,y) => x*y","y-function":"(x,y) => y*y-x*x","boundary-function":""},"Runs the x and y component functions on every parameter, to generate the new position. Ex: vectorField((x,y) => x*y, (x,y) => y*y-x*x, reset())");var Ge=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:be(!0),i=Object(S.b)();return function(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];var u=_(s),l=u.coords,f=(u.history,u.speed);l=Object(S.a)(i,l,s.slice(1));var h=f/80,p=Object(I.k)(s.slice(1)),d={},m={};for(var v in l){var b=l[v],g=b.x,y=b.y,k=p(g,y,l[v]),j=Ke(We([g,y],-O.c/2,-O.a/2),.1),w=$e(e,t,j),E=Qe(w,j),P=We(Ke(E,10),O.c/2,O.a/2),x=Qe([g,y],Ke(Ze(P,[g,y]),h/k));Xe(P=x)?m[v]={x:P[0],y:P[1]}:d[v]={x:P[0],y:P[1],density:k}}return Object.keys(m).length>0&&Object(ze.c)(!0),Object(a.a)({},d,n.apply(void 0,[m].concat(Object(r.a)(s.slice(1)))))}},We=function(e,t,n){return Qe(e,[t,n])},Ke=function(e,t){return Ye(t,e)},Xe=function(e){var t=Object(i.a)(e,2),n=t[0],r=t[1];return n<=O.b||n>=O.c-O.b||r<=O.b||r>=O.a-O.b},Qe=function(e,t){return e.map(function(e,n){return e+t[n]})},Ye=function(e,t){return t.map(function(t){return t*e})},Ze=function(e,t){return e.map(function(e,n){return e-t[n]})},$e=function(e,t,n){var r=Object(i.a)(n,2),a=r[0],o=r[1];return[e(a,o),t(a,o)]};Object(E.a)("alt",{arg1:"",arg2:"",argN:""},"Alternates between the arguments with every trigger received by this function");var et=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=0;return function(){for(var e=r++%t.length,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return P.a.apply(void 0,[t[e]].concat(a))}};Object(E.a)("every",{n:"",fn:"",elseFn:""},"Every n-many triggers do something, otherwise do something else. The else is optional.");var tt=function(e,t,n){var r=0;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];var s=P.a.apply(void 0,[e].concat(i));return 0===++r%s?t.apply(void 0,i):n?n.apply(void 0,i):i[0]}};Object(E.a)("altn",{n:"How many triggers it takes to increment the output conditional",arg1:"Output conditional",arg2:"Output conditional",argN:"Output conditional (will loop back to arg1 after this this)"},"Alternates between the arguments every n-many triggers received by this function");var nt=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=0,i=0;return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];var s=P.a.apply(void 0,[e].concat(r));++a%s===0&&i++;var c=n[i%n.length];return P.a.apply(void 0,[c].concat(r))}},rt=Math.sin,at=function(){var e=Object(S.b)();return function(){console.log("fluid called");for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];console.log(n),n[0]=Object(S.a)(e,n[0],n.slice(1));var a=_(n).group,i=A(q(A(X(0,1),Ge(function(e,t){return e*t-rt(e)},function(e,t){return t/e},be(!0))),ne(nt(8,X(0),function(){return{}},X(1,2),X(25,26),function(){return{}}),[a.force(1),a.force(2),a.force(3)],.92,.6)),tt(8,oe(se(A(X(0,1),Object(j.d)()),10),A(X(0,1),$(10))))).apply(void 0,n);return console.log("ret =",i),i}},it=function(e){return A(q(A(X(function(e){return e},0),Ge(function(e,t){return e*t-rt(e)},function(e,t){return t/e},be(!0))),ne(nt(8,X(function(e){return e},0),function(){return{}},X(function(e){return e},1),X(function(e){return e},25),function(){return{}}),[e.force(1),e.force(2),e.force(3)],e.knob("diffyx",.92,.9,1),e.knob("rootxy",.6,.01,.8))),tt(8,oe(se(A(X(0,1),Object(j.d)()),10),A(X(0,1),$(10)))))},ot=n(23),st=n(6);function ct(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var ut=n(21),lt=n(57),ft=n(45),ht=function(e){return function(t){for(var n={},r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var s=P.a.apply(void 0,[e].concat(i));for(var c in t)n[c]=Object(a.a)({},t[c],{density:s*(t[c].density||1)});return n}},pt=function(){return function(e){return{}}};Object(E.a)("beat",{step:"The step within the beat at which this executes the ifCond condition",beat:"The total number of steps within which we determine if the step has occured",ifCond:"The condition that is executed when the step is reached",elseCond:"The condition that is executed otherwise"},"Conditions on a certain step within a beat. For example, beat(0,32,a,b) executes a on the 1st beat of every bar, and executes b on every other step");var dt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return function(a,i,o,s,c,u){return s%t===e?Object(P.a)(n,a,i,o,s,c,u):r?Object(P.a)(r,a,i,o,s,c,u):a}};function mt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var vt=n(521),bt=n(193),gt=n(520);function yt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ot(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var jt=function(e){Object(l.a)(n,e);var t=Ot(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I.e,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0;return Object(o.a)(this,n),(e=t.call(this,"Plane Group",s)).initialBulkValues={},e.effect=u,e.id=Object(ft.uuid)(),e._parameters=r,e.track=s,e.context=i||(new lt.a).forTrack(s),e.parameterIds=[],e.counter=0,e.parameters=[],e.algorithmParameter=new ut.a("width",Object(c.a)(e),function(t,n){n===I.d&&(e.navier||(e.navier=it(Object(c.a)(e))))},{defaultValue:a,min:0,max:1}),e.widthParameter=new ut.a("width",Object(c.a)(e),function(){return[]},{defaultValue:12,min:4,max:30}),e.speedParameter=new ut.a("speed",Object(c.a)(e),function(){return[]},{defaultValue:1,min:.1,max:8}),e.registerParameter(e.algorithmParameter),e.registerParameter(e.widthParameter),e.registerParameter(e.speedParameter),e.bounce=Je(45),e.life=Object(I.m)(),e.swap=Object(I.o)(),e.rotate=Object(I.n)(3),e.history=[],e.updateIdToParameter(),e.track.sequencerEngine.dispatch(Object(st.Vb)(e.initialBulkValues)),e}return Object(s.a)(n,[{key:"registerParameter",value:function(e){this.context&&e.setContext(this.context),this.initialBulkValues=Object(a.a)({},this.initialBulkValues,e.setStore(this.track.store)),this.parameters.push(e)}},{key:"ungroupParameter",value:function(e){var t=this._parameters.indexOf(e);this._parameters.splice(t,1);e.hasGroup;e.hasGroup=void 0;var n,r=yt(this.variations);try{for(r.s();!(n=r.n()).done;){var a=n.value;Object.keys(a).includes(e.id)&&delete a[e.id]}}catch(i){r.e(i)}finally{r.f()}}},{key:"updateIdToParameter",value:function(){var e=this;this.idToParameter={},this._parameters.forEach(function(t){return e.idToParameter[t.id]=t})}},{key:"width",get:function(){return this.widthParameter.get()},set:function(e){this.widthParameter.set(e)}},{key:"speed",get:function(){return this.speedParameter.get()},set:function(e){this.speedParameter.set(e)}},{key:"algorithm",get:function(){return this.algorithmParameter.get()},set:function(e){this.algorithmParameter.set(e)}},{key:"getAllParameterCoords",value:function(){var e=this,t={};return Object(D.a)(this._parameters).forEach(function(n,r){return t[e._parameters[r].id]=n}),t}},{key:"onTrigger",value:function(e,t,n,r){var a=this.sequenceStep(e,t,n);if(a)return a;this.counter++;var i=this._parameters,o={};i.forEach(function(e){o[e.id]=e.getCoordinates()}),this.history.length<5&&this.history.push(o);var s=[this.speed,this.width,e,this.history,r,this.effect,this],c={};if(0===i.length)return{};if(this.algorithm===I.d)c=this.navier.apply(this,[o].concat(s));else if(this.algorithm===I.c)c=this.life.apply(this,[o].concat(s));else if(this.algorithm===I.i)c=this.swap.apply(this,[o].concat(s));else if(this.algorithm===I.a){var u=this.bounce.apply(this,[o].concat(s));c=this.life(u,this.speed/8,this.width,e,this.history,r,this.effect)}else if(this.algorithm===I.b){var l=this.bounce(o,this.speed,this.width,e,this.history,r,this.effect);c=this.swap.apply(this,[l].concat(s))}else if(this.algorithm===I.f)c=this.rotate.apply(this,[o].concat(s));else if(this.algorithm===I.h){var f=this.life.apply(this,[o].concat(s));c=this.rotate.apply(this,[f].concat(s))}else this.algorithm===I.g&&this.script&&(c=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return e.apply(void 0,[t].concat(r))}.apply(void 0,[this.script,o].concat(s)));if(0===Object.keys(c).length)return{};var h={};for(var p in c)try{var d=c[p].density||1,m=this.idToParameter[p];if(m){var v=m.setCoordinates(c[p].x,c[p].y,t,d*n/1e3,!0),b=v.id,g=v.value;h[b]=g}}catch(y){console.log("ERROR = ",y)}return h}},{key:"fromJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.code&&(this.code=e.code),this.restartScript(),e.id&&(this.id=e.id),this.algorithm=e.algorithm,Object(ot.a)(e,"algorithmParameter",this.algorithmParameter),Object(u.a)(Object(h.a)(n.prototype),"fromJson",this).call(this,e,t),e.id&&(this.id=e.id),this.algorithm=e.algorithm,Object(ot.a)(e,"algorithmParameter",this.algorithmParameter),this.speed=e.speed,this.width=e.width,this.parameterIds=e.parameters,e.stepToState&&(this.stepToState=e.stepToState),e.variations&&(this.variations=e.variations,this.generation=e.generation)}},{key:"loadParameters",value:function(e,t){var n,r=this.parameterIds.map(function(e){return t[e]?t[e].id:e}),a=yt(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;r.includes(i.id)&&!this._parameters.includes(i)&&(this._parameters.push(i),i.hasGroup=this)}}catch(o){a.e(o)}finally{a.f()}}},{key:"getJson",value:function(){var e=Object(a.a)({},Object(u.a)(Object(h.a)(n.prototype),"getJson",this).call(this),{id:this.id,parameters:this._parameters.map(function(e){return e.id}),algorithm:this.algorithm,width:this.width,code:this.code,speed:this.speed,stepToState:this.stepToState,generation:this.generation});return e=Object(ot.b)(e,"algorithmParameter",this.algorithmParameter)}},{key:"updateParameter",value:function(e){if(void 0!==this.selectedVariation){var t=this.variations[this.selectedVariation];t&&(t[e.id]=e.getCoordinates())}var n=e.getCoordinates();if(void 0!==this.stepSelected){var r=this.stepToState[this.stepSelected]||{};r[e.id]=n,this.stepToState[this.stepSelected]=Object(a.a)({},r)}this.history&&this.history[0]&&(this.history[0][e.id]=n)}},{key:"stop",value:function(){this.restartScript(),this.updateIdToParameter(),this.history=[]}},{key:"replaceParameter",value:function(e){for(var t in this._parameters)if(this._parameters[t].id===e.id)return this._parameters[t]=e,this.updateIdToParameter(),void(e.hasGroup=this)}}]),n}(Object(bt.a)(function(e){return function(e){Object(l.a)(n,e);var t=mt(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).code="",e.script=void 0,e.forces={},e}return Object(s.a)(n,[{key:"eval",value:function(e){var t=this.clearVariables();for(var n in this.code=e,this.script=this.evalWithContext(e),t)this[n+"Parameter"]&&this[n+"Parameter"].copyFrom(t[n],this.track.sequencerEngine);this.updateVariablesRedux()}},{key:"hasSyntaxError",value:function(e){return void 0===this.evalWithContext(e)}},{key:"restartScript",value:function(){""!==this.code&&this.eval(this.code)}},{key:"evalWithContext",value:function(e){var t=this;try{var n=e.split(";"),r=n[n.length-1],i=n.slice(0,n.length-1).join(";"),o=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return t.newVar(e,n,r,a,void 0,i),function(){return t[e+"Parameter"].get()}};return new Function("with(this) { "+i+"; return s("+r+")}").call({rotate:I.n,translate:Le,s:A,random:N,fluid:at,circle:J,every:tt,none:Y,altn:nt,loop:ge,snapshot:Oe,byDevice:Ne,spread:$,life:I.m,send:_e,rewind:ve,lazy:P.a,proportion:Q,slice:X,preventIntersect:G,gte:ce,lte:se,eq:ue,neq:le,diameter:j.d,geometry:j.c,diff:pe,and:fe,or:he,reset:be,alt:et,slow:ht,clear:pt,navierStokes:ne,swap:I.o,beat:dt,bounce:Je,vectorField:Ge,expand:I.l,search:Ae,p:q,part:R,interpolateSnapshot:we,nextSnapshot:je,load:function(e){return t.loadScript(e)},receive:Fe,sin:Math.sin,cos:Math.cos,tan:Math.tan,source:de,cond:oe,mac:ie,not:Me,WIDTH:O.c,HEIGHT:O.a,knob:o,force:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.variables.length,n=[o("force.x ".concat(e),10*e,0,O.c,!0),o("force.y (".concat(e,")"),10*e,0,O.a,!0),o("force.dx (".concat(e,")"),100,-O.c,O.c,!0),o("force.dy (".concat(e,")"),100,-O.a,O.a,!0)];return t.forces=Object(a.a)({},t.forces),t.forces[e]=t.variables.slice(t.variables.length-4),n},diffusion:function(){return o("diffusion",.75,.7,1.2)}})}catch(s){return void console.log("error = ",s)}}},{key:"knob",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this.newVar(e,t,r,a,void 0,i),function(){return n[e+"Parameter"].get()}}},{key:"force",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.variables.length,n=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return e.newVar(t,n,r,a,void 0,i),function(){return e[t+"Parameter"].get()}},r=[n("force.x ".concat(t),10*t,0,O.c,!0),n("force.y (".concat(t,")"),10*t,0,O.a,!0),n("force.dx (".concat(t,")"),100,-O.c,O.c,!0),n("force.dy (".concat(t,")"),100,-O.a,O.a,!0)];return this.forces=Object(a.a)({},this.forces),this.forces[t]=this.variables.slice(this.variables.length-4),r}},{key:"loadScript",value:function(e){var t=Object(Z.b)(e),n=this.evalWithContext(t,!1);return function(){return n}}}]),n}(e)},vt.a,k.a,function(e){return function(e){Object(l.a)(n,e);var t=ct(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).stepToState={},e.sequencerEnabled=!0,e.stepSelected=void 0,e}return Object(s.a)(n,[{key:"deleteStateAtStep",value:function(e){delete this.stepToState[e],this.effect.resetValues()}},{key:"selectStep",value:function(e){var t=this.applySequencedState(this.stepToState[e],void 0,.001);this.stepSelected=e,t&&this.track.sequencerEngine.dispatch(Object(st.Vb)(t))}},{key:"unselectStep",value:function(){this.stepSelected=void 0}},{key:"recordStateAtStep",value:function(e){var t={};this._parameters.forEach(function(e){return t[e.id]=e.getCoordinates()}),this.stepToState[e]=t,this.stepSelected=void 0}},{key:"sequenceStep",value:function(e,t,n){if(!this.sequencerEnabled)return!1;e=Math.floor(e/2);var r=this.stepToState[e];return this.applySequencedState(r,t,n)}},{key:"applySequencedState",value:function(e,t,n){var r=this;if(e){var a={},i=function(i){var o=r._parameters.find(function(e){return e.id===i});if(!o)return"continue";var s=o.setCoordinates(e[i].x,e[i].y,t,n/1e3,!0),c=(s.id,s.value);a[i]=c};for(var o in e)i(o);return a}}}]),n}(e)})(gt.a)),wt=n(15),Et=n.n(wt),St=n(644);function Pt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}Math.abs,Math.pow,Math.sqrt;function xt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ct(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var Nt=Math.sqrt,Rt=function(e){return Math.pow(e,2)},Mt=function(e,t,n,r){return Nt(Rt(n-e)+Rt(r-t))},At=(n(379),n(312)),qt=n(276),Dt=n(5),It=n.n(Dt),_t=n(14),Ft=n(50),Lt=(n(92),n(47));function Bt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var Ht=n(1352),Ut=n(796),Jt=n(721);window.tanDiff=20;var Gt=function(e,t,n){var r=Kt((Wt(n/e)-1)/(1-Wt(t/e))+Wt(t)),a=t+r,i=t-r;return{x1:2*e-a*e/t,y1:a,x2:2*e-i*e/t,y2:i}},Wt=function(e){return Math.pow(e,2)},Kt=Math.sqrt,Xt=n(239),Qt=n(775),Yt=n(41);function Zt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return $t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $t(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function $t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function en(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var tn=function(e){Object(l.a)(n,e);var t=en(n);function n(e,r,a,i){var s;return Object(o.a)(this,n),(s=t.call(this)).id=Object(ft.uuid)(),s.name=e,s.number=a,s.parameters=r,s.effect=i,s.signal=new Et.a.Signal(0),s.signalParameter=new Yt.a("macro",s.signal,function(){},{min:0,defaultValue:0,max:1,useInstrumentModulators:!0}),s.signalParameter.setContext((new lt.a).forTrack(s.effect.track)),s.subMacros={},s.initColor(),s}return Object(s.a)(n,[{key:"dispose",value:function(){var e=this;this.lastHull=void 0,this.lastCentroid=void 0;var t=this.effect.track.sequencerEngine.lfos.map(function(e){return e.lfo}),n=function(n){var r=t.find(function(e){return e.number===parseInt(n)});e.disconnectFromLFO(r)};for(var r in this.subMacros)n(r);this.parameters.forEach(function(e){return e.planeMacro=void 0}),this.signalParameter.dispose(),this.signal.dispose(),this.signalParameter=void 0,this.subMacros=void 0,this._disposed=!0}},{key:"disposeSubMacro",value:function(e){var t=e.parameter;this.signal.disconnect(e.scaler),e.dispose(),t.set(t.get(!0),!0,!0)}},{key:"disconnectFromLFO",value:function(e){var t=this,n=this.subMacros[e.number];n.forEach(function(e){t.disposeSubMacro(e)}),delete n[e.number],this.signalParameter.disconnectFromLFO(e)}},{key:"connectToLFO",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this.parameters.filter(function(n){return!t.subMacros[e.number]||!t.subMacros[e.number].some(function(e){return e.parameter===n})}).filter(function(t){return t.context&&(!t.context.lfoTrack||t.context.lfoTrack.lfo!==e)}).filter(function(e){return"LFO Max"!==e.name&&"LFO Phase"!==e.name}).filter(function(e){return e.audioParam||e.audioParams}),i=(this.subMacros[e.number],this.subMacros[e.number]||[]);this.subMacros[e.number]=[].concat(Object(r.a)(i),Object(r.a)(a.map(function(e){var n=new Qt.a(e,e.min,e.max);return n.withSignal(t.signal),e.set(e.get(!0),!0,!0),n}))),n&&!this.lfos.includes(e)&&this.signalParameter.connectToLFO(e)}},{key:"fromJson",value:function(e,t){this.name=e.name,this.id=e.id,this.number=e.number,this.parameterIds=e.parameters,this.signalParameterJson=e.signalParameter,this.isCopy=t,e.color?this.color=e.color:this.initColor()}},{key:"loadParameters",value:function(e,t){var n,r=this.parameterIds.map(function(e){return t[e]?t[e].id:e}),a=Zt(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;r.includes(i.id)&&!this.parameters.includes(i)&&(this.parameters.push(i),i.planeMacro=this)}}catch(u){a.e(u)}finally{a.f()}if(this.signalParameterJson){this._loadedSignalParameter||(this.signalParameter.fromJson(this.signalParameterJson,this.effect.track.sequencerEngine,this.isCopy),this._loadedSignalParameter=!0);var o,s=Zt(this.signalParameter.lfos);try{for(s.s();!(o=s.n()).done;){var c=o.value;this.connectToLFO(c,!1)}}catch(u){s.e(u)}finally{s.f()}}}},{key:"lfos",get:function(){return this.signalParameter.lfos}},{key:"free",value:function(){var e=this;this.parameters.forEach(function(t){return e.removeParameter(t)})}},{key:"getJson",value:function(){return{name:this.name,color:this.color,id:this.id,number:this.number,parameters:this.parameters.map(function(e){return e.id}),signalParameter:this.signalParameter.getJson()}}},{key:"removeParameter",value:function(e){var t=this;if(this.lastHull=void 0,this.lastCentroid=void 0,!this._disposed){this.parameters=this.parameters.filter(function(t){return t!==e}),e.planeMacro=void 0;var n=Object.values(this.subMacros).flat().filter(function(t){return t&&t.parameter===e});for(var r in n.forEach(function(e){return t.disposeSubMacro(e)}),this.subMacros)this.subMacros[r]=this.subMacros[r].filter(function(e){return!n.includes(e)})}}},{key:"isPlaneMacro",get:function(){return!0}},{key:"isEmpty",value:function(){return 0===this.parameters.length}},{key:"getCoordinates",value:function(){return this.coordinates}},{key:"coordinates",get:function(){if(0===this.parameters.length)return 0;var e=this.parameters.map(function(e){return e.getCoordinates()});return this._coordinates=Object(j.a)(e),this._coordinates}},{key:"diameter",get:function(){return Object(j.b)(this.parameters.map(function(e){return e.getCoordinates()}))}},{key:"getAllCoordinates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(D.a)(this.parameters,e)}},{key:"getGeometry",value:function(){if(0===this.parameters.length)return{x:0,y:0,diameter:0};var e=this.getAllCoordinates();return e?Object(a.a)({},Object(j.e)(e),{coordinates:e}):{x:0,y:0,coordinates:void 0}}},{key:"setCoordinates",value:function(e,t){var n=this._coordinates,r=e-n.x,a=t-n.y;this.moveCoordinates(r,a)}},{key:"moveCoordinates",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.parameters.map(function(e){return e.moveCoordinates.apply(e,t)});this.effect.setEffectParameterValues(r.reduce(function(e,t,n){var r=t.id,a=t.value;return Object(Ht.a)(n),e[r]=a,e}))}},{key:"getBlob",value:function(e,t,n,r){var a=this.getAllCoordinates(),i=Object(Xt.b)(a,{x:e,y:t},8);return r&&i.push(i[0]),this.lastHull=i,Object(Jt.a)(i,window.spline||1.1,void 0,r)}},{key:"getEasyBlob",value:function(){var e,t=this.getGeometry(),n=t.x,r=t.y,a=t.diameter,i=t.coordinates;return this.lastHull&&nn(n,r,this.lastCentroid.x,this.lastCentroid.y)<5?e=this.lastHull.map(function(e){return i[e]}):i&&(e=Object(Xt.b)(i,{x:n,y:r},8),this.lastHull=e.map(function(e){var t=e.x,n=e.y,r=i.find(function(e){return e.x===t&&e.y===n});return i.indexOf(r)}),this.lastCentroid={x:n,y:r}),{x:n,y:r,diameter:a,coordinates:i,hull:e,d:e&&Object(Jt.a)(e,this.effect.splineTension)}}},{key:"getConvexHull",value:function(e,t,n){var r=this.getAllCoordinates();return Object(Xt.b)(r,Object(j.a)(r),n)}},{key:"getTans",value:function(e,t){var n,r=[],a=Zt(this.parameters);try{for(a.s();!(n=a.n()).done;){var i=n.value.getCoordinates();r.push(i)}}catch(s){a.e(s)}finally{a.f()}var o=Object(Xt.b)(r);return o[0]?function(e,t,n){for(var r=[],a=0;a<e.length;a++){var i=e[a],o=e[(a+1)%e.length],s=i.x-t,c=i.y-n,u=o.x-t,l=o.y-n,f=Gt(s,c,window.tanDiff);f={x:f.x1+t,y:f.y1+n};var h=Gt(u,l,window.tanDiff);h={x:h.x1+t,y:h.y1+n},0===a?r.push([f,h,o]):r.push([i,h,o])}return r}(o,e,t):""}}]),n}(Object(Ut.a)(function(){return function e(){Object(o.a)(this,e)}}())),nn=function(e,t,n,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))};function rn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}function an(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return on(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return on(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function on(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var cn=function(e){Object(l.a)(n,e);var t=sn(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Plane Parameters",e)).track.sequencerEngine&&(r.track.sequencerEngine.idToObject[r.id]=Object(c.a)(r)),r.newInlet("operation",function(e){return r.onOperation(e)}),r.newInlet("speed",function(e){return r.onSpeed(e)}),r.setupRampParameters(),r.setupPlanarParameters(),r.setupSnapshots(),r.setupDrawable(),r.setupPlayable(),r.groups=[],r.counter=-1,r.effect=Object(c.a)(r),r.smokeResolution=64,r.dispatch(Object(st.fe)(r.track.id,Object(c.a)(r))),r.newOutlet("macros"),r.newOutlet("smoke"),r}return Object(s.a)(n,[{key:"onSpeed",value:function(e){var t=Object(i.a)(e,1)[0];this.groups.filter(function(e){return e.speedParameter.set(t)})}},{key:"setupPlanarParameters",value:function(){this.maxParametersParameter=new ut.a("maxParameters",this,function(e,t){return[]},{defaultValue:24,min:16,max:64}),this.registerParameter(this.maxParametersParameter),this.blurParameter=new ut.a("blur",this,function(e,t){return[]},{defaultValue:0,min:0,max:40}),this.registerParameter(this.blurParameter),this.splineTensionParameter=new ut.a("splineTension",this,function(e,t){return[]},{defaultValue:1.8,min:.5,max:400}),this.registerParameter(this.splineTensionParameter),this.updateRateParameter=new ut.a("updateRate",this,function(e,t){return[]},{defaultValue:0,min:0,max:40}),this.registerParameter(this.updateRateParameter),this.setupNodeMessaging()}},{key:"splineTension",get:function(){return this.splineTensionParameter.get()}},{key:"maxParametersPerIter",get:function(){return this.maxParametersParameter.get()}},{key:"updateRate",get:function(){return this.updateRateParameter.get()}},{key:"randomlyMapParameters",value:function(e,t,r){var a,i=an(r=Object(u.a)(Object(h.a)(n.prototype),"randomlyMapParameters",this).call(this,e,t,r));try{for(i.s();!(a=i.n()).done;)a.value}catch(o){i.e(o)}finally{i.f()}}},{key:"getForces",value:function(){var e=this.groups.flatMap(function(e){return e.variables.filter(function(e){return e.name.startsWith("force.x")})}),t=this.groups.flatMap(function(e){return e.variables.filter(function(e){return e.name.startsWith("force.y")})}),n=this.groups.flatMap(function(e){return e.variables.filter(function(e){return e.name.startsWith("force.dx")})}),r=this.groups.flatMap(function(e){return e.variables.filter(function(e){return e.name.startsWith("force.dy")})}),a=[];for(var i in e)a.push([e[i],t[i],n[i],r[i]]);return a}},{key:"checkForces",value:function(){var e,t=an(this.getForces());try{for(t.s();!(e=t.n()).done;){var n=e.value,r=Object(i.a)(n,4),a=r[0],o=r[1],s=r[2],c=r[3];(a.get()>=O.c||a.get()+.25*s.get()>=O.c)&&(a.set(15),s.set(15)),(o.get()>=O.a||o.get()+.25*c.get()>=O.a)&&(o.set(15),c.set(15))}}catch(u){t.e(u)}finally{t.f()}}},{key:"stop",value:function(){this.checkForces(),Object(u.a)(Object(h.a)(n.prototype),"stop",this).call(this),this.counter=-1,this.stopDrawing(),this.groups.forEach(function(e){return e.stop()})}},{key:"clear",value:function(){Object(u.a)(Object(h.a)(n.prototype),"clear",this).call(this),this.counter=-1}},{key:"output",value:function(e,t,n){if(this.currentSnapshotParameter.refresh(!1),!this.track.sequencerEngine.playing)return this.triggers;var r=this.groups.length>0?this.groups.map(function(e){return e._parameters.length}).reduce(function(e,t){return e+t}):1,i=Math.min(1,this.maxParametersPerIter/r);if(this.applyPencilAutomations(t),this.currentPath){var o=this.applyPath(i,t);return this.track.sequencerEngine.parametersToUpdate=Object(a.a)({},this.track.sequencerEngine.parametersToUpdate,o),this.triggers}var s=t%this.updateRate===0;if(0===this.triggers.length&&!s)return this.triggers;if(!this.playing)return this.triggers;var c,u={},l=an(this.groups);try{for(l.s();!(c=l.n()).done;){var f=c.value;u=Object(a.a)({},u,f.onTrigger(n,e,this.rampTime,i))}}catch(h){l.e(h)}finally{l.f()}return this.track.sequencerEngine.parametersToUpdate=Object(a.a)({},this.track.sequencerEngine.parametersToUpdate,u),this.sendMacroMessages(),this.sendMessage("smoke",this.D),this.triggers}},{key:"getParameters",value:function(){var e,t=Object(u.a)(Object(h.a)(n.prototype),"getParameters",this).call(this),a=an(this.groups);try{for(a.s();!(e=a.n()).done;){var i=e.value;t=[].concat(Object(r.a)(t),Object(r.a)(i.parameters))}}catch(o){a.e(o)}finally{a.f()}return t}},{key:"getParameterValueToSet",value:function(e){}},{key:"groupParameters",value:function(e){var t=new jt(e,void 0,this.context,this.track,this);this.groups=[].concat(Object(r.a)(this.groups),[t]),e.forEach(function(e){return e.hasGroup=t})}},{key:"ungroup",value:function(e){var t=this.groups.indexOf(e);e._parameters.forEach(function(e){return e.hasGroup=void 0}),this.groups.splice(t,1)}},{key:"ungroupParameters",value:function(e){var t=e.map(function(e){return e.hasGroup});e.filter(function(e){return e.hasGroup}).forEach(function(e){return e.hasGroup.ungroupParameter(e)});var n,r=an(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;a&&0===a._parameters.length&&this.ungroup(a)}}catch(i){r.e(i)}finally{r.f()}}},{key:"getGroupForParameter",value:function(e){return this.groups.find(function(t){return t._parameters.includes(e)})}},{key:"mergeIntoGroup",value:function(e,t){this.ungroupParameters(t),t.forEach(function(t){e._parameters.push(t),t.hasGroup=e});var n=this.groups.filter(function(e){return 0===e._parameters.length});this.groups=this.groups.filter(function(e){return!n.includes(e)}),this.groups.push(e)}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"gradientColor",get:function(){return this.track.sequencerEngine.state.plane.gradientColors[this.id]},set:function(e){this.track.sequencerEngine.dispatch(Object(st.ge)(this.id,e))}},{key:"getJson",value:function(e){return Object(a.a)({},Object(u.a)(Object(h.a)(n.prototype),"getJson",this).call(this,e),{gradientColor:this.gradientColor,densities:this.getDensityJson(),splineTension:this.splineTension,width:O.c,height:O.a,hideUI:this.hideUI,scriptExpanded:this.scriptExpanded&&this.scriptExpanded.id,macros:this.getMacrosJson(),snapshots:this.snapshots.map(function(e){return e.map(function(e){var t=e.parameter,n=e.coordinates;return{parameter:t.id,coordinates:n}})}),snapshotComponent:this.snapshotComponent,groups:this.groups.map(function(e){return e.getJson()})})}},{key:"getMappableJson",value:function(e){return{parameters:this._parameters.map(function(t){return{id:t.id,context:e?t.context&&t.context.getJson():void 0,name:e?t.name:void 0,coordinates:t.getCoordinates()}}),depthParameters:[]}}},{key:"unmapParameter",value:function(e){var t=Object(u.a)(Object(h.a)(n.prototype),"unmapParameter",this).call(this,e);if(t&&t.hasGroup&&t.hasGroup.ungroupParameter(t),t&&t.planeMacro){var r=t.planeMacro;r.removeParameter(t),r.isEmpty()&&this.deleteMacro(r)}}},{key:"fromJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t||(this.id=e.id,this.track.sequencerEngine&&(this.track.sequencerEngine.idToObject[this.id]=this)),this.jsonSnapshots=e.snapshots,e.gradientColor&&(this.gradientColor=e.gradientColor),e.splineTension&&this.splineTensionParameter.set(e.splineTension),this.hideUI=e.hideUI,e.width&&Object(O.d)(e.width,e.height),e.snapshotComponent&&(this.snapshotComponent=e.snapshotComponent),e.groups){var r,a=an(e.groups);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=new jt(void 0,void 0,this.context,this.track,this);o.fromJson(i),this.groups.push(o)}}catch(s){a.e(s)}finally{a.f()}}return this.fromMacrosJson(e.macros),e.scriptExpanded&&(this.scriptExpanded=this.groups.find(function(t){return t.id===e.scriptExpanded})),e.densities&&this.fromDensityJson(e.densities),Object(u.a)(Object(h.a)(n.prototype),"fromJson",this).call(this,e,t)}},{key:"loadParameters",value:function(e,t){var r=this,a=Object(u.a)(Object(h.a)(n.prototype),"loadParameters",this).call(this,e,t),i=a.lostParameters,o=a.newMappings;if(this.groups.forEach(function(e){return e.loadParameters(r._parameters,o)}),this.macros.forEach(function(e){return e.loadParameters(r._parameters,o)}),this.snapshots=[],this.jsonSnapshots){var s,c=an(this.jsonSnapshots);try{for(c.s();!(s=c.n()).done;){var l,f=s.value,p=[],d=an(f);try{var m=function(){var e=l.value,t=e.parameter,n=e.coordinates,a=r._parameters.find(function(e){return e.id===t});a&&p.push({parameter:a,coordinates:n})};for(d.s();!(l=d.n()).done;)m()}catch(v){d.e(v)}finally{d.f()}this.snapshots.push(p)}}catch(v){c.e(v)}finally{c.f()}}return this.clear(),this.stop(),{lostParameters:i,newMappings:o}}},{key:"clearParameter",value:function(e,t,r){if(Object(u.a)(Object(h.a)(n.prototype),"clearParameter",this).call(this,e,t),this.macros.forEach(function(e){e.lastHull=void 0,e.lastCentroid=void 0}),r||this.groups.forEach(function(t){return t.updateParameter(e)}),void 0!==this.selectedVariation&&!r){var a=this.variations[this.selectedVariation],i=e.id;a&&(a[i]=e.getCoordinates())}this.setting||this.currentSnapshotParameter.set(null,!0)}},{key:"replaceParameter",value:function(e){Object(u.a)(Object(h.a)(n.prototype),"replaceParameter",this).call(this,e),this.groups.forEach(function(t){return t.replaceParameter(e)})}},{key:"dispose",value:function(){this.macros.forEach(function(e){return e.dispose()}),this.dispatch(Object(st.fe)(this.track.id,void 0)),Object(u.a)(Object(h.a)(n.prototype),"dispose",this).call(this)}},{key:"onParameterUnmapped",value:function(e){this.macros.filter(function(t){return t.parameters.includes(e)}).forEach(function(t){return t.removeParameter(e)})}},{key:"sortParameters",value:function(){}},{key:"shouldOutputSkip",value:function(e,t){return 0===this.triggers.length}}]),n}(Object(bt.a)(w.a,function(e){return function(e){Object(l.a)(n,e);var t=Ct(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).regions=[],e.densityCache={},e}return Object(s.a)(n,[{key:"newRegion",value:function(e,t){var n={x:e,y:t,radius:arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,viscosity:10};return this.regions=[].concat(Object(r.a)(this.regions),[n]),n}},{key:"deleteDensity",value:function(e){var t=this.regions.indexOf(e);t>-1&&(this.regions.splice(t,1),this.regions=Object(r.a)(this.regions))}},{key:"getViscosity",value:function(e,t){var n=0,r=e+","+t;if(this.densityCache[r])return this.densityCache[r];var a,i=xt(this.regions);try{for(i.s();!(a=i.n()).done;){var o=a.value;Mt(e,t,o.x,o.y)<=o.radius&&(n+=o.viscosity)}}catch(c){i.e(c)}finally{i.f()}var s=0===n?1:n;return this.densityCache[r]=s,s}},{key:"expandRegion",value:function(e,t){this.cache={};var n=this.regions.indexOf(e);this.regions[n]=Object(a.a)({},e,{radius:e.radius*t}),this.regions=Object(r.a)(this.regions)}},{key:"expandViscosity",value:function(e,t){this.cache={};var n=this.regions.indexOf(e);this.regions[n]=Object(a.a)({},e,{viscosity:e.viscosity*t}),this.regions=Object(r.a)(this.regions)}},{key:"expandDensitySize",value:function(e,t){return this.cache={},e.radius=e.radius*t,this.regions=Object(r.a)(this.regions),e}},{key:"getDensityJson",value:function(){return this.regions}},{key:"fromDensityJson",value:function(e){this.regions=e}}]),n}(e)},function(e){return function(e){Object(l.a)(n,e);var t=v(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"onOperation",value:function(e){var t=Object(d.a)(e),n=t[0],a=(t.slice(1),n.split(" ").filter(function(e){return""!=e&&" "!==e})),i=a[0],o=a.slice(1).map(function(e){return parseFloat(e)}),s=m[i];s&&s.apply(void 0,[this].concat(Object(r.a)(o)))}}]),n}(e)},qt.a,function(e){return function(e){Object(l.a)(n,e);var t=y(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getModulatedParameters",value:function(){var e,t=[],n=b(this._parameters);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.lfos.length+r.envelopes.length>0&&t.push(r)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getStats",value:function(){var e,t=0,n=b(this._parameters);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=r.lfos.length+r.envelopes.length}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"simplifyPatch",value:function(e){for(var t=this.getModulatedParameters(),n=Math.floor(t.length*e/100),r=0;r<n;r++)t[r].disconnectFromAllModulators()}}]),n}(e)},At.a,function(e){return function(e){Object(l.a)(n,e);var t=Vt(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).snapshots=[],e.currentSnapshot=void 0,e.snapshotComponent={id:Object(ft.uuid)()},e}return Object(s.a)(n,[{key:"setupSnapshots",value:function(){var e=this;this.newInlet(Ft.s,function(t){return e.onSnapshotMessage(t)}),this.newOutlet(Ft.k),this.currentSnapshotParameter=new ut.b("currentSnapshot",this,function(t,n,r,a){return n<0||null===n?e.currentSnapshot=void 0:e.setting=!0,n>=0?e._useSnapshot(e.snapshots[n],a,r,n):-1},{min:0,max:100,defaultValue:null,stepAutomation:!0}),this.registerParameter(this.currentSnapshotParameter)}},{key:"takeSnapshot",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=[],a=Bt(this._parameters);try{for(a.s();!(e=a.n()).done;){var i=e.value;n.push({parameter:i,coordinates:i.getCoordinates(),min:i.min,max:i.max})}}catch(o){a.e(o)}finally{a.f()}this.snapshots=[].concat(Object(r.a)(this.snapshots),[n]),t&&this.currentSnapshotParameter.set(this.snapshots.length-1)}},{key:"deleteAllSnapshots",value:function(){this.snapshots=[],this.currentSnapshot=void 0}},{key:"deleteSnapshot",value:function(e){this.snapshots=this.snapshots.filter(function(t){return t!==e}),this.currentSnapshot=void 0}},{key:"_useSnapshot",value:function(e,t,n,r){var a=this;if(e&&e!==this.currentSnapshot){var i,o={},s={},c=new Set(this._parameters),u=Bt(e);try{var l=function(){var e=i.value,t=e.parameter,n=e.coordinates,r=e.min,u=e.max;if(!c.has(t))return"continue";void 0!==r&&void 0!==u&&(t.min=r,t.max=u),o[t.id]={min:r,max:u};var l=a.groups.map(function(e){return e.history[e.history.length-1]&&e.history[e.history.length-1][t.id]}).find(function(e){return e});if(l&&l.x===n.x&&l.y===n.y)return"continue";var f=Et.a.Master.context.isOffline?Et.a.Master.context._currentTime:Et.a.Master.context.currentTime+.1,h=t.setCoordinates(n.x,n.y,f+.001,a.rampTime/1e3,!0),p=h.id,d=h.value;s[p]=d};for(u.s();!(i=u.n()).done;)l()}catch(v){u.e(v)}finally{u.f()}this.setEffectParameterValues(s),this.setParameterMinMax(o),this._clear(),this.currentSnapshot=e;var f,h=Bt(this.groups);try{for(h.s();!(f=h.n()).done;){var p=f.value;if(p.history&&p.history[0]){var d=function(t){var n=e.find(function(e){return e.parameter.id===t});n&&(p.history[0][t]=n.coordinates)};for(var m in p.history[0])d(m)}}}catch(v){h.e(v)}finally{h.f()}this.isOutletConnected(Ft.k)&&this.sendMessage(Ft.k,r+1),this.setting=!1}}},{key:"setParameterMinMax",value:function(e){this.track.sequencerEngine.dispatch(Object(st.Qd)(e))}},{key:"dropPreset",value:function(){var e=Object(_t.a)(It.a.mark(function e(t){var n,r,a,i,o;return It.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lt.a.getJson(t.contentHash);case 2:return n=e.sent,r=n.trackParameters.instrument,e.next=6,this.track.instrument.fromJson(r,!0);case 6:this.takeSnapshot(),a=Bt(this._parameters);try{for(a.s();!(i=a.n()).done;)(o=i.value).name&&!o._wasDisposed||this.unmap(o)}catch(s){a.e(s)}finally{a.f()}case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onSnapshotMessage",value:function(e){var t=Object(i.a)(e,1)[0];try{t=parseFloat(t),this.currentSnapshotParameter.set(t-1,!0)}catch(n){}}}]),n}(e)},function(e){return function(e){Object(l.a)(n,e);var t=rn(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setupPlayable",value:function(){this.playingParameter=new ut.a("playing",this,function(){return[]},{defaultValue:1,min:0,max:1}),this.registerParameter(this.playingParameter)}},{key:"playing",get:function(){return this.playingParameter.get()}}]),n}(e)},function(e){return function(e){Object(l.a)(n,e);var t=en(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).macros=[],e}return Object(s.a)(n,[{key:"deleteMacro",value:function(e){this.macros=this.macros.filter(function(t){return t!==e}),this.updateMacroRedux(),e.dispose()}},{key:"createMacro",value:function(e){var t="Macro "+(this.macros.length+1),n=new tn(t,e,this.macros.length+1,this);e.forEach(function(e){return e.planeMacro=n}),this.addMacro(n)}},{key:"freeMacro",value:function(e){e.free(),this.deleteMacro(e)}},{key:"updateMacroRedux",value:function(){this.track.sequencerEngine.dispatch(Object(st.je)(this.id,this.macros))}},{key:"addMacro",value:function(e){this.macros=[].concat(Object(r.a)(this.macros),[e]),e.number=this.macros.length,this.updateMacroRedux()}},{key:"sendMacroMessages",value:function(){(new Date).getTime();for(var e=[],t=1;t<=this.macros.length;t++)if(this.isOutletConnected("macros")){var n=this.macros[t-1].getAllCoordinates(!0);e.push(n)}(new Date).getTime(),this.sendMessage("macros",e)}},{key:"getMacrosJson",value:function(){return this.macros.map(function(e){return e.getJson()})}},{key:"fromMacrosJson",value:function(e){if(e){var t,n=Zt(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=new tn("macro",[],0,this);a.fromJson(r),this.addMacro(a)}}catch(i){n.e(i)}finally{n.f()}}}}]),n}(e)},k.a,function(e){return function(e){Object(l.a)(n,e);var t=Pt(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).currentPath=void 0,e.currentPosition=1,e}return Object(s.a)(n,[{key:"stopDrawing",value:function(){this.currentPath=void 0,this.currentPosition=1,this.pencilDown=!1}},{key:"setupDrawable",value:function(){this.pencilXParameter=new ut.a("pencilX",this,function(e,t){return[]},{defaultValue:null,min:0,max:O.c,exactAutomation:!0}),this.registerParameter(this.pencilXParameter),this.pencilYParameter=new ut.a("pencilY",this,function(e,t){return[]},{defaultValue:null,min:0,max:O.a,exactAutomation:!0}),this.registerParameter(this.pencilYParameter)}},{key:"applyPencilAutomations",value:function(){if(!this.pencilXParameter.isRecordingMix&&!this.pencilXParameter.isRecording&&this.pencilXParameter.isPlayingMix&&null===this.pencilXParameter.get(!0)&&null===this.pencilYParameter.get(!0)){var e=this.pencilXParameter.currentStep,t=Object(St.a)(e,this.pencilXParameter.mixAutomation),n=Object(St.a)(e,this.pencilYParameter.mixAutomation),r=this.pencilDown;for(var a in t)void 0!==t[a]&&(r=null!==t[a],this.calculatePath(t[a],n[a],e));this.pencilDown=r}}},{key:"setPencil",value:function(e,t){this.pencilDown=void 0!==e&&null!==e,this.pencilXParameter.set(e,!1),this.pencilYParameter.set(t,!1),this.calculatePath(e,t),this.lastX=void 0,this.lastY=void 0}},{key:"pencilX",get:function(){return this.pencilXParameter&&this.pencilXParameter.get()}},{key:"pencilY",get:function(){return this.pencilYParameter&&this.pencilYParameter.get()}},{key:"calculatePath",value:function(e,t,n){e&&t&&(this.currentPath||(this.currentPath=[]),this.currentPath=[].concat(Object(r.a)(this.currentPath),[{x:e,y:t,stepNumber:n}]))}},{key:"isRecordingMix",get:function(){return this.pencilXParameter.isRecordingMix}},{key:"applyPath",value:function(e,t){var n=this.currentPath[this.currentPosition],r=this.currentPath[this.currentPosition-1];return void 0===n||void 0===r?(this.pencilDown||(this.currentPath=void 0,this.currentPosition=1),{}):(n.x,r.x,n.y,r.y,this.currentPosition++,{})}}]),n}(e)})(p.a));t.a=cn},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(155),o=n(319),s=n(9),c=n(39),u=n.n(c),l=n(12),f=Object(l.b)(function(e,t){return{value:t.parameter.get()}},function(e){return{}})(function(e){var t=e.parameter,n=e.value,i=new Array(5).fill(0).map(function(e,t){return{label:t+1,value:t}}).slice(1),o=Object(r.useCallback)(function(e){var n=e.value;t.set(n)},[t]),c=i.find(function(e){return e.value===n});return i=[{label:"None",value:null}].concat(Object(s.a)(i)),a.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"track-shift track-rules"},a.a.createElement(u.a,{placeholder:"",options:i,value:c,onChange:o}))}),h=n(204),p=n(114),d=Object(l.b)(function(e,t){var n=t.effect.getConnectedTidal(t.number-1);return{currentHand:n&&n.lastLeafStep&&n.lastLeafStep.hand}},function(e){return{}})(function(e){var t=e.currentHand;return a.a.createElement("div",{className:t?"hand-indicator left":"hand-indicator right"})}),m=n(117),v=Object(l.b)(function(e,t){return{hand:t.effect["hand"+t.number+"Parameter"].get()}},function(e){return{}})(function(e){var t=e.hand,n=(e.track,e.number),i=e.effect;t=Math.round(t);var o=i["hand"+n+"Parameter"],s=Object(r.useCallback)(function(){t===m.c?o.set(m.d):t===m.a?o.set(m.e):t===m.e?o.set(m.a):t===m.d&&o.set(m.c)},[t]),c=Object(r.useCallback)(function(){t===m.e?o.set(m.d):t===m.a?o.set(m.c):t===m.c?o.set(m.a):t===m.d&&o.set(m.e)},[t]),u=t===m.a||t===m.c?"left-circle toggled":"left-circle",l=t===m.a||t===m.e?"right-circle toggled":"right-circle";return a.a.createElement("div",{className:"drum-circle"},a.a.createElement(d,{effect:i,number:n}),a.a.createElement("div",{onClick:s,className:u}),a.a.createElement("div",{className:"drum-divider"}),a.a.createElement("div",{onClick:c,className:l}))}),b=n(167),g=n(241);t.a=Object(l.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.isDraggable,n=e.effect,r=e.setChosen,s=e.chosen,c=e.sequencerEngine,u=void 0===c?n.track.sequencerEngine:c;return n.jakiParams?a.a.createElement(o.a,{isDraggable:t,effect:n,skipDiv:!0,instrument:n.jakiParams,type:i.c,className:"drum-router"},a.a.createElement("div",{className:"track-col labeler"},a.a.createElement("div",{className:"empty-thumb"}),a.a.createElement("div",{className:"track-btn"}),a.a.createElement("div",{className:"track-pattern"},"1"),a.a.createElement("div",{className:"track-shift"},"Rules"),a.a.createElement("div",{className:"track-shift"},"Shift"),a.a.createElement("div",{className:"track-shift"},"Truncate"),a.a.createElement("div",{className:"track-shift"},"Swing"),a.a.createElement("div",{className:"track-shift"},"Offset"),a.a.createElement("div",{className:"track-shift"},"Tempo"),a.a.createElement("div",{className:"track-shift"},"Triplet"),a.a.createElement("div",{className:"track-shift"},"Scale")),[1,2,3,4,5,6].map(function(e){return a.a.createElement("div",{className:"track-col"},u.tracks[e-1]?a.a.createElement(h.a,{onClickThumbnail:function(t){t.stopPropagation(),r&&r({type:g.b,track:e})},track:u.tracks[e-1]}):a.a.createElement("div",{className:"empty-thumb"}),a.a.createElement("div",{onClick:function(t){t.stopPropagation(),r&&r({type:g.b,track:e})},className:s&&s.track===e?"track-btn selected":"track-btn"},e),a.a.createElement(v,{number:e,effect:n.jakiParams}),a.a.createElement(f,{effect:n,parameter:n.jakiParams["rule"+e+"Parameter"]}),a.a.createElement(b.a,{width:34,needsRound:!0,parameter:n.jakiParams["shift"+e+"Parameter"],min:0,max:16}),a.a.createElement(b.a,{width:34,needsRound:!0,parameter:n.jakiParams["truncate"+e+"Parameter"],min:0,max:8}),a.a.createElement(b.a,{width:34,needsRound:!0,parameter:n.jakiParams["swing"+e+"Parameter"],min:50,max:100}),a.a.createElement(b.a,{width:34,needsRound:!0,parameter:n.jakiParams["offset"+e+"Parameter"],min:0,max:100}),a.a.createElement(b.a,{width:34,needsRound:!0,parameter:n.jakiParams["tempo"+e+"Parameter"],min:1,max:5}),a.a.createElement(p.a,{parameter:n.jakiParams["triplet"+e+"Parameter"]}),a.a.createElement(p.a,{parameter:n.jakiParams["scale"+e+"Parameter"]}))})):""})},function(e,t,n){"use strict";var r=n(9),a=n(11),i=n(2),o=n(4),s=n(7),c=n(10),u=n(1),l=n(0),f=n.n(l),h=n(5),p=n.n(h),d=n(14),m=n(92),v=n(6),b=n(337),g=n(12),y=n(29),k=new y.a,O=function(e){return e.oscillatorNodes.map(function(t){return e.adjacencyLists[t.id].filter(function(e){return["C","B1","B2","A"].includes(e.effect.name)}).length>0?1:.1})},j=(Object(g.b)(function(e,t){var n=t.instrument.oscillatorNodes;if(!n)return{};var r=n[0],a=n[1],i=n[2],o=n[3],s=e.effects.effectParameters;return{h1:s[r.harmonicityParameter.id],h2:s[a.harmonicityParameter.id],h3:s[i.harmonicityParameter.id],h4:s[o.harmonicityParameter.id],m1:s[r.modulationIndexParameter.id],m2:s[a.modulationIndexParameter.id],m3:s[i.modulationIndexParameter.id],m4:s[o.modulationIndexParameter.id],hd1:r.harmonicityParameter.depth,hd2:a.harmonicityParameter.depth,hd3:i.harmonicityParameter.depth,hd4:o.harmonicityParameter.depth,md1:r.modulationIndexParameter.depth,md2:a.modulationIndexParameter.depth,md3:i.modulationIndexParameter.depth,md4:o.modulationIndexParameter.depth,algo:t.instrument.algorithmParameter.get(!0)}},function(e){return{setSelectedZObject:function(t){return e(Object(v.uf)(t))}}})(function(e){var t=e.hd1,n=e.hd2,r=e.hd3,i=e.hd4,o=e.md1,s=e.md2,c=e.md3,u=e.md4,h=e.algo,v=e.color,g=e.instrument,y=e.h1,j=e.h2,w=e.h3,E=e.h4,S=e.m1,P=e.m2,x=e.m3,T=e.m4,C=(e.setSelectedZObject,e.selectedOscillator),N=Object(l.useState)(void 0),R=Object(a.a)(N,2),M=R[0],A=R[1];return Object(l.useEffect)(function(){!g.fmShader||M?g.track.subSequence.loadSubPatch("fm-harmonicity-mod-22").then(function(){var e=Object(d.a)(p.a.mark(function e(t){var n,r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("LOADED SUB PATCH=",t),console.log(t),t.hide(),g.fmShader=t,t.doNotSave=!0,n=g.track;case 6:if(!(t.effect.inletObjects.length<4)){e.next=11;break}return e.next=9,Object(m.a)(20);case 9:e.next=6;break;case 11:r=k.getColorForHash(n.presetName||n.id),console.log("COLOR FOR HASH=",r),t.effect.inletObjects[0].execute(r),t.effect.inletObjects[3].execute(O(g)),A(t);case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()):A(g.fmShader)},[A]),Object(l.useEffect)(function(){M&&(M.width=244,M.height=140)},[M]),Object(l.useEffect)(function(){M&&M.effect.inletObjects[3].execute(O(g))},[M,h]),Object(l.useEffect)(function(){if(M){for(var e=[o,s,c,u],a=[],l=0;l<4;l++){var f=e[l];g.oscillatorNodes[l].modulationIndexParameter.isConnectedToAnyModulator()?a.push(f):a.push(0)}for(var h=[t,n,r,i],p=[],d=0;d<4;d++){var m=h[d];g.oscillatorNodes[d].harmonicityParameter.isConnectedToAnyModulator()?p.push(m):p.push(0)}M.effect.inletObjects[5].execute(p),M.effect.inletObjects[6].execute(a)}},[M,o,s,c,u,t,n,r,i]),Object(l.useEffect)(function(){M&&M.effect.inletObjects[4].execute(C+1)},[M,C]),Object(l.useEffect)(function(){if(M){var e=[y,j,w,E],t=[S,P,x,T];M.effect.inletObjects[1].execute(e),M.effect.inletObjects[2].execute(t)}},[S,P,x,T,y,j,w,E,M]),Object(l.useEffect)(function(){if(M){var e=g.track,t=k.getColorForHash(e.presetName||e.id);M.effect.inletObjects[0].execute(t)}},[M,v]),M?f.a.createElement(b.a,{zobject:M,forceShow:!0}):""}),n(39)),w=n.n(j),E=n(76),S=Object(g.b)(function(e,t){return{algorithm:t.instrument.algorithmParameter.get()}},function(e){return{}})(function(e){var t=e.instrument,n=e.algorithm,r=(e.onChange,Object(l.useCallback)(function(e){var n=e.value;t.algorithmParameter.set(n)},[])),a=[1,2,3,4,5,6,7,8,9].map(function(e){return{label:e,value:e}});return f.a.createElement(E.a,{element:t.algorithmParameter,className:"algo-container"},f.a.createElement("div",{className:"algo-label"},"Algorithm:"),f.a.createElement(w.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:a,onChange:function(e){return r(e)},value:{label:n,value:n},placeholder:"Algorithm"}))}),P=n(46);n(22),n(42),n(34),new y.a;window.fmColor="#0c3545",window.fmGuideColor="#66d6ff",window.selectedFMColor="#46aaff";var x=Object(l.memo)(function(e){var t=Object(l.useRef)(void 0),n=e.innerHeight||136,r=e.height||140,a=Object(l.useCallback)(function(t){return e.harmonicity/20*242},[e.harmonicity]),i=Object(l.useCallback)(function(t){return r=e.modulation,n-Math.sqrt(r)/15*n;var r},[e.modulation]),o=(Object(l.useCallback)(function(){e.oscillator;return e.oscillator,e.osc,[]},[e.harmonicity,e.modulation,e.osc,e.oscillator]),e.oscillator);if(void 0===e.instrument.oscillators)return[];var s=e.osc,c=a(s),u=i(s);return Object(l.useEffect)(function(){t.current.setAttribute("transform","translate(".concat(c,", ").concat(u,")"))},[c,u]),f.a.createElement("g",{className:o===s?"selected fm-group":"fm-group",ref:t},f.a.createElement(T,{selected:o===s,osc:s,height:r,color:e.color,setDraggingOsc:function(t){e.setDraggingOsc(t),t?e.setParameterSliderDown([e.osc.harmonicityParameter,e.osc.modulationIndexParameter]):(e.setParameterSliderDown([]),e.osc.harmonicityParameter.automation.isRecording&&(e.osc.harmonicityParameter.automation.smoothen(),e.osc.modulationIndexParameter.automation.smoothen()))}}))}),T=Object(l.memo)(function(e){var t=e.osc,n=e.setDraggingOsc,r=e.color,a=e.height,i=e.selected;return[i?f.a.createElement("line",{className:"operator-line",key:1,x1:0,y1:-a,x2:0,y2:a,strokeWidth:1,stroke:window.fmGuideColor}):"",i?f.a.createElement("line",{className:"operator-line",key:2,x1:-242,y1:0,x2:242,y2:0,strokeWidth:1,stroke:window.fmGuideColor}):"",f.a.createElement("circle",{key:3,onMouseDown:function(e){return n(t)},onMouseUp:function(e){n(void 0)},cx:0,cy:0,className:i?"selected fm-circle":"fm-circle",r:t.instrument.adjacencyLists[t.id].filter(function(e){return["C","B1","B2","A"].includes(e.effect.name)}).length>0?13:10,fill:r,strokeWidth:1}),f.a.createElement("text",{key:4,onMouseDown:function(e){return n(t)},className:i?"selected fm-text":"fm-text",onMouseUp:function(e){n(void 0)},fontSize:10,fontFamily:"Arial",x:1===t.name.length?-3:-6,y:4},t.name)]}),C=Object(g.b)(function(e,t){if(void 0===t.instrument.oscillators)return{};var n=e.effects.effectParameters;return{harmonicity:n[t.osc.harmonicityParameter.id],modulation:n[t.osc.modulationIndexParameter.id],algorithm:t.instrument.algorithmParameter.get(!0)}},function(e){return{setParameterSliderDown:function(t){return e(Object(v.Sd)(t))},setContextualHelp:function(t,n){return e(Object(v.ub)(t,n))}}})(x);function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}window.fmColor="#0c3545",window.fmGuideColor="#66d6ff",window.selectedFMColor="#86fcf7";var R=140,M=136,A=[2,4,6,8,10,12,14,16,18],q=[1,10,20,60,120,240,480,800,900],D=function(e){Object(s.a)(n,e);var t=N(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={dragging:!1},r.ref=f.a.createRef(),r.innerHeight=r.props.innerHeight||M,r.height=r.props.innerHeight||R,r}return Object(o.a)(n,[{key:"draggingOsc",set:function(e){this.dragging=e,e&&this.props.setSelectedOsc(e)}},{key:"updateParameter",value:function(e,t){this.props.sequencerEngine.operationManager.dispatch(Object(P.v)(e,t))}},{key:"harmonicity",get:function(){return this.props.harmonicity},set:function(e){var t=this.props.oscillator;t&&t.harmonicityParameter.get(!0)!==e&&this.updateParameter(t.harmonicityParameter,e)}},{key:"modulationIndex",get:function(){return this.props.modulationIndex},set:function(e){var t=this.props.oscillator;t&&t.modulationIndexParameter.get(!0)!==e&&this.updateParameter(t.modulationIndexParameter,e)}},{key:"getHarmonicityXPosition",value:function(e){return e/20*242}},{key:"getHarmonicityX",value:function(e){return this.getHarmonicityXPosition(e.harmonicityParameter.get())}},{key:"getModulationIndexYPosition",value:function(e){return this.innerHeight-Math.sqrt(e)/15*this.innerHeight}},{key:"getModulationIndexY",value:function(e){return this.getModulationIndexYPosition(e.modulationIndexParameter.get())}},{key:"getHelperLines",value:function(){var e=this.props.oscillator;return this.props.oscillator?[f.a.createElement("line",{x1:this.getHarmonicityX(e),y1:0,x2:this.getHarmonicityX(e),y2:this.innerHeight,strokeWidth:1,stroke:window.fmGuideColor}),f.a.createElement("line",{x1:0,y1:this.getModulationIndexY(e),x2:242,y2:this.getModulationIndexY(e),strokeWidth:1,stroke:window.fmGuideColor})]:[]}},{key:"getHarmonicityLines",value:function(){var e=this;return A.map(function(t,n){return f.a.createElement("line",{key:n,className:"fm-guide-line",x1:e.getHarmonicityXPosition(t),y1:0,x2:e.getHarmonicityXPosition(t),y2:e.innerHeight,strokeWidth:1,stroke:window.fmColor})})}},{key:"getModulationIndexLines",value:function(){var e=this;return q.map(function(t,n){return f.a.createElement("line",{key:n,className:"fm-guide-line",x1:0,y1:e.getModulationIndexYPosition(t),x2:242,y2:e.getModulationIndexYPosition(t),strokeWidth:1,stroke:window.fmColor})})}},{key:"convertXY",value:function(e,t){var n=this.ref.current.getBoundingClientRect();return[e-n.left,t-n.top]}},{key:"onMouseMove",value:function(e){if(this.dragging){var t=this.convertXY(e.clientX,e.clientY),n=Object(a.a)(t,2),r=n[0],i=n[1];this.setXAndY(r,i)}}},{key:"setXAndY",value:function(e,t){var n=Math.floor(20*e/242*1e3)/1e3;this.harmonicity=Math.round(4*n)/4,this.modulationIndex=Math.pow(Math.max(0,Math.floor(15e3*(this.innerHeight-t)/this.innerHeight)/1e3),2)}},{key:"render",value:function(){var e=this,t=this.props.oscillator,n=this.props.instrument.oscillatorNodes;if(void 0===n)return[];t&&(n=[].concat(Object(r.a)(n.filter(function(e){return e!==t})),[t]));this.props.instrument.oscillatorNodes.indexOf(t);return f.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()}},f.a.createElement(S,{onChange:this.props.onChangeAlgorithm,instrument:this.props.instrument}),f.a.createElement("div",{draggable:"true",onDragStart:function(e){return e.preventDefault()}},f.a.createElement("svg",{ref:this.ref,id:"harmonicity-mod-"+this.props.instrument.id,className:"harmonicity-mod",onMouseMove:function(t){return e.onMouseMove(t)},onClick:function(t){return e.setXAndY.apply(e,Object(r.a)(e.convertXY(t.clientX,t.clientY)))},onMouseLeave:function(t){return e.draggingOsc=void 0},width:242,height:this.innerHeight},n.map(function(t,n){return f.a.createElement(C,{key:t.name,color:e.props.color,height:e.height,innerHeight:e.innerHeight,osc:t,setDraggingOsc:function(t){return e.draggingOsc=t},dragging:e.dragging,setSelectedOsc:e.props.setSelectedOsc,instrument:e.props.instrument,oscillator:e.props.oscillator})}))))}}]),n}(l.Component);t.a=Object(g.b)(null,function(e){return{setParameterSliderDown:function(t){return e(Object(v.Sd)(t))}}})(D)},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=(n(83),n(12)),o=n(241),s=n(117),c=n(39),u=n.n(c),l=function(e,t){return e.split(" ").join("")===t.split(" ").join("")},f=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setChosen,n=e.effect,i=e.chosen.figure,c=Object(r.useCallback)(function(){n.figures.deleteFigure(i),t(void 0)},[i,n,t]),f=Object(r.useCallback)(function(e){e=n.figures.updateFigure(i,e),t({type:o.a,figure:e})},[t,i]),h=Object(r.useCallback)(function(e){var t=e.value,n=s.b[t][0];f(n)},[t,i]),p=s.b[Math.round(i.figureLength)],d=i.toString();return a.a.createElement("div",{className:"figure-screen"},a.a.createElement("div",{onClick:function(e){e.stopPropagation(),c()},className:"delete-btn"},"x"),a.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"figure-header"},"Figure",a.a.createElement(u.a,{value:{label:i.figureLength,value:i.figureLength},onChange:h,options:Object.keys(s.b).map(function(e){return{label:e,value:e}})})),a.a.createElement("div",{className:"figure-options"},p.map(function(e){return a.a.createElement("div",{onClick:function(t){t.stopPropagation(),f(e)},className:l(d,e)?"cycle-option selected":"cycle-option"},e)})))}),h=n(9),p=n(11),d=n(873),m=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.effect.tidals[t-1];if(n)return a.a.createElement("div",null,a.a.createElement(d.a,{WIDTH:110,HEIGHT:110,tidals:[n],color:"#F6F6E9",backgroundColor:"#2D2D2E",fillColor:"#747474",dotColor:"#E8ECFF"}))}),v=n(95),b=n(62),g=n(300),y=function(e){var t=e.isSelected,n=e.rule,r=e.onClick;return a.a.createElement("div",{onClick:function(){return r(n)},className:t?"rule-part selected":"rule-part"},n.name," ",void 0!==n.value?n.value:"")},k=function(e){var t=e.option,n=e.onClick,r=e.name;return a.a.createElement("div",{onClick:function(){return n(t())},className:"puzzle-option"},r)},O=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.effect,i=Object(r.useState)(void 0),o=Object(p.a)(i,2),s=o[0],c=o[1],u=Object(r.useState)(n.scaleRules[t-1]),l=Object(p.a)(u,2),f=l[0],d=l[1];Object(r.useEffect)(function(){d(n.scaleRules[t-1])},[n,t,d]);var O=Object(r.useCallback)(function(e){if(s){var r=f.indexOf(s);f[r]=e}else f.push(e);n.scaleRules[t-1]=Object(h.a)(f),d(n.scaleRules[t-1])},[s,f,n,t,d]),j=Object(r.useCallback)(function(e){var r=n.scaleRules[t-1].indexOf(e);n.scaleRules[t-1].splice(r,1),d(Object(h.a)(n.scaleRules[t-1]))},[n,t,d]),w=Object(r.useCallback)(function(e,r){void 0!==e.value&&(e.value=r,d(Object(h.a)(n.scaleRules[t-1])))},[n,t,d]),E=Object(r.useCallback)(function(e,r){var a=f.indexOf(e),i=Object(v.a)(a+r,f.length),o=f[i];f[i]=e,f[a]=o,n.scaleRules[t-1]=Object(h.a)(f),d(Object(h.a)(f))},[n,f,t,d]);Object(r.useEffect)(function(){return window.addEventListener("keydown",S),function(){return window.removeEventListener("keydown",S)}},[n,t,d,s]);var S=Object(r.useCallback)(function(e){if(s)if("Backspace"===e.key)j(s);else if("ArrowLeft"===e.key)E(s,-1);else if("ArrowUp"===e.key)E(s,1);else if(Object(b.a)(e.key)){var t=parseInt(e.key);w(s,t)}},[n,f,t,d,s]);return a.a.createElement("div",{onClick:function(){return c(void 0)},className:"track-screen"},"Scale for Track: ",t,a.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"scale-rules"},f.map(function(e){return a.a.createElement(y,{isSelected:s===e,rule:e,onClick:c})})),a.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"puzzle-options"},a.a.createElement(k,{onClick:O,option:g.g,name:"Play"}),a.a.createElement(k,{onClick:O,option:g.f,name:"Pause"}),a.a.createElement(k,{onClick:O,option:g.e,name:"Forward"}),a.a.createElement(k,{onClick:O,option:g.i,name:"Rewind"}),a.a.createElement(k,{onClick:O,option:g.h,name:"Restart"})),a.a.createElement(m,{track:t,effect:n}))}),j=n(875);t.a=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setChosen,n=e.effect,r=e.track,i=e.sequencerEngine,s=e.chosen;return s?a.a.createElement("div",{onClick:function(e){return r?e.stopPropagation():""},className:"screen"},s.type===o.a&&a.a.createElement(f,{setChosen:t,effect:n,chosen:s}),s.type===o.b&&a.a.createElement(O,{setChosen:t,effect:n,track:s.track})):a.a.createElement(j.a,{track:r,sequencerEngine:i,effect:n})})},,function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(9),s=n(12),c=Object(s.b)(function(e,t){return{parametersDisabled:t.effect.parametersDisabled}},function(e){return{}})(function(e){var t=e.effect,n=e.i,r=e.parametersDisabled,s=r.includes(n),c="param-enabled-btn ";s&&(c+=" disabled");var u=Object(a.useCallback)(function(){var e;e=s?r.filter(function(e){return e!==n}):[].concat(Object(o.a)(r),[n]),t.parametersDisabledParameter.set(e,!1)},[r,s,t,n]);return i.a.createElement("div",{onClick:u,className:c})}),u=n(167),l=Object(s.b)(function(e,t){return{depth:t.accumulator.getDepth(t.i)}},function(e){return{}})(function(e){var t=e.depth,n=e.i,o=e.parameter,s=e.accumulator,c=e.isDraggable,l=Object(a.useState)(void 0),f=Object(r.a)(l,2),h=f[0],p=f[1],d=Object(a.useState)(t),m=Object(r.a)(d,2),v=m[0],b=(m[1],Object(a.useRef)(void 0));Object(a.useCallback)(function(e){if("Enter"===e.key){var t=parseFloat(v);if(isNaN(t))return;s.depthParameters[n].set(t),p(!1)}},[p,n,o,v,s]);return Object(a.useEffect)(function(){b.current&&h&&(b.current.focus(),b.current.select())},[h]),i.a.createElement(u.a,{isDraggable:c,track:s.track,parameter:s.depthParameters[n],units:"%",stopPropagation:!1})}),f=(n(1518),n(274)),h=n(6),p=n(846);function d(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=function(e){var t=e.setAccumulatorParameterSelected,n=e.parameter,r=e.parameterSelected,o=Object(a.useRef)(void 0),s=n===r;return i.a.createElement("div",{ref:o,id:s?"accumulator-map-source":"",onClick:function(){return t(s?void 0:n)},className:s?"selected mapped-parameter":"mapped-parameter"},n.name)};t.a=Object(s.b)(function(e,t){var n,r={isSelected:e.effects.selectedEffect===t.effect.id,isMapping:e.effects.isMacroMapping,parameterToMap:e.effects.isMacroMapping&&e.effects.parameterToMap,parameterSelected:e.effects.accumulatorParameterSelected},a=d(t.effect._parameters);try{for(a.s();!(n=a.n()).done;){var i=n.value;i&&(r[i.id]=i.get(!0))}}catch(o){a.e(o)}finally{a.f()}return r},function(e){return{setIsMacroMapping:function(t){return e(Object(h.Ec)(t))},setAccumulatorParameterSelected:function(t){return e(Object(h.r)(t))}}})(function(e){var t=e.isDraggable,n=e.i,o=e.onMapped,s=e.effect,u=e.isMapping,h=e.parameterToMap,d=e.isSelected,m=e.setIsMacroMapping,b=e.parameterSelected,g=e.label,y=e.setAccumulatorParameterSelected,k=e.skipSelected,O=Object(a.useState)(!1),j=Object(r.a)(O,2),w=j[0],E=j[1],S=Object(a.useRef)(void 0),P=Object(f.a)({ref:S}).preventDragging,x=Object(a.useCallback)(function(){s.unmapParameter(n),o()},[n]);Object(a.useEffect)(function(){w&&y(void 0)},[w]),Object(a.useEffect)(function(){u&&h&&w&&s._parameters[n]!==h&&(s.setParameter(h,n),o(),m(!1),k||y(h),E(!1))},[u,h,d,w,n,o,E]),Object(a.useEffect)(function(){return function(){y(void 0),m(!1)}},[]);var T="accumulator-mapper";return w&&(T+=" mapping"),u&&!w&&(T+=" disable"),i.a.createElement("div",{onMouseDown:function(){return t&&P(!1)},onMouseUp:function(){return t&&P(!0)},ref:S,className:T},i.a.createElement(p.a,{label:g,onClick:E}),s._parameters[n]&&i.a.createElement(c,{i:n,effect:s}),s._parameters[n]&&i.a.createElement(v,{parameterSelected:b,setAccumulatorParameterSelected:y,parameter:s._parameters[n]}),s._parameters[n]&&i.a.createElement("div",{className:"acc-parameter-value"},s._parameters[n].get(!0)),s._parameters[n]&&i.a.createElement(l,{isDraggable:t,accumulator:s,i:n,parameter:s._parameters[n]}),s._parameters[n]&&i.a.createElement("div",{onClick:x,className:"delete-parameter-btn"},"x"))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(11),u=n(0),l=n.n(u),f=n(90),h=n.n(f),p=n(12),d=Object(p.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.instrument,n=e.setMods,r=Object(u.useState)(50),a=Object(c.a)(r,2),i=a[0],o=a[1],s=Object(u.useState)(t.getStats()),f=Object(c.a)(s,2),p=f[0],d=f[1],m=Object(u.useCallback)(function(){t.simplifyPatch(i);var e=t.getStats();d(e),n(e)},[d,t,i,n]);return l.a.createElement("div",{className:"simplifier"},l.a.createElement("div",{className:"stats"},p," modulations"),l.a.createElement("div",{className:"slider-and-btn"},l.a.createElement(h.a,{value:i,change:function(e){return o(e.target.value)},step:1,max:100,min:0,orientation:"horizontal",reversed:!1}),l.a.createElement("div",{onClick:m,className:"simplify-btn"},"Simplify Patch (",i,"%)")))}),m=n(535),v=(n(1373),n(69));n(2443);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var g=function(e){Object(i.a)(n,e);var t=b(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"parameterMods",get:function(){var e=[];return this.props.parameters.forEach(function(t){return e=e.concat(t.parameterMods)}),e}},{key:"render",value:function(){var e=this.parameterMods;return 0===e.length?l.a.createElement("div",null):l.a.createElement("div",null,l.a.createElement("div",{className:"synth-mods-name"},this.props.name),e.map(function(e){return l.a.createElement(m.a,{parameterMod:e})}))}}]),n}(u.Component);t.a=function(e){var t=Object(u.useState)(0),n=Object(c.a)(t,2),r=(n[0],n[1]),a=e.instrument,i={},o={};if(a.getInstrumentType()==v.c)i={"Carrier Oscillator":a.carrierOscillator,"Modulator Oscillator":a.modulatorOscillator};else{var s=a.oscillatorNodes[0],f=a.oscillatorNodes[1],h=a.oscillatorNodes[2],p=a.oscillatorNodes[3];i={"Oscillator 1":s,"Oscillator 2":f,"Oscillator 3":h,"Oscillator 4":p};var m=a.ampEnvelope,b=a.filterEnvelope,y=a.pitchEnvelope;o={"Amp Envelope":m,"Filter Envelope":b,"Pitch Envelope":y}}return l.a.createElement("div",{className:"synth-mods"},l.a.createElement(d,{setMods:r,instrument:a}),l.a.createElement(g,{name:"Synth",parameters:a.parameters}),Object.keys(i).map(function(e){return l.a.createElement(g,{name:e,parameters:i[e].parameters})}),Object.keys(o).map(function(e){return l.a.createElement(g,{name:e,parameters:o[e].parameters})}))}},function(e,t,n){"use strict";var r=n(9),a=n(8),i=n(2),o=n(4),s=n(20),c=n(16),u=n(7),l=n(10),f=n(1),h=n(116),p=(n(394),n(102)),d=n(50),m=n(105),v=(n(390),n(389),n(344),n(279)),b=n(255),g=n(551),y=n(153),k=n(187),O=n(348),j=(n(48),n(117),n(804)),w=n(452),E=n(115),S=n(17),P=n(82),x=n(15),T=new(n.n(x).a.Time)("32n"),C=(n(83),n(257),n(806));function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var R=function(e){Object(u.a)(n,e);var t=N(n);function n(e,r){var a;Object(i.a)(this,n),(a=t.call(this,"Jaki",e)).zObject=r,a.rules=[new w.a(e,Object(s.a)(a)),new w.a(e,Object(s.a)(a)),new w.a(e,Object(s.a)(a)),new w.a(e,Object(s.a)(a))],a.scaleRules=[[],[],[],[],[],[]];for(var o=0;o<6;o++)a.useTidal();return a.freeTidals(),a.jakiParams=new j.a(a.track.subSequence),a.figures=new C.a(a.track.subSequence),a.clear(),a.numberOfOutputs=1,a.newOutlet(d.j),a.newOutlet(d.c),a.newOutlet(d.p),a.newOutlet("figure-change"),a}return Object(o.a)(n,[{key:"clear",value:function(){var e=this;this.tidals&&this.tidals.forEach(function(e){return e.clear()}),this.freeTidals();var t=Object(y.f)(function(){return e.figures._figures});t=Object(k.f)(t,function(){return e.jakiParams.shift1Parameter.get()});var n=Object(g.b)(t,0,function(){return e.rules[0].rules});console.log("pl_ruled",n);var r,a,i=[],o=Object(v.e)(t),s=[0],c=function(e,t,n,r){return Object(P.c)(Object(b.b)(t,!0),Object(v.f)(e,o,n,r),Object(v.f)(e,s,void 0,r))},u=function(t,n){return Object(O.a)(c(function(t,n,r){return Object(P.c)(Object(b.a)(function(){return 0===Math.round(n())},function(){return null===r()}),t,Object(g.b)(Object(k.f)(t,function(){return Math.round(n())}),function(){return 0},function(){return null===r()?i:e.rules[Math.round(r())%e.rules.length].rules}))}(Object(m.w)(t,e.getParam("truncate",n,Math.round)),e.getParam("shift",n,Math.round),e.getParam("rule",n,Math.round)),e.getParam("scale",n),function(){return e.scaleRules[n-1]}),function(){return e.getTrackToRoute(n)},function(t){return Object(S.J)(Object(P.b)(t,e.getParam("tempo",n,function(e){return.25*Math.pow(2,Math.round(e))}),e.getParam("triplet",n)),e.swing(n),e.offset(n),e.handleHand(n))},e.zObject)};this.myScript=Object(E.a)(Object(S.D)(function(){var t=o();return t!==e._scale&&(e._scale=t,e.sendMessage(d.j,t)),e.currentScale=o(),e.sendMessage(d.p,e.tidals),Object(S.w)(!1)},(r=Object(m.w)(c(n,this.scale1Parameter,function(){return e.scaleRules[0]},!0),this.getParam("truncate",1,Math.round)),a=1,Object(O.a)(c(r,e.getParam("scale",a),function(){return e.scaleRules[a-1]}),function(){return e.getTrackToRoute(a)},function(t){return Object(S.J)(Object(P.b)(t,e.getParam("tempo",a,function(e){return.25*Math.pow(2,e)}),e.getParam("triplet",a)),e.swing(a),e.offset(a),e.handleHand(a))},e.zObject)),u(n,2),u(n,3),u(n,4),u(n,5),u(n,6)))}},{key:"getTrackToRoute",value:function(e){return e}},{key:"getParam",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};return function(){return r(n.jakiParams[e+t+"Parameter"].get())}}},{key:"pName",value:function(e,t){return this.jakiParams[e+t+"Parameter"]}},{key:"swing",value:function(e){var t,n=this;return t=function(){return n.pName("swing",e).get()},function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=n[0],i=n[1],o=n[2];if(!a)return Object(S.w)(!0);var s=S.A.apply(void 0,[t].concat(n));return Math.floor(i/2)%2!==0?Object(S.Q)({stepData:a,time:o+T*(s-50)/50,stepNumber:i}):Object(S.w)(!0)}}},{key:"offset",value:function(e){var t,n=this;return t=function(){return n.pName("offset",e).get()},function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=n[0],i=n[1],o=n[2];if(!a)return Object(S.w)(!0);var s=S.A.apply(void 0,[t].concat(n));return Object(S.Q)({stepData:a,time:o+T*s/100,stepNumber:i})}}},{key:"handleHand",value:function(e){var t=this;return Object(P.a)(function(){return t.pName("hand",e).get()})}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"stop",value:function(){Object(c.a)(Object(f.a)(n.prototype),"stop",this).call(this),this.freeTidals()}},{key:"getJson",value:function(){return Object(a.a)({},Object(c.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{jakiParams:this.jakiParams.getJson(),figures:this.figures.getJson(),rules:this.rules.map(function(e){return e.getJson()}),scaleRules:this.scaleRules})}},{key:"registerContext",value:function(e){e=e.forEffect(this),this.getParameters().forEach(function(t){return t.setContext(e)})}},{key:"getParameters",value:function(){return[].concat(Object(r.a)(this.parameters),Object(r.a)(this.jakiParams.parameters),Object(r.a)(this.figures.figures.flatMap(function(e){return e.parameters})),Object(r.a)(this.rules.flatMap(function(e){return e.getParameters()}))).filter(function(e){return e})}},{key:"fromJson",value:function(e){var t=Object(c.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e);return e.jakiParams?this.jakiParams.fromJson(e.jakiParams):this.jakiParams.fromJson(e),e.figures&&(Array.isArray(e.figures)?this.figures.fromJson({id:this.figures.id,figures:e.figures}):this.figures.fromJson(e.figures)),e.rules&&this.rules.forEach(function(t,n){e.rules[n]&&(t.effects=[],t.fromJson(e.rules[n]))}),e.scaleRules&&(this.scaleRules=e.scaleRules),t}}]),n}(Object(p.a)(h.a));t.a=R},function(e,t,n){"use strict";(function(e){n.d(t,"c",function(){return g}),n.d(t,"a",function(){return y}),n.d(t,"b",function(){return k});var r=n(5),a=n.n(r),i=n(14),o=n(65),s=n(40),c=(n(92),n(717)),u=n(31),l=n(752),f=n(44),h=n(36),p=n(70),d=n(47);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=new l.a,g=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,s,c,u,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.projectHash,r=t.bpm,i=t.hasArrangement,s=t.thumbnail,c=t.presetsList,u=t.patterns,console.log("generated project metata=",s,n,r,i,c,u),n=Object(o.c)(n),l=h.a.utils.padLeft("0x0",64),s=s?Object(o.c)(s):l,c=c.map(function(e){return Object(o.c)(e)}),new p.a(f.r,"newProjectMetadata",[n,r,s,c,u,i]).execute();case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),y=function(){var t=Object(i.a)(a.a.mark(function t(n,r){var i,o,s,c,u,l,f,h;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.subSequences.flatMap(function(e){return e.tracks.filter(function(e){return e.preset&&e.preset.contentHash}).map(function(e){return e.preset.contentHash})}),o=n.tracks[0]?n.tracks[0].patterns.length:0,s=n.subSequences[0].mix&&n.subSequences[0].mix.length>0,c=n.bpm,u=void 0,!(l=n.subSequences[0].findNodeByName("three.canvas").find(function(e){return!e.isUI&&(!e.subSequence.zObject||!e.subSequence.zObject.isUI)}))||!l.effect.renderer){t.next=13;break}return console.log("generating thumbnail with canvas=",l),f=l.effect.renderer.domElement.toDataURL().slice(22),h=e.from(f,"base64"),t.next=12,d.a.addBuffer(h);case 12:u=t.sent;case 13:return t.abrupt("return",{bpm:c,thumbnail:u,projectHash:r,hasArrangement:s,patterns:o,presetsList:i});case 14:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),k=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,l,f,h,p,d,v,g,y,k,O,j,w,E,S,P,x,T,C,N,R,M,A,q,D,I,_=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(_.length>1&&void 0!==_[1])||_[1],r=new s.a(b.contractAddress).from(u.S).select("projectHash").select("thumbnailhash").whereIn("projectHash",t),e.next=4,r.executeQuery();case 4:return i=e.sent,o=new s.a(b.contractAddress).from(u.R).select("projectHash").select("presetHash").whereIn("projectHash",t),e.next=8,o.executeQuery();case 8:return l=e.sent,f=new s.a(b.contractAddress).from(u.Q).select("projectHash").whereIn("projectHash",t),e.next=12,f.executeQuery();case 12:if(h=e.sent,p={},!n){e.next=21;break}return d=new s.a((new c.a).contractAddress).from(u.ab).select("sequenceHash").select("sampleHash").whereIn("sequencehash",t),e.next=18,d.executeQuery();case 18:v=e.sent,g=m(v);try{for(g.s();!(y=g.n()).done;)k=y.value,O=k.sequenceHash,j=k.sampleHash,p[O]||(p[O]={}),p[O].samples||(p[O].samples=[]),p[O].samples.push(j)}catch(a){g.e(a)}finally{g.f()}case 21:w=m(i);try{for(w.s();!(E=w.n()).done;)S=E.value,P=S.projectHash,x=S.thumbnailhash,p[P]||(p[P]={}),p[P].thumbnail=x}catch(a){w.e(a)}finally{w.f()}T=m(l);try{for(T.s();!(C=T.n()).done;)N=C.value,R=N.projectHash,M=N.presetHash,p[R]||(p[R]={}),p[R].presets||(p[R].presets=[]),p[R].presets.push(M)}catch(a){T.e(a)}finally{T.f()}A=m(h);try{for(A.s();!(q=A.n()).done;)D=q.value,I=D.projectHash,p[I]||(p[I]={}),p[I].hasArrangement=!0}catch(a){A.e(a)}finally{A.f()}return console.log("RESULTS=",p),e.abrupt("return",p);case 29:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}).call(this,n(27).Buffer)},function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l});var r=n(9),a=n(17),i=n(389),o=n(48),s=n(83),c=(n(82),n(153),n(105),[]);window.lazies=0,window.nolazies=0;var u=function(e,t,n,r){return l(e,1,t,n,r)},l=function(e){var t,n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,p=arguments.length>4?arguments[4]:void 0,d=void 0,m=void 0,v=void 0,b=void 0;return function(){for(var g=arguments.length,y=new Array(g),k=0;k<g;k++)y[k]=arguments[k];var O=a.A.apply(void 0,[e].concat(y)),j=a.A.apply(void 0,[l].concat(y)),w=a.A.apply(void 0,[s].concat(y)),E=a.A.apply(void 0,[u].concat(y)),S=a.A.apply(void 0,[p].concat(y));if(E.forEach(function(e){return e.counter=0}),S&&S.forEach(function(e){return e.counter=0}),O===d&&m===w&&v===E&&t===S&&n===j)return window.lazies++,b;if(d=O,m=w,n=j,t=S,v=E,j=j&&j.flat(16),void 0===d)return c;for(var P=Object(i.a)(w).apply(void 0,y).decide,x=void 0,T=[],C=0,N=[],R=function(){return j&&j[(C-1)%j.length]},M=function(){return j&&j[C%j.length]},A=function(e){return T[T.length-1]=e},q=void 0,D=0,I=!1,_=0,F=h(O),L=function(e){if(Array.isArray(e))return V(e);e.figureId!==q&&(D=0,q=e.figureId,0!==C&&_++),e.rules=[],I=!1,e=B(e);var t=f(e,o.r);if(e=t.reduce(function(e,t){return z(t,e,E,D)},e),x){e=f(x,o.l).reduce(function(e,t){return z(t,e,E,D)},e),e=(t=f(e,o.r)).reduce(function(e,t){return z(t,e,E,D,!1,!0)},e),T.push(e);var n=f(e,o.o);T[T.length-2]=n.reduce(function(e,t){return z(t,e,E,D,o.o)},x),e.accent&&A(z(Object(o.r)(o.a),e,E,D))}else T.push(e);if(j&&M()){var r=M(),a=f(r,o.r);e=a.reduce(function(e,t){return z(t,e,S,D)},e),R()&&(e=(a=f(R(),o.l)).reduce(function(e,t){return z(t,e,S)},e)),A(e)}I||(e=[Object(o.p)()].reduce(function(e,t){return z(t,e,E,D)},e),A(e));return x=e,C++,D++,e},B=function(e){N.forEach(function(e){return e.delay--});var t=N.filter(function(e){return 0===e.delay});return t.length>0&&(I=!0,e=t.reduce(function(e,t){return Object(o.n)(e,t)},e)),e},z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,c=Object(o.m)(e,n,P,a,_,F,s),u=c.actions,l=c.delayedActions,f=c.matchedRules;N=[].concat(Object(r.a)(N),Object(r.a)(l)),(u.filter(function(e){return e.type&&"NOTHING"!==e.type}).length>0||l.length>0)&&(i||(I=!0));var h=u.reduce(function(e,t){return Object(o.n)(e,t)},t);return h.rules||(h.rules=[]),Array.isArray(h)&&h.filter(function(e){return!e.rules}).forEach(function(e){return e.rules=[]}),f.forEach(function(e){return Array.isArray(h)?h.map(function(t){return t.rules.push(e)}):h.rules.push(e)}),h},V=function(e){for(var t=function(){var e=T;return T=[],e}(),n=0;n<e.length;n++){var r=e[n];L(r)}T.cycleLength=e.cycleLength,t.push(T),function(e){T=e}(t)},H=0;H<O.length;H++)L(O[H]);return b=T,window.nolazies++,b}},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.r;if(Array.isArray(e))return[t(o.c)];var n=[t(o.b)];switch(e.type.type){case".":n.push(t(Object(s.c)()));break;case"-":n.push(t(Object(s.b)(e.type.value)))}return e.accent&&n.push(t(o.a)),e.staccato&&n.push(t(o.j)),e.legato&&n.push(t(o.e)),e.pianissimo&&n.push(t(o.f)),e.flam&&n.push(t(o.d)),e.piano&&n.push(t(o.g)),null===e.transpose&&n.push(t(o.i)),n},h=function(e){for(var t=void 0,n=0,r=0;r<e.length;r++){var a=e[r];a.figureId!==t&&(t=a.figureId,n++)}return n}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(223),a=function(e,t,n,a){return Object(r.b)()<e/n?e-.75*Object(r.b)()*(e-t)*a:e+.75*(n-e)*a*Object(r.b)()}},function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return f});var r=n(11),a=n(9);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(e,t){if(0===e.length)return[];var n={},r=(Math.max.apply(Math,Object(a.a)(e.map(function(e){return e.y}))),Math.min.apply(Math,Object(a.a)(e.map(function(e){return e.y}))));e.forEach(function(e){e.x;var t=e.y;n[t]||(n[t]=[]),n[t].push(e)});for(var i=[],o=n[r],s=r;;){var l=o,f=c(n,s),h=n[f];if(s=f,o=h,!l||!h)break;i=[].concat(Object(a.a)(i),Object(a.a)(u(l,h)))}return i},c=function(e,t){var n,r=i(Object.keys(e).map(function(e){return parseInt(e)}));try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a>t)return a}}catch(o){r.e(o)}finally{r.f()}},u=function(e,t){for(var n=[],r=function(r){var a=e[r],i=e[r+1],o=t.find(function(e){return e.x===a.x}),s=t.find(function(e){return e.x===i.x});o&&i&&n.push([a,o,i]),s&&i&&o&&n.push([o,s,i])},a=0;a<e.length-1;a++)r(a);return n},l=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=[],a=i(e);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=o.filter(function(e){return e.dist>=n}),c=o.filter(function(e){return e.dist<n});if(0!==c.length&&0!==s.length){for(var u=s.length<c.length?s:c,l=s.length>c.length?s:c,f=[],h=[[u[0],l[0]],[u[0],l[1]]],p=0,d=h;p<d.length;p++){var m=d[p],v=[m[0],m[1]],b=v[0],g=v[1],y=(n-g.dist)/(b.dist-g.dist),k={x:y*b.x+(1-y)*g.x,y:y*b.y+(1-y)*g.y};f.push(k)}f[0].x===f[1].x&&f[0].y===f[1].y||r.push([f[0],f[1]])}}}catch(O){a.e(O)}finally{a.f()}return r},f=function(e){var t,n=Object(a.a)(e),o={},s=i(e);try{for(s.s();!(t=s.n()).done;){var c=t.value,u=Object(r.a)(c,2),l=u[0],f=u[1];l=d(l),f=d(f),o[l]||(o[l]=[]),o[f]||(o[f]=[]),o[l].push(c),o[f].push(c)}}catch(y){s.e(y)}finally{s.f()}for(var m=[];n.length>0;)for(var v=n.shift();;){var b=p(o[d(h(v))],n);b.length>0&&function(){var e=b.pop();e[1].x===h(v).x&&e[1].y===h(v).y?v.push(e[0]):v.push(e[1]),n=n.filter(function(t){return t!==e})}();var g=p(o[d(v[0])],n);if(g.length>0&&function(){var e=g.pop();v.unshift(e[1].x===v[0].x&&e[1].y===v[0].y?e[0]:e[1]),n=n.filter(function(t){return t!==e})}(),0===g.length&&0===b.length){m.push(v);break}}return m},h=function(e){return e[e.length-1]},p=function(e,t){return e||[]},d=function(e){return e.x+","+e.y}},,,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var f=function(e){Object(i.a)(n,e);var t=l(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"onPlayClicked",value:function(e){e.target.parentNode.blur(),e.target.blur(),e.currentTarget.blur(),this.props.play(),this.setState(this.state)}},{key:"render",value:function(){var e=this,t={};return this.props.color&&(t.backgroundColor=this.props.color),u.a.createElement("div",{style:t,onClick:function(t){return e.onPlayClicked(t)},className:"playpause playpause-user"},u.a.createElement("input",{checked:!this.props.isPlaying,type:"checkbox",value:!this.props.isPlaying,id:"playpause",name:"check"}),u.a.createElement("label",{htmlFor:"playpause playpause-user",tabIndex:1}))}}]),n}(c.Component);t.a=f},function(e,t,n){"use strict";n.d(t,"d",function(){return b}),n.d(t,"b",function(){return g}),n.d(t,"f",function(){return y}),n.d(t,"a",function(){return k}),n.d(t,"e",function(){return O}),n.d(t,"c",function(){return j});var r=n(5),a=n.n(r),i=n(14),o=n(120),s=n(30),c=n(36),u=n(751),l=n(52),f=n(40),h=n(70),p=n(44),d=n(31),m=new u.a,v="I authorize publishing on zequencer.io from this ethereum address.",b=function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new o.ethers.providers.Web3Provider(window.ethereum,"any"),e.next=3,t.send("eth_requestAccounts",[]);case 3:return e.abrupt("return",t.getSigner());case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new o.ethers.providers.Web3Provider(window.ethereum,"any"),e.next=3,t.send("eth_requestAccounts",[]);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new o.ethers.providers.Web3Provider(window.ethereum,"any"),e.next=3,n.send("eth_requestAccounts",[]);case 3:return r=e.sent,i=n.getSigner(),e.next=7,i.signMessage(t);case 7:return s=e.sent,e.abrupt("return",{flatSignature:s,splitSignature:o.ethers.utils.splitSignature(s),account:r[0]});case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=v,e.next=3,y(t);case 3:n=e.sent,r=n.account,n.flatSignature,i=n.splitSignature,o=i.r,s=i.s,c=i.v,new h.a(p.b,"authorize",[r.toLowerCase(),t,c,o,s]).execute().then(function(e){return 0}).catch(function(e){return 0});case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,s,u,h,p,b,g;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new o.ethers.providers.Web3Provider(window.ethereum,"any")){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,t.send("eth_requestAccounts",[]);case 5:if((n=e.sent)&&n[0]){e.next=8;break}return e.abrupt("return",!1);case 8:return r=n[0],e.next=11,l.a.getAccount();case 11:if(e.sent){e.next=14;break}return e.abrupt("return",!1);case 14:return i=new f.a(m.contractAddress).from(d.a).where("walletAddress",r.toLowerCase()),e.next=17,i.executeQuery();case 17:if(0!==(s=e.sent).length){e.next=20;break}return e.abrupt("return",!1);case 20:if(u=s[0],h=u.r,p=u.s,b=u.v,h="0x"+h,p="0x"+p,b=c.a.utils.numberToHex(b),g=c.a.eth.accounts.recover(v,b,h,p)){e.next=28;break}return e.abrupt("return",!1);case 28:return e.abrupt("return",g.toLowerCase()===r.toLowerCase()&&r);case 29:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new f.a(m.contractAddress).from(d.a).where("walletAddress",t.toLowerCase()),e.next=3,n.executeQuery();case 3:if(0!==(r=e.sent).length){e.next=6;break}return e.abrupt("return","");case 6:return i=r[0].zequencerAddress,e.next=9,s.a.users.getUserName(i);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(5),s=n.n(o),c=n(14),u=n(29),l=n(337),f=n(6),h=n(92),p=n(698),d=n(12),m=(n(2439),n(169)),v=new u.a,b=Object(d.b)(function(e,t){return{_mode:t.track.recordingMode,countdown:t.track.countdown}},function(e){return{setSelectedZObject:function(t){return e(Object(f.uf)(t))}}})(function(e){var t=e.track,n=e._mode,o=e.setSelectedZObject,u=e.countdown,f=Object(a.useState)(t.recordingMode),d=Object(r.a)(f,2),b=d[0],g=d[1],y=Object(a.useState)(t._zobject),k=Object(r.a)(y,2),O=k[0],j=k[1],w=Object(a.useState)(t._main),E=Object(r.a)(w,2),S=E[0],P=E[1];Object(a.useEffect)(function(){g(n),S&&(n===m.c?S.effect.inletObjects[1].sendMessage("Output",2):n===m.a&&S.effect.inletObjects[1].sendMessage("Output",1))},[n,S]),Object(a.useEffect)(function(){var e=t.sequencerEngine;O||e.currentSubSequence.loadSubPatch("Mode5 Tape Machine").then(function(){var e=Object(c.a)(s.a.mark(function e(n){var r,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o(void 0),r=n.effect.getOutboundNodes();case 2:if(0!==Object.keys(r).length){e.next=8;break}return e.next=5,Object(h.a)(100);case 5:r=n.effect.getOutboundNodes(),e.next=2;break;case 8:(a=r["Output 1"][0].node.zObject).width=160,a.height=160,a.effect.sendMessage("size",[160,160]),a.hide(),n.hide(),j(a),P(n),t._main=n,t._zobject=a,o(void 0);case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},[j]);var x=Object(a.useCallback)(function(){b===m.a?(t.recordingMode=m.b,g(m.b)):b===m.c?(t.recordingMode=m.d,g(m.d)):b===m.b&&(t.recordingMode=m.a,g(m.a))},[g,b,t]);Object(a.useEffect)(function(){t&&S&&S.setAttribute("reelColor",v.getColorForHash(t.id))},[t,S]);var T="record-btn ";return T+=b===m.a?" off ":b===m.d||b===m.b?" preparing ":" recording",b!==m.a&&b!==m.c||(T+=" pushable"),i.a.createElement("div",{className:"live-loop-track"},O&&i.a.createElement(l.a,{forceShow:!0,zobject:O}),i.a.createElement("div",{className:"btn-and-countdown"},i.a.createElement("div",{onClick:x,className:T}),b===m.b&&!isNaN(u)&&i.a.createElement("div",{className:"countdown"},Math.round(u/4))),i.a.createElement(p.a,{track:t,trackColor:t.color,isTrackFrozen:!0}))}),g=(n(1381),n(1075)),y=n(512),k=n(376),O=n(385),j=n(513),w=Object(d.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setOption,n=e.option,r=e.options;return i.a.createElement("div",{className:"mini-options"},r.map(function(e,r){return i.a.createElement("div",{key:r,onClick:function(){return t(e===n?void 0:e)},className:n===e?"selected option":"option"},e)}))}),E=n(69),S=n(544);n(2557);window.miniTran=.5;var P=new u.a,x=(Object(d.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.color,o=Object(a.useState)(void 0),s=Object(r.a)(o,2),c=s[0],u=s[1],l=Object(a.useState)(t.instrument&&t.instrument.oscillatorNodes&&t.instrument.oscillatorNodes[0]),f=Object(r.a)(l,2),h=f[0],p=f[1],d=(t&&t.instrument&&t.instrument.getInstrumentType())!==E.f||t.isFrozen?["FX"]:["FM","Mixer","Env","Filter","FX"],m=P.transparent(n,window.miniTran);return i.a.createElement("div",{className:"track-mini-control"},"FM"===c?i.a.createElement(S.a,{color:n,height:100,backgroundColor:m,innerHeight:96,instrument:t.instrument,sequencerEngine:t.sequencerEngine,oscillator:h,setSelectedOsc:p}):"Mixer"===c?i.a.createElement(O.a,{color:n,setOscillatorDetails:p,oscillatorDetails:h,sequencerEngine:t.sequencerEngine,instrument:t.instrument}):"Env"===c?i.a.createElement(k.a,{color:n,envelopeOptions:j.a,sequencerEngine:t.sequencerEngine,instrument:t.instrument}):"Filter"===c?i.a.createElement(y.a,{color:n,sequencerEngine:t.sequencerEngine,instrument:t.instrument}):"FX"===c?i.a.createElement(g.a,{showEffect:!0,track:t}):"",i.a.createElement(w,{options:d,setOption:u,option:c}))}),n(1548),n(1407)),T=n(1408),C=(n(1557),n(39)),N=n.n(C),R=Object(d.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=Object(a.useState)([]),o=Object(r.a)(n,2),s=o[0],c=o[1],u=Object(a.useState)(void 0),l=Object(r.a)(u,2),f=(l[0],l[1]);t.audioInputManager;Object(a.useEffect)(function(){var e=[{value:"none",label:"None"}];void 0!==t.audioInputManager&&t.audioInputManager.getInputChannels().forEach(function(t){return e.push({value:t,label:t})}),c(e)},[t]);var h=Object(a.useCallback)(function(e){var n="none"===e.value?void 0:e.value;t.setAudioInput(n),f(n)},[t,f]),p=Object(a.useCallback)(function(e){for(var t=0;t<s.length;t++)if(s[t].value==e)return s[t]},[s]);return i.a.createElement("div",{className:"audio-input-dropdown-container"},i.a.createElement(N.a,{className:"audio-input-dropdown",controlClassName:"audio-input-control-dropdown",arrowClassName:"audio-input-arrow-dropdown",options:s,onChange:h,value:p(t.audioInputChannel),placeholder:"Input"}))}),M=n(460),A=n(206),q=n(635),D=(n(2715),n(507)),I=(n(626),n(878)),_=n(1410),F=n(2),L=n(4),B=n(7),z=n(10),V=n(1),H=n(55),U=n(46),J=n(736),G=(n(270),n(90),n(38)),W=n(34);n(1076);function K(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(V.a)(e);if(t){var a=Object(V.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(z.a)(this,n)}}var X=function(e){Object(B.a)(n,e);var t=K(n);function n(e){var r;return Object(F.a)(this,n),(r=t.call(this,e)).state={},r}return Object(L.a)(n,[{key:"onToggleClicked",value:function(){this.props.trackData.toggleEnabled(),this.setState(this.state)}},{key:"onMuteClicked",value:function(){this.props.sequencerEngine.operationManager.dispatch(Object(U.x)(this.props.trackData,!this.props.muted)),this.setState(this.state)}},{key:"onSoloClicked",value:function(){this.props.trackData.solo(!this.props.solo)}},{key:"onChangeVolume",value:function(e){void 0!==e&&(e=parseFloat(e),this.props.trackData.setVolume(e),this.setState(this.state))}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(e),this.props.setContextualHelp(t)}},{key:"toggleLock",value:function(){this.props.trackData.togglePatternLock()}},{key:"render",value:function(){var e=this,t=1==this.props.triggering?" flashit ":"",n=this.props.muted?t+"mute-button muted":t+"mute-button";return this.props.isCompactMode&&(n+=" compact"),i.a.createElement("div",{className:"track-controls"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"volume-container"},i.a.createElement("div",{onMouseOver:function(t){return e.setContextualHelp(t,W.Lb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:n,onClick:function(){return e.onMuteClicked()}},this.props.trackNumber+1),i.a.createElement("div",{onClick:function(){return e.onSoloClicked()},onMouseOver:function(t){return e.setContextualHelp(t,W.Sb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:this.props.solo?"track-solo-button on":"track-solo-button off"},"S"),this.props.trackData.isFrozen&&this.props.trackData.getTrackType()!==H.a?"":i.a.createElement("div",{onMouseOver:function(t){return e.setContextualHelp(t,W.Ob)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.onToggleClicked()},className:this.props.isEnabled?"midi-recording-button on":"midi-recording-button off"},i.a.createElement("span",{className:"black plain-dot"}))),i.a.createElement(G.a,{condition:!this.props.isCompactMode},this.props.isSelectedTrack?i.a.createElement(J.a,{meter:this.props.trackData.trackMeter}):i.a.createElement("div",{className:"ghost-meter"}))),this.props.showEffects?i.a.createElement("div",{className:"effect-lock"},i.a.createElement(M.a,{patternLocked:this.props.patternLocked,toggleLock:function(){return e.toggleLock()}})):"")}}]),n}(a.Component),Q=Object(d.b)(function(e,t){var n=t.trackData,r=e.tracks.trackVolumes[n.id],a=e.tracks.trackMutes[n.id],i=e.tracks.trackSolos[n.id],o=(e.tracks.trackIsEnabled[n.subSequence.id]||{})[n.id],s=e.tracks.triggers[t.trackNumber],c=void 0!==s&&Object.keys(s).some(function(e){return!0===s[e]}),u=((e.tracks.trackPatternLocks[n.subSequence.id]||{})[n.trackNumber]||{})[n.currentPattern]||!1;return{trackNumber:n.trackNumber,patternLocked:u,triggering:c,volume:void 0===r?0:r,muted:void 0!==a&&a,solo:void 0!==i&&i,isEnabled:void 0!==o&&o,isCompactMode:e.sequencer.isCompactMode,isFrozen:t.trackData.isFrozen,showEffects:e.tracks.showTrackEffects[t.trackData.trackNumber]}},function(e,t){return{setContextualHelp:function(t){return e(Object(f.ub)(t))}}})(X),Y=n(204),Z=(n(593),n(9)),$=n(383),ee=function(e){var t=e.selectedPalette,n=e.palette,r=e.onChoose,a=t===n?"selected palette-option":"palette-option",o={backgroundColor:$.a[n]};return i.a.createElement("div",{style:o,onClick:function(){return r(n)},className:a},n+1)},te=Object(d.b)(function(e,t){var n=e.effects.sequencedPalettes[t.effect.track.id],r=e.effects.selectedPalettes[t.effect.track.id];return{selectedPalette:void 0!==r?r:n,numPalettes:t.effect.palettes.length}},function(e){return{setSelectedPalette:function(t,n){return e(Object(f.gf)(t,n))}}})(function(e){var t=e.effect,n=e.selectedPalette,o=(e.setSelectedPalette,Object(a.useState)(Object(Z.a)(t.palettes))),s=Object(r.a)(o,2),c=s[0],u=s[1];Object(a.useCallback)(function(){t.newPalette(),u(Object(Z.a)(t.palettes))},[u]);Object(a.useEffect)(function(){u(t.palettes)},[t.palettes,u]);var l=Object(a.useCallback)(function(e){e===n&&(e=void 0),t.switchToPalette(e,n,void 0,!0)},[t,n]);return i.a.createElement("div",{className:"track-palettes"},c.map(function(e){return i.a.createElement(ee,{onChoose:l,selectedPalette:n,palette:e})}))}),ne=n(89),re=(n(1534),n(76),n(326)),ae=function(e){return void 0===e||null===e?null:(e.length>40?e.substring(0,40)+"...":e).trim()},ie=Object(d.b)(function(e,t){return{planar:e.effects.planar[t.track.id],showEffects:e.tracks.showTrackEffects[t.track.trackNumber],showFreezeHistory:e.tracks.showTrackFreezeHistory[t.track.id],liveEffects:t.track.liveEffects.effects}},function(e,t){return{setContextualHelp:function(t){return e(Object(f.ub)(t))},setShowEffects:function(n){return e(Object(f.ig)(t.track.trackNumber,n))},setShowFreezeHistory:function(n){return e(Object(f.jg)(t.track.id,n))},setTracksToHide:function(t){return e(Object(f.ph)(t))},setQuickAddSearchText:function(t){return e(Object(f.ye)(t))},setSelectorMode:function(t){return e(Object(f.vf)(t))},setSidebarViewMode:function(t){return e(Object(f.qg)(t))},setPulledEffects:function(t){return e(Object(f.we)(t))}}})(function(e){var t=Object(a.useState)(!1),n=Object(r.a)(t,2),o=n[0],s=n[1],c=(e.track.sample,{}),u=e.track,l=e.isHidden;Object(a.useEffect)(function(){},[]),e.isSelected&&(c.backgroundColor=e.borderColor);var f="track-header";e.track.trackNumber%2===1&&(f+=" odd");var h={borderColor:e.borderColor};Object(a.useEffect)(function(){return window.addEventListener("keydown",p),function(){return window.removeEventListener("keydown",p)}},[e.setShowParams,e.showParams,e.isSelected]);var p=Object(a.useCallback)(function(t){"h"===t.key&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),e.setShowParams(!1)):"\\"===t.key&&e.isSelected&&e.setShowParams(!e.showParams)},[e.setShowParams,e.showParams,e.isSelected]),d="effects-tab",m="track-name-view";e.showEffects||(e.showParams?d+=" selected":e.showFreezeHistory||(m+=" selected"));var v=e.track.presetName||e.track.getName();!e.track.presetName&&e.track.sample&&(v=e.track.sample.name);var b=Object(a.useState)(v),g=Object(r.a)(b,2),y=g[0],k=g[1],O=Object(a.useCallback)(function(){e.sequencerEngine.deleteTrack(e.track.trackNumber)},[e.track]),j=(Object(a.useCallback)(function(){var t=e.track.state.effects.pulledEffects||[];e.setPulledEffects([].concat(Object(Z.a)(t),[e.planar]))},[e.planar,e.track]),Object(a.useCallback)(function(){e.setShowEffects(!e.showEffects),e.setShowFreezeHistory(!1),e.setShowParams(!1)},[e.showEffects,e.track]),Object(a.useCallback)(function(){e.setShowParams(e.showParams?void 0:"Velocity")},[e.showEffects,e.showParams,e.track])),w=(Object(a.useCallback)(function(){e.setShowFreezeHistory(!e.showFreezeHistory),e.setShowParams(!1),e.setShowEffects(!1)},[e.showFreezeHistory]),Object(a.useCallback)(function(t){e.setQuickAddSearchText(t),e.setSelectorMode(!0),e.setSidebarViewMode(re.g)},[]),Object(a.useCallback)(function(){var t=Object(Z.a)(e.track.sequencerEngine.state.tracks.tracksToHide);if(l){var n=t.indexOf(e.track);t.splice(n,1),e.setTracksToHide(t)}else{if(e.onHide)return e.onHide();e.setTracksToHide([].concat(Object(Z.a)(t),[e.track]))}},[e.track,l,e.onHide]),Object(a.useCallback)(function(t){"Enter"===t.key&&(e.track.presetName=y,s(!1))},[s,y,e.track])),E=e.liveEffects.find(function(e){return e.effect===ne.d});return i.a.createElement("div",{style:c,className:f},i.a.createElement("div",{onClick:function(){return s(!0)},style:h,className:m},o?i.a.createElement("input",{type:"text",onKeyDown:w,text:y,className:"track-name-edit",onChange:function(e){return k(e.target.value)}}):ae(v)),u.getTrackType()!==H.a&&i.a.createElement("div",{style:h,onClick:j,className:d},"Params"),l?"":E?i.a.createElement(te,{effect:E}):"",i.a.createElement("div",{className:"track-tags"}),i.a.createElement("div",{onMouseLeave:function(){return e.setContextualHelp(void 0)},onMouseOver:function(){return e.setContextualHelp(W.Hb)},onClick:O,className:"delete-button delete-track-button"},"x"))}),oe=n(176),se=n(173),ce=(Object(d.b)(function(e,t){return{connectionStatus:e.clock.connectionStatus}},function(e){return{}})(function(e){var t=e.track,n=e.dropdownPos,r=e.setDropdownPos,o=e.connectionStatus;Object(a.useEffect)(function(){n?window.addEventListener("mousedown",s):window.removeEventListener("mousedown",s)},[r,n]);var s=Object(a.useCallback)(function(){r(void 0)},[r]),c=Object(a.useCallback)(function(e){e(t),s()},[t,r]),u=Object(a.useCallback)(function(e){e.sequencerEngine.clockSync.transferTrack(e)},[t]);return n?i.a.createElement("div",{style:{top:n.y,left:n.x},className:"track-context-menu context-menu"},o===oe.c&&i.a.createElement("div",{onMouseDown:function(){return c(u)},className:"menu-item"},"Send to Peer"),i.a.createElement("div",{onMouseDown:function(){return c(se.g)},className:"menu-item"},"Make Instrument Rack"),i.a.createElement("div",{onMouseDown:function(){return c(se.j)},className:"menu-item"},"Save Preset"),i.a.createElement("div",{onMouseDown:function(){return c(se.a)},className:"menu-item"},"Copy All Steps"),i.a.createElement("div",{onMouseDown:function(){return c(se.k)},className:"menu-item"},"Transcribe"),i.a.createElement("div",{onMouseDown:function(){return c(se.d)},className:"menu-item"},"Extract Stems"),i.a.createElement("div",{className:"menu-item",onMouseDown:function(){return c(se.c)}},"Delete Locks"),i.a.createElement("div",{className:"menu-item",onMouseDown:function(){return c(se.b)}},"Delete Automations"),i.a.createElement("div",{className:"menu-item",onMouseDown:function(){return c(se.f)}},"Make Effect Rack"),i.a.createElement("div",{className:"menu-item",onMouseDown:function(){return c(se.h)}},"Make Midi Effect Rack"),i.a.createElement("div",{className:"menu-item",onMouseDown:function(){return c(se.i)}},"Map to Planar")):[]}),n(1099),n(2561),new u.a);t.a=Object(d.b)(function(e,t){var n=t.track,r=n;n&&n.tracks&&n.tracks[0]&&(r=n.tracks[0].track);var a=((e.tracks.trackPatternLocks[t.track.subSequence.id]||{})[t.track.trackNumber]||{})[t.track.currentPattern]||!1,i=e.mix.selectedTrack===t.track.trackNumber;return{patternLocked:a,tracksToHide:e.tracks.tracksToHide,trackId:n.id,id:r.presetName?r.presetName:void 0!==r.sample&&void 0!==r.sample.getId()?r.sample.getId():r.getName(),isTrackFocused:e.sequencer.trackFocused===t.track.trackNumber,isSelectedTrack:i,resolution:e.sequencer.displayResolution,isConvertingTrack:e.tracks.trackToConvert===t.track,sampleDragging:e.selector.sampleDragging,presetDragging:e.presets.presetDragging,instrument:t.track.instrument,tracks:t.track.tracks,showEffects:e.tracks.showTrackEffects[t.track.trackNumber],showFreezeHistory:e.tracks.showTrackFreezeHistory[t.track.id],cirklonParameterSelected:e.cirklon.cirklonParameterSelected[t.track.id],pad:t.track.pad}},function(e){return{mouseDown:function(t){return e(Object(f.n)(t))},setSelectedSteps:function(t){return e(Object(f.jf)(t))},setStepNumberDraggingFrom:function(t){return e(Object(f.Ag)(t))},setSelectedPianoRollSteps:function(t){return e(Object(f.jf)(t))},setSelectedEffect:function(t){return e(Object(f.Se)(t))},setStepsSelection:function(t){return e(Object(f.Eg)(t))},setShowPianoRoll:function(t){return e(Object(f.Wf)(t))},setArrangementBottomMode:function(t){return e(Object(f.D)(t))},setTrackToConvert:function(t){return e(Object(f.jh)(t))},setSampleDragging:function(t){return e(Object(f.He)(t))},setPresetDragging:function(t){return e(Object(f.re)(t))},setSampleTagDragging:function(t){return e(Object(f.Le)(t))},setCurrentSoundInList:function(t){return e(Object(f.Cb)(t))},setShowEditorBottom:function(t){return e(Object(f.If)(t))}}})(function(e){var t=e.track,n=(e.isMini,e.onHide),o=(e.isDraggable,e.scrollContainer),s=e.isSelectedTrack,c=e.showEffects,u=e.setShowEditorBottom,l=(e.cirklonParameterSelected,e.mouseDown),f=(e.showFreezeHistory,e.setStepsSelection),h=e.setStepNumberDraggingFrom,p=e.setSelectedPianoRollSteps,d=e.resolution,m=e.setSelectedEffect,v=e.setShowPianoRoll,g=e.setArrangementBottomMode,y=e.setTrackToConvert,k=e.isConvertingTrack,O=(e.isTrackFrozen,e.sampleDragging),j=e.presetDragging,w=e.setSampleDragging,E=e.setSampleTagDragging,S=e.setPresetDragging,P=(e.patternLocked,e.tracksToHide),C=e.setCurrentSoundInList,N=e.forceShow,M=Object(a.useState)(!1),F=Object(r.a)(M,2),L=F[0],B=F[1],z=Object(a.useRef)(void 0),V=Object(a.useState)(void 0),U=Object(r.a)(V,2),J=(U[0],U[1],Object(T.a)({track:t,tracksToHide:P,trackRef:z,scrollContainer:o,isSelected:s&&!t.pad}).hideInfo),G=t.trackNumber,W=t.sequencerEngine,K="track";G%2===1&&(K+=" odd");var X=void 0!==t.sample&&void 0!==t.sample.getId()?t.sample.getId():t.getName(),Z="#353535c7",$=void 0===X?Z:ce.getColorForTrack(t),ee={};Object(a.useEffect)(function(){return z.current&&z.current.addEventListener("mousewheel",te),function(){z.current&&z.current.removeEventListener("mousewheel",te)}},[]);var te=function(e){return e.stopPropagation()};s&&(Z=ce.getColorForTrack(t),K+=" selected",ee.borderColor=Z);Object(x.a)({isSelectedTrack:s,track:t,sequencerEngine:W,setArrangementBottomMode:g,setShowPianoRoll:v}).toggleWaveform;var ne=Object(a.useCallback)(function(e){t.state.spatial.showPadSequencer,l(!1);var n=W.store.getState().steps.stepsSelection;if(void 0!==n&&n.toStep-n.fromStep>0){var r=t.getEasyPattern().getSelectedSteps(n,d);0===r.length?p(void 0):p(r)}f(void 0),h(void 0)},[t,d]);Object(a.useEffect)(function(){s&&re()},[s]);var re=Object(a.useCallback)(function(){W.selectedEffect=void 0,m(void 0)},[]);Object(a.useEffect)(function(){c||(W.selectedEffect=void 0,m(void 0))},[c]);var ae=Object(a.useCallback)(function(e){t.isEffectsShowing()||re(),C(void 0),s?W.state.zobject.selectedZObject!==t&&W.selectTrack(t.trackNumber):W.selectTrack(t.trackNumber)},[s,t]),oe=Object(a.useCallback)(function(e){if(O)e.stopPropagation(),W.auditionSound(O,G),w(void 0);else if(j)e.stopPropagation(),W.auditionPreset(j,G,!0,!0),S(void 0);else if(W.state.selector.sampleTagDragging){var n=W.state.selector.sampleTagDragging;Array.isArray(n)||(n=[n]),W.searchForSounds(n,!0,t),E(void 0)}},[O,j,G,t]),se=Object(a.useCallback)(function(){var e=W.state.spatial.showEditorBottom;u(e?void 0:A.b)},[]),ue=Object(a.useCallback)(function(){W.selectedEffect&&!t.isEffectsShowing()&&re()},[t]);Object(a.useCallback)(function(){t.togglePatternLock()},[t]);if(void 0===t.pattern||!N&&t.pad)return i.a.createElement("div",null);var le="track-inner";L&&(le+=" showing-cirklon"),t.getTrackType()===H.a&&(K+=" live-loop");var fe="";return fe=!N&&P.indexOf(t)>-1&&!t.pad?i.a.createElement("div",{onMouseUp:ne,onMouseDown:ae,className:K+" hidden",style:ee},i.a.createElement("div",{className:"track-side-container"},i.a.createElement("div",{style:s?{borderBottomColor:Z}:{},className:"track-side-trap"}),i.a.createElement("div",{style:s?{backgroundColor:Z}:{},className:"trap-rest"})),i.a.createElement("div",{className:"track-container"},i.a.createElement(ie,{onHide:n,showParams:L,setShowParams:B,isSelected:s,isHidden:!0,borderColor:Z,trackColor:$,track:t,sequencerEngine:W}))):i.a.createElement("div",{onMouseUp:ne,onMouseDown:ae,className:K,style:ee},i.a.createElement("div",{className:"track-side-container"},i.a.createElement("div",{style:s?{borderBottomColor:Z}:{},className:"track-side-trap"}),i.a.createElement("div",{style:s?{backgroundColor:Z}:{},className:"trap-rest"})),i.a.createElement("div",{className:"track-container"},i.a.createElement(ie,{onHide:n,showParams:L,setShowParams:B,isSelected:s,borderColor:Z,trackColor:$,track:t,sequencerEngine:W}),i.a.createElement("div",{style:s&&c?{backgroundColor:""}:{},className:le},i.a.createElement("div",{className:"unselected youtube-container"},i.a.createElement(Y.a,{className:"track-thumbnail",track:t,sample:t.sample,onClickThumbnail:se},i.a.createElement("div",{className:"volume-and-inputs"},t.getTrackType()===H.a||t.getTrackType()===H.d?i.a.createElement(R,{track:t}):"",i.a.createElement(_.a,{sequencerEngine:W,track:t})))),i.a.createElement(Q,{sequencerEngine:W,isSelectedTrack:s,trackNumber:G,trackData:t}),t.getTrackType()===H.a?i.a.createElement(b,{track:t}):L?i.a.createElement(D.a,{color:$,track:t}):i.a.createElement(I.a,{key:1,isSelectedTrack:s,sequencerEngine:W,onClickTrack:ae,store:W.store,trackNumber:t.trackNumber,id:X,trackColor:$,borderColor:Z,sample:t.sample,track:t,trackData:t})))),i.a.createElement("div",{onClick:function(e){return e.stopPropagation()},onMouseOver:ue,ref:z,onDragOver:function(e){return e.preventDefault()},onDrop:oe},k?i.a.createElement(q.a,{show:k,track:t,onClickDone:function(e){y(void 0),e?t.convertToInstrumentRack():t.convertToSampledInstrument()},onClickCancel:function(){return y(void 0)}}):"",J?i.a.createElement("div",{style:{height:J.trackHeight},className:"ghost-track"}):fe)})},function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(0),a=n.n(r),i=n(69),o=n(739),s=n(740),c=n(1050),u=n(1028),l=n(637),f=n(630),h=n(631);function p(e,t){if(void 0!==e){if("MIDI"===e.getTrackType())return a.a.createElement(c.a,{track:e});if("INSTRUMENT_RACK"===e.getTrackType())return a.a.createElement(o.a,{scrollContainer:t,track:e});if("INSTRUMENT"===e.getTrackType()){var n=e.sequencerEngine;if(!e.instrument)return[];var r=e.instrument.getInstrumentType();return r===i.i?a.a.createElement(h.a,{scrollContainer:t,key:e.trackNumber+"-instrument",track:e,instrument:e.getInstrument()}):r===i.f?a.a.createElement(s.a,{scrollContainer:t,key:e.trackNumber+"-instrument",sequencerEngine:n,track:e,instrument:e.getInstrument()}):r===i.c?a.a.createElement(l.a,{scrollContainer:t,key:e.trackNumber+"-instrument",sequencerEngine:n,track:e,instrument:e.getInstrument()}):r===i.e?a.a.createElement(f.a,{key:e.trackNumber+"-instrument",scrollContainer:t,sequencerEngine:n,track:e,instrument:e.getInstrument()}):r===i.g?a.a.createElement(u.a,{scrollContainer:t,key:e.trackNumber+"-instrument",sequencerEngine:n,track:e,instrument:e.getInstrument()}):void 0}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(15),o=n.n(i),s="QmcdpaZe62u6p47s2Nmi7jYLpgTbmz6MxVnwvndNFi53Sf",c=new(function(){function e(){Object(r.a)(this,e),this.DEFAULT_BUFFER=new o.a.Buffer(window.isNFT?s:"/ipfs/"+s),console.log("SAMPLE RATE CHOOSER called and name=",s)}return Object(a.a)(e,[{key:"updateBuffer",value:function(){this.DEFAULT_BUFFER=new o.a.Buffer(window.isNFT?s:"/ipfs/"+s)}},{key:"setSampleRate",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("setting sample rate=",e),e!==o.a.context.sampleRate?(o.a.setContext(new AudioContext({sampleRate:e,latencyHint:"playback"})),window.context=o.a.Master.context,this.DEFAULT_BUFFER=new o.a.Buffer(window.isNFT?s:"/ipfs/"+s)):console.log("it was already that so we dont need to")}}]),e}());t.a=c},,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(34),f=n(6),h=n(12);n(250);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"onClick",value:function(){this.props.track.warp(),this.setState(this.state),this.props.onWarp&&this.props.onWarp()}},{key:"isWarped",value:function(){return this.props.track.midiEffects.effects.filter(function(e){return"Warp"===e.name}).filter(function(e){return e.enabled}).length>0}},{key:"render",value:function(){var e=this,t=this.props.isWarped?"warp-button selected pushable":"warp-button pushable";return u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(l.Xb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.onClick()},className:t},"Warp")}}]),n}(c.Component);t.a=Object(h.b)(function(e,t){var n=t.track.subSequence.id;return{isWarped:e.tracks.trackWarps[n]&&e.tracks.trackWarps[n][t.track.trackNumber]}},function(e,t){return{setContextualHelp:function(t){return e(Object(f.ub)(t))}}})(d)},,,,,,function(e,t,n){"use strict";var r=n(133),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(130),l=(n(434),n(527)),f=n(234);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var p=function(e){Object(o.a)(n,e);var t=h(n);function n(e,r,i){var o;return Object(a.a)(this,n),(o=t.call(this,e,r.getType())).event=r,o.duration=i,o}return Object(i.a)(n,[{key:"addEvent",value:function(e,t,n){new l.a(this.mix,e,t,n).execute()}},{key:"execute",value:function(){for(var e in this.events){var t=this.events[e];if(!t.isPrunable()){if(this.event.step===t.step||this.event.step===t.step+t.duration)return;if(this.event.step>t.step&&this.event.step<t.step+t.duration){var n=this.event.initialSubEvent;return n.step=this.event.step,void t.addSubEvent(n)}}}this.addEvent(this.event,0,this.event.step);var r=new f.a(!1,this.event.initialSubEvent.resolution);r.step=this.event.step+this.duration,this.addEvent(r,0,r.step)}}]),n}(u.a),d=n(251),m=n(528),v=n(445);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var g=function(e){Object(o.a)(n,e);var t=b(n);function n(e,r,i){var o;return Object(a.a)(this,n),(o=t.call(this,e,r.getType())).event=r,o.resolution=i,o}return Object(i.a)(n,[{key:"execute",value:function(){void 0!==this.resolution&&(this.event.resolution=this.resolution)}}]),n}(u.a);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var k=function(e){Object(o.a)(n,e);var t=y(n);function n(e,r,i){var o;return Object(a.a)(this,n),(o=t.call(this,e,r.getType())).event=r,o.patternNumber=i,o}return Object(i.a)(n,[{key:"execute",value:function(){this.event.patternNumber=this.patternNumber}}]),n}(u.a);function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var j=function(e){Object(o.a)(n,e);var t=O(n);function n(e,r,i){var o;return Object(a.a)(this,n),(o=t.call(this,e,r.getType())).event=r,o.xTransform=i-o.event.step,o}return Object(i.a)(n,[{key:"execute",value:function(){var e=this,t=this.mixByType.getNextEvent(this.event);if(void 0!==t){var n=this.mixByType.getNextEvent(t);(void 0===n||t.step+this.xTransform<=n.step)&&(this.event.step+=this.xTransform,t.step+=this.xTransform,this.event.initialSubEvent.step+=this.xTransform,this.event.subEvents.forEach(function(t){return t.step+=e.xTransform}),t.initialSubEvent.step+=this.xTransform,t.subEvents.forEach(function(t){return t.step+=e.xTransform}))}}}]),n}(u.a),w=n(5),E=n.n(w),S=n(9),P=n(14);function x(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e){if(!e.tracks)return[];var t=[];return e.tracks.forEach(function(e){t=[].concat(Object(S.a)(t),Object(S.a)(e.getAllParameters().filter(function(e){return e.mixAutomation.automations.length>0})))}),t},N=n(43),R=n(6),M=function(){function e(t,n,r){Object(a.a)(this,e),this.track=t,this.pattern=n,this.step=r}return Object(i.a)(e,[{key:"execute",value:function(){var e=this.pattern.split(this.step);this.track.patterns.push(e),this.track.updateSteps(!0);var t={};t[N.a]=e,this.track.sequencerEngine.store.dispatch(Object(R.Re)(t))}}]),e}();function A(e,t,n){q(e.patterns.find(function(e){return e.overlapsStep(t)&&e.startStep<t}),t),q(e.patterns.find(function(e){return e.overlapsStep(n)&&e.startStep<n}),n);var r=e.patterns.filter(function(e){var r=e.startStep,a=e.startStep+e.length();return!(r>=t&&r<n||a>t&&a<=n)});e.patterns=r,e.updateSteps(!0)}function q(e,t){void 0!==e&&new M(e.track,e,t).execute()}function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var I=function(e){Object(o.a)(n,e);var t=D(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this,e,void 0)).selection=r,i.start=i.selection.start,i.end=i.selection.end,i}return Object(i.a)(n,[{key:"execute",value:function(){if(void 0!==this.mix.subSequence){for(var e in this.mix.mixesByType){var t=this.mix.mixesByType[e];this.deleteByType(parseInt(e),t)}for(var n in this.mix.deterministicMixesByType){var r=this.mix.deterministicMixesByType[n];this.deleteByType(parseInt(n),r)}var a,i,o;this.mix.subSequence.isTrack&&this.executeForTrack(this.mix.subSequence.tracks[0]),a=this.mix.subSequence,i=this.start,o=this.end,C(a).forEach(function(e){var t=e.mixAutomation.automations.filter(function(e){return e.step<i||e.step>o});for(var n in t){var r=t[n];r.step>o&&(r.step-=o-i,t[n]=r.getCopy())}e.mixAutomation.automations=t,e.mixAutomation.schedule(),e.mixAutomation.clearCache(),e.mixAutomation.updateRedux(!0)})}else{var s=this.mix.deterministicMixesByType[N.k];this.deleteByType(N.k,s)}}},{key:"deleteByType",value:function(e,t,n){var r=t.getEventsBetween(this.start,this.end,!0).filter(function(e){return!e.isPrunable()});for(var a in r){var i=r[a];if(void 0!==i.initialSubEvent){var o=Object(S.a)(i.subEvents);for(var s in o)new v.a(this.mix,i,o[s]).execute();new v.a(this.mix,i,i.initialSubEvent).execute()}else new m.a(this.mix,i,!0).execute()}if("LINEAR"===t.getMixType()){var c=Object(N.r)(e);if(void 0!==c){var u=t.getValueAtStep(this.start),l=Object(N.r)(e);c.step=this.start,l.step=this.end-1,c.setValue(u),l.setValue(u),c.subSequence=this.mix.subSequence,l.subSequence=this.mix.subSequence,new d.a(this.mix,c,1).execute(),new d.a(this.mix,l,1).execute()}}}},{key:"executeForTrack",value:function(e){A(e,this.start,this.end)}}]),n}(u.a);function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var F=function(e){Object(o.a)(n,e);var t=_(n);function n(e,r,i,o){var s;return Object(a.a)(this,n),(s=t.call(this,e,void 0)).step=r,s.selection=i,s.start=s.selection.start,s.end=s.selection.end,s.mixType=o,s}return Object(i.a)(n,[{key:"execute",value:function(){if(this.mix.subSequence.id===N.g.id&&(this.mixType=N.k),void 0===this.mixType){for(var e in this.mix.mixesByType){var t=this.mix.mixesByType[e];this.executeByType(parseInt(e),t)}for(var n in this.mix.deterministicMixesByType){var r=this.mix.deterministicMixesByType[n];this.executeByType(parseInt(n),r)}this.mix.subSequence.isTrack&&this.executeForTrack(this.mix.subSequence.tracks[0])}else this.mix.mixesByType[this.mixType]?this.executeByType(this.mixType,this.mix.mixesByType[this.mixType]):this.mix.deterministicMixesByType[this.mixType]&&this.executeByType(this.mixType,this.mix.deterministicMixesByType[this.mixType])}},{key:"executeByType",value:function(e,t,n){}},{key:"executeForTrack",value:function(){}},{key:"splitIntersectingPatterns",value:function(e){var t=this,n=e.patterns.find(function(e){return e.overlapsStep(t.start)&&e.startStep<t.start});this.splitPattern(n,this.start);var r=e.patterns.find(function(e){return e.overlapsStep(t.end)&&e.startStep<t.end});this.splitPattern(r,this.end)}},{key:"splitPattern",value:function(e,t){void 0!==e&&new M(e.track,e,t).execute()}}]),n}(u.a);function L(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var B=function(e){Object(o.a)(n,e);var t=L(n);function n(e,r,i,o,s){var c;return Object(a.a)(this,n),(c=t.call(this,e,r,i,o)).track=s,c}return Object(i.a)(n,[{key:"executeByType",value:function(e,t,n){var r=this,a=t.getEventsBetween(this.start,this.end,!0).filter(function(e){return!e.isPrunable()}).map(function(e){var t=e.getCopy(r.mix.sequencerEngine);return t.setTime(void 0,r.step+e.step-r.start),t.subEvents&&t.subEvents.forEach(function(e){return e.step=r.step+e.step-r.start}),t.duration=e.duration,t.subSequence=r.mix.subSequence,t});if("DETERMINISTIC"===t.getMixType()){var i=t.getEvent(this.start,!1).getCopy(this.mix.sequencerEngine);i.isPrunable()||(i.setTime(void 0,this.step),a.push(i))}if("LINEAR"===t.getMixType()){var o=Object(N.r)(e);if(void 0!==o){var s=t.getValueAtStep(this.start),c=t.getValueAtStep(this.end-1);o.setValue(s),o.setTime(void 0,this.step),o.subSequence=this.mix.subSequence;var u=Object(N.r)(e);u.setValue(c),u.setTime(void 0,this.step+this.end-this.start-1),u.subSequence=this.mix.subSequence;var l=Object(N.r)(e);l.setValue(c),l.setTime(void 0,this.step-1),l.subSequence=this.mix.subSequence,a.push(o),a.push(u),a.push(l)}}for(var f in a){var h=a[f];e===N.k?new p(this.mix,h,h.duration).execute():new d.a(this.mix,h,h.duration).execute()}}},{key:"executeForTrack",value:function(){var e=Object(P.a)(E.a.mark(function e(t){var n,r,a,i,o,s,c,u;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=1/0,a=-1/0,e.t0=E.a.keys(t.patterns);case 4:if((e.t1=e.t0()).done){e.next=33;break}if(i=e.t1.value,!((o=t.patterns[i]).startStep>=this.start&&o.startStep<this.end||o.endStep>=this.start&&o.endStep<this.end)){e.next=31;break}if(s=void 0,!(o.startStep<this.start)){e.next=16;break}return c=this.start-o.startStep,e.next=13,o.getCopy(c,c+o.endStep-this.start);case 13:s=e.sent,e.next=25;break;case 16:if(!(o.endStep>this.end)){e.next=22;break}return e.next=19,o.getCopy(0,this.end-o.startStep);case 19:s=e.sent,e.next=25;break;case 22:return e.next=24,o.getCopy();case 24:s=e.sent;case 25:s.startStep<r&&(r=s.startStep),s.endStep>a&&(a=s.endStep),s.track=this.track,u=s.startStep-this.start,s.startStep=this.step+u,n.push(s);case 31:e.next=4;break;case 33:r!==1/0&&a!==-1/0&&A(this.track,this.step+r-this.start,this.step+a-this.start),this.track.patterns=[].concat(Object(S.a)(this.track.patterns),n),this.track.updateSteps();case 36:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),n}(F),z=n(16);function V(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var H=function(e){Object(o.a)(n,e);var t=V(n);function n(e,r,i,o){return Object(a.a)(this,n),t.call(this,e,r,i,o)}return Object(i.a)(n,[{key:"getEventsAfter",value:function(e,t){return e.events.filter(function(e){return e.step>=t})}},{key:"executeByType",value:function(e,t,n){var r=this.getEventsAfter(t,this.start);for(var a in r){var i=r[a],o=(i.step,this.step-this.start);if(i.setTime(void 0,i.step+o),i.subEvents)for(var s in i.subEvents){i.subEvents[s].step+=o}}}}]),n}(F);function U(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var J=function(e){Object(o.a)(n,e);var t=U(n);function n(e,r,i){var o;return Object(a.a)(this,n),(o=t.call(this,e,void 0,r,i)).step=o.end,o}return Object(i.a)(n,[{key:"duration",get:function(){return this.end-this.start}},{key:"execute",value:function(){var e,t,r,a={start:this.end};new H(this.mix,this.end+this.duration,a).execute(),Object(z.a)(Object(c.a)(n.prototype),"execute",this).call(this),e=this.mix.subSequence,t=this.start,r=this.end,console.log("DUPLICATE START=%s END=%s",t,r),C(e).forEach(function(e){var n=Object(S.a)(e.mixAutomation.automations),a=n.filter(function(e){return e.step>=t&&e.step<r});for(var i in n){var o=n[i];o.step>r&&(n[i]=o.getCopy(),n[i].step+=r-t)}var s,c=x(a);try{for(c.s();!(s=c.n()).done;){var u=s.value.getCopy(!1);u.step+=r-t,n.push(u)}}catch(l){c.e(l)}finally{c.f()}n.sort(function(e,t){return e.step-t.step}),e.mixAutomation.automations=n,e.mixAutomation.schedule(),e.mixAutomation.clearCache(),e.mixAutomation.updateRedux(!0)})}},{key:"executeForTrack",value:function(){var e=Object(P.a)(E.a.mark(function e(){var t,n,r,a,i,o,s=this;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.mix.subSequence.tracks[0],this.splitIntersectingPatterns(t),n=this.end-this.start,t.patterns.filter(function(e){return e.startStep>=s.end}).forEach(function(e){return e.startStep+=n}),e.t0=E.a.keys(t.patterns);case 5:if((e.t1=e.t0()).done){e.next=17;break}if(r=e.t1.value,!((a=t.patterns[r]).startStep>=this.start&&a.startStep<this.end)){e.next=15;break}return i=a.startStep-this.start,e.next=12,a.getCopy();case 12:(o=e.sent).startStep=this.end+i,t.patterns.push(o);case 15:e.next=5;break;case 17:t.updateSteps();case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(B),G=function(){function e(t,n,r){Object(a.a)(this,e),this.track=t,this.pattern=n,this.startStep=r}return Object(i.a)(e,[{key:"execute",value:function(){this.pattern.startStep=this.startStep}}]),e}(),W=(n(33),n(455),n(400)),K=function(){function e(t,n,r){Object(a.a)(this,e),this.pattern=n,this.step=r,this.track=t}return Object(i.a)(e,[{key:"execute",value:function(){var e=Object(P.a)(E.a.mark(function e(){var t,n,r;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return A(this.track,this.step,this.step+this.pattern.length()),e.next=3,this.pattern.getCopy();case 3:(t=e.sent).track=this.track,t.startStep=this.step,this.track.patterns.push(t),this.track.updateSteps(!0),(n={})[N.a]=t,this.track.sequencerEngine.store.dispatch(Object(R.Re)(n)),r=this.step+t.length(),this.track.sequencerEngine.store.dispatch(Object(R.F)(r));case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"xScale",get:function(){return this.track.sequencerEngine.state.arrangement.xScale}}]),e}(),X=function(){function e(t,n){Object(a.a)(this,e),this.pattern=n,this.track=t}return Object(i.a)(e,[{key:"execute",value:function(){var e=Object(P.a)(E.a.mark(function e(){var t,n,r;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return A(this.track,this.pattern.endStep,this.pattern.endStep+this.pattern.length()),e.next=3,this.pattern.getCopy();case 3:(t=e.sent).track=this.track,t.startStep=this.pattern.startStep+this.pattern.length(),this.track.patterns.push(t),this.track.updateSteps(!0),(n={})[N.a]=t,this.track.sequencerEngine.store.dispatch(Object(R.Re)(n)),r=t.startStep,this.track.sequencerEngine.store.dispatch(Object(R.F)(r));case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"xScale",get:function(){return this.track.sequencerEngine.state.arrangement.xScale}}]),e}(),Q=function(){function e(t,n,r){Object(a.a)(this,e),this.pattern=t,this.direction=n,this.resizedStep=r}return Object(i.a)(e,[{key:"findOverlappingPattern",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.resizedStep;return this.pattern.track.patterns.filter(function(t){return t!==e.pattern}).find(function(e){return e.overlapsStep(t)})}},{key:"cutOverlappingPattern",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.resizedStep;if(void 0!==e)if(this.direction===W.c){var n=t-e.startStep;if(n<=0)return void this.deletePattern(e);e.changeLength(n)}else{var r=t-e.startStep;if(e.cutFromStart(r),e.startStep=t,0===e.length())return void this.deletePattern(e)}}},{key:"deletePattern",value:function(e){var t=e.track;t.patterns=t.patterns.filter(function(t){return t!==e})}},{key:"execute",value:function(){if(this.direction===W.d){var e=this.resizedStep-this.pattern.startStep;if(e<=0)return;e>this.pattern.length()&&this.cutOverlappingPattern(this.findOverlappingPattern()),this.pattern.changeLength(e,!1)}else this.resizedStep<this.pattern.startStep?(this.cutOverlappingPattern(this.findOverlappingPattern()),this.pattern.addToStart(this.pattern.startStep-this.resizedStep)):(this.pattern.cutFromStart(this.resizedStep-this.pattern.startStep),0===this.pattern.length()&&this.deletePattern(this.pattern)),this.pattern.startStep=this.resizedStep;this.pattern.track.updateSteps(!0)}}]),e}();function Y(e,t){void 0===t&&(t=e);var n=t.payload,a=void 0;switch(t.type){case r.i:(a=new p(e,n.event,n.duration)).execute();break;case r.h:(a=new d.a(e,n.event,n.duration)).execute();break;case r.b:(a=new m.a(e,n.event,n.inPlace)).execute();break;case r.a:(a=new v.a(e,n.event,n.subEvent)).execute();break;case r.g:(a=new g(e,n.event,n.resolution)).execute();break;case r.f:(a=new k(e,n.event,n.pattern)).execute();break;case r.k:(a=new j(e,n.event,n.newStep)).execute();break;case r.m:(a=new B(e,n.step,n.selection,n.eventType,n.track)).execute();break;case r.c:(a=new I(e,n.selection)).execute();break;case r.e:(a=new J(e,n.selection,n.eventType)).execute();break;case r.j:return(a=new G(n.track,n.pattern,n.startStep)).execute(),a;case r.o:return(a=new M(n.track,n.pattern,n.step)).execute(),a;case r.l:return(a=new K(n.track,n.pattern,n.step)).execute(),a;case r.d:return(a=new X(n.track,n.pattern)).execute(),a;case r.n:return(a=new Q(n.pattern,n.direction,n.resizedStep)).execute(),a;default:return}return n.event?n.event.parentEvent?(e.updateTypeRedux(n.event.parentEvent.getType()),e.prune(n.event.parentEvent.getType())):(e.updateTypeRedux(n.event.getType()),e.prune(n.event.getType())):e.updateAllTypeRedux(),a}n.d(t,"a",function(){return Y})},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(9),a=n(2),i=n(4),o=Object.keys,s=new(function(){function e(){Object(a.a)(this,e),this.nameToParameters={},this.tagToParameters={}}return Object(i.a)(e,[{key:"newParameter",value:function(e,t,n){var r=this;this.nameToParameters[e]||(this.nameToParameters[e]=[]),this.nameToParameters[e].push(n),t&&t.forEach(function(e){r.tagToParameters[e]||(r.tagToParameters[e]={}),r.tagToParameters[e].push(n)})}},{key:"deleteParameter",value:function(e){for(var t in this.nameToParameters)if(this.nameToParameters[t].includes(e)){this.nameToParameters[t]=this.nameToParameters[t].filter(function(t){return t!==e});break}for(var n in this.tagToParameters)if(this.tagToParameters[n].includes(e)){this.tagToParameters[n]=this.tagToParameters[n].filter(function(t){return t!==e});break}}},{key:"search",value:function(e){var t=this,n=o(this.nameToParameters).filter(function(t){return t.toLowerCase().includes(e.toLowerCase())}).flatMap(function(e){return t.nameToParameters[e]}),a=o(this.tagToParameters).filter(function(t){return t.toLowerCase().includes(e.toLowerCase())}).flatMap(function(e){return t.tagToParameters[e]});return[].concat(Object(r.a)(n),Object(r.a)(a))}},{key:"getAllParameters",value:function(){return Object.values(this.nameToParameters).flatMap(function(e){return e})}}]),e}());window.parameterIndex=s},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=n(43);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(e){Object(s.a)(n,e);var t=h(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this)).parameter=e,i.parameterValue=r,i}return Object(i.a)(n,[{key:"getCopy",value:function(){return(new n).fromJson(this.getJson())}},{key:"isSkippable",value:function(){return!0}},{key:"executeEvent",value:function(e){this.parameter&&this.parameter.set(this.parameterValue,!0)}},{key:"getJson",value:function(){if(void 0!==this.parameter)return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{parameter:this.parameter.getJson(),value:this.parameterValue})}},{key:"getType",value:function(){return f.h}},{key:"fromJson",value:function(e,t){if(Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.parameter=t.getParameterFromJson(e.parameter),this.parameterValue=e.value,void 0!==this.parameter)return this}}]),n}(l.a);t.a=p},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=n(15),h=n.n(f),p=n(43);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var m=function(e){Object(s.a)(n,e);var t=d(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this)).subSequence=e,i.volume=r,i}return Object(i.a)(n,[{key:"setValue",value:function(e){this.volume=e}},{key:"getValue",value:function(){return this.volume}},{key:"isSkippable",value:function(){return!1}},{key:"executeEvent",value:function(e,t){if(void 0!==t&&void 0!==this.subSequence&&void 0!==this.subSequence.linearRampFade){var n=(t.step-this.step)*new h.a.Time("32n").toMilliseconds()/1e3;this.subSequence.linearRampFade(Math.max(0,this.value),Math.max(0,t.volume),n)}}},{key:"getType",value:function(){return p.l}},{key:"getCopy",value:function(e){return(new n).fromJson(this.getJson(),e)}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{subSequence:this.subSequence.id,volume:this.volume})}},{key:"fromJson",value:function(e,t){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.subSequence=t.getSubSequence(e.subSequence),this.volume=e.volume,this}}]),n}(l.a);t.a=m},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=(n(15),n(43));function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(e){Object(s.a)(n,e);var t=h(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this)).track=e,i.solo=r,i}return Object(i.a)(n,[{key:"isSkippable",value:function(){return!1}},{key:"executeEvent",value:function(e){this.subSequence.tracks[this.track.trackNumber].solo(this.solo,!0)}},{key:"getType",value:function(){return f.p}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{trackNumber:this.track.trackNumber,solo:this.solo})}},{key:"fromJson",value:function(e,t){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.track=t.tracks[e.trackNumber],this.solo=e.solo,this}}]),n}(l.a);t.a=p},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(165),f=(n(15),n(43));function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(e){Object(s.a)(n,e);var t=h(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this)).track=e,i.reverse=r,i}return Object(i.a)(n,[{key:"isSkippable",value:function(){return!1}},{key:"executeEvent",value:function(e){this.subSequence.tracks[this.track.trackNumber].reverse(this.reverse,!0)}},{key:"getType",value:function(){return f.n}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{trackNumber:this.track.trackNumber,reverse:this.reverse})}},{key:"fromJson",value:function(e,t){return Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e),this.track=t.tracks[e.trackNumber],this.reverse=e.reverse,this}}]),n}(l.a);t.a=p},function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u});var r=n(648),a=n(623),i=n(438),o=n(294),s=n(89),c={"Roll Effect":function(e){return new i.a(e)},Macros:function(e){return new r.a(e)},Playhead:function(e){return new o.a(e)}};function u(e,t){return e.effect===s.f?new i.a(t):e.effect===s.c?new r.a(t):e.effect===s.d?new a.a(t):e.effect===s.e?new o.a(t):void 0}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(39),h=n.n(f),p=(n(1374),n(884)),d=n(893);n(458);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var v=function(e){Object(i.a)(n,e);var t=m(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={selectedLFO:0},a}return Object(a.a)(n,[{key:"getLFOOptions",value:function(){return[{value:0,label:"LFO 1"},{value:1,label:"LFO 2"},{value:2,label:"LFO 3"},{value:3,label:"LFO 4"}]}},{key:"getLFOOption",value:function(e){for(var t=this.getLFOOptions(),n=0;n<t.length;n++)if(t[n].value==e)return t[n];return null}},{key:"onSelectLFO",value:function(e){this.setState({selectedLFO:e.value})}},{key:"onChangeSynced",value:function(e){this.getLFO().isSynced="unsynced"===e,this.setState(this.state)}},{key:"getLFO",value:function(){return this.props.instrument.lfos[this.state.selectedLFO]}},{key:"render",value:function(){var e=this,t=this.getLFO();return u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name lfo-subsection-name colored-lfo-name-"+this.state.selectedLFO},"LFO"),u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(h.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getLFOOptions(),onChange:function(t){return e.onSelectLFO(t)},value:this.getLFOOption(this.state.selectedLFO),placeholder:"LFO"})),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(d.a,{lfo:t}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"refined-checkbox-preferences"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:t.isSynced?"synced":"unsynced",checked:t.isSynced,onChange:function(t){return e.onChangeSynced(t.target.value)}}),"Synced")),t.isSynced?u.a.createElement(p.a,{lfo:t}):u.a.createElement(l.a,{effectNumber:0,name:"Rate",parameter:t.lfoRateParameter,onParameterChanged:function(){return[]},isParameter:!0,step:.1,min:0,max:32}),u.a.createElement(l.a,{effectNumber:0,name:"Min",parameter:t.lfoMinParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}),u.a.createElement(l.a,{effectNumber:0,name:"Max",parameter:t.lfoMaxParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}))}}]),n}(c.Component);t.a=v},,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(85),l=n(1351),f=n(21);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var p=function(e){Object(o.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Midi Outputter",e)).trackOutputParameter=new f.a("trackOutput",Object(i.a)(a),function(e,t){return t},{min:0,max:16,unit:"",defaultValue:void 0}),a.registerParameter(a.trackOutputParameter),a.probabilityParameter=new f.a("probability",Object(i.a)(a),function(e,t){return t},{min:0,max:100,unit:"",defaultValue:100}),a.registerParameter(a.probabilityParameter),a}return Object(a.a)(n,[{key:"documentation",get:function(){return"Routes triggers from this track to another track."}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"getAvailableParameters",value:function(){return[this.track.trackData.durationParameter,this.track.trackData.chopParameter,this.track.trackData.velocityParameter,this.track.trackData.transposeParameter,this.track.trackData.attackParameter,this.track.trackData.releaseParameter,this.track.trackData.pitchAttackParameter,this.track.trackData.pitchDecayParameter,this.track.trackData.pitchSustainParameter,this.track.trackData.pitchReleaseParameter]}},{key:"trackOutput",get:function(){return this.trackOutputParameter.get()},set:function(e){this.trackOutputParameter.set(e)}},{key:"probability",get:function(){return this.probabilityParameter.get()},set:function(e){this.probabilityParameter.set(e)}},{key:"getTrack",value:function(){return this.track.subSequence.tracks[Math.round(this.trackOutput)]}},{key:"getVisualizedParameters",value:function(){return[this.trackOutputParameter]}},{key:"getText",value:function(){var e=this.getTrack();if(e)return e.trackNumber+1+". "+Object(l.a)(e)}},{key:"output",value:function(e,t,n){if(Math.random()<this.probability/100&&this.trackOutput){var r=this.track.subSequence.tracks[Math.round(this.trackOutput)];if(void 0===r||r===this.track)return this.triggers;for(var a in r.onNewStep(),this.triggers)r.midiEffects.input(this.getStep(this.triggers[a].stepData,void 0,void 0,!0),this.triggers[a].time,n);var i=r.midiEffects.output(e,t,n);r.otherTriggerCount=i.length,i.forEach(function(e){return r.trigger(e.stepData,e.time)}),r.onStepEnded(e,t)}return this.triggers}}]),n}(u.a);t.a=p},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(20),s=n(7),c=n(10),u=n(1),l=n(85),f=(n(61),n(101),n(221),n(21)),h=(n(33),n(256),n(430)),p=n(15);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}new(n.n(p).a.Time)("32n");var m=function(e){Object(s.a)(n,e);var t=d(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Chord Sculptor",e)).liveTriggers=[],r.linesParameter=new f.a("lines",Object(o.a)(r),function(e,t){return r.lines=t},{defaultValue:[],min:[],max:[],unit:""}),r.registerParameter(r.linesParameter),r.effects=[],r.rawLines=[],r}return Object(i.a)(n,[{key:"clear",value:function(){this.effects.forEach(function(e){return e.clear()})}},{key:"onNewStep",value:function(){this.effects.forEach(function(e){return e.onNewStep()})}},{key:"removeNote",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!this.gated;this.effects.forEach(function(r){return r.removeNote(e,t,n)})}},{key:"isRealTime",value:function(){return!1}},{key:"lines",set:function(e){this.rawLines=e;var t=[];for(var n in e){var r=e[n],a=r.x1,i=r.y1,o=r.x2,s=r.y2,c=r.brightness,u=Math.abs(Math.ceil(16*(o-a))),l=8*i,f=8*s,p=4*(a+o)/2,d=c||1,m=new h.a(this.track);m.evenDelayTimeParameter.set(l),m.oddDelayTimeParameter.set(f),m.repeatsParameter.set(u),m.durationFactorParameter.set(p),m.velocityParameter.set(d),t.push(m)}this.effects=t}},{key:"input",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.effects.forEach(function(n){return n.input(e,t)})}},{key:"output",value:function(e,t,n){var a=[];for(var i in this.effects)a=[].concat(Object(r.a)(a),Object(r.a)(this.effects[i].output(e,t,n)));return a}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(l.a);t.a=m},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={"MIDI Mix":{note:{0:{PATTERN_SWITCH:1,SEQUENCE_ROLL:3,PREVIOUS_PATTERN:25,NEXT_PATTERN:26},1:{PATTERN_SWITCH:4,SEQUENCE_ROLL:6},2:{PATTERN_SWITCH:7,SEQUENCE_ROLL:9},3:{PATTERN_SWITCH:10,SEQUENCE_ROLL:12},4:{PATTERN_SWITCH:13,SEQUENCE_ROLL:15},5:{PATTERN_SWITCH:16,SEQUENCE_ROLL:18},6:{PATTERN_SWITCH:19,SEQUENCE_ROLL:21},7:{PATTERN_SWITCH:22,SEQUENCE_ROLL:24}},cc:{0:{KNOB_1:16,KNOB_2:17,KNOB_3:18,VOLUME:19},1:{KNOB_1:20,KNOB_2:21,KNOB_3:22,VOLUME:23},2:{KNOB_1:24,KNOB_2:25,KNOB_3:26,VOLUME:27},3:{KNOB_1:28,KNOB_2:29,KNOB_3:30,VOLUME:31},4:{KNOB_1:46,KNOB_2:47,KNOB_3:48,VOLUME:49},5:{KNOB_1:50,KNOB_2:51,KNOB_3:52,VOLUME:53},6:{KNOB_1:54,KNOB_2:55,KNOB_3:56,VOLUME:57},7:{KNOB_1:58,KNOB_2:59,KNOB_3:60,VOLUME:61},MASTER:62}},"Komplete Kontrol M DAW":{actions:{PLAY:94,RECORD:95,CLEAR:93}},"MPD218 Port A":{ccActions:{CHANGE_SELECTED_TRACK:3,BROWSE_SOUNDS:9,CHANGE_START_SLICE:12,CHANGE_END_SLICE:13,CHANGE_TRANSPOSE:15,CHANGE_VOLUME:14}}}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=(n(0),n(101)),l=n(85),f=n(21);n(33);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var p=function(e){Object(o.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Midi Delay",e)).delayTimeParameter=new f.a("delayTime",Object(i.a)(a),function(e,t){return t},{documentation:"The size of the delay in 1/32th notes.",min:1,max:64,unit:"",defaultValue:1}),a.registerParameter(a.delayTimeParameter),a.repeatsParameter=new f.a("repeats",Object(i.a)(a),function(e,t){return[]},{documentation:"The number of additional repeats that will be triggered for each trigger.",defaultValue:1,min:1,max:32,unit:"bars"}),a.registerParameter(a.repeatsParameter),a.wetParameter=new f.a("wet",Object(i.a)(a),function(e,t){return t},{documentation:"Controls the velocity of the delayed triggers vs. the original triggers.",min:0,max:1,unit:"",defaultValue:.5}),a.registerParameter(a.wetParameter),a.delays=[],a}return Object(a.a)(n,[{key:"getVisualizedParameters",value:function(){return[this.delayTimeParameter,this.repeatsParameter]}},{key:"getText",value:function(){return this.delayTime+", "+this.repeats}},{key:"documentation",get:function(){return"A delay-style midi effect that triggers the track at the given delayed rate."}},{key:"onNewStep",value:function(){this.triggers=[]}},{key:"clear",value:function(){this.triggers=[],this.delays=[]}},{key:"wet",get:function(){return this.wetParameter.get()}},{key:"repeats",get:function(){return this.repeatsParameter.get()}},{key:"delayTime",get:function(){return this.delayTimeParameter.get()},set:function(e){this.delayTimeParameter.set(e)}},{key:"input",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.delays.length>8&&(this.delays=this.delays.slice(this.delays.length-8)),this.delays.push({stepNumber:e.stepNumber,trigger:this.copyTrigger(e),repeats:0,elapsed:0}),this.triggers.push(this.copyTrigger(e))}},{key:"output",value:function(e,t,n){var r=[],a=[];for(var i in this.delays){var o=this.delays[i];if(o.elapsed++,this.shouldPlayDelay(t,o)){var s=this.getStep(o.trigger.stepData,void 0,void 0,!1);s.velocity=s.velocity*(this.repeats-o.repeats)/this.repeats,s.velocity*=this.wet;var c=new u.a(s,e,t);if(s.velocity>0&&r.push(c),o.repeats++,o.repeats>=this.repeats)continue}a.push(o)}var l=this.triggers;for(var f in l){var h=this.getStep(l[f].stepData,void 0,void 0,!0);h.velocity*=1-this.wet,l[f].stepData=h}return r=r.concat(l),this.delays=a,r}},{key:"shouldPlayDelay",value:function(e,t){var n=t.elapsed-1;return 0!==n&&n%Math.floor(this.delayTime)===0}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(l.a);t.a=p},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(85);n(21);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var h=function(e){Object(s.a)(n,e);var t=f(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Alternate Tuning",e)).tuningMappings={0:.1,1:.5,2:.8,3:.9,4:1.2,5:1.5,6:2.3,7:2.9,8:3.3,9:4.2,10:5.1,11:7},r}return Object(i.a)(n,[{key:"documentation",get:function(){return"Maps each note (i.e. the transpose) to a different note. "}},{key:"output",value:function(){for(var e in this.triggers){var t=this.triggers[e].stepData.duration,n=this.getStep(this.triggers[e].stepData,this.getTranspose(this.triggers[e].stepData.transpose),this.triggers[e].stepData.duration,!1);n.duration=null===t?void 0:t,this.triggers[e].stepData=n}return this.triggers}},{key:"getTranspose",value:function(e){var t=12*Math.floor(e/12);return(e%=12)<0&&(e=12+e),e in this.tuningMappings?t+this.tuningMappings[e]:e}},{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{tuningMappings:this.tuningMappings})}},{key:"fromJson",value:function(e,t){Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t),this.tuningMappings=e.tuningMappings}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(l.a);t.a=h},function(e,t,n){"use strict";var r=n(8),a=n(9),i=n(2),o=n(4),s=n(20),c=n(16),u=n(7),l=n(10),f=n(1),h=n(85),p=n(50),d=n(57),m=n(378),v=(n(101),n(21)),b=n(102);function g(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var O=function(e){Object(u.a)(n,e);var t=k(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,"Every",e)).everyParameter=new v.a("every",Object(s.a)(r),function(e,t){return t},{documentation:"The size of the cycle in triggers.",min:1,max:32,unit:"",defaultValue:2}),r.registerParameter(r.everyParameter),r.offsetParameter=new v.a("offset",Object(s.a)(r),function(e,t){return t},{documentation:"The number of triggers within a cycle before applying the parameter change",min:0,max:8,unit:"",defaultValue:0}),r.registerParameter(r.offsetParameter),r.gateParameter=new v.a("gate",Object(s.a)(r),function(e,t){return t},{min:0,max:1,unit:"",defaultValue:1}),r.registerParameter(r.gateParameter),r.gateProbabilityParameter=new v.a("gateProbability",Object(s.a)(r),function(e,t){return t},{min:0,max:100,unit:"",defaultValue:100}),r.registerParameter(r.gateProbabilityParameter),r.parameterEffects=[],r.counter=0,r.newInlet(p.h,function(){return r.onReset()}),r.newOutlet(p.c),r}return Object(o.a)(n,[{key:"onReset",value:function(){this.counter=0}},{key:"getVisualizedParameters",value:function(){return[this.everyParameter]}},{key:"getText",value:function(){return this.everyParameter.get()}},{key:"documentation",get:function(){return"Alters a parameter every x many triggers."}},{key:"deleteParameterizer",value:function(e){var t=this.parameterEffects.indexOf(e);this.parameterEffects.splice(t,1)}},{key:"newParameter",value:function(){var e=new m.a(this.track);return this.parameterEffects.push(e),e.registerContext((new d.a).forTrack(this.track)),e.registerMixSession(this.track.mixSession),e.registerTrack(this.track),e}},{key:"getParameters",value:function(){var e,t=Object(c.a)(Object(f.a)(n.prototype),"getParameters",this).call(this),r=g(this.parameterEffects);try{for(r.s();!(e=r.n()).done;){var i=e.value;t=[].concat(Object(a.a)(t),Object(a.a)(i.getParameters()))}}catch(o){r.e(o)}finally{r.f()}return t}},{key:"every",get:function(){return Math.round(this.everyParameter.get())},set:function(e){this.everyParameter.set(e)}},{key:"offset",get:function(){return Math.round(this.offsetParameter.get())},set:function(e){this.offsetParameter.set(e)}},{key:"gate",get:function(){return Math.round(this.gateParameter.get())}},{key:"gateProbability",get:function(){return this.gateProbabilityParameter.get()}},{key:"onNewStep",value:function(){this.triggers=[],this.parameterEffects.forEach(function(e){return e.onNewStep()})}},{key:"clear",value:function(){this.counter=0,this.triggers=[],this.parameterEffects.forEach(function(e){return e.clear()})}},{key:"output",value:function(){var e=this;if(0===this.triggers.length)return this.triggers;if(this.counter++%this.every!==this.offset)return this.triggers;if(!(this.gate&&100*Math.random()<=this.gateProbability))return[];this.sendMessage(p.c,0);var t=this.triggers,n=function(n){var r=e.parameterEffects[n];t.forEach(function(e){return r.input(e)}),t=r.output()};for(var r in this.parameterEffects)n(r);return t}},{key:"getJson",value:function(){return Object(r.a)({},Object(c.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{parameterEffects:this.parameterEffects.map(function(e){return e.getJson()})})}},{key:"fromJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Object(c.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t);for(var i in e.parameterEffects){var o=new m.a(this.track);a=Object(r.a)({},a,o.fromJson(e.parameterEffects[i],t)),this.parameterEffects.push(o),o.registerContext((new d.a).forTrack(this.track)),o.registerMixSession(this.track.mixSession),o.registerTrack(this.track)}return a}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(Object(b.a)(h.a));t.a=O},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=n(172),f=n(17);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Alternate N",e)).newVar("steps",16,1,64),a.newVar("outputs",2,1,8),a.clear(),a}return Object(a.a)(n,[{key:"value",get:function(){return this.outputsParameter.get()},set:function(e){this.outputsParameter.set(e)}},{key:"documentation",get:function(){return["Alternates between the outputs of this effect every few steps."]}},{key:"numberOfOutputs",get:function(){if(this.outputsParameter){var e=Math.floor(this.var("outputs")());return isNaN(e)?2:e}return 2},set:function(e){}},{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){for(var e=[],t=0;t<this.numberOfOutputs;t++)e.push(Object(f.O)(t));this.myScript=Object(u.a)(l.b.apply(void 0,[this.var("steps")].concat(e)))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=p},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(17),a=n(72);Object(a.a)("density",{windowSize:"The number of steps that we look back from to calculate the density"},"Calculates the number of triggers received in the last windowSize-many steps");var i=function(e){var t=[],n=void 0;return function(a,i,o){for(var s=n+2;s<i;s+=2)t.shift();var c=Object(r.A)(e,a,i,o);if(i!==n)for(;t.length>c;)t.shift();var u=t.filter(function(e){return e}).map(function(e){return e.chop}).reduce(function(e,t){return e+t},0);return t.push(a),n=i,u}}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(56),l=n(15),f=n.n(l),h=n(41);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var d=function(e){Object(o.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Stereo Widener",function(){return new f.a.StereoWidener(.5)},e)).widthParameter=new h.c("Width",a.effectNode.width,{min:0,max:1,defaultValue:.5}),a.registerParameter(a.widthParameter),a.updateInitialValues(),a}return Object(a.a)(n,[{key:"getJson",value:function(){var e=Object(i.a)(Object(c.a)(n.prototype),"getJson",this).call(this);return e.width=this.widthParameter.get(),e=this.saveParameterToJson(e,"widthParameter",this.widthParameter)}},{key:"fromJson",value:function(e,t){Object(i.a)(Object(c.a)(n.prototype),"fromJson",this).call(this,e,t),this.widthParameter.set(e.width),this.loadParameterFromJson(e,"widthParameter",this.widthParameter,t)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(u.a.Effect);t.a=d},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(15),f=n.n(l),h=n(32),p=n(56),d=n(41);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Chebyshev",function(){return new f.a.Chebyshev(1)},e)).effectNode.oversampling="none",r.orderParameter=new d.a("Order",r.effectNode,function(e,t){return e.order=t},{min:1,max:100,unit:"",defaultValue:1}),r.registerParameter(r.orderParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"getJson",value:function(e){var t=Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this);return t.order=this.effectNode.order,t.enabled=this.enabledParameter.get(),t.wet=this.effectNode.wet.value,t.name=this.name,t=this.saveParameterToJson(t,"orderParameter",this.orderParameter,e)}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(h.a)(this.orderParameter,e.order,a),e.enabled&&this.enable(!0),this.setValue(e.value),Object(r.a)({},a,this.loadParameterFromJson(e,"orderParameter",this.orderParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(p.a.Effect);t.a=v},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(15),f=n.n(l),h=n(56),p=n(41);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var m=function(e){Object(s.a)(n,e);var t=d(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Bit Crusher",function(){return new f.a.BitCrusher(8)},e)).bitsParameter=new p.a("Bits",r.effectNode,function(e,t){return e.bits=t},{min:1,max:8,unit:"",defaultValue:8}),r.registerParameter(r.bitsParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"getJson",value:function(e){var t=Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this);return t.bits=this.bitsParameter.get(),t.name=this.name,this.saveParameterToJson(t,"bitsParameter",this.bitsParameter,e)}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return this.effectNode.bits=e.bits,this.effectNode.wet.value=e.wet,e.enabled&&this.enable(!0),Object(r.a)({},a,this.loadParameterFromJson(e,"bitsParameter",this.bitsParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(h.a.Effect);t.a=m},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(15),f=n.n(l),h=n(32),p=n(56),d=n(41);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Distortion",function(){return new f.a.Distortion(.4)},e)).effectNode.oversampling="4x",r.distortionParameter=new d.a("Distortion",r.effectNode,function(e,t){return e.distortion=t},{min:0,max:1,unit:"%",defaultValue:.1}),r.registerParameter(r.distortionParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"getJson",value:function(){var e=Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this);return e.distortion=this.effectNode.distortion,e.enabled=this.enabledParameter.get(),e.wet=this.effectNode.wet.value,e.name=this.name,(this.distortionParameter.isConnectedToAnyModulator()||Object.keys(this.distortionParameter.patternToValue).length>0)&&(e.distortionParameter=this.distortionParameter.getJson()),e}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(h.a)(this.distortionParameter,e.distortion,a),e.enabled&&this.enable(!0),this.setValue(e.value),Object(r.a)({},a,this.loadParameterFromJson(e,"distortionParameter",this.distortionParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(p.a.Effect);t.a=v},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(15),f=n.n(l),h=n(32),p=n(56),d=(n(41),n(21));function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Pitch Shift",function(){return new f.a.PitchShift(0)},e)).pitchParameter=new d.a("Pitch",r.effectNode,function(e,t){e&&(e.pitch=t)},{min:-24,max:24,unit:"",defaultValue:12}),r.registerParameter(r.pitchParameter),r.windowSizeParameter=new d.a("Window Size",r.effectNode,function(e,t){e&&(e.windowSize=t)},{min:.01,max:.5,unit:"",defaultValue:.03}),r.registerParameter(r.windowSizeParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"getJson",value:function(){var e=Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this);return e.pitch=this.pitchParameter.get(!0),e.windowSize=this.windowSizeParameter.get(!0),e.enabled=this.enabledParameter.get(!0),e.wet=this.effectNode.wet.value,e.name=this.name,e=this.saveParameterToJson(e,"pitchParameter",this.pitchParameter),e=this.saveParameterToJson(e,"windowSizeParameter",this.windowSizeParameter)}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(h.a)(this.pitchParameter,e.pitch,a),Object(h.a)(this.windowSizeParameter,e.windowSize,a),e.enabled&&this.enable(!0),this.setValue(e.value),Object(r.a)({},a,this.loadParameterFromJson(e,"pitchParameter",this.pitchParameter,t),this.loadParameterFromJson(e,"windowSizeParameter",this.windowSizeParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(p.a.Effect);t.a=v},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(15),f=n.n(l),h=(n(6),n(131)),p=n(32),d=n(56),m=n(41);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var b=function(e){Object(s.a)(n,e);var t=v(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Panner",function(){return new f.a.Panner(0)},e)).panningParameter=new m.c("Panning",r.effectNode._panner.pan,{min:-1,log:!0,max:1,unit:"",defaultValue:0,automationRate:h.a,noInput:!0}),r.registerParameter(r.panningParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"getJson",value:function(){var e=Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this);return e.panning=this.panningParameter.get(!0),e.enabled=this.enabledParameter.get(!0),e.name=this.name,e=this.saveParameterToJson(e,"panningParameter",this.panningParameter)}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(p.a)(this.panningParameter,e.panning,a),e.enabled&&this.enable(!0),Object(r.a)({},a,this.loadParameterFromJson(e,"panningParameter",this.panningParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(d.a.Effect);t.a=b},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(21);function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}t.a=function(e){return function(e){Object(i.a)(n,e);var t=u(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"setupTrackParameter",value:function(){var e=this;this.trackParameter=new c.b("track",this,function(t,n){e.onChangeTrack(n)},{defaultValue:-1,min:0,max:10,isAutomatable:!1}),this._track=void 0}},{key:"onChangeTrack",value:function(e){this._track=-1!==e?this.sequencerEngine.tracks[e]:void 0}},{key:"getTrack",value:function(){var e=this.trackParameter.get();if(-1!==e)return this.sequencerEngine.tracks[e]}}]),n}(e)}},function(e,t,n){"use strict";var r=n(8),a=n(9),i=n(2),o=n(4),s=n(16),c=n(7),u=n(10),l=n(1),f=n(381),h=n(6),p=(n(62),n(57),n(89));function d(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var b=function(e){Object(c.a)(n,e);var t=v(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,"Palettes",p.d,e)).palettes=[0,1],r}return Object(o.a)(n,[{key:"newPalette",value:function(){this.palettes=[].concat(Object(a.a)(this.palettes),[this.palettes.length])}},{key:"selectedPalette",get:function(){return this.track.sequencerEngine.state.effects.selectedPalettes[this.track.id]}},{key:"sequencedPalette",get:function(){return this.track.sequencerEngine.state.effects.sequencedPalettes[this.track.id]}},{key:"switchToPalette",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sequencedPalette,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={};e=null===e?void 0:e,r&&this.track.store.dispatch(Object(h.gf)(this.track.id,e)),this.track.store.dispatch(Object(h.Bf)(this.track.id,e));var i,o=d(this.track.getAllParameters().filter(function(n){return void 0===e&&void 0!==n.paletteToValue[t]||void 0===t&&void 0!==n.paletteToValue[e]||n.paletteToValue[e]!==n.paletteToValue[t]}));try{for(o.s();!(i=o.n()).done;){var s=i.value,c=s.set(s.getPaletteValue(e),!0,!0,n);c&&(a[c.id]=c.value)}}catch(u){o.e(u)}finally{o.f()}this.track.store.dispatch(Object(h.Vb)(a))}},{key:"getJson",value:function(){return Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{palettes:this.palettes})}},{key:"fromJson",value:function(e){Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e),this.palettes=e.palettes}},{key:"getCopy",value:function(){var e=new n(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.track);return e.fromJson(this.getJson()),e}}]),n}(f.a);t.a=b},function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return f});var r=n(11),a=n(9),i=n(1497),o=n(533),s=n(553);function c(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}window.rasterTimes=[];var l=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,o=f(e,n,r),u=new i.a,l=[],h=-1,p=c(o);try{for(p.s();!(t=p.n()).done;){var d=t.value;d.x=Math.round(d.x),d.y=Math.round(d.y);var m=(u.noise2D(d.x,d.y)+1)/2;d.dist=m,Math.random()<1&&(m=Math.min(d.distX,d.distY)/n,d.dist=m),m>h&&(h=m),l.push(d)}}catch(O){p.e(O)}finally{p.f()}for(var v=Object(s.c)(l,n),b=[],g=[],y=2;y<Math.max(8,h);y+=1){var k=Object(s.a)(v,y);b=[].concat(Object(a.a)(b),Object(a.a)(k)),g=[].concat(Object(a.a)(g),Object(a.a)(Object(s.b)(k)))}return{triangles:v,points:l,segments:b,contours:b}},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=((new Date).getTime(),e=Object(o.a)(e)),s=Object(r.a)(i,6),c=s[0],u=s[1],l=s[2],f=s[3],m=s[4],g=s[5];if(f===g)return p(e,t,n);if(u===f)return d(e,t,n);var y=Math.round(c+(f-u)/(g-u)*(m-c)),k=Math.round(f),O=[l,f,y,k,m,g];O=Object(o.a)(O);var j=d(O,t,!0,u),w=j[j.length-1],E=h(c,u,l,f,y,k,w),S=Object(r.a)(E,2),P=[c,u,l=S[0],f=w,y=S[1],k=w];P=Object(o.a)(P);var x=v(j,w);return[].concat(Object(a.a)(b(j,w)),Object(a.a)(p(P,t,x,g)))},h=function(e,t,n,r,a,i,o){return[e-(t-o)/((t-r)/(e-n)),e-(t-o)/((t-i)/(e-a))]},p=function(e,t,n,i){var o=Object(r.a)(e,6),s=o[0],c=o[1],u=o[2],l=o[3],f=o[4],h=(u-s)/(l-c),p=(f-s)/(o[5]-c),d=u,v=f,b=0,y=[];n=g(n||d,t),i=g(i||l);for(var k=l;k>c;k--){Math.abs(c-k),Math.abs(k-l);if(b%t===0){var O=m(d,k,v,k,t,n,i);y=[].concat(Object(a.a)(y),Object(a.a)(O))}if(d-=h,v-=p,++b>1e4)break}return y},d=function(e,t){for(var n=Object(r.a)(e,6),i=n[0],o=n[1],s=n[2],c=n[3],u=n[4],l=n[5],f=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=arguments.length>3?arguments[3]:void 0,p=(u-i)/(l-o),d=(u-s)/(l-c),v=u,b=u,y=[],k=0,O=g(v,t),j=g(l,t),w=g(l,t),E=!0;E;w--){Math.abs(h-w),Math.abs(l-w);if(k%t===0){if(w<=o){if(!f)break;E=!1}var S=m(v,w,b,w,t,O,j);y=[].concat(Object(a.a)(y),Object(a.a)(S))}if(v-=p,b-=d,++k>1e4)break}return y},m=function(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,i=arguments.length>5?arguments[5]:void 0,o=(arguments.length>6&&arguments[6],e);i>e;)i-=a;e=Math.round(i),t=Math.round(t),n=Math.round(n),r=Math.round(r);for(var s=Math.abs(n-e),c=Math.abs(r-t),u=e<n?1:-1,l=t<r?1:-1,f=s-c,h=[],p=0;e!=n||t!=r;){if(p%a===0&&e>o){Math.abs(e-i),Math.abs(n-e);h.push(e),h.push(t)}var d=2*f;if(d>-c&&(f-=c,e+=u),d<s&&(f+=s,t+=l),++p>1e4)break}return h},v=function(e,t){for(var n=1e4,r=0;r<e.length;r+=2)e[r+1]===t&&e[r]<n&&(n=e[r]);return n},b=function(e,t){for(var n=[],r=0;r<e.length;r+=2)e[r+1]!==t&&(n.push(e[r]),n.push(e[r+1]));return n},g=function(e,t){return e-e%t}},function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});var r=n(28),a=(Object(r.a)({kick:"kick","hi-hat":"hi-hat",snare:"snare",clap:"clap",rim:"rim",tom:"tom",perc:"perc",breaks:"breaks",bass:"bass",sub:[["808","sub"]],keys:"keys"},"breaks","breaks"),{kick:"kick","hi-hat":"hi-hat",snare:"snare",clap:"clap",rim:"rim",tom:"tom",perc:"perc",sub:[["808","sub"]],breaks:"breaks"}),i=["kick","hi-hat","snare","clap","rim","tom","perc","sub","breaks","keys","808","synth","vocal","vox","bass","pluck","chord","fx"]},function(e,t,n){"use strict";var r=n(9),a=n(11),i=n(0),o=n.n(i),s=n(6),c=n(731),u=n(831),l=n(627),f=(n(38),n(832)),h=n(46),p=(n(560),n(205)),d=n(374),m=n(261),v=n(12);t.a=Object(v.b)(function(e,t){return{isFrozen:t.track.isFrozen,effectsLen:t.track.effects&&t.track.effects.length,midiEffectsLen:t.track.midiEffects.effects&&t.track.midiEffects.effects.length,liveEffects:t.track.liveEffects.effects&&t.track.liveEffects.effects.length,_audioFx:t.track.effects,_midiFx:t.track.midiEffects,_liveFx:t.track.liveEffects,panning:e.tracks.trackPannings[t.track.trackNumber]||0,pulledEffects:e.effects.pulledEffects}},function(e){return{setSelectedSteps:function(t){return e(Object(s.jf)(t))}}})(function(e){e.isFrozen;var t=e.sends,n=e.track,s=e.scrollContainer,v=e.sequencerEngine,b=e.panning,g=(e.hideLock,e._liveFx,e._audioFx,e._midiFx,e.isRack),y=e.pulledEffects,k=e.setSelectedSteps,O=Object(i.useRef)(void 0),j=Object(i.useState)(n.effects),w=Object(a.a)(j,2),E=w[0],S=w[1],P=Object(i.useState)(n.midiEffects.effects),x=Object(a.a)(P,2),T=x[0],C=x[1],N=Object(i.useState)(n.liveEffects.effects),R=Object(a.a)(N,2),M=R[0],A=R[1],q=n.getSendNodes(),D=Object(i.useCallback)(function(e){v.operationManager.dispatch(Object(h.b)(e,n)),C(Object(r.a)(n.midiEffects.effects))},[n,C]),I=Object(i.useCallback)(function(e){n.liveEffects.addEffect(e),A(Object(r.a)(n.liveEffects.effects))},[n,A]),_=Object(i.useCallback)(function(e){e.enable(!0),v.operationManager.dispatch(Object(h.b)(e,n)),S(Object(r.a)(n.effects))},[n,S]),F=Object(i.useCallback)(function(e){n.setPanning(e)},[n]),L=Object(i.useCallback)(function(){S(Object(r.a)(n.effects)),C(Object(r.a)(n.midiEffects.effects)),A(Object(r.a)(n.liveEffects.effects))},[n,S,C,A]);if(Object(i.useEffect)(function(){k([])},[]),void 0===E||void 0===M||void 0===T)return o.a.createElement("div",null);var B=v.tracks,z=function(){},V="effects-view";g&&(V+=" effects-view-instrument-rack");var H=n&&n.liveEffects&&n.liveEffects.effects||[],U=n&&n.midiEffects&&n.midiEffects.effects||[],J=n&&n.effects||[];return o.a.createElement("div",{ref:O,className:V},H.map(function(e,t){return o.a.createElement(d.a,{key:t,scrollContainer:[s,O],sequencerEngine:v,onDeleteEffect:L,isPulled:y.includes(e),effect:e,track:n,tracks:B,onEffectsChange:z})}),"",U.map(function(e,t){return o.a.createElement(p.a,{key:t,sequencerEngine:v,isPulled:y.includes(e),scrollContainer:[s,O],onDeleteEffect:L,effect:e,track:n,tracks:B,onEffectsChange:z})}),J.map(function(e,t){return o.a.createElement(m.a,{sequencerEngine:v,isPulled:y.includes(e),scrollContainer:[s,O],key:t,onDeleteEffect:L,effect:e,track:n,tracks:B,onEffectsChange:z})}),o.a.createElement(f.a,{track:n,sequencerEngine:v,addClassName:"add-track-effects-button",handleChooseMidiEffect:D,handleChooseLiveEffect:I,handleChooseEffect:_,store:v.store}),o.a.createElement("div",{className:"sends-and-options-container"},o.a.createElement("div",{className:"sends-container"},q.map(function(e,r){return o.a.createElement(u.a,{key:"track-send-"+r,track:n,sequencerEngine:v,sendNumber:r,send:t.getSends()[r],sendNode:e})}),o.a.createElement(l.a,{panning:b,onChangePanning:F})),n?o.a.createElement(c.a,{track:n}):""))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(90),f=n.n(l);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){return Object(r.a)(this,n),t.call(this,e)}return Object(a.a)(n,[{key:"render",value:function(){var e=this,t=void 0!==this.automation?"enabled effect effect-automation":"effect enabled";return u.a.createElement("div",{className:t},u.a.createElement("div",{className:"effect-name"},"Pan"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"parameter-box"},u.a.createElement(f.a,{value:this.props.panning,change:function(t){return e.props.onChangePanning(t.target.value)},step:.01,max:1,min:-1,orientation:"horizontal",reversed:!1})))}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=new(n(29).a);t.a=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.seedHash,n=e.className,r=void 0===n?"token-icon":n,i={};if(t){var s=o.saturate(o.getColorForHash(t),1),c=[s,o.compliment(s,1.1),o.compliment(s,1.2),o.compliment(s,1.3),o.compliment(s,1.4),o.compliment(s,1.5)];i={background:"radial-gradient(92% 75.29% at 2.96% 24.36%, ".concat(c[0]," 0.52%, ").concat(c[1]," 18.75%, ").concat(c[2]," 34.38%, ").concat(c[3]," 49.48%, ").concat(c[4]," 74.48%, ").concat(c[5]," 100%)")}}return a.a.createElement("div",{style:i,className:r})})},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(11),s=n(0),c=n.n(s),u=n(76),l=n(835),f=n(106),h=n(92),p=n(12),d=n(6);t.a=Object(p.b)(function(e,t){return{value:t.parameter.get(),hasAutomations:t.parameter.automations&&t.parameter.automations.length>0}},function(e){return{setShowPianoRoll:function(t){return e(Object(d.Wf)(t))},setShowAutomation:function(t){return e(Object(d.Hf)(t))},setTrackAutomationParameter:function(t,n){return e(Object(d.Ng)(t,n))},setBottomMode:function(t){return e(Object(d.D)(t))}}})(function(e){var t=e.name,n=e.value,r=e.className,p=e.parameter,d=e.hasAutomations,m=e.setShowPianoRoll,v=e.setBottomMode,b=e.setShowAutomation,g=e.setTrackAutomationParameter,y=Object(s.useState)(0),k=Object(o.a)(y,2),O=k[0],j=k[1],w=Object(s.useRef)(!1),E=Object(s.useRef)(0),S=Object(s.useCallback)(function(){if(b(!0),m(!0),v(f.d),p.track){var e=p.track.instrumentRack?p.track.instrumentRack:p.track;g(e.id,p)}},[p]),P=Object(s.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=l.length>1&&void 0!==l[1]?l[1]:1,r=t.clientY,j(r),E.current=0,w.current=n;case 5:if(!w.current){e.next=18;break}return i=Math.pow(E.current,2),E.current<0&&(i=-i),o=p.get(),s=Math.floor(o),c=Math.round(1e3*(o-s)),1===n?s=Math.round(s-i/40):c=Math.round(c-i/40),(u=s+c/1e3)>=0&&p.set(u),e.next=16,Object(h.a)(100);case 16:e.next=5;break;case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[p,j]),x=Object(s.useCallback)(function(e){w.current=void 0},[]),T=Object(s.useCallback)(function(e){w.current&&(E.current=e.clientY-O)},[O]),C=Math.floor(n),N=Math.round(1e3*(n-C));return c.a.createElement(u.a,{element:p,className:"fm-parameter "+r},c.a.createElement(l.a,{parameter:p}),c.a.createElement("div",null,t),c.a.createElement("div",{className:"values"},c.a.createElement("div",{onMouseDown:function(e){return P(e,1)},onMouseUp:x,onMouseLeave:x,onMouseMove:T,className:"whole-value"},C),c.a.createElement("div",{className:"dot-value"},"."),c.a.createElement("div",{onMouseDown:function(e){return P(e,2)},onMouseUp:x,onMouseLeave:x,onMouseMove:T,className:"decimal-value"},function(e){for(var t=e.toString();t.length<3;)t="0"+t;return t}(N))),d?c.a.createElement("img",{className:"automation-icon",onClick:S,src:"/automation-icon-disabled.png"}):"")})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(38);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={showMods:!1},a}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props.instrument;return u.a.createElement("div",{className:"instrument"},u.a.createElement("div",{className:"instrument-name"},this.props.instrument.getName()),u.a.createElement(f.a,{condition:!this.state.showMods},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"instrument-section"},u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Filter"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(l.a,{effectNumber:0,name:"Frequency",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:e.frequencyParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:4e3,step:1}),u.a.createElement(l.a,{effectNumber:0,name:"Resonance",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:e.resonanceParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:4e3,step:1}),u.a.createElement(l.a,{effectNumber:0,name:"Harmonicity",sequencerEngine:this.props.sequencerEngine,parameter:e.harmonicityParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:200,step:1e-4}),u.a.createElement(l.a,{effectNumber:0,name:"Modulation Index",sequencerEngine:this.props.sequencerEngine,parameter:e.modulationIndexParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:20,step:1e-4}))),u.a.createElement("div",{className:"instrument-section"},u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Amp/Filter Envelope"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(l.a,{effectNumber:0,name:"Attack",parameter:e.attackParameter,sequencerEngine:this.props.sequencerEngine,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,min:0,max:6e3,step:1}),u.a.createElement(l.a,{effectNumber:0,name:"Decay",sequencerEngine:this.props.sequencerEngine,parameter:e.decayParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:0,max:6e3,step:1}),u.a.createElement(l.a,{effectNumber:0,name:"Sustain",parameter:e.sustainParameter,onParameterChanged:function(){return[]},isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,min:0,max:1,step:.01}),u.a.createElement(l.a,{effectNumber:0,sequencerEngine:this.props.sequencerEngine,name:"Release",parameter:e.releaseParameter,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,min:0,max:1e4,step:1})))))}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(606),h=n(63),p=n(39),d=n.n(p);n(458);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var v=function(e){Object(i.a)(n,e);var t=m(n);function n(e){return Object(r.a)(this,n),t.call(this,e)}return Object(a.a)(n,[{key:"getOscillatorOptions",value:function(){return[{value:"square",label:"Square"},{value:"sine",label:"Sine"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"},{value:"pwm",label:"PWM"},{value:"pulse",label:"Pulse"}]}},{key:"getOscillatorOption",value:function(e){for(var t=this.getOscillatorOptions(),n=0;n<t.length;n++)if(t[n].value==e)return t[n];return null}},{key:"getSelectedOscillatorType",value:function(){return this.props.instrument.oscillatorType}},{key:"onSelectOscillatorType",value:function(e){var t="none"===e.value?void 0:e.value;this.props.instrument.oscillatorType=t,this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.props.instrument;this.props.instrument.lfos[0];return u.a.createElement("div",{className:"instrument synth"},u.a.createElement("div",{className:"instrument-name"},this.props.instrument.getName()),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"instrument-section"},u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Oscillator"),u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(d.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getOscillatorOptions(),onChange:function(t){return e.onSelectOscillatorType(t)},value:this.getOscillatorOption(this.getSelectedOscillatorType()),placeholder:"Osc. Type"})),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(l.a,{name:"Frequency",automation:this.props.automation,parameter:t.oscillatorFrequencyParameter,onParameterChanged:function(){return t.releaseAll()},displayFunction:function(e){return h.a.fromTranspose(e).toString()},isParameter:!0,min:-32,max:32,step:1}),u.a.createElement(l.a,{name:"Detune",lfoEnabled:!0,automation:this.props.automation,instrument:t,lfos:t.lfos,parameter:t.detuneParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}),u.a.createElement(l.a,{lfoEnabled:!0,lfos:t.lfos,instrument:t,automation:this.props.automation,name:"Pulse Width",parameter:t.pulseWidthParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1,step:.01}),u.a.createElement(l.a,{name:"Polyphony",automation:this.props.automation,parameter:t.polyphonyParameter,onParameterChanged:function(){return[]},isParameter:!0,min:1,max:16,step:1}),u.a.createElement(l.a,{name:"Glide",automation:this.props.automation,parameter:t.portamentoParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:50,step:.1})),u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Filter"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(l.a,{name:"Cutoff",lfoEnabled:!0,automation:this.props.automation,lfos:t.lfos,instrument:t,parameter:t.filterCutoffParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1e4,step:1}),u.a.createElement(l.a,{name:"Q",lfoEnabled:!0,automation:this.props.automation,lfos:t.lfos,instrument:t,parameter:t.filterQParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:9,step:1}))),u.a.createElement("div",{className:"instrument-section"},u.a.createElement(f.a,{instrument:t}),u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Amp Envelope"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(l.a,{automation:this.props.automation,name:"Amp Attack",lfoEnabled:!0,lfos:t.lfos,instrument:t,parameter:t.ampAttackParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:6e3,step:1}),u.a.createElement(l.a,{automation:this.props.automation,name:"Amp Decay",lfoEnabled:!0,lfos:t.lfos,instrument:t,parameter:t.ampDecayParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:6e3,step:1}),u.a.createElement(l.a,{name:"Amp Sustain",automation:this.props.automation,lfoEnabled:!0,lfos:t.lfos,instrument:t,parameter:t.ampSustainParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1,step:.01}),u.a.createElement(l.a,{name:"Amp Release",automation:this.props.automation,lfoEnabled:!0,lfos:t.lfos,instrument:t,parameter:t.ampReleaseParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1e4,step:1}))),u.a.createElement("div",{className:"instrument-section"},u.a.createElement(b,{automation:this.props.automation,instrument:t})))}}]),n}(c.Component),b=function(e){Object(i.a)(n,e);var t=m(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props.instrument.filterEnvelope;return u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Filter Envelope"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(l.a,{name:"Frequency",parameter:e.baseFrequencyParameter,automation:this.props.automation,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1e4,step:1}),u.a.createElement(l.a,{name:"Octaves",parameter:e.octavesParameter,automation:this.props.automation,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:8,step:.1}),u.a.createElement(l.a,{name:"Attack",parameter:e.attackParameter,automation:this.props.automation,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:8e3,step:1}),u.a.createElement(l.a,{name:"Decay",parameter:e.decayParameter,automation:this.props.automation,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:8e3,step:1}),u.a.createElement(l.a,{name:"Sustain",parameter:e.sustainParameter,automation:this.props.automation,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1,step:.01}),u.a.createElement(l.a,{name:"Release",automation:this.props.automation,parameter:e.releaseParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:8e3,step:1}))}}]),n}(c.Component);t.a=v},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(6),s=n(12),c=function(e){var t=e.isBest,n=e.isSelected,r=(e.group,e.variation,e.i),a=e.onClick,o="variation";return t&&(o+=" best"),n&&(o+=" selected"),i.a.createElement("div",{onClick:a,className:o},r+1)};t.a=Object(s.b)(function(e,t){return{}},function(e){return{setSelectedZObject:function(t){return e(Object(o.uf)(t))}}})(function(e){var t=e.group,n=e.setSelectedZObject,o=Object(a.useState)(t.generation),s=Object(r.a)(o,2),u=s[0],l=s[1],f=Object(a.useState)(t.selectedVariation),h=Object(r.a)(f,2),p=h[0],d=h[1],m=Object(a.useCallback)(function(){n(t)},[t]),v=Object(a.useCallback)(function(){t.reproduce(),l(t.generation)},[l,t]),b=Object(a.useCallback)(function(){t.unsupervised(64),l(t.generation)},[l,t]),g=Object(a.useCallback)(function(){t.clearGenetic(),l(t.generation)},[l,t]);Object(a.useEffect)(function(){d(void 0)},[u,d]),Object(a.useEffect)(function(){void 0!==p&&t.selectVariation(p)},[p]);var y=Object(a.useCallback)(function(e){t.selectBest(e),d(p===e?void 0:e)},[d,p]);Object(a.useEffect)(function(){return window.addEventListener("keydown",k),function(){return window.removeEventListener("keydown",k)}},[t,d,p]);var k=Object(a.useCallback)(function(e){0!==t.generation&&"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&("ArrowLeft"===e.key?(e.preventDefault(),d(void 0!==p?0===p?15:p-1:0),m()):"ArrowRight"===e.key?(e.preventDefault(),d(void 0!==p?(p+1)%16:0),m()):"Enter"===e.key&&(e.preventDefault(),e.ctrlKey?v():O(),m()))},[t,d,p]),O=Object(a.useCallback)(function(){void 0!==p&&(t.selectBest(p),d(void 0),d(p))},[p,d]);if(0===u)return i.a.createElement("div",{className:"genetic-btns"},i.a.createElement("div",{className:"genetic-label"},"Genetic:"),i.a.createElement("img",{src:"/generate-random.svg",onClick:v,className:"genetic-btn"}),i.a.createElement("img",{src:"/generate-from-snapshots.svg",onClick:b,className:"snapshot genetic-btn"}));var j=function(e){return e.map(function(e,n){return i.a.createElement(c,{onClick:function(){return y(t.variations.indexOf(e))},isSelected:p===t.variations.indexOf(e),isBest:t._bestSolutions.includes(t.variations.indexOf(e)),key:n,variation:e,i:t.variations.indexOf(e),group:t})})},w=t.variations;return i.a.createElement("div",{className:"genetic-algo"},i.a.createElement("div",{className:"generation"},i.a.createElement("div",{className:"generation-label"},"Generation: ",u),i.a.createElement("img",{src:"/generate-random.svg",onClick:v,className:"genetic-btn"}),i.a.createElement("div",{onClick:g,className:"breed-done genetic-btn"},i.a.createElement("div",{className:"inner-btn"}))),t.categories?i.a.createElement("div",{className:"variations"},i.a.createElement("div",{className:"elite"},i.a.createElement("div",{className:"label"},"Elite"),j(t.categories.elite)),i.a.createElement("div",{className:"children"},i.a.createElement("div",{className:"label"},"Children"),j(t.categories.children)),i.a.createElement("div",{className:"mutations"},i.a.createElement("div",{className:"label"},"Mutations"),j(t.categories.mutations))):i.a.createElement("div",{className:"variations"},w.map(function(e,n){return i.a.createElement(c,{onClick:function(){return y(n)},isSelected:p===n,isBest:t._bestSolutions.includes(n),key:n,variation:e,i:n,group:t})})))})},function(e,t,n){"use strict";var r=n(9),a=n(11),i=n(0),o=n.n(i),s=n(22),c=n(319),u=n(155),l=n(12);t.a=Object(l.b)(function(e,t){return{_snapshots:t.effect.snapshots,currentSnapshotIndex:t.effect.currentSnapshotParameter.get()}},function(e){return{}})(function(e){var t=e.isDraggable,n=void 0===t||t,l=e.effect,f=(e.currentSnapshot,e.currentSnapshotIndex),h=e._snapshots,p=Object(i.useState)(l.snapshots),d=Object(a.a)(p,2),m=d[0],v=d[1],b=Object(i.useState)(l.currentSnapshot),g=Object(a.a)(b,2),y=g[0],k=g[1];Object(i.useEffect)(function(){k(m[l.currentSnapshotParameter.get()])},[f,k]),Object(i.useEffect)(function(){h&&v(Object(r.a)(h))},[h]);var O=Object(i.useCallback)(function(){l.deleteAllSnapshots(),v([]),k(void 0)},[]),j=Object(i.useCallback)(function(){l.takeSnapshot(),v(Object(r.a)(l.snapshots)),k(l.currentSnapshot)},[v,l,k]),w=Object(i.useCallback)(function(e){var t=m.indexOf(e);l.currentSnapshotParameter.get()===t?l.currentSnapshotParameter.set(-1):l.currentSnapshotParameter.set(m.indexOf(e),!1)},[l,k,m]),E=Object(i.useCallback)(function(){l.deleteSnapshot(y),v(Object(r.a)(l.snapshots)),k(void 0)},[l,y,k,v]);return o.a.createElement(c.a,{isDraggable:n,effect:l,instrument:l.snapshotComponent,type:u.f,className:"snapshots-container"},o.a.createElement("div",{className:"snapshot-toolbar"},o.a.createElement(s.a,{parameter:l.currentSnapshotParameter,hideSlider:!0,name:"Snapshots"}),o.a.createElement("div",{onClick:j,className:"plane-snapshot-btn"},"+"),y?o.a.createElement("div",{onClick:E,className:"delete-snapshot plane-snapshot-btn"},"-"):"",o.a.createElement("div",{onClick:O,className:"delete-all"},"x")),o.a.createElement("div",{className:"snapshots-list"},m.map(function(e,t){return o.a.createElement("div",{key:t,onClick:function(){return w(e)},className:e===y?"snapshot current":"snapshot"},t+1)})))})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=n(83);t.a=Object(i.b)(function(e,t){return{immutable:t.tidal.cycleParameter.immutable,cycle:t.tidal.cycle,currentLeaves:t.tidal.currentLeaves}},function(e){return{}})(function(e){var t=e.tidal,n=e.cycle,r=e.currentLeaves,i=e.immutable,s=Object(o.d)(n,r,!0),c=s.spans,u=s.index,l=i?"immutable tidal-string":"tidal-string";return r&&r.some(function(e){return null!==e.transpose})&&(l+=" triggering"),a.a.createElement("div",{className:l},a.a.createElement("span",{className:"cycle-length"},t.cycleLength),a.a.createElement("div",{onClick:function(){return t.lockGroove(!i)},className:i?"immutable dot":"dot"}),c.map(function(e,t){return a.a.createElement("span",{keys:t,className:t===u?"str-part current":"str-part"},e)}))})},function(e,t,n){"use strict";var r=n(11),a=n(58),i=n(6),o=n(55),s=n(0),c=n.n(s),u=n(59),l=n(12);n(39),n(210),n(459);t.a=Object(l.b)(function(e){return{}},function(e){return{setTrackToConvert:function(t){return e(Object(i.jh)(t))}}})(function(e){var t=e.onClickDone,n=e.onClickCancel,i=e.show,l=e.track,f=e.setTrackToConvert,h=Object(s.useState)(!1),p=Object(r.a)(h,2),d=p[0],m=p[1];return c.a.createElement(a.a,{dialogClassName:"rack-modal",show:i,onHide:n||function(){return f(void 0)}},c.a.createElement(a.a.Header,{closeButton:!0},c.a.createElement(a.a.Title,null,"Convert Track Type")),l.getTrackType()===o.f?c.a.createElement(a.a.Body,null,c.a.createElement("div",null,"Confirm to convert of track to a:"),c.a.createElement("div",{className:"convert-options"},c.a.createElement("div",{onClick:function(){return m(!1)},className:d?"convert-option":"convert-option selected"},"Sampled Instrument"))):c.a.createElement(a.a.Body,null,"Confirm to convert to instrument rack"),c.a.createElement(a.a.Footer,null,c.a.createElement(u.b,{variant:"secondary",onClick:t?function(){return t(d)}:function(){f(void 0),d?l.convertToInstrumentRack():l.convertToSampledInstrument()}},"Confirm"),c.a.createElement(u.b,{variant:"primary",onClick:n||function(){return f(void 0)}},"Cancel")))})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(71),o=n(86),s=n(203),c=n(382),u=n(6),l=n(12);t.a=Object(l.b)(function(e,t){return{}},function(e){return{setDrawingPadEdge:function(t,n){return e(Object(u.Nb)(t,n))}}})(function(e){var t=e.isControl,n=e.containerRef,u=e.pad,l=e.setDrawingPadEdge,f=e.fx,h=e.rack,p=e.id,d=void 0===p?f.id:p,m=e.coords,v=e.nodeRef,b=e.outputNumber,g="effect-output-"+d;void 0!==b&&(g="effect-output-"+b+"-"+d);var y=Object(r.useRef)(void 0),k=Object(s.a)({ref:y}),O=k.onContextMenu,j=k.dropdownPos,w=k.setDropdownPos,E=Object(r.useRef)({x:0,y:0});Object(r.useEffect)(function(){if(m&&v&&v.current){var e=m.x,t=m.y;e+=v.current.offsetWidth+20,E.current.x=e,E.current.y=t}},[m]);var S=Object(r.useCallback)(function(e){n.current.getBoundingClientRect();var r=e.clientX,a=e.clientY,i=(u.state.spatial.edgesPadding,{effect:t?f.inputNode:f,outputNumber:b,rack:h,x1:r,y1:a,x2:r,y2:a});e.stopPropagation(),l(u.subSequence.id,i)},[]),P=f.getEffectType&&f.getEffectType()===i.c,x={};return f.numberOfOutputs>1&&(x.top=30+20*b+"%"),a.a.createElement("div",{ref:y,style:x,onContextMenu:O,id:g,onMouseDown:S,className:"effect-output"},!t&&a.a.createElement(c.a,{isMidi:P,setDropdownPos:w,outputNumber:b,dropdownPosRef:E,effectOptions:P?o.e:o.a,initializeEffect:P?o.c:o.b,dropdownPos:j,effect:f,node:u}))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=n(22),h=n(63),p=n(536),d=n(850),m=n(544);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var b=function(e){Object(o.a)(n,e);var t=v(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props.instrument.carrierOscillator,t=this.props.instrument.modulatorOscillator;return l.a.createElement("div",{className:"fm-parameters"},l.a.createElement("div",{className:"oscillator-types"},l.a.createElement("div",{className:"oscillator-type"},l.a.createElement(p.a,{sequencerEngine:this.props.sequencerEngine,oscillator:t}),l.a.createElement(d.a,{oscillator:t})),l.a.createElement("div",{className:"mod-label"},"mods"),l.a.createElement("div",{className:"oscillator-type"},l.a.createElement(p.a,{sequencerEngine:this.props.sequencerEngine,oscillator:e}),l.a.createElement(d.a,{oscillator:e}))),l.a.createElement(m.a,{oscillator:this.props.instrument.carrierOscillator,sequencerEngine:this.props.sequencerEngine,instrument:this.props.instrument}),l.a.createElement(f.a,{automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,name:"Frequency",parameter:e.oscillatorFrequencyParameter,onParameterChanged:function(){return e.releaseAll()},displayFunction:function(e){return h.a.fromTranspose(e).toString()},isParameter:!0,min:-32,max:32,step:1}),l.a.createElement(f.a,{automation:this.props.automation,name:"Detune",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:e.detuneParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}))}}]),n}(u.Component),g=(n(606),n(39)),y=n.n(g);function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var O=function(e){Object(o.a)(n,e);var t=k(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"getSelectedOscillatorType",value:function(){return this.props.oscillator.oscillatorType}},{key:"onSelectOscillatorType",value:function(e){var t="none"===e.value?void 0:e.value;this.props.oscillator.oscillatorType=t,this.setState(this.state)}},{key:"render",value:function(){var e=this.props.oscillator;return l.a.createElement("div",{className:"oscillator-component"},l.a.createElement(f.a,{automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,name:"Polyphony",parameter:e.polyphonyParameter,onParameterChanged:function(){return[]},isParameter:!0,min:1,max:16,step:1}),l.a.createElement(f.a,{automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,name:"Glide",parameter:e.portamentoParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:50,step:.1}))}}]),n}(u.Component);var j=O;function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}u.Component;var E=[{value:"square",label:"Square"},{value:"sine",label:"Sine"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"},{value:"pwm",label:"PWM"},{value:"pulse",label:"Pulse"},{value:"fatsquare",label:"Fat Square"},{value:"fatsine",label:"Fat Sine"},{value:"fattriangle",label:"Fat Triangle"},{value:"fatsawtooth",label:"Fat Sawtooth"},{value:"fmsquare",label:"FM Square"},{value:"fmsine",label:"FM Sine"},{value:"fmtriangle",label:"FM Triangle"},{value:"fmsawtooth",label:"FM Sawtooth"}];var S=n(38),P=(n(1032),n(738)),x=n(376),T=n(548),C=(n(458),n(129));function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var R=function(e){Object(o.a)(n,e);var t=N(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={showMods:!1,showGenetix:!1},a.onClickMods=a.onClickMods.bind(Object(i.a)(a)),a.onClickGenetix=a.onClickGenetix.bind(Object(i.a)(a)),a}return Object(a.a)(n,[{key:"onClickMods",value:function(){this.setState({showMods:!this.state.showMods})}},{key:"onClickGenetix",value:function(){this.setState({showGenetix:!this.state.showGenetix})}},{key:"render",value:function(){var e=this,t=this.props.instrument;return l.a.createElement("div",{className:"instrument fm-synth"},l.a.createElement(S.a,{condition:!this.state.showMods&&!this.state.showGenetix},l.a.createElement("div",{className:"clear-fix"}),l.a.createElement(b,{sequencerEngine:this.props.sequencerEngine,instrument:t}),l.a.createElement("div",{className:"instrument-section"},l.a.createElement("div",{className:"instrument-subsection"},l.a.createElement("div",{className:"instrument-subsection-name"},"Filter"),l.a.createElement("div",{className:"clear-fix"}),l.a.createElement(f.a,{automation:this.props.automation,name:"Cutoff",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:t.filterCutoffParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1e4,step:1}),l.a.createElement(f.a,{automation:this.props.automation,name:"Q",sequencerEngine:this.props.sequencerEngine,parameter:t.filterQParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:9,step:1}),l.a.createElement(f.a,{automation:this.props.automation,name:"Noise Level",sequencerEngine:this.props.sequencerEngine,parameter:t.noiseVolumeParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},unit:"db",isParameter:!0,min:-100,max:0,step:.1})),l.a.createElement("div",{className:"instrument-subsection"},l.a.createElement(j,{automation:this.props.automation,oscillator:t.carrierOscillator,sequencerEngine:this.props.sequencerEngine,instrument:t}))),l.a.createElement("div",{className:"instrument-section"},l.a.createElement("div",{className:"instrument-subsection"},l.a.createElement(x.a,{automation:this.props.automation,envelopeOptions:M,sequencerEngine:this.props.sequencerEngine,instrument:t})))),l.a.createElement(S.a,{condition:this.state.showGenetix},l.a.createElement("div",{className:"clear-fix"}),l.a.createElement(P.a,{onClickBack:function(){return e.onClickGenetix()},track:this.props.track,instrument:t})),l.a.createElement(S.a,{condition:this.state.showMods},l.a.createElement("div",{className:"clear-fix"}),l.a.createElement(T.a,{instrument:t})),l.a.createElement(S.a,{condition:!this.state.showGenetix},l.a.createElement("div",{onClick:this.onClickMods,className:"mods-button common-button pink-button small-button"},this.state.showMods?"BACK":"MODS"),l.a.createElement("div",{onClick:this.onClickGenetix,className:"mods-button common-button pink-button small-button"},"GENETIX")))}}]),n}(u.Component),M=[{value:C.a,label:"Amp"},{value:C.b,label:"Filter"},{value:C.c,label:"Filter 2"},{value:C.d,label:"Modulation"}];t.a=R},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(252),s=n(12),c=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.leaf,n=e.sequencerEngine,s=e.setLeafDetails,c=Object(a.useState)(t.track),u=Object(r.a)(c,2),l=u[0],f=u[1];Object(a.useEffect)(function(){f(t.track)},[t,f]);var h=Object(a.useCallback)(function(e){t.track=e,f(e)},[t,f]);return i.a.createElement("div",{className:"leaf-details"},i.a.createElement("div",{onClick:function(e){return s(void 0)},className:"delete-btn"},"x"),"Send trigger to track:",i.a.createElement(o.a,{sequencerEngine:n,track:l,onSelectTrack:h}))}),u=(n(335),n(99)),l=n(239),f=n(280),h=n(95),p=n(29),d=new p.a,m=window.factor||2,v=Object(s.b)(function(e,t){var n={};return t.tidals.forEach(function(e){n[e.id]=e.currentCycles,n["cycle"+e.id]=e.cycle}),n},function(e){return{}})(function(e){var t=e.leafDetails,n=e.setLeafDetails,r=e.backgroundColor,o=e.color,s=e.WIDTH,c=void 0===s?280:s,p=e.HEIGHT,v=void 0===p?280:p,b=e.dotColor,g=e.tidals,y=e.total,k=void 0===y?1:y,O=e.radius,j=void 0===O?c/2*.95:O,w=Object(u.a)(e,["leafDetails","setLeafDetails","backgroundColor","color","WIDTH","HEIGHT","dotColor","tidals","total","radius"]),E=Object(a.useRef)(void 0),S=Object(a.useRef)([]),P=Object(a.useRef)(void 0);Object(a.useEffect)(function(){P.current=E.current.getContext("2d"),T()},[]),Object(a.useEffect)(function(){P.current&&P.current.scale(window.devicePixelRatio,window.devicePixelRatio)},[c,v]);var x=c/2;Object(a.useEffect)(function(){P.current&&T()},[w,b,t,c,v,j,x]);var T=Object(a.useCallback)(function(){var e=P.current;e.clearRect(0,0,c,v),S.current=[];for(var t=void 0,n=0;n<g.length;n++)for(var r=g[n],a=r.cycle,i=t||Math.max(10,j-12*m*n),o=a,s=o.length,u=0;u<o.length;u++){var l=o[u];if(0===u&&(t=C(e,u,s,a,i,x,l)),Array.isArray(l)&&(l=l[0]),w.sequencerEngine.tracks[n]&&N(e,l,u,i,a,n,s,r))break}},[o,c,v,b,r,g,k,t,x,j]),C=function(e,t,n,r,a,i,o){var s=M((t+1)%n,i,a,r),c=M((t+2)%n,i,a,r),u=M(Object(h.a)(t-2,n),i,a,r),p=M(Object(h.a)(t-1,n),i,a,r),d=Object(f.a)(p,c,u,s);return Object(l.c)({x:i,y:i},d)},N=function(e,t,n,a,i,o,s,c){var u=M(n,x,a,i),l=u.deg,f=u.x,h=u.y,p=R(t,o/s,o,s),v=p.fill,g=(p.stroke,p.radius);if(!c.currentCycles||!c.currentCycles[t.id])return!1;v=d.brighten(v,window.bright||.5);var y=new Path2D;if(y.arc(x,x,a,1.5*Math.PI,l),e.strokeStyle=b,e.stroke(y),null!==t.transpose){var k=new Path2D;if(g<0&&(g=1),k.arc(f,h,m*g,0,2*Math.PI),S.current.push({leaf:t,path:y,nth:o}),e.fillStyle=b,e.fill(k),t.staccato){var O=.3*g*m;e.fillStyle=r,e.fillRect(f-.5*O,h-.5*O,O,O)}}return!0},R=Object(a.useCallback)(function(e,t,n,a){var i=w.sequencerEngine.tracks[n],s=i?d.getColorForTrack(i):o,u=c/280*5*(a-n)/a;return e.accent?u*=2:e.piano?u/=2:e.pianissimo&&(u/=2),null===e.transpose?{fill:d.transparent(d.saturate(r,1)),stroke:s,radius:u}:{fill:s,radius:u}},[o,c,v,x,r]),M=Object(a.useCallback)(function(e,t,n,r){e*=1;var a=r.length,i=2*Math.PI*e/a-.5*Math.PI;return{x:t+n*Math.cos(i),y:t+n*Math.sin(i),deg:i}},[x,j,c,v]),A=Object(a.useCallback)(function(e){},[n]);return i.a.createElement("canvas",{onMouseDown:A,className:"tidal-art",style:{width:c,height:v},width:c*window.devicePixelRatio,height:v*window.devicePixelRatio,ref:E})}),b=n(873);window.magik=1.5,window.rad=1;new p.a,Object(s.b)(function(e,t){var n={};return t.tidals.forEach(function(e){n[e.id]=e.currentCycles,n["cycle"+e.id]=e.cycle}),n},function(e){return{}})(function(e){var t=e.displayRef,n=e.backgroundColor,r=e.color,o=e.tidals,s=e.total,c=void 0===s?1:s,l=(e.radius,Object(u.a)(e,["displayRef","backgroundColor","color","tidals","total","radius"])),f=Object(a.useRef)(void 0),h=Object(a.useRef)(void 0);Object(a.useEffect)(function(){h.current=f.current.getContext("2d"),h.current.scale(window.devicePixelRatio,window.devicePixelRatio),p()},[]),Object(a.useEffect)(function(){h.current&&p()},[l]);var p=Object(a.useCallback)(function(){var e=h.current;e.clearRect(0,0,495,400),e.beginPath(),e.rect(0,0,495,400),e.fillStyle=n,e.fill();for(var a=0;a<Math.min(1,o.length);a++){for(var i=o[a],s=i.cycle.flat(16),c=(s.length,!1),u=Math.max(1,15-3*a),l={x:2*u,y:2*u},f=!1,p=0;p<s.length;p++){var d=s[p];if(d.type){var m=d.type,v=m.type,b=m.value;if(p>0){var g=d.accent?2*u:u;"-"===v?(l.x+=3*g,0===b&&(c=!c)):"."===v&&(f&&(l.y+=3*g),c=!c)}f="."===v;var y=l.x,k=l.y;if(c&&(k=400-k),null!==d.transpose){e.beginPath(),e.fillStyle=r;var O=window.rad*u;d.accent&&(O*=2);var j=2*Math.PI;d.staccato&&(j=Math.PI),i.currentCycles&&i.currentCycles[d.id]&&(e.fillStyle="red",e.fillStyle="#FFA47D"),a>0&&(e.fillStyle="gray",O=u),e.arc(y,k,O,0,j),d.piano||d.pianissimo?(e.strokeStyle=r,e.lineWidth=2,e.stroke()):e.fill()}}}0===a&&(l.x+=4*u,l.y+=4*u,e.fillStyle="black",e.fillRect(l.x,l.y,495-l.x-u,100),t.current&&(t.current.style.left=l.x+"px",t.current.style.top=l.y+"px",t.current.style.width=495-l.x+"px",t.current.style.height="100px"))}},[r,n,o,c]);return i.a.createElement("canvas",{className:"tidal-art",style:{width:495,height:400},width:495*window.devicePixelRatio,height:400*window.devicePixelRatio,ref:f})}),n(1055),t.a=Object(s.b)(function(e,t){var n={};return t.tidals.forEach(function(e){return n[e.id]=e.inUse}),n},function(e){return{}})(function(e){var t=e.tidals,n=e.isScript,o=e.WIDTH,s=e.HEIGHT,u=e.color,l=void 0===u?"#A19A9A":u,f=e.backgroundColor,h=void 0===f?"#100B0B":f,p=e.fillColor,d=void 0===p?"#757474":p,m=e.dotColor,g=void 0===m?"#B5B5B5":m,y=Object(a.useRef)(),k=Object(a.useState)(!1),O=Object(r.a)(k,2),j=(O[0],O[1],Object(a.useState)({x:0,y:0})),w=Object(r.a)(j,2),E=(w[0],w[1],Object(a.useState)(void 0)),S=Object(r.a)(E,2),P=S[0],x=S[1],T=t.filter(function(e){return e.inUse||e.lastUsed<1});T[0];return 0===T.length?"":i.a.createElement("div",{className:"script-tidals"},P&&i.a.createElement(c,{setLeafDetails:x,sequencerEngine:t[0].track.sequencerEngine,leaf:P}),i.a.createElement("div",{ref:y,className:"display"},i.a.createElement("span",null)),i.a.createElement(b.a,{leafDetails:P,setLeafDetails:x,isScript:n,sequencerEngine:t[0].track.sequencerEngine,backgroundColor:h,color:l,fillColor:d,WIDTH:o,HEIGHT:s,dotColor:g,tidals:t}),i.a.createElement(v,{leafDetails:P,WIDTH:o,HEIGHT:s,setLeafDetails:x,sequencerEngine:t[0].track.sequencerEngine,backgroundColor:h,dotColor:g,color:l,tidals:T,total:T.length}))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(8),l=n(56),f=n(15),h=n.n(f),p=n(41),d=n(23);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var v=function(e){Object(o.a)(n,e);var t=m(n);function n(e,a,i){var o;return Object(r.a)(this,n),(o=t.call(this,e,a,i)).updateInitialValues(),o}return Object(a.a)(n,[{key:"dispose",value:function(){Object(i.a)(Object(c.a)(n.prototype),"dispose",this).call(this)}},{key:"setCompressors",value:function(e){for(var t in this.compressors=[],e)this.compressors.push(new b(t,this.store,e[t]))}},{key:"getJson",value:function(){return Object(u.a)({},Object(i.a)(Object(c.a)(n.prototype),"getJson",this).call(this),{compressors:this.compressors.map(function(e){return e.getJson()})})}},{key:"fromJson",value:function(e,t){var r=Object(i.a)(Object(c.a)(n.prototype),"fromJson",this).call(this,e,t);for(var a in e.compressors){var o=e.compressors[a].name;this.getCompressor(o).fromJson(e.compressors[a],t)}return r}},{key:"getCompressor",value:function(e){return this.compressors.find(function(t){return t.name===e})}}]),n}(l.a.Effect),b=function(){function e(t,n,a){Object(r.a)(this,e),this.name=t,this.store=n,this.compressorNode=a,this.parameters=[],this.thresholdParameter=new p.c("Threshold",this.compressorNode.threshold,{min:-80,max:8,unit:"",defaultValue:0,constantAutomationRate:!0,automatable:!1}),this.registerParameter(this.thresholdParameter),this.ratioParameter=new p.c("Ratio",this.compressorNode.ratio,{min:1,max:24,unit:"",defaultValue:3,constantAutomationRate:!0}),this.registerParameter(this.ratioParameter),this.attackParameter=new p.b("Attack",this.compressorNode.attack,{constantAutomationRate:!0}),this.registerParameter(this.attackParameter),this.releaseParameter=new p.b("Release",this.compressorNode.release,{constantAutomationRate:!0}),this.registerParameter(this.releaseParameter),this.releaseParameter.set(.1),this.kneeParameter=new p.c("Knee",this.compressorNode.knee,{min:0,max:40,unit:"db",defaultValue:1,constantAutomationRate:!0}),this.registerParameter(this.kneeParameter)}return Object(a.a)(e,[{key:"registerParameter",value:function(e){void 0!==e&&(e.name=e.name,e.effectName=this.name,e.setStore(this.store),this.parameters.push(e))}},{key:"getJson",value:function(){var e={name:this.name,threshold:this.thresholdParameter.get(),ratio:this.ratioParameter.get(),attack:this.attackParameter.get(),release:this.releaseParameter.get()};return e=Object(d.b)(e,"thresholdParameter",this.thresholdParameter),e=Object(d.b)(e,"ratioParameter",this.ratioParameter),e=Object(d.b)(e,"attackParameter",this.attackParameter),e=Object(d.b)(e,"releaseParameter",this.releaseParameter)}},{key:"fromJson",value:function(e,t){this.thresholdParameter.set(e.threshold),this.ratioParameter.set(e.ratio),this.attackParameter.set(e.attack),this.releaseParameter.set(e.release),Object(d.a)(e,"thresholdParameter",this.thresholdParameter,t),Object(d.a)(e,"ratioParameter",this.ratioParameter,t),Object(d.a)(e,"attackParameter",this.attackParameter),Object(d.a)(e,"releaseParameter",this.releaseParameter)}}]),e}();function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var y=function(e){Object(o.a)(n,e);var t=g(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Multiband Compressor",function(){return new h.a.MultibandCompressor},e)).setCompressors({LOW:a.effectNode.low,MID:a.effectNode.mid,HIGH:a.effectNode.high}),a}return Object(a.a)(n,[{key:"dispose",value:function(){Object(i.a)(Object(c.a)(n.prototype),"dispose",this).call(this)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(v);t.a=y},,function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[{internalType:"bytes32",name:"packHash",type:"bytes32"},{internalType:"bytes32",name:"previousHash",type:"bytes32"},{internalType:"bytes32[]",name:"contentHashes",type:"bytes32[]"},{internalType:"bytes32",name:"title",type:"bytes32"}],name:"newPack",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"packHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousHash",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"title",type:"bytes32"}],name:"NewPack",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"packHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"}],name:"PackHasContent",type:"event"}],this.contractAddress="0xF7bd2ada59c4ab5AD0f6BFbE94EB4f8eCa18eEDd"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[{internalType:"bytes32",name:"scriptHash",type:"bytes32"},{internalType:"bytes32",name:"scriptType",type:"bytes32"},{internalType:"bytes32",name:"title",type:"bytes32"}],name:"newScript",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"scriptHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"scriptType",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"title",type:"bytes32"}],name:"NewScript",type:"event"}],this.contractAddress="0xA6FF112D42c50FEE6c212B775721185f82285844"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}()},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=function(){function e(t,n){Object(o.a)(this,e),this.currentPromise=t,this.nextPromise=n}return Object(s.a)(e,[{key:"getCurrent",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.currentPromise();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getNext",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.nextPromise;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();t.a=c},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n(15),a=n.n(r),i=function(e,t){return t.stepToValues[e]||[]},o=function(e,t,n){var r,i=t.config.stepAutomation,o=n[0],s=t.get(!0);if(t.getNumberFromOption&&(s=t.getNumberFromOption(s)),"string"===typeof s&&(s=new a.a.Time(s).toFrequency()),0===n.length)return s;for(var c in n){var u=n[c=parseInt(c)];if(r=u,u.step<=e){if(null===u.value)return null;if(n[c+1]&&e<n[c+1].step){var l=void 0===u.value?t.get(!0):u.value;if("function"===typeof l&&(l=l()),i)return l;var f=n[c+1],h=(f.step,u.step,l+(e-u.step)*((("function"===typeof f.value?f.value():f.value)-l)/(f.step-u.step)));return h=t.toFrequency?new a.a.Time(h):h}}}if(r&&e>=r.step){if(null===r.value)return null;var p=void 0===r.value?t.get(!0):r.value;return"function"===typeof p?p():p}if(o){var d=o.value;return"function"===typeof d?d():d}return s}},function(e,t,n){"use strict";n.d(t,"a",function(){return b});var r=n(43),a=n(33),i=n(198),o=n(501),s=n(363),c=n(424),u=n(364),l=n(601),f=n(502),h=n(603),p=n(604),d=n(234),m=n(238),v=n(602);function b(e,t,n,b){var g=void 0;switch(t){case r.i:g=new i.a;break;case r.q:g=new o.a;break;case r.e:g=new s.a;break;case r.m:g=new c.a;break;case r.p:g=new h.a;break;case r.d:g=new u.a;break;case r.h:g=new l.a;break;case r.o:g=new f.a;break;case r.n:g=new p.a;break;case r.j:g=new m.a;break;case r.k:g=new d.a(!1,new a.a);break;case r.l:g=new v.a}return void 0!==g&&(g.fromJson(e,n),void 0!==g&&(g.subSequence=b)),g}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1);function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var l=function(e){Object(o.a)(n,e);var t=u(n);function n(e,a,i){var o;Object(r.a)(this,n);var s=!0;return(o=t.call(this,e,i,function(e,t){s||e.send(a,t),s=!1},{min:0,max:127,defaultValue:1})).ccNumber=a,i.setCallback(a,function(e){o.set(e)}),o}return Object(a.a)(n,[{key:"getJson",value:function(){var e=Object(i.a)(Object(c.a)(n.prototype),"getJson",this).call(this);return e.ccNumber=this.ccNumber,e}}]),n}(n(21).a);t.a=l},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(56),f=n(32),h=n(15),p=n.n(h),d=n(41);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Gain",function(){return new p.a.Gain(1)},e)).effectNode.gain.value=1,r.gainParameter=new d.c("Gain",r.effectNode.gain,{documentation:"Controls the gain (or loudness) of the signal before it hits the compressor",min:0,max:6,unit:"db",defaultValue:1}),r.registerParameter(r.gainParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"documented",get:function(){return"Reduces the volume of loud sounds or amplifies quiet sounds."}},{key:"getJson",value:function(e){var t=Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this);return t.gain=this.gainParameter.get(),t=this.saveParameterToJson(t,"gainParameter",this.gainParameter)}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return"gain"in e&&Object(f.a)(this.gainParameter,e.gain,a),Object(r.a)({},a,this.loadParameterFromJson(e,"gainParameter",this.gainParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(l.a.Effect);t.a=v},function(e,t,n){"use strict";var r=n(9),a=n(8),i=n(2),o=n(4),s=n(16),c=n(7),u=n(10),l=n(1),f=n(381),h=n(62),p=n(57),d=n(322),m=n(89),v=n(379);function b(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var k=6,O=function(e){Object(c.a)(n,e);var t=y(n);function n(e){var r;Object(i.a)(this,n),(r=t.call(this,"Macros",m.c,e)).macros=[];for(var a=0;a<k;a++)r.newMacro();return r.randomness=15,r}return Object(o.a)(n,[{key:"getParameters",value:function(){return this.macros.map(function(e){return e.macroParameter})}},{key:"newMacro",value:function(){this.macros.push(new d.a("Macro "+(this.numMacros+1),this.track.sequencerEngine,this.context))}},{key:"context",get:function(){return(new p.a).forLiveEffect(this).forTrack(this.track)}},{key:"numMacros",get:function(){return this.macros.length}},{key:"getJson",value:function(){var e=Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this);return Object(a.a)({},e,{macros:this.macros.map(function(e){return e.getJson()})})}},{key:"getLFOParameters",value:function(){return[]}},{key:"fromJson",value:function(e){Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e),this.ripMods();var t=[].concat(Object(r.a)(this.track.getAllParameters()),Object(r.a)(this.getLFOParameters()));for(var a in this.macros)this.macros[a].fromJson(e.macros[a],t)}},{key:"getCopy",value:function(e){var t=new n(e);return t.fromJson(this.getJson()),t}},{key:"dispose",value:function(){this.macros.forEach(function(e){return e.unmapAllParameters()}),this.macros=void 0}},{key:"ripMods",value:function(){this.macros.forEach(function(e){return e.ripMods()})}},{key:"generateMappings",value:function(){this.macros.forEach(function(e){return e.unmapAllParameters()});var e=[].concat(Object(r.a)(this.track.effectsChain.getAllParameters()),Object(r.a)(this.track.midiEffects.getAllParameters()),Object(r.a)(this.getLFOParameters()));this.track.instrument&&(e=[].concat(Object(r.a)(e),Object(r.a)(this.track.instrument.getParameters())));var t,n=b(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(!(Math.random()>this.randomness/100||!a.automatable||v.a.includes(a.name))){var i=a.get(!0),o=i+this.randomness/100*Math.random()*(a.max-i);Math.random()<.5&&(o=i-this.randomness/100*Math.random()*(i-a.min));var s=this.macros[Math.floor(Math.random()*this.macros.length)];Object(h.a)(i)&&s.addParameter(a,i,o)}}}catch(c){n.e(c)}finally{n.f()}this.macros.forEach(function(e){return e.macroParameter.set(e.macroParameter.get())})}}]),n}(f.a);t.a=O},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r="REVERB",a="DELAY",i="PHASER"},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return i});var r="LOW",a="MID",i="HIGH"},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(11),a=n(6);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(e,t,n){var o=0,s=e.getEasyPattern(),c=!t||0==t.length,u=e.sequencerEngine.state;c&&(t=s.getAllSteps(),o=e.pattern.length(n));var l,f=-1,h=i(s.getStepNumbers(t,n));try{for(h.s();!(l=h.n()).done;){var p=l.value,d=Object(r.a)(p,2),m=d[0],v=d[1];v>f&&(f=v,m)}}catch(k){h.e(k)}finally{h.f()}var b=f+(n.resolution/4-f%(n.resolution/4));c||void 0===u.keyboard.cursor?c||(o=b):o=u.keyboard.cursor-u.keyboard.cursor%(n.resolution/4),(c||o>=e.pattern.length(n))&&e.doubleTrackLength();var g=c?s.getFirstOnStep(n):s.getFirstStepNumber(t,n);o+=c?g:g%(n.resolution/4);e.getEasyPattern().pasteSteps(t,{stepNumber:o},s,n);e.updateSteps();var y=b-(g-g%(n.resolution/4));e.sequencerEngine.dispatch(Object(a.Zd)(o+y))}},,function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(7),u=n(10),l=n(1),f=n(0),h=n.n(f),p=n(558),d=n(94),m=n(29),v=n(30),b=n(1082),g=n(59),y=n(38),k=n(366),O=n(6),j=n(12),w=n(52);n(1083);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var S=new m.a,P=function(e){Object(c.a)(n,e);var t=E(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={isAuthorized:!1,toggled:!1,guilds:[]},v.a.store=r.props.store,w.a.setStore(r.props.store),w.a.setEthereum(v.a),w.a.checkLogin(),r.getGuilds(),r.getUserName(),r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.userToken!==e.userToken&&(this.getGuilds(),this.getUserName()),this.state.toggled,t.toggled,!0}},{key:"getUserName",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.getUserName();case 2:t=e.sent,this.setState({userName:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getGuilds",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.guilds.getGuildsForUser();case 2:if(t=e.sent,n=d.a.getItem("selectedGuild"))try{(n=JSON.parse(n))&&t.some(function(e){return e.guildId===n.guildId})&&this.props.setSelectedGuild(t.find(function(e){return e.guildId===n.guildId}))}catch(r){}this.setState({guilds:t.filter(function(e){return!e.name.includes(",")})});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickLogIn",value:function(){this.props.setSigningUp(!1),this.props.setShowLogin(!0)}},{key:"onClickSignUp",value:function(){this.props.setSigningUp(!0),this.props.setShowLogin(!0)}},{key:"onClickLogout",value:function(){w.a.logout()}},{key:"onClickGuild",value:function(e){void 0!==e&&v.a.crypto.getPassword(),this.props.setSelectedGuild(e),d.a.setItem("selectedGuild",JSON.stringify(e))}},{key:"toggle",value:function(){this.setState({toggled:!this.state.toggled})}},{key:"getSelectedGuild",value:function(){return this.props.selectedGuild?this.props.selectedGuild.name:this.state.userName}},{key:"onClickConnect",value:function(){var e=this;Object(p.e)().then(function(t){t||Object(p.a)(),e.setState({isAuthorized:t})})}},{key:"goToGuildsPage",value:function(){}},{key:"render",value:function(){var e=this;return h.a.createElement("div",{className:"guilds-menu"},h.a.createElement(b.a,{crypto:v.a.crypto,show:!0}),h.a.createElement(g.c,{className:"view-dropdown guilds-dropdown",show:this.state.toggled?"true":"false",isOpen:this.state.toggled,toggle:function(){return e.toggle()}},w.a.isLoggedIn()?h.a.createElement(g.f,{size:"sm",caret:!0,color:"primary"},h.a.createElement("div",{style:this.props.selectedGuild&&{backgroundColor:S.getColorForHash(this.getSelectedGuild())},className:"not-recording-dot"}),h.a.createElement("span",{className:"guild-name"},this.getSelectedGuild())):h.a.createElement(g.f,{size:"sm",caret:!0,color:"primary"},h.a.createElement("div",{className:"not-recording-dot logged-out"}),"Log In"),h.a.createElement(g.e,null,h.a.createElement(y.a,{condition:!w.a.isLoggedIn()},h.a.createElement(g.d,{key:"",onClick:function(){return e.onClickLogIn()},size:"sm"},"Log In"),h.a.createElement(g.d,{key:"public",onClick:function(){return e.onClickSignUp()},size:"sm"},"Sign Up")),h.a.createElement(y.a,{condition:w.a.isLoggedIn()},h.a.createElement("div",{onClick:function(){return e.props.setIsManagingGuilds(!0)},className:"guilds-mgmt-btn"},"Manage Groups"),h.a.createElement(g.d,{key:"public",className:"connect-wallet-option",size:"sm"},this.state.isAuthorized?h.a.createElement("div",{className:"guild-dropdown-option connected-btn"},x(this.state.isAuthorized)):h.a.createElement("div",{onClick:function(){return e.onClickConnect(void 0)},className:"guild-dropdown-option connect-wallet-btn"},h.a.createElement("div",null,"Connect Wallet"))),h.a.createElement(g.d,{key:"public",onClick:function(){return e.onClickGuild(void 0)},size:"sm"},h.a.createElement("div",{className:"guild-dropdown-option"},h.a.createElement("div",null,"Everything"),h.a.createElement(k.a,{className:"guilds-checkmark",condition:void 0===this.props.selectedGuild}))),h.a.createElement("div",{className:"section-header"},"Groups"),this.state.guilds.map(function(t){return h.a.createElement(g.d,{key:t.name,onClick:function(){return e.onClickGuild(t)},size:"sm"},h.a.createElement("div",{className:"guild-dropdown-option"},h.a.createElement("div",{style:{backgroundColor:S.getColorForHash(t.name)},className:"dot"}),h.a.createElement("div",null,t.name),h.a.createElement(k.a,{className:"guilds-checkmark",condition:e.props.selectedGuild===t})))}),h.a.createElement("div",{className:"user-name-item"},h.a.createElement("div",{className:"not-recording-dot"})," ",h.a.createElement("span",{className:"guild-user-name"},this.state.userName)),h.a.createElement("div",{onClick:function(){return e.onClickLogout()},className:"logout-btn"}," Log out ")))))}}]),n}(f.Component),x=function(e){return e.length>12?e.slice(0,12)+"...":e};t.a=Object(j.b)(function(e){return{selectedGuild:e.guilds.selectedGuild,userToken:e.sequencer.userToken}},function(e){return{setSelectedGuild:function(t){return e(Object(O.af)(t))},setShowLogin:function(t){return e(Object(O.Qf)(t))},setSigningUp:function(t){return e(Object(O.sg)(t))},setIsManagingGuilds:function(t){return e(Object(O.Fc)(t))}}})(P)},function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(5),a=n.n(r),i=n(14),o=n(36),s=n(94),c=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=s.a).getItem("blockDate."+t)){e.next=3;break}return e.abrupt("return",new Date(1e3*n.getItem("blockDate."+t)));case 3:if(void 0!==t){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.next=7,o.a.eth.getBlock(t);case 7:if(null!==(r=e.sent)){e.next=10;break}return e.abrupt("return",new Date);case 10:return i=new Date(1e3*r.timestamp),n.setItem("blockDate."+t,r.timestamp),e.abrupt("return",i);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";function r(e){return e.getMonth()+1+"/"+e.getDate()}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(6),f=n(46),h=n(12),p=n(34);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var m=function(e){Object(i.a)(n,e);var t=d(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={start:0},a.operationManager=a.props.sequencerEngine.operationManager,a}return Object(a.a)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props.currentPattern-this.props.currentPattern%10;t!==this.state.start&&(this.state.start=t,this.setState(this.state))}},{key:"prev",value:function(){this.props.sequencerEngine.switchToPattern(this.state.start-1)}},{key:"next",value:function(){this.props.sequencerEngine.switchToPattern(this.state.start+10)}},{key:"hasNext",value:function(){return this.state.start+10<this.numPatterns}},{key:"hasPrev",value:function(){return this.state.start>0}},{key:"onDragStart",value:function(e){this.props.dragPattern(e)}},{key:"deletePattern",value:function(){0!==this.props.sequencerEngine.tracks.length&&this.operationManager.dispatch(Object(f.f)(this.props.sequencerEngine.tracks[0].currentPattern))}},{key:"onDragOver",value:function(e){e.preventDefault()}},{key:"onDrop",value:function(e){this.props.sequencerEngine.movePatternTo(this.props.patternDragging,e),this.setState(this.state)}},{key:"clickPattern",value:function(e){this.props.sequencerEngine.store.getState();this.props.sequencerEngine.switchToPattern(e),this.setState(this.state)}},{key:"numPatterns",get:function(){return this.props.subSequence&&this.props.subSequence.tracks[0]?this.props.subSequence.tracks[0].patterns.length:this.props.sequencerEngine.numberOfPatterns()}},{key:"render",value:function(){var e=this;if(this.props.sequencerEngine.currentSubSequence.isTrack)return u.a.createElement("div",null);for(var t=[],n=0;n<this.numPatterns;n++)t.push(n);return t=t.slice(this.state.start,this.state.start+10),u.a.createElement("div",{className:"patterns-container"},this.hasPrev()?u.a.createElement("div",{onClick:function(){return e.prev()},className:"pag-btn"},"..."):"",t.map(function(t){return u.a.createElement(v,{key:t,setContextualHelp:function(t){return e.props.setContextualHelp(t)},patternNumber:t,currentPattern:e.props.currentPattern,patternColor:e.props.patternColors[t],patternToEditColor:e.props.patternToEditColor,secondaryColor:e.props.secondaryColor,primaryColor:e.props.primaryColor,onClickPattern:function(){return e.clickPattern(t)},onDragStart:function(n){return e.onDragStart(t)},onDragOver:function(t){return e.onDragOver(t)},onDrop:function(n){e.onDrop(t)}})}),this.hasNext()?u.a.createElement("div",{onClick:function(){return e.next()},className:"pag-btn"},"..."):"",u.a.createElement("div",{style:{color:this.props.secondaryColor},onMouseOver:function(){return e.props.setContextualHelp(p.T)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"new-pattern-btn",onClick:function(){return e.props.sequencerEngine.newPattern(!0)}},"+"),u.a.createElement("div",{style:{color:this.props.secondaryColor},onMouseOver:function(){return e.props.setContextualHelp(p.r)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"delete-pattern-btn",onClick:function(){return e.deletePattern()}},"-"))}}]),n}(c.Component),v=function(e){Object(i.a)(n,e);var t=d(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this,t="pattern-box",n={};this.props.currentPattern==this.props.patternNumber?(void 0!==this.props.patternColor?t+=" background-"+this.props.patternColor:t+=" current-pattern",n.backgroundColor=this.props.secondaryColor):(void 0!==this.props.patternColor&&(t+=" foreground-"+this.props.patternColor),n.color=this.props.secondaryColor),this.props.patternNumber==this.props.patternToEditColor&&(t+=" editing-color");var r=this.props.currentPattern===this.props.patternNumber?p.p:p.hb;return u.a.createElement("div",{style:n,onMouseOver:function(){return e.props.setContextualHelp(r)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onDragStart:this.props.onDragStart,onDragOver:this.props.onDragOver,onMouseDown:function(e){return e.stopPropagation()},onDrop:this.props.onDrop,draggable:!0,className:t,onClick:this.props.onClickPattern},this.props.patternNumber+1)}}]),n}(c.Component);t.a=Object(h.b)(function(e,t){var n=t.sequencerEngine.engineId,r=t.subSequenceId||e.sequencer.currentSubSequence[n],a=e.sequencer.currentPattern[r]||0,i=e.sequencer.isPlaying[n]||0;return{midiMapMode:e.midi.midiMapMode,isCompactMode:e.sequencer.isCompactMode,resolution:e.sequencer.displayResolution,detailsView:e.sequencer.detailsView,decentralized:e.sequencer.decentralized,currentPattern:a,viewMode:e.sequencer.viewMode,numberOfPatterns:e.sequencer.numberOfPatterns[r]||1,samplePack:e.sequencer.samplePack,patternDragging:e.sequencer.patternDragging,isRecordingMix:e.mix.isRecordingMix,isPlayingMix:e.mix.isPlayingMix,isPlaying:i,patternToEditColor:e.toolbar.patternToEditColor,patternColors:e.toolbar.patternColors,trackRolling:e.sequencer.trackRolling,sequenceRolling:e.sequencer.sequenceRolling}},function(e){return{dragPattern:function(t){return e(Object(l.i)(t))},setContextualHelp:function(t){return e(Object(l.ub)(t))}}})(m)},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(11),a=n(0),i=function(){var e=Object(a.useState)([]),t=Object(r.a)(e,2);return{ordering:t[0],setOrdering:t[1],sizeRef:Object(a.useRef)({width:250,height:150})}}},function(e,t,n){"use strict";n.d(t,"c",function(){return v}),n.d(t,"a",function(){return b}),n.d(t,"b",function(){return g}),n.d(t,"g",function(){return y}),n.d(t,"f",function(){return k}),n.d(t,"e",function(){return O}),n.d(t,"d",function(){return j});var r=n(5),a=n.n(r),i=n(14),o=n(70),s=n(31),c=n(715),u=n(40),l=n(36),f=n(65),h=n(44);function p(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=(new c.a).contractAddress,v=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,c,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new u.a(m).from(s.U).select("artistName").select("releaseName").select("releaseType").select("coverArtHash").whereIn("releaseId",t),e.next=3,n.executeQuery();case 3:r=e.sent,i={},o=p(r);try{for(o.s();!(c=o.n()).done;)(l=c.value).releaseName.startsWith("RECORD")&&(l.releaseName=l.releaseName.slice(7)),l.releaseName.startsWith("SAMPLE_PACK")&&(l.releaseName=l.releaseName.slice(12)),i[l.releaseId]=l}catch(a){o.e(a)}finally{o.f()}return e.abrupt("return",i);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new u.a(m).from(s.V).select("artistName").where("ipfsHash",t),e.next=3,n.executeQuery();case 3:if(0!==(r=e.sent).length){e.next=6;break}return e.abrupt("return",void 0);case 6:return r.reverse(),e.abrupt("return",r[0].artistName);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new u.a(m).from(s.b).select("artistName").select("linkType").select("link").where("artistName",t),e.next=3,n.executeQuery();case 3:if(0!==(r=e.sent).length){e.next=6;break}return e.abrupt("return",void 0);case 6:return r.reverse(),e.abrupt("return",r[0]);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("newSampleByArtist(%s,%s)",t,n),e.next=3,new o.a(h.a,"newSampleByArtist",[l.a.utils.fromAscii(t),Object(f.c)(n)]).execute();case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(i.a)(a.a.mark(function e(t,n,r,i){var s,c=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.length>4&&void 0!==c[4]?c[4]:"RECORD",console.log("newRelease(%s,%s,%s,%s,%s)",t,n,r,i,s),e.next=4,new o.a(h.a,"newRelease",[l.a.utils.fromAscii(t),n,r,Object(f.c)(i),l.a.utils.fromAscii(s)]).execute();case 4:case"end":return e.stop()}},e)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),O=function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("newArtistInfo(%s,%s,%s,%s,%s)",t,n,r),e.next=3,new o.a(h.a,"newArtistInfo",[l.a.utils.fromAscii(t),l.a.utils.fromAscii(n),r]).execute();case 3:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=window.sessionStorage.getItem("getSamplePack("+t+","+n+")"))){e.next=4;break}return console.log("item =",r),e.abrupt("return",JSON.parse(r));case 4:return i=new u.a(m).from(s.U).select("artistName").select("releaseName").select("discogsId").select("releaseType").select("coverArtHash").where("artistName",t),e.next=7,i.executeQuery();case 7:if(o=e.sent,console.log("SAMPLE PACK RESULTS =",o),!(c=o.find(function(e){return e.releaseName.includes(n)}))){e.next=13;break}return c.releaseName=c.releaseName.slice(12),e.abrupt("return",c);case 13:return e.abrupt("return",void 0);case 14:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),a=function(e){var t=e.subtractContainer,n=e.mouseDown,a=e.scrollRef,i=e.isCurrent,o=e.ref,s=e.expanded,c=e.topOffset,u=void 0===c?180:c,l=e.skipBottom,f=void 0!==l&&l;Object(r.useEffect)(function(){if((!n||!n.current)&&i&&a&&a.current&&o.current){var e=a.current.scrollTop,r=a.current.offsetHeight,s=o.current.offsetTop+80;t&&(s-=a.current.getBoundingClientRect().top);var c=o.current.offsetHeight,l=c>r?s+(r-150):s+c;s<e+u?a.current.scrollTop-=e+u-s:!f&&l>e+r&&(a.current.scrollTop+=l-(e+r))}},[i,s])}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(106),f=n(6),h=n(12),p=n(34),d=n(278);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var v=function(e){Object(i.a)(n,e);var t=m(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"onPlayMixClicked",value:function(e){this.props.setIsPlayingMix(!this.props.isPlaying),this.props.sequencerEngine.schedulePlay(),document.activeElement.blur()}},{key:"onClickRecordMixButton",value:function(){var e=this.props.isRecording||this.props.isRecordingMix;this.props.setIsRecordingMix(!e),this.props.sequencerEngine.recording(!e)}},{key:"onClickStop",value:function(){this.props.sequencerEngine.stop(),this.props.sequencerEngine.seekToTrackStep(0),this.props.setPianoRollCursor(void 0),this.props.setArrangementMouseX(void 0),this.props.setArrangementCursorStep(0)}},{key:"getPianoIcon",value:function(){return this.props.showPianoRoll&&this.props.bottomMode===l.d?"/piano-roll-on.svg":"/piano-roll-off.svg"}},{key:"getPianoClass",value:function(){return this.props.showPianoRoll&&(this.props.bottomMode,l.d),"piano-roll-button"}},{key:"onClickPianoRoll",value:function(){this.props.showPianoRoll&&this.props.bottomMode===l.e?this.props.setArrangementBottomMode(l.d):(this.props.setArrangementBottomMode(l.d),this.props.setShowPianoRoll(!this.props.showPianoRoll))}},{key:"render",value:function(){var e=this,t="playpause ";return this.props.playScheduled&&(t+=" flashit"),u.a.createElement("div",{className:"mix-buttons"},u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(p.kb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:t},u.a.createElement("input",{onChange:function(t){return e.onPlayMixClicked(t)},checked:!this.props.isPlaying,type:"checkbox",value:!this.props.isPlaying,id:"playpause",name:"check"}),u.a.createElement("label",{className:this.props.isPlaying&&this.props.isPlayingMix?"mix":"",htmlFor:"playpause",tabIndex:1})),u.a.createElement("div",{onClick:function(){return e.onClickStop()},className:"stop-button"}),u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(p.wb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.onClickRecordMixButton()},className:this.props.isRecording||this.props.isRecordingMix?"record-btn recording-dot":"record-btn not-recording-dot"}),u.a.createElement("img",{onClick:function(){return e.onClickPianoRoll()},onMouseOver:function(){return e.props.setContextualHelp(p.Nb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:this.getPianoClass(),src:this.getPianoIcon()}),u.a.createElement("img",{onMouseOver:function(){return e.props.setContextualHelp(p.h)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.onClickLooping()},className:"loop-icon",src:this.getLoopIcon()}))}},{key:"getLoopIcon",value:function(){return this.props.looping?"/arrow-loop-looping.png":"/arrow-loop.png"}},{key:"onClickLooping",value:function(){this.props.sequencerEngine.restartAllMixes(!this.props.looping),this.props.setLooping(!this.props.looping)}},{key:"getLoopClass",value:function(){return this.props.looping?"loop-icon looping":"loop-icon"}},{key:"onClickAutomationMode",value:function(){this.props.automationMode===d.a?this.props.setProjectAutomationMode(d.b):this.props.automationMode===d.b&&this.props.setProjectAutomationMode(d.a)}},{key:"getAutomationIcon",value:function(){return this.props.automationMode===d.b?"/automation-icon-enabled.png":"/automation-icon-disabled.png"}}]),n}(c.Component);t.a=Object(h.b)(function(e,t){var n=t.sequencerEngine.getSequenceId(),r=e.sequencer.isPlaying[n]||0;return{isRecordingMix:window.installation?e.sequencer.isRecording:e.mix.isRecordingMix,isRecording:e.sequencer.isRecording,isPlayingMix:e.mix.isPlayingMix,isPlaying:r,showPianoRoll:e.sequencer.showPianoRoll,automationMode:e.sequencer.automationMode,playScheduled:e.clock.playScheduled,looping:e.arrangement.looping,bottomMode:e.arrangement.bottomMode}},function(e){return{setShowPianoRoll:function(t){return e(Object(f.Wf)(t))},setIsPlayingMix:function(t){return e(Object(f.Hc)(t))},setIsRecordingMix:function(t){return e(Object(f.Lc)(t))},setProjectAutomationMode:function(t){return e(Object(f.te)(t))},setContextualHelp:function(t){return e(Object(f.ub)(t))},setLooping:function(t){return e(Object(f.H)(t))},setArrangementMouseX:function(t){return e(Object(f.J)(t))},setArrangementBottomMode:function(t){return e(Object(f.D)(t))},setArrangementCursorStep:function(t){return e(Object(f.F)(t))},setPianoRollCursor:function(t){return e(Object(f.Zd)(t))}}})(v)},function(e,t,n){"use strict";var r=n(7),a=n(10),i=n(1),o=n(2),s=n(4),c=function(){function e(t,n){Object(o.a)(this,e),this.sampler=t,this.sliceNumber=n}return Object(s.a)(e,[{key:"start",get:function(){return this.sampler.getStartTime(this.sliceNumber)},set:function(e){this.sampler.slice(this.sliceNumber,e,this.end)}},{key:"end",get:function(){return this.sampler.getEndTime(this.sliceNumber)},set:function(e){this.sampler.slice(this.sliceNumber,this.start,e)}}]),e}(),u=n(5),l=n.n(u),f=n(14);function h(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.cursor.step;return e.getSelectedTrack().getEasyPattern().getStepsAtStepNumber(e.cursor.step).map(function(e){return e.step})}var p=n(62),d=n(77);function m(e,t){var n=t.split("=");if(2!=n.length)return!1;var r=n[0],a=n[1];if(!Object(p.a)(a))return!1;if(a=parseFloat(a),"length"===r)return function(e,t){t=d.a.baseResolution.transformStepAtResolution2(t,e.resolution);var n=e.getSelectedTrack();n.pattern.changeLength(t),n.updateSteps()}(e,a),!0;var i=h(e);for(var o in i){var s=i[o];if(!(r in s))return!1;s[r]=a}return e.getSelectedTrack().updateSteps(),!0}var v=n(6),b=n(1042),g=function(){function e(t){Object(o.a)(this,e),this.sequencerEngine=t}return Object(s.a)(e,[{key:"run",value:function(e){return"run"!==e&&(e.indexOf("=")>-1?m(this.sequencerEngine,e):e in this&&(this[e](),!0))}},{key:"warp",value:function(){this.track&&(this.track.warp(),this.sequencerEngine.update())}},{key:"gate",value:function(){this.track&&(this.track.gated=!0)}},{key:"ungate",value:function(){this.track&&(this.track.gated=!1)}},{key:"sampleSynth",value:function(){this.sequencerEngine.autoResampleMode=!0,this.sequencerEngine.masterResampler.prepare(),this.sequencerEngine.store.dispatch(Object(v.Be)(!0))}},{key:"freezeInstrument",value:function(){Object(b.a)(this.sequencerEngine)}},{key:"makeInstrument",value:function(){var e=Object(f.a)(l.a.mark(function e(){var t,n,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.sequencerEngine.addSampledInstrumentTrack(),e.t0=l.a.keys(this.sequencerEngine.tracks);case 2:if((e.t1=e.t0()).done){e.next=10;break}if(n=e.t1.value,!(r=this.sequencerEngine.tracks[n].sample)){e.next=8;break}return e.next=8,t.instrument.newSample(void 0,r);case 8:e.next=2;break;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"pack",value:function(){this.sequencerEngine.dispatch(Object(v.wb)(!0))}},{key:"track",get:function(){return this.sequencerEngine.getSelectedTrack()}}]),e}(),y=n(9),k=n(46),O=500;function j(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;t.cursor.step;w(t)&&function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.getSelectedStepData(),r=new Set;for(;n.on;)if(r.add(n.id),t?e.right(!1):e.left(!1),n=e.getSelectedStepData(),r.has(n.id))return void e.cursor.updateRedux();e.cursor.updateRedux()}(t,e),E(t,e)}function w(e){var t=e.cursor.getStep(e.resolution);return e.getSelectedTrack().getEasyPattern().getStepsAtStepNumber(t,e.resolution).map(function(e){return e.step}).some(function(e){return e.on})}function E(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.getSelectedStepData(),r=new Set,a=0;!n.on;)if(a++,r.add(n.id),t?e.right(!1):e.left(!1),n=e.getSelectedStepData(),r.has(n.id)||a>O)return void e.cursor.updateRedux();e.cursor.updateRedux()}var S=n(8);function P(e){for(var t=e.getSelectedStep()%e.resolution.numSteps(),n=0;n<t;n++)e.left(!1);e.cursor.updateRedux()}function x(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.resolution.numSteps(),r=0;r<n;r++)e.right(!1);t&&e.cursor.updateRedux()}function T(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.resolution.numSteps(),r=0;r<n;r++)e.left(!1);e.cursor.updateRedux(),t&&e.cursor.updateRedux()}var C=500;function N(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];w(e)||E(e);for(var n=e.getSelectedTrack(),r=n.getEasyPattern(),a=[],i=new Set,o=0;w(e);){o++;var s=e.getSelectedStepData();if(i.has(s)||o>C)return;i.add(s);var c=e.cursor.getStep(e.resolution),u=r.getStepsAtStepNumber(c,e.resolution).map(function(t){return Object(S.a)({},t,{stepNumber:e.cursor.step})});a=[].concat(Object(y.a)(a),Object(y.a)(u)),e.right()}var l=M(a);return t&&e.operationManager.dispatch(Object(k.h)(n,a.map(function(e){return e.step}))),l}function R(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];P(e);for(var n=e.resolution.numSteps(),r=e.resolution.getNumberOfStepsAtBaseResolution(),a=[],i=e.getSelectedTrack(),o=i.getEasyPattern(),s=e.cursor.step,c=0;c<n;c++){var u=o.getStepsAtStepNumber(s).map(function(e){return Object(S.a)({},e,{stepNumber:s})});a=[].concat(Object(y.a)(a),Object(y.a)(u)),s+=r}var l=M(a);return t&&e.operationManager.dispatch(Object(k.h)(i,a.map(function(e){return e.step}))),l}function M(e){var t=[];for(var n in e)t.push(Object(S.a)({},e[n],{step:e[n].step.getCopy(!0,!1,!0,!1,!1)}));return t}var A=function(){function e(t){var n=this;Object(o.a)(this,e),this.sequencerEngine=t,this.cursor=t.cursor,this.currentCommand=void 0,this.number=void 0,this.killRing=[],this[0]=function(){n.zero()}}return Object(s.a)(e,[{key:"run",value:function(e){e in this&&(this.currentCommand&&this.number?(this[e](parseInt(this.number)),this.number=void 0,this.currentCommand=void 0):(this[e](),this.currentCommand=e)),Object(p.a)(e)&&(void 0===this.number&&(this.number=""),this.number+=e)}},{key:"d",value:function(e){if(e=void 0===e?1:e,"d"==this.currentCommand){this.killRing=[];for(var t=0;t<e;t++)this.killRing=[].concat(Object(y.a)(this.killRing),Object(y.a)(R(this.sequencerEngine))),x(this.sequencerEngine,!1);for(var n=0;n<e;n++)T(this.sequencerEngine,!1);this.updateRedux(),this.currentCommand=void 0}}},{key:"x",value:function(){this.killRing=function(e){var t=e.getSelectedTrack();if(w(e)){var n=e.getSelectedStepData(),r=e.cursor.step,a=M([{stepNumber:r,step:n}]);return e.operationManager.dispatch(Object(k.g)(t,r)),a}return[]}(this.sequencerEngine)}},{key:"w",value:function(e){if("d"!=this.currentCommand)if("y"!=this.currentCommand){e=void 0===e?1:e-1;for(var t=0;t<e;t++)j(!0,this.sequencerEngine)}else{e=void 0===e?1:e,this.killRing=[];for(var n=0;n<e;n++)this.killRing=[].concat(Object(y.a)(this.killRing),Object(y.a)(N(this.sequencerEngine,!1)));this.currentCommand=void 0}else{e=void 0===e?1:e,this.killRing=[];for(var r=0;r<e;r++)this.killRing=[].concat(Object(y.a)(this.killRing),Object(y.a)(N(this.sequencerEngine)));this.currentCommand=void 0}}},{key:"b",value:function(e){e=void 0===e?1:e-1;for(var t=0;t<e;t++)j(!1,this.sequencerEngine)}},{key:"h",value:function(){this.sequencerEngine.left()}},{key:"l",value:function(){this.sequencerEngine.right()}},{key:"j",value:function(){x(this.sequencerEngine)}},{key:"k",value:function(){T(this.sequencerEngine)}},{key:"t",value:function(){this.dispatch(Object(k.t)(this.track,this.stepNumber,this.resolution))}},{key:"e",value:function(){this.cursor.show=!this.cursor.show}},{key:"zero",value:function(){P(this.sequencerEngine)}},{key:"a",value:function(){this.track.doubleTrackLength()}},{key:"s",value:function(){this.track.halfTrackLength()}},{key:"o",value:function(){!function(e){var t=h(e,e.cursor.step);for(var n in t){var r=t[n].duration||1;t[n].duration=r+1}e.getSelectedTrack().updateSteps()}(this.sequencerEngine)}},{key:"i",value:function(){!function(e){var t=h(e,e.cursor.step);for(var n in t){var r=t[n].duration||1;t[n].duration=Math.max(1,r-1)}e.getSelectedTrack().updateSteps()}(this.sequencerEngine)}},{key:"y",value:function(e){if(e=void 0===e?1:e,"y"==this.currentCommand){this.killRing=[];for(var t=0;t<e;t++)this.killRing=[].concat(Object(y.a)(this.killRing),Object(y.a)(R(this.sequencerEngine,!1))),x(this.sequencerEngine,!1);for(var n=0;n<e;n++)T(this.sequencerEngine,!1);this.updateRedux(),this.currentCommand=void 0}}},{key:"p",value:function(){!function(e,t){var n=e.getSelectedTrack(),r=e.cursor.step,a=Math.min.apply(Math,Object(y.a)(t.map(function(e){return e.stepNumber})));t=t.map(function(e){return Object(S.a)({},e,{stepNumber:r+e.stepNumber-a})});var i=e.operationManager;t.forEach(function(e){return i.dispatch(Object(k.c)(n,e.step.getCopy(!0,!1,!0,!1,!1),e.stepNumber))}),n.updateSteps()}(this.sequencerEngine,Object(y.a)(this.killRing))}},{key:"stepNumber",get:function(){return this.sequencerEngine.getSelectedStep()}},{key:"track",get:function(){return this.sequencerEngine.getSelectedTrack()}},{key:"op",get:function(){return this.sequencerEngine.operationManager}},{key:"dispatch",value:function(e){this.op.dispatch(e)}},{key:"resolution",get:function(){return this.sequencerEngine.resolution}},{key:"updateRedux",value:function(){this.cursor.updateRedux()}}]),e}(),q=n(1066);function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var o=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(a.a)(this,n)}}var I=function(){function e(t){Object(o.a)(this,e),this.sequencerEngine=t,this.emacsScripting=new g(this.sequencerEngine),this.viScripting=new A(this.sequencerEngine),this.cursor=t.cursor,this.clipboard=[],this.cmd={},this.stepFunctions={},this.stepTimes={},this.commandHistory=[],this.historyCounter=0,this.futureCalls=[]}return Object(s.a)(e,[{key:"viCommand",value:function(e){var t=void 0!==this.viScripting.currentCommand;return this.viScripting.run(e),t}},{key:"emacsCommand",value:function(e){this.emacsScripting.run(e)}},{key:"isEmacsCommand",value:function(){return"M-x"===this.sequencerEngine.state.commands.commandPrefix}},{key:"runScript",value:function(e){if(this.isEmacsCommand())return this.emacsScripting.run(e),!0;try{if(this.commandHistory.push({cursor:this.cursor.getJson(),command:e,enabled:!0}),e.startsWith("/"))this.search(e.slice(1));else if(e.startsWith("+"))this.addCommand(e.slice(1));else{if(e.startsWith(":"))return this.emacsScripting.run(e.slice(1));t=this,new Function("with(this) { "+e+"}").call(t)}return this.historyCounter=0,!0}catch(n){return void 0!==this.onFlashInfo&&this.onFlashInfo(n.message),!1}var t}},{key:"runEmacsCommand",value:function(e){}},{key:"search",value:function(e){var t=e.endsWith("/");t&&(e=e.slice(0,e.length-1));var n=e.split("+");this.sequencerEngine.searchForSounds(n,t)}},{key:"addCommand",value:function(e){Object(q.a)(this.sequencerEngine,e)}},{key:"getJson",value:function(){return{commandHistory:this.commandHistory.filter(function(e){return e.enabled})}}},{key:"fromJson",value:function(e){for(var t=e.commandHistory,n=0;n<t.length;n++){var r=null;if("string"===typeof t[n])this.cursor.step=0,this.cursor.track=0,r=t[n];else if("cursor"in t[n]){var a=t[n].cursor;this.cursor.step=a.step,this.cursor.track=a.track,r=t[n].command}this.runScript(r)}}},{key:"recordMix",value:function(e){this.sequencerEngine.recordingMix=e}},{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.sequencerEngine.getSelectedTrack().getSamplers()[0];return new c(t,e)}},{key:"midiFX",value:function(){var e=this;this.sequencerEngine.getSelectedTrack(),this.sequencrerEngine.midiEffects;return function(){e.sequencerEngine.getSelectedTrack()}}},{key:"left",value:function(){this.sequencerEngine.left()}},{key:"right",value:function(){this.sequencerEngine.right()}},{key:"up",value:function(){this.sequencerEngine.up()}},{key:"down",value:function(){this.sequencerEngine.down()}},{key:"arp",value:function(e){this.sequencerEngine.getSelectedTrack().trackData.arpOn=e}},{key:"arpRate",value:function(e,t){this.sequencerEngine.getSelectedTrack()}},{key:"arpOctaves",value:function(e){this.sequencerEngine.getSelectedTrack().trackData.arpOctaves=e}},{key:"steps",value:function(e){var t=this.sequencerEngine.getSelectedTrack(),n=t.getStepsAtResolution(this.sequencerEngine.resolution);void 0===e&&(e=n.length),e+this.sequencerEngine.getSelectedStep()>=n.length&&(e-=e+this.sequencerEngine.getSelectedStep()-n.length);var r=this.sequencerEngine.getSelectedStep();return new _(this.sequencerEngine,t,n.slice(r,r+e),r)}},{key:"copy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.clipboard=this.steps(e).map(function(e){return e.getCopy()}),this.clipboard[0]}},{key:"paste",value:function(){for(var e=this.steps(this.clipboard.length).stepDataList,t=0;t<e.length;t++)e[t].copyFrom(this.clipboard[t]);this.sequencerEngine.getSelectedTrack().syncBuckets(this.sequencerEngine.resolution),this.sequencerEngine.getSelectedTrack().updateSteps()}},{key:"rand",value:function(){return Math.random()}},{key:"onStepReached",value:function(e){if(e in this.stepFunctions){try{this.stepFunctions[e].map(function(e){return e()})}catch(t){void 0!==this.onFlashInfo&&this.onFlashInfo(t.message)}this.stepTimes[e]++}}},{key:"stepFunction",value:function(e){var t=this,n=this.steps().get(0),r=(this.sequencerEngine.getSelectedTrack(),this.cursor.step),a=function(){e(n,t.stepTimes[r])};r in this.stepFunctions?this.stepFunctions[r].push(a):(this.stepFunctions[r]=[a],this.stepTimes[r]=0)}},{key:"volume",value:function(e){this.sequencerEngine.getSelectedTrack().setRawVolume(e)}},{key:"start",value:function(){this.cursor.step=0}},{key:"end",value:function(){var e=this.sequencerEngine.getTrackLength();this.cursor.setStep(e-1,this.sequencerEngine.resolution)}},{key:"line",value:function(e){var t=this;this.steps(e).map(function(){t.right()})}},{key:"clearStepFunctions",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=0;t<e;t++){var n=this.cursor.step+t;delete this.stepFunctions[n]}}},{key:"pattern",value:function(e){this.sequencerEngine.switchToPattern(e)}},{key:"clearSequence",value:function(){this.sequencerEngine.clearSequence()}},{key:"clear",value:function(){this.sequencerEngine.getSelectedTrack().pattern.clear()}},{key:"upHistory",value:function(){var e=this.commandHistory.length-this.historyCounter-1,t=this.commandHistory[e];return this.historyCounter=Math.min(this.historyCounter+1,this.commandHistory.length),void 0===t?"":t.command}},{key:"downHistory",value:function(){return this.historyCounter--,this.historyCounter<=0?(this.historyCounter=0,""):this.commandHistory[this.commandHistory.length-this.historyCounter].command}},{key:"deleteHistoryForTrack",value:function(e){for(var t=[],n=0;n<this.commandHistory.length;n++)this.commandHistory[n].cursor.track!=e&&t.push(this.commandHistory[n]);this.commandHistory=t}},{key:"currentStep",get:function(){return this.sequencerEngine.trackStep}},{key:"map",value:function(e){this.sequencerEngine.stepNumberScript=e}},{key:"phi",get:function(){return 1.61803398875}},{key:"com",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=e,r=t.length-1;r>=0;r--)n=t[r](n);return n}}}]),e}();var _=function(e){Object(r.a)(n,e);var t=D(n);function n(e,r,a,i){var s,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return Object(o.a)(this,n),(s=t.call(this,e)).stepDataList=a,s.step=i,s.stepOffset=c,s.track=r,s}return Object(s.a)(n,[{key:"filter",value:function(e){return new n(this.sequencerEngine,this.track,this.stepDataList.filter(e),this.step)}},{key:"isOn",value:function(){return this.filter(function(e){return e.on})}},{key:"sync",value:function(){this.sequencerEngine.getSelectedTrack().syncBuckets(this.sequencerEngine.resolution),this.track.updateSteps()}},{key:"get",value:function(e){return this.stepDataList[e]}},{key:"even",value:function(){for(var e=[],t=0;t<this.stepDataList.length;t+=2)e.push(this.stepDataList[t]);return new n(this.sequencerEngine,this.track,e,this.step,2*this.stepOffset)}},{key:"odd",value:function(){for(var e=[],t=1;t<this.stepDataList.length;t+=2)e.push(this.stepDataList[t]);var r=this.sequencerEngine.resolution.transformStepAtBaseResolution(1);return new n(this.sequencerEngine,this.track,e,this.step+r,2*this.stepOffset)}},{key:"stepFunction",value:function(e){var t=this;this.do(function(){return t.sequencerEngine.scripting.stepFunction(e)})}},{key:"do",value:function(e){var t=this.sequencerEngine.cursor,n=t.step,r=this.step;for(var a in this.stepDataList)t.step=r,e(),r+=this.sequencerEngine.resolution.transformStepAtBaseResolution(this.stepOffset);t.step=n}},{key:"on",get:function(){return this.map(function(e){return e.on})},set:function(e){this.map(function(t,n){return t.on="function"===typeof e?e(n):e}),this.sync()}},{key:"duration",get:function(){return this.map(function(e){return e.duration})},set:function(e){this.map(function(t,n){return t.duration="function"===typeof e?e(n):e}),this.sync()}},{key:"chop",get:function(){return this.map(function(e){return e.chop})},set:function(e){this.map(function(t,n){return t.chop="function"===typeof e?e(n):e}),this.sync()}},{key:"velocity",get:function(){return this.map(function(e){return e.velocity})},set:function(e){this.map(function(t,n){return t.velocity="function"===typeof e?e(n):e}),this.sync()}},{key:"transpose",get:function(){return this.map(function(e){return e.transpose})},set:function(e){this.map(function(t,n){return t.transpose="function"===typeof e?e(n):e}),this.sync()}},{key:"attack",get:function(){return this.map(function(e){return e.attack})},set:function(e){this.map(function(t,n){return t.transpose="function"===typeof e?e(n):e}),this.sync()}},{key:"release",get:function(){return this.map(function(e){return e.release})},set:function(e){this.map(function(t,n){return t.transpose="function"===typeof e?e(n):e}),this.sync()}},{key:"map",value:function(e){var t=this.stepDataList.map(e);return this.sync(),t}}]),n}(I);t.a=I},function(e,t,n){"use strict";var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=(n(30),n(420),n(52)),l=function e(){Object(s.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"},{name:"month",type:"uint32"},{name:"year",type:"uint32"}],name:"newMonthlyIndex",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"sampleHash",type:"bytes32"},{indexed:!0,name:"month",type:"uint32"},{indexed:!0,name:"year",type:"uint64"}],name:"NewMonthlyIndex",type:"event"}],this.contractAddress="0xfaa21e766f988524d3f38b9c46c22aca11d76dd5"},f=n(192),h=n(36),p=n(31),d=n(47),m=new l,v=function(){function e(){Object(s.a)(this,e),this.indexContract=new h.a.eth.Contract(m.abi,m.contractAddress),this.indexContractAddress=this.indexContract.options.address}return Object(c.a)(e,[{key:"getIndexForMonth",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new f.a(this.indexContractAddress).from(p.A).select("hash").where("month",t).where("year",n).executeQuery();case 2:if(r=e.sent,console.log("got the results for monthly = "),console.log(r),void 0!==r&&0!==r.length){e.next=7;break}return e.abrupt("return");case 7:return a=r[0].hash,e.next=10,d.a.getJson(a);case 10:return o=e.sent,e.abrupt("return",o);case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function b(e){var t=void 0;for(var n in e){var r=e[n];void 0!==r&&(t=void 0!==t?g(t,r):r)}return t}function g(e,t){var n={};for(var r in e){var a=e[r],i=t[r];for(var o in n[r]={},a){var s=a[o],c=i[o];n[r][o]=y(s,c)}}return n}function y(e,t){var n=k(e),a=k(t),i={};for(var o in n)i[o]=o in a?[].concat(Object(r.a)(n[o]),Object(r.a)(a[o])):n[o];for(var s in a)s in n||(i[s]=n[s]);return function(e){return Object.keys(e).map(function(t){return{dimension:t,values:e[t]}})}(i)}function k(e){var t={};for(var n in e){var r=e[n];t[r.dimension]=r.values}return t}var O=n(40),j=function(){function e(){Object(s.a)(this,e),this.abi=[{constant:!1,inputs:[{internalType:"uint32",name:"guildId",type:"uint32"},{internalType:"bytes32",name:"ipfsHash",type:"bytes32"}],name:"newIndex",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"guildsAddress",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"},{indexed:!1,internalType:"bytes32",name:"indexHash",type:"bytes32"}],name:"NewIndex",type:"event"}],this.contractAddress="0xefBe8bf3720fE3aD117B1397DD95c77240Fe8837"}return Object(c.a)(e,[{key:"getContract",value:function(e){return console.log("getting contract w address = "+this.contractAddress),new e.eth.Contract(this.abi,this.contractAddress)}}]),e}(),w=(n(127),new j),E=new v,S={},P=function(){function e(t){var n=this;Object(s.a)(this,e),this.fullIndex=void 0,this.guildId=0,this.useMonth=!1,this.monthlyIndices=[],this.monthlyFilter=void 0,this.store=t,t&&this.store.subscribe(function(){return n.onStateUpdate()})}return Object(c.a)(e,[{key:"onStateUpdate",value:function(){var e=this.store.getState(),t=e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0;t!==this.guildId&&(this.guildId=t,this.loadIndex())}},{key:"loadNewIndex",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.guildId=t,e.next=3,this.loadIndex();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"index",get:function(){return this.useMonth?void 0===this.monthlyIndex?this.fullIndex:this.monthlyIndex.index:this.fullIndex}},{key:"toBlock",get:function(){return this.monthlyIndex.toBlock}},{key:"fromBlock",get:function(){return this.monthlyIndex.fromBlock}},{key:"filterByMonth",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.monthlyFilter&&this.monthlyFilter.month===t&&this.monthlyFilter.year===n){e.next=4;break}return e.next=3,E.getIndexForMonth(t,n);case 3:this.monthlyIndex=e.sent;case 4:return this.useMonth=!0,this.monthlyFilter={month:t,year:n},e.abrupt("return",!0);case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"clearFilter",value:function(){this.useMonth=!1}},{key:"loadIndex",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=n.length>0&&void 0!==n[0]?n[0]:this.guildId)||!u.a.isLoggedIn()){e.next=6;break}return e.next=4,this.fetchAndMergeIndices();case 4:return this.fullIndex=e.sent,e.abrupt("return");case 6:return e.next=8,this.fetchIndex(t);case 8:this.fullIndex=e.sent;case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchAndMergeIndices",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=[0],n=Array.from(new Set(t.map(function(e){return e.guildId}))),r=[],e.t0=i.a.keys(n);case 4:if((e.t1=e.t0()).done){e.next=15;break}return a=e.t1.value,o=n[a],console.log("fetching index for guildId = "+o),e.t2=r,e.next=11,this.fetchIndex(o);case 11:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=4;break;case 15:return console.log("indices to merge = "),console.log(r),e.abrupt("return",b(r));case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchIndex",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:this.guildId,e.next=3,this.getIndexHash(t);case 3:if(n=e.sent,console.log("hash returned = "+n),void 0!==n){e.next=8;break}return e.abrupt("return",void 0);case 8:return e.next=10,d.a.getJson(n);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAllForField",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(void 0===this.index)return[];var r=this.index[e][e].map(function(e,t){return{value:e.dimension,rank:t}});return this.sort(r),r.length<t+n?r.slice(t):r.slice(t,t+n)}},{key:"getFieldsForField",value:function(e,t,n){if(void 0===this.index)return new Set([]);var a=this.index[t][e].filter(function(e){return e.dimension==n});if(0==a.length)return new Set([]);if(void 0===a[0].values)return new Set;var i=Object(r.a)(a[0].values).map(function(e,t){return{value:e,rank:t}});return this.sort(i),new Set(i)}},{key:"freeTextSearch",value:function(e,t){var n=this.getAllForField(e,0,5e3);return n=n.filter(function(e){return e.value.toString().toLowerCase().includes(t.toLowerCase())}).map(function(e,t){return{value:e.value,rank:e.rank}})}},{key:"sort",value:function(e){return e.sort(function(e,t){return e=e.value,t=t.value,void 0===e[0]?1:void 0===t[0]?-1:e[0]===e[0].toLocaleLowerCase()&&t[0]===t[0].toLocaleLowerCase()||e[0]===e[0].toLocaleUpperCase()&&t[0]===t[0].toLocaleUpperCase()?e.localeCompare(t):e[0]===e[0].toLocaleLowerCase()?-1:1})}},{key:"getIndexHash",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in S)){e.next=4;break}return e.next=3,S[t];case 3:return e.abrupt("return",e.sent);case 4:return n=new Promise(function(){var e=Object(o.a)(i.a.mark(function e(n,r){var a,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new O.a(w.contractAddress).from(p.w).select("indexHash").where("guildId",t).limit(1),e.next=3,a.executeQuery();case 3:if(0!==(o=e.sent).length){e.next=7;break}return n(void 0),e.abrupt("return");case 7:s=o[0].indexHash,n(s);case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),S[t]=n,e.next=8,n;case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),e}();t.a=P},function(e,t,n){"use strict";var r=n(9),a=n(11),i=n(0),o=n.n(i),s=n(164),c=n.n(s),u=(n(30),n(12));t.a=Object(u.b)(function(e,t){return{pendingTransactions:e.transactions.pendingTransactions}},function(e){return{}})(function(e){var t=e.content,n=e.pendingTransactions,s=e.setTagSelected,u=e.onTag,l=e.tagSelected,f=Object(i.useRef)(void 0),h=Object(i.useState)(""),p=Object(a.a)(h,2),d=p[0],m=p[1],v=Object(i.useState)(t.tags),b=Object(a.a)(v,2),g=b[0],y=b[1],k=Object(i.useCallback)(function(e){m(e.target.value)},[m]);Object(i.useEffect)(function(){y(t.tags)},[y,t.ipfsHash,n]),Object(i.useEffect)(function(){s||f.current.focus()},[]);var O=Object(i.useCallback)(function(){""!==d.trim()&&(t.newTag(d),y([].concat(Object(r.a)(g),[d])),m(""),u&&u(d))},[t.ipfsHash,d,g,y,m,u]),j=Object(i.useCallback)(function(e){"Enter"===e.key?O():"ArrowDown"!==e.key&&"ArrowUp"!==e.key||f.current.blur()},[O,u]);return o.a.createElement("div",{className:"tags-info"},o.a.createElement("div",{className:"tags-container"},g.map(function(e){return o.a.createElement("div",{onClick:function(){return s?s(e===l?void 0:e):""},className:e===l?"sample-tag selected":l?"sample-tag disabled":"sample-tag"},e)}),o.a.createElement(c.a,{sizeUnit:"px",size:10,color:"#42f4f1",loading:n>0})),o.a.createElement("div",{className:"tagger-container"},o.a.createElement("input",{ref:f,onKeyDown:j,placeholder:"Type new tag",onChange:k,value:d,type:"text",className:"sample-tagger"}),o.a.createElement("div",{onClick:O,className:"tag-button"},"Tag")))})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(33),o=n(39),s=n.n(o),c=n(34),u=n(12),l=n(6);var f=[{value:new i.a(4,!1),label:"1/4"},{value:new i.a(4,!0),label:"1/4t"},{value:new i.a(8,!1),label:"1/8"},{value:new i.a(8,!0),label:"1/8t"},{value:new i.a(16,!1),label:"1/16"},{value:new i.a(16,!0),label:"1/16t"},{value:new i.a(32,!1),label:"1/32"},{value:new i.a(32,!0),label:"1/32t"}];function h(e){for(var t=0;t<f.length;t++)if(f[t].value.resolution==e.resolution&&f[t].value.isTriplet==e.isTriplet)return f[t];return null}t.a=Object(u.b)(function(e){return{resolution:e.sequencer.displayResolution}},function(e){return{setContextualHelp:function(t){return e(Object(l.ub)(t))},setDisplayResolution:function(t){return e(Object(l.Kb)(t))}}})(function(e){return a.a.createElement("div",{onMouseOver:function(){return e.setContextualHelp(c.xb)},onMouseLeave:function(){return e.setContextualHelp(void 0)}},a.a.createElement(s.a,{className:"resolution-dropdown",options:f,onChange:function(t){return n=t.value,e.sequencerEngine.resolution=n,e.setDisplayResolution(n),e.sequencerEngine.updateSteps(),void(e.sequencerEngine.tracks.length>0&&e.sequencerEngine.select(e.sequencerEngine.cursor.track,0));var n},value:h(e.resolution),placeholder:"Select a resolution"}))})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(538),s=n(29),c=n(12);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e){var t=e.sampleDragging,n=e.slotNumber,r=e.slot,i=e.pad,o=e.sampleTagDragging,s=e.setSampleDragging,c=e.setSampleTagDragging,l=e.setTrackDragging,f=e.trackDragging;return{onDrop:Object(a.useCallback)(function(e){if(e.stopPropagation(),i.sequencerEngine.switchToSubSequence(i.subSequence.id),f)i.tracks.includes(f)?i.switch(n,i.tracks.indexOf(f)):i.addTrack(f,n);else if(t){var a=i.containsSample(t);if(a)i.switch(n,i.tracks.indexOf(a));else{var h,p=u(i.subSequence.tracks);try{for(p.s();!(h=p.n()).done;){var d=h.value;if(!d.isFrozen&&d.sample===t){var m=0===d.getEasyPattern().getAllSteps().length;return i.addTrack(d,n,m),void s(void 0)}}}catch(g){p.e(g)}finally{p.f()}i.slots[n]?t.audioBuffer?i.slots[n].useNewSound(t):t.load().then(function(e){return i.slots[n].useNewSound(t)}):i.newSample(t,n)}}else if(o){var v=i.sequencerEngine,b=v.state.selector.sampleTagDragging;Array.isArray(b)||(b=[b]),v.searchForSounds(b,r,r,void 0,!1).then(function(e){r||i.addTrack(e,n,!0)}),c(void 0)}l(void 0),s(void 0),l(void 0)},[t,r,n,i,o,f,l])}},h=n(6),p=new s.a,d=Object(c.b)(function(e,t){return{sampleDragging:e.selector.sampleDragging,sampleTagDragging:e.selector.sampleTagDragging,trackDragging:e.tracks.trackDragging}},function(e){return{setSampleDragging:function(t){return e(Object(h.He)(t))},setTrackDragging:function(t){return e(Object(h.Sg)(t))},setSampleTagDragging:function(t){return e(Object(h.Le)(t))},setParameterSliderDown:function(t){return e(Object(h.Sd)(t))},setArrangementBottomMode:function(t){return e(Object(h.D)(t))},setShowPianoRoll:function(t){return e(Object(h.Wf)(t))},setContextualHelp:function(t){return e(Object(h.ub)(t))},setSelectedZObject:function(t){return e(Object(h.uf)(t))}}})(function(e){var t=e.sampleDragging,n=e.slotNumber,r=e.pad,a=e.sampleTagDragging,o=e.setSampleDragging,s=e.setSampleTagDragging,c=e.slot,u=e.trackDragging,l=e.setTrackDragging,h=(e.setParameterSliderDown,e.setArrangementBottomMode,e.setShowPianoRoll,e.size),d=(e.setContextualHelp,e.setSelectedZObject),m=e.scale,v=e.attributes,b=f({sampleDragging:t,slotNumber:n,pad:r,sampleTagDragging:a,setSampleDragging:o,setSampleTagDragging:s,slot:c,trackDragging:u,setTrackDragging:l}).onDrop;return i.a.createElement("div",{style:{backgroundColor:v?v["slot-color"]&&p.transparent(p.saturate(v["slot-color"],1),v["slot-opacity"]||1):void 0,width:h,height:h,margin:3*m+"px"},onClick:function(e){e.stopPropagation(),d(void 0)},onDrop:b,className:"empty pad-slot"})}),m=n(34),v=n(182),b=n(272),g=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.hide,n=e.pad,o=Object(a.useState)(""),s=Object(r.a)(o,2),c=s[0],u=s[1],l=Object(a.useCallback)(function(){Object(b.d)(c,n),t()},[c,t,n]);return i.a.createElement("div",{className:"pads save-pad"},i.a.createElement("div",{className:"pad-inner"},i.a.createElement("div",null,"Save as Pack"),i.a.createElement("input",{value:c,type:"text",className:"pack-name",onChange:function(e){return u(e.target.value)},placeholder:"Type name for pack"}),i.a.createElement("div",{className:"complete-buttons"},i.a.createElement("div",{onClick:l,className:"done-btn"},"Done"),i.a.createElement("div",{onClick:t,className:"cancel-btn"},"Cancel"))))}),y=(n(244),n(139),n(203)),k=n(76),O=n(1376),j=n(559),w=n(9),E=n(651),S=n(367),P=Object(c.b)(function(e,t){return{tracks:t.pad.tracks}},function(e){return{}})(function(e){var t=e.pad,n=Object(a.useState)(1),o=Object(r.a)(n,2),s=o[0],c=o[1],u=Object(a.useState)(!1),l=Object(r.a)(u,2),f=l[0],h=l[1],p=Math.max.apply(Math,Object(w.a)(t.tracks.filter(function(e){return e}).map(function(e){return e.pattern.length()})));p===-1/0&&(p=32);var d=p/32;Object(S.a)({clear:function(){return h(!1)},selected:f});var v=Object(a.useCallback)(function(e){e.stopPropagation(),t.tracks.filter(function(e){return e}).forEach(function(e){return e.halfTrackLength()}),c(s/2)},[t,c,s]),b=Object(a.useCallback)(function(e){e.stopPropagation(),t.tracks.filter(function(e){return e}).forEach(function(e){return Object(E.a)(e,void 0,t.sequencerEngine.resolution)}),c(2*s)},[t,c,s]),g="";return f&&(g=i.a.createElement("div",{className:"length-dropdown"},i.a.createElement("div",{onMouseDown:v,className:"length-btn"},"-"),i.a.createElement("div",{onMouseDown:b,className:"length-btn"},"+"))),i.a.createElement(k.a,{element:m.X,className:"pad-length"},g,"Length ",i.a.createElement("span",{onMouseDown:function(){return h(!0)},className:"bars"},d)," bars")}),x=function(e){var t=e.element,n=e.option,r=e.name,a=e.mode,o=e.setMode,s="pad-toolbar-btn";return n===a&&(s+=" selected"),i.a.createElement(k.a,{element:t,onClick:function(){return o(n===a?void 0:n)},className:s},r)},T=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.pad,n=e.setMode,r=e.mode,o=Object(a.useCallback)(function(e){n("WAVEFORM"===r?void 0:"WAVEFORM")},[r,n]);return i.a.createElement("div",{className:"pad-toolbar"},i.a.createElement(x,{element:m.W,mode:r,setMode:n,option:"DELETE",name:"Delete"}),i.a.createElement(x,{element:m.Y,mode:r,setMode:n,option:"MUTES",name:"Mutes"}),i.a.createElement(k.a,{element:m.bb,onClick:o,className:"WAVEFORM"===r?"waveform-btn selected":"waveform-btn"},i.a.createElement("div",{className:"wave"}),i.a.createElement("div",{className:"wave"})),i.a.createElement(P,{pad:t}))}),C=n(8),N=n(1411),R=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.slotNumber,n=e.pad,s=(e.sliderMaterial,e.style),c=Object(a.useState)(void 0),u=Object(r.a)(c,2),l=u[0],f=u[1];return Object(a.useEffect)(function(){return f(n.newSliderRenderer(t)),function(){n.freeSliderRenderer(t)}},[]),l?i.a.createElement(o.a,{className:"slider-canvas",width:s.width,height:s.height,zobject:l}):""}),M=n(147),A=n(206),q=n(736),D=Object(c.b)(function(e,t){var n=t.track,r={};if(n){var a=e.tracks.triggers[n.trackNumber];if(a)for(var i in a)a[i]&&(r.playing=!0);r.playing||(r.playing=n.notesTriggered&&Object.keys(n.notesTriggered).length>0),r.isSelected=n&&e.mix.selectedTrack===n.trackNumber}return r},function(e){return{}})(function(e){var t=e.track,n=e.padRef,r=e.isSelected,i=e.playing;return Object(a.useEffect)(function(){if(!n.current)return"";if(i)n.current.className="pad-slot pressed";else{var e=n.current.className.split(" ").filter(function(e){return"pressed"!==e});n.current.className=e.join(" ")}if(r)n.current.className+=" selected";else{var a=n.current.className.split(" ").filter(function(e){return"selected"!==e});n.current.className=a.join(" ")}t.muted&&(n.current.className+=" muted")},[i,r]),""}),I=function(e,t,n,i,o,s,c){var u=Object(a.useRef)(0),l=Object(a.useState)(!1),f=Object(r.a)(l,2),h=f[0],p=f[1],d=Object(a.useRef)(!1),m=Object(a.useState)(void 0),v=Object(r.a)(m,2),b=v[0],g=v[1],y=Object(a.useState)(!1),k=Object(r.a)(y,2),O=k[0],j=k[1];Object(a.useEffect)(function(){d.current=h},[h]);var w=Object(a.useCallback)(function(){},[p,j]);Object(a.useEffect)(function(){return window.addEventListener("mousemove",E),window.addEventListener("mouseup",P),function(){return window.removeEventListener("mouseup",P)}},[j,t,i,p]);var E=Object(a.useCallback)(function(n){if(!n.metaKey&&"DELETE"!==i&&"MUTES"!==i&&d.current&&t){n.preventDefault(),n.stopPropagation();var r=n.clientY;n.touches&&(n.touches.length>0&&n.preventDefault(),r=function(e,t){var n=void 0;Array.isArray(t)||(t=[t]),t=t.map(function(e){return e.current});for(var r=0;r<e.touches.length;r++)if(t.includes(e.touches[r].target)){n=e.touches[r];break}return n}(n,s).clientY);var a=e.current.getBoundingClientRect(),o=e.current.offsetHeight,u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,r=arguments.length>3?arguments[3]:void 0,a=(e=Math.min(Math.max(0,e),r))/r,i=Math.pow(a,.5);return t+(n-t)*i}(o-(r-a.top),-65,6,o);c&&c.sendSliderLevels(),t.setVolume(u,!1,!1),j({x:n.clientX,y:n.clientY})}},[j,t,i]),S=Object(a.useCallback)(function(e){e.metaKey||e.ctrlKey||"DELETE"===i||"MUTES"===i||t&&(c&&c.mouseDown(c.slots.indexOf(t),!0),n(t.volumeParameter),p(!0),g({x:e.clientX,y:e.clientY}),u.current=(new Date).getTime())},[p,g,t,i]),P=Object(a.useCallback)(function(e){d.current&&(e.metaKey||(c.mouseDown(c.slots.indexOf(t),!1),j(void 0),p(!1),n(void 0)))},[j,p,O,b]);return{innerStyle:{height:t&&_(void 0!==o?o:t.volumeParameter.get(),-65,6,e.current&&e.current.offsetHeight)},onMouseLeave:w,onMouseDown:S,onMouseUp:P,onMouseMove:E,mouseDown:h}};function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,r=arguments.length>3?arguments[3]:void 0,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return(e-t)/(n-t)}(e,t,n,r);return r*Math.pow(a,2)}var F=n(204),L=new s.a,B=Object(c.b)(function(e,t){var n=t.slot,r={sliderMaterial:t.pad.sliderMaterial,sampleId:n?void 0!==n.sample&&void 0!==n.sample.getId()?n.sample.getId():n.presetName||n.getName():0,sampleDragging:e.selector.sampleDragging,sampleTagDragging:e.selector.sampleTagDragging,isSelected:t.slot&&e.mix.selectedTrack===t.slot.trackNumber,trackDragging:e.tracks.trackDragging},a=t.slot;return a&&(r.isEnabled=a.isEnabled,r.muted=e.tracks.trackMutes[a.id],r.volume=e.tracks.trackVolumes[a.id]),r},function(e){return{setSampleDragging:function(t){return e(Object(h.He)(t))},setTrackDragging:function(t){return e(Object(h.Sg)(t))},setSampleTagDragging:function(t){return e(Object(h.Le)(t))},setParameterSliderDown:function(t){return e(Object(h.Sd)(t))},setArrangementBottomMode:function(t){return e(Object(h.D)(t))},setShowPianoRoll:function(t){return e(Object(h.Wf)(t))},setContextualHelp:function(t){return e(Object(h.ub)(t))},setSelectedZObject:function(t){return e(Object(h.uf)(t))},setShowEditorBottom:function(t){return e(Object(h.If)(t))}}})(function(e){var t=e.muted,n=e.showCanvas,o=e.attributes,s=e.setSelectedZObject,c=e.size,u=e.setShowEditorBottom,l=e.trackToShow,h=e.scale,p=e.setContextualHelp,d=(e.sampleId,e.setTrackToShow),b=(e.playing,e.setParameterSliderDown),g=(e.notesTriggered,e.slotNumber),k=e.slot,O=e.pad,j=e.sampleDragging,w=e.setSampleDragging,E=e.isSelected,S=e.sampleTagDragging,P=e.setSampleTagDragging,x=e.mode,T=(e.setArrangementBottomMode,e.setShowPianoRoll,e.isEnabled),_=e.volume,B=e.setTrackDragging,z=e.trackDragging,V=e.sliderMaterial,H=Object(a.useRef)(void 0),U=Object(a.useRef)(void 0),J=Object(y.a)({ref:H,useTop:!0}),G=J.onContextMenu,W=J.dropdownPos,K=J.setDropdownPos,X=Object(a.useState)(!1),Q=Object(r.a)(X,2),Y=Q[0],Z=Q[1],$=Object(a.useCallback)(function(e){e.stopPropagation(),k&&u(O.state.spatial.showEditorBottom===A.b?void 0:A.b)},[k]),ee=Object(v.a)($,250,function(e){return e.stopPropagation()});Object(a.useEffect)(function(){return window.addEventListener("keydown",te),window.addEventListener("keyup",ne),function(){window.removeEventListener("keydown",te),window.removeEventListener("keyup",ne)}},[Z]),Object(a.useEffect)(function(){Z(!1)},[z,k,Z]);var te=Object(a.useCallback)(function(e){"Shift"===e.key&&Z(!0)},[Z]),ne=Object(a.useCallback)(function(e){"Shift"===e.key&&Z(!1)},[Z]),re=I(H,k,b,x,_,[H,U],O),ae=re.innerStyle,ie=re.onMouseDown,oe=re.onMouseMove,se=re.onMouseLeave,ce=re.mouseDown,ue=re.onMouseUp,le=f({sampleDragging:j,slotNumber:g,pad:O,sampleTagDragging:S,setSampleDragging:w,setSampleTagDragging:P,slot:k,trackDragging:z,setTrackDragging:B}).onDrop,fe=Object(a.useCallback)(function(e){e.stopPropagation(),k&&(O.sequencerEngine.selectTrack(k.trackNumber),ie(e),"DELETE"===x?k.deleting=!0:"MUTES"===x&&k.mute(!t))},[Y,x,k,ie,l,d,t]),he=Object(a.useCallback)(function(e){e.stopPropagation(),k&&(O.sequencerEngine.selectTrack(k.trackNumber),ue(e),"DELETE"===x&&(k.deleting=!1))},[x,k,ue]),pe=(Object(a.useCallback)(function(e){e.stopPropagation(),k&&O.sequencerEngine.selectTrack(k.trackNumber),O.sequencerEngine.state.zobject.selectedZObject&&s(void 0)},[k,O]),Object(a.useCallback)(function(e){k&&(k.gated=!k.gated)},[k]),Object(a.useCallback)(function(e){e.stopPropagation(),k.toggleEnabled()},[T,k])),de="pad-slot";k||(de+=" empty"),E&&(de+=" selected"),"DELETE"===x&&ce&&(de+=" deleting"),t&&(de+=" muted");var me=void 0;k&&(me=k.getKeyMapping()),Y&&(de+=" slot-draggable");var ve=!n&&k&&L.getColorForTrack(k);ve&&k.sample&&k.sample.getThumbnail()&&k.sample.getThumbnail(),o&&o["slot-color"]&&(ve=L.transparent(L.saturate(o["slot-color"],1),o["slot-opacity"]||1));var be={backgroundColor:ve,width:c,height:c,margin:3*h+"px"};Object(a.useEffect)(function(){return M.isMobile&&H.current.addEventListener("touchmove",oe,{passive:!1}),function(){H.current&&M.isMobile&&H.current.removeEventListener("touchmove",oe,{passive:!1})}},[k,x]);var ge=o&&!o["Show Track Names"];return i.a.createElement("div",{style:be,onContextMenu:G,ref:H,onClick:ee,onMouseMove:oe,onMouseOver:function(){return p(k?m.Z:m.ab)},onTouchStart:ie,onMouseUp:he,onMouseLeave:function(e){p(void 0),se(e)},onDragEnter:function(e){e.dataTransfer.dropEffect="move"},onDragOver:function(e){e.dataTransfer.dropEffect="move",e.stopPropagation(),e.preventDefault()},onDrop:le,onMouseDown:k?fe:function(){return[]},className:de},k&&i.a.createElement(N.a,{dropdownPos:W,setDropdownPos:K,track:k}),i.a.createElement(D,{padRef:H,track:k}),i.a.createElement("div",{className:"inner-slot"},k&&!ge?i.a.createElement(F.a,{isPad:!0,scale:h,onMouseDown:function(e){e.metaKey||t||e.stopPropagation()},showPresetName:!0,track:k}):"",i.a.createElement("div",{ref:U,className:ce?"volume-indicator":"volume-indicator skinny",style:Object(C.a)({},ae,{width:ce?c:void 0})},V&&i.a.createElement(R,{pad:O,mouseDown:ce,slotNumber:g,sliderMaterial:V,style:Object(C.a)({},ae,{width:ce?c:8})})),!n&&k&&i.a.createElement(q.a,{height:c,meter:k.trackMeter}),k&&i.a.createElement("div",{onMouseDown:pe,className:T?"recording-dot enabled":"recording-dot"}),me&&i.a.createElement("div",{className:"pad-key-map"},me.toUpperCase())))}),z=n(1480);t.a=Object(c.b)(function(e,t){return{tracks:t.pad.tracks,selectedTrack:e.mix.selectedTrack,trackToShow:e.pads.padsExpand&&e.pads.padsExpand.pad===t.pad?e.pads.padsExpand:void 0,isSelected:e.windows.selectedElements[t.pad.id],showCanvas:t.pad.showCanvas}},function(e){return{setShowPadSequencer:function(t){return e(Object(h.Uf)(t))},setTrackToShow:function(t){return e(Object(h.Md)(t))}}})(function(e){var t=e.pad,n=e.scrollContainer,s=e.selectedTrack,c=e.setShowPadSequencer,u=e.tracks,l=(e.setPadExpand,e.trackToShow),f=e.setTrackToShow,p=e.width,b=e.height,y=e.attributes,w=e.showCanvas,E=(e.zobject,e.isPulled),S=(e.isSelected,Object(a.useRef)(void 0)),P=Object(a.useRef)(void 0),x=Object(a.useRef)(void 0),C=Object(v.a)(function(e){}),N=Object(a.useState)(!1),R=Object(r.a)(N,2),M=R[0],A=R[1],q=Object(a.useState)(void 0),D=Object(r.a)(q,2),I=D[0],_=D[1];Object(a.useEffect)(function(){var e=t.tracks.find(function(e,t){return e&&e.trackNumber===s});e&&void 0!==l&&f(e)},[l,s,f,t,u]);Object(a.useCallback)(function(){if(l)return f(void 0);if(void 0!==s){var e=t.sequencerEngine.tracks[s];if(t.tracks.some(function(t){return t===e}))return void f(e)}var n=t.tracks.filter(function(e){return e});0!==n.length&&f(n[0])},[s,l,t,f]),Object(a.useCallback)(function(){t.slotTracks.forEach(function(e){return e.pattern.clear()}),t.sequencerEngine.updateTracks()},[t]);var F="pads";if("DELETE"===I?F+=" delete-mode":"MUTES"===I&&(F+=" mute-mode"),M)return i.a.createElement(g,{hide:function(){return A(!1)},pad:t});var L={},V={};y&&(V.backgroundColor=y["primary-color"],L.backgroundColor=y["secondary-color"]),L.width=p,L.height=b,L.borderRadius=p/191*15,y&&y["border-radius"]?V.borderRadius=y["border-radius"]/1.2+"px":V.borderRadius=p/191*8;var H={borderRadius:p/191*8};w?(F+=" show-canvas",L.borderColor=y["secondary-color"]):F+=" no-canvas";var U=p/191*3,J=p-26,G=isNaN(y["Pads Per Row"])?3:y["Pads Per Row"],W=(J-2*G*U)/G;return i.a.createElement("div",{ref:P,onClick:C,style:L,onMouseDown:function(){x.current=t.sequencerEngine.state.windows.windowPositions[t.id]},onMouseUp:function(){if(t.sequencerEngine.state.windows.windowPositions[t.id]){var e=t.sequencerEngine.state.windows.windowPositions[t.id],n=e.x;e.y,x.current&&n===x.current.x&&x.current.y}},onDrop:function(e){return e.stopPropagation()},className:F},i.a.createElement("div",{style:H,className:"pad-inner"},i.a.createElement("div",{style:V,className:"slots-and-track"},i.a.createElement("div",null,i.a.createElement(k.a,{element:m.K,onClick:function(){Object(h.uf)(void 0),c(t)},className:"step-sequencer-btn"},i.a.createElement("div",{className:"pad-dot"}),i.a.createElement("div",{className:"pad-dot"}),i.a.createElement("div",{className:"pad-dot"})),w&&i.a.createElement(o.a,{className:"pad-canvas",width:p-13,height:b-18,zobject:t.canvas}),i.a.createElement(T,{mode:I,setMode:_,pad:t}),i.a.createElement("div",{style:{width:J},className:"pad-slots"},t.tracks.map(function(e,n){return e?i.a.createElement(B,{attributes:y,showCanvas:w,size:W,scale:p/191,setTrackToShow:f,trackToShow:l,key:n,slotNumber:n,pad:t,slot:e,mode:I}):i.a.createElement(d,{attributes:y,scale:p/191,size:W,pad:t,slotNumber:n})}))),l?i.a.createElement(j.a,{isDraggable:!1,onHide:function(){return f(void 0)},forceShow:!0,track:l,scrollContainer:n}):""),i.a.createElement("div",{className:"pad-bottom",ref:S},"WAVEFORM"===I?i.a.createElement(O.a,{div:S,pad:t}):!E&&i.a.createElement(z.a,{trackToShow:l,container:P,pad:t}))))})},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return r});n(5),n(14),n(229);function r(e){}},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(55),a=n(97),i=n(0),o=n.n(i),s=n(69),c=n(902),u=new Set(["clap","tom","toms","clave","perc","snare","kick","hi-hat","rim","side-stick","breaks","sub","ride"]),l=function(e,t){if(!e||e.subSequence===e)return"";if(!e.getObjectType||e.getObjectType()!==a.c)return"";var n="";e&&e.tracks&&e.tracks[0]&&e.tracks[0].track&&(e=e.tracks[0].track);var i=t||e.sample;if(i&&i.tags&&((n=i.tags.find(function(e){return u.has(e)}))||(n=i.tags[0])),e&&e.getInstrumentType()==s.f&&(n="Synth"),e&&e.getTrackType()===r.e&&(n=o.a.createElement(c.a,{track:e})),e&&e.getInstrumentType()===s.g){var l=e.instrument.getSamples();l[0]&&l[0].tags&&(n=l[0].tags.find(function(e){return u.has(e)}))}return n}},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(11),s=n(0),c=n.n(s),u=n(76),l=n(34),f=n(659),h=n(334),p=n(6),d=n(29),m=n(663),v=n(138),b=n(728),g=(n(1081),n(30),n(75),n(12)),y=new d.a,k=function(e){return e.length<24?e:e.slice(0,24)+"..."};t.a=Object(g.b)(function(e,t){return{isExploringThis:t.sample===e.selector.sourceExploring,isExploringSomething:void 0!==e.selector.sourceExploring}},function(e){return{setSampleDragging:function(t){return e(Object(p.He)(t))},setSearchText:function(t){return e(Object(p.ye)(t))},setSourceExploring:function(t){return e(Object(p.ug)(t))}}})(function(e){var t=e.onClickTag,n=e.id,r=e.loadingSample,p=e.scrollRef,d=e.selected,g=e.track,O=e.topOffset,j=e.isExploringThis,w=e.isExploringSomething,E=e.sample,S=e.setSourceExploring,P=e.tags,x=void 0===P?[]:P,T=e.samples,C=e.setSampleDragging,N=(e.setSearchText,Object(s.useRef)(void 0)),R=Object(s.useState)(void 0),M=Object(o.a)(R,2),A=M[0],q=M[1],D=Object(s.useState)(!1),I=Object(o.a)(D,2),_=I[0],F=I[1],L=Object(s.useState)(!1),B=Object(o.a)(L,2),z=B[0],V=B[1];T||Object(f.a)({scrollRef:p,ref:N,isCurrent:d,topOffset:200,mouseDown:r});var H=Object(s.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(t){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.metaKey&&S(E),!d){e.next=3;break}return e.abrupt("return");case 3:if(r.current=!0,V(!0),!T){e.next=12;break}return e.next=8,E.fetchAudio();case 8:return e.next=10,g.useNewSound(E,!0);case 10:e.next=15;break;case 12:return i=g.samplesStream.sounds.indexOf(n),e.next=15,g.auditionSeek(i-2);case 15:V(!1),r.current=!1;case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[T,g,V,E,n,d]);Object(s.useEffect)(function(){!T&&d&&w&&S(E)},[w,d,T]);var U=Object(s.useCallback)(function(){var e=g.samplesStream.getCopy(E);g.sequencerEngine.addSound(E,void 0,void 0,void 0,void 0,e),q(void 0)},[E,q]),J=Object(s.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.stopPropagation(),r.current=!0,e.next=4,t(i,n.metaKey);case 4:r.current=!1;case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),[V,t]),G=Object(s.useCallback)(function(e){e.stopPropagation();var t=e.clientX-N.current.getBoundingClientRect().left,n=e.clientY-p.current.getBoundingClientRect().top;t>200&&(t-=200),t=Math.max(0,t),O&&(n+=O),q({x:t,y:n}),e.preventDefault()},[q]);if(!E)return[];var W="sample-stream-option";d&&(W+=" selected"),z&&(W+=" flashit");var K=E.tags.filter(function(e){return!x.includes(e)});return A&&(W+=" showing-dropdown"),j&&(W+=" is-exploring"),K.sort(),c.a.createElement("div",{onContextMenu:G,ref:N},c.a.createElement(u.a,{element:l.i,draggable:!0,onDragOver:function(e){return e.preventDefault()},onDragStart:function(){return C(E)},onClick:H,id:T?void 0:"sample-option-"+E.getId(),className:W},c.a.createElement(b.a,{createNewTrack:U,setIsTagging:F,dropdownPos:A,setDropdownPos:q,type:v.f,content:E,setPackToSearch:function(){return[]},contentHash:E.getId()}),E.getThumbnail()?c.a.createElement("img",{src:E.getThumbnail(),className:"s-thumb"}):"",E.favorited?c.a.createElement("div",{className:"heart favorited"}):"",c.a.createElement("div",{className:"s-name"},k(Object(h.a)(E.name))),E.packs&&E.packs.map(function(e){return c.a.createElement("div",{style:{backgroundColor:y.getColorForHash(e)},className:"pack-thumb"})}),c.a.createElement("div",{className:"s-tags"},K.map(function(e){return c.a.createElement("div",{onClick:function(t){return J(t,e)},className:"s-tag"},e)}))),_?c.a.createElement(m.a,{onTag:function(){return F(!1)},content:E}):"")})},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(5),a=n.n(r),i=n(9),o=n(14),s=n(52),c=n(75);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f={},h=function(e,t){return new Promise(function(){var n=Object(o.a)(a.a.mark(function n(r){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t in f)){n.next=3;break}if(f[t].lenggth!==e.length){n.next=3;break}return n.abrupt("return",r(Object(i.a)(f[t])));case 3:return n.t0=fetch,n.t1=JSON,n.next=7,s.a.getAccount();case 7:n.t2=n.sent,n.t3=e,n.t4={user:n.t2,ids:n.t3},n.t5=n.t1.stringify.call(n.t1,n.t4),n.t6={Accept:"application/json","Content-Type":"appliction/json"},n.t7={method:"POST",body:n.t5,headers:n.t6},(0,n.t0)("/querySample/",n.t7).then(function(e){return e.json()}).then(function(e){var n=[];if(!e||!Array.isArray(e))return f[t]=n,r(n);var a,i=u(e);try{for(i.s();!(a=i.n()).done;){var o=a.value,s=new c.a(o.id);s.name=o.title,s.packs=o.packs,s.videoId=o.videoId,s.favorited=5===o.rating,s.blockNumber=o.blockNumber,s.sampledByUser=o.user,s.artistName=o.artistName,s.releaseName=o.releaseName,s.guildId=o.guildId,s.year=o.year,s.discogsId=o.discogsId,s.coverArtHash=""===o.coverArtHash?void 0:o.coverArtHash,s.tags=Array.from(new Set(o.tags||[])),n.push(s)}}catch(l){i.e(l)}finally{i.f()}f[t]=n,r(n)});case 14:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())}},,function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(76),o=n(34),s=n(1051),c=n(1045),u=n(38),l=n(12);t.a=Object(l.b)(function(e,t){return{isFrozen:t.track.isFrozen,numColumns:t.track.frozenColumns&&t.track.frozenColumns.length}},function(e){return{}})(function(e){var t=e.track,n=e.trackColor,r=(e.isTrackFrozen,e.isFrozen),l=t.sequencerEngine;t.frozenColumns.some(function(e){return e.frozenSamplers.length>0});return a.a.createElement("div",{className:"frozen-columns-container"},t.frozenColumns.map(function(e,r){return a.a.createElement(s.a,{key:r,number:r,column:e,color:n,sequencerEngine:l,track:t})}),a.a.createElement("div",null,a.a.createElement(c.a,{track:t}),a.a.createElement(u.a,{condition:r},a.a.createElement(i.a,{element:o.Vb},a.a.createElement("div",{style:{backgroundColor:n},onClick:function(){t.unfreeze()},className:"expand-sample"},"Unfreeze")))))})},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(71),a=function(e){return e&&e.getEffectType&&e.getEffectType()!==r.a&&e.track?e.track:e.context?e.context.track:e.track}},,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[{internalType:"address",name:"guildsAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"effectHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"effectType",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"tag",type:"bytes32"}],name:"EffectTagged",type:"event"},{inputs:[{internalType:"bytes32",name:"effectHash",type:"bytes32"},{internalType:"bytes32",name:"effectType",type:"bytes32"},{internalType:"string",name:"title",type:"string"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"newEffect",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"effectHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"effectType",type:"bytes32"},{indexed:!1,internalType:"string",name:"title",type:"string"},{indexed:!1,internalType:"uint32",name:"guildId",type:"uint32"}],name:"NewEffect",type:"event"},{inputs:[{internalType:"bytes32",name:"effectHash",type:"bytes32"},{internalType:"bytes32",name:"effectType",type:"bytes32"},{internalType:"bytes32",name:"tag",type:"bytes32"}],name:"tagEffect",outputs:[],stateMutability:"nonpayable",type:"function"}],this.contractAddress="0x133F927E9d1b94e6f274eAa4eEE21d29c65782B4"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"name",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"linkType",type:"bytes32"},{indexed:!1,internalType:"string",name:"link",type:"string"}],name:"ArtistInfo",type:"event"},{inputs:[{internalType:"bytes32",name:"artistName",type:"bytes32"},{internalType:"address",name:"user",type:"address"}],name:"claimArtist",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"ipfsHash",type:"bytes32"}],name:"deleteSampleByArtist",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"artistName",type:"bytes32"},{internalType:"bytes32",name:"linkType",type:"bytes32"},{internalType:"string",name:"link",type:"string"}],name:"newArtistInfo",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"artistName",type:"bytes32"},{internalType:"uint32",name:"releaseId",type:"uint32"},{internalType:"string",name:"releaseName",type:"string"},{internalType:"bytes32",name:"coverArtHash",type:"bytes32"},{internalType:"bytes32",name:"releaseType",type:"bytes32"}],name:"newRelease",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"artistName",type:"bytes32"},{internalType:"bytes32",name:"ipfsHash",type:"bytes32"}],name:"newSampleByArtist",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"artistName",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"releaseId",type:"uint32"},{indexed:!1,internalType:"string",name:"releaseName",type:"string"},{indexed:!1,internalType:"bytes32",name:"coverArtHash",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"releaseType",type:"bytes32"}],name:"ReleaseInfo",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"artistName",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"ipfsHash",type:"bytes32"}],name:"SampleByArtist",type:"event"},{inputs:[{internalType:"bytes32",name:"artistName",type:"bytes32"}],name:"unclaimArtist",outputs:[],stateMutability:"nonpayable",type:"function"}],this.contractAddress="0x0C8aB6a2ED347F076ed69f9eBf05967a8A889400"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"wallpaperHash",type:"bytes32"}],name:"DefaultWallpaper",type:"event"},{inputs:[{internalType:"bytes32",name:"wallpaperHash",type:"bytes32"},{internalType:"bytes32",name:"thumbnailHash",type:"bytes32"}],name:"newWallpaper",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"wallpaperHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"thumbnailHash",type:"bytes32"}],name:"NewWallpaper",type:"event"},{inputs:[{internalType:"bytes32",name:"wallpaperHash",type:"bytes32"}],name:"setDefaultWallpaper",outputs:[],stateMutability:"nonpayable",type:"function"}],this.contractAddress="0x21e424dB64f6597B60E179AAA7C819E616F801A0"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"sequenceHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"}],name:"SampleInSequence",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"previousSequence",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newSequence",type:"bytes32"},{indexed:!1,internalType:"string",name:"title",type:"string"},{indexed:!1,internalType:"uint32",name:"bpm",type:"uint32"}],name:"SequenceEdited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"projectHash",type:"bytes32"},{indexed:!0,internalType:"uint256",name:"zoraTokenId",type:"uint256"}],name:"ZoraProject",type:"event"},{inputs:[{internalType:"bytes32",name:"previousSequence",type:"bytes32"},{internalType:"bytes32",name:"newSequence",type:"bytes32"},{internalType:"string",name:"title",type:"string"},{internalType:"bytes32[]",name:"samples",type:"bytes32[]"},{internalType:"uint32",name:"bpm",type:"uint32"}],name:"editSequence",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"projectHash",type:"bytes32"},{internalType:"uint256",name:"zoraTokenId",type:"uint256"}],name:"zoraProject",outputs:[],stateMutability:"nonpayable",type:"function"}],this.contractAddress="0x27Fd050dF7c0c603A407f1BC4fd0ED634824270E"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r=1,a=2},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=!1},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){for(var t=e.getJson(),n=[],r=0;r<e.sequencerEngine.numberOfPatterns();r++){var a=e.patterns[r];if(void 0!==a){for(var i={},o=0;o<a.stepBuckets.length;o++){var s=a.stepBuckets[o];if(s.anyEffectAutomation()||s.anyOn())for(var c in s.steps)i[o]=s.getJson()}i.size=a.length(),i.buckets=!0,n.push(i)}}return{patterns:n,patternsConfig:e.patterns.map(function(e){return e.getJson()}),trackData:t,trackEffectChains:e.effectsChains.map(function(e){return e.getJson()}),trackMidiEffects:e.midiEffects.getJson()}}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(9);function a(e,t){if(e=Object(r.a)(e),Array.isArray(e[0])||(e=e.map(function(e){return[e.x,e.y]})),t){var n=e[e.length-1],a=e[e.length-2],i=e[0],o=e[1];e.unshift(n),e.unshift(a),e.push(i),e.push(o)}return e.flat()}function i(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(e=a(e,n)).length,o=i-4,s=n?e[2]:e[0],c=n?e[3]:e[1],u=[[s,c]],l="M"+[s,c],f=n?i-4:i-2,h=n?2:0;h<f;h+=2){var p=h?e[h-2]:e[0],d=h?e[h-1]:e[1],m=e[h+0],v=e[h+1],b=e[h+2],g=e[h+3],y=m+(b-p)/6*t,k=v+(g-d)/6*t,O=b-((h!==o?e[h+4]:b)-m)/6*t,j=g-((h!==o?e[h+5]:g)-v)/6*t;l+="C"+[y,k,O,j,b,g],u.push([y,k,O,j,b,g])}return r?u:l}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(56),l=n(15),f=n.n(l),h=n(21);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var d=function(e){Object(o.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Auto Wah",function(){return new f.a.AutoWah(50,6,-30)},e)).effectNode.gain.value=6,a.baseFrequencyParameter=new h.a("Base Frequency",a.effectNode,function(e,t){return e.baseFrequency=t},{min:0,max:1e4,unit:"hz",defaultValue:400}),a.registerParameter(a.baseFrequencyParameter),a.octaveParameter=new h.a("Octaves",a.effectNode,function(e,t){return e.octaves=t},{min:0,max:10,unit:"",defaultValue:1}),a.registerParameter(a.octaveParameter),a.qParameter=new h.c("Q",a.effectNode.Q,{min:0,max:10,unit:"",defaultValue:0}),a.registerParameter(a.qParameter),a.sensitivityParameter=new h.a("Sensitivity",a.effectNode,function(e,t){return e.sensitivity=t},{min:-12,max:6,unit:"db",defaultValue:0}),a.registerParameter(a.sensitivityParameter),a.attackParameter=new h.a("Attack",a.effectNode,function(e,t){return e.follower.attack=t},{min:0,max:2,unit:"",defaultValue:0}),a.registerParameter(a.attackParameter),a.releaseParameter=new h.a("Release",a.effectNode,function(e,t){return e.follower.release=t},{min:0,max:2,unit:"",defaultValue:0}),a.registerParameter(a.releaseParameter),a}return Object(a.a)(n,[{key:"getJson",value:function(){var e=Object(i.a)(Object(c.a)(n.prototype),"getJson",this).call(this);return e.name=this.name,e.baseFrequency=this.baseFrequencyParameter.get(),e.octave=this.octaveParameter.get(),e.q=this.qParameter.get(),e.sensitivity=this.sensitivityParameter.get(),e.attack=this.attackParameter.get(),e.release=this.releaseParameter.get(),e.wet=this.wetParameter.get(),e}},{key:"fromJson",value:function(e,t){Object(i.a)(Object(c.a)(n.prototype),"fromJson",this).call(this,e,t),"baseFrequency"in e&&this.baseFrequencyParameter.set(e.baseFrequency),"octave"in e&&this.octaveParameter.set(e.octave),"sensitivity"in e&&this.sensitivityParameter.set(e.sensitivity),"q"in e&&this.qParameter.set(e.q),"attack"in e&&this.attackParameter.set(e.attack),"release"in e&&this.releaseParameter.set(e.release),e.enabled&&this.enable(!0),"wet"in e&&this.setValue(e.wet)}},{key:"getEffectCopy",value:function(){var e=new n(this.sequencerEngine);return e.fromJson(this.getJson(),!0),e}}]),n}(u.a.Effect);t.a=d},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(15),f=n.n(l),h=n(56),p=n(21);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var m=function(e){Object(s.a)(n,e);var t=d(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"EQ 3",function(){return new f.a.EQ3},e)).lowParameter=new p.a("Low",r.effectNode.low,function(e,t){return e.value=t},{min:-10,max:10,unit:"db",defaultValue:0}),r.lowFrequencyParameter=new p.a("Low Frequency",r.effectNode.lowFrequency,function(e,t){return e.value=t},{min:0,max:400,unit:"hz",defaultValue:0}),r.midParameter=new p.a("Mid",r.effectNode.mid,function(e,t){return e.value=t},{min:-10,max:10,unit:"db",defaultValue:0}),r.highParameter=new p.a("High",r.effectNode.high,function(e,t){return e.value=t},{min:-10,max:10,unit:"db",defaultValue:0}),r.highFrequencyParameter=new p.a("High Frequency",r.effectNode.highFrequency,function(e,t){return e.value=t},{min:1e3,max:1e4,unit:"hz",defaultValue:2e3}),r.registerParameter(r.lowParameter),r.registerParameter(r.midParameter),r.registerParameter(r.highParameter),r.registerParameter(r.lowFrequencyParameter),r.registerParameter(r.highFrequencyParameter),r}return Object(i.a)(n,[{key:"getJson",value:function(){return Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{low:this.lowParameter.get(),mid:this.midParameter.get(),high:this.highParameter.get(),lowFrequency:this.lowFrequencyParameter.get(),highFrequency:this.highFrequencyParameter.get(),enabled:this.enabledParameter.get(),name:this.name})}},{key:"fromJson",value:function(e,t){Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t),this.lowParameter.set(e.low),this.midParameter.set(e.mid),this.highParameter.set(e.high),this.lowFrequencyParameter.set(e.lowFrequency),this.highFrequencyParameter.set(e.highFrequency),this.enable(e.enabled)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(h.a.Effect);t.a=m},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(15),f=n.n(l),h=n(56),p=(n(21),n(41));function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var m="peaking",v=function(e){Object(s.a)(n,e);var t=d(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"EQ 10",function(){return new f.a.Gain(1)},e)).filter31=new f.a.Filter(31,m),r.filter31.Q.value=.71,r.filter63=new f.a.Filter(63,m),r.filter63.Q.value=.71,r.filter125=new f.a.Filter(125,m),r.filter125.Q.value=.71,r.filter250=new f.a.Filter(250,m),r.filter250.Q.value=.71,r.filter500=new f.a.Filter(500,m),r.filter500.Q.value=.71,r.filter1k=new f.a.Filter(1e3,m),r.filter1k.Q.value=.71,r.filter2k=new f.a.Filter(2e3,m),r.filter2k.Q.value=.71,r.filter4k=new f.a.Filter(4e3,m),r.filter4k.Q.value=.71,r.filter8k=new f.a.Filter(8e3,m),r.filter8k.Q.value=.71,r.filter16k=new f.a.Filter(16e3,m),r.filter16k.Q.value=.71,r.outputNode=new f.a.Gain(1),r.effectNode.chain(r.filter31,r.filter63,r.filter125,r.filter250,r.filter500,r.filter1k,r.filter2k,r.filter4k,r.filter8k,r.filter16k,r.outputNode),r.gain31Parameter=new p.c("Gain 31",r.filter31.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain31Parameter),r.gain63Parameter=new p.c("Gain 63",r.filter63.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain63Parameter),r.gain125Parameter=new p.c("Gain 125",r.filter125.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain125Parameter),r.gain125Parameter=new p.c("Gain 125",r.filter125.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain125Parameter),r.gain250Parameter=new p.c("Gain 250",r.filter250.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain250Parameter),r.gain500Parameter=new p.c("Gain 500",r.filter500.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain500Parameter),r.gain1kParameter=new p.c("Gain 1k",r.filter1k.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain1kParameter),r.gain2kParameter=new p.c("Gain 2k",r.filter2k.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain2kParameter),r.gain4kParameter=new p.c("Gain 4k",r.filter4k.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain4kParameter),r.gain8kParameter=new p.c("Gain 8k",r.filter8k.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain8kParameter),r.gain16kParameter=new p.c("Gain 16k",r.filter16k.gain,{min:-12,max:12,unit:"db",defaultValue:0}),r.registerParameter(r.gain16kParameter),r}return Object(i.a)(n,[{key:"connect",value:function(e){this.outputNode.connect(e)}},{key:"disconnect",value:function(){this.outputNode.disconnect()}},{key:"getJson",value:function(){var e=Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{gain63:this.gain63Parameter.get(),gain125:this.gain125Parameter.get(),gain250:this.gain250Parameter.get(),gain500:this.gain500Parameter.get(),gain1k:this.gain1kParameter.get(),gain2k:this.gain2kParameter.get(),gain4k:this.gain4kParameter.get(),gain8k:this.gain8kParameter.get(),gain16k:this.gain16kParameter.get()});return e=this.saveParameterToJson(e,"gain31Parameter",this.gain31Parameter),e=this.saveParameterToJson(e,"gain63Parameter",this.gain63Parameter),e=this.saveParameterToJson(e,"gain125Parameter",this.gain125Parameter),e=this.saveParameterToJson(e,"gain250Parameter",this.gain250Parameter),e=this.saveParameterToJson(e,"gain500Parameter",this.gain500Parameter),e=this.saveParameterToJson(e,"gain1kParameter",this.gain1kParameter),e=this.saveParameterToJson(e,"gain2kParameter",this.gain2kParameter),e=this.saveParameterToJson(e,"gain4kParameter",this.gain4kParameter),e=this.saveParameterToJson(e,"gain8kParameter",this.gain8kParameter),e=this.saveParameterToJson(e,"gain16kParameter",this.gain16kParameter)}},{key:"fromJson",value:function(e,t){Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t),this.gain63Parameter.set(e.gain63),this.gain125Parameter.set(e.gain125),this.gain250Parameter.set(e.gain250),this.gain500Parameter.set(e.gain500),this.gain1kParameter.set(e.gain1k),this.gain2kParameter.set(e.gain2k),this.gain4kParameter.set(e.gain4k),this.gain8kParameter.set(e.gain8k),this.gain16kParameter.set(e.gain16k),this.loadParameterFromJson(e,"gain31Parameter",this.gain31Parameter,t),this.loadParameterFromJson(e,"gain63Parameter",this.gain63Parameter,t),this.loadParameterFromJson(e,"gain125Parameter",this.gain125Parameter,t),this.loadParameterFromJson(e,"gain250Parameter",this.gain250Parameter,t),this.loadParameterFromJson(e,"gain500Parameter",this.gain500Parameter,t),this.loadParameterFromJson(e,"gain1kParameter",this.gain1kParameter,t),this.loadParameterFromJson(e,"gain2kParameter",this.gain2kParameter,t),this.loadParameterFromJson(e,"gain4kParameter",this.gain4kParameter,t),this.loadParameterFromJson(e,"gain8kParameter",this.gain8kParameter,t),this.loadParameterFromJson(e,"gain16kParameter",this.gain16kParameter,t),this.enable(e.enabled)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(h.a.Effect);t.a=v},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(16),s=n(7),c=n(10),u=n(1),l=n(56),f=n(15),h=n.n(f),p=n(21);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var m=function(e){Object(s.a)(n,e);var t=d(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Gate",function(){return new h.a.Gain(2)},e)).connectedTrack=void 0,a.follower=new h.a.Follower(.012,.1),a.multiplier=new h.a.Gain(100),a.gate=new h.a.Gate(-30,.001,.2),a.smoothingParameter=new p.a("Smoothing",Object(i.a)(a),function(e,t){return a.gate.smoothing=t},{min:1e-5,max:2,unit:"ms",defaultValue:.012}),a.thresholdParameter=new p.a("Threshold",Object(i.a)(a),function(e,t){return a.gate.threshold=t},{min:-30,max:6,unit:"db",defaultValue:0}),a.registerParameter(a.smoothingParameter),a.registerParameter(a.thresholdParameter),a.effectNode.connect(a.gate),a.updateInitialValues(),a}return Object(a.a)(n,[{key:"connect",value:function(e){this.gate.connect(e)}},{key:"disconnect",value:function(e){this.gate.disconnect(e)}},{key:"smoothing",get:function(){return this.smoothingParameter.get()},set:function(e){return this.smoothingParameter.set(e)}},{key:"threshold",get:function(){return this.thresholdParameter.get()},set:function(e){return this.thresholdParameter.set(e)}},{key:"setSideChainedTrack",value:function(e,t){void 0!==this.connectedTrack&&this.connectedTrack.volumeNode.disconnect(this.multiplier),e.volumeNode.chain(this.multiplier,this.follower),this.follower.connect(this.effectNode.gain),this.connectedTrack=e,this.trackNumber=t}},{key:"getJson",value:function(){var e=Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this);return e.trackNumber=this.trackNumber,e.threshold=this.threshold,e.smoothing=this.smoothing,e=this.saveParameterToJson(e,"smoothingParameter",this.smoothingParameter),e=this.saveParameterToJson(e,"thresholdParameter",this.thresholdParameter)}},{key:"fromJson",value:function(e,t,r){Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,r),e.enabled&&this.enable(!0),this.threshold=e.threshold,this.smoothing=e.smoothing,this.setSideChainedTrack(t[e.trackNumber],e.trackNumber),this.loadParameterFromJson(e,"thresholdParameter",this.thresholdParameter),this.loadParameterFromJson(e,"smoothingParameter",this.smoothingParameter)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),this.sequencerEngine.tracks,t),r}}]),n}(l.a.Effect);t.a=m},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(5),a=n.n(r),i=n(14),o=n(183),s=n(75),c=n(207),u=n(191),l=n(15),f=n.n(l),h=function(){var e=Object(i.a)(a.a.mark(function e(t,n,r,i){var l,h,p,d,m,v,b,g,y,k,O;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:l=[],h=0,p=new o.a(2,function(e,t,n){return[]}),d=t.state.freeze.loops,m=Object(c.f)(t,0,i)*d,v=0;case 6:if(!(v<r)){e.next=23;break}return g=(b=h)+f.a.Master.context.sampleRate*m*new f.a.Time("32n").toMilliseconds()/1e3,y=Object(u.a)(n,b,g,f.a.Master.context),h=g,e.next=13,p.uploadBufferToIpfs(y);case 13:k=e.sent,(O=new s.a(k)).audioBuffer=y,O.tempo=t.tempo,O.name="Frozen Pattern "+(v+1),O.tags=["Resampled"],l.push(O);case 20:v++,e.next=6;break;case 23:return e.abrupt("return",l);case 24:case"end":return e.stop()}},e)}));return function(t,n,r,a){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(11),s=n(0),c=n.n(s),u=n(6),l=n(34),f=n(92),h=n(12);t.a=Object(h.b)(function(e,t){return{bpm:t.sequencerEngine.bpmParameter.get(),isMacroMapping:e.effects.isMacroMapping}},function(e){return{setContextualHelp:function(t){return e(Object(u.ub)(t))},setParameterToMap:function(t){return e(Object(u.Td)(t))}}})(function(e){var t=e.setParameterToMap,n=e.bpm,r=e.sequencerEngine,u=e.setContextualHelp,h=e.isMacroMapping,p=Object(s.useState)(0),d=Object(o.a)(p,2),m=d[0],v=d[1],b=Object(s.useState)(!1),g=Object(o.a)(b,2),y=g[0],k=g[1],O=Object(s.useState)(n),j=Object(o.a)(O,2),w=j[0],E=j[1],S=Object(s.useRef)(!1),P=Object(s.useRef)(0),x=Object(s.useRef)(0);Object(s.useEffect)(function(){return window.addEventListener("mousedown",T),function(){return window.removeEventListener("mousedown",T)}},[y,k]);var T=Object(s.useCallback)(function(){y&&k(!1)},[y,k]),C=Object(s.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(n){var i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h&&(r.bpmParameter.isMapped||t(r.bpmParameter)),n.stopPropagation(),!((i=(new Date).getTime())-x.current<=250)){e.next=6;break}return k(!0),e.abrupt("return");case 6:x.current=i,o=n.clientY,v(o),P.current=0,S.current=!0;case 11:if(!S.current){e.next=18;break}return s=P.current,r.bpm=Math.round(r.bpmParameter.get()-s/5),e.next=16,Object(f.a)(50);case 16:e.next=11;break;case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[v,k,h]),N=Object(s.useCallback)(function(e){S.current=!1,u(void 0)},[]),R=Object(s.useCallback)(function(e){S.current&&(P.current=e.clientY-m)},[m]),M=Math.round(10*n)/10,A=Object(s.useCallback)(function(e){var t=e.target.value;E(t),parseFloat(t)&&(r.bpm=parseFloat(t))},[r,E]),q=Object(s.useCallback)(function(e){"Enter"===e.key&&k(!1)},[k]);return c.a.createElement("div",{onMouseOver:function(){return u(l.m)},onMouseDown:C,onMouseUp:N,onMouseLeave:N,onMouseMove:R,className:"bpm-component"},y?c.a.createElement("input",{onKeyDown:q,onChange:A,value:w,type:"text",className:"bpm-input"}):M)})},function(e,t,n){"use strict";var r=n(9),a=n(11),i=n(0),o=n.n(i),s=n(29),c=n(272),u=n(991),l=n(6),f=n(138),h=n(729),p=n(366),d=n(12),m=new s.a;t.a=Object(d.b)(function(e,t){return{}},function(e){return{setCreatingNewPack:function(t){return e(Object(l.wb)(t))}}})(function(e){var t=e.setPackToSearch,n=e.setCreatingNewPack,s=e.dropdownPos,l=e.setDropdownPos,d=e.type,v=void 0===d?f.f:d,b=e.isUnsourced,g=e.setIsSourcing,y=e.setIsTagging,k=e.content,O=e.contentHash,j=e.createNewTrack,w=Object(h.a)({type:v,contentHash:O,disabled:!s}),E=w.toggleFavorite,S=w.isFavorited,P=Object(i.useState)([]),x=Object(a.a)(P,2),T=x[0],C=x[1],N=Object(u.a)(O,s,v===f.f?k:void 0,(f.b,k)),R=(N.createNewPack,N.addToPack),M=N.packsIncludedIn;Object(i.useEffect)(function(){s?window.addEventListener("mousedown",A):window.removeEventListener("mousedown",A)},[l,s]);var A=Object(i.useCallback)(function(){l(void 0)},[l]);if(Object(i.useEffect)(function(){s&&Object(c.a)().then(C)},[s,C]),!s)return[];var q=T.filter(function(e){return M.some(function(t){return t.packHash===e.packHash})}),D=T.filter(function(e){return!M.some(function(t){return t.packHash===e.packHash})}),I=[].concat(Object(r.a)(q),Object(r.a)(D)),_=[];I.forEach(function(e){_.some(function(t){return t.title===e.title})||_.push(e)}),I=_;var F=v===f.f?" sample":" preset";return o.a.createElement("div",{onClick:function(e){return e.stopPropagation()},style:{left:s.x,top:s.y},className:"sample-dropdown"},o.a.createElement("div",{onMouseDown:E,className:"menu-item"},S?"Unfavorite"+F:"Favorite"+F," ",o.a.createElement("div",{className:S?"heart favorited":"heart"})),o.a.createElement("div",{onMouseDown:function(){return y(!0)},className:"menu-item"},"Tag ",F),b?o.a.createElement("div",{onMouseDown:function(){return g(!0)},className:"menu-item"},"Edit Source"):"",o.a.createElement("div",{onMouseDown:j,className:"menu-item"},"Create New Track"),o.a.createElement("div",{className:"menu-item"},"Add to pack ",o.a.createElement("div",{className:"arrow-right"}),o.a.createElement("div",{className:"packs sample-dropdown"},o.a.createElement("div",{onClick:function(e){return e.stopPropagation()},onMouseDown:function(e){n(k)},className:"menu-item new-pack"},"+ New Pack"),I.map(function(e){return o.a.createElement("div",{onClick:function(e){return e.stopPropagation()},onMouseDown:function(t){M.some(function(t){return t.packHash===e.packHash})||R(e),l(void 0)},className:"menu-item"},o.a.createElement("div",{style:{backgroundColor:m.getColorForHash(e.title)},className:"pack-thumb"}),o.a.createElement("div",{className:"pack-title"},e.title),o.a.createElement(p.a,{className:"guilds-checkmark",condition:M.some(function(t){return t.packHash===e.packHash})}))}))),q.length>0?o.a.createElement("div",{className:"packs-included-in"},q.map(function(e){return o.a.createElement("div",{onClick:function(e){return e.stopPropagation()},onMouseDown:function(){t(e)},className:"menu-item"},o.a.createElement("div",{style:{backgroundColor:m.getColorForHash(e.title)},className:"pack-thumb"}),o.a.createElement("div",{className:"pack-title"},e.title),o.a.createElement(p.a,{className:"guilds-checkmark",condition:M.some(function(t){return t.packHash===e.packHash})}))})):"")})},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(11),a=n(0),i=n(30),o=n(52),s=function(e){var t=e.type,n=e.contentHash,s=e.disabled,c=Object(a.useState)(void 0),u=Object(r.a)(c,2),l=u[0],f=u[1],h=Object(a.useCallback)(function(e){e.stopPropagation(),i.a.xanadu.rateSound(n,l?0:5,t),f(!l)},[f,n,l,t]);return Object(a.useEffect)(function(){if(!s){var e=!1;return o.a.getAccount().then(function(r){return r&&i.a.xanadu.getSoundRating(n,t,r).then(function(t){e||f(5===t)})}),function(){return e=!0}}},[f,n,t,s]),{toggleFavorite:h,isFavorited:l}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e,t,n){return new Promise(function(r){fetch("/packSearch/",{method:"POST",body:JSON.stringify({searchTerm:e,includeContent:t,contentType:n}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){r(e)})})}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=n(215),s=n(39),c=n.n(s),u=function(e){return e===o.a?"Mix":"Sends Only"};t.a=Object(i.b)(function(e,t){return{outputType:t.track.outputTypeParameter&&t.track.outputTypeParameter.get()}},null)(function(e){var t=e.track,n=e.outputType,i=e.className,s=Object(r.useCallback)(function(e){var n=e.value;t.outputTypeParameter.set(n)},[]),l=[{value:o.a,label:"Mix"},{value:o.b,label:"Sends Only"}],f={value:n,label:u(n)};return a.a.createElement("div",{className:"track-output-type"},a.a.createElement("div",{className:"track-output-type-label"},"Audio To"),a.a.createElement(c.a,{className:i||"osc-type-dropdown float-left",controlClassName:i||"osc-type-control-dropdown",arrowClassName:i||"osc-type-arrow-dropdown",options:l,onChange:s,value:f,placeholder:"Audio To"}))})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(12),s=40;function c(e,t,n,r,a,i){var o=i.current.getBoundingClientRect(),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3?arguments[3]:void 0,a=(e=Math.min(Math.max(0,e),r))/r,i=Math.pow(a,.5);return t+(n-t)*i}(e.clientX-o.left,n,r,a);return isNaN(s)?-100:s}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3?arguments[3]:void 0,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;return(e-t)/(n-t)}(e,t,n,r);return r*Math.pow(a,2)+4}t.a=Object(o.b)(function(e,t){return void 0===t.track?{}:{volume:t.track.volumeParameter.get()}},null)(function(e){var t=e.track,n=e.rackTrack,o=e.volume,l=e.id,f=e.onVolumeChange,h=e.min,p=void 0===h?-40:h,d=e.max,m=void 0===d?4:d,v=e.width,b=void 0===v?s:v,g=e.display,y=(e.onVolumeChange2,Object(a.useState)(!1)),k=Object(r.a)(y,2),O=k[0],j=k[1],w=Object(a.useRef)(void 0),E={width:u(o,p,m,b)},S=function(){return l||"volume-"+n.trackNumber+"-"+t.trackNumber},P=Object(a.useCallback)(function(e){e.stopPropagation();var n=c(e,S(),p,m,b,w);f?f(n):t.volumeParameter.set(n,!0),j(!0)},[t,j]),x=Object(a.useCallback)(function(e){if(e.stopPropagation(),O){var n=c(e,S(),p,m,b,w);f?f(n):t.volumeParameter.set(n)}},[t,O]),T=function(e){return Math.round(10*e)/10};return i.a.createElement("div",{ref:w,style:{width:b+6},id:S(),onClick:function(e){return e.stopPropagation()},onMouseUp:function(e){e.stopPropagation(),j(!1)},onMouseLeave:function(e){e.stopPropagation(),j(!1)},onMouseMove:x,onMouseDown:P,className:"volume-box"},i.a.createElement("div",{style:E,className:"volume-indicator"}),i.a.createElement("span",{className:"value"},T(g?g(o):o)," db"))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12),f=n(22),h=n(38),p=n(63),d=n(837),m=n(39),v=n.n(m),b=n(46);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var y=function(e){Object(i.a)(n,e);var t=g(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={showHarmonics:!1},a}return Object(a.a)(n,[{key:"showHarmonics",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({showHarmonics:e})}},{key:"getSelectedOscillatorType",value:function(){return this.props.oscillator.oscillatorType}},{key:"onSelectOscillatorType",value:function(e){var t="none"===e.value?void 0:e.value;this.props.sequencerEngine.operationManager.dispatch(Object(b.v)(this.props.oscillator.oscillatorTypeParameter,t)),this.setState(this.state)}},{key:"render",value:function(){var e,t=this,n=this.props.oscillator,r=this.props.instrument;return n.isInitialized()?this.state.showHarmonics&&"custom"===n.oscillatorType?u.a.createElement("div",{className:"oscillator-component"},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(d.a,{oscillator:n}),u.a.createElement("div",{onClick:function(){return t.showHarmonics(!1)},className:"harmonics-button"},"Done Editing")):u.a.createElement("div",{className:"oscillator-component"},u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(v.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:k,onChange:function(e){return t.onSelectOscillatorType(e)},value:(e=this.getSelectedOscillatorType(),k.filter(function(t){return t.value===e})[0]),placeholder:"Osc. Type"})),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(f.a,{automation:this.props.automation,name:"Volume",parameter:n.oscillatorLevelParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,isParameter:!0,min:0,max:1,step:.01}),u.a.createElement(f.a,{automation:this.props.automation,name:"Frequency",sequencerEngine:this.props.sequencerEngine,parameter:n.oscillatorFrequencyParameter,onParameterChanged:function(){return r.releaseAll()},displayFunction:function(e){return p.a.fromTranspose(e).toString()},isParameter:!0,min:-32,max:32,step:1}),u.a.createElement(f.a,{automation:this.props.automation,name:"Detune",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:n.detuneParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}),u.a.createElement(h.a,{condition:"custom"===n.oscillatorType},u.a.createElement("div",{onClick:function(){return t.showHarmonics()},className:"harmonics-button"},"Edit Harmonics"))):u.a.createElement("div",null)}}]),n}(c.Component),k=[{value:"square",label:"Square"},{value:"sine",label:"Sine"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"},{value:"pwm",label:"PWM"},{value:"pulse",label:"Pulse"},{value:"custom",label:"Custom"}];t.a=Object(l.b)(function(e,t){return{type:t.oscillator.oscillatorType}},null)(y)},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=(n(208),n(6)),s=n(12),c=function(e){return Math.round(1e3*e)/1e3};t.a=Object(s.b)(function(e,t){return{uxLocked:e.zobject.uxLocked,round:t.znumber.round,number:t.znumber._text}},function(e){return{setSelectedZObject:function(t){return e(Object(o.uf)(t))}}})(function(e){var t=e.znumber,n=e.number,o=e.uxLocked,s=e.isSelectedZObject,u=e.setSelectedZObject,l=e.color,f=e.onChange,h=e.hideNumber,p=Object(a.useRef)(void 0),d=Object(a.useState)(n),m=Object(r.a)(d,2),v=m[0],b=m[1],g=Object(a.useState)(!1),y=Object(r.a)(g,2),k=y[0],O=y[1];Object(a.useEffect)(function(){return window.addEventListener("mouseup",w),window.addEventListener("mousemove",j),function(){window.removeEventListener("mouseup",w),window.removeEventListener("mousemove",j)}},[O,k,b]),Object(a.useEffect)(function(){b(n)},[n,b]);var j=Object(a.useCallback)(function(e){if(k){var n=k.y,r=k.number,a=(n-e.pageY)/n*(t.max-t.min)+r;a=Math.max(t.min,Math.min(t.max,a)),t.round&&(a=Math.round(a)),a!==t._text&&(t.text=a,t.execute&&t.execute(),b(a),f&&f(a))}},[O,k,b,f]),w=Object(a.useCallback)(function(e){k&&O(!1)},[O,k]);return i.a.createElement("div",{style:{color:l},ref:p,onMouseDown:function(e){o&&O({number:n,y:e.pageY}),t.execute&&u(t)},className:"z-number"},i.a.createElement("div",{style:{borderLeftColor:t.attributes["secondary-color"]},onMouseDown:function(e){e.stopPropagation(),O({number:n,y:e.pageY}),t.execute&&u(t)},className:s?"selected arrow-right":"arrow-right"}),h?"":c(v))})},,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c);n(323),n(270);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var f=function(e){Object(i.a)(n,e);var t=l(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={height:0,referenceHeight:a.fromDecibel(0)},a}return Object(a.a)(n,[{key:"fromDecibel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-80,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return e<-80?0:(this.props.height||45)*Math.pow((e-t)/(n-t),2)}},{key:"componentDidMount",value:function(){var e=this;this.timer=setInterval(function(){var t=e.props.meter.getLevel();e.setState({isRed:t>0,height:Math.min(60,e.fromDecibel(t))})},100)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){var e={height:this.state.height},t={height:this.state.referenceHeight},n="track-meter-value";return this.state.isRed&&(n+=" is-red"),u.a.createElement("div",{className:"track-meter"},u.a.createElement("div",{className:n,style:e}),u.a.createElement("div",{className:"track-meter-reference",style:t}))}}]),n}(c.Component);t.a=f},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(9),o=n(14),s=n(11),c=n(0),u=n.n(c),l=n(6),f=n(29),h=n(695),p=n(12),d=new f.a,m=Object(p.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.stream,n=e.tag,r=e.samples,a=e.track,i=e.onClickTag,o=e.loadingSample,l=e.scrollRef,f=e.id,p=Object(c.useState)(!1),m=Object(s.a)(p,2),v=m[0],b=m[1];Object(c.useEffect)(function(){b(!1)},[t,b]);var g=Object(c.useCallback)(function(){v&&(t.tagSounds=r.map(function(e){return e.getId()}))},[v,t,r]);return u.a.createElement("div",{onMouseDown:g,className:"samples-stream-tag"},u.a.createElement("div",{onClick:function(){return b(!v)},className:v?"tag-info expanded":"tag-info"},u.a.createElement("div",{style:{borderRightColor:d.getColorForHash(n),borderLeftColor:d.getColorForHash(n)},className:"tag-box"})," ",n),u.a.createElement("div",{className:"tag-results"},v&&r.map(function(e,t){return u.a.createElement(h.a,{scrollRef:l,onClickTag:i,loadingSample:o,tags:a.samplesStream.tags,track:a,selected:f===e.getId(),key:e.getId()+"-"+t,sample:e,id:e.getId()})})))});function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=n(1478),y=Object(p.b)(function(e,t){return{searchText:e.selector.quickAddSearchText}},function(e){return{setSearchText:function(t){return e(Object(l.ye)(t))}}})(function(e){var t=e.sequencerEngine,n=e.searchText,r=e.setSearchText,a=Object(c.useRef)(void 0),i=Object(c.useState)(void 0),o=Object(s.a)(i,2),l=o[0],f=o[1],h=Object(c.useState)(void 0),p=Object(s.a)(h,2),d=p[0],m=p[1],v=Object(c.useState)([]),b=Object(s.a)(v,2),y=b[0],k=b[1],O=Object(c.useState)({}),j=Object(s.a)(O,2),w=j[0],E=j[1],S=Object(g.a)({setTags:k,setEffects:E,tags:y,effects:w,sequencerEngine:t,searchText:n,setSearchText:r,selectedTag:l,setSelectedTag:f,selectedEffect:d,setSelectedEffect:m,ref:a}),P=S.onChange,x=S.clear;return u.a.createElement("div",{className:"sample-search-container"},u.a.createElement("input",{value:n,onChange:P,placeholder:"Search for sounds",ref:a}),u.a.createElement("div",{onClick:x,className:"clear-btn"},"x"))}),k=n(696),O=n(367),j=n(355),w=(n(2374),0);t.a=Object(p.b)(function(e,t){return{selectedTrack:e.mix.selectedTrack,trackId:t.track.id,stream:t.track.samplesStream,ids:t.track.samplesStream&&t.track.samplesStream.sounds&&t.track.samplesStream.sounds.length,id:t.track.sample&&t.track.sample.getId(),selectedSteps:e.keyboard.selectedPianoRollSteps,sampleExplorerSelected:e.selector.sampleExplorerSelected,explorerMaximized:e.selector.explorerMaximized}},function(e){return{setSourceExploring:function(t){return e(Object(l.ug)(t))},setSampleExplorerSelected:function(t){return e(Object(l.Ie)(t))},setSearchText:function(t){return e(Object(l.ye)(t))}}})(function(e){var t=e.isPianoRoll,n=e.track,r=e.stream,l=e.id,f=(e.selectedSteps,e.setSampleExplorerSelected),p=e.sampleExplorerSelected,d=e.setSearchText,b=e.explorerMaximized,g=e.setSourceExploring,E=Object(c.useState)(!1),S=Object(s.a)(E,2),P=S[0],x=S[1],T=Object(c.useCallback)(function(){x(!P)},[P,x]),C=Object(c.useRef)(!1),N=Object(c.useRef)(void 0),R=Object(c.useState)(13),M=Object(s.a)(R,2),A=M[0],q=M[1],D=Object(j.a)(N,A,!0,r).size,I=Object(c.useState)([]),_=Object(s.a)(I,2),F=_[0],L=_[1],B=function(e,t){var n=Object(c.useState)({}),r=Object(s.a)(n,2),a=r[0],i=r[1],o=Object(c.useState)(void 0),u=Object(s.a)(o,2),l=u[0],f=u[1];return Object(c.useEffect)(function(){"TAGS"!==l&&t&&t._tagSounds&&(t.tagSounds=void 0)},[l,t]),Object(c.useEffect)(function(){if("TAGS"===l){var t,n={},r=v(e);try{for(r.s();!(t=r.n()).done;){var a,o=t.value,s=v(o.tags);try{for(s.s();!(a=s.n()).done;){var c=a.value;c in n||(n[c]=[]),n[c].push(o)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){r.e(u)}finally{r.f()}i(n)}},[e,l]),{tags:a,groupBy:l,setGroupBy:f}}(F,r),z=B.tags,V=B.groupBy,H=B.setGroupBy;Object(c.useEffect)(function(){return function(){return g(void 0)}},[]),Object(c.useEffect)(function(){g(void 0)},[r]),Object(c.useEffect)(function(){setTimeout(function(){if(N.current){var e=N.current.offsetHeight/15;q(e)}},100)},[N.current&&N.current.offsetHeight,q,b]),Object(O.a)({clear:function(){return f(!1)},selected:p}),Object(c.useEffect)(function(){return function(){return f(!1)}},[]);var U=Object(c.useCallback)(function(){n.backSamplesStream(),n!==n.sequencerEngine.auditionTrack&&(n.updateSteps(),d(""))},[n]),J=Object(c.useCallback)(function(){n.forwardSamplesStream(),n!==n.sequencerEngine.auditionTrack&&(n.updateSteps(),d(""))},[n]);Object(c.useEffect)(function(){if(r&&r._sounds){var e=++w;Object(k.a)(r._sounds,r.id).then(function(t){e===w&&L(t)})}},[n,r,L,r&&r._sounds]);var G=Object(c.useCallback)(function(){var e=Object(o.a)(a.a.mark(function e(t,r){var o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C.current=!0,d(""),o=n.samplesStream.tags,s=[t],r&&(s=[].concat(Object(i.a)(o),Object(i.a)(s))),e.next=7,n.sequencerEngine.searchForSounds(s,!0,n,!1);case 7:C.current=!1;case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),[n]);if(Object(c.useEffect)(function(){if(n.samplesStream){var e=n.samplesStream.tags;n.samplesStream.filterFavorites!==P&&n.sequencerEngine.searchForSounds(e,!0,n,!1,!1,P,!1)}},[P]),!r)return[];Array.from(new Set(r.sounds||[]));var W=Array.from(new Set(n.samplesStream.tags||[])),K="samples-stream-explorer no-select";p&&(K+=" selected");var X=n.backStreams,Q=n.forwardStreams,Y="";Y=V?Object.keys(z).sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}).map(function(e,t){return u.a.createElement(m,{scrollRef:N,onClickTag:G,track:n,stream:r,key:e+","+t,loadingSample:C,id:l,tag:e,samples:z[e]})}):F.slice(0,D).map(function(e,t){return u.a.createElement(h.a,{scrollRef:N,onClickTag:G,loadingSample:C,tags:n.samplesStream.tags,track:n,selected:l===e.getId(),key:e.getId()+"-"+t,sample:e,id:e.getId()})});return u.a.createElement("div",{onMouseDown:function(e){e.stopPropagation(),f(!0)},className:K},u.a.createElement("div",{className:"explorer-header"},u.a.createElement("div",{className:"header-text"},X.length+Q.length>0?u.a.createElement("div",{className:"arrows"},X.length>0?u.a.createElement("div",{onClick:U,className:"arrow-left"}):"",Q.length>0?u.a.createElement("div",{onClick:J,className:0===X.length?"no-left arrow-right":"arrow-right"}):""):"",r&&r.length," ",W.map(function(e,t){return u.a.createElement("span",{key:t,onClick:function(){return G(e)},className:1===W.length?"stream-type first last":0===t?"stream-type first":t===W.length-1?"stream-type last":"stream-type"},e," ",t<W.length-1?"+":""," ")})," sounds",u.a.createElement("div",{onClick:T,className:P?"filter-by-favorites heart favorited":"filter-by-favorites heart"}),u.a.createElement("img",{onClick:function(){return H("TAGS"===V?void 0:"TAGS")},src:"/tag.svg",className:"TAGS"===V?"tags-icon selected":"tags-icon"})),t?u.a.createElement(y,{sequencerEngine:n.sequencerEngine}):""),u.a.createElement("div",{ref:N,className:"inner-explorer"},Y))})},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(20),u=n(7),l=n(10),f=n(1),h=n(0),p=n.n(h),d=n(90),m=n.n(d),v=n(38),b=n(8);function g(e,t){for(var n in e)if(t[n]!==e[n])return!1;for(var r in t)if(t[r]!==e[r])return!1;return!0}var y=function(){function e(t){Object(o.a)(this,e),this.filter=t,this.results=void 0}return Object(s.a)(e,[{key:"isEqual",value:function(e){return g(this.filter.instrumentTypes,e.filter.instrumentTypes)&&g(this.filter.tags,e.filter.tags)}},{key:"getPaginatedResults",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return void 0===this.results?[]:this.results.length>e+t?this.results.slice(e,e+t):this.results.slice(e)}}]),e}(),k=n(30).a.presets,O=function(){function e(){Object(o.a)(this,e),this.queries=[]}return Object(s.a)(e,[{key:"clear",value:function(){this.queries=[]}},{key:"getPaginatedPresets",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:10,i=u.length>3&&void 0!==u[3]?u[3]:0,t=Object(b.a)({},t),o=new y(t),void 0===(s=this.queries.find(function(e){return e.isEqual(o)}))){e.next=7;break}return e.abrupt("return",s.getPaginatedResults(n,r));case 7:return e.next=9,k.getPresets(t,i);case 9:return c=e.sent,o.results=c,this.queries.push(o),e.abrupt("return",o.getPaginatedResults(n,r));case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}();n(69);function j(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var w=new O,E=function(e){Object(u.a)(n,e);var t=j(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={presets:[],start:0,loading:!1,loadingCounter:0,probability:.5,crossbreedEffects:!0},r.getPresets(),r.onClickNext=r.onClickNext.bind(Object(c.a)(r)),r.onClickPrevious=r.onClickPrevious.bind(Object(c.a)(r)),r}return Object(s.a)(n,[{key:"onClickNext",value:function(){this.state.start=this.state.start+10,this.getPresets()}},{key:"onClickPrevious",value:function(){this.state.start=Math.max(0,this.state.start-10),this.getPresets()}},{key:"startLoading",value:function(){var e=this;this.setState({loading:!0}),this.loadingTimer=setInterval(function(){e.setState({loadingCounter:(e.state.loadingCounter+1)%5})},200)}},{key:"stopLoading",value:function(){this.setState({loading:!1}),clearInterval(this.loadingTimer)}},{key:"getPresets",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t={instrumentTypes:{},tags:{}}).instrumentTypes[this.props.track.instrument.getInstrumentType()]=!0,e.next=4,w.getPaginatedPresets(t,this.state.start);case 4:n=e.sent,this.setState({presets:n});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onUpdateProbability",value:function(e){this.setState({probability:e/100})}},{key:"onClickPreset",value:function(){var e=Object(i.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.startLoading(),e.next=3,this.props.track.mateWithPreset(t,this.state.probability,this.state.crossbreedEffects);case 3:this.stopLoading();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getEffectsClassName",value:function(e){return this.state.crossbreedEffects===e?"crossbreed-option enabled":"crossbreed-option"}},{key:"onClickEffects",value:function(e){this.setState({crossbreedEffects:e})}},{key:"render",value:function(){for(var e=this,t="",n=0;n<this.state.loadingCounter;n++)t+=".";return p.a.createElement("div",{className:"fm-genetix"},p.a.createElement("div",{onClick:this.props.onClickBack,className:"back-button"},"Back"),p.a.createElement(v.a,{condition:this.state.loading},p.a.createElement("div",{className:"loading-spinner"},"Loading ",t," ")),p.a.createElement(v.a,{condition:!this.state.loading},p.a.createElement("div",{className:"crossbreed-options"},p.a.createElement("div",null,p.a.createElement("div",{className:"crossbreed-probability"},"Crossbreed Preset: ",100*this.state.probability,"%"),p.a.createElement(m.a,{value:100*this.state.probability,change:function(t){return e.onUpdateProbability(t.target.value)},step:.01,max:100,min:0,orientation:"horizontal",reversed:!1})),p.a.createElement("div",null,"Crossbreed Effects:",p.a.createElement("span",{onClick:function(){return e.onClickEffects(!0)},className:this.getEffectsClassName(!0)},"Yes"),p.a.createElement("span",{onClick:function(){return e.onClickEffects(!1)},className:this.getEffectsClassName(!1)},"No"))),p.a.createElement("div",{className:"presets"},this.state.presets.map(function(t,n){return p.a.createElement("div",{onClick:function(){return e.onClickPreset(t)},className:n%2===0?"preset":"preset odd"},t.title)})),p.a.createElement("div",{className:"pagination-buttons"},p.a.createElement(v.a,{condition:this.state.start>0},p.a.createElement("div",{onClick:this.onClickPrevious,className:"pagination-button"},"PREVIOUS")),p.a.createElement("div",{onClick:this.onClickNext,className:"pagination-button"},"NEXT"))))}}]),n}(h.Component);t.a=E},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(9),s=n(11),c=n(0),u=n.n(c),l=n(12),f=n(210),h=n(6),p=n(38),d=n(732),m=new(n(29).a),v=Object(l.b)(function(e,t){var n=t.track.track;return{id:void 0!==n.sample&&void 0!==n.sample.getId()?n.sample.getId():n.presetName||n.getName()}},null)(function(e){e.showMods;var t=e.name,n=e.rackTrack,r=e.track,a=e.onSelect,i=e.isSelected,o=e.onDelete,s=(e.id,"track-slot"),c={};return i&&(s+=" selected",c.backgroundColor=m.getColorForTrack(r.track)),t.length>16&&(t=t.substring(0,16)+"..."),u.a.createElement("div",{onClick:a,className:s,style:c},u.a.createElement("div",{className:"sub-instrument-name"},t),u.a.createElement(d.a,{rackTrack:n,track:r}),u.a.createElement(p.a,{condition:i},u.a.createElement("div",{onClick:o,className:"delete-button"},"x")))}),b=(n(2425),n(1097)),g=(n(211),n(346),n(833));n(75);var y=Object(l.b)(function(e,t){return{instrumentTypeDragging:e.instruments.instrumentTypeDragging,presetDragging:e.presets.presetDragging,sampleDragging:e.selector.sampleDragging,sampleTagDragging:e.selector.sampleTagDragging}},function(e,t){return{setInstrumentTypeDragging:function(t){return e(Object(h.Cc)(t))},setPresetDragging:function(t){return e(Object(h.re)(t))},setSampleDragging:function(t){return e(Object(h.He)(t))},setSampleTagDragging:function(t){return e(Object(h.Le)(t))}}})(function(e){var t=Object(c.useCallback)(function(t){t.stopPropagation(),e.instrumentTypeDragging?(e.newInstrument(e.instrumentTypeDragging),e.setInstrumentTypeDragging(void 0)):e.presetDragging?(e.newPreset(e.presetDragging),e.setPresetDragging(void 0)):e.sampleDragging?(e.newSample(e.sampleDragging),e.setSampleDragging(void 0)):e.sampleTagDragging&&Object(g.a)(e.sampleTagDragging,e.track,e.setSampleTagDragging,e.newSample)},[e.instrumentTypeDragging,e.newInstrument,e.newPreset,e.newSample,e.presetDragging,e.sampleDragging,e.sampleTagDragging]);return u.a.createElement("div",{onDragOver:function(e){return e.preventDefault()},onDrop:t,className:"drop-here"},u.a.createElement("span",null,"Drop inst, preset or sample here"))});n(560),n(392);t.a=Object(l.b)(function(e,t){return{selectedInstrument:e.tracks.selectedRackSubTrack[t.track.id],tracks:t.track.tracks}},function(e,t){return{setSelectedInstrument:function(n){return e(Object(h.nf)(t.track.id,n))}}})(function(e){var t=e.track,n=e.selectedInstrument,r=e.setSelectedInstrument,l=e.scrollContainer,h=Object(c.useState)(t.tracks),p=Object(s.a)(h,2),d=p[0],m=p[1],g=Object(c.useState)(!1),k=Object(s.a)(g,2),O=k[0],j=k[1],w=Object(c.useCallback)(function(e){var n=t.addInstrumentType(e);m(Object(o.a)(t.tracks)),r(n)},[t,m,r]);Object(c.useEffect)(function(){m(t.tracks)},[t.tracks,m]);var E=Object(c.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.addPreset(n);case 2:i=e.sent,m(Object(o.a)(t.tracks)),r(i);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[t,m,r]),S=Object(c.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(n,i){var s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.addSample(n,i);case 2:s=e.sent,m(Object(o.a)(t.tracks)),r(s);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),[t,m,r]),P=Object(c.useCallback)(function(){t.deleteInstrument(n),r(void 0),m(Object(o.a)(t.tracks))},[t,m,r,n]),x=t.tracks.indexOf(n)>-1?Object(b.a)(n.track,l,!0):"",T=(Object(c.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getCopy();case 2:i=e.sent,t.addInstrument(i),r(void 0),m(Object(o.a)(t.tracks));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[m]),"instrument-rack-controller");return O&&(T+=" show-mods"),u.a.createElement("div",{className:"instrument instrument-rack"},u.a.createElement("div",{className:T},d.map(function(e){return u.a.createElement(v,{name:e.presetName||e.getName(),key:e.presetName||e.getName(),rackTrack:t,isSelected:n===e,onDelete:function(){return P()},onSelect:function(){return r(e===n?void 0:e)},track:e})}),O&&n?u.a.createElement(f.a,{parameters:n.getAllParameters(),setShowMods:j,showMods:O}):"",u.a.createElement(y,{newInstrument:w,newPreset:E,newSample:S,track:t})),x)})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(6),s=n(12),c=Object(s.b)(function(e,t){return{}},function(e){return{setShowFormantPresets:function(t){return e(Object(o.Lf)(t))}}})(function(e){var t=e.oscillator,n=e.setShowFormantPresets,o=Object(a.useState)(!1),s=Object(r.a)(o,2),c=s[0],u=s[1],l=Object(a.useState)(""),f=Object(r.a)(l,2),h=f[0],p=f[1],d=Object(a.useCallback)(function(){t.saveFormantsAsPreset(h),p(""),u(!1)},[h,t,p,u]);return c?i.a.createElement("div",{className:"save-formants-flow"},i.a.createElement("input",{onChange:function(e){return p(e.target.value)},value:h,type:"text",placeholder:"Name your Multi-Filter"}),i.a.createElement("div",{onClick:d,className:"confirm-formants-btn pushable"},"Complete Save")):i.a.createElement("div",{className:"save-formants-flow"},i.a.createElement("div",{onClick:function(){return u(!0)},className:"pushable save-formants-btn"},"Save Multi-Filter Settings"),i.a.createElement("div",{onClick:function(){return n(!1)},className:"pushable save-formants-btn done-formants-btn"},"Done"))}),u=n(339),l=n(244),f=n(203),h=n(139),p=n(741),d=n(508),m=n(836),v=n(889),b=n(385),g=n(512),y=(n(629),n(1384),n(849)),k=(n(249),n(29)),O=(n(1108),n(22),n(738),n(606),n(38)),j=(n(1032),n(63),n(39),n(376)),w=n(548),E=(n(1405),n(458),n(1385),n(129),n(513)),S=(n(2573),new k.a);t.a=Object(s.b)(function(e,t){var n=t.instrument.oscillatorNodes;return n?{preset1:n[0].preset,preset2:n[1].preset,preset3:n[2].preset,preset4:n[3].preset,selectedParameter:e.effects.accumulatorParameterSelected,planeMapping:e.effects.planeMapping,presetName:t.track.presetName,formant:e.instruments.showFormantEffect,selectedFMOperatorDetails:e.instruments.selectedFMOperatorDetails,showFormantPresets:e.instruments.showFormantPresets}:{}},function(e){return{}})(function(e){var t=Object(a.useRef)(void 0),n=Object(a.useState)(void 0),o=Object(r.a)(n,2),s=o[0],k=o[1],P=Object(a.useState)(!1),x=Object(r.a)(P,2),T=x[0],C=x[1],N=Object(f.a)({ref:t}),R=(N.onContextMenu,N.dropdownPos),M=N.setDropdownPos,A=Object(a.useState)(void 0),q=Object(r.a)(A,2),D=q[0],I=(q[1],Object(a.useState)(void 0)),_=Object(r.a)(I,2),F=_[0],L=_[1],B=Object(a.useState)(0),z=Object(r.a)(B,2),V=z[0],H=z[1],U=Object(a.useState)(!1),J=Object(r.a)(U,2),G=J[0],W=J[1],K=e.instrument,X=e.color||S.getColorForTrack(e.track),Q=Object(a.useCallback)(function(){e.track.subSequence.createZObject(0,0,"synthcontrol").effect.linkSynth(e.instrument)},[e.instrument]);Object(a.useEffect)(function(){void 0!==e.selectedFMOperatorDetails?L(K.oscillatorNodes[e.selectedFMOperatorDetails]):L(void 0)},[e.selectedFMOperatorDetails,L,K]);var Y=K.oscillatorNodes[V],Z=F;Object(a.useEffect)(function(){var e=K.oscillatorNodes.indexOf(F);H(-1===e?0:e)},[H,F]),Object(a.useEffect)(function(){if(e.selectedParameter){var t=e.selectedParameter.context;if(t.instrument===K){var n=t.subDevice;if(n){n.oscillator&&(n=n.oscillator);var r=K.oscillatorNodes.indexOf(n);r>-1&&(H(r),L(n))}else L(void 0)}}},[e.selectedParameter,K,H,L]);var $=Object(a.useCallback)(function(){W(!G)},[W,G]),ee="instrument multi-synth rack-synth";e.planeMapping&&(ee+=" plane-mapping");var te=Object(a.useCallback)(function(t){t.stopPropagation(),e.planeMapping&&e.planeMapping.randomlyMapParameters(e.track)},[e.planeMapping,e.instrument]),ne="",re="";if(s){var ae="";"LFO"===s?ae=e.track.lfosTrack.lfos.map(function(t){return i.a.createElement(d.a,{key:t.number,lfo:t,sequencerEngine:e.sequencerEngine})}):"ENVELOPE"===s&&(ae=e.track.envelopesTrack.envelopes.map(function(t){return i.a.createElement(p.a,{scrollContainer:e.scrollContainer,key:t.number,envelopeTrack:t,sequencerEngine:e.sequencerEngine})})),ne=i.a.createElement("div",{className:"inner showing-mods"},i.a.createElement("div",{className:"mods-inner"},ae))}return re=i.a.createElement("div",null,i.a.createElement(O.a,{condition:!G},i.a.createElement("div",{className:"inner"},(!T||!F)&&i.a.createElement(m.a,{color:X,track:e.track,osc:Y,scrollContainer:e.scrollContainer,setSelectedOscillator:H,sequencerEngine:e.sequencerEngine,instrument:e.instrument}),i.a.createElement("div",null,i.a.createElement("div",{className:"sections"},i.a.createElement("div",{className:"instrument-section"},i.a.createElement(b.a,{formantsExpanded:T&&F,setFormantsExpanded:C,color:X,setOscillatorDetails:L,oscillatorDetails:F,sequencerEngine:e.sequencerEngine,instrument:K}),D||F?"":i.a.createElement(g.a,{automation:e.automation,sequencerEngine:e.sequencerEngine,instrument:K})),Z&&e.showFormantPresets?i.a.createElement(u.a,{isPianoRoll:!1,initialSize:10,oscillator:Z||K.oscillators[0],track:Z||K.oscillators[0],content:(Z||K.oscillators[0]).preset,searchText:"",type:"formants"},i.a.createElement(c,{oscillator:Z||K.oscillators[0]})):e.formant?i.a.createElement(v.a,{track:e.track,sequencerEngine:e.sequencerEngine,formant:e.formant,instrument:K}):i.a.createElement("div",{className:"instrument-section envelopes"},i.a.createElement("div",{className:"instrument-subsection envelopes"},i.a.createElement(j.a,{color:X,automation:e.automation,envelopeOptions:E.a,sequencerEngine:e.sequencerEngine,instrument:K})),i.a.createElement("div",{className:"aux-parameters"},i.a.createElement(y.a,{instrument:K,selectedOscillator:V,sequencerEngine:e.sequencerEngine}),i.a.createElement("div",{className:"mods-container"},i.a.createElement("div",{onClick:function(){return k("LFO"===s?void 0:"LFO")},className:"LFO"===s?"mod-type-btn selected pushable ":"mod-type-btn pushable"},"LFOs"),i.a.createElement("div",{onClick:function(){return k("ENVELOPE"===s?void 0:"ENVELOPE")},className:"ENVELOPE"===s?"mod-type-btn selected pushable":"mod-type-btn pushable"},"ENVs"),i.a.createElement("div",{onClick:$,className:"mod-type-btn pushable"},"MODS")))))))),i.a.createElement(O.a,{condition:G},i.a.createElement("div",{className:"clear-fix"}),i.a.createElement(w.a,{instrument:K}),i.a.createElement("div",{onClick:$,className:"mods-button common-button small-button"},G?"BACK":"MODS"))),i.a.createElement("div",{ref:t,onClick:te,className:ee},i.a.createElement(l.a,{dropdownPos:R,setDropdownPos:M},i.a.createElement(h.a,{onMouseDown:Q},"Create Controller Object")),re,ne)})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(253),f=n(12),h=n(39),p=n.n(h),d=n(6),m=n(34),v=n(214);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var g=function(e){Object(i.a)(n,e);var t=b(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"onSelectTrack",value:function(e){for(var t in this.tracks)this.tracks[t].isConnectedToEnvelope(this.props.envelope)&&this.tracks[t].disconnectFromEnvelope(this.props.envelope);e.value.connectToEnvelope(this.props.envelope),this.setState(this.state)}},{key:"getTruncatedName",value:function(e){var t=e.getName();return void 0===t?"":t.length>=16?t.slice(0,16)+"...":t}},{key:"getOptions",value:function(){var e=this;return this.props.sequencerEngine.tracks.map(function(t){return{label:t.trackNumber+1+". "+e.getTruncatedName(t),value:t}})}},{key:"getSelectedOption",value:function(){var e=this;return this.getOptions().filter(function(t){return t.value.isConnectedToEnvelope(e.props.envelope)})[0]}},{key:"render",value:function(){var e=this,t=this.props.isSelected&&void 0===this.getSelectedOption()?"envelope-dropdown osc-type-dropdown-container selected":"envelope-dropdown osc-type-dropdown-container";return u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(m.E)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:t},u.a.createElement(p.a,{controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getOptions(),onChange:function(t){return e.onSelectTrack(t)},value:this.getSelectedOption(),placeholder:"Track"}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"pre-post-options"},u.a.createElement("div",{onClick:function(){return e.onClickMode(v.b)},className:this.preFXClassName},"Pre-FX"),u.a.createElement("div",{onClick:function(){return e.onClickMode(v.a)},className:this.postFXClassName},"Post-FX")))}},{key:"onClickMode",value:function(e){var t=this.connectedTrack;void 0!==t&&(t.setEnvelopeMode(this.props.envelope,e),this.setState(this.state))}},{key:"tracks",get:function(){return this.props.sequencerEngine.tracks}},{key:"connectedTrack",get:function(){var e=this;return this.tracks.filter(function(t){return t.isConnectedToEnvelope(e.props.envelope)})[0]}},{key:"mode",get:function(){var e=this.connectedTrack;if(void 0!==e)return e.getEnvelopeMode(this.props.envelope)}},{key:"preFXClassName",get:function(){return void 0!==this.mode&&this.mode!==v.a?"pre-post-option selected":"pre-post-option"}},{key:"postFXClassName",get:function(){return void 0!==this.mode&&this.mode!==v.b?"pre-post-option selected":"pre-post-option"}}]),n}(c.Component),y=Object(f.b)(function(e){return{tracks:e.tracks.trackSteps}},function(e,t){return{setContextualHelp:function(t){return e(Object(d.ub)(t))}}})(g);n(38),n(148),n(1049);function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var O=function(e){Object(i.a)(n,e);var t=k(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={showEnvelopeModal:!1,value:0},a}return Object(a.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){e.setState({value:e.props.envelopeTrack.envelope.envelope.value})},100)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"showEnvelopeModal",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({showEnvelopeModal:e})}},{key:"isSelected",value:function(){return!this.props.hideSelection&&this.props.selectedEnvelope===this.props.envelopeTrack.number}},{key:"render",value:function(){var e=this,t="instrument-subsection-name lfo-subsection-name lfo-track-foreground-"+this.props.envelopeTrack.number,n=this.props.envelopeTrack.envelope,r=this.isSelected(),a=r?"envelope-component selected":"envelope-component",i=this.props.envelopeTrack.number;a+=" modulator-"+i;var o={width:100*this.state.value+"%"};return u.a.createElement("div",{onClick:function(){return e.props.setSelectedEnvelope(e.props.envelopeTrack.number)},onMouseOver:function(){return e.props.setContextualHelp(m.B)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:a},u.a.createElement("div",{className:t},this.props.envelopeTrack.name),u.a.createElement(y,{isSelected:r,sequencerEngine:this.props.sequencerEngine,envelope:n}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"knobs"},u.a.createElement(l.a,{name:"Env "+i,envelope:n,width:200,hasRelease:!0,hasLevel:!1,sequencerEngine:this.props.sequencerEngine})),u.a.createElement("div",{className:"envelope-value-container"},u.a.createElement("div",{className:"envelope-value",style:o})))}}]),n}(c.Component);t.a=Object(f.b)(function(e){return{selectedEnvelope:e.sequencer.selectedEnvelope}},function(e){return{setSelectedEnvelope:function(t){return e(Object(d.Te)(t))},setContextualHelp:function(t){return e(Object(d.ub)(t))}}})(O)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12),f=n(39),h=n.n(f);var p=Object(l.b)(function(e,t){return{value:t.effect.type}},null)(function(e){var t=e.effect,n=e.value,r=[{label:"Lowpass",value:"lowpass"},{label:"Highpass",value:"highpass"},{label:"Bandpass",value:"bandpass"},{label:"Notch",value:"notch"},{label:"Peaking",value:"peaking"}],a=Object(c.useCallback)(function(e){t.type=e},[]);return u.a.createElement("div",{className:"filter-dropdown-container"},u.a.createElement("div",{className:"dropdown-label"},"Type: "),u.a.createElement(h.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:r,onChange:function(e){return a(e.value)},value:function(e){return r.find(function(t){return t.value===e})}(n),placeholder:"Type"}))}),d=n(22);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var v=function(e){Object(i.a)(n,e);var t=m(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={filterEffect:e.filterEffect,refined:!1},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.filterEffect=e.filterEffect,!0}},{key:"handleOptionChange",value:function(e){document.activeElement.blur(),"lowpass"===e.target.value?this.state.filterEffect.lowpass():this.state.filterEffect.hipass(),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.filterEffect.isEnabled()}},{key:"onChangeRefined",value:function(e){this.setState({refined:"refined"===e})}},{key:"render",value:function(){var e=this,t=(this.state.filterEffect.type,void 0!==this.props.automation||this.state.filterEffect.isEnabled(),this.state.refined?400:1e4);return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(p,{effect:this.props.filterEffect}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(d.a,{customClassName:"wider-slider",effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Cutoff",lfoEnabled:!0,root:2,sequencerEngine:this.props.sequencerEngine,unit:"HZ",parameter:this.state.filterEffect.cutoffParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1,max:t,min:20}),u.a.createElement(d.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,root:2,name:"Q",lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,parameter:this.state.filterEffect.qParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:10,min:0}),u.a.createElement("div",{className:""},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:this.state.refined?"unrefined":"refined",checked:this.state.refined,onChange:function(t){return e.onChangeRefined(t.target.value)}}),"Refine"))):"")}}]),n}(c.Component);t.a=v},function(e,t,n){"use strict";var r=n(99),a=n(0),i=n.n(a),o=(n(347),n(220),n(6),n(1046),n(505)),s=n(12),c=Object(s.b)(function(e,t){var n=t.pad.effectRack.adjacencyLists&&t.pad.effectRack.adjacencyLists[t.ffrom||t.fx.id];return{selectedEdge:e.pads.selectedEdge,numEdges:n&&n.length,effects:e.pads.padEffects[t.pad.id],midiEffects:e.pads.trackMidiEffects[t.pad.id]}},function(e){return{}})(function(e){var t=e.edgesRef,n=e.fromWindow,r=e.outputPrefix,a=e.scale,s=e.containerRef,c=e.fromId,u=(e.type,e.fx),l=e.pad,f=e.id,h=l.effectRack.adjacencyLists;if(!h)return[];var p=h[f||u.id];if(!p)return[];return p.map(function(e,f){return i.a.createElement(o.a,{edgesRef:t,key:e.effect.id,sequencerEngine:l.sequencerEngine,containerRef:s,fromWindow:n,outputPrefix:r,scale:a,fromId:c||u.id,pad:l,edge:e,fx:u})})});t.a=Object(s.b)(function(e,t){if(!t.pad)return{};var n=t.pad.effectRack&&t.pad.effectRack.adjacencyLists&&t.pad.effectRack.adjacencyLists[-1];return{controlEdges:n&&n.length,isCollapsed:t.pad.effectRack&&e.effects.effectCollapsed[t.pad.effectRack.id]}},function(e){return{}})(function(e){e.setSelectedPadEdge,e.setDrawingPadEdge;var t=e.isCollapsed,n=e.pad,a=e.effects,s=void 0===a?[]:a,u=e.fromId,l=(e.controlEdges,e.isMidi),f=(e.drawingEdge,e.selectedElements,e.outputPrefix),h=void 0===f?"output-node-":f,p=e.edgesRef,d=Object(r.a)(e,["setSelectedPadEdge","setDrawingPadEdge","isCollapsed","pad","effects","fromId","controlEdges","isMidi","drawingEdge","selectedElements","outputPrefix","edgesRef"]);return n&&n.effectRack&&n.effectRack.adjacencyLists?t?i.a.createElement(o.a,Object.assign({scale:d.scale,sequencerEngine:n.sequencerEngine,fromId:n.id,edgesRef:p,test:!0,outputPrefix:"output-node-",padZObject:n.zObject,pad:n,edge:{effect:{id:-1}}},d)):i.a.createElement("g",{className:"all-edges"},i.a.createElement(c,Object.assign({id:-1,pad:n,fromId:n.effectRack.id,outputPrefix:l&&h,ffrom:-1,edgesRef:p,fromWindow:u,sequencerEngine:n.sequencerEngine,fx:n.effectRack},d)),!l&&i.a.createElement(o.a,Object.assign({scale:d.scale,fromId:n.id,sequencerEngine:n.sequencerEngine,fromWindow:u,edgesRef:p,test:!0,padZObject:n.zObject,outputPrefix:h,pad:n,edge:{effect:{id:-1}}},d)),s.map(function(e){return i.a.createElement(c,Object.assign({key:e.id,edgesRef:p,pad:n,fx:e},d))})):[]})},,,function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(5),a=n.n(r),i=n(14),o=n(558),s=n(65),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r){var i,c,u,l,f,h;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(o.f)("A new spore.");case 2:i=n.sent,i.account,i.flatSignature,c=i.splitSignature,u=c.r,l=c.s,f=c.v,h={r:u,s:l,v:f,message:"A new spore.",sporeHash:Object(s.c)(e),tokenId:t},"https://zequencer.io",window.location.hostname.includes("localhost"),fetch("https://zequencer.io/newSpore/",{method:"POST",body:JSON.stringify(h),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){console.log("response=",e),r(e.transactionHash)});case 11:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())}},,,function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(a.a)(this,e),this.name=t,this.parent=n,this.subFolders=[],this.items=[],this.depth=r}return Object(i.a)(e,[{key:"isDynamic",value:function(){return!1}},{key:"isRoot",value:function(){return void 0===this.parent}},{key:"addItem",value:function(e){e.parent=this,this.items.push(e)}},{key:"deleteItem",value:function(e){var t=this.items.indexOf(e);if(t>-1)return e.parent=void 0,this.items.splice(t,1),e}},{key:"deleteFolder",value:function(e){var t=this.subFolders.indexOf(e);if(t>-1)return this.subFolders.splice(t,1),e}},{key:"delete",value:function(){void 0!==this.parent&&this.parent.deleteFolder(this)}},{key:"newFolder",value:function(t){var n=new e(t,this,this.depth+1);return this.subFolders.push(n),n}},{key:"addFolder",value:function(e){e.depth=this.depth+1,this.subFolders.push(e)}},{key:"getJson",value:function(){return{name:this.name,subFolders:this.subFolders.map(function(e){return e.getJson()}),items:this.items.map(function(e){return e.getJson()})}}},{key:"fromJson",value:function(t,n){var r=this;return this.name=t.name,this.items=t.items.map(function(e){return n(e)}),this.items.forEach(function(e){return e.parent=r}),this.subFolders=t.subFolders.map(function(t){return new e(void 0,r,r.depth+1).fromJson(t,n)}),this}},{key:"getAllItems",value:function(){var e=Object(r.a)(this.items);for(var t in this.subFolders)e=e.concat(this.subFolders[t].getAllItems());return e}}]),e}();t.a=o},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"sampleHash",type:"bytes32"}],name:"favoriteSample",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"sampleHash",type:"bytes32"}],name:"unfavoriteSample",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"user",type:"address"},{indexed:!0,name:"sampleHash",type:"bytes32"}],name:"SampleFavorited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"user",type:"address"},{indexed:!0,name:"sampleHash",type:"bytes32"}],name:"SampleUnfavorited",type:"event"}],this.contractAddress="0xcddbc9238e5ba4f6f4c0c8e0ef4231e1be4943fc"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"zequencerAddress",type:"address"},{indexed:!0,internalType:"address",name:"walletAddress",type:"address"},{indexed:!1,internalType:"string",name:"message",type:"string"},{indexed:!1,internalType:"uint8",name:"v",type:"uint8"},{indexed:!1,internalType:"bytes32",name:"r",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"s",type:"bytes32"}],name:"AccountAuthorized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"zequencerAddress",type:"address"},{indexed:!0,internalType:"address",name:"walletAddress",type:"address"},{indexed:!1,internalType:"string",name:"message",type:"string"},{indexed:!1,internalType:"uint8",name:"v",type:"uint8"},{indexed:!1,internalType:"bytes32",name:"r",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"s",type:"bytes32"}],name:"AccountRevoked",type:"event"},{inputs:[{internalType:"address",name:"walletAddress",type:"address"},{internalType:"string",name:"message",type:"string"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"authorize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"walletAddress",type:"address"},{internalType:"string",name:"message",type:"string"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"revoke",outputs:[],stateMutability:"nonpayable",type:"function"}],this.contractAddress="0xCB1a18e5e9cB53453f78fd5A2E378A3B81cBd4Ff"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[{internalType:"bytes32",name:"projectHash",type:"bytes32"},{internalType:"int16",name:"bpm",type:"int16"},{internalType:"bytes32",name:"thumbnail",type:"bytes32"},{internalType:"bytes32[]",name:"presetHash",type:"bytes32[]"},{internalType:"int8",name:"patterns",type:"int8"},{internalType:"bool",name:"hasArrangement",type:"bool"}],name:"newProjectMetadata",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"projectHash",type:"bytes32"},{indexed:!1,internalType:"int16",name:"bpm",type:"int16"}],name:"ProjectBPM",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"projectHash",type:"bytes32"}],name:"ProjectHasArrangement",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"projectHash",type:"bytes32"},{indexed:!1,internalType:"int8",name:"patterns",type:"int8"}],name:"ProjectPatternsCount",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"projectHash",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"presetHash",type:"bytes32"}],name:"ProjectUsesPreset",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"projectHash",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"thumbnailHash",type:"bytes32"}],name:"ProjectVisuals",type:"event"}],this.contractAddress="0x020c2D741a221bBADc2d979b62D11e968da3450e"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!0,inputs:[{name:"user",type:"address"}],name:"getNumberOfFollowers",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"userB",type:"address"}],name:"unfollow",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"name",type:"string"}],name:"isUserNameAvailable",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"user",type:"address"}],name:"getUserProfilePicture",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"profile",type:"bytes32"}],name:"setProfileHash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"userB",type:"address"}],name:"follow",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"user",type:"address"},{name:"index",type:"uint256"}],name:"getFollower",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"profilePicture",type:"bytes32"}],name:"setProfilePicture",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"name",type:"string"}],name:"getUserAddressFromName",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"user",type:"address"}],name:"getUserProfile",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"name",type:"string"}],name:"setName",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"user",type:"address"}],name:"getUserName",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"userAddress",type:"address"},{indexed:!0,name:"ipfsAddress",type:"bytes32"}],name:"ProfileIpfsHashUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userAddress",type:"address"},{indexed:!0,name:"ipfsAddress",type:"bytes32"}],name:"ProfilePictureIpfsHashUpdated",type:"event"}],this.contractAddress="0xd0fb239ceb867bdcf68ae8331e911a9d4ec80632"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!0,inputs:[{internalType:"uint32",name:"i",type:"uint32"}],name:"getGuildForSelf",outputs:[{internalType:"uint32",name:"",type:"uint32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"address",name:"user",type:"address"}],name:"getTotalGuildsForUser",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"bytes32[6]",name:"guildPublicKey",type:"bytes32[6]"},{internalType:"string",name:"name",type:"string"},{internalType:"bytes32",name:"encryptedKeyIpfsHash",type:"bytes32"},{internalType:"bytes32[9]",name:"contentKey",type:"bytes32[9]"},{internalType:"bytes32[6]",name:"userPublicKey",type:"bytes32[6]"}],name:"newGuild",outputs:[{internalType:"uint32",name:"",type:"uint32"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"uint32",name:"guildId",type:"uint32"}],name:"rejectRequestToAddToGuild",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"uint32",name:"guildId",type:"uint32"},{internalType:"bytes32[6]",name:"publicKey",type:"bytes32[6]"}],name:"setPublicKeyForGuild",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{internalType:"uint32",name:"guildId",type:"uint32"},{internalType:"address",name:"member",type:"address"}],name:"isGuildMember",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"uint32",name:"guildId",type:"uint32"},{internalType:"address",name:"potentialMember",type:"address"},{internalType:"bytes32",name:"encryptedKeyIpfsHash",type:"bytes32"},{internalType:"bytes32[9]",name:"contentKey",type:"bytes32[9]"},{internalType:"bytes32[6]",name:"publicKey",type:"bytes32[6]"}],name:"requestToAddMember",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"getTotalGuildsForSelf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"uint32",name:"guildId",type:"uint32"}],name:"acceptRequestToAddToGuild",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint32",name:"i",type:"uint32"}],name:"getGuildForUser",outputs:[{internalType:"uint32",name:"",type:"uint32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"uint32",name:"guildId",type:"uint32"}],name:"getTotalGuildUsers",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"uint32",name:"guildId",type:"uint32"}],name:"getGuildName",outputs:[{internalType:"string",name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"uint32",name:"guildId",type:"uint32"},{internalType:"string",name:"name",type:"string"}],name:"setNameForGuild",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{internalType:"uint32",name:"guild",type:"uint32"},{internalType:"uint32",name:"i",type:"uint32"}],name:"getUserFromGuild",outputs:[{internalType:"address",name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"encryptionContractAddress",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"",type:"address"},{indexed:!0,internalType:"uint32",name:"",type:"uint32"},{indexed:!1,internalType:"string",name:"name",type:"string"}],name:"NewGuild",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"",type:"address"},{indexed:!0,internalType:"uint32",name:"",type:"uint32"}],name:"NewGuildMember",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"",type:"address"},{indexed:!0,internalType:"address",name:"",type:"address"},{indexed:!0,internalType:"uint32",name:"",type:"uint32"}],name:"NewGuildMemberRequest",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"",type:"address"},{indexed:!0,internalType:"uint32",name:"",type:"uint32"}],name:"NewGuildMemberRequestAccepted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"",type:"address"},{indexed:!0,internalType:"uint32",name:"",type:"uint32"}],name:"NewGuildMemberRequestRejected",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"",type:"address"},{indexed:!0,internalType:"uint32",name:"",type:"uint32"}],name:"GuildMemberLeft",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint32",name:"",type:"uint32"},{indexed:!0,internalType:"bytes32[6]",name:"",type:"bytes32[6]"}],name:"GuildPublicKeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"",type:"address"},{indexed:!0,internalType:"uint32",name:"",type:"uint32"},{indexed:!0,internalType:"bytes32",name:"",type:"bytes32"}],name:"GuildKeyEncrypted",type:"event"}],this.contractAddress="0x70548646c2A475ebfE46F19637651e76a38324d4"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"sharedWith",type:"address"},{name:"contentHash",type:"bytes32"},{name:"encryptedContentKey",type:"bytes32[9]"},{name:"publicKey",type:"bytes32[6]"}],name:"shareEncryptedContentWith",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"publicKey",type:"bytes32[6]"}],name:"setPublicKey",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"previousContentHash",type:"bytes32"},{name:"newContentHash",type:"bytes32"},{name:"encryptedName",type:"bytes32"},{name:"contentType",type:"int8"},{name:"encryptedContentKey",type:"bytes32[9]"},{name:"publicKey",type:"bytes32[6]"}],name:"newEncryptedContent",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"hasPublicKey",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"user",type:"address"},{indexed:!1,name:"publicKey",type:"bytes32[6]"}],name:"NewPublicKey",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"user",type:"address"},{indexed:!1,name:"previousContent",type:"bytes32"},{indexed:!0,name:"newContent",type:"bytes32"},{indexed:!0,name:"contentType",type:"int8"},{indexed:!1,name:"encryptedName",type:"bytes32"},{indexed:!1,name:"contentKey",type:"bytes32[9]"},{indexed:!1,name:"publicKey",type:"bytes32[6]"}],name:"NewEncryptedContent",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"sharedWith",type:"address"},{indexed:!0,name:"creator",type:"address"},{indexed:!0,name:"contentHash",type:"bytes32"},{indexed:!1,name:"contentKey",type:"bytes32[9]"},{indexed:!1,name:"publicKey",type:"bytes32[6]"}],name:"EncryptedContentShared",type:"event"}],this.contractAddress="0xbe559f9f38c5f36186b364972cb8b4ebd7174043"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{internalType:"bytes32",name:"foldersHash",type:"bytes32"}],name:"foldersUpdated",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"foldersHash",type:"bytes32"}],name:"FoldersUpdated",type:"event"}],this.contractAddress="0x20039b89449aC0bAB5B4114Bf66aCff1b3043988"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{internalType:"address",name:"toUser",type:"address"},{internalType:"bytes32",name:"referenceHash",type:"bytes32"},{internalType:"bytes32",name:"messageContentHash",type:"bytes32"}],name:"sendPublicMessage",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"messageContentHash",type:"bytes32"}],name:"deleteMessage",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"fromUser",type:"address"},{indexed:!0,internalType:"address",name:"toUser",type:"address"},{indexed:!0,internalType:"bytes32",name:"referencedHash",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"messageContentHash",type:"bytes32"}],name:"PublicMessageSent",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"messageContentHash",type:"bytes32"}],name:"PublicMessageDeleted",type:"event"}],this.contractAddress="0xb407EFd2254583C8BF99c578c7b891313AC1933E"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[{internalType:"address",name:"samplesAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"resampleHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"sampleUsed",type:"bytes32"}],name:"NewResample",type:"event"},{inputs:[{internalType:"bytes32",name:"resampleHash",type:"bytes32"},{internalType:"string",name:"title",type:"string"},{internalType:"bytes32[4]",name:"tags",type:"bytes32[4]"},{internalType:"bytes32[]",name:"samplesUsedHashes",type:"bytes32[]"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"newResample",outputs:[],stateMutability:"nonpayable",type:"function"}],this.contractAddress="0xD914528749Fcfc2945148551d0F61AfDFe429962"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[{internalType:"address",name:"guildContractAddress",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"guildId",type:"uint256"},{indexed:!1,internalType:"address",name:"user",type:"address"}],name:"UserChoseDefaultGuild",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"guildId",type:"uint256"},{indexed:!1,internalType:"address",name:"user",type:"address"}],name:"UserLeftGuild",type:"event"},{constant:!1,inputs:[{internalType:"bytes32[6]",name:"guildPublicKey",type:"bytes32[6]"},{internalType:"string",name:"guildName",type:"string"},{internalType:"bytes32",name:"encryptedKeyIpfsHash",type:"bytes32"},{internalType:"bytes32[9]",name:"contentKey",type:"bytes32[9]"},{internalType:"bytes32[6]",name:"userPublicKey",type:"bytes32[6]"}],name:"createGuildWithPeople",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"uint256",name:"guildId",type:"uint256"}],name:"leaveGuild",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"uint256",name:"guildId",type:"uint256"}],name:"userChoseDefaultGuild",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}],this.contractAddress="0x1775E7d49D41b01c2D5811ED51ee2d22c9706f86"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"deviceName",type:"bytes32"},{indexed:!0,internalType:"uint32",name:"ccNumber",type:"uint32"},{indexed:!0,internalType:"bytes32",name:"parameterName",type:"bytes32"},{indexed:!1,internalType:"address",name:"user",type:"address"}],name:"MidiCCParameter",type:"event"},{inputs:[{internalType:"bytes32",name:"deviceName",type:"bytes32"},{internalType:"uint32",name:"ccNumber",type:"uint32"},{internalType:"bytes32",name:"parameterName",type:"bytes32"}],name:"newMidiCCParameter",outputs:[],stateMutability:"nonpayable",type:"function"}],this.contractAddress="0x9c2607b1f1444AC1349aE79Bffa4000965d6936E"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"versionNumber",type:"uint256"},{indexed:!1,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!1,internalType:"string",name:"metadataURI",type:"string"}],name:"NewPluginVersion",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"creator",type:"address"},{indexed:!1,internalType:"string",name:"name",type:"string"}],name:"PluginCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"activeTokens",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"pluginURI",type:"string"},{internalType:"string",name:"pluginMetadata",type:"string"},{internalType:"bytes32",name:"pluginContentHash",type:"bytes32"},{internalType:"uint8[3]",name:"profitSplit",type:"uint8[3]"}],name:"createPlugin",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getProfitSplit",outputs:[{components:[{internalType:"uint8",name:"creatorShare",type:"uint8"},{internalType:"uint8",name:"ownerShare",type:"uint8"},{internalType:"uint8",name:"minterShare",type:"uint8"}],internalType:"struct ISplit.ProfitSplit",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"pluginTokens",outputs:[{internalType:"string",name:"name",type:"string"},{components:[{internalType:"uint8",name:"creatorShare",type:"uint8"},{internalType:"uint8",name:"ownerShare",type:"uint8"},{internalType:"uint8",name:"minterShare",type:"uint8"}],internalType:"struct ISplit.ProfitSplit",name:"profitSplit",type:"tuple"},{components:[{internalType:"uint256",name:"_value",type:"uint256"}],internalType:"struct Counters.Counter",name:"versionsCounter",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"tokenCreators",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenMetadataURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"pluginURI",type:"string"},{internalType:"string",name:"pluginMetadataURI",type:"string"},{internalType:"bytes32",name:"pluginContentHash",type:"bytes32"}],name:"updatePlugin",outputs:[],stateMutability:"nonpayable",type:"function"}],this.contractAddress="0x922005bb5715BD7a584b53b9B377Bf5d426723c9"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(15),a=n.n(r),i=n(1035),o=.75;function s(e,t,n){var r=(new Date).getTime(),s=e.getChannelData(0),u=s.length,l=1e3*u/a.a.context.sampleRate;if(u/a.a.context.sampleRate<o)return{onsets:[],tempo:0};for(var f=t.asm._initTempo(1024,256,a.a.context.sampleRate,n,-45),h=t._newBuffer(256),p=[],d=new Set,m=s.length/256-1,v=u/256-1,b=0;b<m;b++){var g=s.subarray(256*b,256*(b+1));t.HEAPF32.set(g,h>>2);var y=t.asm._processTempo(f,h),k=t.asm._getOnset(f);0===b&&(y=c(g)?1:0);var O=t.asm._getTempo(f);p.push(O),0!=y&&b<v&&k<.8*l&&d.add(k)}d=Array.from(d),t._destroyBuffer(h),t.asm._dispose(f);var j=Object(i.a)(p.filter(function(e){return 0!=e}))||0;j>180&&(j/=2);(new Date).getTime();return{tempo:j,onsets:d,onsetToPitch:{}}}function c(e){return Math.sqrt(e.reduce(function(e,t){return e+Math.pow(t,2)})/e.length)>.1}},function(e,t,n){"use strict";(function(e){var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(753),u=n(94),l=n(52),f=n(47),h=new c.a,p=n(229),d=function(){function e(t){Object(o.a)(this,e),this.web3=t,this.cachedUserNames={}}return Object(s.a)(e,[{key:"isUserNameAvailable",value:function(e){var t=this;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.getAccount();case 2:return n.sent,o=h.getContract(t.web3),n.prev=4,n.next=7,o.methods.isUserNameAvailable(e).call();case 7:s=n.sent,r(s),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(4),console.log(n.t0),i(n.t0);case 15:case"end":return n.stop()}},n,null,[[4,11]])}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getUserId",value:function(e){var t=this;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.getAccount();case 2:return n.sent,o=h.getContract(t.web3),n.prev=4,n.next=7,o.methods.getUserAddressFromName(e).call();case 7:s=n.sent,r(s),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(4),console.log(n.t0),i(n.t0);case 15:case"end":return n.stop()}},n,null,[[4,11]])}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"setUserName",value:function(e){var t=this;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=h.getContract(t.web3),n.t0=o.methods.setName(e),n.next=4,l.a.getAccount();case 4:n.t1=n.sent,n.t2={from:n.t1},n.t3=function(e,t){e?i(e):r()},n.t0.send.call(n.t0,n.t2,n.t3);case 8:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"setProfile",value:function(e){var t=this;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.getACCOUNT();case 2:return o=n.sent,n.next=5,f.a.addJson(e);case 5:s=m(s=n.sent),h.getContract(t.web3).methods.setProfileHash(s).send({from:o[0]},function(e,t){e?i(e):r()});case 9:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getUserName",value:function(e){var t=this;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s,c;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=u.a,!t.cachedUserNames[e]){n.next=4;break}return r(t.cachedUserNames[e]),n.abrupt("return");case 4:if(window.isNFT||!o.getItem("username:"+e)){n.next=7;break}return r(o.getItem("username:"+e)),n.abrupt("return");case 7:if(void 0!==e&&""!==e){n.next=11;break}return n.next=10,l.a.getAccount();case 10:e=n.sent;case 11:if(void 0!==e){n.next=14;break}return r(void 0),n.abrupt("return");case 14:if(!(e in t.cachedUserNames)){n.next=17;break}return r(t.cachedUserNames[e]),n.abrupt("return");case 17:return s=h.getContract(t.web3),n.prev=18,n.next=21,s.methods.getUserName(e).call();case 21:if(c=n.sent,o.setItem("username:"+e,c),""!==c){n.next=26;break}return r(void 0),n.abrupt("return");case 26:t.cachedUserNames[e]=c,r(c),n.next=33;break;case 30:n.prev=30,n.t0=n.catch(18),i(n.t0);case 33:case"end":return n.stop()}},n,null,[[18,30]])}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getProfile",value:function(e){var t=this;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s,c,u;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==e){n.next=8;break}return n.next=3,l.a.getAccount();case 3:if(void 0!==(o=n.sent)){n.next=7;break}return i("no ethereum"),n.abrupt("return");case 7:e=o;case 8:return s=h.getContract(t.web3),n.next=11,s.methods.getUserProfile(e).call();case 11:if(c=n.sent,n.prev=12,0!==t.web3.utils.hexToNumber(c)){n.next=16;break}return r("no profile"),n.abrupt("return");case 16:n.next=21;break;case 18:n.prev=18,n.t0=n.catch(12),console.log("had error while trying to get profile");case 21:return c=v(c),n.next=24,f.a.getJson(c);case 24:u=n.sent,r(u);case 26:case"end":return n.stop()}},n,null,[[12,18]])}));return function(e,t){return n.apply(this,arguments)}}())}}]),e}();function m(e){var t=p.decode(e).toString("hex").replace(/^1220/,"");return 64!=t.length?null:"0x"+t}function v(t){var n=new e(t.replace(/^0x/,"1220"),"hex");return p.encode(n)}t.a=d}).call(this,n(27).Buffer)},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(5),a=n.n(r),i=n(8),o=n(14),s=n(30),c=n(765),u=n(36),l=function(){var e=Object(o.a)(a.a.mark(function e(t,n){var r,o,l,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new c.a(s.a.crypto),0===n){e.next=19;break}return e.next=4,s.a.guilds.getGuildKey(n);case 4:o=e.sent,l=[],e.t0=a.a.keys(t);case 7:if((e.t1=e.t0()).done){e.next=16;break}return f=e.t1.value,e.t2=l,e.next=12,r.decryptQueryResult(t[f],o.privateKey);case 12:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=7;break;case 16:t=l,e.next=20;break;case 19:t=t.map(function(e){return Object(i.a)({},e,{title:u.a.utils.toAscii("0x"+e.encryptedName)})});case 20:return e.abrupt("return",t);case 21:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(8),o=n(14),s=n(2),c=n(4),u=n(352),l=function(){function e(t){Object(s.a)(this,e),this.crypto=t}return Object(c.a)(e,[{key:"decryptQueryResult",value:function(){var e=Object(o.a)(a.a.mark(function e(t,n){var r,o,s,c,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("query decryptor"),r=Object(u.b)(t.encryptedContentKey),e.next=4,this.crypto.decryptName(t.encryptedName,r,n);case 4:return o=e.sent,s=t.user,e.next=8,this.crypto.decryptContentKey(r,n);case 8:return c=e.sent,l=Object(i.a)({},t,{title:Object(u.b)(o),encryptedTitle:t.encryptedName,user:"0x"+Object(u.a)(s.slice(2)),contentKey:c?c.contentKey:void 0,publicKey:Object(u.b)(t.publicKey)}),e.abrupt("return",l);case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}();t.a=l},,,function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(61);n(719);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}t.a=function(e){return function(e){Object(o.a)(n,e);var t=l(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).cacheSize=8,e}return Object(i.a)(n,[{key:"initCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.cacheSize;this.cachedSteps=[];for(var t=0;t<e;t++){var n=new u.a(void 0,void 0,void 0,this.track);n.loadDefaults(),this.cachedSteps.push(n)}this.cacheIndex=0}},{key:"getStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transpose,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.durationParameter.get(),a=void 0;return!(arguments.length>3&&void 0!==arguments[3])||arguments[3]?(a=this.cachedSteps[this.cacheIndex],this.cacheIndex=(this.cacheIndex+1)%this.cachedSteps.length):a=new u.a(void 0,void 0,void 0,this.track),a.transpose=t,a.velocity=e.velocity,a.on=e.on,a.leafNumber=e.leafNumber,a.duration=n,e.voices&&(a.voices=Object(r.a)(e.voices)),a.attack=e.attack,a.delays=e.delays,e.track&&(a.track=e.track),(e.track?e.track.instrument:this.track.instrument)?a.release=null:a.release=e.release,a.start=e.start,a.hand=e.hand,a.isNewCycle=e.isNewCycle,a.chop=e.chop,a.pitchAttack=e.pitchAttack,a.pitchSustain=e.pitchSustain,a.pitchRelease=e.pitchRelease,a.pitchDecay=e.pitchDecay,a.slice=e.slice,a.reverse=e.reverse,a.panning=e.panning,a.selectedRecording=e.selectedRecording,a.palette=e.palette,a.auxEventA=e.auxEventA,a.auxEventB=e.auxEventB,a.auxEventC=e.auxEventC,a.auxEventD=e.auxEventD,a}}]),n}(e)}},function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(2),a=n(4),i=n(20),o=n(16),s=n(7),c=n(10),u=n(1),l=n(770),f=n(21);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(e){Object(s.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Flush",e)).flushParameter=new f.a("flush",Object(i.a)(a),function(){return 0},{defaultValue:4,min:0,max:64}),a.registerParameter(a.flushParameter),a.newInlet("to flush"),a.newInlet("control flush"),a.newOutlet("send messages"),a}return Object(a.a)(n,[{key:"dispose",value:function(){Object(o.a)(Object(u.a)(n.prototype),"dispose",this).call(this),this.disposeMessaging()}},{key:"flush",get:function(){return this.flushParameter.get()}},{key:"processMessages",value:function(){var e=this,t=this.queuedMessages["control flush"];t&&t.length>=this.flush&&(this.queuedMessages["to flush"].forEach(function(t){return e.sendMessage("send messages",t)}),this.clearMessages())}}]),n}(l.a)},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(102),l=n(85);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var h=function(e){Object(o.a)(n,e);var t=f(n);function n(e,a){var i;return Object(r.a)(this,n),(i=t.call(this,e,a)).queuedMessages={},i}return Object(a.a)(n,[{key:"newInlet",value:function(e){var t=this;Object(i.a)(Object(c.a)(n.prototype),"newInlet",this).call(this,e,function(n){return t.onMessage(e,n)})}},{key:"onMessage",value:function(e,t){this.queuedMessages[e]||(this.queuedMessages[e]=[]),this.queuedMessages[e].push(t),this.processMessages()}},{key:"processMessages",value:function(){this.clearMessages()}},{key:"getInletByNumber",value:function(e){var t=0;for(var n in this.inlets)if(t++===e)return n}},{key:"clearMessages",value:function(){for(var e in this.queuedMessages)this.queuedMessages[e].length=0}}]),n}(Object(u.a)(l.a))},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(770),l=n(21);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var h=function(e){Object(o.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Message",e)).newInlet(1),a.newOutlet("output"),a.messageTextParameter=new l.a("messageText",Object(i.a)(a),function(){return 0},{defaultValue:""}),a.registerParameter(a.messageTextParameter),a._messageText=void 0,a}return Object(a.a)(n,[{key:"messageText",get:function(){return this.messageTextParameter.get()},set:function(e){this.messageTextParameter.set(e,!1)}},{key:"processMessages",value:function(){for(var e in this.queuedMessages){var t=this.queuedMessages[e][0],n=this.messageText.replaceAll("$"+e,t[0]);this.sendMessage("output",n),this._messageText=n}this.clearMessages()}},{key:"execute",value:function(){this.sendMessage("output",this._messageText||this.messageText)}}]),n}(u.a)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(85),u=n(95),l=n(102);n(101),n(21),n(15);function f(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Note Display",e)).notes={},a.timeOn={},a.durations={},a.velocities={},a.newOutlet("notes on"),a.newOutlet("note durations"),a}return Object(a.a)(n,[{key:"removeNote",value:function(e,t){arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gated;delete this.notes[e]}},{key:"output",value:function(e){for(var t in this.notes)this.notes[t]--,this.notes[t]<=0&&delete this.notes[t];var n,r=f(this.triggers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.stepData){var i=a.stepData,o=i.transpose,s=i.duration,c=i.velocity;this.notes[o]=2*s,this.durations[o]=s,this.velocities[o]=c,this.timeOn[o]=e}}}catch(b){r.e(b)}finally{r.f()}this.sendMessage("notes on",Object.keys(this.notes));var l=new Array(12).fill(0);for(var h in this.notes){var p=Object(u.a)(parseInt(h),12);l[p]=this.notes[h];var d=this.durations[h],m=this.velocities[h];l[p]=3*m*this.notes[h]/d;var v=this.timeOn[h];Math.pow(e-v,3)<l[p]&&(l[p]=Math.pow(e-v,3))}return this.sendMessage("note durations",l),this.triggers}},{key:"stop",value:function(){this.notes={}}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(Object(l.a)(c.a));t.a=d},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(85),h=n(312),p=n(21),d=(n(6),n(195)),m=n(276),v=n(102);function b(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var k=function(e){Object(c.a)(n,e);var t=y(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Accumulator",e)).storedAccumulator=0,r.accumulatorValueParameter=new p.a("accumulatorValue",Object(o.a)(r),function(e,t){return t},{documentation:"Adds this value to the accumulator on each trigger",min:-64,max:64,unit:"",defaultValue:1}),r.registerParameter(r.accumulatorValueParameter),r.limitParameter=new p.a("limit",Object(o.a)(r),function(e,t){return t},{documentation:"Accumulates until limit before resettig",min:-64,max:64,unit:"",defaultValue:64}),r.registerParameter(r.limitParameter),r.syncedParameter=new p.a("synced",Object(o.a)(r),function(e,t){return t},{documentation:"Takes the trigger parameter and adds it to the accumulator value",min:0,max:1,defaultValue:null}),r.registerParameter(r.syncedParameter),r.setupRampParameters(),r.modeParameter=new p.a("mode",Object(o.a)(r),function(e,t){return t},{documentation:"How accumulator should act once it reaches the limit",min:0,max:1,defaultValue:d.b}),r.registerParameter(r.modeParameter),r.directionFactor=1,r.setupNodeMessaging(),r}return Object(i.a)(n,[{key:"getVisualizedParameters",value:function(){return[this.accumulatorValueParameter]}},{key:"getText",value:function(){var e=this.accumulatorValue;return e>0?"+"+e:e}},{key:"clear",value:function(){this.directionFactor=1,this.storedAccumulator=0,this._clear()}},{key:"clearParameter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._parameters.indexOf(e);this.directionFactor=1,this.storedAccumulator=0,this._clearParameter(e,t)}},{key:"accumulatorValue",get:function(){return this.accumulatorValueParameter.get()}},{key:"mode",get:function(){return this.modeParameter.get()}},{key:"limit",get:function(){return this.limitParameter.get()}},{key:"output",value:function(e,t){var n=Object(r.a)(this.triggers);if(!this.track.sequencerEngine.playing||this.shouldOutputSkip(e,t))return n;var a=this.triggers[0],i=this.accumulatorValue;this.syncedParameter.get()&&(i+=a.stepData[this.syncedParameter.get()]);return this.storedAccumulator=this.storedAccumulator+i*this.directionFactor,this.storedAccumulator>=this.limit?this.mode===d.b?this.storedAccumulator=this.storedAccumulator%this.limit:this.mode===d.c?(this.storedAccumulator=this.limit,this.directionFactor*=-1):this.mode===d.d&&(this.storedAccumulator=this.limit):Math.abs(this.storedAccumulator)>=this.limit?this.mode===d.b?this.storedAccumulator=(this.storedAccumulator%this.limit+this.limit)%this.limit:this.mode===d.c?(this.storedAccumulator=-1*this.limit,this.directionFactor*=-1):this.mode===d.d&&(this.storedAccumulator=this.accumulatorValue<0?-1*this.limit:this.limit):Math.abs(this.storedAccumulator)<Math.abs(this.accumulatorValue)&&-1===this.directionFactor&&this.mode===d.c&&(this.storedAccumulator=0,this.directionFactor*=-1),this.setParameterValues(e),this.triggers}},{key:"getParameterValueToSet",value:function(e){return this.initialParameterValues[e]+this.storedAccumulator*(this.getDepth(e)/100)}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"randomlyMapParameters",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,r=Object(s.a)(Object(l.a)(n.prototype),"randomlyMapParameters",this).call(this,t),a=-4,i=b(r);try{for(i.s();!(e=i.n()).done;){var o=e.value;o.max>=a&&(a=o.max)}}catch(p){i.e(p)}finally{i.f()}this.accumulatorValueParameter.set(Math.random()*a/10),this.limitParameter.set(a);var c,u=0,f=b(r);try{for(f.s();!(c=f.n()).done;){var h=100*c.value.max/a;h*=Math.random(),this.depthParameters[u].set(h),u++}}catch(p){f.e(p)}finally{f.f()}}}]),n}(Object(m.a)(Object(h.a)(Object(v.a)(f.a))));t.a=k},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(9),a=n(69);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(e,t,n){var o=e.context,s=e.name,c=(e.id,n?n.subSequences.flatMap(function(e){return e.tracks}):[]);if(o){if("BPM"===s)return n.bpmParameter;if(o.instrumentType!==a.f){if(void 0!==o.effect){var u,l=i(c);try{for(l.s();!(u=l.n()).done;){var f=u.value,h=[].concat(Object(r.a)(f.effects),Object(r.a)(f.midiEffects.effects),Object(r.a)(f.liveEffects.effects)).find(function(e){return e.name===o.effectName});if(h)return h.getParameters().find(function(e){return e.name===s})}}catch(O){l.e(O)}finally{l.f()}var p,d=i(t.sequencerEngine.subSequences);try{for(d.s();!(p=d.n()).done;){var m=p.value,v=[].concat(Object(r.a)(m.midiEffects.effects),[m.playhead]).find(function(e){return e.name===o.effectName});if(v)return v.getParameters().find(function(e){return e.name===s})}}catch(O){d.e(O)}finally{d.f()}}}else{var b=void 0;if(!(b=t&&t.instrument&&t.instrument.getInstrumentType()===a.f?t:c.find(function(e){return e.instrument&&e.instrument===a.f&&!e.isFrozens})))return;var g=b.instrument.getSubDevice(o.subDevice);if(g){var y=(g.getParameters?g.getParameters():g.parameters).find(function(e){return e.name===s});if(y&&y.context&&y.context.formant){var k=y.context.formant;k.enabledParameter.get()||k.enabledParameter.set(!0,!0,!0)}return y}}}}},function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(2),a=n(4),i=n(15),o=n.n(i),s=n(131),c=function(){function e(t,n,a,i){Object(r.a)(this,e),this.macro=i,this.parameter=t,this._min=n,this._max=a;var c=Math.abs(Math.min(this._min,this._max));if(this.scaler=new o.a.Scale(this._min+c,this._max+c),this.subtract=new o.a.Subtract(this._min<0||this._max<0?0:c),this.scaler.connect(this.subtract),this.parameter.audioParam)this.subtract.connect(this.parameter.audioParam);else if(this.parameter.audioParams)for(var u in this.parameter.audioParams){var l=this.parameter.audioParams[u].input||this.parameter.audioParams[u];Array.isArray(l)&&(l=l[0]),this.subtract.connect(l)}this.parameter.automationRate=s.a}return Object(a.a)(e,[{key:"withSignal",value:function(e){e.connect(this.scaler)}},{key:"dispose",value:function(){this._disposed||(this.scaler.disconnect(),this.scaler.dispose(),this.subtract.disconnect(),this.subtract.dispose(),this._disposed=!0)}},{key:"normalizeValue",value:function(e){return this.min+(this.max-this.min)*e}},{key:"updateRedux",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e=this.normalizeValue(e),t&&this.parameter.set(e,void 0,!0,void 0,!0),{id:this.parameter.id,value:e}}},{key:"min",get:function(){return this._min},set:function(e){this._min=e;var t=Math.abs(Math.min(this._min,this._max));this.scaler.min=e+t,this.scaler.max=this._max+t,this.subtract.value=this._min<0||this._max<0?0:t}},{key:"max",get:function(){return this._max},set:function(e){this._max=e;var t=Math.abs(Math.min(this._min,this._max));this.scaler.max=e+t,this.scaler.min=this._min+t,this.subtract.value=this._min<0||this._max<0?0:t}},{key:"getJson",value:function(){return{parameter:this.parameter.id,min:this.min,max:this.max}}}]),e}()},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}window.outputTimes=[],window.outputCounters=[],window.copyTimes=[],window.triggerInputs={},t.a=function(e){return function(e){Object(o.a)(n,e);var t=f(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"runFlow",value:function(e,t,n){var a=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.inputNode,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.triggers,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.adjacencyLists,c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];window.triggerInputs[e]=0;var l=[],f=[];f.push(i);for(var h=0,p=function(){var i=f.shift();h++;var p=(new Date).getTime(),d=i.output?i.output(e,t,n):Object(r.a)(o),m=(new Date).getTime();if(window.outputTimes.push({time:m-p,name:i.name}),void 0===s[i.id])return"continue";var v,b=u(s[i.id]);try{var g=function(){var t=v.value,n=t.effect,o=t.probability;if(t.triggerCount=0,Math.random()>=o/100)return"continue";if(n.input){var u=(new Date).getTime();d.filter(function(e){return void 0===e.outputNumber&&0===t.outputNumber||e.outputNumber===t.outputNumber}).forEach(function(r){t.triggerCount++,s[i.id].length>1&&(r=a.copyTrigger(r,c)),window.triggerInputs[e]++,n.input(r,void 0===r.time)});var h=(new Date).getTime();window.copyTimes.push(h-u)}else{var p=d.filter(function(e){return void 0===e.outputNumber&&0===t.outputNumber||e.outputNumber===t.outputNumber});t.triggerCountc+=p.length,l=[].concat(Object(r.a)(l),Object(r.a)(p))}n.parent=i,f.includes(n)||f.push(n)};for(b.s();!(v=b.n()).done;)g()}catch(y){b.e(y)}finally{b.f()}};f.length>0;)p();return window.outputCounters.push(h),l}}]),n}(e)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return MicroTuningEffect});var _Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(20),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(16),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(10),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1),_MidiEffect_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(85),utils_IsNumber_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(62),parameters_AbstractParameter_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(21);function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__.a)(e);if(t){var a=Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__.a)(this,n)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var MicroTuningEffect=function(_MidiEffect){Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__.a)(MicroTuningEffect,_MidiEffect);var _super=_createSuper(MicroTuningEffect);function MicroTuningEffect(e){var t;return Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__.a)(this,MicroTuningEffect),(t=_super.call(this,"Micro Tuning",e)).scriptParameter=new parameters_AbstractParameter_js__WEBPACK_IMPORTED_MODULE_10__.a("script",Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__.a)(t),function(e,n){return t.executeScript(n)},{defaultValue:"(x) => x"}),t.offsets={},t.algo=function(e){return e},t}return Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__.a)(MicroTuningEffect,[{key:"executeScript",value:function executeScript(script){var isTest=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var algo=eval(script);return!!Object(utils_IsNumber_js__WEBPACK_IMPORTED_MODULE_9__.a)(algo(5))&&(isTest||(this.algo=algo),!0)}catch(e){return!1}}},{key:"newNoteOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new parameters_AbstractParameter_js__WEBPACK_IMPORTED_MODULE_10__.a("noteOffset",this,function(){return[]},{defaultValue:t,min:-1,max:1});return this.registerParameter(n),this.context&&n.setContext(this.context),this.offsets[e]=n,n}},{key:"output",value:function(){for(var e in this.triggers){var t=this.triggers[e].stepData.duration,n=this.getTranspose(this.triggers[e].stepData.transpose),r=this.getStep(this.triggers[e].stepData,n,this.triggers[e].stepData.duration,!1);r.duration=null===t?void 0:t,this.triggers[e].stepData=r}return this.triggers}},{key:"getTranspose",value:function(e){var t=Math.round(e),n=t in this.offsets?this.offsets[t].get():0,r=this.algo(e)+n;return Math.max(Math.min(42,r),-42)}},{key:"getJson",value:function(e){var t={};for(var n in this.offsets)t[n]=this.offsets[n].get();return Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__.a)({},Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_4__.a)(Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__.a)(MicroTuningEffect.prototype),"getJson",this).call(this,e),{script:this.scriptParameter.get(),offsets:t})}},{key:"fromJson",value:function(e,t){for(var n in Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_4__.a)(Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__.a)(MicroTuningEffect.prototype),"fromJson",this).call(this,e,t),e.offsets)this.newNoteOffset(parseFloat(n),e.offsets[n]);this.scriptParameter.set(e.script)}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new MicroTuningEffect(e);return n.fromJson(this.getJson(),t),n}}]),MicroTuningEffect}(_MidiEffect_js__WEBPACK_IMPORTED_MODULE_8__.a)},function(e,t,n){"use strict";n.d(t,"a",function(){return v});var r=n(8),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(273),h=n(21);function p(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var v=function(e){Object(c.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).name="Linked Tidal",r.cycleFactorParameter=new h.a("cycleFactor",Object(o.a)(r),function(e,t){},{defaultValue:1,min:0,max:16,unit:""}),r.registerParameter(r.cycleFactorParameter),r.linkedEffect=void 0,r}return Object(i.a)(n,[{key:"cycle",get:function(){return this.linkedEffect?this.linkedEffect.cycle:this._cycle},set:function(e){this._cycle=e}},{key:"cycleFactor",get:function(){return this.cycleFactorParameter.get()}},{key:"cycleLength",get:function(){return this.linkedEffect?this.linkedEffect.cycleLength*this.cycleFactor:Object(s.a)(Object(l.a)(n.prototype),"cycleLength",this)}},{key:"var",value:function(e){return this.linkedEffect?this.linkedEffect.var(e):Object(s.a)(Object(l.a)(n.prototype),"var",this).call(this,e)}},{key:"durationFactor",get:function(){return this.linkedEffect?this.linkedEffect.durationFactor:Object(s.a)(Object(l.a)(n.prototype),"durationFactor",this)}},{key:"lengthFactor",get:function(){return this.linkedEffect?this.linkedEffect.lengthFactor:Object(s.a)(Object(l.a)(n.prototype),"lengthFactor",this)}},{key:"replaceOperandVariables",value:function(e){return this.linkedEffect?this.linkedEffect.replaceOperandVariables(e):Object(s.a)(Object(l.a)(n.prototype),"replaceOperandVariables",this).call(this,e)}},{key:"getJson",value:function(){return Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{linkedEffect:this.linkedEffect.id})}},{key:"fromJson",value:function(e){var t=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e),r=e.linkedEffect;return r&&(this.lostParameters=this.loadParameters([r])),t}},{key:"loadParameters",value:function(e){var t,n=e[0],r=p(this.track.sequencerEngine.tracks);try{for(r.s();!(t=r.n()).done;){var a=t.value.midiEffects.effects.find(function(e){return e.id===n});if(a)return void(this.linkedEffect=a)}}catch(i){r.e(i)}finally{r.f()}return[n]}}]),n}(f.a)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(85),l=n(21);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var h=function(e){Object(o.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Limit",e)).limitParameter=new l.a("limit",Object(i.a)(a),function(e,t){return t},{documentation:"The maximum number of notes that can be triggered on a given step.",min:0,max:16,unit:"",defaultValue:1}),a.registerParameter(a.limitParameter),a}return Object(a.a)(n,[{key:"getVisualizedParameters",value:function(){return[this.limitParameter]}},{key:"getText",value:function(){return this.limitParameter.get()}},{key:"documentation",get:function(){return"Limits the number of notes that can be triggered on a given step."}},{key:"limit",get:function(){return this.limitParameter.get()}},{key:"output",value:function(){return this.triggers.slice(0,this.limit)}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(u.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(85),l=n(21);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var h=function(e){Object(o.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Midi CC",e)).deviceNameParameter=new l.a("deviceName",Object(i.a)(a),function(e,t){return[]},{defaultValue:null,unit:"",automatable:!1}),a.registerParameter(a.deviceNameParameter),a.midiCCNumberParameter=new l.b("midiCCNumber",Object(i.a)(a),function(e,t){return[]},{documentation:"The Midi CC number that will be sent on each trigger.",defaultValue:0,min:0,max:119,unit:""}),a.registerParameter(a.midiCCNumberParameter),a.midiCCValueParameter=new l.b("midiCCValueParameter",Object(i.a)(a),function(e,t){return[]},{documentation:"The value that will be sent to a given Midi CC on a each trigger",defaultValue:0,min:0,max:128,unit:""}),a.registerParameter(a.midiCCValueParameter),a}return Object(a.a)(n,[{key:"documentation",get:function(){return"Sends a MIDI CC message on each trigger, with the CC number and value being configurable."}},{key:"output",value:function(){for(var e in this.triggers){if(void 0==this.midiCC)break;this.midiCC.send(this.midiCCNumber,this.midiCCValue)}return this.triggers}},{key:"midiCCNumber",get:function(){return this.midiCCNumberParameter.get()}},{key:"midiCCValue",get:function(){return this.midiCCValueParameter.get()}},{key:"midiCC",get:function(){return this.midi.deviceToMidiCC[this.deviceName]}},{key:"deviceName",get:function(){return this.deviceNameParameter.get()}},{key:"midi",get:function(){return this.track.sequencerEngine.midi}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(u.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=n(17);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Steps",e)).newVar("fromStep",0,0,64),a.newVar("toStep",16,0,64),a.clear(),a}return Object(a.a)(n,[{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){this.myScript=Object(u.a)(Object(l.N)(this.var("fromStep"),this.var("toStep")))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(17),l=n(115);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Notes",e)).newVar("fromNote",0,-32,32),a.newVar("toNote",16,-32,32),a.clear(),a}return Object(a.a)(n,[{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){this.myScript=Object(l.a)(Object(u.B)(this.var("fromNote"),this.var("toNote")))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.track,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=(n(17),n(187));function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Beat Repeat",e)).newVar("repeats",1,0,16),a.newVar("rate",2,0,16),a.clear(),a}return Object(a.a)(n,[{key:"documentation",get:function(){return["Repeats any triggers"]}},{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){this.myScript=Object(u.a)(Object(l.e)(this.var("repeats"),this.var("rate")))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=n(17);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Grab",e)).newTrackVar("trackNumber",null,0,64),a.newParamVar("fromParam","",0,64),a.newParamVar("toParam","",0,64),a.newCheckboxVar("add",!1),a.clear(),a}return Object(a.a)(n,[{key:"documentation",get:function(){return["Sets a parameter for this track to a value grabbed from a different track.","If there are no triggers at a given step, then the original value will play."]}},{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){this.myScript=Object(u.a)(Object(l.y)(this.var("trackNumber"),this.var("fromParam"),this.var("toParam"),this.var("add")))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.track,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=n(17);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Grab Time",e)).newTrackVar("trackNumber",null,0,64),a.clear(),a}return Object(a.a)(n,[{key:"documentation",get:function(){return["Sets a parameter for this track to a value grabbed from a different track.","If there are no triggers at a given step, then the original value will play."]}},{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){this.myScript=Object(u.a)(Object(l.z)(this.var("trackNumber")))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.track,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=n(17),f=n(187);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Beat",e)).newVar("step",0,0,32),a.newVar("steps",16,0,64),a.numberOfOutputs=2,a.clear(),a}return Object(a.a)(n,[{key:"documentation",get:function(){return["Sends triggers to output 1 on a specific step of the beat.","All other triggers go to output 2."]}},{key:"getVisualizedParameters",value:function(){return[this.stepParameter,this.stepsParameter]}},{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){this.myScript=Object(u.a)(Object(f.a)(this.var("step"),this.var("steps"),Object(l.O)(0),Object(l.O)(1)))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=(n(172),n(17),n(788));function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Threshold",e)).clear(),a.newVar("threshold",4,1,64),a.newVar("time",4,1,64),a.numberOfOutputs=2,a}return Object(a.a)(n,[{key:"documentation",get:function(){return["Switches the output of the effect once a threshold of triggers is reached and remains switched until an amount of time has passed."]}},{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){this.myScript=Object(u.a)(Object(l.a)(function(e){return e.velocity},this.var("threshold"),this.var("time")))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(17),a=function(e,t,n){var a=0,i=!1,o=0;return function(s,c,u){return void 0===s?Object(r.w)(!1):(i||(a+=e(s,c,u))>=Object(r.A)(t)&&(a=0,i=!0,o=0),i?(++o>=Object(r.A)(n)&&(i=!1),Object(r.O)(1)):Object(r.O)(0))}}},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(17);function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var o,s=n[3],c="",u=a(t);try{for(u.s();!(o=u.n()).done;){var l=o.value,f=r.A.apply(void 0,[l].concat(n));if(f)try{c+="string"===typeof l?l+" ":JSON.stringify(f)+" "}catch(h){}}}catch(p){u.e(p)}finally{u.f()}return""!==c&&s.logs.push(c),Object(r.w)(!0)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(9),a=n(17),i=n(72);Object(i.a)("sparse",{sparseness:"how dense the output should be (0-1)"},"Controls density of triggers by filtering out triggers. sparseness: 0-1 ");var o=function(e,t){var n=void 0,i={},o=void 0,s=function(e){(function(e){var t=0===e&&o!==e;return o=e,t})(e)&&(n=i,i={},0),i[e]||(i[e]=0),i[e]++};return function(){for(var t=arguments.length,o=new Array(t),c=0;c<t;c++)o[c]=arguments[c];var u=o[0],l=o[1],f=(o[2],o[3]),h=a.A.apply(void 0,[e].concat(o));if(l=function(e,t){if(function(e){return void 0!==e.track.envelopesTrack}(t)){var n=t.track,a=Math.max.apply(Math,Object(r.a)(n.tracks.map(function(e){return e.pattern.length()})));return n.sequencerEngine.trackStep%a}return e}(l,f),f.track.sequencerEngine.isLooping)return Object(a.w)(!0);if(!u)return Object(a.w)(!1);if(s(l),1===h||u.slide)return Object(a.w)(!0);var p=function(e,t){var n={};for(var r in e)n[r]=e[r]*t;var a=0;for(var i in n){var o=a+n[i];n[i]=Math.floor(o),a=o-Math.floor(o)}return n}(n||i,h);return i[l]>p[l]?Object(a.w)(!1):(0,Object(a.w)(!0))}}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(17),a=n(72);Object(a.a)("poly",{args:"Arguments to be evaluated"},"Splits a chord among the arguments passed. poly(switchOutput(0), switchOutput(1)) will send half the notes in a chord to output 0 and the others to output 1");var i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=void 0,i=void 0;return function(e,n,o){return i!==n&&(a=-1),a++,i=n,Object(r.A)(t[a%t.length],e,n,o)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(15),a=n.n(r),i=function(e){return 69+12*Math.log2(e/a.a.Frequency.A4)-60}},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(85),h=n(15),p=n.n(h),d=n(312),m=n(276),v=n(21),b=(n(6),n(195),n(102));function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var y=function(e){Object(c.a)(n,e);var t=g(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Control Parameters",e)).setupRampParameters(),r.counter=-1,r.listParameter=new v.a("list",Object(o.a)(r),function(){return[]},{defaultValue:[0],min:0,max:1}),r.registerParameter(r.listParameter),r.setupNodeMessaging(),r.newInlet("list",function(e){return r.onListMessage(e)}),r.newOutlet("value"),r}return Object(i.a)(n,[{key:"onListMessage",value:function(e){this.listParameter.set(e[0])}},{key:"getText",value:function(){return""}},{key:"valueList",get:function(){return this.listParameter.get()},set:function(e){this.listParameter.set(Object(r.a)(e))}},{key:"stop",value:function(){Object(s.a)(Object(l.a)(n.prototype),"stop",this).call(this),this.counter=-1}},{key:"clear",value:function(){Object(s.a)(Object(l.a)(n.prototype),"clear",this).call(this),this.counter=-1}},{key:"output",value:function(e,t){var n=this;if(!this.track.sequencerEngine.playing)return this.triggers;if(0===t&&this.resetAtZero&&0!==this.counter&&(this.stop(),this._clear()),0===this.triggers.length)return this.triggers;this.counter++;var r=this.valueList[this.counter%this.valueList.length];return setTimeout(function(){n.sendMessage("value",r)},1e3*(e-p.a.Master.context.currentTime)),this.setParameterValues(e),this.triggers}},{key:"getParameterValueToSet",value:function(e){var t=this.valueList[this.counter%this.valueList.length];return this.initialParameterValues[e]+t*(this.getDepth(e)/100)}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(Object(m.a)(Object(d.a)(Object(b.a)(f.a))));t.a=y},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(16),s=n(7),c=n(10),u=n(1),l=n(85),f=n(312),h=n(276),p=n(21),d=(n(6),n(393)),m=n(102);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var b=function(e){Object(s.a)(n,e);var t=v(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Conditional Parameters",e)).setupRampParameters(),a.conditionalTypeParameter=new p.a("conditionalType",Object(i.a)(a),function(){return[]},{defaultValue:d.a}),a.registerParameter(a.conditionalTypeParameter),a.conditionalValueParameter=new p.a("conditionalValue",Object(i.a)(a),function(){return[]},{defaultValue:0}),a.registerParameter(a.conditionalValueParameter),a.thenValueParameter=new p.a("thenValue",Object(i.a)(a),function(){return[]},{defaultValue:0}),a.registerParameter(a.thenValueParameter),a.parametersDisabledParameter.set([0]),a.setupNodeMessaging(),a}return Object(a.a)(n,[{key:"conditionalType",get:function(){return this.conditionalTypeParameter.get(!0)}},{key:"conditionalValue",get:function(){return this.conditionalValueParameter.get(!0)}},{key:"thenValue",get:function(){return this.thenValueParameter.get(!0)}},{key:"fromParameter",get:function(){return this._parameters[0]}},{key:"getText",value:function(){return""}},{key:"stop",value:function(){Object(o.a)(Object(u.a)(n.prototype),"stop",this).call(this)}},{key:"clear",value:function(){Object(o.a)(Object(u.a)(n.prototype),"clear",this).call(this)}},{key:"output",value:function(e,t){return this.track.sequencerEngine.playing?(0===t&&this.resetAtZero&&0!==this.counter&&(this.stop(),this._clear()),0===this.triggers.length?this.triggers:(this.setParameterValues(e),this.triggers)):this.triggers}},{key:"getParameterValueToSet",value:function(e){return this.isConditionMet()?this.thenValue:this.initialParameterValues[e]}},{key:"isConditionMet",value:function(){if(!this.fromParameter)return!1;var e=this.fromParameter.getNumber();switch(this.conditionalType){case d.c:return e<=this.conditionalValue;case d.b:return e>=this.conditionalValue;default:return e===this.conditionalValue}}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"shouldSkipParameter",value:function(e){return 0===parseInt(e)}}]),n}(Object(h.a)(Object(f.a)(Object(m.a)(l.a))));t.a=b},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return e*(Math.PI/180)}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var u=new(n(29).a);t.a=function(e){return function(e){Object(i.a)(n,e);var t=c(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).color="#ffffff",e}return Object(a.a)(n,[{key:"initColor",value:function(){this.color=u.getColorForHash(this.id)}}]),n}(e)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return ScaleEffect});var _Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(20),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(16),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(10),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1),_MidiEffect_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(85),tone__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(15),tone__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(tone__WEBPACK_IMPORTED_MODULE_9__),utils_IsNumber_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(62),parameters_AbstractParameter_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(21),parameters_parameterJsonFunctions_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(23),_utils_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(792),_scales_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(1496);function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__.a)(e);if(t){var a=Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__.a)(this,n)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DEFAULT_NOTE=tone__WEBPACK_IMPORTED_MODULE_9___default.a.Frequency("C4"),ScaleEffect=function(_MidiEffect){Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__.a)(ScaleEffect,_MidiEffect);var _super=_createSuper(ScaleEffect);function ScaleEffect(e){var t;return Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__.a)(this,ScaleEffect),(t=_super.call(this,"Scale",e)).scaleParameter=new parameters_AbstractParameter_js__WEBPACK_IMPORTED_MODULE_11__.a("scale",Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__.a)(t),function(e,t){return[]},{defaultValue:_scales_js__WEBPACK_IMPORTED_MODULE_14__.a}),t.registerParameter(t.scaleParameter),t.referencePitchParameter=new parameters_AbstractParameter_js__WEBPACK_IMPORTED_MODULE_11__.a("referencePitch",Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__.a)(t),function(e,t){return[]},{defaultValue:195.99771799087463}),t.registerParameter(t.referencePitchParameter),t.subsetParameter=new parameters_AbstractParameter_js__WEBPACK_IMPORTED_MODULE_11__.a("subset",Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__.a)(t),function(e,t){return[]},{defaultValue:[!0,!0,!0,!0,!0,!0,!0]}),t.registerParameter(t.subsetParameter),t}return Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__.a)(ScaleEffect,[{key:"documentation",get:function(){return["Forces the notes to a scale. The scale can be defined using ratios where 1 is the base note, and 2 is the octave.","Can drag and drop a scala file with custom micro-tunings."]}},{key:"subset",get:function(){return this.subsetParameter.get()},set:function(e){this.subsetParameter.set(e)}},{key:"scale",get:function(){return this.scaleParameter.get()},set:function(e){var t=[];for(var n in e)t[n]=!0;this.subset=t,this.scaleParameter.set(e)}},{key:"referencePitch",get:function(){return tone__WEBPACK_IMPORTED_MODULE_9___default.a.Frequency(this.referencePitchParameter.get())}},{key:"output",value:function(){for(var e in this.triggers)if(this.triggers[e].stepData){var t=this.triggers[e].stepData.duration,n=this.getTranspose(this.triggers[e].stepData.transpose),r=this.getStep(this.triggers[e].stepData,n,this.triggers[e].stepData.duration,!0);r.duration=null===t?void 0:t,this.triggers[e].stepData=r}return this.triggers}},{key:"getTranspose",value:function getTranspose(t){var _this2=this,scale=this.scale.filter(function(e,t){return _this2.subset[t]}),octave=Math.floor(t/12),offset=t<0?(12-Math.abs(t)%12)%12:t%12,scaleNote=scale[Math.floor(scale.length*offset/12)];try{scaleNote=eval(scaleNote)}catch(e){return t}var octavedNote=this.referencePitch.transpose(12*octave)._val,transpose=Object(_utils_js__WEBPACK_IMPORTED_MODULE_13__.a)(octavedNote*scaleNote);return transpose}},{key:"getJson",value:function(){var e=Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__.a)({},Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_4__.a)(Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__.a)(ScaleEffect.prototype),"getJson",this).call(this),{annotation:this.annotation});return e=this.saveParameterToJson(e,"scaleParameter",this.scaleParameter),e=this.saveParameterToJson(e,"subsetParameter",this.subsetParameter)}},{key:"fromJson",value:function(e,t){Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_4__.a)(Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__.a)(ScaleEffect.prototype),"fromJson",this).call(this,e,t),this.scale=e.scale,e.subset&&(this.subset=e.subset),this.loadParameterFromJson(e,"scaleParameter",this.scaleParameter),this.loadParameterFromJson(e,"subsetParameter",this.subsetParameter),this.annotation=e.annotation}},{key:"getCopy",value:function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var t=new ScaleEffect(e);return t.fromJson(this.getJson(),!0),t}}]),ScaleEffect}(_MidiEffect_js__WEBPACK_IMPORTED_MODULE_8__.a)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=n(17);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Pattern Switch",e)).newVar("patternNumber",0,0,16),a.clear(),a}return Object(a.a)(n,[{key:"documentation",get:function(){return["Switches the pattern when a trigger is received."]}},{key:"getVisualizedParameters",value:function(){return[this.patternNumberParameter]}},{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){this.myScript=Object(u.a)(Object(l.E)(this.var("patternNumber")))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=(n(72),n(115)),l=n(17),f=n(791);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Poly",e)).newVar("outputs",2,1,8,"Number of outputs to split notes among."),a.clear(),a}return Object(a.a)(n,[{key:"documentation",get:function(){return["Splits any polyphony chords among the outputs of this effect."]}},{key:"numberOfOutputs",get:function(){if(this.outputsParameter){var e=Math.floor(this.var("outputs")());return isNaN(e)?2:e}return 2},set:function(e){}},{key:"getVisualizedParameters",value:function(){return[this.outputsParameter]}},{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){for(var e=[],t=0;t<this.numberOfOutputs;t++)e.push(Object(l.O)(t));this.myScript=Object(u.a)(f.a.apply(void 0,e))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=(n(172),n(615)),f=n(255),h=n(17);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Density",e)).clear(),a.newVar("limit",4,1,32),a.newVar("windowSize",4,1,32),a.numberOfOutputs=2,a}return Object(a.a)(n,[{key:"isRealTime",value:function(){return!1}},{key:"documentation",get:function(){return["Sends triggers to output 2 when the number of triggers of the last few steps exceeds a certain threshold.","All other triggers go to output 1."]}},{key:"clear",value:function(){this.myScript=Object(u.a)(Object(h.q)(Object(f.c)(this.var("limit"),Object(l.a)(this.var("windowSize"))),Object(h.O)(1),Object(h.O)(0)))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=d},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=(n(172),n(17));function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Roll",e)).clear(),a.numberOfOutputs=2,a}return Object(a.a)(n,[{key:"documentation",get:function(){return["Sends triggers to output 1 when the sequence is rolling.","All other triggers go to output 2."]}},{key:"isRealTime",value:function(){return!1}},{key:"clear",value:function(){this.myScript=Object(u.a)(Object(l.q)(Object(l.I)(),Object(l.O)(0),Object(l.O)(1)))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=n(187);n(17);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Midi Gate",e)).clear(),a.numberOfOutputs=2,a.newVar("steps",new Array(16).fill(1),0,65536),a}return Object(a.a)(n,[{key:"clear",value:function(){this.myScript=Object(u.a)(Object(l.d)(this.var("steps")))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=n(790);n(17);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Sparse",e)).clear(),a.numberOfOutputs=2,a.system5Objects=[],a.newVar("density",1,0,1,void 0,void 0,function(e){return a.system5Objects.forEach(function(e){return e.sendDensities()})}),a}return Object(a.a)(n,[{key:"clear",value:function(){this.myScript=Object(u.a)(Object(l.a)(this.var("density")))}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=h},function(e,t,n){"use strict";n.d(t,"a",function(){return v});var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(21),l=n(805),f=n(316),h=n(45),p=n(102),d=n(117);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var v=function(e){Object(o.a)(n,e);var t=m(n);function n(e,a){var i;return Object(r.a)(this,n),(i=t.call(this)).subSequence=e,i.zObject=a,i.sequencerEngine=e.sequencerEngine,i.id=Object(h.uuid)(),i.setupShiftParameters(),i}return Object(a.a)(n,[{key:"getConnectedTidal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.zObject&&this.zObject.outlets;return Object(i.a)(Object(c.a)(n.prototype),"getConnectedTidal",this).call(this,e,"params",t)}},{key:"setupShiftParameters",value:function(){var e=this;this.seedParameter=new u.b("seed",this,function(e){return[]},{defaultValue:1,min:1,max:64e3}),this.registerParameter(this.seedParameted),this.shift1Parameter=this.newShiftParameter(1),this.shift2Parameter=this.newShiftParameter(2),this.shift3Parameter=this.newShiftParameter(3),this.shift4Parameter=this.newShiftParameter(4),this.shift5Parameter=this.newShiftParameter(5),this.shift6Parameter=this.newShiftParameter(6),this.hand1Parameter=this.newHandParameter(1),this.hand2Parameter=this.newHandParameter(2),this.hand3Parameter=this.newHandParameter(3),this.hand4Parameter=this.newHandParameter(4),this.hand5Parameter=this.newHandParameter(5),this.hand6Parameter=this.newHandParameter(6),this.scale1Parameter=this.newScaleParameter(1),this.scale2Parameter=this.newScaleParameter(2),this.scale3Parameter=this.newScaleParameter(3),this.scale4Parameter=this.newScaleParameter(4),this.scale5Parameter=this.newScaleParameter(5),this.scale6Parameter=this.newScaleParameter(6),this.truncate1Parameter=this.newTruncateParameter(1),this.truncate2Parameter=this.newTruncateParameter(2),this.truncate3Parameter=this.newTruncateParameter(3),this.truncate4Parameter=this.newTruncateParameter(4),this.truncate5Parameter=this.newTruncateParameter(5),this.truncate6Parameter=this.newTruncateParameter(6),this.tempo1Parameter=this.newTempoParameter(1),this.tempo2Parameter=this.newTempoParameter(2),this.tempo3Parameter=this.newTempoParameter(3),this.tempo4Parameter=this.newTempoParameter(4),this.tempo5Parameter=this.newTempoParameter(5),this.tempo6Parameter=this.newTempoParameter(6),this.rule1Parameter=this.newRuleParameter(1),this.rule2Parameter=this.newRuleParameter(2),this.rule3Parameter=this.newRuleParameter(3),this.rule4Parameter=this.newRuleParameter(4),this.rule5Parameter=this.newRuleParameter(5),this.rule6Parameter=this.newRuleParameter(6),this.swing1Parameter=this.newSwingParameter(1),this.swing2Parameter=this.newSwingParameter(2),this.swing3Parameter=this.newSwingParameter(3),this.swing4Parameter=this.newSwingParameter(4),this.swing5Parameter=this.newSwingParameter(5),this.swing6Parameter=this.newSwingParameter(6),this.offset1Parameter=this.newOffsetParameter(1),this.offset2Parameter=this.newOffsetParameter(2),this.offset3Parameter=this.newOffsetParameter(3),this.offset4Parameter=this.newOffsetParameter(4),this.offset5Parameter=this.newOffsetParameter(5),this.offset6Parameter=this.newOffsetParameter(6),this.triplet1Parameter=this.newTripletParameter(1),this.triplet2Parameter=this.newTripletParameter(2),this.triplet3Parameter=this.newTripletParameter(3),this.triplet4Parameter=this.newTripletParameter(4),this.triplet5Parameter=this.newTripletParameter(5),this.triplet6Parameter=this.newTripletParameter(6),this.newInlet("shift",function(t){return e.onMsg("shift",t)}),this.newInlet("truncate",function(t){return e.onMsg("truncate",t)}),this.newInlet("tempo",function(t){return e.onMsg("tempo",t)}),this.newInlet("hand",function(t){return e.onMsg("hand",t)}),this.newInlet("swing",function(t){return e.onMsg("swing",t)}),this.newInlet("offset",function(t){return e.onMsg("offset",t)})}},{key:"onMsg",value:function(e,t){var n=this,r=[1,2,3,4,5,6].map(function(t){return n[e+t+"Parameter"]});t=t[0],Array.isArray(t)?r.forEach(function(e,n){return e.set(t[n%t.length])}):r.forEach(function(e){return e.set(t)})}},{key:"newRuleParameter",value:function(e){var t=new u.b("rule"+e,this,function(){return 0},{defaultValue:null,min:0,max:12});return this.registerParameter(t),t}},{key:"newShiftParameter",value:function(e){var t=new u.b("shift"+e,this,function(){return 0},{defaultValue:0,min:0,max:16});return this.registerParameter(t),t}},{key:"newScaleParameter",value:function(e){var t=new u.a("scale"+e,this,function(){return 0},{defaultValue:!1});return this.registerParameter(t),t}},{key:"newHandParameter",value:function(e){var t=new u.b("hand"+e,this,function(){return 0},{defaultValue:d.a,min:0,max:3});return this.registerParameter(t),t}},{key:"newTruncateParameter",value:function(e){var t=new u.b("truncate"+e,this,function(){return 0},{defaultValue:0,min:0,max:5});return this.registerParameter(t),t}},{key:"newTempoParameter",value:function(e){var t=new u.b("tempo"+e,this,function(){return 0},{defaultValue:2,min:1,max:5});return this.registerParameter(t),t}},{key:"newSwingParameter",value:function(e){var t=new u.b("swing"+e,this,function(){return 0},{defaultValue:50,min:50,max:100});return this.registerParameter(t),t}},{key:"newOffsetParameter",value:function(e){var t=new u.b("offset"+e,this,function(){return 0},{defaultValue:0,min:0,max:100});return this.registerParameter(t),t}},{key:"newTripletParameter",value:function(e){var t=new u.a("triplet"+e,this,function(){return 0},{defaultValue:!1});return this.registerParameter(t),t}}]),n}(Object(l.a)(Object(p.a)(Object(f.a)(function(){return function e(){Object(r.a)(this,e)}}()))))},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}t.a=function(e){return function(e){Object(i.a)(n,e);var t=c(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).cachedTidal={},e}return Object(a.a)(n,[{key:"getConnectedTidal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.outlets;if(this.cachedTidal[e])return this.cachedTidal[e];var r=this.searchForNode("jaki",t,n);return r&&(this.cachedTidal[e]=r.effect.tidals[e]),this.cachedTidal[e]}}]),n}(e)}},function(e,t,n){"use strict";n.d(t,"a",function(){return w});var r=n(8),a=n(9),i=n(11),o=n(2),s=n(4),c=n(20),u=n(7),l=n(10),f=n(1),h=n(316),p=n(117),d=n(45),m=n(82),v=n(257),b=n(394),g=n(102);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var k=Object(v.a)(Object(m.f)(". -")),O=Object(v.a)(Object(m.f)(". . -")),j=Object(v.a)(Object(m.f)(". . . -")),w=function(e){Object(u.a)(n,e);var t=y(n);function n(e,r){var a;return Object(o.a)(this,n),(a=t.call(this)).subSequence=e,a.zObject=r,a.sequencerEngine=e.sequencerEngine,a.id=Object(d.uuid)(),a.figures=[new b.a(k,Object(c.a)(a)),new b.a(O,Object(c.a)(a)),new b.a(j,Object(c.a)(a)),new b.a(O,Object(c.a)(a))],a.newInlet("swap",function(e){return a.onSwap(e)}),a.onFiguresChanged(),a}return Object(s.a)(n,[{key:"onSwap",value:function(e){var t=Object(i.a)(e[0],2),n=t[0],r=t[1];if(console.log("on swap = ",n,r),n%=this.figures.length,r%=this.figures.length,!isNaN(n)&&!isNaN(r)){var a=this.figures[n];this.figures[n]=this.figures[r],this.figures[r]=a,console.log("swapping",this.figures[n],this.figures[r]),this.onFiguresChanged()}}},{key:"updateFigure",value:function(e,t){for(var n=-1,r=0;r<this.figures.length;r++)if(e===this.figures[r]){n=r;break}return t=Object(v.a)(Object(m.f)(t)),this.figures[n].updateFigure(t),this.figures=Object(a.a)(this.figures),this.onFiguresChanged(),this.figures[n]}},{key:"onFiguresChanged",value:function(){var e=this;if(this.figures){this._figures=this.figures.map(function(e){return e.figure});for(var t=function(t){var n=e.getFigureInletName(t);e.inlets[n]||e.newInlet(n,function(){return e.onFigureTypeChange(t)})},n=0;n<this._figures.length;n++)t(n)}}},{key:"onFigureTypeChange",value:function(e){var t=this.figures[e];if(t){var n=p.b[t.figureLength],r=(t.figureType+1)%n.length;t.figureTypeParameter.set(r)}}},{key:"newFigure",value:function(){this.figures=[].concat(Object(a.a)(this.figures),[new b.a(k,this)]),this.onFiguresChanged()}},{key:"getFigureInletName",value:function(e){return"figure-type-"+(e+1)}},{key:"deleteFigure",value:function(e){this.figures.indexOf(e);this.deleteInlet(this.getFigureInletName(e)),this.figures=this.figures.filter(function(t){return t!==e}),this.onFiguresChanged()}},{key:"fromJson",value:function(e){var t=e.figures,n=e.id,a={};if(this.id=n,!t)return a;for(var i=0;i<t.length;i++){var o=t[i];"string"===typeof o?(this.figures[i]=new b.a(Object(v.a)(Object(m.f)(o)),this),this.updateFigure(this.figures[i],o)):(this.figures[i]||this.newFigure(),a=Object(r.a)({},a,this.figures[i].fromJson(o)))}return this.figures=this.figures.slice(0,t.length),this.onFiguresChanged(),a}},{key:"getJson",value:function(){return{id:this.id,figures:this.figures.map(function(e){return e.getJson()})}}}]),n}(Object(g.a)(Object(h.a)(function(){return function e(){Object(o.a)(this,e)}}())))},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(20),u=n(16),l=n(7),f=n(10),h=n(1),p=n(56),d=n(147),m=(n(32),n(15)),v=n.n(m),b=n(21);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var y=function(e){Object(l.a)(n,e);var t=g(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Soft Clipper",function(){return new v.a.Gain(1)},e,!0)).outputNode=new v.a.Gain(1),r.amountParameter=new b.a("Amount",Object(c.a)(r),function(e,t){return r.softClipper?r.softClipper.parameters.get("amount").value=t:r.effectNode.gain.value=t},{documentation:"Controls the amount of soft clipping",min:0,max:8,defaultValue:1}),r.registerParameter(r.amountParameter),r.loadedValue=1,r.initializeWorklets(),r.updateInitialValues(),r}return Object(s.a)(n,[{key:"connect",value:function(e){this.outputNode.connect(e)}},{key:"disconnect",value:function(e){this.outputNode.disconnect(e)}},{key:"initializeWorklets",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.isMobile&&!this.sequencerEngine.isOffline){e.next=4;break}this.effectNode.connect(this.outputNode),e.next=10;break;case 4:return e.next=6,this.sequencerEngine.initAudioWorklets();case 6:this.softClipper=new AudioWorkletNode(v.a.Master.context._context,"soft-clipper-node"),this.amountParameter.set(this.loadedValue,!1,!1),this.effectNode.connect(this.softClipper),this.softClipper.connect(this.outputNode);case 10:this.updateInitialValues();case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"documented",get:function(){return"Reduces the volume of loud sounds or amplifies quiet sounds."}},{key:"getJson",value:function(e){var t=Object(u.a)(Object(h.a)(n.prototype),"getJson",this).call(this);return t.amount=this.amountParameter.get(),t}},{key:"fromJson",value:function(e,t){var r=Object(u.a)(Object(h.a)(n.prototype),"fromJson",this).call(this,e,t);if(e.amount){this.loadedValue=e.amount;var a=this.amountParameter.set(e.amount,!1,!1),i=a.id,o=a.value;r[i]=o}return r}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(p.a.Effect);t.a=y},function(e,t,n){"use strict";n.d(t,"a",function(){return k});var r=n(8),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(56),h=n(179),p=n(32),d=n(41),m=n(57),v=n(15),b=n.n(v),g=n(882);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var k=function(e){Object(c.a)(n,e);var t=y(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Multi Filter",function(){return new b.a.Gain(1)},e)).context=(new m.a).forEffect(Object(o.a)(r)),r.preset=new h.a,r.setupFormants(),r.track={sequencerEngine:e},r.crossFade=new b.a.CrossFade(1),r.wetParameter=new d.c("Wet",r.crossFade.fade,{documentation:"Controls the amount of (wet) effected signal, vs. dry (un-effected) signal.",defaultValue:.5,min:0,max:1}),r.registerParameter(r.wetParameter),r.gainParameter=new d.c("Output Gain",r.formantsManager.output.gain,{defaultValue:1,min:0,max:4}),r.registerParameter(r.gainParameter),r.effectNode.connect(r.formantsManager.input),r.outputNode=new b.a.Gain(1),r.effectNode.connect(r.crossFade,0,0),r.formantsManager.output.connect(r.crossFade,0,1),r.crossFade.connect(r.outputNode),r}return Object(i.a)(n,[{key:"getJson",value:function(){for(var e,t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];var o=Object(r.a)({},(e=Object(s.a)(Object(l.a)(n.prototype),"getJson",this)).call.apply(e,[this].concat(a)),{gain:this.gainParameter.get(!0),multiFilter:this.getFormantsJson()});return o=this.saveParameterToJson(o,"gainParameter",this.gainParameter)}},{key:"fromJson",value:function(e,t){var a=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t);return"gain"in e&&Object(p.a)(this.gainParameter,e.gain,a),Object(r.a)({},a,this.loadFormantsJson(e.multiFilter,t),this.loadParameterFromJson(e,"gainParameter",this.gainParameter,t))}},{key:"connect",value:function(e){this.outputNode.connect(e)}},{key:"disconnect",value:function(){this.outputNode.disconnect()}}]),n}(Object(g.a)(f.a.Effect))},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(32),h=n(15),p=n.n(h),d=n(56),m=n(41),v=n(21),b=n(325);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var y=function(e){Object(c.a)(n,e);var t=g(n);function n(e){var r;Object(a.a)(this,n),r=t.call(this,"Ring Modulator",function(){return new p.a.Gain(.5)},e);var i=p.a.Master.context;return r.dryIn=r.effectNode,r.wetIn=new p.a.Gain(.5),r.dryIn.connect(r.wetIn),r.cross=new p.a.CrossFade(.5),r.dryIn.connect(r.cross,0,0),r.outGain=new p.a.Gain(1),r.outGain.connect(r.cross,0,1),r.wetParameter=new m.c("Wet",r.cross.fade,{documentation:"Controls the amount of (wet) effected signal, vs. dry (un-effected) signal.",defaultValue:.5,min:0,max:1}),r.registerParameter(r.wetParameter),r.cross.connect(r.outGain),r.vInGain=new p.a.Gain(.5),r.vIn=i.createOscillator(),r.vIn.frequency.value=30,r.vIn.start(0),r.vInInverter1=new p.a.Gain(-1),r.vInInverter2=new p.a.Gain(-1),r.vInInverter3=new p.a.Gain(-1),r.vInDiode1=new b.a(e),r.vInDiode2=new b.a(e),r.vcInverter1=i.createGain(),r.vcInverter1.gain.value=-1,r.vcDiode3=new b.a(e),r.vcDiode4=new b.a(e),r.compressor=new p.a.Compressor(-12,3),r.vIn.connect(r.vInGain),r.wetIn.connect(r.vcInverter1),r.wetIn.connect(r.vcDiode4.effectNode),r.vcInverter1.connect(r.vcDiode3.effectNode),r.vInGain.connect(r.vInInverter1),r.vInGain.connect(r.vcInverter1),r.vInGain.connect(r.vcDiode4.effectNode),r.vInInverter1.connect(r.vInInverter2),r.vInInverter1.connect(r.vInDiode2.effectNode),r.vInInverter2.connect(r.vInDiode1.effectNode),r.vInDiode1.connect(r.vInInverter3),r.vInDiode2.connect(r.vInInverter3),r.vInInverter3.connect(r.compressor),r.vcDiode3.connect(r.compressor),r.vcDiode4.connect(r.compressor),r.compressor.connect(r.outGain),r.frequencyParameter=new m.c("Frequency",r.vIn.frequency,{min:1,max:3e3,unit:"",defaultValue:30}),r.registerParameter(r.frequencyParameter),r.distortionParameter=new v.a("distortion",Object(o.a)(r),function(e,t){r.vInDiode1.distortionParameter.set(t),r.vInDiode2.distortionParameter.set(t),r.vcDiode3.distortionParameter.set(t),r.vcDiode4.distortionParameter.set(t)},{documention:"Controls the level of saturation.",min:2,max:10,unit:"",defaultValue:.3,constantAutomationRate:!0}),r.registerParameter(r.distortionParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"connect",value:function(e){this.cross.connect(e)}},{key:"disconnect",value:function(e){this.cross.disconnect()}},{key:"getJson",value:function(e){var t=Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this);return t.frequency=this.frequencyParameter.get(),t.distortion=this.distortionParameter.get(),t=this.saveParameterToJson(t,"frequencyParameter",this.frequencyParameter,e),t=this.saveParameterToJson(t,"distortionParameter",this.distortionParameter,e)}},{key:"fromJson",value:function(e,t){var a=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(f.a)(this.frequencyParameter,e.frequency,a),Object(f.a)(this.distortionParameter,e.distortion,a),Object(r.a)({},a,this.loadParameterFromJson(e,"frequencyParameter",this.frequencyParameter,t),this.loadParameterFromJson(e,"distortionParameter",this.distortionParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(d.a.Effect);t.a=y},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(56),l=n(15),f=n.n(l);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var p=1024,d=function(e){Object(o.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Oscilloscope",function(){return new f.a.Analyser({type:"waveform",size:p})},e)).size=p,a.newOutlet("Waveform Data"),a.newInlet("Start",function(){return a.onStart()}),a}return Object(a.a)(n,[{key:"dispose",value:function(){this.interval&&clearInterval(this.interval),Object(i.a)(Object(c.a)(n.prototype),"dispose",this).call(this)}},{key:"onStart",value:function(){var e=this;this.interval=setInterval(function(){e.sendMessage("Waveform Data",e.getValue())},64)}},{key:"getValue",value:function(){return this.effectNode.getValue()}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine;!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new n(e)}}]),n}(u.a.Effect);t.a=d},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(56),f=n(32),h=n(15),p=n.n(h),d=n(530),m=n(293),v=n(41);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var g=function(e){Object(s.a)(n,e);var t=b(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Tape Delay",function(){return new p.a.Gain(1)},e)).initComponents(),r.rateParameter=new v.c("Rate",r.delayNode.delayTime,{documentation:"The amount of time (in seconds) between echos.",defaultValue:.6,min:0,max:1},.07),r.registerParameter(r.rateParameter),r.feedbackParameter=new v.c("Feedback",r.feedbackNode.gain,{documentation:["The amount of delayed signal that is fed back into the effect","Be careful, past 50%-- depending on the saturation-- it can get unruly."],defaultValue:.1,min:0,max:1}),r.registerParameter(r.feedbackParameter),r.wetParameter=new v.c("Wet",r.crossFade.fade,{documentation:"Controls the amount of (wet) effected signal, vs. dry (un-effected) signal.",defaultValue:.5,min:0,max:1}),r.registerParameter(r.wetParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"documentation",get:function(){return"Emulates a tape echo effect, where the signal is fed back into the effect, and saturated."}},{key:"driveParameter",get:function(){return this.saturatorNode&&this.saturatorNode.driveParameter}},{key:"lowEQParameter",get:function(){return this.eqNode&&this.eqNode.equalizerPoints[0].gainParameter}},{key:"midEQParameter",get:function(){return this.eqNode&&this.eqNode.equalizerPoints[4].gainParameter}},{key:"highEQParameter",get:function(){return this.eqNode&&this.eqNode.equalizerPoints[7].gainParameter}},{key:"initComponents",value:function(){this.inputNode=this.effectNode,this.crossFade=new p.a.CrossFade(.5),this.feedbackNode=new p.a.Gain(.35),this.saturatorNode=new d.a(this.sequencerEngine),this.saturatorNode.driveParameter.set(.95),this.registerParameter(this.driveParameter),this.delayNode=new p.a.FeedbackDelay(.1,.1),this.eqNode=new m.a(this.sequencerEngine,!1),this.eqNode.equalizerPoints[0].frequencyParameter.set(300),this.eqNode.equalizerPoints[4].qParameter.set(.7),this.eqNode.equalizerPoints[7].frequencyParameter.set(4e3),this.registerParameter(this.lowEQParameter),this.registerParameter(this.midEQParameter),this.registerParameter(this.highEQParameter),this.delayNode.wet.value=1,this.inputNode.connect(this.saturatorNode.effectNode),this.saturatorNode.connect(this.eqNode.effectNode),this.eqNode.connect(this.delayNode),this.inputNode.connect(this.crossFade,0,0),this.delayNode.connect(this.crossFade,0,1),this.delayNode.connect(this.feedbackNode),this.feedbackNode.connect(this.saturatorNode.effectNode),this.outputNode=new p.a.Gain(1),this.crossFade.connect(this.outputNode)}},{key:"connect",value:function(e){this.outputNode.connect(e)}},{key:"disconnect",value:function(e){this.outputNode.disconnect(e)}},{key:"dispose",value:function(){Object(o.a)(Object(u.a)(n.prototype),"dispose",this).call(this),this.delayNode.dispose(),this.eqNode.dispose(),this.saturatorNode.dispose(),this.feedbackNode.dispose(),this.crossFade.dispose(),this.outputNode.dispose(),this.rateParameter=void 0,this.wetParameter=void 0,this.track=void 0,this.inputNode=void 0,this.feedbackParameter=void 0,this.delayNode=void 0,this.eqNode=void 0,this.saturatorNode=void 0,this.feedbackNode=void 0,this.crossFadeNode=void 0,this.outputNode=void 0,this.parameters=void 0,this.rateParameter=void 0,this.feedbackParameter=void 0,this.wetParameter=void 0,this.sequencerEngine=void 0}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"getJson",value:function(){var e=Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{lowEQ:this.lowEQParameter.get(!0),midEQ:this.midEQParameter.get(!0),drive:this.driveParameter.get(!0),highEQ:this.highEQParameter.get(!0),feedback:this.feedbackParameter.get(!0),wet:this.wetParameter.get(!0),rate:this.rateParameter.get(!0)});return e=this.saveParameterToJson(e,"driveParameter",this.driveParameter),e=this.saveParameterToJson(e,"lowEQParameter",this.lowEQParameter),e=this.saveParameterToJson(e,"midEQParameter",this.midEQParameter),e=this.saveParameterToJson(e,"highEQParameter",this.highEQParameter),e=this.saveParameterToJson(e,"feedbackParameter",this.feedbackParameter),e=this.saveParameterToJson(e,"rateParameter",this.rateParameter),e=this.saveParameterToJson(e,"wetParameter",this.wetParameter)}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(f.a)(this.lowEQParameter,e.lowEQ,a),Object(f.a)(this.midEQParameter,e.midEQ,a),Object(f.a)(this.highEQParameter,e.highEQ,a),Object(f.a)(this.feedbackParameter,e.feedback,a),Object(f.a)(this.wetParameter,e.wet,a),Object(f.a)(this.rateParameter,e.rate,a),e.drive&&Object(f.a)(this.driveParameter,e.drive,a),Object(r.a)({},a,this.loadParameterFromJson(e,"lowEQParameter",this.lowEQParameter,t),this.loadParameterFromJson(e,"driveParameter",this.driveParameter,t),this.loadParameterFromJson(e,"midEQParameter",this.midEQParameter,t),this.loadParameterFromJson(e,"highEQParameter",this.highEQParameter,t),this.loadParameterFromJson(e,"feedbackParameter",this.feedbackParameter,t),this.loadParameterFromJson(e,"rateParameter",this.rateParameter,t),this.loadParameterFromJson(e,"wetParameter",this.wetParameter,t))}}]),n}(l.a.Effect);t.a=g},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(56),h=n(15),p=n.n(h),d=n(21),m=(n(41),n(212),n(232));function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var b=function(e){Object(c.a)(n,e);var t=v(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Stereo Delay",function(){return new p.a.Gain(1)},e)).initComponents(),r.isSynced=!0,r.wetParameter=new d.a("Wet",Object(o.a)(r),function(e,t){r.leftDelay.wetParameter.set(t),r.rightDelay.wetParameter.set(t)},{min:0,max:1,unit:"",defaultValue:0,constantAutomationRate:!0}),r.registerParameter(r.wetParameter),r.feedbackParameter=new d.a("Feedback",Object(o.a)(r),function(e,t){r.leftDelay.feedbackParameter.set(t),r.rightDelay.feedbackParameter.set(t)},{min:0,max:1,unit:"",defaultValue:0,constantAutomationRate:!0}),r.registerParameter(r.feedbackParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"connect",value:function(e){this.outputNode.connect(e)}},{key:"disconnect",value:function(e){this.outputNode.disconnect(e)}},{key:"initComponents",value:function(){this.leftDelay=new m.a(this.sequencerEngine),this.rightDelay=new m.a(this.sequencerEngine),this.effectNode.connect(this.leftDelay.effectNode),this.effectNode.connect(this.rightDelay.effectNode),this.merger=new p.a.Merge,this.leftDelay.connect(this.merger.left),this.rightDelay.connect(this.merger.right),this.outputNode=new p.a.Gain(1),this.merger.connect(this.outputNode)}},{key:"getJson",value:function(){var e=Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{leftDelay:this.leftDelay.getJson(),rightDelay:this.rightDelay.getJson(),wet:this.wetParameter.get(),feedback:this.feedbackParameter.get(),isSynced:this.isSynced});return e=this.saveParameterToJson(e,"wetParameter",this.wetParameter),e=this.saveParameterToJson(e,"feedbackParameter",this.feedbackParameter)}},{key:"fromJson",value:function(e,t){Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t),this.isSynced=e.isSynced,this.wetParameter.set(e.wet),this.feedbackParameter.set(e.feedback),this.leftDelay.fromJson(e.leftDelay),this.rightDelay.fromJson(e.rightDelay),this.loadParameterFromJson(e,"feedbackParameter",this.feedbackParameter,t),this.loadParameterFromJson(e,"wetParameter",this.wetParameter,t)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(f.a.Effect);t.a=b},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(8),s=n(2),c=n(4),u=n(16),l=n(7),f=n(10),h=n(1),p=n(292),d=n(15),m=n.n(d),v=n(56);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var g="QmQjRkKxSgAYtuepTdHp8inhYp8QYc18KUL5fYSprqKAEt",y=function(e){Object(l.a)(n,e);var t=b(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,"Guitar Amp",function(){return new m.a.Gain(1)},e)).convolver=r||new p.a(e),r||a.convolver.setConvolverSample(g),a.convolver.wetParameter.set(1),a.effectNode.connect(a.convolver.effectNode),a.updateInitialValues(),a}return Object(c.a)(n,[{key:"dispose",value:function(){Object(u.a)(Object(h.a)(n.prototype),"dispose",this).call(this),this.convolver.dispose()}},{key:"disconnect",value:function(e){this.convolver.disconnect(e)}},{key:"connect",value:function(e){this.convolver.connect(e)}},{key:"getJson",value:function(){return Object(o.a)({},Object(u.a)(Object(h.a)(n.prototype),"getJson",this).call(this),{convolver:this.convolver.getJson()})}},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t,r){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(u.a)(Object(h.a)(n.prototype),"fromJson",this).call(this,t,r),e.next=3,this.convolver.fromJson(t.convolver,r);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];console.log("get effect copy guitar amp");var r=new n(e,this.convolver.getEffectCopy(e,t));return t||(r.id=this.id),r}}]),n}(v.a.Effect);t.a=y},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(56),h=n(32),p=n(15),d=n.n(p),m=n(21),v=n(41);n(212);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}new Float32Array(65536);var g=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Wave Folder",function(){return new d.a.Gain(1)},e)).crossFade=new d.a.CrossFade(0),r.wetParameter=new v.c("Wet",r.crossFade.fade,{documentation:"Controls the amount of (wet) effected signal, vs. dry (un-effected) signal.",defaultValue:.5,min:0,max:1}),r.registerParameter(r.wetParameter),r.counter=0,r.waveShaperNode=new d.a.WaveShaper([-1,1]),r.effectNode.connect(r.waveShaperNode),r.postGain=new d.a.Gain(1),r.waveShaperNode.connect(r.postGain),r.effectNode.connect(r.crossFade,0,0),r.postGain.connect(r.crossFade,0,1),r.overSampleParameter=new m.a("oversample",Object(o.a)(r),function(e,t){return r.waveShaperNode.oversample=t?"4x":"none"},{min:.01,max:32,unit:"",defaultValue:!1,constantAutomationRate:!0}),r.driveParameter=new v.a("drive",r.effectNode.gain,function(e,t){r.effectNode.gain.value=t,r.postGain.gain.value=Math.pow(1/t,.6)},{documention:"Controls the level of saturation.",min:.01,max:32,unit:"",defaultValue:1,constantAutomationRate:!0}),r.registerParameter(r.driveParameter),r.stagesParameter=new m.a("stages",Object(o.a)(r),function(e,t){r.recomputeCurve()},{documention:"Controls the level of saturation.",min:2,max:10,unit:"",defaultValue:4,constantAutomationRate:!0,automatable:!1}),r.registerParameter(r.stagesParameter),r.smoothnessParameter=new m.a("smoothness",Object(o.a)(r),function(e,t){r.recomputeCurve()},{documention:"Controls the level of saturation.",min:1,max:32,unit:"",defaultValue:6,constantAutomationRate:!0,automatable:!1}),r.registerParameter(r.smoothnessParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"stages",get:function(){return this.stagesParameter?this.stagesParameter.get():4}},{key:"smoothness",get:function(){return this.smoothnessParameter?this.smoothnessParameter.get():6}},{key:"recomputeCurve",value:function(){var e=this,t=++this.counter;setTimeout(function(){if(t===e.counter){for(var n=Math.pow(2,e.smoothness+1)*(2*e.stages+1)+1,r=new Float32Array(n),a=0;a<n;a++){var i=(2*e.stages+1)*Math.PI*(a/(n-1)-.5);r[a]=Math.sin(i)}e.waveShaperNode.curve=r}},100)}},{key:"documentation",get:function(){return"Saturates the sound, making it more distorted."}},{key:"dispose",value:function(){Object(s.a)(Object(l.a)(n.prototype),"dispose",this).call(this),this.postGain.dispose(),this.waveShaperNode.dispose()}},{key:"connect",value:function(e){this.crossFade.connect(e)}},{key:"disconnect",value:function(e){this.crossFade.disconnect(e)}},{key:"getJson",value:function(){var e=Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{oversample:this.overSampleParameter.get(),smoothness:this.smoothnessParameter.get(),stages:this.stagesParameter.get(),drive:this.driveParameter.get()});return e=this.saveParameterToJson(e,"oversampleParameter",this.overSampleParameter),e=this.saveParameterToJson(e,"driveParameter",this.driveParameter),e=this.saveParameterToJson(e,"smoothnessParameter",this.smoothnessParameter),e=this.saveParameterToJson(e,"stagesParameter",this.stagesParameter)}},{key:"fromJson",value:function(e,t){var a=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(h.a)(this.driveParameter,e.drive,a),Object(h.a)(this.overSampleParameter,e.overSample,a),Object(h.a)(this.smoothnessParameter,e.smoothness,a),Object(h.a)(this.stagesParameter,e.stages,a),Object(r.a)({},a,this.loadParameterFromJson(e,"driveParameter",this.driveParameter,t),this.loadParameterFromJson(e,"overSampleParameter",this.overSampleParameter,t),this.loadParameterFromJson(e,"smoothnessParameter",this.smoothnessParameter,t),this.loadParameterFromJson(e,"stagesParameter",this.stagesParameter,t))}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(f.a.Effect);t.a=g},function(e,t,n){"use strict";n.d(t,"a",function(){return j});var r=n(8),a=n(9),i=n(2),o=n(4),s=n(16),c=n(7),u=n(10),l=n(1),f=n(56),h=n(132),p=n(32),d=n(15),m=n.n(d),v=(n(41),n(622));function b(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var k=10,O=[90,250,400,1250,1950,2350,2750,5500,6900,8600],j=function(e){Object(c.a)(n,e);var t=y(n);function n(e){var r;Object(i.a)(this,n),(r=t.call(this,"Vocoder",function(){return new m.a.Gain(4)},e)).components=[],r.outGain=new m.a.Gain(16);for(var o=0;o<k;o++){var s=O[o],c=new m.a.Filter(s,"bandpass"),u=new m.a.Filter(s,"bandpass"),l=new m.a.Gain(1);c.Q.value=50,u.Q.value=50;var f=new m.a.Follower(.01);c.chain(f,l.gain),r.effectNode.chain(l,u,r.outGain),r.components.push({filterIn:c,filterOut:u,follower:f})}return r.setupTrackParameter(),r.qParameter=new h.a("q",[].concat(Object(a.a)(r.components.map(function(e){return e.filterIn.Q})),Object(a.a)(r.components.map(function(e){return e.filterOut.Q}))),{defaultValue:50,min:.1,max:100}),r.registerParameter(r.qParameter),r.roughnessParameter=new h.a("roughness",r.components.map(function(e){return e.follower._filter.frequency}),{defaultValue:20,min:.1,max:100}),r.registerParameter(r.roughnessParameter),r.frequencyParameter=new h.a("frequency",[].concat(Object(a.a)(r.components.map(function(e){return e.filterIn.frequency})),Object(a.a)(r.components.map(function(e){return e.filterOut.frequency}))),{defaultValue:0,min:0,max:4e3}),r.registerParameter(r.frequencyParameter),r.components.forEach(function(e,t){var n=e.filterIn,r=e.filterOut;n.frequency.value=O[t],r.frequency.value=O[t]}),r.updateInitialValues(),r}return Object(o.a)(n,[{key:"dispose",value:function(){Object(s.a)(Object(l.a)(n.prototype),"dispose",this).call(this),this.components.forEach(function(e){var t=e.filterIn,n=e.filterOut,r=e.follower;t.dispose(),n.dispose(),r.dispose()}),this.outGain.dispose()}},{key:"connect",value:function(e){this.outGain.connect(e)}},{key:"disconnect",value:function(e){this.outGain.disconnect()}},{key:"onChangeTrack",value:function(e){-1!==e?(e=this.sequencerEngine.tracks[e],this._track&&this.disconnectFromTrack(this._track),this.connectToTrack(e),Object(s.a)(Object(l.a)(n.prototype),"onChangeTrack",this).call(this,e)):this._track=void 0}},{key:"disconnectFromTrack",value:function(e){var t,n=b(this.components);try{for(n.s();!(t=n.n()).done;){var r=t.value.filterIn;e.trackNode.disconnect(r)}}catch(a){n.e(a)}finally{n.f()}}},{key:"connectToTrack",value:function(e){var t,n=b(this.components);try{for(n.s();!(t=n.n()).done;){var r=t.value.filterIn;e.trackNode.connect(r)}}catch(a){n.e(a)}finally{n.f()}}},{key:"getJson",value:function(e){var t=Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this,e),{q:this.qParameter.get(!0),roughness:this.roughnessParameter.get(!0),frequency:this.frequencyParameter.get(!0),track:this.trackParameter.get(!0)});return t=this.saveParameterToJson(t,"frequencyParameter",this.frequencyParameter),t=this.saveParameterToJson(t,"qParameter",this.qParameter),t=this.saveParameterToJson(t,"roughnessParameter",this.roughnessParameter)}},{key:"fromJson",value:function(e,t){var a=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(p.a)(this.qParameter,e.q,a),Object(p.a)(this.roughnessParameter,e.roughness,a),Object(p.a)(this.frequencyParameter,e.frequency,a),Object(p.a)(this.trackParameter,e.track,a),Object(r.a)({},a,this.loadParameterFromJson(e,"frequencyParameter",this.frequencyParameter),this.loadParameterFromJson(e,"qParameter",this.qParameter),this.loadParameterFromJson(e,"roughnessParameter",this.roughnessParameter))}},{key:"getEffectCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new n(e).fromJson(this.getJson(),t),!0}}]),n}(Object(v.a)(f.a.Effect))},function(e,t,n){"use strict";n.d(t,"a",function(){return b});var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(56),f=n(32),h=n(15),p=n.n(h),d=n(41),m=n(622);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var b=function(e){Object(s.a)(n,e);var t=v(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Follower",function(){return new p.a.Gain(1)},e)).follower=new p.a.Follower,r.follower.connect(r.effectNode.gain),r.roughnessParameter=new d.c("roughness",r.follower._filter.frequency,{defaultValue:10,min:.1,max:100}),r.setupTrackParameter(),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"onChangeTrack",value:function(e){-1!==e?(e=this.sequencerEngine.tracks[e],this._track&&this._track.volumeNode.disconect(this.follower),e.volumeNode.connect(this.follower),Object(o.a)(Object(u.a)(n.prototype),"onChangeTrack",this).call(this,e)):this._track=void 0}},{key:"getJson",value:function(e){var t=Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this,e),{roughness:this.roughnessParameter.get(!0),track:this.trackParameter.get(!0)});return t=this.saveParameterToJson(t,"roughnessParameter",this.roughnessParameter)}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(f.a)(this.roughnessParameter,e.roughness,a),Object(f.a)(this.trackParameter,e.track,a),Object(r.a)({},a,this.loadParameterFromJson(e,"roughnessParameter",this.roughnessParameter))}},{key:"getEffectCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new n(e).fromJson(this.getJson(),t),!0}}]),n}(Object(m.a)(l.a.Effect))},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(20),s=n(16),c=n(7),u=n(10),l=n(1),f=n(56),h=n(325),p=n(32),d=n(15),m=n.n(d),v=n(41),b=n(21),g=n(132);function y(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var j=function(e){Object(c.a)(n,e);var t=O(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Frequency Shifter",function(){return new m.a.Gain(.5)},e))._numBanks=4,r.outputNode=new m.a.Merge(1),r.wetIn=new m.a.Gain(.5),r.delaySpread=new m.a.Signal(0),r.effectNode.connect(r.wetIn),r.vInGains=[],r.delays=[[],[]],r.createGraph(),r.delaySpreadParameter=new v.c("delaySpread",r.delaySpread,{defaultValue:0,min:0,max:1,automationRate:"A_RATE"},.07),r.registerParameter(r.delaySpreadParameter),r.frequencyParameter=new g.a("frequency",[r.sineA.frequency,r.sineB.frequency],{defaultValue:30,min:1,max:1e4}),r.registerParameter(r.frequencyParameter),r.delayDirectionParameter=new b.a("delayDirection",Object(o.a)(r),function(e,t){return e.setDelayDirection(t)},{defaultValue:!0}),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"createGraph",value:function(){this.sineA=new m.a.Oscillator(0,"sine"),this.sineA.phase=0,this.sineB=new m.a.Oscillator(0,"sine"),this.sineB.phase=90,this.sineA.start(0),this.sineB.start(0),this.createHilbertTransformer()}},{key:"ring",value:function(e,t,n){var r=new m.a.Compressor(-12,3),a=new m.a.Gain(.5);this.vInGains.push(a);var i=new m.a.Gain(-1),o=new m.a.Gain(-1),s=new m.a.Gain(-1),c=new m.a.Gain(-1),u=new h.a(this.sequencerEngine).effectNode,l=new h.a(this.sequencerEngine).effectNode,f=new h.a(this.sequencerEngine).effectNode,p=new h.a(this.sequencerEngine).effectNode;return e.connect(a),a.connect(i),i.connect(o),i.connect(l),o.connect(u),u.connect(s),l.connect(s),s.connect(r),a.connect(p),a.connect(c),c.connect(f),f.connect(r),p.connect(r),t.connect(c),t.connect(p),{output:r,dispose:function(){a.dispose(),r.dispose(),u.dispose(),l.dispose(),f.dispose(),p.dispose(),i.dispose(),o.dispose(),s.dispose(),c.dispose()}}}},{key:"createHilbertTransformer",value:function(){var e=this,t=new m.a.Split;this.wetIn.connect(t);var n=this.ring(this.sineA,t.left),r=this.ring(this.sineB,t.left),a=this.ring(this.sineA,t.right,!0),i=this.ring(this.sineB,t.right,!0),o=[n.dispose,r.dispose,a.dispose,i.dispose,function(){return t.dispose()}];n=n.output,r=r.output,a=a.output,i=i.output;for(var s=0;s<2;s++)for(var c=50,u=function(t){var u=e.numBanks/8*((t+1)/4),l=e.delayDirection?e.numBanks-t:t,f=l/1e3,h=new m.a.Filter(c,"bandpass",-24);h.Q.value=u;var p=new m.a.Filter(c,"allpass");p.Q.value=u,c+=1e4/e.numBanks;var d=new m.a.Delay(f);d.delayTime.input.automationRate="A_RATE";var v=new m.a.Gain(l/e.numBanks);e.delaySpread.chain(v,d.delayTime),d.delayTime.value=f,0===s?(h.chain(p,d,e.outputNode.left),n.connect(h),r.connect(h)):(h.chain(p,d,e.outputNode.right),a.connect(h),i.connect(h)),e.delays[s].push({delay:d,delayBlunter:v}),o.push(function(){h.dispose(),p.dispose(),d.dispose(),v.dispose()})},l=0;l<this.numBanks;l++)u(l);this.disposeList=o}},{key:"numBanks",get:function(){return this._numBanks},set:function(e){console.log("setting numbank=",e),this._numBanks=e,this.disposeList&&(this.disposeList.forEach(function(e){return e()}),this.disposeList=void 0),this.vInGains=[],this.delays=[[],[]],this.wetIn.disconnect(),this.createHilbertTransformer()}},{key:"dispose",value:function(){Object(s.a)(Object(l.a)(n.prototype),"dispose",this).call(this),this.disposeList.forEach(function(e){return e()}),this.sineA.dispose(),this.sineB.dispose()}},{key:"randomizeDelays",value:function(){for(var e in this.delays){var t,n=y(this.delays[e]);try{for(n.s();!(t=n.n()).done;){t.value.delay.delayTime.value=Math.random()/2}}catch(r){n.e(r)}finally{n.f()}}}},{key:"clearRandom",value:function(){this.delayDirectionParameter.refresh()}},{key:"delayDirection",get:function(){return!this.delayDirectionParameter||this.delayDirectionParameter.get()}},{key:"setDelayDirection",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];for(var t in this.delays)for(var n in this.delays[t]){var r=e?this.numBanks-n:n,a=this.delays[t][n],i=a.delay,o=a.delayBlunter;i.delayTime.value=r/1e3,o.gain.value=r/this.numBanks}}},{key:"connect",value:function(e){this.connectedNode=e,this.outputNode.connect(e)}},{key:"disconnect",value:function(e){this.outputNode.disconnect(e)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"getJson",value:function(){var e=Object(r.a)({},Object(s.a)(Object(l.a)(n.prototype),"getJson",this).call(this),{frequency:this.frequencyParameter.get(!0),delaySpread:this.delaySpreadParameter.get(!0),delayDirection:this.delayDirectionParameter.get(!0),numBanks:this.numBanks});return e=this.saveParameterToJson(e,"delaySpreadParameter",this.delaySpreadParameter),e=this.saveParameterToJson(e,"delayDirectionParameter",this.delayDirectionParameter),e=this.saveParameterToJson(e,"frequencyParameter",this.frequencyParameter)}},{key:"fromJson",value:function(e,t){var a=Object(s.a)(Object(l.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(p.a)(this.frequencyParameter,e.frequency,a),Object(p.a)(this.delaySpreadParameter,e.delaySpread,a),Object(p.a)(this.delayDirectionParameter,e.delayDirection,a),e.numBanks&&e.numBanks!==this.numBanks&&(this.numBanks=e.numBanks),a=Object(r.a)({},a,this.loadParameterFromJson(e,"frequencyParameter",this.frequencyParameter,t),this.loadParameterFromJson(e,"delaySpreadParameter",this.delaySpreadParameter,t),this.loadParameterFromJson(e,"delayDirectionParameter",this.delayDirectionParameter,t))}}]),n}(f.a.Effect);t.a=j},function(e,t,n){"use strict";n.d(t,"a",function(){return v});var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(56),f=n(32),h=n(15),p=n.n(h),d=n(41);n(622);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,"Transient Shaper",function(){return new p.a.Gain(1)},e)).effectNode.gain.value=1,r.follower1=new p.a.Follower,r.follower2=new p.a.Follower,r.filter=new p.a.Filter(100,"highpass"),r.effectNode.connect(r.filter),r.filter.connect(r.follower1),r.filter.connect(r.follower2),r.roughness1Parameter=new d.c("roughness1",r.follower1._filter.frequency,{defaultValue:63.8,min:.01,max:100,noInput:!0}),r.roughness2Parameter=new d.c("roughness2",r.follower2._filter.frequency,{defaultValue:2.4,min:.01,max:100,noInput:!0}),r.registerParameter(r.roughness1Parameter),r.registerParameter(r.roughness2Parameter),r.controlVoltage=new p.a.Subtract,r.follower1.connect(r.controlVoltage,0,0),r.follower2.connect(r.controlVoltage,0,1),r.input=r.effectNode,r.outputNode=new p.a.Gain(1),r.sustainNode=new p.a.Gain(1),r.effectNode.connect(r.sustainNode),r.sustainNode.connect(r.outputNode),r.controlVoltage.connect(r.sustainNode.gain),r.attackParameter=new d.c("attack",r.controlVoltage.output.gain,{defaultValue:1,min:-4,max:4,automationRate:"A_RATE"}),r.registerParameter(r.attackParameter),r.outputGainParameter=new d.c("outputGain",r.outputNode.gain,{defaultValue:1,min:0,max:2,automationRate:"A_RATE"}),r.registerParameter(r.outputGainParameter),r.sustainParameter=new d.c("sustain",r.sustainNode.gain,{defaultValue:0,min:0,max:.5,automationRate:"A_RATE"}),r.registerParameter(r.sustainParameter),r.updateInitialValues(),r}return Object(i.a)(n,[{key:"connect",value:function(e){this.outputNode.connect(e),this.connectedNode=e}},{key:"disconnect",value:function(e){this.outputNode.disconnect(),this.connectedNode=null}},{key:"getJson",value:function(e){var t=Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this,e),{attack:this.attackParameter.get(!0),outputGain:this.outputGainParameter.get(!0),sustain:this.sustainParameter.get(!0)});return t=this.saveParameterToJson(t,"attackParameter",this.attackParameter),t=this.saveParameterToJson(t,"outputGainParameter",this.outputGainParameter),t=this.saveParameterToJson(t,"sustainParameter",this.sustainParameter)}},{key:"fromJson",value:function(e,t){var a=this,i=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return p.a.Master.context.isOffline?(Object(f.a)(this.attackParameter,e.attack,i),Object(f.a)(this.sustainParameter,e.sustain,i),Object(f.a)(this.outputGainParameter,e.outputGain,i)):setTimeout(function(){Object(f.a)(a.attackParameter,e.attack,i),Object(f.a)(a.sustainParameter,e.sustain,i),Object(f.a)(a.outputGainParameter,e.outputGain,i)},1e3),Object(r.a)({},i,this.loadParameterFromJson(e,"attackParameter",this.attackParameter,t),this.loadParameterFromJson(e,"sustainParameter",this.sustainParameter,t),this.loadParameterFromJson(e,"outputGainParameter",this.outputGainParameter,t))}},{key:"getEffectCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(l.a.Effect)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(t,n){Object(r.a)(this,e),this.minValue=t,this.maxValue=t,this.min=t,this.max=n}return Object(a.a)(e,[{key:"min",get:function(){return this.minValue},set:function(e){this.minValue="-"===e?-0:parseFloat(e)}},{key:"max",get:function(){return this.maxValue},set:function(e){this.maxValue="-"===e?-0:parseFloat(e)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(819),o=(n(15),function(){function e(t,n,a,i){Object(r.a)(this,e),this.initialBulkValues={},this.sequencerEngine=t,this.store=t.store,this.context=a,this.number=i,this.idToParameter={},this.parameterToScaler={},this.parameterIdToVoiceToNode={},this.parameters=[]}return Object(a.a)(e,[{key:"getType",value:function(){}},{key:"connect",value:function(e,t,n){if(void 0!==e){this.idToParameter[t.id]=t;var r=this.getChain(t,e);this.getModulator().connect(r[0]);for(var a=0;a<r.length-1;a++)r[a].connect(r[a+1]);return void 0===this.parameterIdToVoiceToNode[t.id]&&(this.parameterIdToVoiceToNode[t.id]={}),this.parameterIdToVoiceToNode[t.id][n]=r,r}var o=new i.a(t.min,t.max);this.parameterToScaler[t.id]=o}},{key:"replaceParameterIds",value:function(e,t,n){if(e!==t){var r=this.parameterIdToVoiceToNode[e];this.parameterIdToVoiceToNode[t]=r;var a=this.parameterToScaler[e];a&&(this.parameterToScaler[t]=a),this.idToParameter[t]=n,delete this.parameterIdToVoiceToNode[e],delete this.parameterToScaler[e],delete this.idToParameter[e]}}},{key:"disconnect",value:function(e,t,n){if(this.parameterIdToVoiceToNode&&void 0!==this.parameterIdToVoiceToNode[t.id]){delete this.idToParameter[t.id];var r=this.parameterIdToVoiceToNode[t.id][n];delete this.parameterIdToVoiceToNode[t.id][n],0===Object.keys(this.parameterIdToVoiceToNode[t.id]).length&&delete this.parameterIdToVoiceToNode[t.id],void 0!==this.parameterToScaler[t.id]&&delete this.parameterToScaler[t.id];var a=this.getModulator();if(void 0!==r&&a){var i=this.getScaleFromChain(r);i.min=0,i.max=0,a.output._add.input&&a.disconnect(r[0]);for(var o=0;o<r.length-1;o++)r[o].disconnect(r[o+1]);this.releaseChain(r)}}}},{key:"disposeParameters",value:function(){this.parameters.forEach(function(e){return e.dispose(!1)})}},{key:"disconnectAllModulators",value:function(){this.parameters.forEach(function(e){return e.disconnectFromAllModulators()})}},{key:"getScaleForParameter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.parameterToScaler[e.id])return this.parameterToScaler[e.id];if(this.parameterIdToVoiceToNode){var n=this.parameterIdToVoiceToNode[e.id];if(void 0!==n){var r=n[t];return this.getScaleFromChain(r)}}}},{key:"getDepthForParameter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.parameterIdToVoiceToNode[e.id];if(void 0!==n){var r=n[t];return this.getDepthFromChain(r)}}}]),e}());t.a=o},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(310);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}t.a=function(e){return function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"loadLostParameters",value:function(e){var t,n=u(this.midiEffects.effects);try{for(n.s();!(t=n.n()).done;){var r=t.value;(r.effects||[r]).filter(function(e){return e.lostParameters&&e.lostParameters.length>0}).forEach(function(e){e.lostParameters=e.loadParameters(e.lostParameters)})}}catch(a){n.e(a)}finally{n.f()}(this.tracks&&this.tracks.forEach(function(t){return e?t.loadLostParameters():t.track?t.track.loadLostParameters():0}),e)&&Object(c.a)(this).filter(function(e){return e.effect&&e.effect.lostParameters&&e.effect.lostParameters.length>0}).forEach(function(e){return e.effect.lostParameters=e.effect.loadParameters(e.effect.lostParameters)})}}]),n}(e)}},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=(n(438),n(605)),s=n(57),c=function(){function e(t){Object(a.a)(this,e),this.track=t,this.effects=[]}return Object(i.a)(e,[{key:"addEffect",value:function(e){this.effects=[].concat(Object(r.a)(this.effects),[e]),this.linkEffectParameters()}},{key:"clear",value:function(){}},{key:"clearEffects",value:function(){this.effects.forEach(function(e){return e.dispose()}),this.effects=[]}},{key:"linkEffectParameters",value:function(){var e=this;this.effects.forEach(function(t){t.registerContext((new s.a).forTrack(e.track)),t.registerMixSession(e.track.mixSession),t.registerTrack(e.track)})}},{key:"deleteEffect",value:function(e){var t=this.effects.indexOf(e);this.effects.splice(t,1)}},{key:"getAllParameters",value:function(){var e=[];for(var t in this.effects)e=[].concat(Object(r.a)(e),Object(r.a)(this.effects[t].getParameters()));return e}},{key:"getEffect",value:function(e){var t=this.effects.filter(function(t){return t.effect==e&&t.isEnabled()});return t.length>0?t[0]:void 0}},{key:"getJson",value:function(){return this.effects.map(function(e){return e.getJson()})}},{key:"fromJson",value:function(e){for(var t in e)this.addEffect(Object(o.a)(e[t],this.track)),this.effects[this.effects.length-1].fromJson(e[t])}},{key:"getCopy",value:function(t,n){var r=new e(t);return console.log("live effects =",this.effects),r.effects=this.effects.map(function(e){return e.getCopy(t,n)}),r.linkEffectParameters(),r}}]),e}();t.a=c},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}t.a=function(e){return function(e){Object(i.a)(n,e);var t=c(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"updatePatternRollStepNumber",value:function(e){if(void 0!==this.patternRollStepNumber){var t=e.getNumberOfStepsAtBaseResolution();this.patternRollStepNumber-=this.patternRollStepNumber%t}}},{key:"initPatternBuffer",value:function(e){if(this.pattern){var t=this.pattern.stepBuckets.length;this.patternRollStepNumber=e%t}else this.patternRollStepNumber=e}}]),n}(e)}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=(n(901),n(15)),o=n.n(i),s=n(63),c=n(317),u=n(6),l=n(183),f=n(75);function h(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=function(){function e(t,n){var a=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(r.a)(this,e),this.sequencerEngine=t,this.input=n,this.soundUploader=new l.a(2,function(e,t,n){return a.onSoundUploaded(t)}),this.isMaster=i,this.resampleCount=0}return Object(a.a)(e,[{key:"getRecorder",value:function(){return new window.Recorder(this.input,{numChannels:2,bufferLen:1024})}},{key:"start",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.track=t,this.freeze=n,this.sequencerEngine.store.dispatch(Object(u.Mc)(void 0===t||t.trackNumber)),this.resamplingDurationElapsed=0,this.recorder.record(e)}},{key:"stop",value:function(e){var t=this,n=Object(c.a)(e)+400;this.autoResampleMode||(e+=.2),this.recorder.stop(e),setTimeout(function(){t.recorder.getBuffer(function(e){return t.saveBuffer(e)}),t.sequencerEngine.store.dispatch(Object(u.Mc)(void 0))},n+500)}},{key:"saveBuffer",value:function(e){if(0===e[0].length)return console.log("frame count for blob is 0 so redoing the damn shit!"),void this.redoResample();this.audioBuffer=this.getAudioBuffer(e),this.soundUploader.uploadBufferToIpfs(e,!0,0)}},{key:"getAudioBuffer",value:function(e){var t=e[0].length,n=o.a.Master.context.createBuffer(2,t,o.a.Master.context.sampleRate);return n.copyToChannel(e[0],0,0),n.copyToChannel(e[1],1,0),n}},{key:"autoResampleTrack",get:function(){return this.sequencerEngine.tracks[0]}},{key:"autoResampleTrackNote",get:function(){return this.autoResampleTrack.pattern.stepBuckets[0].steps[0].transpose}},{key:"incrementNotes",value:function(e){var t,n=h(this.autoResampleTrack.pattern.stepBuckets);try{for(n.s();!(t=n.n()).done;){var r=t.value;for(var a in r.steps)r.steps[a].getPolyphony().forEach(function(t){return t.transpose+=e})}}catch(i){n.e(i)}finally{n.f()}}},{key:"autoResampleMode",get:function(){return this.sequencerEngine.autoResampleMode}},{key:"samplesPerNote",get:function(){return this.sequencerEngine.resampleConfig.samplesPerNote}},{key:"onSoundUploaded",value:function(e){var t=new f.a(e);if(t.audioBuffer=this.audioBuffer,t.name="Resampled Recording",t.tags=["Resampled"],this.autoResampleMode){t.name=s.a.fromTranspose(this.autoResampleTrackNote).toString();var n=this.autoResampleTrack;n.midiOutputs&&t.tags.push(Array.from(n.midiOutputs)[0].name)}if(t.isResampled=!0,t.samplesUsed=[],this.isMaster){var r=this.sequencerEngine.tracks.filter(function(e){return!e.muted&&e.sample}).map(function(e){return e.sample});t.samplesUsed=r.map(function(e){return e.getId()})}void 0===t.samplesUsed&&(t.samplesUsed=[]),this.freeze?this.track.freeze(t):(void 0===this.sampledInstrument&&(this.sampledInstrument=this.sequencerEngine.addSampledInstrumentTrack(),this.autoResampleMode&&this.matchLengths(this.sampledInstrument)),this.sampledInstrument.instrument.newSample(void 0,t),this.sequencerEngine.recordingsToSave.push(t)),this.autoResampleMode&&(console.log("AUTO RESAMPLE MMODEE PREPARE"),this.prepare(),this.resampleCount%this.samplesPerNote===0&&this.incrementNotes(2),this.resampleCount++,this.sequencerEngine.store.dispatch(Object(u.Be)(!0)))}},{key:"prepare",value:function(){void 0===this.recorder?this.recorder=this.getRecorder():this.recorder.clear()}},{key:"matchLengths",value:function(e){for(;e.length>this.autoResampleTrack.length;)e.halfTrackLength()}},{key:"dispatch",value:function(e){this.sequencerEngine.store.dispatch(e)}},{key:"redoResample",value:function(){this.isMaster?this.dispatch(Object(u.Be)(!0)):this.dispatch(Object(u.kh)(this.track.subSequence.id,this.track.trackNumber))}}]),e}();t.a=d},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var r=n(15),a=new(n.n(r).a.Time)("32n");function i(e,t,n){var r=e[0],a=e.map(function(e){return c(e-r,t,n)}),i=s(a,32),u=o(a,32,i),l=s(u,16),f=s(u=o(u,16,l),8),h=s(u=o(u,8,f),4),p=s(u=o(u,4,h),2),d=s(u=o(u,2,p),1);return u=o(u,1,d),console.log("timing 1 = "),console.log(d),{steps:u,unquantizedSteps:a,timings:[d,p,h,f,l,i].filter(function(e){return!(0===(t=e).even&&0===t.odd);var t})}}function o(e,t,n){var r=32/t;return e.map(function(e){return{stepNumber:e.stepNumber,offset:Math.max(0,Math.floor(e.stepNumber/r)%2===0?e.offset-n.even:e.offset-n.odd)}})}function s(e,t){var n=32/t,r=void 0,a=void 0;for(var i in e){var o=e[i],s=o.stepNumber,c=o.offset;Math.floor(s/n)%2===0?(1===t&&console.log("even for 1 offset = "+c),(void 0===a||a>c)&&(a=c)):(1===t&&console.log("odd for 1 offset = "+c),(void 0===r||r>c)&&(r=c))}return{resolution:t,even:a||0,odd:r||0}}function c(e,t,n){var r=e*t/n/a.toMilliseconds(),i=r-Math.floor(r);return{stepNumber:Math.floor(r),offset:i}}},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(15),l=n.n(u),f=(n(317),n(6)),h=n(50);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}t.a=function(e){return function(e){Object(o.a)(n,e);var t=p(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).currentStepDatas=[],e}return Object(i.a)(n,[{key:"releaseAll",value:function(e){this.getSamplers().filter(function(e){return e&&e.isLoaded()}).map(function(t){return t.releaseAll(e)})}},{key:"liveTriggerRelease",value:function(e,t){this.gated&&(this.triggerRelease(e,t),this.chokes.liveRelease())}},{key:"resetAnyPLockedParameters",value:function(e,t){if(this.previousPLocks&&this.previousPLocks.length>0){var n=Array.from(new Set(this.previousPLocks)).filter(function(e){return e.savedUnlockedValue}).filter(function(t){return!e||!e.pLockedParameters.includes(t)}).map(function(e){if(void 0===e.savedUnlockedValue)return{id:-1,value:-1};var n=e.set(e.savedUnlockedValue,!0,!0,t);return e.savedUnlockedValue=void 0,n}).reduce(function(e,t){var n=t.id,a=t.value;return Object(r.a)({},e,function(e,t){var n={};return n[e]=t,n}(n,a))},{});this.store.dispatch(Object(f.Vb)(n))}}},{key:"handlePLockedAutomations",value:function(e,t){var n=this;if(!this.isMetronome){var r=this.store.getState().keyboard.selectedPianoRollSteps;r&&r.some(function(e){return e.track===n})||(this.resetAnyPLockedParameters(e,t),this.previousPLocks=e.triggerAutomations(t,this))}}},{key:"storeStepData",value:function(e,t){this.isMetronome||(e.time=t,this.sendMessage(h.q,e),this.lastPlayedStepData=e,void 0===e.stepNumber||this.currentStepDatas[0]&&this.currentStepDatas[0].stepNumber===e.stepNumber||(this.currentStepDatas=[]),void 0===e.stepNumber&&(e=e.getCopy(!0,!1,!0,!1,!1)),this.currentStepDatas.push(e))}},{key:"trigger",value:function(e,t){var n=this;t=t||l.a.Master.context.currentTime,this.storeStepData(e,t),this.getSamplers().filter(function(e){return e&&e.isLoaded()}).filter(function(e){return e&&e.isChosen}).map(function(r){r.trigger({gated:!!n.isWarped()||!n.isFrozen&&!n.isAudioTrack&&n.gated,stepData:e,time:t,sliceNumber:e.slice})})}},{key:"triggerSamples",value:function(e,t,n){var r=this;this.soundIds.filter(function(e){return r.isRecordingPlaying(e)}).map(function(e){return r.samplers[e]}).filter(function(e){return e&&e.isLoaded()}).map(function(n){return n.trigger({gated:!1,stepData:e,time:t})})}},{key:"triggerSlice",value:function(e){var t=this.trackData.transpose;this.triggerSample(e,t)}},{key:"triggerSample",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0;this.getSamplers().filter(function(e){return e&&e.isLoaded()}).forEach(function(u){return u.trigger({gated:!!n.isWarped()||n.gated,sliceNumber:e,stepData:c||n.trackData,start:s,noDuration:o,velocity:a,transpose:t,skipRelease:r,time:i})})}},{key:"triggerRelease",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.getSamplers().filter(function(e){return e&&e.isLoaded()}).forEach(function(n){n.release(t,e)}),this.currentStepDatas&&(this.currentStepDatas=this.currentStepDatas.filter(function(t){return t.transpose!==e}))}},{key:"triggerMidiNoteOn",value:function(e,t){this.triggerSample(0,!1,this.resolution.getTimeInStep(),e+this.trackData.transpose,!0)}},{key:"triggerMidiNoteOff",value:function(e){}},{key:"liveTrigger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.trackData,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;this.triggerSample(t,e.transpose,!0,e.velocity,n,void 0===e.duration,e.start,e.track&&e),e.track=this,this.sendMessage(h.q,e),this.storeStepData(e,n),this.chokes.liveTrigger()}}]),n}(e)}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(342);function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}t.a=function(e){return function(e){Object(i.a)(n,e);var t=u(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"addRackEffect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=this.effectRack;a||(a=new c.a(this),this.midiEffects.addEffect(a));var i=a.adjacencyLists;if(a.addEffect(e),n){var o=i[n.id]&&i[n.id].filter(function(e){return e.outputNumber===r})||[],s=o.map(function(e){return e.effect});o.forEach(function(e){return a.deleteEdge(e)}),s.forEach(function(t){return a.connectNodes(e,t)}),a.connectNodes(n,e,r)}else if(t){if(a.effects.length>1){var u,l=void 0,f=function(e){var t=i[e].find(function(e){return e.effect===a.outputNode});if(t)return l=a.effects.find(function(t){return t.id===e}),u=t,"break"};for(var h in i){if("break"===f(h))break}a.deleteEdge(u),a.connectNodes(l,e)}else a.connectNodes(void 0,e);a.connectNodes(e)}else{var p=a.adjacencyLists[-1];if(a.effects.length>1&&p.length>0){var d=p[0].effect;a.deleteEdge(p[0]),a.connectNodes(e,d)}else a.connectNodes(e);a.connectNodes(void 0,e)}}}]),n}(e)}},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(11),a=n(37),i=function(e){return"object"===typeof e&&0===Object.keys(e).length?"p":"p - ".concat(Object(a.b)(e),".x *\n    clamp(\n        round(p/").concat(Object(a.b)(e),".x), \n        -vec3(").concat(Object(a.b)(e),".y, ").concat(Object(a.b)(e),".z, ").concat(Object(a.b)(e),".w), \n        vec3(").concat(Object(a.b)(e),".y, ").concat(Object(a.b)(e),".z, ").concat(Object(a.b)(e),".w))")},o={cappedCylinder:function(e){var t=Object(r.a)(e,8),n=t[0],o=(t[1],t[2]),s=(t[3],t[4]),c=(t[5],t[6]),u=t[7];return{args:{p:"vec3"},returnType:"vec2",body:"\n   p = (p - ".concat(n,")*").concat(s,"  + (").concat(n,")*(").concat(s," - identity);\n   p = ").concat(i(u),";\n   float h = ").concat(Object(a.b)(o),".x;\n   float r = ").concat(Object(a.b)(o),".y;\n  vec2 d = abs(vec2(length(p.xz),p.y)) - vec2(h,r);\n  return vec2(min(max(d.x,d.y),0.0) + length(max(d,0.0)), ").concat(Object(a.b)(c),");\n")}},rect:function(e){var t=Object(r.a)(e,7),n=t[0],i=(t[1],t[2]),o=t[3],s=t[4],c=t[5],u=t[6];return{args:{p:"vec2"},returnType:"vec2",body:"\n    return vec2(sdRoundBoxCoord(\n        p, \n        ".concat(Object(a.b)(n),", \n        (").concat(Object(a.b)(i),"), \n        ").concat(Object(a.b)(o),",\n        ").concat(Object(a.b)(s||"identity"),", \n        ").concat(Object(a.b)(c),"), ").concat(Object(a.b)(u),");\n")}},box:function(e){var t=Object(r.a)(e,8),n=t[0],o=(t[1],t[2]),s=t[3],c=t[4],u=t[5],l=t[6],f=t[7];return{args:{p:"vec3"},returnType:"vec2",body:"\n\n  p = (p - ".concat(n,")*").concat(c,"  + (").concat(n,")*(").concat(c," - identity);\n  vec3 q = ").concat(i(f),";\n  return vec2(sdRoundBox3DCoord(\n        q, \n        ").concat(Object(a.b)(n),", \n        (").concat(Object(a.b)(o),"), \n        ").concat(Object(a.b)(s),", \n        ").concat(Object(a.b)(c||"identity"),", \n        ").concat(Object(a.b)(u),"), ").concat(Object(a.b)(l),");\n")}},circle:function(e){var t=Object(r.a)(e,8),n=t[0],i=(t[1],t[2]),o=(t[3],t[4],t[5],t[6]);t[7];return{args:{p:"vec2"},returnType:"vec2",body:"\n\nreturn vec2(length(p - ".concat(Object(a.b)(n),") - ").concat(Object(a.b)(i),".x, ").concat(Object(a.b)(o),");\n")}},sphere:function(e){var t=Object(r.a)(e,7),n=t[0],i=(t[1],t[2]),o=(t[3],t[4],t[5],t[6]);return{args:{p:"vec3"},returnType:"vec2",body:"\nreturn vec2(length(p - ".concat(Object(a.b)(n),") - ").concat(Object(a.b)(i),".x, ").concat(Object(a.b)(o),");\n")}},torus:function(e){var t=Object(r.a)(e,7),n=t[0],i=(t[1],t[2]),o=(t[3],t[4]),s=(t[5],t[6]);return{args:{p:"vec3"},returnType:"vec2",body:"\n    p = (p - ".concat(n,")*").concat(o,"  + (").concat(n,")*(").concat(o," - identity);\n    vec3 r = ").concat(i,";\n    float x = length(p.xz)-r.x;\n    return vec2(\n        length(vec2(x, p.y)) - r.y, \n        ").concat(Object(a.b)(s),");\n")}},plane:function(e){var t=Object(r.a)(e,7),n=t[0],i=(t[1],t[2]),o=(t[3],t[4],t[5],t[6]);return{args:{p:"vec3"},returnType:"vec2",body:"\n    return vec2(\n        dot(p, ".concat(i,") + ").concat(n,".x,\n        ").concat(Object(a.b)(o),");\n")}}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="SEQUENCER"},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(6),f=n(34),h=n(12);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"isToggled",value:function(){return this.props.parameter&&this.props.parameter.isConnectedToEnvelope(this.props.envelope)}},{key:"toggle",value:function(){this.props.parameter.isAudioParamEnabled()||this.props.parameter.enableAudioParam(),this.isToggled()?this.props.parameter.disconnectFromEnvelope(this.props.envelope):(this.props.parameter.connectToEnvelope(this.props.envelope),this.props.setSelectedEnvelope(this.props.envelope.number)),this.setState({toggled:this.isToggled()})}},{key:"onMouseOver",value:function(e){e.stopPropagation(),this.props.setContextualHelp(f.D)}},{key:"showMods",value:function(e){this.props.setShowEnvelopes(!0)}},{key:"render",value:function(){var e=this,t=this.isToggled()?" toggled ":"",n=this.props.envelopes.indexOf(this.props.envelope);return u.a.createElement("div",{onMouseOver:function(t){return e.onMouseOver(t)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.toggle()},className:"pushable parameter-envelope-toggle lfo-"+n+t},n+1)}}]),n}(c.PureComponent);t.a=Object(h.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(l.ub)(t))},setSelectedEnvelope:function(t){return e(Object(l.Te)(t))},setShowEnvelopes:function(t){return e(Object(l.Jf)(t))},setArrangementBottomMode:function(t){return e(Object(l.D)(t))},setShowPianoRoll:function(t){return e(Object(l.Wf)(t))}}})(d)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(6),f=n(12),h=(n(502),n(34)),p=n(90),d=n.n(p);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var v=function(e){Object(i.a)(n,e);var t=m(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"handleSendVolumeChange",value:function(e){this.props.setParameterSliderDown(this.parameter),this.props.track.setSendVolume(this.props.sendNumber,e,!1)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"parameter",get:function(){return this.props.track.sendNodeVolumeParameters[this.props.sendNumber]}},{key:"onMouseUp",value:function(e){this.props.isMacroMapping&&(e.stopPropagation(),this.parameter.isMapped||this.props.setParameterToMap(this.parameter)),this.props.setParameterSliderDown(void 0),this.parameter.automation.smoothen(),this.parameter.mixAutomation.smoothen()}},{key:"render",value:function(){var e=this;if(this.props.send&&this.props.send.pad)return"";var t=0===this.props.sendNumber?h.Qb:h.Rb,n="enabled effect track-send";return this.props.isMacroMapping&&(n+=" plane-mapping"),this.props.send?u.a.createElement("div",{onMouseUp:function(t){return e.onMouseUp(t)},onMouseOver:function(n){return e.setContextualHelp(n,t)},onMouseLeave:function(){e.props.setContextualHelp(void 0)},className:n},u.a.createElement("div",{className:"effect-name"},this.props.send.getName()),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"parameter-box"},u.a.createElement(d.a,{value:this.props.volume,change:function(t){return e.handleSendVolumeChange(t.target.value)},slideStop:this.mouseDown,step:.1,max:3,min:-70,orientation:"horizontal",reversed:!1}))):""}}]),n}(c.Component);t.a=Object(f.b)(function(e,t){var n=t.track;return{volume:void 0!==n?n.sendNodeVolumeParameters[t.sendNumber].get():0,isRecordingMix:e.mix.isRecordingMix,isRecording:e.sequencer.isRecording,isMacroMapping:e.effects.isMacroMapping}},function(e){return{setContextualHelp:function(t){return e(Object(l.ub)(t))},setParameterSliderDown:function(t){return e(Object(l.Sd)(t))},setParameterToMap:function(t){return e(Object(l.Td)(t))},setTrackSendVolume:function(t,n,r){return e(Object(l.hh)(t,n,r))}}})(v)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(648),f=(n(56),n(1372)),h=n(39),p=n.n(h),d=(n(722),n(436),n(38)),m=(n(292),n(639),n(232),n(616),n(293),n(250),n(989),n(437),n(619),n(618),n(723),n(612),n(724),n(725),n(620),n(621),n(617),n(509),n(510),n(613),n(378),n(429),n(611),n(430),n(609),n(431),n(438)),v=n(623),b=n(294),g=(n(342),n(608),n(273),n(89)),y=n(6),k=n(86),O=n(34),j=n(12);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var E=[{value:g.c,label:"Macro"},{value:g.e,label:"Playhead"},{value:g.f,label:"Roll"}],S=function(e){Object(i.a)(n,e);var t=w(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={showOptions:!0},a}return Object(a.a)(n,[{key:"handleChooseLiveEffect",value:function(e){var t=this,n=null;e===g.f?n=new m.a(this.props.track):e===g.c?n=new l.a(this.props.track):e===g.d?n=new v.a(this.props.track):e===g.e&&(n=new b.a(this.props.track)),this.props.handleChooseLiveEffect(n),this.setState({value:0}),setTimeout(function(){t.setState({value:void 0})},50)}},{key:"handleChooseMidiEffect",value:function(e){var t=this;this.props.handleChooseMidiEffect(Object(k.c)(e,this.props.track)),this.setState({value:0}),setTimeout(function(){t.setState({value:void 0})},50)}},{key:"handleChooseEffect",value:function(e){var t=this,n=(this.props.send,Object(k.b)(e,this.props.sequencerEngine));this.props.handleChooseEffect(n),this.setState({value:e}),setTimeout(function(){t.setState({value:void 0})},50)}},{key:"onClickShowOptions",value:function(){this.state.showOptions=!0,this.setState(this.state)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"render",value:function(){var e=this;if(this.state.showOptions)return u.a.createElement("div",{className:"enabled effect choose-effects"},u.a.createElement("div",{className:"add-effect-type"},u.a.createElement(p.a,{className:"delay-time-dropdown",options:k.a,value:this.state.value,onChange:function(t){return e.handleChooseEffect(t.value)},placeholder:"Audio FX"})),u.a.createElement(d.a,{condition:void 0!==this.props.track},u.a.createElement("div",{className:"add-effect-type"},u.a.createElement(p.a,{className:"delay-time-dropdown",options:k.e,onChange:function(t){return e.handleChooseMidiEffect(t.value)},value:this.state.value,placeholder:"MIDI FX"})),u.a.createElement(d.a,{condition:!window.installation},u.a.createElement("div",{className:"add-effect-type"},u.a.createElement(p.a,{className:"delay-time-dropdown",value:this.state.value,options:E,onChange:function(t){return e.handleChooseLiveEffect(t.value)},placeholder:"Live FX"})))));void 0===this.props.track||this.props.track.effectsChains;return u.a.createElement("div",{className:"effects-chooser-container"},u.a.createElement("div",{onMouseOver:function(t){return e.setContextualHelp(t,O.a)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.onClickShowOptions()},className:this.props.addClassName},"+"),u.a.createElement(d.a,{condition:!window.installation},u.a.createElement(f.a,{track:this.props.track})))}}]),n}(c.Component);t.a=Object(j.b)(function(e,t){var n=0;return t.track&&(n=t.track.chainNumber),{chainNumber:n}},function(e,t){return{setContextualHelp:function(t){return e(Object(y.ub)(t))},setEffectsChainToShow:function(t,n,r){return e(Object(y.Zb)(t,n,r))}}})(S)},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(5),a=n.n(r),i=n(14),o=n(346),s=n(211),c=n(75),u=function(e,t,n,r){Object(o.a)(e).then(function(){var e=Object(i.a)(a.a.mark(function e(i){var o,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=new c.a(i[0]),e.next=3,o.load();case 3:(u=new s.a(o,t.sequencerEngine)).sounds=i.slice(1),r(o,u),n(void 0),u.initBuffers();case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),a=n.n(r),i=n(534),o=n(830);function s(e){var t=e.sequencerEngine.lfosTrack.lfos.map(function(e){return e.lfo}),n=e.sequencerEngine.envelopes;return a.a.createElement("div",{className:"parameter-modulators"},a.a.createElement("div",{className:"lfo-buttons"},t.map(function(n){return a.a.createElement(i.a,{lfo:n,lfos:t,parameter:e.parameter})})),a.a.createElement("div",{className:"envelope-buttons"},n.map(function(t,r){return a.a.createElement(o.a,{parameter:e.parameter,envelope:t,envelopes:n})})))}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(29),o=n(12),s=n(6),c=new i.a;t.a=Object(o.b)(function(e,t){return{isMacroMapping:e.effects.isMacroMapping,isParameterToMap:t.parameter&&e.effects.parameterToMap===t.parameter}},function(e){return{setParameterToMap:function(t){return e(Object(s.Td)(t))}}})(function(e){var t=e.parameter,n=e.isMacroMapping,r=e.isParameterToMap,i=e.setParameterToMap;if(n&&t){var o="macro-overlay";r&&(o+=" parameter-to-map"),t.hasMacro&&(o+=" mapped");var s={};t.hasMacro&&(s={backgroundColor:c.getColorForHash(t.hasMacro.id)});var u=t.hasMacro&&t.hasMacro.name;return a.a.createElement("div",{onClick:function(){return i(t)},className:o},a.a.createElement("div",{className:"overlay-main"}),a.a.createElement("div",{className:"overlay-detail",style:s},u))}return""})},function(e,t,n){"use strict";var r=n(11),a=n(99),i=n(0),o=n.n(i),s=n(155),c=n(319),u=n(249),l=n(22),f=n(12);t.a=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){e.isDraggable;var t=e.setSelectedOscillator,n=e.instrument,f=e.color,h=e.osc,p=Object(a.a)(e,["isDraggable","setSelectedOscillator","instrument","color","osc"]),d=Object(i.useState)(void 0===h?n.oscillators[0]:h),m=Object(r.a)(d,2),v=m[0],b=m[1];Object(i.useEffect)(function(){h&&b(h)},[h,b]);var g=v||n.oscillators[0];return o.a.createElement(c.a,{isDraggable:!1,instrument:n,id:n.fmParameters.id,type:s.a,className:"instrument-section"},o.a.createElement(u.a,{color:f,track:p.track,scrollContainer:p.scrollContainer,setSelectedOscillator:function(e){t?t(Math.max(0,n.oscillatorNodes.indexOf(e))):b(e)},sequencerEngine:p.sequencerEngine,effect:n}),o.a.createElement("div",{className:"fm-parameters"},o.a.createElement("div",{className:"osc-name"},g.name),o.a.createElement("div",{className:"fm-parameters-container"},o.a.createElement(l.a,{automation:p.automation,name:"Harmonicity",sequencerEngine:p.sequencerEngine,lfoEnabled:!0,parameter:g.harmonicityParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:20,step:.01}),o.a.createElement(l.a,{automation:p.automation,name:"Modulation",sequencerEngine:p.sequencerEngine,parameter:g.modulationIndexParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:125,step:.01}))))})},function(e,t,n){"use strict";var r=n(9),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=n(90),h=n.n(f);n(62);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var d=function(e){Object(o.a)(n,e);var t=p(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.oscillator,t=e.partials;return t?l.a.createElement("div",{className:"harmonics-editor"},"Harmonics Editor",t.slice(0,64).map(function(t,n){return l.a.createElement(m,{oscillator:e,i:n})})):l.a.createElement("div",null)}}]),n}(u.Component),m=function(e){Object(o.a)(n,e);var t=p(n);function n(e){var r;Object(a.a)(this,n);var i=(r=t.call(this,e)).props.oscillator.partials[r.props.i];return r.state={value:i},r}return Object(i.a)(n,[{key:"onChange",value:function(e){var t=Object(r.a)(this.props.oscillator.partials);t[this.props.i]=e,this.props.oscillator.partials=t,this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.props.oscillator.partials[this.props.i];return l.a.createElement("div",{className:"partial-editor"},l.a.createElement("div",{className:"partial-number"},this.props.i+1),l.a.createElement(h.a,{value:t,change:function(t){return e.onChange(t.target.value)},step:.01,max:8,min:0,orientation:"horizontal",reversed:!1}))}}]),n}(u.Component);t.a=d},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(291),s=n(12);function c(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e,t){var n,r=e.offsetLeft,a=e.offsetTop,i=document.createElement("div"),o=getComputedStyle(e),s=c(o);try{for(s.s();!(n=s.n()).done;){var u=n.value;i.style[u]=o[u]}}catch(m){s.e(m)}finally{s.f()}var l="INPUT"===e.tagName?e.value.replace(/ /g,"."):e.value,f=l.substr(0,t);i.textContent=f,"TEXTAREA"===e.tagName&&(i.style.height="auto"),"INPUT"===e.tagName&&(i.style.width="auto");var h=document.createElement("span");h.textContent=l.substr(t)||".",i.appendChild(h),document.body.appendChild(i);var p=h.offsetLeft,d=h.offsetTop;return document.body.removeChild(i),{x:r+p,y:a+d}};t.a=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.library,n=(e.setLibrary,e.input),s=e.possibilities,c=e.setPossibilities,u=e.scrollTop,f=e.choosePossibility,h=e.selectedChoice,p=e.doc,d=(e.effect,Object(a.useRef)());Object(a.useEffect)(function(){return d.current&&d.current.addEventListener("mousewheel",m),function(){d.current&&d.current.removeEventListener("mousewheel",m)}},[s]);var m=function(e){return e.stopPropagation()},v=Object(a.useState)(void 0),b=Object(r.a)(v,2),g=b[0],y=b[1],k=Object(a.useState)(""),O=Object(r.a)(k,2),j=O[0],w=O[1];Object(a.useEffect)(function(){return window.addEventListener("click",E),function(){return window.removeEventListener("click",E)}},[s,c]);var E=Object(a.useCallback)(function(){s.length>0&&c([])},[s,c]);Object(a.useEffect)(function(){n.current&&y(l(n.current,n.current.selectionStart))},[s]),Object(a.useEffect)(function(){t||w("")},[t,w]);var S={};g&&(S.top=g.y+16-u,S.left=g.x,S.maxHeight=n.current.offsetHeight-S.top);var P=Object(a.useCallback)(function(e){e.stopPropagation(),Object(o.a)(t).then(function(e){w(e)})},[t,w]);return t||0!==s.length?i.a.createElement("div",{ref:d,style:S,className:"possibilities"},t&&i.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},onMouseUp:function(e){return e.stopPropagation()},className:"library-view"},i.a.createElement("div",{className:"library"},i.a.createElement("div",null,"Library: ",t),i.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},onMouseUp:P,className:"see-source-btn"},"See Source")),""!==j&&i.a.createElement("textarea",{className:"see-source"},j)),s.map(function(e,t){return i.a.createElement("div",{key:t,onMouseUp:function(t){t.stopPropagation(),f(e)},onMouseDown:function(e){e.stopPropagation()},className:e===h?"selected option":"option"},i.a.createElement("div",{className:"args"},i.a.createElement("div",{className:"keyword"},e),i.a.createElement("div",{className:"param"},"(",Object.keys(p(e).params).join(", "),")")),i.a.createElement("div",{className:"description"},p(e).description))})):[]})},function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n(8),a=(n(448),function e(t,n,a,o,s){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};for(var l in u[a]||(u[a]=0),u[a]++,s)if(!(l===a||u[l]>6)){var f=s[l].current;if(f){var h=Object(r.a)({},c);if(h[a]={x:t,y:n},i(o,f,a,l,h)){var p={x:f.offsetLeft,y:f.offsetTop};c[l]&&(p=c[l]);var d={x:p.x+o.offsetWidth+50,y:p.y};c[l]=d,c=Object(r.a)({},c,e(d.x,d.y,l,f,s,c,u))}}}return c}),i=function(e,t,n,r,a){var i=t.offsetLeft,s=t.offsetTop,c=t.offsetWidth+i,u=t.offsetHeight+s;return a&&void 0!==a[r]&&(i=a[r].x,s=a[r].y,c=t.offsetWidth+a[r].x,u=t.offsetHeight+a[r].y),o(e,i,s,c,u,n,a)},o=function(e,t,n,r,a,i,o){if(!e)return!1;var s=t,c=n,u=r,l=a,f={x1:e.offsetLeft,y1:e.offsetTop,x2:e.offsetLeft+e.offsetWidth,y2:e.offsetTop+e.offsetHeight};return o&&void 0!==o[i]&&(f.x1=o[i].x,f.y1=o[i].y,f.x2=o[i].x+e.offsetWidth,f.y2=o[i].y+e.offsetHeight),s<=f.x2&&u>=f.x1&&c<=f.y2&&l>=f.y1}},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(5),a=n.n(r),i=n(14),o=n(11),s=n(0),c=n(92),u=function(e){var t=e.ref,n=e.code,r=e.onChange,u=e.doc,m=e.skipMouse,v=void 0!==m&&m,b=e.timeout,g=void 0===b?250:b,y=e.disable,k=Object(s.useState)([]),O=Object(o.a)(k,2),j=O[0],w=O[1],E=Object(s.useState)(void 0),S=Object(o.a)(E,2),P=S[0],x=S[1],T=Object(s.useState)(void 0),C=Object(o.a)(T,2),N=C[0],R=C[1],M=Object(s.useState)(void 0),A=Object(o.a)(M,2),q=A[0],D=A[1],I=Object(s.useRef)(0);Object(s.useEffect)(function(){if(!y&&t&&t.current)return t.current.addEventListener("keydown",_),t.current.addEventListener("keyup",L),v||t.current.addEventListener("mouseup",L),function(){t.current&&(t.current.removeEventListener("keydown",_),t.current.removeEventListener("keyup",L),v||t.current.removeEventListener("mouseup",L))}},[n,P,j,N,R,x,y]);var _=Object(s.useCallback)(function(e){return"Tab"!==e.key||(e.preventDefault(),e.stopPropagation(),N&&B(N),!1)},[n,r,j,w,j,N,R]),F=Object(s.useCallback)(function(e){var t=1;for(e-=2;e>=0&&t>0;e--)")"===n.charAt(e)?t++:"("===n.charAt(e)&&t--;if(e>0){var r=d(e,n),a=r.x,i=r.y;D({x:a,y:i}),setTimeout(function(){D(void 0)},1e3)}},[D,n]),L=Object(s.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(r){var i,o,s,l,f,d;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.current){e.next=2;break}return e.abrupt("return");case 2:if(!y){e.next=4;break}return e.abrupt("return");case 4:return I.current++,i=I.current,e.next=8,Object(c.a)(g);case 8:if(i===I.current){e.next=10;break}return e.abrupt("return");case 10:if("Tab"!==r.key){e.next=12;break}return e.abrupt("return",!1);case 12:if(o=t.current.selectionStart,")"===r.key&&F(o),s=n.replaceAll("("," ").replaceAll(")"," "),""===(l=p(s,o))&&(l=p(s,o-1)),""!==l.trim()){e.next=21;break}return j.length>0&&w([]),P&&x(void 0),e.abrupt("return");case 21:if("load"!==l&&"library"!==l){e.next=26;break}if(""===(f=h(s,o))){e.next=26;break}return x(f),e.abrupt("return");case 26:if(1!==(d=u().filter(function(e){return e.startsWith(l)})).length||d[0]!==l.trim()){e.next=30;break}return d.length>0&&w([]),e.abrupt("return");case 30:w(d),R(d.find(function(e){return e===l})||d[0]);case 32:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[n,P,j,w,R,x,y]),B=Object(s.useCallback)(function(e){var a=l(n,t.current.selectionStart),i=f(n,t.current.selectionStart),o=n.substring(0,0===a?0:a+1),s=n.substring(i);r({target:{value:o+e+s}}),setTimeout(function(){var n=o.length+e.length;t.current&&(t.current.focus(),t.current.setSelectionRange(n,n),w([]),x(void 0))},50)},[n,r,x,w]);return{choosePossibility:B,library:P,possibilities:j,setPossibilities:w,setLibrary:x,selectedChoice:N,matchingParenthesis:q}},l=function(e,t){for(t--;t>0&&" "!==e.charAt(t)&&"\n"!==e.charAt(t)&&","!==e.charAt(t)&&")"!==e.charAt(t)&&"("!==e.charAt(t);)t--;return t},f=function(e,t){for(t--;t<e.length&&" "!==e.charAt(t)&&"\n"!==e.charAt(t)&&","!==e.charAt(t)&&")"!==e.charAt(t)&&"("!==e.charAt(t);)t++;return t},h=function(e,t){for(var n="",r=!1,a=t;a<e.length;a++)if('"'!==e.charAt(a))r&&(n+=e.charAt(a));else{if(r)return n;r=!0}return n},p=function(e,t){e=String(e),t=Number(t)>>>0;var n=e.slice(0,t+1).search(/\S+$/),r=e.slice(t).search(/\s/);return r<0?e.slice(n):e.slice(n,r+t)},d=function(e,t){e++;var n=(t=t.slice(0,e+1)).split("\n"),r=n.length-1;return{x:9*(e-n.slice(0,n.length-1).reduce(function(e,t){return e+t.length+1},0)),y:22*r}}},,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=n(295),h=n(42);n(15);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var d=function(e){Object(o.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={playTicks:{}},a.onTriggerSample=a.onTriggerSample.bind(Object(i.a)(a)),a.onReleaseSample=a.onReleaseSample.bind(Object(i.a)(a)),a}return Object(a.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener(f.d,this.onTriggerSample),window.addEventListener(f.c,this.onReleaseSample)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(f.d,this.onTriggerSample),window.removeEventListener(f.c,this.onReleaseSample)}},{key:"onReleaseSample",value:function(e){var t=this;setTimeout(function(){Object.keys(t.state.playTicks).forEach(function(e){return clearInterval(e)}),t.setState({playTicks:{}})},e)}},{key:"onTriggerSample",value:function(e){var t=this;if(e.soundId===this.props.soundId&&!(Object.keys(this.state.playTicks).length>=10)){var n=e.time,r=e.transpose,a=Math.pow(2,r/12);setTimeout(function(){var n=0,r=(new Date).getTime(),i=setInterval(function(){var o=(new Date).getTime();n=(o-r)/1e3;var s=t.state.playTicks,c=n*a;if(t.props.instrument&&t.props.instrument.loop){if(void 0===t.props.instrument.defaultSampler)return;c%=t.props.instrument.defaultSampler.getDuration()*t.props.instrument.loopLength/100}else t.props.sampler&&t.props.sampler.getDuration();var u=e.startTime+c;s[i]=t.props.convertSecondsToSpace(u),e.duration&&n>e.duration&&(clearInterval(i),delete s[i]),t.setState(t.state)},80),o=t.props.convertSecondsToSpace(e.startTime);t.state.playTicks[i]=o,t.setState(t.state)},n)}}},{key:"render",value:function(){var e=this;return Object.values(this.state.playTicks).map(function(t){return l.a.createElement(h.Rect,{x:e.props.sequencerEngine&&e.props.sequencerEngine.reverse?e.props.width-t:t,y:0,width:2,height:e.props.height,fill:"rgb(35, 249, 111)"})})}}]),n}(u.Component);t.a=d},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0);function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var l=new(n(29).a),f=function(e){Object(i.a)(n,e);var t=u(n);function n(e){return Object(r.a)(this,n),t.call(this,e)}return Object(a.a)(n,[{key:"getTrack",value:function(e){return this.props.sequencerEngine.tracks[e]}},{key:"getSample",value:function(e){var t=this.getTrack(e);return void 0===t?void 0:t.sample}},{key:"isSample",value:function(e){return void 0!==this.getSample(e)}},{key:"key",get:function(){return this.props.value.toLowerCase()}},{key:"isThumbnail",value:function(e){return this.isSample(e)&&""!==this.getSample(e).getThumbnail()&&void 0!==this.getSample(e).getThumbnail()}},{key:"getThumbnailURL",value:function(e){return this.getSample(e).getThumbnail()}},{key:"getStyle",value:function(){var e={};if(void 0!==this.props.keyMapping){var t=this.props.keyMapping;e.borderBottomColor=l.getColor(t.sliceNumber),e.borderBottomStyle="solid",e.borderBottomWidth="3px",this.isThumbnail(t.trackNumber)?(e.backgroundImage='url("'+this.getThumbnailURL(t.trackNumber)+'")',e.backgroundPosition="center",e.backgroundSize="cover"):this.isSample(t.trackNumber)&&(e.backgroundColor=this.getSample(t.trackNumber).color),e.color="black"}return e}}]),n}(c.Component);t.a=f},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(182),s=n(12);t.a=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=Object(a.useRef)(void 0),s=Object(a.useState)(t.messageText),c=Object(r.a)(s,2),u=c[0],l=c[1],f=Object(a.useState)(!1),h=Object(r.a)(f,2),p=h[0],d=h[1],m=Object(o.a)(function(){return d(!0)},250,function(){return t.execute()});Object(a.useEffect)(function(){p&&n.current.focus()},[p]);var v=Object(a.useCallback)(function(e){"Enter"===e.key&&(t.messageText=u,t.execute(),d(!1))},[d,u]);return i.a.createElement("div",{onMouseDown:function(e){p&&e.stopPropagation()},className:"message-button"},p?i.a.createElement("input",{ref:n,onKeyDown:v,value:u,onChange:function(e){return l(e.target.value)}}):i.a.createElement("div",{onClick:m,className:"message-content"},u))})},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(11),s=n(0),c=n.n(s),u=n(6),l=n(334),f=(n(164),n(30)),h=n(47),p=n(318);t.a=function(e){var t=e.effect,n=e.hide,r=e.sequencerEngine,l=e.trackNumber,f=Object(s.useState)(""),m=Object(o.a)(f,2),v=m[0],b=m[1],g=Object(s.useState)([]),y=Object(o.a)(g,2),k=y[0],O=y[1],j=Object(s.useState)(!1),w=Object(o.a)(j,2),E=w[0],S=w[1],P=Object(s.useCallback)(function(){var e=t.getJson();Object(p.b)(e,v),n()},[v,n,t]),x=Object(s.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(i){var o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S(i),e.next=3,h.a.getJson(i.effectHash);case 3:return o=e.sent,e.next=6,t.fromJson(o,r.tracks,l,!0,!1);case 6:s=e.sent,t.track&&t.track.loadLostParameters&&t.track.loadLostParameters(),t.preset=i.effectHash,r.dispatch(Object(u.Vb)(s)),S(void 0),n();case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[S,t]);Object(s.useEffect)(function(){Object(p.a)(t.name).then(function(e){return O(e)})},[O,t]);var T="save-button";return""===v&&(T+=" disabled"),c.a.createElement("div",{className:"effect-presets"},c.a.createElement("div",{className:"presets-container"},k.map(function(e){return c.a.createElement(d,{id:e.effectHash,isLoading:e===E,isSelected:e.effectHash===t.preset,onClick:function(){return x(e)},preset:e})})),c.a.createElement("div",{className:"save-container"},c.a.createElement("input",{type:"text",className:"save-input",placeholder:"Type name to save",value:v,onChange:function(e){return b(e.target.value)}}),c.a.createElement("div",{onClick:P,className:T},"SAVE")))};var d=function(e){var t=e.preset,n=e.onClick,r=e.isSelected,a=e.isLoading,i=Object(s.useState)(""),u=Object(o.a)(i,2),h=u[0],p=u[1];Object(s.useEffect)(function(){f.a.users.getUserName(t.user).then(function(e){return p(e)})},[p]);var d="effect-preset";return r&&(d+=" selected"),a&&(d+=" loading"),c.a.createElement("div",{onClick:n,className:d},c.a.createElement("div",{className:"preset-title"},Object(l.a)(t.title)),c.a.createElement("div",{className:"preset-author"},h))}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(6),o=n(12);t.a=Object(o.b)(function(e,t){return{isMacroMapping:e.effects.isMacroMapping}},function(e){return{setParameterToMap:function(t){return e(Object(i.Td)(t))},setIsMacroMapping:function(t){return e(Object(i.Ec)(t))}}})(function(e){e.track;var t=e.isMacroMapping,n=e.setIsMacroMapping,r=e.onClick,i=e.setParameterToMap,o=e.label,s="macro-map-button";return t&&(s+=" mapping"),a.a.createElement("div",{onClick:function(e){e.stopPropagation();var a=!t;i(void 0),n(a),r&&r(a)},className:s},o||"Map")})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a);t.a=function(e){var t=e.subMacro,n=e.macro,o=t.parameter,s=o.context,c=s.subDevice,u=s.effect,l=s.liveEffect,f=s.midiEffect,h=s.instrument;c=c||u||l||f||h;var p=Object(a.useState)(t.min),d=Object(r.a)(p,2),m=d[0],v=d[1],b=Object(a.useState)(t.max),g=Object(r.a)(b,2),y=g[0],k=g[1],O=Object(a.useCallback)(function(){n.unmapParameter(o)},[n,o]),j=Object(a.useCallback)(function(e){var n=e.target.value;n=parseFloat(n),o.isValidValue(n)?(t.min=n,v(e.target.value)):""!==e.target.value&&"."!==e.target.value||v(e.target.value)},[v]),w=Object(a.useCallback)(function(e){var n=e.target.value;n=parseFloat(n),o.isValidValue(n)?(t.max=n,k(e.target.value)):""!==e.target.value&&"."!==e.target.value||k(e.target.value)},[k]);return i.a.createElement("div",{className:"sub-macro"},i.a.createElement("div",{className:"sub-field effect"},c?c.name:u?u.name:h?h.name:""),i.a.createElement("div",{className:"sub-field parameter"},o.name),i.a.createElement("div",{className:"sub-field"},i.a.createElement("input",{className:"min-field",onChange:j,value:m,type:"text"})),i.a.createElement("div",{className:"sub-field"},i.a.createElement("input",{className:"max-field",onChange:w,value:y,type:"text"})),i.a.createElement("div",{onClick:O,className:"unmap-button"},"x"))}},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(11),a=n(0),i=n.n(a),o=n(42),s=n(456),c=100,u=200;function l(e){var t=Object(a.useState)([]),n=Object(r.a)(t,2),l=n[0],f=n[1],h=void 0!==e.automation||e.effect.isEnabled();void 0!==e.automation||e.effect.isEnabled();if(Object(s.a)(function(){h&&f(Array.from(e.effect.getValue()))},100),!h)return i.a.createElement("div",null);return i.a.createElement("div",null,i.a.createElement(o.Stage,{width:u,height:c},i.a.createElement(o.FastLayer,null,l.map(function(t,n){return function(t,n){t*=2;var r=Math.floor(u*n/e.effect.size),a=void 0,i=void 0;return t<0?(a=c/2,i=Math.abs(t)*c/2):(a=c/2-t*c/2,i=t*c/2),{x:r,y:a,height:i,width:3}}(t,n)}).map(function(e,t){return i.a.createElement(o.Rect,{perfectDrawEnabled:!1,key:t,x:e.x,y:e.y,width:e.width,height:e.height,fill:"red"})}))))}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12),f=n(22);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props.instrument.getOscillator(this.props.selectedOscillator),t=this.props.instrument;return u.a.createElement("div",{className:"oscillators-continued"},u.a.createElement(f.a,{sequencerEngine:t.sequencerEngine,name:"Noise",parameter:t.noiseLevelParameter,isParameter:!0,lfoEnabled:!0,root:2,min:0,max:1,step:.001}),u.a.createElement(f.a,{sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,name:"Feedback",parameter:t.feedbackParameter,root:2,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:6,step:.001}),u.a.createElement(f.a,{sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,name:"Polyphony",parameter:t.polyphonyParameter,onParameterChanged:function(){return[]},isParameter:!0,min:1,max:12,step:1}),u.a.createElement(f.a,{sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,name:"Glide",parameter:e.portamentoParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:5,step:.01}),u.a.createElement(f.a,{sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,name:"X/Y Mix",parameter:t.mixParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:0,max:1,step:.01}))}}]),n}(c.Component);t.a=Object(l.b)(function(e,t){return{algorithm:t.instrument.algorithmParameter.get(),adjacencyLists:t.instrument.adjacencyLists}},function(e){return{}})(p)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"onClickPartialCount",value:function(){var e=this.props.oscillator.partialCountParameter;e.set((e.get()+1)%e.max)}},{key:"render",value:function(){var e=this;this.props.oscillator;return u.a.createElement("div",{className:"partial-count-container"},u.a.createElement("div",{onClick:function(){return e.onClickPartialCount()},className:"partial-count"},this.props.value),u.a.createElement("div",null,"Partials"))}}]),n}(c.Component);t.a=Object(l.b)(function(e,t){var n=t.oscillator.partialCountParameter;return{value:void 0===t.automation||void 0===t.automation.get(n)?e.effects.effectParameters[n.id]:t.automation.get(n).value}},null)(h)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=(n(90),n(39)),h=n.n(f);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(e){return Object(r.a)(this,n),t.call(this,e)}return Object(a.a)(n,[{key:"handleOptionChange",value:function(e){this.props.effect.setSideChainedTrack(this.props.tracks[e],e)}},{key:"getSideChainedTrack",value:function(){var e=this.props.effect.connectedTrack;return void 0===e?0:this.props.tracks.indexOf(e)+1}},{key:"getOptions",value:function(){return this.props.sequencerEngine.tracks.map(function(e){return{label:"Track "+(e.trackNumber+1),value:e.trackNumber}})}},{key:"getOption",value:function(e){if(void 0!==e)return this.getOptions().filter(function(t){return t.value===e.trackNumber})[0]}},{key:"render",value:function(){var e=this;void 0!==this.props.automation||this.props.effect.isEnabled();return u.a.createElement("div",null,this.props.effect.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"sidechain-container"},u.a.createElement("div",{className:"parameter-label"},"Sidechain: "),u.a.createElement(h.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getOptions(),onChange:function(t){return e.handleOptionChange(t.value)},value:this.getOption(this.props.effect.connectedTrack),placeholder:"None"})),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Smoothing",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.smoothingParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1e-4,max:2,min:1e-5}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Threshold",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.thresholdParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:6,min:-120})):"")}}]),n}(c.Component);t.a=d},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(39),u=n.n(c),l=n(0),f=n.n(l),h=n(15),p=n.n(h),d=n(22);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var v=function(e){Object(i.a)(n,e);var t=m(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={filterEffect:e.filterEffect,frequency:e.filterEffect.getStoredLFOTime()},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.filterEffect=e.filterEffect,!0}},{key:"handleOptionChange",value:function(e){"lowpass"===e.target.value?this.state.filterEffect.lowpass():this.state.filterEffect.hipass(),this.setState(this.state)}},{key:"handleLFOTimeChange",value:function(e){this.state.frequency=e,this.state.filterEffect.setLFOTime(e()),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.filterEffect.isEnabled()}},{key:"render",value:function(){var e=this,t=this.state.filterEffect.getFilterType();this.state.filterEffect.getLFOTime(),void 0!==this.props.automation||this.state.filterEffect.isEnabled();return f.a.createElement("div",null,this.isEnabled()?f.a.createElement("div",null,f.a.createElement("form",null,f.a.createElement("div",{className:"radio"},f.a.createElement("label",null,f.a.createElement("input",{className:"filter-radio",type:"radio",value:"lowpass",checked:"lowpass"===t,onChange:function(t){return e.handleOptionChange(t)}}),"Lowpass"),f.a.createElement("label",null,f.a.createElement("input",{className:"filter-radio",type:"radio",value:"hipass",checked:"highpass"===t,onChange:function(t){return e.handleOptionChange(t)}}),"Hipass"),f.a.createElement(u.a,{className:"delay-time-dropdown",options:b,onChange:function(t){return e.handleLFOTimeChange(t.value)},value:g(this.state.frequency),placeholder:"Delay Time"}),f.a.createElement(d.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Cutoff",unit:"HZ",parameter:this.state.filterEffect.effectNode.baseFrequency,onParameterChanged:this.props.onParameterChanged,updateFunction:function(t){return e.state.filterEffect.effectNode.baseFrequency=t},getValue:function(){return e.state.filterEffect.effectNode.baseFrequency},step:5,max:1e4,min:10}),f.a.createElement(d.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Octaves",parameter:this.state.filterEffect.effectNode.octaves,updateFunction:function(t){return e.state.filterEffect.effectNode.octaves=t},onParameterChanged:this.props.onParameterChanged,getValue:function(){return e.state.filterEffect.effectNode.octaves},step:.1,max:10,min:0}),f.a.createElement(d.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Q",parameter:this.state.filterEffect.qParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1,max:10,min:0})))):"")}}]),n}(l.Component),b=[{value:function(){return.03125*new p.a.Time("1m")},label:"4"},{value:function(){return.125*new p.a.Time("1m")},label:"2"},{value:function(){return.25*new p.a.Time("1m")},label:"1"},{value:function(){return.5*new p.a.Time("1m")},label:"1/2"},{value:function(){return.5*new p.a.Time("2m")},label:"1/4"},{value:function(){return 2*new p.a.Time("1m")},label:"1/8"},{value:function(){return 3*new p.a.Time("1m")},label:"1/8t"},{value:function(){return 4*new p.a.Time("1m")},label:"1/16"},{value:function(){return 6*new p.a.Time("1m")},label:"1/16t"},{value:function(){return 8*new p.a.Time("1m")},label:"1/32"}];function g(e){e="function"===typeof e?e():e;var t=b.filter(function(t){return t.value()===e});return 0==t.length?b[0]:t[0]}t.a=v},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(110);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={reverbEffect:e.reverbEffect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.reverbEffect=e.reverbEffect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.reverbEffect.isEnabled()}},{key:"render",value:function(){Math.round(10*this.state.reverbEffect.getRoomSize()),this.state.reverbEffect.getDampening(),this.state.reverbEffect.getWet(),void 0!==this.props.automation||this.state.reverbEffect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Room Size",parameter:this.state.reverbEffect.roomSizeParameter,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:1,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Dampening",lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,parameter:this.state.reverbEffect.dampeningParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:100,max:8e3,min:0}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.reverbEffect})):"")}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(110);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={chorusEffect:e.chorusEffect},a}return Object(a.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.chorusEffect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.chorusEffect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Rate",selectedParameter:this.props.selectedParameter,parameter:this.state.chorusEffect.rateParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,isParameter:!0,step:.01,max:12,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Depth",selectedParameter:this.props.selectedParameter,parameter:this.state.chorusEffect.depthParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,isParameter:!0,step:.1,max:3,min:0}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.chorusEffect})):"")}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(110),f=n(22);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={tremoloEffect:e.tremoloEffect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.tremoloEffect=e.tremoloEffect,!0}},{key:"handleDepthChange",value:function(e){this.state.tremoloEffect.setDepth(e),this.setState(this.state)}},{key:"handleRateChange",value:function(e){this.state.tremoloEffect.setRate(e),this.setState(this.state)}},{key:"handleWetChange",value:function(e){this.state.tremoloEffect.setWet(e),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.tremoloEffect.isEnabled()}},{key:"render",value:function(){var e=this;Math.round(10*this.state.tremoloEffect.getRate()),this.state.tremoloEffect.getDepth(),this.state.tremoloEffect.getWet(),void 0!==this.props.automation||this.state.tremoloEffect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Rate",selectedParameter:this.props.selectedParameter,displayFunction:function(t){return Math.round(10*e.state.tremoloEffect.getRate())/10},lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,onParameterChanged:this.props.onParameterChanged,parameter:this.state.tremoloEffect.rateParameter,isParameter:!0,step:.1,max:16,min:0}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Depth",selectedParameter:this.props.selectedParameter,parameter:this.state.tremoloEffect.depthParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,isParameter:!0,step:.1,max:1,min:0}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Spread",selectedParameter:this.props.selectedParameter,parameter:this.state.tremoloEffect.spreadParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,isParameter:!0,step:1,max:360,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,effect:this.state.tremoloEffect})):"")}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12),f=n(110),h=n(46),p=n(22),d=n(39),m=n.n(d);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var b=function(e){Object(i.a)(n,e);var t=v(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={delayEffect:e.delayEffect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.delayEffect=e.delayEffect,!0}},{key:"handleOptionChange",value:function(e){this.setState(this.state)}},{key:"handleFeedbackChange",value:function(e){this.state.delayEffect.setFeedback(e),this.setState(this.state)}},{key:"handleDelayTimeChange",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(h.v)(this.state.delayEffect.rateParameter,e.value)),this.setState(this.state)}},{key:"handleWetChange",value:function(e){this.state.delayEffect.setWet(e),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.delayEffect.isEnabled()}},{key:"delay",get:function(){return this.state.delayEffect}},{key:"onChangeSynced",value:function(e){document.activeElement.blur(),this.delay.isSynced="unsynced"===e,this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.state.delayEffect,n=(t.getFeedback(),t.rawDelayRate,t.isSynced);t.getWet(),void 0!==this.props.automation||t.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"refined-checkbox-preferences lfo-synced-checkbox"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:n?"synced":"unsynced",checked:n,onChange:function(t){return e.onChangeSynced(t.target.value)}}),"Synced")),n?u.a.createElement("div",{className:"lfo-rate-dropdown"},u.a.createElement("div",{className:"lfo-rate-label"},"Rate:"),u.a.createElement(m.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:g,onChange:function(t){return e.handleDelayTimeChange(t)},value:y(this.delay.rawDelayRate),placeholder:"Rate"}),u.a.createElement("div",{className:"clear-fix"})):u.a.createElement(p.a,{effectNumber:this.props.effectNumber,name:"Rate",parameter:this.state.delayEffect.rateParameter,onParameterChanged:this.props.onParameterChanged,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0,step:1,min:1,max:1e3}),u.a.createElement(p.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Feedback",lfoEnabled:!0,selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,unit:"%",parameter:this.state.delayEffect.feedbackParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,displayFunction:function(e){return Math.floor(100*e)},step:.01,max:1,min:0}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.delayEffect})):"")}}]),n}(c.Component),g=[{value:"1n",label:"1"},{value:"2n",label:"1/2"},{value:"4n",label:"1/4"},{value:"4t",label:"1/4t"},{value:"8n",label:"1/8"},{value:"8n.",label:"1/8."},{value:"8t",label:"1/8t"},{value:"16n",label:"1/16"},{value:"16t",label:"1/16t"},{value:"32n",label:"1/32"}];function y(e){var t=g.filter(function(t){return t.value===e});return 0==t.length?"16n":t[0]}t.a=Object(l.b)(function(e,t){return{rate:t.delayEffect.rateParameter.get(),isEnabled:t.delayEffect.isEnabled()}},null)(b)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(148);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Gain",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.gainParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.1,max:6,min:.1}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Threshold",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,scrollContainer:this.props.scrollContainer,selectedParameter:this.props.selectedParameter,parameter:this.state.effect.thresholdParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.1,max:0,min:-80}),u.a.createElement("div",{className:"knobs"},u.a.createElement(f.a,{effectNumber:this.props.effectNumber,scrollContainer:this.props.scrollContainer,automation:this.props.automation,name:"Ratio",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.state.effect.ratioParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:20,min:1}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,scrollContainer:this.props.scrollContainer,name:"Knee",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.state.effect.kneeParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:40,min:0}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Attack",scrollContainer:this.props.scrollContainer,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.state.effect.attackParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:1,min:0}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Release",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.releaseParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,scrollContainer:this.props.scrollContainer,max:1,min:.15}))):"")}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(110);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Order",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.orderParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:1,max:100,min:1}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Low",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.lowParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:10,min:-10}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Mid",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.midParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:10,min:-10}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"High",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.highParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:10,min:-10}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Low Frequency",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.lowFrequencyParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:10,max:400,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"High Frequency",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.highFrequencyParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:10,max:1e4,min:1e3})):"")}}]),n}(c.Component);t.a=h},function(e,t,n){"use strict";var r=n(28),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=n(22);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var p=function(e){Object(o.a)(n,e);var t=h(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={effect:e.effect},r}return Object(i.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){var e,t,n,a,i,o,s,c;void 0!==this.props.automation||this.state.effect.isEnabled();return l.a.createElement("div",null,this.isEnabled()?l.a.createElement("div",null,l.a.createElement(f.a,(e={effectNumber:this.props.effectNumber,automation:this.props.automation,name:"31",unit:"db",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain31Parameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,step:.1,max:12,min:-12},Object(r.a)(e,"isParameter",!0),Object(r.a)(e,"lfoEnabled",!0),e)),l.a.createElement(f.a,(t={effectNumber:this.props.effectNumber,automation:this.props.automation,name:"63",sequencerEngine:this.props.sequencerEngine,unit:"db",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain63Parameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:12,min:-12},Object(r.a)(t,"isParameter",!0),Object(r.a)(t,"lfoEnabled",!0),t)),l.a.createElement(f.a,(n={effectNumber:this.props.effectNumber,automation:this.props.automation,name:"125",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain125Parameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,unit:"db",step:.1,max:12,min:-12,sequencerEngine:this.props.sequencerEngine},Object(r.a)(n,"isParameter",!0),Object(r.a)(n,"lfoEnabled",!0),n)),l.a.createElement(f.a,(a={effectNumber:this.props.effectNumber,automation:this.props.automation,name:"250",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain250Parameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,unit:"db",step:.1,max:12,min:-12,sequencerEngine:this.props.sequencerEngine},Object(r.a)(a,"isParameter",!0),Object(r.a)(a,"lfoEnabled",!0),a)),l.a.createElement(f.a,(i={effectNumber:this.props.effectNumber,automation:this.props.automation,name:"500",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,parameter:this.state.effect.gain500Parameter,onParameterChanged:this.props.onParameterChanged,unit:"db",isParameter:!0,step:.1,max:12,min:-12},Object(r.a)(i,"isParameter",!0),Object(r.a)(i,"lfoEnabled",!0),i)),l.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,name:"1k",unit:"db",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain1kParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,isParameter:!0,step:.1,max:12,min:-12}),l.a.createElement(f.a,(o={effectNumber:this.props.effectNumber,automation:this.props.automation,name:"2k",unit:"db",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,parameter:this.state.effect.gain2kParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:12,min:-12},Object(r.a)(o,"isParameter",!0),Object(r.a)(o,"lfoEnabled",!0),o)),l.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"4k",unit:"db",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain4kParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,isParameter:!0,step:.1,max:12,sequencerEngine:this.props.sequencerEngine,min:-12}),l.a.createElement(f.a,(s={effectNumber:this.props.effectNumber,automation:this.props.automation,name:"8k",unit:"db",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain8kParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:12,min:-12,sequencerEngine:this.props.sequencerEngine},Object(r.a)(s,"isParameter",!0),Object(r.a)(s,"lfoEnabled",!0),s)),l.a.createElement(f.a,(c={effectNumber:this.props.effectNumber,automation:this.props.automation,unit:"db",name:"16k",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain16kParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:12,min:-12,sequencerEngine:this.props.sequencerEngine},Object(r.a)(c,"isParameter",!0),Object(r.a)(c,"lfoEnabled",!0),c))):"")}}]),n}(u.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Rate",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.rateParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:20,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Feedback",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.feedbackParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:1,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Depth",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.depthParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.01,max:1,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Wet",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.wetParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:1,min:0})):"")}}]),n}(c.Component);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(110);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Filter Cutoff",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.baseFrequencyParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:10,max:1e4,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Octave",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.octaveParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:10,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Q",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.qParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1,max:10,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Sensitivity",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.sensitivityParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1,max:3,min:-30}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Attack",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.attackParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:4,min:.1}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Release",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.releaseParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:4,min:.1}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(110);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Distortion",parameter:this.state.effect.distortionParameter,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:1,min:0}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(110);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Bits",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.state.effect.bitsParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1,max:8,min:1}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22);n(110);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Drive",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.driveParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.01,root:3,max:32,min:.01})):"")}}]),n}(c.Component);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22),f=n(110);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Pitch",parameter:this.state.effect.pitchParameter,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:24,min:-24}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Window Size",parameter:this.state.effect.windowSizeParameter,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:.2,min:.03}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22);n(110);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Panning",parameter:this.state.effect.panningParameter,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:1,min:-1})):"")}}]),n}(c.Component);t.a=h},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(110),f=n(22);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Width",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.widthParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.01,max:1,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(c.Component);t.a=p},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(110),f=n(22),h=n(148);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.props.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",{className:"tape-row"},u.a.createElement("div",{className:"tape-column"},u.a.createElement(f.a,{effectNumber:this.props.effectNumber,name:"Rate",parameter:this.props.effect.rateParameter,onParameterChanged:this.props.onParameterChanged,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0,root:2,step:1e-4,min:0,max:1}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Feedback",lfoEnabled:!0,selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,unit:"%",parameter:this.props.effect.feedbackParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,displayFunction:function(e){return Math.floor(100*e)},step:.01,max:1,min:0}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Saturation",lfoEnabled:!0,selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,parameter:this.props.effect.driveParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:6,min:.1}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})),u.a.createElement("div",{className:"eq-knobs"},u.a.createElement(h.a,{name:"Low",min:-16,max:3,parameter:this.props.effect.lowEQParameter,scrollContainer:this.props.scrollContainer}),u.a.createElement(h.a,{name:"Mid",min:-16,max:3,parameter:this.props.effect.midEQParameter,scrollContainer:this.props.scrollContainer}),u.a.createElement(h.a,{min:-16,max:3,name:"Hi",parameter:this.props.effect.highEQParameter,scrollContainer:this.props.scrollContainer}))):"")}}]),n}(c.Component);t.a=d},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(110),f=n(22),h=n(39),p=n.n(h);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var m=function(e){Object(i.a)(n,e);var t=d(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={delayEffect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.delayEffect=e.effect,!0}},{key:"handleOptionChange",value:function(e){this.setState(this.state)}},{key:"handleFeedbackChange",value:function(e){this.state.delayEffect.setFeedback(e),this.setState(this.state)}},{key:"handleDelayTimeChange",value:function(e){"LEFT"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LEFT")?this.state.delayEffect.leftDelay.rate=e.value:this.state.delayEffect.rightDelay.rate=e.value,this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.delayEffect.isEnabled()}},{key:"onChangeSynced",value:function(e){document.activeElement.blur(),this.props.effect.isSynced="unsynced"===e,this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.props.effect,n=t.isSynced;void 0!==this.props.automation||t.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"refined-checkbox-preferences lfo-synced-checkbox"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:n?"synced":"unsynced",checked:n,onChange:function(t){return e.onChangeSynced(t.target.value)}}),"Synced")),n?u.a.createElement("div",null,u.a.createElement("div",{className:"lfo-rate-dropdown"},u.a.createElement("div",{className:"lfo-rate-label"},"Left Rate:"),u.a.createElement(p.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:v,onChange:function(t){return e.handleDelayTimeChange(t,"LEFT")},value:b(this.props.effect.leftDelay.rawDelayRate),placeholder:"Rate"}),u.a.createElement("div",{className:"clear-fix"})),u.a.createElement("div",{className:"lfo-rate-dropdown"},u.a.createElement("div",{className:"lfo-rate-label"},"Right Rate:"),u.a.createElement(p.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:v,onChange:function(t){return e.handleDelayTimeChange(t,"RIGHT")},value:b(this.props.effect.rightDelay.rawDelayRate),placeholder:"Rate"}),u.a.createElement("div",{className:"clear-fix"}))):u.a.createElement("div",null,u.a.createElement(f.a,{effectNumber:this.props.effectNumber,name:"Left Rate",parameter:this.state.delayEffect.leftDelay.rateParameter,onParameterChanged:this.props.onParameterChanged,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0,step:1,min:1,max:1e3}),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,name:"Right Rate",parameter:this.state.delayEffect.rightDelay.rateParameter,onParameterChanged:this.props.onParameterChanged,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0,step:1,min:1,max:1e3})),u.a.createElement(f.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Feedback",lfoEnabled:!0,selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,unit:"%",parameter:this.state.delayEffect.feedbackParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,displayFunction:function(e){return Math.floor(100*e)},step:.01,max:1,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.delayEffect})):"")}}]),n}(c.Component),v=[{value:"1n",label:"1"},{value:"2n",label:"1/2"},{value:"4n",label:"1/4"},{value:"4t",label:"1/4t"},{value:"8n",label:"1/8"},{value:"8n.",label:"1/8."},{value:"8t",label:"1/8t"},{value:"16n",label:"1/16"},{value:"16t",label:"1/16t"},{value:"32n",label:"1/32"}];function b(e){var t=v.filter(function(t){return t.value===e});return 0==t.length?"16n":t[0]}t.a=m},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=(n(22),n(249));function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(l.a,{isDraggable:this.props.isDraggable,track:this.props.track,scrollContainer:this.props.scrollContainer,send:this.props.send,compact:this.props.compact,sequencerEngine:this.props.sequencerEngine,effect:this.state.effect})):"")}}]),n}(c.Component);t.a=h},,function(e,t,n){"use strict";var r=n(99),a=n(0),i=n.n(a),o=n(239),s=n(280),c=n(95),u=(n(1547),n(12));function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=new(n(29).a),p=window.factor||2,d=Object(a.memo)(function(e){var t=e.leafDetails,n=e.WIDTH,u=void 0===n?280:n,f=e.HEIGHT,d=void 0===f?280:f,m=e.setLeafDetails,v=e.FULL_RADIUS,b=void 0===v?u/2*.95:v,g=e.isScript,y=e.backgroundColor,k=e.color,O=e.tidals,j=e.fillColor,w=e.dotColor,E=e.radius,S=void 0===E?b:E,P=Object(r.a)(e,["leafDetails","WIDTH","HEIGHT","setLeafDetails","FULL_RADIUS","isScript","backgroundColor","color","tidals","fillColor","dotColor","radius"]),x=(O=O.filter(function(e){return e.inUse||e.lastUsed<1})).length,T=Object(a.useRef)(void 0),C=Object(a.useRef)([]),N=Object(a.useRef)(void 0);Object(a.useEffect)(function(){N.current=T.current.getContext("2d"),M()},[]),Object(a.useEffect)(function(){N.current&&N.current.scale(window.devicePixelRatio,window.devicePixelRatio)},[u,d]);var R=u/2;Object(a.useEffect)(function(){N.current&&(6===O.length||g)&&window.requestAnimationFrame(M)},[P,R,w,t,O,j,u,d,S]);var M=Object(a.useCallback)(function(){var e=N.current;e.clearRect(0,0,u,d),C.current=[];for(var t=void 0,n=0;n<O.length;n++){var r=O[n],a=r.cycle,i=t||Math.max(10,S-12*p*n);if(0===n&&(e.beginPath(),e.arc(R,R,i,0,2*Math.PI),e.fillStyle=y,e.fill(),e.closePath()),!P.sequencerEngine||P.sequencerEngine.tracks[n])for(var o=a,s=o.length,c=0;c<o.length;c++){var l=o[c];Array.isArray(l)&&(l=l[0]);var f=P.sequencerEngine&&P.sequencerEngine.tracks[n];if(!P.sequencerEngine||f){var h=A(e,c,s,a,i,{x:R,y:R},l);h&&(t=h)}l.type&&"-"===l.type.type&&0===l.type.value&&q(e,l,c,i,a,s),D(e,l,c,i,a,n,s,r)}}},[k,R,y,O,x,t,j,S,u,d]),A=Object(a.useCallback)(function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{x:R,y:R},u=arguments.length>6?arguments[6]:void 0;arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(null!==u.transpose){var l=I(t,i,a,r),f=I((t+1)%n,i,a,r),h=I((t+2)%n,i,a,r),p=I((t+3)%n,i,a,r),d=I(Object(c.a)(t-3,n),i,a,r),m=I(Object(c.a)(t-2,n),i,a,r),v=I(Object(c.a)(t-1,n),i,a,r),b=l,g=Object(s.a)(l,p,f,m),y=Object(s.a)(v,h,m,f),O=Object(s.a)(l,d,h,v);return e.beginPath(),e.lineWidth=1,e.moveTo(b.x,b.y),e.lineTo(g.x,g.y),e.lineTo(y.x,y.y),e.lineTo(O.x,O.y),e.closePath(),e.fillStyle=j,e.fill(),e.strokeStyle=k,e.stroke(),Object(o.c)({x:R,y:R},y)}},[R,S,u,d,j,k]),q=Object(a.useCallback)(function(e,t,n,r,a,i){var o={x:R,y:R},u=I(n,o,r,a),l=I((n+1)%i,o,r,a),f=(I((n+2)%i,o,r,a),I((n+3)%i,o,r,a)),h=(I(Object(c.a)(n-3,i),o,r,a),I(Object(c.a)(n-2,i),o,r,a)),p=(I(Object(c.a)(n-1,i),o,r,a),Object(s.a)(u,f,l,h));e.lineWidth=1,e.beginPath(),e.moveTo(u.x,u.y),e.lineTo(p.x,p.y),e.lineTo(l.x,l.y),e.closePath(),e.fillStyle=j,e.fill(),e.strokeStyle=k,e.stroke()},[R,S,d,u,j,k]),D=function(e,t,n,r,a,i,o,s){},I=(Object(a.useCallback)(function(e,t,n){var r=w,a=5*t;return null===e.transpose?{fill:h.transparent(h.saturate(y,1)),stroke:r,radius:a}:{fill:r,radius:a}},[w,y,S]),Object(a.useCallback)(function(e,t,n,r){e*=1;r.flat(16);var a=r.length,i=2*Math.PI*e/a-.5*Math.PI;return{x:t.x+n*Math.cos(i),y:t.y+n*Math.sin(i),deg:i}},[R,S,u,d])),_=Object(a.useCallback)(function(e){var t,n=T.current.getBoundingClientRect(),r=Math.round(2*(e.clientX-n.left)),a=Math.round(2*(e.clientY-n.top)),i=l(C.current);try{for(i.s();!(t=i.n()).done;){var o=t.value,s=o.leaf,c=o.path;if(N.current.isPointInPath(c,r,a)){m(s);break}}}catch(u){i.e(u)}finally{i.f()}},[m]);return i.a.createElement("canvas",{onMouseDown:_,className:"tidal-art structure",style:{width:u,height:d},width:u*window.devicePixelRatio,height:d*window.devicePixelRatio,ref:T})});t.a=Object(u.b)(function(e,t){var n={};return t.tidals.forEach(function(e){n["cycle"+e.id]=e.cycle}),n},function(e){return{}})(d)},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(634),s=(n(274),n(1055)),c=n(83),u=n(59),l=(n(39),n(38)),f=n(46),h=n(22),p=(n(6),n(12));t.a=Object(p.b)(function(e,t){return{cycle:t.effect.cycle}},null)(function(e){var t=Object(a.useRef)(void 0),n=Object(a.useState)(e.effect.cycleString),p=Object(r.a)(n,2),d=p[0],m=p[1],v=Object(a.useState)(!1),b=Object(r.a)(v,2),g=b[0],y=b[1],k=Object(a.useState)(!1),O=Object(r.a)(k,2),j=O[0],w=O[1];Object(a.useEffect)(function(){m(Object(c.e)(e.cycle))},[m,e.cycle]);var E=Object(a.useCallback)(function(e){"Enter"===e.key&&S()},[d,e.effect,w]),S=Object(a.useCallback)(function(){var t=Object(c.g)(d);t&&t.length>0?e.sequencerEngine.operationManager.dispatch(Object(f.v)(e.effect.cycleParameter,t)):(y(!0),setTimeout(function(){y(!1)},1e3)),w(!1)},[e.effect,y,d,w]),P=Object(a.useCallback)(function(t){t.target.value,document.activeElement.blur(),e.effect.cycleRetrigger=!e.effect.cycleRetrigger},[e.effect]);return i.a.createElement("div",{ref:t},i.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},draggable:!0,onDragStart:function(e){return e.preventDefault()},className:"tidal-component"},!j&&i.a.createElement(o.a,{tidal:e.effect}),i.a.createElement(u.g,{value:d,onKeyDown:E,onChange:function(e){w(!0),m(e.target.value)},placeholder:"Output Note",className:"tidal-input"}),i.a.createElement("div",{className:"enter-button",onClick:S},"Enter")),i.a.createElement(l.a,{condition:g},i.a.createElement("div",{className:"error-box"},"Syntax Error")),!e.noUI&&i.a.createElement(s.a,{effect:e.effect}),!e.noUI&&i.a.createElement("div",{className:"tidal-parameters"},i.a.createElement(h.a,{effectNumber:e.effectNumber,name:"Cycle Length",parameter:e.effect.cycleLengthParameter,automation:e.automation,onParameterChanged:e.onParameterChanged,isParameter:!0,sequencerEngine:e.sequencerEngine,lfoEnabled:!0,step:1,min:4,max:64}),i.a.createElement(h.a,{effectNumber:e.effectNumber,name:"Speed Factor",parameter:e.effect.lengthFactorParameter,automation:e.automation,onParameterChanged:e.onParameterChanged,isParameter:!0,sequencerEngine:e.sequencerEngine,lfoEnabled:!0,step:.5,min:.5,max:4}),i.a.createElement(h.a,{effectNumber:e.effectNumber,name:"Duration Factor",parameter:e.effect.durationFactorParameter,automation:e.automation,onParameterChanged:e.onParameterChanged,isParameter:!0,sequencerEngine:e.sequencerEngine,lfoEnabled:!0,step:.01,min:.1,max:4}),e.effect.variables.map(function(t){return i.a.createElement(h.a,{name:t.name,min:t.min,max:t.max,step:1,parameter:t,lfoEnabled:!0,sequencerEngine:e.sequencerEngine,isParameter:!0,effectNumber:e.effectNumber})})),!e.noUI&&i.a.createElement("div",{className:"refined-checkbox-preferences"},i.a.createElement("label",null,i.a.createElement("input",{type:"checkbox",value:"reversed",checked:e.effect.cycleRetrigger,onChange:P}),"Cycle Retrigger")))})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(249),s=n(12);t.a=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,s=e.track,c=Object(a.useState)(1),u=Object(r.a)(c,2),l=u[0],f=u[1],h=t.rules[l-1];return i.a.createElement("div",{className:"rules-screen"},i.a.createElement(o.a,{effect:h,track:s,sequencerEngine:n}),i.a.createElement("div",{className:"rules-chooser"},t.rules.map(function(e,t){return i.a.createElement("div",{onClick:function(){return f(t+1)},className:t+1===l?"selected rule":"rule"},t+1)})))})},function(e,t,n){"use strict";var r=n(0),a=n(12);t.a=Object(a.b)(function(e,t){var n=e.spatial.presentationMode||t.isInstrumentView;return{presentationMode:n,coords:n&&e.windows.presentationWindowPositions[t.zobject.id]||e.windows.windowPositions[t.zobject.id]}},function(e){return{}})(function(e){var t=e.windowRef,n=e.coords;e.isInstrumentView,e.presentationMode,e.zobject;return Object(r.useEffect)(function(){n&&(t.current.style.left=n.x+"px",t.current.style.top=n.y+"px")},[n]),""})},,function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(11),o=n(103),s=(n(1556),n(12)),c=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.transformation,n=(e.track,t.thenType),r=t.whenType,i=o.q.find(function(e){return e.value===r}),s=t.whenValue.get(),c=t.auxValue.get(),u=o.o.find(function(e){return e.value===n}),l=t.thenValue.get();return a.a.createElement("div",{className:"transformation-tooltip"},a.a.createElement("div",{className:"when-type"},i&&i.label),r===o.g?a.a.createElement("div",{className:"when-value"},c,"%"):a.a.createElement("div",{className:"when-value"},s," ",t.whenType===o.c?"loops":t.whenType===o.k?"%":""),a.a.createElement("div",{className:"arrow-right"}),a.a.createElement("div",{className:"then-type"},u&&u.label),a.a.createElement("div",{className:"then-value"},o.i.includes(n)?l:""))}),u=n(9);function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=n(29),p=new h.a;window.groupOpacity=.5;var d=n(178),m=n(6),v=(new h.a,Object(s.b)(function(e,t){return{selectedPianoRollSteps:e.keyboard.selectedPianoRollSteps,numTransformations:t.group.transformations.length}},function(e){return{setSelectedPianoRollSteps:function(t){return e(Object(m.jf)(t))},setTransformationEdgeDragging:function(t){return e(Object(m.sh)(t))},setStepsGroupMode:function(t){return e(Object(m.Dg)(t))}}})(function(e){var t=e.setTransformationEdgeDragging,n=e.trackSteps,s=e.group,f=e.track,h=e.setSelectedPianoRollSteps,m=e.selectedPianoRollSteps,v=e.setStepsGroupMode,b=(e.showEffects,e.container),g=e.scale,y=function(e){var t=e.container,n=e.group,a=e.track,o=e.trackSteps,s=e.scale,c=void 0===s?1:s;0===c&&(c=1);var f=Object(r.useState)(void 0),h=Object(i.a)(f,2),p=h[0],d=h[1],m=Object(r.useRef)(0);return Object(r.useEffect)(function(){if(t.current){var e=++m.current;setTimeout(function(){if(e===m.current){var r,a=[],i=l(n.steps);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=document.getElementById("stepdata-"+o.id);if(s){var f=s.getBoundingClientRect();a.push(f)}}}catch(k){i.e(k)}finally{i.f()}var h=Math.min.apply(Math,Object(u.a)(a.map(function(e){return e.left}))),p=Math.max.apply(Math,Object(u.a)(a.map(function(e){return e.left}))),v=Math.min.apply(Math,Object(u.a)(a.map(function(e){return e.top}))),b=Math.max.apply(Math,Object(u.a)(a.map(function(e){return e.top})));if(t.current){var g=t.current.getBoundingClientRect(),y={x:1/c*(h-g.left-4),y:1/c*(v-g.top+3),height:b-v+18,width:p-h+30};d(y)}}},75)}},[d,n,a,o]),{pos:p}}({container:b,group:s,track:f,trackSteps:n,scale:g}).pos,k=function(e){var t=e.pos,n=e.group,r=e.selectedPianoRollSteps,a={};t&&(a={left:t.x,top:t.y-5,height:t.height,width:t.width,backgroundColor:p.transparent(p.saturate(p.getColorForHash(n.id),1.1),window.groupOpacity)}),void 0===a.left&&(a.height=0);var i=r&&r.some(function(e){return e.group===n}),o="steps-group";return i&&(o+=" selected"),{style:a,selected:i,className:o}}({group:s,pos:y,selectedPianoRollSteps:m}),O=k.style,j=k.className,w=k.selected,E=function(e){var t=e.setTransformationEdgeDragging,n=e.track;return{startDragging:Object(r.useCallback)(function(e){t({transformation:e})},[]),endDragging:Object(r.useCallback)(function(e){var r=n.sequencerEngine.state.groups.transformationEdgeDragging;if(r){var a=r.transformation;a!==e?(e.whenType=o.g,e.whenValue.set(a.id),n.updateSteps(),t(void 0)):t(void 0)}},[n])}}({track:f,setTransformationEdgeDragging:t}),S=E.startDragging,P=E.endDragging,x=function(){var e=Object(r.useState)(void 0),t=Object(i.a)(e,2),n=t[0],a=t[1],o=Object(r.useRef)(!1);return{showTooltip:n,onMouseOver:Object(r.useCallback)(function(e,t){o.current=t,setTimeout(function(){o.current===t&&a(t)},250)},[a]),onMouseLeave:Object(r.useCallback)(function(e,t){o.current=!1,a(void 0)},[a])}}(),T=x.showTooltip,C=(x.setShowTooltip,x.onMouseOver),N=x.onMouseLeave,R=Object(r.useCallback)(function(){h(w?[]:s.steps),v(!0)},[w]);return Object(r.useEffect)(function(){return function(){(f.isEffectsShowing()||f.isHidden())&&v(!1)}},[]),a.a.createElement("div",{id:"steps-group-"+s.id,onClick:R,style:O,className:j},isNaN(O.left)?"":a.a.createElement("span",{className:"group-name"},s.name.split(" ")[1]),isNaN(O.left)?"":a.a.createElement("div",{className:"transformations"},s.transformations.map(function(e){return a.a.createElement("div",{key:e.id,className:"transformation-wrapper",onMouseOver:function(t){return C(t,e)},onMouseLeave:N},a.a.createElement("div",{onMouseUp:function(){P(e),R()},onMouseDown:function(){return S(e)},id:"transformation-"+e.id,className:Object(d.i)(e)?"transforming transformation":"transformation"}),T===e?a.a.createElement(c,{track:f,transformation:e}):"")})))})),b=(n(2559),Object(s.b)(function(e,t){return{stepsGroupMode:e.groups.stepsGroupMode,trackSteps:e.tracks.trackSteps[t.track.trackNumber],stepGroups:e.steps.stepGroups}},function(e){return{}})(function(e){var t=e.trackSteps,n=e.track,i=e.stepsGroupMode,o=e.scale,s=void 0===o?1:o,c=Object(r.useRef)(void 0);if(!i)return[];var u=n.pattern.getAllGroups();return a.a.createElement("div",{ref:c,className:"track-step-groups"},u.map(function(e){return a.a.createElement(v,{scale:s,container:c,key:e.id,trackSteps:t,group:e,track:n})}))})),g=n(698),y=n(885),k=n(28),O=n(166),j=Object(s.b)(function(e,t){return{resolution:e.sequencer.displayResolution,size:e.tracks.trackLengthChoice}},function(e){return{setSize:function(t){return e(Object(m.Yg)(t))}}})(function(e){var t=e.resolution,n=(e.resizable,e.rowLength,e.color),i=e.track,o=e.row,s=e.setSize,c=e.size,u=Object(r.useRef)(void 0),l={backgroundColor:n,width:528};Object(r.useEffect)(function(){s(i.pattern.length(t))},[t]);var f=new Array(16).fill(0);return a.a.createElement("div",{ref:u,style:l,className:"track-length-bar"},f.map(function(e,t){return a.a.createElement("div",{onClick:function(){return s(16*o+t+1)},className:c===16*o+t+1?"length-option selected":c<16*o+t+1?"length-option disabled":"length-option"},16*o+t+1)}))}),w=n(338),E=n(2),S=n(4),P=n(7),x=n(10),T=n(1),C=n(77);function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(T.a)(e);if(t){var a=Object(T.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(x.a)(this,n)}}var R=function(e){Object(P.a)(n,e);var t=N(n);function n(){return Object(E.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"render",value:function(){var e=this.props.currentStep,t=(this.props.isMini?20:32)*e,n=(Math.floor(e/4),{width:t+(this.props.isMini?15:30)});return a.a.createElement("div",{className:"steps-row-bottom"},void 0!==e?a.a.createElement("div",{style:n,className:"current-step-box"},a.a.createElement("div",{className:"right-box"})):"")}}]),n}(r.Component),M=Object(s.b)(function(e,t){var n=t.sequencerEngine.getSequenceId(),r=e.tracks.trackSteps[t.track.id]?e.tracks.trackSteps[t.track.id].length:16,a=e.sequencer.currentGlobalStep[n]||0,i=t.track.getPatternStep(a,!1),o=Math.floor(i/(C.a.baseResolution.numSteps()/e.sequencer.displayResolution.numSteps()));o%=r;var s=t.chunk*t.stepsInRow,c=(t.chunk+1)*t.stepsInRow;return{currentStep:o>=s&&o<c?o%t.stepsInRow:void 0}},null)(R),A=n(76),q=n(46),D=n(439),I=n(383),_=new h.a,F=n(61),L=n(38),B=n(63),z=(n(15),function(e){var t=e.palette,n=e.selectedPalette,r=e.onChoosePalette,i="palette-option";t===n&&(i+=" selected");var o={backgroundColor:I.a[t]};return a.a.createElement("div",{style:o,onClick:function(){return r(t===n?void 0:t)},className:i},t+1)}),V=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.stepData,o=Object(r.useState)(n.palette),s=Object(i.a)(o,2),c=s[0],u=s[1],l=t.track.sequencerEngine,f=Object(r.useCallback)(function(e){l.operationManager.dispatch(Object(q.w)(t.track,n,n.paletteParameter,e)),u(e)},[u,n]);return a.a.createElement("div",{className:"palettes-container"},t.palettes.map(function(e){return a.a.createElement(z,{onChoosePalette:f,palette:e,selectedPalette:c})}))}),H=n(89),U=n(90),J=n.n(U),G=n(205),W=n(897),K=n(997),X=n(637),Q=n(630),Y=n(631),Z=n(69);n(2560),n(1409);function $(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(T.a)(e);if(t){var a=Object(T.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(x.a)(this,n)}}var ee=new h.a,te=function(e){Object(P.a)(n,e);var t=$(n);function n(e){var r;return Object(E.a)(this,n),(r=t.call(this,e)).state={showMoreParameters:!1,refined:!1},r}return Object(S.a)(n,[{key:"effectToShow",get:function(){return void 0===this.props.showStepOptions?void 0:this.props.showStepOptions.effect}},{key:"showOption",get:function(){return void 0===this.props.showStepOptions?void 0:this.props.showStepOptions.option}},{key:"hasMidiFX",value:function(){return this.props.track.midiEffects.effects.length>0}},{key:"hasInstrument",value:function(){return void 0!==this.props.track.instrument}},{key:"onClickMore",value:function(){this.setState({showMoreParameters:!this.state.showMoreParameters})}},{key:"shouldBeRefined",value:function(){return this.props.stepData.duration%1!==0||this.props.stepData.transpose%1!==0}},{key:"onChangeRefined",value:function(e){var t="refined"===e;document.activeElement.blur(),this.setState({refined:t})}},{key:"onChangeDuration",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(q.w)(this.props.track,this.props.stepData,this.props.stepData.durationParameter,e)),this.setState(this.state)}},{key:"onChangeChop",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(q.w)(this.props.track,this.props.stepData,this.props.stepData.chopParameter,e)),this.state.chop=e,this.setState(this.state)}},{key:"onChangeParameter",value:function(e,t){this.props.sequencerEngine.operationManager.dispatch(Object(q.w)(this.props.track,this.props.stepData,e,t))}},{key:"onChangeChopDuration",value:function(e){this.props.stepData.chopDuration=e,this.state.chopDuration=e,this.setState(this.state)}},{key:"onChangeTranspose",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(q.w)(this.props.track,this.props.stepData,this.props.stepData.transposeParameter,e)),this.state.transpose=e,this.setState(this.state)}},{key:"onChangeReversed",value:function(e,t){this.props.stepData.reverse=!t.reverse,document.activeElement.blur(),this.setState(this.state)}},{key:"onChangeVelocity",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(q.w)(this.props.track,this.props.stepData,this.props.stepData.velocityParameter,e)),this.state.velocity=e,this.setState(this.state)}},{key:"onChangeSlice",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(q.w)(this.props.track,this.props.stepData,this.props.stepData.sliceParameter,e)),this.state.slice=e,this.setState(this.state)}},{key:"effects",get:function(){return this.props.track.effectsChains[this.props.effectsChain].effects}},{key:"onClickFX",value:function(){this.effects.length>0&&this.props.setShowStepOptions("AUDIO_FX",0)}},{key:"onClickInstrument",value:function(){return this.props.setShowStepOptions("INSTRUMENT",0)}},{key:"onClickMidiFX",value:function(){this.props.setShowStepOptions("MIDI_FX",0)}},{key:"onClickNextFX",value:function(){var e="MIDI_FX"===this.showOption?this.midiFX:this.effects;if(e.length>0){var t=(this.effectToShow+1)%e.length;this.props.setShowStepOptions(this.showOption,t)}}},{key:"onClickBack",value:function(){this.props.setShowStepOptions(void 0)}},{key:"onChangePanning",value:function(e){this.props.stepData.panning=e,this.state.panning=e,this.setState(this.state)}},{key:"getParametersToShow",value:function(e){var t=this,n=this.state.refined?.01:1,r=this.state.refined?2:64,i=this.props.isMidi?B.a.middleC.transpose(e.transpose).toString():e.transpose,o=this.state.refined?.01:1;if(this.state.showMoreParameters)return a.a.createElement("div",null,a.a.createElement(ne,{label:"Attack",labelValue:e.attack,value:e.attack,min:0,step:1,max:4e3,onChange:function(e){return t.onChangeParameter(t.props.stepData.attackParameter,e)}}),a.a.createElement(ne,{label:"Release",labelValue:e.release,value:e.release,min:0,step:1,max:6e3,onChange:function(e){return t.onChangeParameter(t.props.stepData.releaseParameter,e)}}),a.a.createElement(ne,{label:"Pitch Attack",labelValue:e.pitchAttack,value:e.pitchAttack,min:0,step:1,max:6e3,onChange:function(e){return t.onChangeParameter(t.props.stepData.pitchAttackParameter,e)}}),a.a.createElement(ne,{label:"Pitch Decay",labelValue:e.pitchDecay,value:e.pitchDecay,min:0,step:1,max:6e3,onChange:function(e){return t.onChangeParameter(t.props.stepData.pitchDecayParameter,e)}}),a.a.createElement(ne,{label:"Pitch Sustain",labelValue:e.pitchSustain,value:e.pitchSustain,min:-10,step:.01,max:10,onChange:function(e){return t.onChangeParameter(t.props.stepData.pitchSustainParameter,e)}}),a.a.createElement(ne,{label:"Pitch Release",labelValue:e.pitchRelease,value:e.pitchRelease,min:0,step:1,max:8e3,onChange:function(e){return t.onChangeParameter(t.props.stepData.pitchReleaseParameter,e)}}));var s=null===e.panning?this.props.track.getPanning():e.panning;return a.a.createElement("div",null,a.a.createElement(ne,{label:"Duration",labelValue:e.duration,value:e.duration,min:n,step:o,max:r,onChange:function(e){return t.onChangeDuration(e)}}," "),a.a.createElement(ne,{label:"Chop",labelValue:e.chop,value:e.chop,min:1,step:1,max:64,onChange:function(e){return t.onChangeChop(e)}}," "),a.a.createElement(ne,{label:"Slice",labelValue:e.slice+1,isSlice:!0,value:e.slice,min:0,step:1,max:this.props.slices-1,onChange:function(e){return t.onChangeSlice(e)}}," "),a.a.createElement(ne,{label:"Transpose",labelValue:i,value:e.transpose,min:-23,max:23,step:1,onChange:function(e){return t.onChangeTranspose(e)}}," "),a.a.createElement(ne,{label:"Velocity",labelValue:e.velocity,value:e.velocity,min:0,max:1,step:.1,onChange:function(e){return t.onChangeVelocity(e)}}," "),a.a.createElement(ne,{label:"Pan",labelValue:s,value:s,min:-1,max:1,step:.1,onChange:function(e){return t.onChangePanning(e)}}," "))}},{key:"getCheckboxes",value:function(e){var t=this;return a.a.createElement("div",null,a.a.createElement("div",{className:"reverse-parameter"},a.a.createElement("form",null,a.a.createElement("div",{className:"refined-checkbox"},a.a.createElement("label",null,a.a.createElement("input",{type:"checkbox",value:"reversed",checked:e.reverse,onChange:function(n){return t.onChangeReversed(n.target.value,e)}}),"Reverse")))),a.a.createElement("div",{className:"refined-parameter"},a.a.createElement("form",null,a.a.createElement("div",{className:"refined-checkbox"},a.a.createElement("label",null,a.a.createElement("input",{type:"checkbox",value:"refined",checked:this.state.refined,onChange:function(e){return t.onChangeRefined(e.target.value)}}),"Refine")))))}},{key:"getPalettes",value:function(){var e=this.props.track.liveEffects.effects.find(function(e){return e.effect===H.d});return void 0===e?[]:a.a.createElement(V,{effect:e,stepData:this.props.stepData})}},{key:"midiFX",get:function(){return this.props.track.midiEffects.effects}},{key:"effectExists",value:function(e){return"MIDI_FX"===this.showOption?void 0!==this.midiFX[e]:void 0!==this.effects[e]}},{key:"render",value:function(){var e=this,t=this.props.track.getStepDataForStep(this.props.stepData,!0);return"INSTRUMENT"===this.showOption&&this.hasInstrument()||"MIDI_FX"===this.showOption&&this.hasMidiFX()||"AUDIO_FX"===this.showOption&&this.effects.length>0?a.a.createElement("div",null,this.getEffectOrInstrument(),a.a.createElement("div",{className:"effects-parameters-button-container"},a.a.createElement(L.a,{condition:"AUDIO_FX"===this.showOption||"MIDI_FX"===this.state.showOption},a.a.createElement("div",{onClick:function(){return e.onClickNextFX()},className:"small-button pink-button float-right"},"NEXT")),a.a.createElement("div",{onClick:function(){return e.onClickBack()},className:"small-button pink-button float-right"},"BACK"))):a.a.createElement("div",null,this.getParametersToShow(t),this.getPalettes(t),this.getCheckboxes(t),a.a.createElement("div",{className:"effects-parameters-button-container"},a.a.createElement("div",{onClick:function(){return e.onClickMore()},className:"small-button pink-button float-right"},this.state.showMoreParameters?"BACK":"MORE")))}},{key:"getEffectOrInstrument",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.effectToShow,n="MIDI_FX"===this.showOption?this.props.track.midiEffects.effects[t]:this.effects[t];if("MIDI_FX"===this.showOption&&this.effectExists(t))return a.a.createElement(G.a,{onEffectsChange:function(){return e.props.track.updateEffects()},sequencerEngine:this.props.sequencerEngine,effect:n,track:this.props.track,effectNumber:t,automation:this.props.stepData.effectAutomations});if("AUDIO_FX"===this.showOption&&this.effectExists(t))return a.a.createElement(W.a.EffectComponent,{onEffectsChange:function(){return e.props.track.updateEffects()},sequencerEngine:this.props.sequencerEngine,effect:n,track:this.props.track,effectNumber:t,automation:this.props.stepData.effectAutomations});if("INSTRUMENT"===this.showOption&&this.hasInstrument()){var r=this.props.track.instrument.getInstrumentType();if(r===Z.i)return a.a.createElement(Y.a,{track:this.props.track,automation:this.props.stepData.effectAutomations,instrument:this.props.track.getInstrument()});if(r===Z.f)return a.a.createElement(K.a,{sequencerEngine:this.props.sequencerEngine,track:this.props.track,automation:this.props.stepData.effectAutomations,instrument:this.props.track.getInstrument()});if(r===Z.c)return a.a.createElement(X.a,{sequencerEngine:this.props.sequencerEngine,track:this.props.track,automation:this.props.stepData.effectAutomations,instrument:this.props.track.getInstrument()});if(r===Z.e)return a.a.createElement(Q.a,{sequencerEngine:this.props.sequencerEngine,automation:this.props.stepData.effectAutomations,track:this.props.track,instrument:this.props.track.getInstrument()})}return""}}]),n}(r.Component),ne=function(e){Object(P.a)(n,e);var t=$(n);function n(e){return Object(E.a)(this,n),t.call(this,e)}return Object(S.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.value!==e.value||this.props.step!==e.step}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"step-parameter"},a.a.createElement("div",{className:"parameter-label"},this.props.label,": ",Math.round(10*this.props.labelValue)/10),this.props.isSlice?a.a.createElement("div",{style:{backgroundColor:ee.getColor(this.props.labelValue-1)},className:"slice-indicator"}):"",a.a.createElement(J.a,{value:this.props.value,change:function(t){return e.props.onChange(t.target.value)},step:this.props.step,max:this.props.max,min:this.props.min,orientation:"horizontal",reversed:!1}))}}]),n}(r.Component),re=(Object(s.b)(function(e,t){var n=t.track.trackNumber;return{effectsChain:e.tracks.trackEffectsChain[n]||0,showStepOptions:e.steps.showStepOptions}},function(e){return{setShowStepOptions:function(t,n){return e(Object(m.gg)(t,n))}}})(te),n(33)),ae=n(34);function ie(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(T.a)(e);if(t){var a=Object(T.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(x.a)(this,n)}}var oe=new h.a;window.factorFill=.9;var se=function(e){Object(P.a)(n,e);var t=ie(n);function n(e){return Object(E.a)(this,n),t.call(this,e)}return Object(S.a)(n,[{key:"brighten",value:function(e,t){var n=Math.min(255,Math.floor(parseInt(e.slice(1,3),16)*t)),r=Math.min(255,Math.floor(parseInt(e.slice(3,5),16)*t)),a=Math.min(255,Math.floor(parseInt(e.slice(5),16)*t));return n=n.toString(16),r=r.toString(16),a=a.toString(16),1===n.length&&(n="0"+n),1===r.length&&(r="0"+r),1===a.length&&(a="0"+a),"#"+n+r+a}},{key:"render",value:function(){var e=this,t={};if(this.props.fill){t={backgroundColor:oe.brighten(oe.getColorForTrack(this.props.track),window.factorFill)}}this.props.stepData&&this.props.on&&this.props.stepData.duration<1&&(t.width=30*this.props.stepData.duration);var n="fill ";return this.props.isCurrentStep&&(n+=" current-step"),this.props.isCursor&&(n+=" cursor"),this.props.on&&(n+=" on"),a.a.createElement("div",{onMouseDown:function(t){return e.props.onMouseDown(t)},onMouseUp:function(t){return e.props.onMouseUp(t)},style:t,className:n})}}]),n}(r.Component),ce=new h.a,ue=new re.a(16,!1),le=new F.a;window.pianoRoll=7;var fe=Object(r.memo)(function(e){var t=ce.getColorForTrack(e.track),n=Object(r.useRef)(void 0),i=e.sequencerEngine.store.getState().tracks.trackStepIds[e.track.id],o=i&&i[e.stepNumber];void 0!==o&&o.on||(o=le);var s=function(e,t){return!(void 0===e.selectedSteps||!e.on||e.showParameters||void 0===t)&&e.selectedSteps.filter(function(e){return void 0!==e&&e.id===t.id}).length>0}(e,o),c=function(e){var t=e.stepsSelection;return void 0!==t&&e.stepNumber>=t.fromStep&&e.stepNumber<=t.toStep}(e),u=function(e,t,n,r,a){var i={},o="step ";if(a.group&&(r=_.getColorForHash(a.group.id)),e.on){if(o+="on ",i.backgroundColor=r,!e.showParameters)if(0===e.velocity||e.velocity){var s=.7*e.velocity+.3;i.opacity=s}else i.opacity=1}else o+="off ";e.isAlternateColor&&(o+=" alternate "),t?(o+=" selected ",i.borderColor=r,i.backgroundColor=_.brighten(r,.4)):e.isCurrentStep&&e.isCursor?o+=" cursor ":e.isCurrentStep?o+=" current-step ":e.isCursor&&(o+=" cursor "),e.viMode&&(o+=" vi-mode"),e.on&&!t&&(a.trackData&&void 0!==a.palette&&null!==a.palette?(i.borderBottomColor=I.a[a.palette],i.borderBottomWidth="5px"):0!==a.slice&&(i.borderBottomColor=_.getColor(a.slice),i.borderBottomWidth="5px",i.borderBottomStyle="solid")),a.pLockedParameters.length>0&&(o+=" p-locked"),e.showParameters||(o+=" not-expanded"),o+=n?" selection ":"";var c=Object(D.a)(e.resolution);c>2&&e.stepNumber%c===0&&(o+=" beat-division");var u="step-container";return n&&(u+=" selection"),{className:o,style:i,containerClassName:u}}(e,s,c,t,o),l=u.className,f=u.style,h=u.containerClassName,p=Object(r.useCallback)(function(t){if(!e.showParameters){if(e.mouseDown(!0),e.sequencerEngine.select(e.trackNumber,e.stepNumber,e.track),s)e.setStepNumberDraggingFrom(e.stepNumber);else if(t.metaKey||t.ctrlKey||!e.on)e.setSelectedSteps(void 0),e.setStepsSelection(e.trackNumber,e.stepNumber,e.stepNumber);else{e.setSelectedSteps(void 0);var n=e.sequencerEngine.state.tracks.trackStepIds[e.track.id]||{};e.setSingleStepToDrag(n[e.stepNumber]),e.setStepNumberDraggingFrom(e.stepNumber)}e.setStepNumberDraggingFrom(e.stepNumber)}},[s,e.showParameters,o,e.on,e.stepNumber,e.trackNumber,e.track]),d=Object(r.useCallback)(function(){e.setSingleStepToDrag(void 0),e.setIsDraggingDuration(!1),e.setStepToCopy(void 0);var t=e.sequencerEngine.store.getState();(he(e)||t.steps.stepNumberDraggedTo!==e.stepNumber)&&t.steps.stepNumberDraggingFrom===e.stepNumber?(he(e)?(e.setStepsSelection(void 0),e.sequencerEngine.cursor.show=!0):(e.sequencerEngine.operationManager.dispatch(Object(q.t)(e.sequencerEngine.tracks[e.trackNumber],e.stepNumber,e.resolution)),e.setSelectedSteps(void 0),e.sequencerEngine.select(e.trackNumber,e.stepNumber),e.setStepsSelection(void 0),e.sequencerEngine.cursor.track=e.trackNumber),e.setStepNumberDraggedTo(void 0)):e.setStepNumberDraggedTo(void 0)},[e.stepNumber,e.resolution,e.track,e.trackNumber]),m=Object(r.useCallback)(function(t){t.stopPropagation();var n=e.sequencerEngine.store.getState();if(n.keyboard.isDraggingDuration&&n.keyboard.isMouseDown)v();else if(void 0===n.steps.stepNumberDraggingFrom||void 0===n.keyboard.selectedPianoRollSteps&&!n.steps.singleStepToDrag){if(void 0!==e.stepsSelection){var r=e.stepsSelection;e.stepNumber>=r.fromStep?e.setStepsSelection(e.trackNumber,r.fromStep,e.stepNumber):e.setStepsSelection(e.trackNumber,e.stepNumber,r.toStep)}}else{var a=g(n.steps.stepNumberDraggingFrom),i=void 0!==n.keyboard.selectedPianoRollSteps?n.keyboard.selectedPianoRollSteps:[n.steps.singleStepToDrag];e.sequencerEngine.operationManager.dispatch(Object(q.m)(e.sequencerEngine.tracks[e.trackNumber],i,a,e.resolution)),e.setStepNumberDraggingFrom(e.stepNumber),e.setStepNumberDraggedTo(e.stepNumber),e.sequencerEngine.select(e.trackNumber,e.stepNumber)}},[e.stepsSelection,e.selectedSteps,e.track,e.trackNumber,e.resolution,e.stepNumber]),v=Object(r.useCallback)(function(){var t=e.sequencerEngine.state,n=1+e.stepNumber-t.keyboard.stepDragging,r=ue.transformStepAtResolution2(n,e.resolution),a=t.keyboard.stepToCopy;null===a.duration?e.track.trackData.duration:a.duration;e.selectedSteps?e.selectedSteps.forEach(function(e){return b(e,r)}):b(a,r)},[e.selectedSteps,e.track,e.resolution]),b=function(t,n){null===t.duration?e.track.trackData.duration:t.duration;e.sequencerEngine.operationManager.dispatch(Object(q.w)(e.sequencerEngine.tracks[e.trackNumber],t,t.durationParameter,Math.max(.1,n)))},g=Object(r.useCallback)(function(t){return{stepDifference:e.stepNumber-t,transposeDifference:0}},[e.stepNumber]),y=Object(r.useCallback)(function(t){t.stopPropagation();var n=e.sequencerEngine.state.tracks.trackStepIds[e.track.id],r=n&&n[e.stepNumber];s||e.setSelectedSteps([r]),e.setIsDraggingDuration(!0),e.setStepDragging(e.stepNumber),e.setStepToCopy(r),e.mouseDown(!0)},[s,o,e.track]),k=o&&(o.position>.6&&o.position<.7||o.position>.3&&o.position<.4),O=o&&o.reverse;return a.a.createElement(A.a,{element:ae.Eb},a.a.createElement("div",{onMouseOver:m,className:h},a.a.createElement("div",{ref:n,id:"stepdata-"+o.id,onMouseDown:p,onMouseUp:d,className:l,style:f},"",a.a.createElement(L.a,{condition:e.on},O?a.a.createElement("i",{className:"reverse-indicator"}):"",o.group?a.a.createElement("div",{className:"group-indicator"}):"",o.pLockedParameters.length>0?a.a.createElement("div",{style:{backgroundColor:ce.getColorForHash(pe(o))},className:"p-lock-indicator"}):"",k?a.a.createElement("div",{className:"triplet"},"t"):"",a.a.createElement("div",{draggable:!1,onMouseDown:y,className:"right-edge"}))),a.a.createElement(se,{stepData:o,onMouseDown:p,onMouseUp:d,sampleId:e.id,on:e.on,fill:e.fill,track:e.track,isCurrentStep:e.isCurrentStep,isCursor:e.isCursor})))}),he=function(e){return e.sequencerEngine.store.getState().keyboard.isCommandDown};var pe=function(e){var t=e.pLockedParameters.map(function(t){return t.stepToValue[e.id]}).reduce(function(e,t){return e+t},0);return t<31&&(t=Math.pow(2,t)),t+"-"+e.pLockedParameters[0].id},de=Object(s.b)(null,function(e){return{mouseDown:function(t){return e(Object(m.n)(t))},dragToggle:function(t){return e(Object(m.l)(t))},setContextualHelp:function(t){return e(Object(m.ub)(t))},setStepToCopy:function(t){return e(Object(m.Cg)(t))},setStepDragging:function(t){return e(Object(m.yg)(t))},setSingleStepToDrag:function(t){return e(Object(m.tg)(t))},setStepsSelection:function(t,n,r){return e(Object(m.Eg)(t,n,r))},setStepNumberDraggingFrom:function(t){return e(Object(m.Ag)(t))},setStepNumberDraggedTo:function(t){return e(Object(m.zg)(t))},setIsDraggingDuration:function(t){return e(Object(m.Dc)(t))},setSelectedSteps:function(t){return e(Object(m.jf)(t))}}})(fe),me=(new F.a,Object(r.memo)(function(e){var t=e.stepGroups,n=e.cursorStep,r=e.chunk,i=(e.show,e.stepsLength,e.stepNumbers),o=e.track,s=e.resolution,c=e.barLength,u=e.sequencerEngine,l=e.id,f=e.selectedSteps,h=e.stepsSelection,p=e.trackLengthMode,d=e.showPianoRoll,m=e.isSelectedTrack,v=e.isMini,b=e.trackColor,g=e.chunkSize,y=e.stepsInRow,O=e.partNumber,w=void 0===O?0:O,E=(e.rowHash,"steps-row"),S=!1;Math.floor(r/2)%2===1&&(E+=" odd",S=!0);var P=o.numberOfSlices(),x=(u.cursor,u.getSelectedStep(),u.state.tracks.trackStepIds[o.id]||{}),T=u.state.tracks.trackSteps[o.id],C=u.state.tracks.trackFills[o.id];return a.a.createElement("div",{className:"steps-row-container"},a.a.createElement("div",{className:E},i.map(function(e,r){var i;return a.a.createElement(de,(i={id:l,odd:S,key:r,isCursor:n===e,on:T&&T[e],fill:C&&C[e],showParameters:!1,showPianoRoll:d,selectedSteps:f,stepsSelection:h,group:x[e]?x[e].group:void 0,slice:x[e]?x[e].slice:0,velocity:x[e]?x[e].velocity:1,trackColor:b,sequencerEngine:u,resolution:s,trackNumber:o.trackNumber,stepGroups:t},Object(k.a)(i,"resolution",s),Object(k.a)(i,"stepNumber",e),Object(k.a)(i,"trackData",o),Object(k.a)(i,"isAlternateColor",function(e){return Math.ceil((e+1)/c)%2!=0}(r)),Object(k.a)(i,"slices",P),Object(k.a)(i,"track",o),i))})),!v&&p&&m?a.a.createElement(j,{resizable:r===g-1,rowLength:T.length,track:o,color:b,row:r}):"",a.a.createElement(M,{isMini:v,sequencerEngine:u,track:o,stepsInRow:y,chunk:r+4*w}))})),ve=Object(w.a)([function(e,t){return e.tracks.trackSteps[t.track.id]},function(e,t){return t.chunk*t.stepsInRow},function(e,t){return(t.chunk+1)*t.stepsInRow}],function(e,t,n,r){return Object(O.a)([].concat(Object(u.a)(e||[]),Object(u.a)(r||[])).slice(t,n).join(","))}),be=Object(s.b)(function(e,t){var n=e.steps.stepsSelection,r=-1,a=t.sequencerEngine.currentSubSequence===t.track.subSequence;if(e.mix.selectedTrack===t.track.trackNumber&&a){var i=e.mix.selectedStep,o=t.chunk+4*t.partNumber;i>=o*t.stepsInRow&&i<=(o+1)*t.stepsInRow&&(r=i)}var s=e.keyboard.selectedPianoRollSteps;return s&&s[0]&&s[0].track!==t.track&&(s=void 0),{fills:e.tracks.trackFills[t.track.id],rowHash:ve(e,t),selectedSteps:s,stepsSelection:void 0!==n&&a&&n.trackNumber===t.track.trackNumber?n:void 0,cursorStep:r,cursorShow:t.sequencerEngine.cursor.show,showPianoRoll:e.sequencer.showPianoRoll,stepGroups:e.steps.stepGroups}},function(e){return{}})(me),ge=(n(1045),n(1051),n(1086)),ye=Object(r.memo)(function(e){var t=e.steps,n=e.length,r=e.pattern,i=e.trackColor,o=e.resolution;return t.map(function(e){return a.a.createElement(ge.a,{key:e.step.id,trackColor:i,pattern:r,length:n,stepNumber:e.stepNumber,resolution:o,stepData:e.step})})});var ke=Object(s.b)(function(e,t){var n=t.sequencerEngine.getSequenceId(),r=e.sequencer.currentGlobalStep[n]||0;return{currentStep:t.track.getPatternStep(r)}},null)(function(e){var t={left:448*e.currentStep/e.track.length};return a.a.createElement("div",{className:"play-tick",style:t})}),Oe=128;function je(e){var t="part";e.i===e.partNumber&&(t+=" current-part");return a.a.createElement("div",{onClick:function(){return function(){e.sequencerEngine.cursor.step=e.i*Oe;var t=e.sequencerEngine.trackStep;e.sequencerEngine.seekToTrackStep(t%Oe+e.i*Oe,!1)}()},className:t})}var we=Object(s.b)(function(e,t){t.sequencerEngine.getSequenceId();var n=e.tracks.trackSteps[t.track.id];return{resolution:e.sequencer.displayResolution,steps:n,trackStepIds:e.tracks.trackStepIds[t.track.id]}},null)(function(e){var t=e.track.pattern.length(e.resolution),n=(Array(t).fill(0),(e.trackStepIds||[]).map(function(e,t){return{step:e,stepNumber:t}}).filter(function(e){return e.step&&e.step.on})),r=Math.ceil(e.track.length/Oe),i=Array(r).fill(0);return a.a.createElement("div",{className:"steps-map"},i.map(function(t,n){return a.a.createElement(je,{i:n,track:e.track,sequencerEngine:e.sequencerEngine,partNumber:e.partNumber})}),a.a.createElement(ye,{resolution:e.resolution,steps:n,pattern:e.track.pattern,trackColor:e.trackColor,length:t}),a.a.createElement(ke,{track:e.track,sequencerEngine:e.sequencerEngine}))}),Ee=(n(460),{});new re.a(32,!1),new F.a,new h.a;var Se=Object(r.memo)(function(e){var t=e.borderColor,n=e.isTrackFrozen,r=e.trackLengthMode,i=e.sequencerEngine,o=e.trackColor,s=e.track,c=e.id,u=e.partNumber,l=e.numberParts,f=e.resolution,h=e.isMini,p=e.show,d=e.isSelectedTrack,m=e.setTrackLengthMode,v=(e.stepGroups,e.sequencerScale),k=e.onClickTrack,O="steps-container";n&&(O+=" frozen");r&&(" selected",O+=" track-length-mode");var j=s.length,w=function(e){return e.isTriplet?12:16}(f),E=function(e,t){if(void 0===e||void 0===e.pattern||void 0===t)return[];var n=t.transformStepAtResolution2(e.pattern.length(),new re.a(32,!1));n=Math.floor(n);for(var r=[],a=0;a<n;a++)r.push(a);for(var i=t.isTriplet?12:16,o=r.length/i,s=[],c=0;c<o;c++){var u=c*i,l=u+i;r.length<l&&(l=r.length);var f=u+","+l;if(f in Ee)s.push(Ee[f]);else{var h=r.slice(u,l);Ee[f]=h,s.push(h)}}return s}(s,f),S=0;if(j>128){S=Math.floor(u*E.length/l);var P=Math.floor((u+1)*E.length/l);E=E.filter(function(e,t){return t>=S&&t<P})}if(void 0===E[0])return a.a.createElement("div",null);E[0].length;var x=Object(D.a)(f);return n&&(E=[]),a.a.createElement("div",{onMouseDown:function(e){e.stopPropagation(),k()},className:O},a.a.createElement(b,{scale:v,track:s}),!h&&j>128&&!n?a.a.createElement(we,{partNumber:u,track:s,trackColor:o,sequencerEngine:i}):"",E.map(function(e,t){return a.a.createElement(be,{isMini:h,key:t,trackColor:o,sequencerEngine:i,resolution:f,show:p,barLength:x,isSelectedTrack:d,trackLengthMode:r,id:c,stepNumbers:e,stepsInRow:w,partNumber:isNaN(u)?0:u,chunk:t,track:s})}),a.a.createElement(g.a,{track:s,trackColor:t,isTrackFrozen:n}),a.a.createElement(y.a,{stepsInRow:w,trackLengthMode:r,isSelectedTrack:d,trackColor:o,resolution:f,setTrackLengthMode:m,track:s}))});t.a=Object(s.b)(function(e,t){var n=t.sequencerEngine.getSequenceId(),r=e.sequencer.currentGlobalStep[n]||0,a=(e.tracks.tracksFrozen[t.track.subSequence.id]||{})[t.track.id],i=void 0,o=void 0;if(t.track.length>128){i=Math.floor(r%t.trackData.length/128),o=t.track.length/128;var s=e.mix.selectedTrack==t.trackNumber,c=t.sequencerEngine.cursor.getStep();s&&!t.sequencerEngine.playing&&(i=Math.floor(c/128))}e.steps.stepsSelection;return{numberParts:o,resolution:e.sequencer.displayResolution,partNumber:i,isTrackFrozen:a,trackLengthMode:e.tracks.trackLengthMode,stepsLength:e.tracks.trackStepIds[t.track.id]&&e.tracks.trackStepIds[t.track.id].length}},function(e){return{setTrackLengthMode:function(t){return e(Object(m.Zg)(t))}}})(Se)},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(323),s=n(456),c=n(12);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.oscillator,n=e.width,c=e.height,l=Object(a.useRef)(),f=Object(a.useRef)();Object(a.useEffect)(function(){f.current=l.current.getContext("2d")},[]);var h=Object(a.useState)([]),p=Object(r.a)(h,2),d=p[0],m=p[1],v=Object(a.useCallback)(function(){for(var e=[],r=Array.from(t.formantsManager.analyser.getValue()),a=0;a<r.length;a++){var i=r[a],s=Object(o.a)(i,-160,0,1,c),u=44100*a/256,l=44100*(a+1)/246,f=Math.pow(u/44100,.5)*n,h=Math.pow(l/44100,.5)*n-f;f<n&&e.push({x:f,y:c-s,width:h,height:s})}m(e)},[m,n,c,t]);Object(a.useEffect)(function(){f.current&&window.requestAnimationFrame(b)},[d,n,c]);var b=Object(a.useCallback)(function(){var e=f.current;if(e&&l.current){e.clearRect(0,0,l.current.width,l.current.height);var t,n=u(d);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=r.x,i=r.y,o=r.width,s=r.height;e.beginPath(),e.rect(a,i,o,s),e.fillStyle="#383838",e.fill()}}catch(c){n.e(c)}finally{n.f()}}},[d,n,c]);return Object(s.a)(v,100),i.a.createElement("canvas",{className:"formant-analyser",ref:l,width:n,height:c,style:{width:n,height:c}})}),h=[80,120,220,380,550,750,1e3,1200,1400,1800,2e3,2400,3e3,4e3,5e3,6e3,7e3,8e3,1e4,14e3,18e3],p=[.25,.5,1,1.5,2,2.5,3,3,5],d=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.width,n=e.height,r=function(e){return Math.sqrt(e/2e4)*t},a=function(e){var r=n-e/4*n;return 300===n&&(r-=t/200*10,r-=40),r};return i.a.createElement("svg",{className:"formants-helper",width:t,height:n},p.map(function(e){return i.a.createElement("line",{className:"gain-helper",y1:a(e),x1:0,y2:a(e),x2:t})}),h.map(function(e){return i.a.createElement("line",{x1:r(e),y1:0,x2:r(e),y2:n})}))}),m=Object(a.memo)(function(e){var t=e.curve,n=e.width,r=e.height;return i.a.createElement("svg",{height:r,width:n},i.a.createElement("path",{d:t,className:"bandwidth-visualizer"}))}),v=Object(c.b)(function(e,t){var n=t.formant.enabledParameter.get();return n?{enabled:n,currentStep:t.sequencerEngine.trackStep,frequency:t.formant.formantFrequencyParameter.get(!0),q:t.formant.formantQParameter.get(!0),gain:t.formant.formantGainParameter.get(!0)}:{enabled:n}},function(e){return{}})(function(e){var t=e.enabled,n=e.height,r=e.width,o=e.formant,s=Object(a.useRef)(void 0),c=o.formantFrequencyParameter.get(),u=o.formantQParameter.get(),l=o.formantGainParameter.get(),f=Math.sqrt(c/2e4)*r,h=n-l/4*n;o.enabledParameter.get();var p=c/(.5*u),d=Math.sqrt(p/2e4)*r/2,v=r/200*100,b=d/v,g=n,y=v-v/2,k=v+v/2,O=2*v,j=n,w="M ".concat(v-v," ").concat(g," C ").concat(y," ").concat(-10,", ").concat(k," ").concat(-10,", ").concat(O," ").concat(j);return Object(a.useEffect)(function(){if(s.current){var e=f-v;s.current.setAttribute("style","transform: translate(".concat(e,"px, ").concat(h,"px) scale(").concat(b,", 1)"))}},[f,h,b]),t&&o.isConnectedToAnyModulator()?i.a.createElement("div",{ref:s},i.a.createElement(m,{width:r,height:n,curve:w})):[]}),b=Object(c.b)(function(e,t){var n=t.formant.formantFrequencyParameter.id;return{frequency:Math.round(e.effects.effectParameters[n])}},function(e){return{}})(function(e){var t=e.height,n=(e.formant,e.frequency);return i.a.createElement("div",{style:{height:t.current||20},className:"dragging-formant-info"},n," hz")}),g=n(39),y=n.n(g),k=[{value:-12,label:"-12db"},{value:-24,label:"-24db"},{value:-48,label:"-48db"}],O=Object(c.b)(function(e,t){return{rolloff:t.formant.rolloff}},function(e){return{}})(function(e){var t=e.formant,n=e.rolloff,r=Object(a.useCallback)(function(e){t.formantRolloffParameter.set(e.value)},[t]);return i.a.createElement(y.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:k,onChange:r,value:k.find(function(e){return e.value===n}),placeholder:"Rate"})}),j=[{value:"bandpass",label:"Bandpass"},{value:"lowpass",label:"Lowpass"},{value:"highpass",label:"Highpass"}],w=Object(c.b)(function(e,t){return{type:t.formant.formantTypeParameter.get()}},function(e){return{}})(function(e){var t=e.formant,n=e.type,r=Object(a.useCallback)(function(e){t.formantTypeParameter.set(e.value)},[t]);return i.a.createElement(y.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:j,onChange:r,value:j.find(function(e){return e.value===n}),placeholder:"Rate"})}),E=n(6),S=n(22),P=Object(c.b)(function(e,t){return{showFormantEffect:e.instruments.showFormantEffect}},function(e,t){return{setShowFormantEffect:function(t){return e(Object(E.Kf)(t))}}})(function(e){var t=e.height,n=e.formant,r=e.setShowFormantEffect,o=e.showFormantEffect,s=Object(a.useRef)();return Object(a.useEffect)(function(){var e=n.sequencerEngine.state.instruments.showFormantEffect;n!==e&&e&&r(n)},[n]),Object(a.useEffect)(function(){t.current=s.current.offsetHeight},[n]),Object(a.useEffect)(function(){return function(){return r(void 0)}},[]),i.a.createElement("div",{ref:s,className:"formant-parameters"},i.a.createElement("div",{className:"inner"},i.a.createElement(S.a,{sequencerEngine:n.oscillator.sequencerEngine,name:"Frequency",parameter:n.formantFrequencyParameter,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,root:2,min:0,max:2e4,step:1}),i.a.createElement(S.a,{sequencerEngine:n.oscillator.sequencerEngine,name:"Q",parameter:n.formantQParameter,root:2,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,min:.1,max:50,step:.01})),i.a.createElement("div",{className:"inner"},i.a.createElement(S.a,{sequencerEngine:n.oscillator.sequencerEngine,name:"Gain",parameter:n.formantGainParameter,root:2,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,min:0,max:3.9,step:.01}),i.a.createElement(O,{formant:n}),i.a.createElement(w,{formant:n})),i.a.createElement("div",{onClick:function(){return r(o?void 0:n)},className:o?"fx-button show":"fx-button"},i.a.createElement("span",null,"FX")," ",n.effect?i.a.createElement("span",{className:"fx-name"},n.effect.name):""))}),x=Object(a.memo)(function(e){var t=e.formant,n=e.width,r=e.height,o=e.setDraggingFormant,s=e.isSelected,c=e.frequency,u=e.q,l=e.gain,f=e.enabled,h=Object(a.useRef)(void 0),p=Object(a.useRef)(void 0),d=(Object(a.useRef)(void 0),Object(a.useRef)(0)),m="formant";f&&(m+=" enabled"),s&&(m+=" selected");var v=Object(a.useCallback)(function(){var e=(new Date).getTime();if(e-d.current<=400){var n=!t.enabledParameter.get();t.enabledParameter.set(n)}d.current=e,t.enabledParameter.get()&&o(t)},[t,o]),b=Object(a.useCallback)(function(){o(void 0)},[o]),g=c/(.5*u),y=Math.sqrt(g/2e4)*n/2,k=n/200*100,O=y/k,j=r+60,w=k-y/2,E=k+y/2,S=k+y,P=r+60,x="M ".concat(k-y," ").concat(j," C ").concat(w," ").concat(-10,", ").concat(E," ").concat(-10,", ").concat(S," ").concat(P);Object(a.useEffect)(function(){var e=Math.sqrt(c/2e4)*n,t=r-l/4*r;if(p.current){var a=e-8,i=t-8;p.current.style.transform="translate(".concat(a,"px, ").concat(i,"px)")}if(h.current){var o=e-k;300===r&&(t-=n/200*10,t-=40),h.current.style.transform="translate(".concat(o,"px, ").concat(t,"px)")}},[c,l,O,y,n,r]);var N="band-wrap";return s&&(N+=" selected"),f||(N+=" disabled"),[i.a.createElement("div",{key:1,className:N,ref:h},i.a.createElement(T,{enabled:!0,width:n,height:r,curve:x,isSelected:s})),i.a.createElement("div",{className:s?"circle-wrap selected":"circle-wrap",key:2,ref:p},i.a.createElement(C,{className:m,isSelected:s&&f,formant:t,onMouseDown:v,onMouseUp:b}))]}),T=Object(a.memo)(function(e){var t=e.isSelected,n=e.curve,r=e.bandRef,a=e.width,o=e.height,s="bandwidth-svg";return e.enabled||(s+=" enabled"),i.a.createElement("svg",{className:s,height:o+60,width:a,ref:r},i.a.createElement("path",{d:n,className:t?"bandwidth selected":"bandwidth"}))}),C=Object(a.memo)(function(e){var t=e.onMouseDown,n=e.onMouseUp,r=e.formant,a=(e.curve,e.isSelected),o=e.className;return i.a.createElement("svg",{className:a?"circle-svg selected":"circle-svg",width:16,height:16},i.a.createElement("circle",{onMouseDown:t,onMouseUp:n,className:o,cx:8,cy:8,r:8,strokeWidth:1,key:2}),i.a.createElement("text",{key:3,onMouseDown:t,onMouseUp:n,x:5,y:12}," ",r.number+1))}),N=Object(c.b)(function(e,t){return{enabled:t.formant.enabledParameter.get(),frequency:t.formant.formantFrequencyParameter.get(!0,void 0,!0),q:t.formant.formantQParameter.get(!0,void 0,!0),gain:t.formant.formantGainParameter.get(!0,void 0,!0)}},function(e){return{}})(x);n(2442),t.a=Object(c.b)(function(e,t){return{selectedParameter:e.effects.accumulatorParameterSelected,selectedFMFormant:e.instruments.selectedFMFormant,showFormantPresets:e.instruments.showFormantPresets}},function(e){return{setShowFormantPresets:function(t){return e(Object(E.Lf)(t))},setShowingFormants:function(t){return e(Object(E.mg)(t))},setEffectParameterValues:function(t){return e(Object(E.Vb)(t))}}})(function(e){var t=e.oscillator,n=e.selectedParameter,o=e.setShowingFormants,s=e.setShowFormantPresets,c=e.showFormantPresets,u=e.setEffectParameterValues,l=e.formantsExpanded,h=e.setFormantsExpanded,p=e.selectedFMFormant,m=Object(a.useRef)(void 0),g=Object(a.useRef)(void 0),y=t.formants,k=Object(a.useState)(void 0),O=Object(r.a)(k,2),j=O[0],w=O[1],E=Object(a.useState)(void 0!==x?t.formants[x]:void 0),S=Object(r.a)(E,2),x=S[0],T=S[1];Object(a.useEffect)(function(){if(void 0!==p){var e=t.formants[p];T(e)}},[p,T,t]),Object(a.useEffect)(function(){return o(!0),function(){return o(!1)}},[]),Object(a.useEffect)(function(){return window.addEventListener("keydown",R),function(){return window.removeEventListener("keydown",R)}},[T,x,R]),Object(a.useEffect)(function(){return m.current.addEventListener("mousewheel",C,{passive:!1}),function(){m.current&&m.current.removeEventListener("mousewheel",C)}},[x]);var C=Object(a.useCallback)(function(e){if(e.preventDefault(),x){var t=e.deltaX,n=e.deltaY,r=(e.wheelDeltaX,e.wheelDeltaY),a={};if(Math.abs(t)>5){var i=x.formantFrequencyParameter.moveCoordinates(t/-10,0),o=i.id,s=i.value;a[o]=s}if(Math.abs(n)>5){var c=x.formantGainParameter.moveCoordinates(n/10,0),l=c.id,f=c.value;a[l]=f}else if(Math.abs(r)>4){var h=x.formantQParameter.moveCoordinates(r/-28,0),p=h.id,d=h.value;a[p]=d}Object.keys(a).length>0&&u(a)}},[x]),R=Object(a.useCallback)(function(e){if("Tab"===e.key&&x){var t=y.filter(function(e){return e.enabledParameter.get()}),n=t.indexOf(x);T(t[(n+1)%t.length])}},[T,x]);Object(a.useEffect)(function(){j&&x!==j&&(console.log("dragging formant=",j),T(j))},[j,T]),Object(a.useEffect)(function(){x&&t&&!t.formants.includes(x)&&(console.log("OSC CHANGED SO CLEARING FORMANT =",x),T(void 0))},[x,T,t]),Object(a.useEffect)(function(){n&&n.context&&n.context.formant&&T(n.context.formant)},[n,T]);var M=Object(a.useCallback)(function(e){if(j){var t=l?470:200,n=l?300:100,r=m.current.getBoundingClientRect(),a=e.clientX-r.left,i=e.clientY-r.top,o=2e4*Math.pow(a/t,2),s=j.formantGainParameter.originalMax*(n-i)/n;j.formantFrequencyParameter.set(o,!1),j.formantGainParameter.set(s,!1)}},[j,l]);return i.a.createElement("div",{className:"formants-editor"},i.a.createElement("div",{ref:m,onMouseDown:function(e){return e.stopPropagation()},style:{width:l?470:200,height:l?300:100},draggable:!0,onDragStart:function(e){return e.preventDefault()},onMouseMove:M,className:"formants-wrapper"},i.a.createElement("img",{onClick:function(e){return s(!c)},src:"/floppy-disk.svg",className:"pushable formant-presets-icon"}),i.a.createElement("img",{onClick:function(e){return h(!l)},src:"/expand-icon.svg",className:"pushable expand-formants-icon"}),i.a.createElement(d,{width:l?470:200,height:l?300:100}),i.a.createElement(f,{width:l?470:200,height:l?300:100,oscillator:t}),y.map(function(e,n){return i.a.createElement(v,{key:n,isSelected:x===e,setDraggingFormant:w,sequencerEngine:t.track.sequencerEngine,width:l?470:200,height:l?300:100,formant:e})}),y.map(function(e,t){return i.a.createElement(N,{key:t,isSelected:x===e,setDraggingFormant:w,width:l?470:200,height:l?300:100,formant:e})})),x&&!j?i.a.createElement(P,{height:g,formant:x}):j?i.a.createElement(b,{height:g,formant:j}):"")})},function(e,t,n){"use strict";var r=n(8),a=n(0),i=n.n(a),o=n(11),s=function(e,t,n){return Math.max(e,Math.min(t,n))},c=function(e,t){var n,r;return e.some(function(e){var a=Math.abs(t-e);if(a>=r)return!0;n=e,r=a}),n},u=function(e){var t=e.min,n=e.max;return(e.value-t)/(n-t)},l={37:-1,38:1,39:1,40:-1},f=function(e){return function(t){return e(Object(r.a)({},t,{type:"START"}))}},h=function(e){return function(t){var n=l[t.keyCode];n&&(t.preventDefault(),e({type:"STEPS",direction:n}))}},p=function(e,t){return document.body.addEventListener(e,t)},d=function(e,t){return document.body.removeEventListener(e,t)},m=function(e){return Object(r.a)({},e,{isActive:!0},function(e){var t=e.container,n=e.size,r=t.current.getBoundingClientRect();return{startX:Math.floor(r.left)+n/2,startY:Math.floor(r.top)+n/2}}(e))},v=function(e){var t=e.state,n=e.action,a=(e.onChange,function(e){var t=e.startX,n=e.startY,r=(e.scrollContainer,e.size,e.pageX),a=e.pageY,i=e.angleOffset,o=e.angleRange,c=t-r,u=n-a,l=180*Math.atan2(-u,-c)/Math.PI+90-i,f=l<0?l+360:l%360;return f<=o?s(0,1,f/o):+(f-o<(360-o)/2)}(Object(r.a)({},t,n))),i=function(e){var t=e.min;return t+(e.max-t)*e.percentage}(Object(r.a)({},t,{percentage:a}));return Object(r.a)({},t,{percentage:a,value:i})},b=function(e){return function(t,n){switch(n.type){case"START":return m(t);case"SCROLL_CONTAINER":return function(e,t){return Object(r.a)({},e,{scrollContainer:t.scrollContainer})}(t,n);case"MOVE":return v({state:t,action:n,onChange:e});case"STEPS":return function(e){var t=e.state,n=e.action,a=(e.onChange,s(t.min,t.max,t.value+1*n.direction));return Object(r.a)({},t,{value:a,percentage:u(Object(r.a)({},t,{value:a}))})}({state:t,action:n,onChange:e});default:return Object(r.a)({},t,{isActive:!1,value:t.value})}}},g=function(e){var t=e.min,n=e.max,r=e.initialValue,i=e.angleOffset,s=void 0===i?0:i,u=e.scrollContainer,l=e.angleRange,m=void 0===l?360:l,v=e.size,g=e.steps,y=(e.snap,e.onChange),k=Object(a.useRef)(),O=Object(a.useRef)(),j=Object(a.useReducer)(b(y),{isActive:!1,min:t,max:n,angleOffset:s,angleRange:m,percentage:void 0!==r?(r-t)/(n-t):0,value:r||0,svg:k,container:O,size:v}),w=Object(o.a)(j,2),E=w[0],S=E.percentage,P=E.value,x=E.angle,T=E.isActive,C=w[1];return Object(a.useEffect)(function(e){var t=e.dispatch,n=e.isActive;return function(){var e=function(e){var n=e.pageX,r=e.pageY;return t({pageX:n,pageY:r,type:"MOVE"})},r=function(){return t({type:"STOP"})};if(n)return p("mousemove",e),p("mouseup",r),function(){d("mousemove",e),d("mouseup",r)}}}({dispatch:C,isActive:T}),[T]),{dispatch:C,svg:k,container:O,percentage:g?c(g,S):S,value:P,scrollContainer:u,angle:x,onStart:f(C),onKeyDown:h(C),onScroll:function(e){}}},y=n(99),k=function(e,t,n){return{x:e+t*Math.cos(n),y:e+t*Math.sin(n)}},O=function(e){return Math.PI*e/180},j=function(e){var t=e.percentage,n=e.angleOffset,r=e.angleRange,a=e.arcWidth,i=e.radius,o=e.center,s=r*t,c=n-90,u=i-a,l=O(c),f=O(c+s),h=s<180?0:1,p=k(o,i,f),d=k(o,i,l),m=k(o,u,l),v=k(o,u,f);return"M".concat(p.x,",").concat(p.y," A").concat(i,",").concat(i," 0 ").concat(h," 0 ").concat(d.x,",").concat(d.y,"L").concat(m.x,",").concat(m.y," A").concat(u,",").concat(u," 0 ").concat(h," 1 ").concat(v.x,",").concat(v.y," L").concat(p.x,",").concat(p.y)},w=function(e){var t=e.color,n=e.background,a=Object(y.a)(e,["color","background"]);return i.a.createElement("g",null,n&&i.a.createElement("path",{d:j(Object(r.a)({},a,{percentage:1})),style:{fill:n}}),i.a.createElement("path",{d:j(a),style:{fill:t}}))},E=function(e){var t=e.children,n=e.width,r=e.height,a=void 0===r?n:r,o=e.angleOffset,s=e.angleRange,c=e.percentage,u=e.radius,l=e.center,f=e.type,h=e.color,p=e.className;return i.a.createElement("g",{transform:"\n        rotate(".concat(o+s*c," ").concat(l," ").concat(l,")\n        translate( ").concat(l-n/2," ").concat(l-u-a,")\n        ")},t&&i.a.Children.map(t,function(e){return i.a.cloneElement(e,{width:n,height:a,percentage:c})}),"rect"===f&&i.a.createElement("rect",{width:n,height:a,fill:h,className:p}),"circle"===f&&i.a.createElement("circle",{r:n,fill:h,className:p}))},S=function(e){var t=e.angleRange,n=e.steps,a=e.type,o=void 0===a?"rect":a,s=e.radius,c=e.tickWidth,u=e.tickHeight,l=e.angleOffset,f=e.center,h=e.color,p=e.activeColor,d=void 0===p?h:p,m=e.className,v=e.activeClassName,b=void 0===v?m:v,g=e.fn,k=e.percentage,O=t/n,j=n+(360===t?0:1),w=f-c/2,E=f-s,S=Math.round((j-1)*k),P="circle"===o?function(e){var t=e.tickWidth,n=e.translateX,r=e.translateY,a=e.angleOffset,o=e.stepSize,s=e.center,c=e.color,u=e.active,l=e.activeColor,f=e.activeClassName,h=e.className;return function(e,p){return i.a.createElement("circle",{r:t,key:p,className:p===u?f:h,fill:p===u?l:c,stroke:"none",transform:"\n        rotate(".concat(a+o*p," ").concat(s," ").concat(s,") \n        translate(").concat(n," ").concat(r,")\n        ")})}}({tickWidth:c,translateX:w,translateY:E,center:f,angleOffset:l,stepSize:O,color:h,active:S,activeColor:d,className:m,activeClassName:b}):"rect"!==o||g?function(e){var t=e.fn,n=Object(y.a)(e,["fn"]);return function(e,a){return t(Object(r.a)({},n,{i:a}))}}({fn:g,tickWidth:c,tickHeight:u,translateX:w,translateY:E,angleOffset:l,stepSize:O,center:f,color:h,active:S,activeColor:d,className:m,activeClassName:b}):function(e){var t=e.tickWidth,n=e.tickHeight,r=e.translateX,a=e.translateY,o=e.angleOffset,s=e.stepSize,c=e.center,u=e.color,l=e.active,f=e.activeColor,h=e.activeClassName,p=e.className;return function(e,d){return i.a.createElement("rect",{className:d===l?h:p,fill:d===l?f:u,stroke:"none",width:t,height:n,key:d,transform:"\n        rotate(".concat(o+s*d," ").concat(c," ").concat(c,") \n        translate(").concat(r," ").concat(a,")\n        ")})}}({tickWidth:c,tickHeight:u,translateX:w,translateY:E,angleOffset:l,stepSize:O,center:f,color:h,active:S,activeColor:d,className:m,activeClassName:b});return i.a.createElement("g",null,Array.from({length:j},P))},P=function(e,t){return e&&t?Array.from({length:e+1},function(t,n){return 1/e*n}):void 0},x=function(e){var t=e.type;return t===w||t===E||t===S||t===function(e){var t=e.value,n=e.size,r=e.decimalPlace,a=void 0===r?0:r,o=e.className,s=e.marginBottom,c=void 0===s?0:s;return null==t?null:i.a.createElement("text",{style:{userSelect:"none"},x:"50%",textAnchor:"middle",className:o,y:n-c},t.toFixed(a))}},T=function(e){var t=e.min,n=e.max,o=e.value,s=e.angleOffset,c=void 0===s?0:s,l=e.angleRange,f=void 0===l?360:l,h=e.size,p=e.onChange,d=void 0===p?function(){}:p,m=e.children,v=e.scrollContainer,b=e.steps,y=e.snap,k=void 0!==y&&y,O=e.ariaValueText,j=e.ariaLabelledBy,w=e.className,E=g({min:t,scrollContainer:v,max:n,initialValue:o,angleOffset:c,percentage:u(o),angleRange:f,size:h,steps:P(b,k),onChange:d}),S=E.dispatch,T=E.onStart,C=E.svg,N=E.container,R=E.onKeyDown,M=E.onScroll,A=o,q=void 0!==o?(o-t)/(n-t):0;return Object(a.useEffect)(function(){d(E.value)},[E.value]),Object(a.useEffect)(function(){S({scrollContainer:v,type:"SCROLL_CONTAINER"})},[v]),i.a.createElement("div",{ref:N,tabIndex:"0",style:{outline:"none",width:h,height:h},"aria-valuemax":n,"aria-valuemin":t,"aria-valuenow":A,"aria-valuetext":O,"aria-labelledby":j,onKeyDown:R,onWheel:M,className:w},i.a.createElement("svg",{onMouseDown:function(e){e.preventDefault(),T(e)},width:h,height:h,ref:C},i.a.createElement("g",{className:"knob-group"},i.a.Children.map(m,function(e){return x(e)?i.a.cloneElement(e,Object(r.a)({percentage:q,size:h,value:A,angleOffset:c,angleRange:f,radius:h/2,center:h/2,steps:b},e.props)):e}))))};n.d(t,"b",function(){return T}),n.d(t,"a",function(){return w}),n.d(t,"c",function(){return E})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12),f=n(148),h=n(42);n(110),n(22),n(39);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d={},m={},v=[50,60,70,80,90,100,200,300,400,500,600,700,800,900,1e3,2e3,3e3,4e3,5e3,6e3,7e3,8e3,9e3,1e4],b=function(e){Object(i.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a.guideLines=a.getGuideLines(),a.fillCache(),a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.nextProps!==e.nextProps||JSON.stringify(this.props.equalizerPoints)!==JSON.stringify(e.equalizerPoints)}},{key:"fillCache",value:function(){for(var e=0;e<14e3;e++)this.getXPositionForFrequency(e);for(var t=0;t<650;t++)this.getFrequencyForXPosition(t)}},{key:"getFrequencyForXPosition",value:function(e){if(e in d)return d[e];var t=0,n=0,r=0;for(n=0;t<e;n++)t+=this.props.getWidth(n),r+=86;var a=this.props.getWidth(n),i=r-86+(e-(t-a))/a*86;return d[e]=i,i}},{key:"getXPositionForFrequency",value:function(e){if(e in m)return m[e];var t=0,n=0,r=0;for(t=0;r<e;t++)n+=this.props.getWidth(t),r+=86;return n-=this.props.getWidth(t),n+=(e-(r-86))/86*this.props.getWidth(t),m[e]=n,n}},{key:"getGainYPosition",value:function(e){return 80-5*e}},{key:"equalizerPoints",get:function(){return this.props.effect.equalizerPoints||[]}},{key:"getEQCurve",value:function(){for(var e=[],t=this.equalizerPoints.filter(function(e){return e.enabled}),n=0;n<360;n+=2){var r=this.getFrequencyForXPosition(n),a=0;for(var i in t)a+=t[i].frequencyToGain(r);e.push(n),e.push(this.getGainYPosition(a))}return u.a.createElement(h.Line,{closed:!1,strokeWidth:2,lineCap:"butt",lineJoin:"miter",tension:.91,points:e,stroke:"#f55442"})}},{key:"getEqualizerPoints",value:function(){var e=this,t=this.equalizerPoints.filter(function(e){return e.enabled});return t.map(function(n,r){var a=t[r],i=e.getXPositionForFrequency(n.frequency);return u.a.createElement(h.Group,null,u.a.createElement(h.Circle,{onMouseDown:function(t){return e.startDraggingPoint(a)},onMouseUp:function(t){return e.stopDraggingPoint(a)},x:i,y:e.getGainYPosition(n.gain),radius:8,fill:e.props.selectedPoint===a?"yellow":"black",stroke:"yellow",strokeWidth:2}),u.a.createElement(h.Text,{onMouseDown:function(t){return e.startDraggingPoint(a)},onMouseUp:function(t){return e.stopDraggingPoint(a)},text:a.number,fill:e.props.selectedPoint===a?"black":"yellow",fontSize:10,fontFamily:"Arial",x:i-3,y:e.getGainYPosition(n.gain)-5}))})}},{key:"getGuideLines",value:function(){var e=this;return v.map(function(t){return e.getXPositionForFrequency(t)}).map(function(e){return u.a.createElement(h.Line,{key:"eq-guideline-"+e,points:[e,0,e,160],stroke:"#1f1f1f",strokeWidth:1,closed:!1})})}},{key:"startDraggingPoint",value:function(e){this.props.setSelectedPoint(e),this.setState({draggingPoint:e})}},{key:"stopDraggingPoint",value:function(e){this.setState({draggingPoint:void 0})}},{key:"onMouseMove",value:function(e){var t=e.evt.layerX,n=e.evt.layerY,r=parseInt(this.getFrequencyForXPosition(t));void 0!==this.state.draggingPoint&&(this.state.draggingPoint.frequency=r,this.state.draggingPoint.gain=(80-n)/5,this.setState(this.state))}},{key:"onMouseLeave",value:function(){this.setState({draggingPoint:void 0})}},{key:"render",value:function(){var e=this;return u.a.createElement(h.Group,{onMouseMove:function(t){return e.onMouseMove(t)},onMouseLeave:function(t){return e.onMouseLeave()}},u.a.createElement(h.Line,{closed:!0,strokeWidth:2,lineCap:"round",lineJoin:"round",points:[0,0,360,0,360,160,0,160],stroke:"black"}),this.guideLines,this.getEQCurve(),this.getEqualizerPoints())}}]),n}(c.Component),g=Object(l.b)(function(e,t){var n=t.effect.equalizerPoints,r={};for(var a in n){var i=n[a],o=i.frequencyParameter,s=i.gainParameter,c=i.qParameter,u=i.enabledParameter;r[a]={frequency:e.effects.effectParameters[o.id],gain:e.effects.effectParameters[s.id],enabled:e.effects.effectParameters[u.id],q:e.effects.effectParameters[c.id]}}return{equalizerPoints:r}},null)(b),y=n(323);function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var O={},j=function(e){Object(i.a)(n,e);var t=k(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect,pts:[],updateRate:e.updateRate},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.state.updateRate!==e.updateRate&&(this.state.updateRate=e.updateRate,clearInterval(this.timer),this.run()),!0}},{key:"componentDidMount",value:function(){this.run()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"run",value:function(){var e=this;this.timer=setInterval(function(){if(e.props.sequencerEngine.playing){var t=Array.from(e.props.effect.getSpectrum());e.setState({pts:t})}},this.state.updateRate)}},{key:"getXPositionForFrequency",value:function(e){if(void 0!==O[e])return O[e];for(var t=0,n=0;n<e;n++)t+=this.props.getWidth(n);return O[e]=t,t}},{key:"getBucketRect",value:function(e,t){var n=Object(y.a)(e,-160,0,1,160);return u.a.createElement(h.Rect,{width:this.props.getWidth(t),height:-2*n,y:160,x:this.getXPositionForFrequency(t),fill:this.rainbow(t)})}},{key:"rainbow",value:function(e){return"hsl("+e+",100%,50%)"}},{key:"render",value:function(){var e=this;return this.state.pts.map(function(t,n){return e.getBucketRect(t,n)})}}]),n}(c.Component);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var E=function(e){Object(i.a)(n,e);var t=w(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props.equalizerPoint,t=e.enabled?"equalizer-point-info":"equalizer-point-info disabled";return this.props.selected&&(t+=" selected"),u.a.createElement("div",{onClick:this.props.onClick,className:t},u.a.createElement("div",{className:"equalizer-point-number"},e.number))}}]),n}(c.Component),S=n(397);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var x=function(e){Object(i.a)(n,e);var t=P(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"getOption",value:function(e){return T.filter(function(t){return t.value===e})[0]}},{key:"onSelectOption",value:function(e){this.props.onUpdateRateChanged(e.value)}},{key:"render",value:function(){return u.a.createElement("div",null)}}]),n}(c.Component),T=[{value:S.a,label:"Fastest"},{value:S.b,label:"Fast"},{value:S.c,label:"Medium"},{value:S.e,label:"Slow"},{value:S.d,label:"Slowest"}],C=x;function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var R={};window.WIDTH_CACHE=R;var M=function(e){Object(i.a)(n,e);var t=N(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={effect:e.effect,pts:[],frequency:0,selectedPoint:e.effect.equalizerPoints[0]},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"handleOptionChange",value:function(e){this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"onChangeSynced",value:function(e){document.activeElement.blur(),this.setState(this.state)}},{key:"getWidth",value:function(e){if(void 0!==R[e])return R[e];var t=void 0;return t=e<5?Object(y.a)(256-e,252,256,10,20):e<12?Object(y.a)(256-e,245,252,4,10):e<16?Object(y.a)(256-e,241,245,2,4):Object(y.a)(256-e,0,241,1,2),R[e]=t,t}},{key:"setSelectedPoint",value:function(e){this.setState({selectedPoint:e})}},{key:"onClickEqualizerPoint",value:function(e){if(this.state.selectedPoint!==e)e.enabled||(e.enabled=!0),this.setState({selectedPoint:e});else{e.enabled=!1;var t=void 0;for(var n in this.state.effect.equalizerPoints){var r=this.state.effect.equalizerPoints[n];if(r.enabled){t=r;break}}this.setState({selectedPoint:t})}}},{key:"onUpdateRateChanged",value:function(e){this.state.effect.updateRate=e,this.setState(this.state)}},{key:"render",value:function(){var e=this;this.props.automation;return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"eq8"},u.a.createElement("div",{className:"eq8-knobs"},u.a.createElement(f.a,{color:"#f55442",scrollContainer:this.props.scrollContainer,name:"Freq",unit:"Hz",parameter:this.state.selectedPoint.frequencyParameter}),u.a.createElement(f.a,{color:"#f55442",scrollContainer:this.props.scrollContainer,unit:"db",name:"Gain",parameter:this.state.selectedPoint.gainParameter}),u.a.createElement(f.a,{color:"#f55442",scrollContainer:this.props.scrollContainer,name:"Q",min:.1,parameter:this.state.selectedPoint.qParameter})),u.a.createElement("div",null,u.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"spectrum-container"},u.a.createElement(h.Stage,{width:360,height:160},u.a.createElement(l.a,{store:this.props.sequencerEngine.store},u.a.createElement(h.FastLayer,{width:360,height:160},u.a.createElement(h.Rect,{width:360,height:160,fill:"black"}),u.a.createElement(j,{updateRate:this.state.effect.updateRate,sequencerEngine:this.props.sequencerEngine,getWidth:function(t){return e.getWidth(t)},effect:this.state.effect})),u.a.createElement(h.Layer,{width:360,height:160},u.a.createElement(g,{selectedPoint:this.state.selectedPoint,setSelectedPoint:function(t){return e.setSelectedPoint(t)},effect:this.props.effect,getWidth:function(t){return e.getWidth(t)},setDraggingPoint:function(t){return e.setState({draggingPoint:t})}}))))),u.a.createElement("div",{className:"equalizer-parameters"},u.a.createElement("div",{className:"equalizer-points"},this.state.effect.equalizerPoints.map(function(t){return u.a.createElement(E,{onClick:function(){return e.onClickEqualizerPoint(t)},selected:e.state.selectedPoint===t,equalizerPoint:t})}),u.a.createElement("div",{className:"eq8-update-rate-dropdown-container"},u.a.createElement(C,{updateRate:this.state.effect.updateRate,onUpdateRateChanged:function(t){return e.onUpdateRateChanged(t)}}))))))):"")}}]),n}(c.Component);t.a=M},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(8),o=n(14),s=n(2),c=n(4),u=n(7),l=n(10),f=n(1),h=n(15),p=n.n(h),d=n(47),m=n(92),v=n(179),b=n(9),g=n(20),y=(n(41),n(6)),k=n(151);function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var j=n(132),w=n(32),E=n(23),S=n(21);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var x=function(e){Object(u.a)(n,e);var t=P(n);function n(e,r){var a;Object(s.a)(this,n),(a=t.call(this)).initialBulkValues={},a.formants=e,a.oscillator=e.oscillator;var i=a.oscillator.context.getCopy();return i.forFormant(Object(g.a)(a)),i.forSubDevice(Object(g.a)(a)),i.forTrack(a.oscillator.track),a.context=i,a.number=r,a.parameters=[],a.name="Formant "+r,a.enabled=!1,a.setup(),a.sequencerEngine.dispatch(Object(y.Vb)(a.initialBulkValues)),a}return Object(c.a)(n,[{key:"sequencerEngine",get:function(){return this.oscillator.sequencerEngine}},{key:"registerParameter",value:function(e,t){this.initialBulkValues=Object(i.a)({},this.initialBulkValues,e.setStore(this.oscillator.store)),e.setMixSession(this.oscillator.mixSession);var n=this.oscillator.context.getCopy();n.forFormant(this),n.forSubDevice(this),n.forTrack(this.oscillator.track),this.context=n,e.setContext(n),e.setTrack(this.oscillator.context.track),this.parameters.push(e),this.oscillator.parameters.push(e)}},{key:"input",get:function(){return this.formants.input}},{key:"output",get:function(){return this.formants.output}},{key:"initialize",value:function(){this.formantFilter||this.formantGain||(this.formantFilter=new p.a.Filter(this.formantFrequencyParameter.get(!0),this.formantType,this.rolloff),this.formantGain=this.formantFilter.output,this.setAudioParams()),this.input.chain(this.formantFilter,this.output),this.enabled=!0}},{key:"isEnabled",get:function(){return this.enabledParameter.get()}},{key:"bypass",value:function(){this.enabled&&(this.formantFilter&&this.formantGain&&(this.input.disconnect(this.formantFilter),this.formantGain.disconnect()),this.enabled=!1)}},{key:"setup",value:function(){var e=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0]||(this.enabledParameter=new S.a("Formant "+(this.number+1)+" Enabled",this,function(t,n){e.enable(n)},{documentation:["When enabled, a formant filter is applied to the operator"],min:0,max:1,defaultValue:!1,automatable:!1}),this.registerParameter(this.enabledParameter),this.formantFrequencyParameter=new j.a("Formant Frequency "+(this.number+1),void 0,{min:16,max:2e4,unit:"",defaultValue:1e3*(this.number+1)}),this.registerParameter(this.formantFrequencyParameter),this.formantQParameter=new j.a("Formant Q "+(this.number+1),void 0,{min:0,documentation:["Ratio between this operator`'s frequency, and the frequency of the inputed note.","Ex: A ratio of 2 is an octave above the inputed note"],max:80,unit:"",defaultValue:20}),this.registerParameter(this.formantQParameter),this.formantGainParameter=new j.a("Formant Gain "+(this.number+1),void 0,{min:0,documentation:["Ratio between this operator`'s frequency, and the frequency of the inputed note.","Ex: A ratio of 2 is an octave above the inputed note"],max:4,unit:"",defaultValue:.5}),this.registerParameter(this.formantGainParameter),this.formantRolloffParameter=new S.a("Formant Rolloff "+(this.number+1),this,function(t,n){return e.rolloff=n},{defaultValue:-12,min:-48,max:-12,automatable:!1}),this.registerParameter(this.formantRolloffParameter),this.formantTypeParameter=new S.a("Formant Type "+(this.number+1),this,function(t,n){return e.formantType=n},{defaultValue:"bandpass",min:-48,max:-12,automatable:!1}),this.registerParameter(this.formantTypeParameter))}},{key:"formantType",get:function(){return this.formantTypeParameter?this.formantTypeParameter.get():"bandpass"},set:function(e){this.formantFilter&&(this.formantQParameter.max="lowpass"===e?12:this.formantQParameter.originalMax,this.formantFilter.type=e)}},{key:"rolloff",get:function(){return this.formantRolloffParameter?this.formantRolloffParameter.get():-12},set:function(e){this.formantFilter&&(this.formantFilter.rolloff=e)}},{key:"enable",value:function(e){e&&!this.formants.anyFormantsOn()?this.formants.enableFormants():1===this.formants.numFormants()&&!e&&this.enabled&&this.formants.disableFormants(),e?this.initialize():this.bypass()}},{key:"refreshParameters",value:function(){this.formantFrequencyParameter.set(this.formantFrequencyParameter.get(!0)),this.formantGainParameter.set(this.formantGainParameter.get(!0)),this.formantQParameter.set(this.formantQParameter.get(!0))}},{key:"setAudioParams",value:function(){this.formantQParameter.setAudioParams([this.formantFilter.Q]),this.formantFrequencyParameter.setAudioParams([this.formantFilter.frequency]),this.formantGainParameter.setAudioParams([this.formantGain.gain])}},{key:"removeAudioParams",value:function(e,t){this.formantQParameter.removeAudioParams([this.formantFilter.Q]),this.formantFrequencyParameter.removeAudioParams([this.formantFilter.frequency]),this.formantGainParameter.removeAudioParams([this.formantGain.gain]),this.formantQParameter.disableKeyScaling(),this.formantFrequencyParameter.disableKeyScaling(),this.formantGainParameter.disableKeyScaling()}},{key:"getJson",value:function(e){var t={enabled:this.enabledParameter.get(!0),frequency:this.formantFrequencyParameter.get(!0),q:this.formantQParameter.get(!0),gain:this.formantGainParameter.get(!0),effect:this.effect&&this.effect.getJson(),rolloff:this.rolloff,formantType:this.formantType};return t=Object(E.b)(t,"enabledParameter",this.enabledParameter,void 0,e),t=Object(E.b)(t,"formantFrequencyParameter",this.formantFrequencyParameter,void 0,e),t=Object(E.b)(t,"formantQParameter",this.formantQParameter,void 0,e),t=Object(E.b)(t,"formantGainParameter",this.formantGainParameter,void 0,e),t=Object(E.b)(t,"formantTypeParameter",this.formantTypeParameter,void 0,e)}},{key:"fromJson",value:function(e,t){var n={};if(e.rolloff&&Object(w.a)(this.formantRolloffParameter,e.rolloff,n),this.formantFilter&&(this.formantFilter.rolloff=this.rolloff),Object(w.a)(this.enabledParameter,e.enabled,n),this.enabledParameter.get(!0)){Object(w.a)(this.formantFrequencyParameter,e.frequency,n),Object(w.a)(this.formantQParameter,e.q,n),Object(w.a)(this.formantGainParameter,e.gain,n),e.formantType?Object(w.a)(this.formantTypeParameter,e.formantType,n):Object(w.a)(this.formantTypeParameter,"bandpass",n);(new Date).getTime();e.effect?this.loadEffectFromJson(e.effect):this.bypassEffect();(new Date).getTime();return n=Object(i.a)({},n,Object(E.a)(e,"formantFrequencyParameter",this.formantFrequencyParameter,this.sequencerEngine,t,!0)),n=Object(i.a)({},n,Object(E.a)(e,"formantQParameter",this.formantQParameter,this.sequencerEngine,t,!0)),n=Object(i.a)({},n,Object(E.a)(e,"formantTypeParameter",this.formantTypeParameter,this.sequencerEngine,t,!0)),n=Object(i.a)({},n,Object(E.a)(e,"formantGainParameter",this.formantGainParameter,this.sequencerEngine,t,!0))}this.bypassEffect()}},{key:"disconnectParameters",value:function(){}},{key:"ripMods",value:function(){}},{key:"isConnectedToAnyModulator",value:function(){return this.formantGainParameter.isConnectedToAnyModulator()||this.formantFrequencyParameter.isConnectedToAnyModulator()||this.formantQParameter.isConnectedToAnyModulator()}},{key:"dispose",value:function(){this.formantFilter&&this.formantGain&&(this.parameters.forEach(function(e){return e.dispose(!0)}),this.formantFilter.dispose(),this.formantFilter=void 0),this.effect&&(this.effect.dispose(),this.effect=void 0)}},{key:"getParameters",value:function(){var e=Object(b.a)(this.parameters);return this.effect&&(e=[].concat(Object(b.a)(e),Object(b.a)(this.effect.getParameters()))),e}}]),n}(function(e){Object(u.a)(n,e);var t=O(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).effect=void 0,e}return Object(c.a)(n,[{key:"useEffect",value:function(e){this.effect&&this.effect.dispose(),this.effect=e,this.effect.registerContext(this.context),this.formantGain.disconnect(),this.formantGain.connect(this.effect.effectNode),this.effect.connect(this.output)}},{key:"bypassEffect",value:function(){this.effect&&(this.effect.parameters,this.effect.dispose(),this.effect=void 0,this.formantGain.disconnect(),this.formantGain.connect(this.output))}},{key:"loadEffectFromJson",value:function(){var e=Object(o.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.effect&&t.name===this.effect.name?this.effect.fromJson(t,[],0):(n=Object(k.a)(t,[],this.sequencerEngine,void 0,this.context),this.useEffect(n.effect));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),n}(function(){return function e(){Object(s.a)(this,e)}}())),T=8,C=function(){function e(t){Object(s.a)(this,e),this.oscillator=t,this.input=new p.a.Gain(.3),this.output=new p.a.Gain(1),this.analyser=new p.a.Analyser("fft",256),this.input.connect(this.output),this.output.connect(this.analyser),this.bypassConnected=!0,this.formants=[];for(var n=0;n<T;n++)this.formants.push(new x(this,n))}return Object(c.a)(e,[{key:"dispose",value:function(){this.formants.forEach(function(e){return e.dispose()}),this.input.dispose(),this.output.dispose(),this.analyser.dispose(),this.input=void 0,this.output=void 0,this.analyser=void 0}},{key:"anyFormantsOn",value:function(){return this.formants.some(function(e){return e.enabled})}},{key:"numFormants",value:function(){return this.formants.filter(function(e){return e.enabled}).length}},{key:"enableFormants",value:function(){this.bypassConnected&&(this.input.disconnect(this.output),this.bypassConnected=!1)}},{key:"disableFormants",value:function(){this.bypassConnected||(this.input.connect(this.output),this.bypassConnected=!0)}}]),e}();function N(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var A=n(30).a.presets;t.a=function(e){return function(e){Object(u.a)(n,e);var t=M(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"loadFormantsPreset",value:function(){var e=Object(o.a)(a.a.mark(function e(t){var n,r,o,s,c,u,l,f,h,p,b,g,k,O,j,w,E,S,P;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.contentHash,e.next=3,d.a.getJson(n);case 3:if(r=e.sent,Array.isArray(r)&&(r={formants:r}),this.preset=new v.a,this.preset.contentHash=n,!(o=this.instrument)){e.next=16;break}return s=o.ampEnvelope.release,o.ampEnvelope.release=100,o.clearVoiceData(),o.loaded=!1,o.track.trackIsLoading=!0,e.next=16,Object(m.a)(100);case 16:if(c={},u=o?o.track.lfosTrack:this.sequencerEngine.currentSubSequence.lfosTrack,l=o?o.track.envelopesTrack:this.sequencerEngine.currentSubSequence.envelopesTrack,r.lfos){f=0,h=N(u.lfos);try{for(h.s();!(p=h.n()).done;)b=p.value,g=b.lfo,c=Object(i.a)({},c,g.fromJson(r.lfos[f++],!0))}catch(a){h.e(a)}finally{h.f()}}if(r.envelopes){k=0,O=N(l.envelopes);try{for(O.s();!(j=O.n()).done;)w=j.value,E=w.envelope,c=Object(i.a)({},c,E.fromJson(r.envelopes[k++],!0))}catch(a){O.e(a)}finally{O.f()}}for(S=0;S<this.formants.length;S++)P=this.formants[S],c=Object(i.a)({},c,P.fromJson(r.formants[S],!0));(o?o.track:this.track).sequencerEngine.dispatch(Object(y.Vb)(c)),o&&(o.loaded=!0,o.track.trackIsLoading=!1,o.ampEnvelope.release=s);case 25:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"saveFormantsAsPreset",value:function(e){var t=this,n={envelopes:this.instrument.track.envelopesTrack.envelopes.map(function(e){return e.getJson()}),lfos:this.instrument.track.lfosTrack.lfos.map(function(e){return e.getJson()}),formants:this.formantsManager.formants.map(function(e){return e.getJson(!0)})};A.newPreset(n,e,void 0,"formants",0).then(function(n){t.preset=new v.a,t.preset.contentHash=n,t.preset.name=e,console.log("returned x=",n)})}},{key:"formants",get:function(){return this.formantsManager.formants}},{key:"setupFormants",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.formantsManager=new C(this)}},{key:"initializeFormants",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.voices}},{key:"copyFormants",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"voiceHasFormant",value:function(e){return void 0!==e.formantFilters}},{key:"destroyFormants",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],!(arguments.length>1&&void 0!==arguments[1])||arguments[1],!(arguments.length>2&&void 0!==arguments[2])||arguments[2]}},{key:"getFormantsJson",value:function(e){return this.formants.map(function(t){return t.getJson(e)})}},{key:"loadFormantsJson",value:function(e,t){if(this.formants.forEach(function(e){return e.ripMods()}),p.a.Master.context.isOffline){var n={};for(var r in e)n=Object(i.a)({},n,this.formants[r].fromJson(e[r],t));return n}var a={},o=[];for(var s in e)o.push(this.formants[s]),a=Object(i.a)({},a,this.formants[s].fromJson(e[s],t));return this.formants.filter(function(e){return!o.includes(e)}).forEach(function(e){e.bypassEffect(),e.bypass()}),a}}]),n}(e)}},function(e,t,n){"use strict";var r=n(8),a=n(11),i=n(9),o=n(2),s=n(4),c=n(20),u=n(16),l=n(7),f=n(10),h=n(1),p=n(116),d=n(102),m=n(50),v=n(23),b=n(32),g=(n(248),n(453)),y=n(95),k=(n(524),n(21)),O=n(85),j=n(776),w=n(186),E=n(313),S=n(321),P=n(315),x=n(140);function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var C=n(432),N=n(101);function R(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}window.voicingTimes=[],window.flowTimes=[],window.networkBuildTimes=[];function q(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var _=function(e){Object(l.a)(n,e);var t=I(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Chords Rack",e,8)).initializeConfigurations(r.adjacencyLists),r.addChords(),r.initializeChordParameters(),r}return Object(s.a)(n,[{key:"addChords",value:function(){this.addEffect(new x.b(this,1)),this.addEffect(new x.b(this,2)),this.addEffect(new x.b(this,3)),this.addEffect(new x.b(this,4)),this.addEffect(new x.b(this,5)),this.addEffect(new x.b(this,6)),this.addEffect(new x.b(this,7)),this.addEffect(new x.b(this,0)),this.addEffect(new x.f(this,1)),this.addEffect(new x.f(this,3)),this.addEffect(new x.f(this,5)),this.effects[0].x=40,this.effects[0].y=47,this.effects[1].x=120,this.effects[1].y=18,this.effects[2].x=220,this.effects[2].y=16,this.effects[3].x=303,this.effects[3].y=43,this.effects[4].x=244,this.effects[4].y=76,this.effects[5].x=167,this.effects[5].y=99,this.effects[6].x=91,this.effects[6].y=86,this.effects[7].x=21,this.effects[7].y=145,this.effects[8].x=6,this.effects[8].y=200,this.effects[9].x=61,this.effects[9].y=200,this.effects[10].x=125,this.effects[10].y=200,this.connectNodes(this.effects[7],this.effects[8]),this.connectNodes(this.effects[7],this.effects[9]),this.connectNodes(this.effects[7],this.effects[10])}},{key:"clear",value:function(){this.counter=0,this.effects.forEach(function(e){return e.clear()}),this.triggers=[]}},{key:"isRack",get:function(){return!0}},{key:"clearCaching",value:function(){this.effects.forEach(function(e){e.subGraph=void 0,e.effects=void 0})}},{key:"addEffect",value:function(e){Object(u.a)(Object(h.a)(n.prototype),"addEffect",this).call(this,e),this.clearCaching(),e.rack=this}},{key:"connectNodes",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];(e=Object(u.a)(Object(h.a)(n.prototype),"connectNodes",this)).call.apply(e,[this].concat(r)),this.clearCaching()}},{key:"deleteEdge",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];(e=Object(u.a)(Object(h.a)(n.prototype),"deleteEdge",this)).call.apply(e,[this].concat(r)),this.clearCaching()}},{key:"deleteEffect",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];(e=Object(u.a)(Object(h.a)(n.prototype),"deleteEffect",this)).call.apply(e,[this].concat(r)),this.clearCaching()}},{key:"getJson",value:function(){return this.getRackJson()}},{key:"fromJson",value:function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t;this.adjacencyLists={},this.initializeConfigurations(this.adjacencyLists,!1),this.effects=[],this.loaded=!1;var s=Object(u.a)(Object(h.a)(n.prototype),"fromJson",this).call(this,e,t),c=e.effects;for(var l in c){var f=c[l],p=Object(w.a)(f,this.track);if(s=Object(r.a)({},s,p.fromJson(f,o)),p.id!==f.id){var d,m=q(e.configurations);try{for(m.s();!(d=m.n()).done;){var v=d.value,b=v[f.id];v[p.id]=b,delete v[f.id]}}catch(g){m.e(g)}finally{m.f()}}this.addEffect(p,!1),p.x=f._x||f.x,p.y=f._y||f.y}return this.fromRackJson(e,t),this.loaded=!0,s}}]),n}(Object(j.a)(function(e){return function(e){Object(l.a)(n,e);var t=A(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getAdjacentTransforms",value:function(e){return(this.adjacencyLists[e.id]||[]).map(function(e){return e.effect}).filter(function(e){return e.getChordEffectType()===x.e})}},{key:"getAdjacentVoices",value:function(e){var t=this.getChord(0),n=this.getChord(e),r=this.adjacencyLists[t.id]||[],a=this.adjacencyLists[n.id]||[];return[].concat(Object(i.a)(r),Object(i.a)(a)).map(function(e){return e.effect}).filter(function(e){return e.getChordEffectType()===x.d})}},{key:"getChordElements",value:function(e){return this.getAdjacentVoices(e).map(function(e){return e.degree})}},{key:"getChordVoicing",value:function(e){var t,n=[],r=R(this.getAdjacentVoices(e));try{for(r.s();!(t=r.n()).done;){var a=t.value,i=this.getAdjacentTransforms(a);0===i.length?n.push(0):n.push(i[0].value)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getFlowChordVoicing",value:function(e){var t=this;return function(n,r,a){if(!n)return[];var o,s,c=(new Date).getTime(),u=e(),l=t.getChord(u);if(l.subGraph)o=l.subGraph,s=l.effects;else{o={},s=[];var f=function(e){var n=t.effects.find(function(t){return t.id===e}),r=e;if(n.getChordEffectType()===x.a&&0===n.numeral)r=l.id;else if(n.getChordEffectType()===x.a&&n!==l)return"continue";var a=t.adjacencyLists[e].filter(function(e){return e.effect.getChordEffectType()!==x.a});o[r]?o[r]=[].concat(Object(i.a)(o[r]),Object(i.a)(a)):o[r]=a,s=[].concat(Object(i.a)(s),[n],Object(i.a)(a.map(function(e){return e.effect})))};for(var h in t.adjacencyLists)f(h);var p,d=R(s);try{for(d.s();!(p=d.n()).done;){var m=p.value;o[m.id]&&0!==o[m.id].length||(o[m.id]=[new C.a(t.outputNode,t.track.sequencerEngine)])}}catch(W){d.e(W)}finally{d.f()}l.subGraph=o,l.effects=s}t.effects.forEach(function(e){return e.active=!1});var v=l;n.voices=[];var b=new N.a(n,a,r);t.effects.forEach(function(e){e.onNewStep(),e.triggers.length=0}),window.networkBuildTimes.push((new Date).getTime()-c),l.input(b);var g=(new Date).getTime(),y=t.runFlow(a,r,r,v,[b],o),k=(new Date).getTime();window.flowTimes.push(k-g);var O,j={},w=R(y);try{for(w.s();!(O=w.n()).done;){var E,S=O.value,P=S.time,T=R(S.stepData.voices);try{for(T.s();!(E=T.n()).done;){var M=E.value,A=M.voice,q=M.octave,D=M.flat,I=M.thick,_=A+P;D&&(_+="+flat"+D),I&&(_+="+thick"+I),isNaN(q)||(_+="+"+q),j[_]={octave:q,time:P,voice:A,flat:D,thick:I}}}catch(W){T.e(W)}finally{T.f()}}}catch(W){w.e(W)}finally{w.f()}var F=[];for(var L in j){var B=j[L],z=B.time,V=B.octave,H=B.voice,U=B.flat,J=B.thick;F.push({voice:H,octave:V,time:z,flat:U,thick:J})}F.sort(function(e,t){return e.voice-t.voice});var G=(new Date).getTime();return window.voicingTimes.push(G-c),F}}},{key:"getStep",value:function(e){var t=this.cachedSteps[this.cacheIndex];return this.cacheIndex=(this.cacheIndex+1)%this.cachedSteps.length,t.voices=Object(i.a)(e.voices),t}}]),n}(e)}(function(e){Object(l.a)(n,e);var t=T(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"initializeChordParameters",value:function(){this.progressionStartParameter=new k.b("progressionStart",this,function(){return 0},{defaultValue:1,min:1,max:7}),this.registerParameter(this.progressionStartParameter)}},{key:"getChord",value:function(e){return this.effects.find(function(t){return t.numeral===e})}},{key:"getStartingChord",value:function(){return this.progressionStartParameter.get()}},{key:"getPossibleNextEffects",value:function(e){var t=this.getChord(e);return(this.adjacencyLists[t.id]||[]).map(function(e){return e.effect}).filter(function(e){return e.getChordEffectType()===x.a})}},{key:"getPossibleNextChords",value:function(e){return this.getPossibleNextEffects(e).map(function(e){return e.numeral})}},{key:"getNextChordEffect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.getPossibleNextEffects(e),r=this.getChord(e);return void 0!==r.nextChords[t]?r.nextChords[t]:n[0]||this.getChord(1)}},{key:"getNextChord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getNextChordEffect(e,t).numeral}}]),n}(Object(E.a)(Object(S.a)(Object(P.a)(O.a))))))),F=(n(105),n(390),n(344),n(279)),L=(n(444),n(153)),B=n(187),z=(n(348),n(48),n(115)),V=n(17),H=n(82);n(83);function U(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}n.d(t,"a",function(){return J}),window.chordTimes=[];Object(L.h)(Object(H.f)("- - . -"),Object(H.f)("- . - -"),Object(H.f)(". - - -"),Object(H.f)("- - - .")),Object(L.h)(Object(H.f)("- - ."),Object(H.f)("- . -"),Object(H.f)(". - -"));var J=function(e){Object(l.a)(n,e);var t=U(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Generative Chords",e)).chordProgression=new _(e,Object(c.a)(r)),r.progressionLengthParameter=new k.b("progressionLength",Object(c.a)(r),function(){return[]},{defaultValue:4,min:1,max:16}),r.registerParameter(r.progressionLengthParameter),r.currentChord=1,r.tidalString=". - . -",r.expressionSeries=[13,11,9,7],r.scaleParameter=new k.b("scale",Object(c.a)(r),function(){return[]},{defaultValue:g.b,min:1,max:3}),r.registerParameter(r.scaleParameter),r.connectedJakiEffect=void 0,r.newInlet(m.j),r.newInlet(m.h,function(){return r.reset()}),r.newOutlet(m.c),r}return Object(s.a)(n,[{key:"reset",value:function(){this.position=void 0}},{key:"getParameters",value:function(){return[].concat(Object(i.a)(this.parameters),Object(i.a)(this.chordProgression.getParameters()))}},{key:"tidalString",get:function(){return this._tidalString},set:function(e){this.tidalPattern=Object(H.f)(e)(),this._tidalString=e}},{key:"getNoteDegree",value:function(e){e=Object(y.a)(e,12);var t=this.shifted_scale().indexOf(e);return t%2===0?t+1:t+8}},{key:"getCurrentChordNotes",value:function(){return[]}},{key:"scale",get:function(){return this.scaleParameter.get()},set:function(e){this.scaleParameter.set(e,!1)}},{key:"progressionLength",get:function(){return this.progressionLengthParameter.get()}},{key:"getPossibleNextChords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentChord;return this.chordProgression.getPossibleNextChords(e)}},{key:"getNextChord",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentChord,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position;return this.chordProgression.getNextChord(e,t)}},{key:"chordElements",get:function(){var e=this;return this.chordProgression.getFlowChordVoicing(function(){return e.currentChord})}},{key:"output",value:function(){for(var e,t=(new Date).getTime(),r=this.triggers.length>0,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];var s=(e=Object(u.a)(Object(h.a)(n.prototype),"output",this)).call.apply(e,[this].concat(i)),c=(new Date).getTime();return r&&window.chordTimes.push(c-t),s}},{key:"clear",value:function(){var e=this;this.tidals&&this.tidals.forEach(function(e){return e.clear()}),this.freeTidals(),this.chordProgression.clear(),this.position=void 0;this.shifted_scale=Object(B.f)(function(){if(e.isInletConnected(m.j)){var t=e.receiveMessage(m.j);if(t[0]){var n=Object(a.a)(t[0],1)[0];return e._scale=n,n}if(e._scale)return e._scale}return g.d[e.scale]},function(){return e.currentChord-1});var t=0;this.myScript=Object(z.a)(function(e){return e&&(t=e.transpose),Object(V.w)(!0)},function(){return(arguments.length<=0?void 0:arguments[0])&&(void 0===e.position?(e.position=0,e.currentChord=e.chordProgression.getStartingChord(),e.sendMessage(m.c)):(e.position++,e.position>=e.progressionLength?(e.position=0,e.currentChord=e.chordProgression.getStartingChord(),e.sendMessage(m.c)):e.currentChord=e.getNextChord())),Object(V.w)(!0)},Object(F.b)(this.shifted_scale,this.chordElements,function(){return t}))}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}},{key:"fromJson",value:function(e){var t=Object(u.a)(Object(h.a)(n.prototype),"fromJson",this).call(this,e);return Object(b.a)(this.scaleParameter,e.scale,t),t=Object(r.a)({},t,Object(v.a)(e,"scaleParameter",this.scaleParameter)),Object(b.a)(this.progressionLengthParameter,e.progressionLength,t),t=Object(r.a)({},t,Object(v.a)(e,"progressionLengthParameter",this.progressionLengthParameter)),e.chordProgression&&(this.chordProgression.effects=[],t=Object(r.a)({},t,this.chordProgression.fromJson(e.chordProgression))),t}},{key:"getJson",value:function(){return Object(r.a)({},Object(u.a)(Object(h.a)(n.prototype),"getJson",this).call(this),{chordProgression:this.chordProgression.getJson()})}}]),n}(Object(d.a)(p.a))},function(e,t,n){"use strict";var r=n(39),a=n.n(r),i=(n(15),[{value:function(){return"128m"},label:"128"},{value:function(){return"64m"},label:"64"},{value:function(){return"32m"},label:"32"},{value:function(){return"16m"},label:"16"},{value:function(){return"8m"},label:"8"},{value:function(){return"4m"},label:"4"},{value:function(){return"2m"},label:"2"},{value:function(){return"1m"},label:"1"},{value:function(){return"2n"},label:"1/2"},{value:function(){return"4n"},label:"1/4"},{value:function(){return"4n."},label:"1/4."},{value:function(){return"4t"},label:"1/4t"},{value:function(){return"8n"},label:"1/8"},{value:function(){return"8n."},label:"1/8."},{value:function(){return"8t"},label:"1/8t"},{value:function(){return"16n"},label:"1/16"},{value:function(){return"16t"},label:"1/16t"},{value:function(){return"32n"},label:"1/32"}]);function o(e){e="function"===typeof e?e():e;var t=i.filter(function(t){return t.value()===e});return 0==t.length?i[0]:t[0]}n(8),n(9),n(33),n(6);var s=n(0),c=n.n(s),u=n(12);t.a=Object(u.b)(function(e,t){return{rate:t.lfo.lfoRate}},function(e){return{}})(function(e){return c.a.createElement("div",{className:"lfo-rate-dropdown"},c.a.createElement("div",{className:"lfo-rate-label"},"Rate:"),c.a.createElement(a.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:i,onChange:function(t){e.lfo.lfoRate=t.value()},value:o(e.lfo.lfoRate),placeholder:"LFO"}),c.a.createElement("div",{className:"clear-fix"}))})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=(n(1042),n(34)),o=n(76),s=(n(55),n(173),n(294)),c=n(89),u=n(163),l=n(12),f={1:"/FORWARD_DIRECTION.png",2:"/REVERSE_DIRECTION.png",3:"/FORWARD_REVERSE_DIRECTION.png",4:"/BROWNIAN_DIRECTION.png"},h=Object(l.b)(function(e,t){return{direction:(n=t.track,n.playheadEffect?n.playheadEffect.direction:u.b)};var n},function(e){return{}})(function(e){var t=e.track,n=(e.isSelected,e.direction),u=(e.color,Object(r.useCallback)(function(){var e=t.liveEffects.effects.find(function(e){return e.effect===c.e});e||(e=new s.a(t),t.liveEffects.addEffect(e));var r=n+1;r>4&&(r=1),e.directionParameter.set(r,void 0,void 0)},[t,n]));return a.a.createElement("div",{onClick:u,className:"pushable playhead-direction-btn"},a.a.createElement(o.a,{element:i.ib},a.a.createElement("img",{className:"playhead-direction-icon",src:f[n]})))}),p=Object(l.b)(function(e,t){return{speed:(n=t.track,n.playheadEffect?n.playheadEffect.speedFactor:1)};var n},function(e){return{}})(function(e){var t=e.track,n=e.speed,i=Object(r.useCallback)(function(){if(!t.playheadEffect){var e=new s.a(t);t.liveEffects.addEffect(e)}4===n?t.playheadEffect.speedFactorParameter.set(.25,!1):t.playheadEffect.speedFactorParameter.set(2*n,!1)},[n,t]);return a.a.createElement("div",{onClick:i,className:"track-speed-button pushable"},n,"x")}),d=n(33),m=n(6),v=new d.a(32,!1);t.a=Object(l.b)(null,function(e,t){return{setTrackToFreeze:function(){return e(Object(m.kh)(t.track.subSequence.id,t.track.trackNumber))}}})(function(e){var t=e.track,n=e.trackColor,s=e.trackLengthMode,c=e.setTrackLengthMode,u=e.resolution,l=e.isSelectedTrack,f=(e.setTrackToFreeze,e.children),d=t.sequencerEngine,m={};l&&(m={backgroundColor:n,color:"black"});var b="track-length-button";s&&(b+=" selected");var g=Object(r.useCallback)(function(){if(s){var e=v.transformStepAtResolution(t.sequencerEngine.state.tracks.trackLengthChoice,u);t.pattern.changeLength(e)}c(!s)},[s,t,u]);return a.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"track-footer-container"},a.a.createElement(o.a,{element:i.Gb},a.a.createElement("div",{style:m,onClick:function(){return d.doubleTrackLength(t.trackNumber)},className:"add-steps-button pushable"},"+")),a.a.createElement(o.a,{element:i.Pb},a.a.createElement("div",{style:m,onClick:function(){return d.halfTrackLength(t.trackNumber)},className:"remove-steps-button pushable"},"-")),a.a.createElement(o.a,{element:i.Ib},a.a.createElement("div",{style:m,onClick:g,className:b},"Len.")),f,a.a.createElement(h,{isSelected:l,color:n,track:t}),a.a.createElement(p,{isSelected:l,color:n,track:t}))})},function(e,t,n){"use strict";var r=n(9),a=n(0),i=n.n(a),o=n(11),s=n(34),c=n(76),u=n(12),l=Object(u.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.envelope,n=e.lfo,r=e.parameter,u=e.sequencerEngine,l=e.keyScaling,f=Object(a.useRef)(void 0),h=Object(a.useRef)(0),p=Object(a.useState)(!1),d=Object(o.a)(p,2),m=d[0],v=d[1],b=Object(a.useState)(!1),g=Object(o.a)(b,2),y=g[0],k=g[1],O=Object(a.useState)(r.min),j=Object(o.a)(O,2),w=j[0],E=j[1],S=Object(a.useState)(r.max),P=Object(o.a)(S,2),x=P[0],T=P[1],C=function(e){var t=e.parameter,n=e.lfo,r=e.envelope,a=(e.sequencerEngine,e.keyScaling),i=e.zoomMin,o=e.zoomMax,s=a||t.getParameterMod(r||n);if(s.scale||a){var c=o-i,u=(Math.min(s.min,s.max)-i)/c,l=(Math.max(s.min,s.max)-i)/c-u;u<0?u=0:u>1&&(u=1);var f={marginLeft:100*u+"%",width:100*l+"%"},h="modulator-indicator",p=0,d="modulator-thumb ";return n?(d+=" lfo-"+(p=t.availableLFOs.indexOf(n))+" toggled",h+=" lfo-"+p+" toggled"):r?(h+=" lfo-"+(p=t.availableEnvelopes.indexOf(r))+" toggled",d+=" lfo-"+p+" toggled env"):a&&(d+=" key-scaling",h+=" key-scaling"),{style:f,className:h,mod:s,num:p,thumbClass:d}}}({parameter:r,envelope:t,lfo:n,sequencerEngine:u,keyScaling:l,zoomMin:w,zoomMax:x}),N=Object(a.useState)(C&&C.mod.min),R=Object(o.a)(N,2),M=R[0],A=R[1],q=Object(a.useState)(C&&C.mod.max),D=Object(o.a)(q,2),I=D[0],_=D[1],F=C&&C.mod,L=Object(a.useCallback)(function(){(y||m)&&(k(!1),v(!1))},[y,m,k,v]),B=Object(a.useCallback)(function(e){if(y||m){var t=f.current.getBoundingClientRect(),n=e.clientX-t.left,r=t.width,a=w+n/r*(x-w);y?(F.min=a,A(a)):(F.max=a,_(a))}},[B,r,F,y,m,A,_,w,x]),z=function(e){return F.max-F.min>=1e3?Math.round(e):F.max-F.min>=100?Math.round(10*e)/10:Math.round(1e4*e)/1e4},V=Object(a.useCallback)(function(){var e=(I+x)/2;E((M+w)/2),T(e)},[E,T,M,I,w,x]),H=Object(a.useCallback)(function(e){var t=(new Date).getTime();if(t-h.current<=300)V();else{h.current=t;var n=f.current.getBoundingClientRect(),r=e.clientX-n.left,a=n.width;w+r/a*(x-w)>(F.max+F.min)/2?v(!0):k(!0)}},[F,k,v,w,x,E,T,I,M]),U=Object(a.useCallback)(function(e){if(u.state.keyboard.isCommandDown){var t=F.min,n=F.max;F.min=n,F.max=t,A(n),_(t)}L(e)},[A,_,y,m,k,v]);if(!C)return i.a.createElement("div",null);var J=C.style,G=C.className,W=(C.num,C.thumbClass,"modulator-control ");return l&&(W+=" key-scaling-control"),i.a.createElement(c.a,{className:"modulator-control-container",element:s.S},i.a.createElement("div",{draggable:!0,onDragStart:function(e){return e.preventDefault()},ref:f,onMouseUp:U,onMouseDown:H,onMouseMove:B,onMouseLeave:L,className:W},i.a.createElement("div",{className:G,style:J},i.a.createElement("div",{onMouseDown:function(e){e.stopPropagation(),F.min<F.max?k(!0):v(!0)},className:F.min<F.max?"small left-edge":"big left-edge"}),i.a.createElement("div",{onMouseDown:function(e){e.stopPropagation(),F.min<F.max?v(!0):k(!0)},className:F.min<F.max?"big right-edge":"small right-edge"})),i.a.createElement("div",{className:"mod-number"},y?"Min: "+z(F.min):m?"Max: "+z(F.max):"")))});n(2372),t.a=Object(u.b)(function(e,t){return t.parameter?{lfos:t.parameter.lfos,envs:t.parameter.envelopes,keyScaling:t.parameter.keyScaling}:{}},function(e){return{}})(function(e){var t=e.parameter,n=e.sequencerEngine;if(!n||!t||!t.lfos||!t.envelopes)return[];var a=Object(r.a)(t.lfos);a.sort(function(e,t){return e.number-t.number});var o=Object(r.a)(t.envelopes);return o.sort(function(e,t){return e.number-t.number}),i.a.createElement("div",{className:"modulator-controls"},a.map(function(e){return i.a.createElement(l,{key:e.number,sequencerEngine:n,lfo:e,parameter:t})}),o.map(function(e){return i.a.createElement(l,{key:e.number,sequencerEngine:n,envelope:e,parameter:t})}),t.keyScaling?i.a.createElement(l,{sequencerEngine:n,keyScaling:t.keyScaling,parameter:t}):"")})},function(e,t,n){"use strict";var r=n(9),a=n(8),i=n(11),o=n(0),s=n.n(o),c=n(274),u=n(535),l=n(12);function f(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t=e.modulator,n=e.parameter,r=e.i,a=e.height,i=e.color,o=e.setSelectedEdge,c=e.selectedEdge,u=25+48*r,l="LFO"===t.getType()?0:4,f=15+33*(t.number-1)+33*l,h=a-18,p=c&&c.modulator===t&&c.parameter===n;return s.a.createElement("g",null,s.a.createElement("line",{onMouseDown:function(e){e.stopPropagation(),o({modulator:t,parameter:n})},x1:u,y1:2,x2:f,y2:h,strokeWidth:4,opacity:0,stroke:i}),s.a.createElement("line",{onMouseDown:function(e){e.stopPropagation(),o({modulator:t,parameter:n})},className:p?"mod-edge selected":c?"mod-edge hidden":"mod-edge",x1:u,y1:2,x2:f,y2:h,strokeWidth:2,stroke:i}))},d=Object(l.b)(function(e,t){return t.parameter?{lfos:t.parameter.lfos.length,envelopes:t.parameter.envelopes.length}:{}},function(e){return{}})(function(e){var t=e.parameter;e.i,e.height,e.color,e.selectedEdge,e.setSelectedEdge;if(void 0===t)return[];var n,r=[],a=f(t.lfos);try{for(a.s();!(n=a.n()).done;){var i=n.value;r.push(s.a.createElement(p,Object.assign({},e,{modulator:i})))}}catch(l){a.e(l)}finally{a.f()}var o,c=f(t.envelopes);try{for(c.s();!(o=c.n()).done;){var u=o.value;r.push(s.a.createElement(p,Object.assign({},e,{modulator:u})))}}catch(l){c.e(l)}finally{c.f()}return r}),m=n(104),v=Object(l.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.modulator,n=e.i,r=(e.width,e.height),a=e.lineDragging,i=e.setLineDragging,c=e.el,u=2+33*n,l=r-15,f=Object(o.useCallback)(function(e){var n=c.current.getBoundingClientRect(),r=e.clientX-n.left,a=e.clientY-n.top;i({x1:r,y1:a,x2:r,y2:a,modulator:t})},[i,c]),h=Object(o.useCallback)(function(e){if(a){var n=a.parameter;n.isAudioParamEnabled()||n.enableAudioParam(),"LFO"===t.getType()?n.connectToLFO(t):n.connectToEnvelope(t)}},[a,i,t]);return s.a.createElement("g",null,s.a.createElement("circle",{onMouseUp:h,onMouseDown:f,cx:u+14,cy:l-3,r:3}),s.a.createElement("rect",{x:u,y:l,width:30,height:15,fill:"gray"}),s.a.createElement("text",{x:u+2,y:l+14},t.name))});t.a=Object(l.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,l=e.parameters,f=e.width,h=void 0===f?260:f,p=e.height,b=void 0===p?40:p,g=e.color,y=Object(o.useState)(void 0),k=Object(i.a)(y,2),O=k[0],j=k[1],w=Object(o.useState)(void 0),E=Object(i.a)(w,2),S=E[0],P=E[1],x=Object(o.useRef)(void 0),T=Object(c.a)({ref:x,effect:t}).preventDragging;Object(o.useEffect)(function(){return window.addEventListener("keydown",C),function(){return window.removeEventListener("keydown",C)}},[S,P]);var C=Object(o.useCallback)(function(e){if("INPUT"!==e.target.tagName&&"Backspace"===e.key&&S){var t=S.modulator,n=S.parameter;t.getType()===m.b?n.disconnectFromLFO(t):n.disconnectFromEnvelope(t),P(void 0)}},[S,P]),N=Object(o.useCallback)(function(e,t){if(O&&t){var n=O.modulator;t.isAudioParamEnabled()||t.enableAudioParam(),n.getType()===m.b?t.connectToLFO(n):t.connectToEnvelope(n)}},[O,j]),R=Object(o.useCallback)(function(e){if(O){var t=x.current.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top,i=Object(a.a)({},O,{x2:n,y2:r});j(i)}},[O,j]),M=function(e){return 25+48*l.indexOf(e)},A=Object(o.useCallback)(function(e,t){var n=x.current.getBoundingClientRect(),r=e.clientX-n.left,a=e.clientY-n.top;j({x1:r,y1:a,x2:r,y2:a,parameter:t})},[j,x]),q=[].concat(Object(r.a)(n.lfos.map(function(e){return e.lfo})),Object(r.a)(n.envelopes));return s.a.createElement("div",{ref:x,className:"mod-routes"},s.a.createElement("svg",{onMouseDown:function(){T(!1),P(void 0)},onMouseUp:function(){T(!0),j(void 0)},onMouseMove:R,height:b,width:h},O?s.a.createElement("line",{x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,stroke:"red",strokeWidth:1}):[],l.map(function(e,t){return s.a.createElement("g",{key:"fuck-yeah-"+t},s.a.createElement("circle",{key:"circle-yeah-"+t,onMouseDown:function(t){return A(t,e)},onMouseUp:function(t){return N(t,e)},cx:M(e),cy:2,r:3,fill:"black"}),s.a.createElement(d,{key:t,selectedEdge:S,setSelectedEdge:P,i:t,color:g,parameter:e,height:b}))}),q.map(function(e,t){return s.a.createElement(v,{key:t,el:x,setLineDragging:j,lineDragging:O,i:t,width:h,height:b,modulator:e})})),S?s.a.createElement(u.a,{parameterMod:S.parameter.parameterMods.find(function(e){return e.modulator===S.modulator})}):"")})},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=function(){function e(t,n){Object(o.a)(this,e),this.wasm=t,this.wasm.decoder_init(),this.wasm.decoder_set_mp3_data_size(n.byteLength),new Uint8Array(this.wasm.memory.buffer,this.wasm.decoder_mp3_data_offset(),this.wasm.decoder_mp3_data_size()).set(n),this.duration=this.seek(-1),this.seek(0)}return Object(s.a)(e,[{key:"seek",value:function(e){return this.wasm.decoder_seek(e),this.currentTime()}},{key:"decode",value:function(e){var t=this.currentTime();this.wasm.decoder_decode(e);var n=new Int16Array(this.wasm.memory.buffer,this.wasm.decoder_pcm_data_offset(),this.wasm.decoder_pcm_data_size()/2),r=this.wasm.decode_results_sampling_rate(),a=this.wasm.decode_results_num_channels(),i=this.wasm.decode_results_num_samples();return{pcm:n,startTime:t,duration:i/a/r,samplingRate:r,numChannels:a,numSamples:i}}},{key:"currentTime",value:function(){return this.wasm.decoder_current_time()}}]),e}();function u(e,t){return l.apply(this,arguments)}function l(){return(l=Object(i.a)(a.a.mark(function e(t,n){var r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=n||"decoder.opt.wasm",e.next=3,fetch(n);case 3:return r=e.sent,e.next=6,r.arrayBuffer();case 6:return i=e.sent,e.next=9,WebAssembly.instantiate(i,{});case 9:return o=e.sent,e.abrupt("return",new c(o.instance.exports,t));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}n(222),n(75);var f=n(15),h=n.n(f);n.d(t,"a",function(){return p});var p=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,l,f,p,d,m,v;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.isNFT?"decoder.opt.wasm":"/decoder.opt.wasm",console.log("DECODE URL =",n),e.next=4,u(t,n);case 4:for(r=e.sent,i=new Uint16Array(6*t.length),o=0,r.seek(0),0,s=r.decode(330),s.samplingRate,i.set(s.pcm,o),o+=s.pcm.length,c=h.a.Master.context,l=c.createBuffer(2,o/2,44100),f=l.getChannelData(0),p=l.getChannelData(1),d=0;d<i.length;d+=2)m=i[d],v=i[d+1],f[d/2]=m>=32768?-(65536-m)/32768:m/32767,p[d/2]=v>=32768?-(65536-v)/32768:v/32767;return e.abrupt("return",l);case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(247),s=n(12),c=n(86),u=n(261),l=n(39),f=n.n(l),h=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,r=e.track,o=e.onChange,s=e.onDelete,l=e.noSelect,h="";t&&(h=i.a.createElement(u.a,{sequencerEngine:n,noSelect:l,track:r,compact:!0,instrument:!0,onDeleteEffect:s,effect:t,send:void 0}));var p=Object(a.useCallback)(function(e){var t=Object(c.b)(e.value,n);t.enable(!0),t.wetParameter&&t.wetParameter.set(1),o(t)},[o,n]);return i.a.createElement("div",null,i.a.createElement(f.a,{className:"send-effects-dropdown",options:c.a,onChange:p,option:t&&c.a.find(function(e){return e.label===t.name}),placeholder:"Audio FX"}),h)});t.a=Object(s.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.formant,n=e.sequencerEngine,s=e.track,c=Object(a.useRef)(),u=Object(a.useState)(t.effect),l=Object(r.a)(u,2),f=l[0],p=l[1];Object(o.a)(c),Object(a.useEffect)(function(){t&&p(t.effect)},[t]);var d=Object(a.useCallback)(function(e){t.useEffect(e),p(e)},[p,t]),m=Object(a.useCallback)(function(){p(void 0),t.bypassEffect()},[f,p,t]);return i.a.createElement("div",{onDragStart:function(e){e.stopPropagation(),e.preventDefault()},ref:c,className:"formant-effect"},i.a.createElement("div",{className:"sub-header"},"Formant ",t.number+1," FX"),i.a.createElement(h,{track:s,sequencerEngine:n,onDelete:m,noSelect:!0,effect:f,onChange:d}))})},function(e,t,n){"use strict";var r=n(11),a=n(2),i=n(4),o=n(33),s=n(9);function c(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=new o.a(32,!1),f=function(e,t){for(var n=[],r=Math.floor(t);r>=0;r--){var a,i=c(e.getAllOnStepAtResolutionAtAnyPosition(r,l));try{for(i.s();!(a=i.n()).done;){var o=a.value;r+2*o.duration>t&&n.push(o)}}catch(s){i.e(s)}finally{i.f()}}return n},h=function(e,t,n){var r=[],a=e.stepBuckets[t];for(var i in a.steps)parseFloat(i)>=n&&(r=[].concat(Object(s.a)(r),Object(s.a)(a.steps[i].getPolyphony().filter(function(e){return e.on}))));return r},p=function(e,t,n){var r=[],a=e.stepBuckets[t];for(var i in a.steps)parseFloat(i)<=n&&(r=[].concat(Object(s.a)(r),Object(s.a)(a.steps[i].getPolyphony().filter(function(e){return e.on}))));return r},d=function(e,t){var n=null===e.transpose?(void 0).trackData.transpose:e.transpose;return n<=t.transpose&&n>t.transpose-t.numNotes},m=n(178),v=n(443),b=n(128);function g(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var k=new o.a(32,!1),O=new o.a(32,!0),j=function(){function e(t,n){Object(a.a)(this,e),this.pattern=t,this.trackData=n}return Object(i.a)(e,[{key:"getStep",value:function(e,t,n){var r=this;return this.pattern.getStepAtResolution(e,t,function(e){return null===e.transpose&&n===r.trackData.transpose||e.transpose===n})}},{key:"getStepsAtStepNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k;return this.pattern.getPolyphonicStepsAtResolution(e,t)}},{key:"getStepWithTranspose",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=this.pattern.getAllOnStepAtResolutionAtAnyPosition(e,t,a).filter(function(e){return e.on&&(null===(t=e).transpose&&n===r.trackData.transpose||Math.round(t.transpose)===n);var t});if(i.length>0)return i[0]}},{key:"deleteStepsAtStepNumber",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t.isTriplet?(e=O.transformStepAtResolution2(e,t),this.pattern.tripletStepBuckets[e]=new b.a(this.pattern.track,!0)):(e=k.transformStepAtResolution2(e,t),this.pattern.stepBuckets[e]=new b.a(this.pattern.track)),n&&this.update(t.isTriplet)}},{key:"deleteStepAtStepNumber",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];t=this.getStepNumber(t,n);var a=n.isTriplet?this.pattern.tripletStepBuckets[t]:this.pattern.stepBuckets[t];if(void 0!==a){for(var i in a.steps){var o=a.steps[i],s=o.deleteStep(e);if(s===v.a){delete a.steps[i];break}if(void 0!==s&&s!==o){a.steps[i]=s;break}}a.anyOn()||a.clear(),r&&this.update(n.isTriplet)}}},{key:"deleteStep",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.pattern.stepBucketsMatrix;for(var r in Object(m.b)(e),n){var a=n[r];if(a){for(var i in a.steps){var o=a.steps[i].deleteStep(e);if(o===v.a){delete a.steps[i];break}if(void 0!==o){a.steps[i]=o;break}}a.anyOn()||a.clear()}}t&&this.update()}},{key:"addStep",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];e.track=this.pattern.track;var s=k.transformStepAtResolution2(t,n);o&&t>=this.pattern.length(n)&&this.pattern.changeLength(s+2*e.duration,!1);var c=this.pattern.getStepAtResolution(t,n,function(){return!0},r);if(void 0===c||i||(e=c.addStep(e)),this.pattern.setStepAtResolution(e,t,n,r),a)if(n.isTriplet)this.update(n.isTriplet);else{var u=k.transformStepAtResolution2(t,n);this.pattern.stepBucketsMatrix[u]=this.pattern.stepBuckets[u],this.pattern.needsSync=!0}return e}},{key:"getSelectedSteps",value:function(e,t){for(var n=[],r=e.fromStep;r<=e.toStep;r++){var a=this.pattern.getAllOnStepAtResolutionAtAnyPosition(r,t);n=n.concat(a)}return n}},{key:"getAllIntersectingSteps",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,a=[],i=e;i>=n;i--){var o,s=Math.floor(i),c=g(this.pattern.getAllOnStepAtResolutionAtAnyPosition(s,t));try{for(c.s();!(o=c.n()).done;){var u=o.value;s+u.duration>(r?e:Math.floor(e))&&a.push(u)}}catch(l){c.e(l)}finally{c.f()}}return a}},{key:"getSelectedPianoRollSteps",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(r)return function(e){var t=e.pattern,n=e.selection,r=e.resolution,a=(e.checkIntersection,l.transformStepAtResolution2(n.stepNumber,r)),i=l.transformStepAtResolution2(n.stepNumber+n.numSteps,r),o=[];o=[].concat(Object(s.a)(o),Object(s.a)(f(t,a))),o=[].concat(Object(s.a)(o),Object(s.a)(h(t,Math.floor(a),a-Math.floor(a))));for(var c=Math.ceil(a);c<Math.floor(i);c++){var u=t.stepBuckets[c];o=[].concat(Object(s.a)(o),Object(s.a)(u.getAllOnSteps()))}return o=[].concat(Object(s.a)(o),Object(s.a)(p(t,Math.floor(i),i-Math.floor(i)))),Array.from(new Set(o)).filter(function(e){return d(e,n)})}({pattern:this.pattern,selection:e,resolution:t});for(var a=[],i=void 0,o=e.stepNumber+e.numSteps,c=!0,u=e.stepNumber;u<=e.stepNumber+e.numSteps;u++){var m=r?this.getAllIntersectingSteps(u,t,i,c):this.pattern.getAllOnStepAtResolutionAtAnyPosition(u,t);c=!1;var v=m.filter(function(t){return n.isStepSelected(t,e)});a=a.concat(v),i=u}if(r&&Math.floor(i)<Math.floor(o)){var b=k.transformStepAtResolution2(o,t),g=this.pattern.getAllOnStepAtResolutionBeforePosition(Math.floor(b),k,b-Math.floor(b)).filter(function(t){return n.isStepSelected(t,e)});a=a.concat(g)}return Array.from(new Set(a))}},{key:"getStepNumber",value:function(e,t){return t.isTriplet?O.transformStepAtResolution2(e,t):k.transformStepAtResolution2(e,t)}},{key:"isStepSelected",value:function(e,t){var n=null===e.transpose?this.trackData.transpose:e.transpose;return n<=t.transpose&&n>t.transpose-t.numNotes}},{key:"getStepNumbers",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];for(var a in e){var i=e[a],o=this.findStepNumber(i,t,n);r.push([i,o])}return r}},{key:"transformSteps",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];(new Date).getTime();if(0===n.stepDifference&&0===n.transposeDifference)return e;var o=t.some(function(e){return e[1]+e[0].position+n.stepDifference<=0});if(a&&o&&n.stepDifference<0)return e;for(var s in t){var c=t[s][0],u=t[s][1];this.deleteStepAtStepNumber(c,u,r,!1)}var l=[],f={},h=this.pattern.length(r);for(var p in t){var d=t[p][0],m=t[p][1],v=m,b=null===d.transpose?this.trackData.transpose:d.transpose;if(isNaN(n.stepDifference)&&(n.stepDifference=0),d.transpose=b+n.transposeDifference,m+=d.position+n.stepDifference,!isNaN(m)){m<0?a?(m=0,d.position=0):m=h+m:a&&(m%=h);var g=Math.floor(m),y=m-g;d.position=y,v!==g&&(f[v]=g),this.addStep(d,g,r,y,!1),l.push(d)}}return i&&!r.isTriplet?(this.pattern.clearCache(),this.pattern.syncMatrixBySteps(f,r)):i&&this.update(r.isTriplet),l}},{key:"snapToGrid",value:function(e,t){var n=this.getStepNumbers(e,t);for(var r in n){var a=n[r][0],i=n[r][1];a.position;this.deleteStepAtStepNumber(a,i,t,!1)}var o=t.isTriplet;for(var s in n){var c=n[s][0],u=Math.round(n[s][1]);c.position=0,this.addStep(c,u,t,0,!1)}this.update(o)}},{key:"findStepNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.isTriplet?this.pattern.tripletStepBucketsMatrix:this.pattern.stepBucketsMatrix;for(var a in r){var i=r[a];if(void 0!==i)for(var o in i.steps){if(i.steps[o].hasStep(e))return t.transformStepAtResolution2(n?parseFloat(a)+parseFloat(o):a,t.isTriplet?O:k)}}}},{key:"findStepNumberAndDelete",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.pattern.stepBucketsMatrix;for(var a in r){var i=r[a];for(var o in i.steps){var s=i.steps[o].deleteStep(e);if(void 0!==s)return i.steps[o]=s,n&&this.update(t.isTriplet),t.transformStepAtResolution2(a,t.isTriplet?O:k)}}}},{key:"deleteSteps",value:function(e){var t=this;e.forEach(function(e){return t.deleteStep(e,!1,void 0,!0)}),this.update()}},{key:"getAllSteps",value:function(){var e=[],t=this.pattern.stepBuckets;for(var n in t){var r=t[n];for(var a in r.steps){var i=r.steps[a];e=e.concat(i.getPolyphony().filter(function(e){return e.on}))}}return e}},{key:"pasteSteps",value:function(e,t,n,r){if(void 0!==e&&void 0!==t){var a=n.getStepNumbers(e,r),i=6e4;for(var o in a){var s=a[o][1];s<i&&(i=s)}for(var c in a)a[c][1]-=i;var u=t.stepNumber,l=[];for(var f in a){var h=a[f][0].getCopy(!0,!1,!1,!0,!1,!1),p=u+a[f][1];l.push(this.addStep(h,p,r,h.position,!1))}return this.update(r.isTriplet),l}}},{key:"getFirstStepNumber",value:function(e,t){var n,a=1/0,i=g(this.getStepNumbers(e,t));try{for(i.s();!(n=i.n()).done;){var o=n.value,s=Object(r.a)(o,2),c=s[0],u=s[1];u<a&&(a=u,c)}}catch(l){i.e(l)}finally{i.f()}return a}},{key:"getFirstOnStep",value:function(e){var t,n=0,r=g(this.pattern.stepBuckets);try{for(r.s();!(t=r.n()).done;){if(t.value.getAnyOnStep())return e.transformStepAtResolution2(n,k);n++}}catch(a){r.e(a)}finally{r.f()}return 0}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pattern.calculateFills(this.trackData),this.pattern.clearCache(),this.pattern.syncBuckets(e)}}]),e}();t.a=j},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(116),u=n(115),l=(n(172),n(615),n(255),n(8)),f=n(17);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,"Stats",e)).mem={},a.clear(),a}return Object(a.a)(n,[{key:"isRealTime",value:function(){return!0}},{key:"clear",value:function(){this.myScript=Object(u.a)(function(){var e={},t={},n=void 0,r=0,a=void 0;return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var c=o[0],u=o[1],h=(o[2],o[3]);return u=h.track.sequencerEngine.trackStep,c&&c.track.length>r&&(r=c.track.length),u%=r,c&&!t[c.track.id]&&(t[c.track.id]={},t[c.track.id][u]=0),n!==u&&(c&&(t[c.track.id][u]=0),e[u]=0),c&&(e[u]++,t[c.track.id][u]++,isNaN(t[c.track.id][u])&&(t[c.track.id][u]=0),e[u]>a&&(a=e[u])),n=u,h.mem=Object(l.a)({},e),h.trackMem=Object(l.a)({},t),h.maxTriggers=a,h.maxLength=r,Object(f.w)(!0)}}())}},{key:"script",get:function(){return this.myScript}},{key:"getCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(r.getJson(),t),r}}]),n}(c.a);t.a=p},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(16),s=n(7),c=n(10),u=n(1),l=n(56),f=n(32),h=n(15),p=n.n(h),d=(n(41),n(9));function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(e){Object(s.a)(n,e);var t=m(n);function n(e){var r,i,o;Object(a.a)(this,n);return(o=t.call(this,"Phase Shift Allpass",function(){return new p.a.Gain(1)},e))._bank0=o._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),o._bank1=o._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),o._oneSampleDelay=p.a.context.createIIRFilter([0,1],[1,0]),o.output=new p.a.Gain(1),o.offset90=new p.a.Gain(1),(r=o.effectNode).chain.apply(r,Object(d.a)(o._bank0).concat([o._oneSampleDelay,o.output])),(i=o.effectNode).chain.apply(i,Object(d.a)(o._bank1).concat([o.offset90])),o}return Object(i.a)(n,[{key:"connect",value:function(e){this.output.connect(e)}},{key:"disconnect",value:function(e){this.output.disconnect(e)}},{key:"_createAllPassFilterBank",value:function(e){return e.map(function(e){var t=[[e*e,0,-1],[1,0,-e*e]];return p.a.context.createIIRFilter(t[0],t[1])})}}]),n}(l.a.Effect),b=n(132);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}n.d(t,"a",function(){return y});var y=function(e){Object(s.a)(n,e);var t=g(n);function n(e){var r;Object(a.a)(this,n),(r=t.call(this,"Freak Shifter",function(){return new p.a.Gain(1)},e)).output=new p.a.Gain(1),r._sine=new p.a.Oscillator(0,"sine"),r._cosine=new p.a.Oscillator(0,"sine"),r._cosine.phase=-90,r.frequencyParameter=new b.a("frequency",[r._sine.frequency,r._cosine.frequency],{defaultValue:1,min:1,max:1e4}),r.registerParameter(r.frequencyParameter),r._sineMultiply=new p.a.Multiply(0),r._cosineMultiply=new p.a.Multiply(0),r._negate=new p.a.Negate,r._add=new p.a.Add,r._phaseShifter=new v(e),r.effectNode.connect(r._phaseShifter.effectNode),r._phaseShifter.offset90.connect(r._cosineMultiply),r._cosine.connect(r._cosineMultiply.input[1]),r._phaseShifter.connect(r._sineMultiply),r._sine.connect(r._sineMultiply.input[1]),r._sineMultiply.connect(r._negate),r._cosineMultiply.connect(r._add),r._negate.connect(r._add.input[1]),r._add.connect(r.output);var i=p.a.Master.context.currentTime+.01;return r._sine.start(i),r._cosine.start(i),r}return Object(i.a)(n,[{key:"connect",value:function(e){this.output.connect(e)}},{key:"disconnect",value:function(e){this.output.disconnect(e)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}},{key:"getJson",value:function(){var e=Object(r.a)({},Object(o.a)(Object(u.a)(n.prototype),"getJson",this).call(this),{frequency:this.frequencyParameter.get(!0)});return e=this.saveParameterToJson(e,"frequencyParameter",this.frequencyParameter)}},{key:"fromJson",value:function(e,t){var a=Object(o.a)(Object(u.a)(n.prototype),"fromJson",this).call(this,e,t);return Object(f.a)(this.frequencyParameter,e.frequency,a),a=Object(r.a)({},a,this.loadParameterFromJson(e,"frequencyParameter",this.frequencyParameter,t))}}]),n}(l.a.Effect)},function(e,t,n){"use strict";var r=n(39),a=n.n(r),i=[{value:"square",label:"Square"},{value:"sine",label:"Sine"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"}];function o(e){for(var t=0;t<i.length;t++)if(i[t].value===e)return i[t];return null}var s=n(0),c=n.n(s),u=n(12);t.a=Object(u.b)(function(e,t){return{lfoType:t.lfo.lfoType}},function(e){return{}})(function(e){return c.a.createElement("div",{className:"osc-type-dropdown-container"},c.a.createElement(a.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:i,onChange:function(t){e.lfo.lfoType=t.value},value:o(e.lfo.lfoType),placeholder:"LFO"}),c.a.createElement("div",{className:"clear-fix"}))})},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(7),u=n(10),l=n(1),f=n(0),h=n.n(f),p=n(11),d=n(75),m=n(354),v=n(12),b=n(1071),g=(Object(v.b)(function(e,t){return{convolverSample:t.effect.convolverSample,buffer:t.effect.effectNode.buffer,pitch:t.effect.pitch,attack:t.effect.attack,duration:t.effect.duration}},function(e){return{}})(function(e){var t=e.effect,n=e.convolverSample,r=e.pitch,a=e.duration,i=e.attack,o=Object(f.useRef)(0),s=Object(f.useState)(n+r+a+i),c=Object(p.a)(s,2),u=c[0],l=c[1],v=Object(f.useState)(new m.a),g=Object(p.a)(v,2),y=g[0];g[1];Object(f.useEffect)(function(){o.current=o.current+1;var e=o.current;setTimeout(function(){console.log("c = %s counter=%s",e,o.current),e===o.current&&t.effectNode.buffer&&(console.log("setting buffer =",t.effectNode.buffer._buffer),l(n+a+r+i+e))},100)},[n,l,t.effectNode.buffer,r,a,i]),y.setBuffer(t.effectNode.buffer._buffer);var k=new d.a(u);return h.a.createElement(b.a,{audioUnit:y,sequencerEngine:t.sequencerEngine,buffer:t.effectNode.buffer,id:u,sample:k,width:180,height:30})}),n(47)),y=(n(39),n(110)),k=n(148),O=n(6),j=n(30),w=n(38);n(22);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var S=function(e){Object(c.a)(n,e);var t=E(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={reverbEffect:e.reverbEffect},r.getConvolverType(),r.getConvolverThumbnail(),r}return Object(s.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return e.reverbEffect!==this.props.reverbEffect&&(this.state.reverbEffect=e.reverbEffect,this.getConvolverType(),this.getConvolverThumbnail()),e.sample!==this.props.sample&&(this.getConvolverType(),this.getConvolverThumbnail()),!0}},{key:"handleConvolverTypeChange",value:function(e){this.state.reverbEffect.setConvolverType(e),this.getConvolverType(),this.getConvolverThumbnail(),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.isEnabled}},{key:"getConvolverThumbnail",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.reverbEffect).convolverSample){e.next=10;break}return n=new d.a(t.convolverSample),e.next=5,n.load(!1);case 5:if(void 0!==(r=n.getThumbnail())&&""!==r){e.next=9;break}return this.setState({thumbnail:void 0}),e.abrupt("return");case 9:this.setState({thumbnail:r});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getConvolverType",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.reverbEffect).convolverSample){e.next=9;break}return e.next=4,j.a.getTitleForSound(t.convolverSample);case 4:n=e.sent,this.state.convolverType={label:n,value:t.convolverSample},this.setState(this.state),e.next=13;break;case 9:r=P.filter(function(e){return e.value===t.convolverType}),this.state.convolverType=r[0],this.state.thumbnail=void 0,this.setState(this.state);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"upload",value:function(e){var t=this,n=new FileReader;e.name.includes(".wav")||e.name.includes(".flac")||e.name.includes(".mp3")?(n.readAsArrayBuffer(e),n.onloadend=Object(i.a)(a.a.mark(function e(){var r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.result,e.next=3,g.a.addArrayBuffer(r);case 3:return i=e.sent,console.log("CONVOLVER HASH = ",i),e.next=7,t.props.reverbEffect.setConvolverSample(i);case 7:return e.next=9,t.getConvolverType();case 9:return e.next=11,t.getConvolverThumbnail();case 11:case"end":return e.stop()}},e)}))):window.alert("Only accepts .wav, .mp3, & .flac files for now")}},{key:"onDrop",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),t.preventDefault(),t.dataTransfer.effectAllowed="none",t.dataTransfer.dropEffect="none",t.dataTransfer.items)for(t.dataTransfer.items.length,n=0;n<t.dataTransfer.items.length;n++)"file"===t.dataTransfer.items[n].kind&&this.upload(t.dataTransfer.items[n].getAsFile());if(!this.props.sampleDragging){e.next=14;break}return t.stopPropagation(),e.next=9,this.props.reverbEffect.setConvolverSample(this.props.sampleDragging.getId());case 9:return e.next=11,this.getConvolverType();case 11:return e.next=13,this.getConvolverThumbnail();case 13:this.props.setSampleDragging(void 0);case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;this.state.reverbEffect.getWet(),void 0!==this.props.automation||this.state.reverbEffect.isEnabled();return h.a.createElement("div",{onDrop:function(t){return e.onDrop(t)}},this.isEnabled()?h.a.createElement("div",null,h.a.createElement("div",{className:"convolver-type"},this.state.convolverType?this.state.convolverType.label:""),h.a.createElement(w.a,{condition:this.state.thumbnail},h.a.createElement("img",{className:"convolver-thumbnail",src:this.state.thumbnail})),h.a.createElement("div",{className:"convolver-row"},h.a.createElement(k.a,{scrollContainer:this.props.scrollContainer,min:-24,max:24,name:"Pitch",parameter:this.state.reverbEffect.pitchParameter}),h.a.createElement(k.a,{scrollContainer:this.props.scrollContainer,min:0,max:100,name:"Start",parameter:this.state.reverbEffect.startParameter}),h.a.createElement(k.a,{scrollContainer:this.props.scrollContainer,min:0,max:100,name:"Attack",parameter:this.state.reverbEffect.attackParameter}),h.a.createElement(k.a,{scrollContainer:this.props.scrollContainer,min:.5,max:100,name:"Release",parameter:this.state.reverbEffect.durationParameter})),h.a.createElement(y.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.reverbEffect})):"")}}]),n}(f.Component),P=[{value:"Giant Cave",label:"Giant Cave"},{value:"Hangar",label:"Airport Hangar"},{value:"Airport Terminal",label:"Airport Terminal"},{value:"Outdoor Blastoff",label:"Outdoor Blastoff"},{value:"Outdoor Stadium",label:"Outdoor Stadium"},{value:"Plate Large",label:"Plate Large"},{value:"Plate Medium",label:"Plate Medium"},{value:"Plate Small",label:"Plate Small"},{value:"Plate Super Dry",label:"Plate Super Dry"},{value:"Prime Long",label:"Prime Long"},{value:"Prime Medium",label:"Prime Medium"},{value:"Prime Short",label:"Prime Short"},{value:"Prime Extra Long",label:"Prime Extra Long"},{value:"Room Concert Hall",label:"Room Concert Hall"},{value:"Room Huge",label:"Room Huge"},{value:"Room Large",label:"Room Large"},{value:"Room Medium",label:"Room Medium"},{value:"Room Pool",label:"Room Pool"}];t.a=Object(v.b)(function(e,t){return{sampleDragging:e.selector.sampleDragging,isEnabled:t.reverbEffect.enabledParameter.get(),sample:t.reverbEffect.convolverSample,preset:t.reverbEffect.preset}},function(e,t){return{setSampleDragging:function(t){return e(Object(O.He)(t))}}})(S)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(22);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(e){return Object(r.a)(this,n),t.call(this,e)}return Object(a.a)(n,[{key:"render",value:function(){return u.a.createElement("div",{className:"compressor-part"},u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Threshold",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.thresholdParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.1,max:8,min:-80}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Ratio",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.ratioParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:20,min:1}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Knee",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.kneeParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:40,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Attack",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.attackParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:1,min:0}),u.a.createElement(l.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Release",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.props.effect.releaseParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:1,min:.1}))}}]),n}(c.Component),p=n(39),d=n.n(p);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var v="LOW",b=function(e){Object(i.a)(n,e);var t=m(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={selectedPart:v},a}return Object(a.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"onSelectCompressor",value:function(e){e=e.value,this.setState({selectedPart:e})}},{key:"getCompressor",value:function(){var e=this;return this.props.effect.compressors.find(function(t){return t.name===e.state.selectedPart})}},{key:"render",value:function(){var e=this;return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(d.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:g,onChange:function(t){return e.onSelectCompressor(t)},value:y(this.state.selectedPart),placeholder:"LFO"})),u.a.createElement(h,{selectedParameter:this.props.selectedParameter,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,onParameterChanged:this.props.onParameterChanged,effect:this.getCompressor(),effectNumber:this.props.effectNumber})):"")}}]),n}(c.Component),g=[{value:"LOW",label:"Low"},{value:"MID",label:"Mid"},{value:"HIGH",label:"High"}];function y(e){for(var t=0;t<g.length;t++)if(g[t].value==e)return g[t];return null}t.a=b},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return v}),n.d(t,"b",function(){return b});var r=n(5),a=n.n(r),i=n(14),o=n(399),s=(n(518),n(52)),c=n(65),u=n(70),l=n(44),f=n(6),h=n(30),p=n(120),d=(n(1043),n(47)),m=function(){var t=Object(i.a)(a.a.mark(function t(n){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(n,{method:"GET"});case 2:return r=t.sent,t.next=5,r.arrayBuffer();case 5:return r=t.sent,t.abrupt("return",e.from(r));case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),v=function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://zequencer.io/ipfs/"+t.animationUrl,"https://zequencer.io/ipfs/QmUKVhbFgiGLhWay37Ek9Yo3tduHJrgeg9ekwLT5J2m7XR",e.abrupt("return",{description:"test descroption",mimeType:"text/html",animation_url:n,name:"test",version:"zora-20210604"});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),b=function(t,n,r,s,c,u){return new Promise(function(){var l=Object(i.a)(a.a.mark(function i(l,h){var v,b,y,k,O,j,w,E,S,P,x,T,C,N;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return v=!1,b=!1,!1,setTimeout(function(){b||(v=!0,console.log("FAILED!"),h("timed out"))},12e3),y="https://zequencer.io/ipfs/"+t.animationUrl+"/",t.projectJson,a.next=8,m("https://zequencer.io/ipfs/"+t.animationUrl);case 8:return k=a.sent,O="https://zequencer.io/ipfs/"+s,j=Object(o.generateMetadata)("zora-20210604",{description:r,mimeType:"text/html",image:O,animation_url:y,name:n,version:"zora-20210604"}),a.next=13,d.a.addBuffer(e.from(j));case 13:return w="https://zequencer.io/ipfsJSON/"+(w=a.sent),E=Object(o.sha256FromBuffer)(k),S=Object(o.sha256FromBuffer)(e.from(j)),P=Object(o.constructMediaData)(y,w,E,S),console.log("media data = ",P),a.next=21,Object(o.isMediaDataVerified)(P,1e4);case 21:if(a.sent){a.next=24;break}throw new Error("MediaData not valid, do not mint");case 24:return x=new p.ethers.providers.Web3Provider(window.ethereum,"any"),a.next=27,x.send("eth_requestAccounts",[]);case 27:if(T=x.getSigner(),4,C=new o.Zora(T,4),N=Object(o.constructBidShares)(c,100-c,0),u.dispatch(Object(f.kd)("Confirm your transaction in your wallet")),u.dispatch(Object(f.wd)(void 0)),b=!0,!v){a.next=36;break}return a.abrupt("return");case 36:return a.prev=36,a.next=39,C.mint(P,N);case 39:a.sent,u.dispatch(Object(f.kd)("Now wait a little, your transaction is being processed.")),C.media.on("Transfer",function(e,t,r){!0,window.localStorage.setItem("new_zora_token",JSON.stringify({zoraId:r.toNumber(),projectHash:u.sequenceId})),u.dispatch(Object(f.wd)(r.toNumber())),g(r.toNumber(),u.sequenceId,u,n),l()}),a.next=48;break;case 44:a.prev=44,a.t0=a.catch(36),console.log("error while mintingg",a.t0),h("rejected");case 48:case"end":return a.stop()}},i,null,[[36,44]])}));return function(e,t){return l.apply(this,arguments)}}())},g=function(e,t,n,r){return new Promise(function(){var o=Object(i.a)(a.a.mark(function i(o,p){var d;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(d=new u.a(l.x,"zoraProject",[Object(c.c)(t),e]),a.t0=!s.a.isLoggedIn(),a.t0){a.next=9;break}if(a.t1=s.a.isLoggedIn(),!a.t1){a.next=8;break}return a.next=7,s.a.checkLogin();case 7:a.t1=!a.sent;case 8:a.t0=a.t1;case 9:if(!a.t0){a.next=15;break}n.dispatch(Object(f.rh)(d)),n.dispatch(Object(f.Qf)(!0)),setTimeout(function(){h.a.saveNewSequence(void 0,t,r,n.getSamples(),n.bpm)},5e3),a.next=17;break;case 15:d.execute().then(function(e){return o}).catch(function(e){return p}),h.a.saveNewSequence(void 0,t,r,n.getSamples(),n.bpm);case 17:case"end":return a.stop()}},i)}));return function(e,t){return o.apply(this,arguments)}}())}}).call(this,n(27).Buffer)},function(e,t,n){"use strict";var r=n(20),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=n(205),h=n(374),p=(n(22),n(848)),d=(n(110),n(15),n(831)),m=n(12),v=(n(69),n(6)),b=(n(90),n(460)),g=(n(39),n(428),n(731)),y=(n(1050),n(832)),k=n(377),O=(n(997),n(1028),n(637),n(630),n(631),n(851)),j=n(627),w=n(742),E=n(852),S=n(853),P=n(894),x=n(854),T=n(855),C=n(38),N=n(560),R=(n(739),n(856)),M=n(857),A=n(858),q=n(859),D=n(860),I=n(895),_=n(861),F=n(862),L=n(863),B=n(864),z=n(865),V=n(866),H=n(867),U=n(881),J=n(868),G=n(869),W=n(870),K=n(871),X=n(46);function Q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var Y=function(e){Object(o.a)(n,e);var t=Q(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={},r}return Object(i.a)(n,[{key:"getEffect",value:function(){return"Filter"===this.props.effect.name?l.a.createElement(w.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,filterEffect:this.props.effect})):"Auto Filter"===this.props.effect.name?l.a.createElement(E.a,Object.assign({},this.props,{track:this.track,sequencerEngine:this.props.sequencerEngine,effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,filterEffect:this.props.effect})):"Delay"===this.props.effect.name?l.a.createElement(R.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,delayEffect:this.props.effect})):"Tremolo"===this.props.effect.name?l.a.createElement(T.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,tremoloEffect:this.props.effect})):"Chorus"===this.props.effect.name?l.a.createElement(x.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,chorusEffect:this.props.effect})):"Reverb"===this.props.effect.name?l.a.createElement(S.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,reverbEffect:this.props.effect})):"Convolver Reverb"===this.props.effect.name?l.a.createElement(P.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,reverbEffect:this.props.effect})):"Compressor"===this.props.effect.name?l.a.createElement(M.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Distortion"===this.props.effect.name?l.a.createElement(L.a,Object.assign({},this.props,{sequencerEngine:this.props.sequencerEngine,effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"EQ 3"===this.props.effect.name?l.a.createElement(q.a,Object.assign({},this.props,{sequencerEngine:this.props.sequencerEngine,effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"EQ 10"===this.props.effect.name?l.a.createElement(D.a,Object.assign({},this.props,{sequencerEngine:this.props.sequencerEngine,effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Bit Crusher"===this.props.effect.name?l.a.createElement(B.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Ultra Phaser"===this.props.effect.name?l.a.createElement(_.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Auto Wah"===this.props.effect.name?l.a.createElement(F.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Gate"===this.props.effect.name?l.a.createElement(O.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Pitch Shift"===this.props.effect.name?l.a.createElement(V.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Panner"===this.props.effect.name?l.a.createElement(H.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"EQ8"===this.props.effect.name?l.a.createElement(U.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Chebyshev"===this.props.effect.name?l.a.createElement(A.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Multiband Compressor"===this.props.effect.name?l.a.createElement(I.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Stereo Widener"===this.props.effect.name?l.a.createElement(J.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Saturator"===this.props.effect.name?l.a.createElement(z.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Tape Delay"===this.props.effect.name?l.a.createElement(G.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Stereo Delay"===this.props.effect.name?l.a.createElement(W.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Oscilloscope"===this.props.effect.name?l.a.createElement(p.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Effect Rack"===this.props.effect.name?l.a.createElement(K.a,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):null}},{key:"render",value:function(){var e=this;return l.a.createElement(k.a,Object.assign({},this.props,{onDeleteEffect:this.props.onDeleteEffect,effectNumber:this.props.effectNumber,onToggle:function(){return e.setState(e.state)},track:this.props.track,group:this.props.group,send:this.props.send,effect:this.props.effect,automation:this.props.automation}),this.getEffect())}}]),n}(u.Component),Z=function(e){Object(o.a)(n,e);var t=Q(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).state={selectedParameter:void 0,effectsView:l.a.createRef()},i.unmapSelectedParameter=i.unmapSelectedParameter.bind(Object(r.a)(i)),i}return Object(i.a)(n,[{key:"unmapSelectedParameter",value:function(){console.log("UMMAP!"),this.props.sequencerEngine.dispatch(Object(v.r)(void 0))}},{key:"componentDidMount",value:function(){console.log("component did mount = ",this.state.effectsView),this.state.effectsView.current.addEventListener("scroll",this.unmapSelectedParameter)}},{key:"componentWillUnmount",value:function(){this.state.effectsView.current.removeEventListener("scroll",this.unmapSelectedParameter),this.unmapSelectedParameter()}},{key:"handleChooseMidiEffect",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(X.b)(e,this.props.track,this.props.group,this.props.send)),this.setState(this.state)}},{key:"handleChooseLiveEffect",value:function(e){this.props.track.liveEffects.addEffect(e),this.setState(this.state)}},{key:"handleChooseEffect",value:function(e){e.enable(!0),this.props.sequencerEngine.operationManager.dispatch(Object(X.b)(e,this.props.track,this.props.group,this.props.send)),this.setState(this.state)}},{key:"onParameterChanged",value:function(e,t){void 0===this.props.track&&void 0===this.props.group&&void 0===this.props.send||(this.props.setSelectedEffect(t.id),this.props.onParameterChanged(e))}},{key:"onDeleteEffect",value:function(){this.setState(this.state)}},{key:"toggleLock",value:function(){this.props.track.togglePatternLock()}},{key:"onChangePanning",value:function(e){void 0!==this.props.track?this.props.track.setPanning(e):void 0!==this.props.group&&this.props.group.setPanning(e)}},{key:"render",value:function(){var e=this,t=void 0!==this.props.send?this.props.send.effects:void 0!==this.props.track?this.props.track.effects:this.props.group.effects;this.props.track&&(t=this.props.track.getEffects(this.props.chainNumber));var n=void 0!==this.props.send?this.props.send.getSendNodes():void 0!==this.props.track?this.props.track.getSendNodes():this.props.group.getSendNodes(),r=void 0!==this.props.track?this.props.track.midiEffects.effects:[],a=void 0!==this.props.track?this.props.track.liveEffects.effects:[],i=Object(N.a)(this.props.track,this.props.scrollContainer||this.state.effectsView)||"";return this.props.isFrozen&&(i=""),void 0===t||void 0===a||void 0===r?l.a.createElement("div",null):l.a.createElement("div",{ref:this.state.effectsView,className:"effects-view"},a.map(function(t,n){return l.a.createElement(h.a,{key:"live-effect-"+n,scrollContainer:e.props.scrollContainer||e.state.effectsView,sequencerEngine:e.props.sequencerEngine,onDeleteEffect:function(){return e.onDeleteEffect()},effect:t,selectedParameter:e.state.selectedParameter,track:e.props.track,tracks:e.props.tracks,onParameterChanged:function(n){return e.onParameterChanged(n,t)},onEffectsChange:e.props.onEffectsChange})}),i,r.map(function(t,n){return l.a.createElement(f.a,{key:"midi-effect-"+n,sequencerEngine:e.props.sequencerEngine,scrollContainer:e.props.scrollContainer||e.state.effectsView,onDeleteEffect:function(){return e.onDeleteEffect()},effect:t,isMixCollapsed:e.props.isMixCollapsed,selectedParameter:e.state.selectedParameter,track:e.props.track,tracks:e.props.tracks,onParameterChanged:function(n){return e.onParameterChanged(n,t)},onEffectsChange:e.props.onEffectsChange})}),t.map(function(t,n){return l.a.createElement(Y,{sequencerEngine:e.props.sequencerEngine,scrollContainer:e.props.scrollContainer||e.state.effectsView,key:"effect-"+n,onDeleteEffect:function(){return e.onDeleteEffect()},effect:t,isMixCollapsed:e.props.isMixCollapsed,selectedParameter:e.state.selectedParameter,track:e.props.track,group:e.props.group,send:e.props.send,tracks:e.props.tracks,onParameterChanged:function(n){return e.onParameterChanged(n,t)},onEffectsChange:e.props.onEffectsChange})}),l.a.createElement(y.a,{track:this.props.track,sequencerEngine:this.props.sequencerEngine,addClassName:"add-track-effects-button",handleChooseMidiEffect:function(t){return e.handleChooseMidiEffect(t)},handleChooseLiveEffect:function(t){return e.handleChooseLiveEffect(t)},handleChooseEffect:function(t){return e.handleChooseEffect(t)},store:this.props.store}),l.a.createElement("div",{className:"sends-and-options-container"},l.a.createElement("div",{className:"sends-container"},n.map(function(t,n){return l.a.createElement(d.a,{key:"track-send-"+n,track:e.props.track,sequencerEngine:e.props.sequencerEngine,sendNumber:n,send:e.props.sends.getSends()[n],sendNode:t})}),l.a.createElement(j.a,{panning:this.props.panning,onChangePanning:function(t){return e.onChangePanning(t)}})),this.props.track?l.a.createElement(g.a,{track:this.props.track}):""),l.a.createElement("div",{className:"effect-lock"},l.a.createElement(C.a,{condition:!this.props.hideLock},l.a.createElement(b.a,{patternLocked:this.props.patternLocked,toggleLock:function(){return e.toggleLock()}}))))}}]),n}(u.Component),$={EffectsView:Object(m.b)(function(e,t){var n=!1,r=!1;void 0!==t.track&&(n=((e.tracks.trackPatternLocks[t.track.subSequence.id]||{})[t.track.trackNumber]||{})[t.track.currentPattern]||!1,r=t.track.isFrozen);var a=0,i=void 0;void 0!==t.track?(a=e.tracks.trackPannings[t.track.trackNumber]||0,i=t.track.chainNumber):void 0!==t.group&&(a=e.tracks.groupPannings[t.group.groupNumber]||0);var o=t.track||t.group||t.send;return{isFrozen:r,patternLocked:n,panning:a,chainNumber:i,effects:o.effects,effectsLen:o.effects?o.effects.length:o.midiEffects&&o.midiEffects.effects?o.midiEffects.effects.length:0,midiEffects:o.midiEffects&&o.midiEffects.effects}},function(e){return{setSelectedEffect:function(t){return e(Object(v.Se)(t))}}})(Z),EffectComponent:Y};t.a=$},function(e,t,n){"use strict";n.r(t);var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(20),u=n(7),l=n(10),f=n(1),h=n(9),p=n(8),d=n(56),m=n(92),v=n(550),b=n(296),g=n(365),y=n(310),k=n(94),O=n(147),j=n(45),w=n(155);function E(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=function(e,t){var n,r=E(t.subSequences);try{for(r.s();!(n=r.n()).done;){var a,i=n.value,o=E(i.tracks);try{for(o.s();!(a=o.n()).done;){var s,c=a.value,u=[].concat(Object(h.a)(c.effects),Object(h.a)(c.midiEffects.effects),Object(h.a)(c.liveEffects.effects)),l=E(u);try{for(l.s();!(s=l.n()).done;){var f=s.value;f.effects&&(u=[].concat(Object(h.a)(u),Object(h.a)(f.effects)))}}catch(m){l.e(m)}finally{l.f()}var p=u.find(function(t){return t.id===e});if(p)return p}}catch(m){o.e(m)}finally{o.f()}var d=i.midiEffects.effects.find(function(t){return t.id===e});if(d)return d}}catch(m){r.e(m)}finally{r.f()}},x=function(e,t,n){console.log("findInstrumentPart",e,t,n);var r,a=E(n.subSequences);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(t===w.d){var o=n.lfos.find(function(t){return t.lfo.id===e});return{type:w.d,instrument:o,effect:o,id:e}}if("MODULE_ENVELOPE"===t){var s=n.envelopes.find(function(t){return t.id===e});return s?{type:"MODULE_ENVELOPE",instrument:s,subType:s.number,id:e}:void 0}var c,u=E(i.tracks);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(t===w.f||t===w.c){var f=w.g[t];return T(l,f,t,e)}if(l.instrument&&l.instrument.id===e)return{type:t,track:l,instrument:l.instrument}}}catch(h){u.e(h)}finally{u.f()}}}catch(h){a.e(h)}finally{a.f()}},T=function(e,t,n,r){var a,i=[],o=E(e.midiEffects.effects);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.effects?i=[].concat(Object(h.a)(i),Object(h.a)(s.effects)):i.push(s)}}catch(u){o.e(u)}finally{o.f()}var c=i.find(function(e){return e[t]&&e[t].id===r});if(c)return{type:n,track:e,instrument:c[t],effect:c}},C=n(6),N=n(720),R=n(75),M=function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o,s,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.pattern.volume=n.volume,!("samplers"in n)){e.next=9;break}e.t0=a.a.keys(n.samplers);case 3:if((e.t1=e.t0()).done){e.next=9;break}return i=e.t1.value,e.next=7,t.addSound(i,n.samplers[i],void 0,!1);case 7:e.next=3;break;case 9:if("envelopes"in n)for(o in n.envelopes)t.connectToEnvelope(r.envelopes[n.envelopes[o]]);if("envelopeConnections"in n)for(s in n.envelopeConnections)c=n.envelopeConnections[s],t.connectToEnvelope(r.envelopes[c.envelope],c.mode);case 11:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),A=n(55),q=n(61),D=n(128),I=n(233),_=n(200),F=n(151),L=n(57),B=n(435),z=n(69),V=n(15),H=n.n(V),U=new H.a.Time("16n"),J=new H.a.Time("16n"),G=function(){function e(){Object(o.a)(this,e),this.offset=0,this.parameters=[],this.initialBulkValues={}}return Object(s.a)(e,[{key:"registerParameter",value:function(e,t){var n=this.context.forInstrument(this);this.initialBulkValues=Object(p.a)({},this.initialBulkValues,e.setStore(this.store)),e.setMixSession(this.mixSession),e.setContext(n),e.setTrack(this.context.track),this.parameters.push(e)}},{key:"getSubDevices",value:function(){return[]}},{key:"getSubDeviceIndex",value:function(e){return this.getSubDevices().map(function(e){return e.value}).indexOf(e)}},{key:"getSubDevice",value:function(e){return this.getSubDevices().map(function(e){return e.value})[e]}},{key:"getName",value:function(){return""}},{key:"name",get:function(){return this.getName()}},{key:"connect",value:function(e){void 0!==e&&(this.getInstrument().connect(e),this.node=e)}},{key:"disconnect",value:function(e){this.getInstrument().disconnect(e),this.node=void 0}},{key:"dispose",value:function(){this.disconnect(),this.parameters.forEach(function(e){return e.dispose()})}},{key:"isMonophonic",value:function(){return!1}},{key:"getEnvelope",value:function(){}},{key:"getInstrument",value:function(){}},{key:"getInstrumentType",value:function(){}},{key:"releaseAll",value:function(){}},{key:"getJson",value:function(){return{instrumentType:this.getInstrumentType()}}},{key:"hasLFO",value:function(){return!1}},{key:"release",value:function(e){e=void 0!==e?e:this.lastNote,this.isMonophonic()&&this.lastNote!==e||void 0!==this.lastNote&&this.getInstrument().triggerRelease([e])}},{key:"trigger",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=e.start,r=null;e.duration&&(r="number"===typeof e.duration?U*e.duration:new H.a.Time(e.duration));var a=isNaN(e.transpose)?0:e.transpose,i=this.getNoteFromTranspose(a),o=null===e.velocity?1:e.velocity,s=null==e.chop?1:e.chop,c=(null==r?U:r)/s.toString();t=t||void 0,this.offset>0&&(void 0===t&&(t=H.a.Master.context.currentTime),t=J*this.offset+t);var u=t;if((void 0!==this.lastSlideTranspose||this.hasSlide)&&this.releaseSlide(t),r&&e.slide)this.triggerSlide(i,t,r);else{if(void 0!==this.lastSlideTranspose&&(this.triggerSlide(i,t,r,!1),this.hasSlide=!0),t){var l=this.detuneParameter.get(!0);this.detuneSignal.setValueAtTime(l,Math.max(0,t-.001))}this.lastSlideTranspose=void 0,this.lastSlideMax=void 0;var f=this.getInstrument(),h=!this.track||this.track.gated;r===1/0&&(r=null);for(var p=0;p<s;p++)this.lastNote=i,null!==r&&h?f.triggerAttackRelease(i,r,u,o,n,e):f.triggerAttack(i,u,o,n,e),u||(u=H.a.Master.context.currentTime),u+=c;this.lastTranspose=i}}},{key:"hasNotes",value:function(){return!0}},{key:"setEnvelopes",value:function(e){var t=this.getEnvelopes();t.forEach(function(t){return t.attack=new H.a.Time((1+e.attack)/1e3)}),t.forEach(function(t){return t.release=new H.a.Time((1+e.release)/1e3)})}},{key:"getNoteFromTranspose",value:function(e){return e+this.sequencerEngine.transpose}},{key:"getDefaultNote",value:function(){return H.a.Frequency("C3")}},{key:"getParameters",value:function(){return this.parameters}},{key:"getEnvelopes",value:function(){return[]}},{key:"findParameter",value:function(e,t){var n=this.getParameters().filter(function(e){return t===e.name});return 0===n.length?0:n[0]}},{key:"freeze",value:function(){}}]),e}(),W=n(162),K=n(63),X=n(131),Q=n(23),Y=n(41),Z=n(16),$=n(21),ee=n(184),te=n(132),ne=n(32),re=n(71),ae=n(62),ie=(new H.a.Frequency("C3"),function(){function e(t,n,r,a,i){!(arguments.length>5&&void 0!==arguments[5])||arguments[5];var s=arguments.length>6?arguments[6]:void 0;Object(o.a)(this,e),this.bulk={},this.sequencerEngine=t,this.id=Object(j.uuid)(),this.track=s,this.name="Osc "+this.id,this.store=t.store,this.mixSession=n,this.context=r.getCopy().forSubDevice(this).forOscillator(this),this.pitchEnvelope=i,this.synthFactory=a,this.polyphonySet=!1,this.volume=new H.a.Gain(.4)}return Object(s.a)(e,[{key:"dispose",value:function(){this.synth&&this.disposeSynth(),this.getParameters().forEach(function(e){return e.dispose()}),this.parameters=void 0}},{key:"create",value:function(){this.initVoices(),this.setupParameters(),this.setupWaveformParameters()}},{key:"isInitialized",value:function(){return void 0!==this.synth}},{key:"getEffectType",value:function(){return re.a}},{key:"getCopy",value:function(e,t,n){return n.oscillatorFrequency=this.oscillatorFrequency,n.oscillatorLevel=this.oscillatorLevel,n.detune=this.detune,n.polyphony=this.polyphony,n.portamento=this.portamento,n.oscillatorType=this.oscillatorType,n.pulseWidth=this.pulseWidth,n}}]),e}());function oe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var se=function(e){Object(u.a)(n,e);var t=oe(n);function n(e,r,a){return Object(o.a)(this,n),t.call(this,e,r,a,function(e){return new H.a.PolySynth(e,H.a.FMSynth)})}return Object(s.a)(n,[{key:"setupParameters",value:function(){Object(Z.a)(Object(f.a)(n.prototype),"setupParameters",this).call(this),this.harmonicityParameter=new Y.a("Harmonicity",this,function(e,t){return e.synth.set({harmonicity:t})},{min:0,max:20,unit:"",defaultValue:3}),this.registerParameter(this.harmonicityParameter),this.modulationIndexParameter=new Y.a("modulationIndex",this,function(e,t){return e.synth.set({modulationIndex:t})},{min:0,max:1e3,unit:"",defaultValue:10}),this.harmonicityParameter.setAudioParams(this.synth.voices.map(function(e){return e.harmonicity})),this.modulationIndexParameter.setAudioParams(this.synth.voices.map(function(e){return e.modulationIndex})),this.partialCountParameter=new $.a("Partial Count",this,function(e,t){return e.synth.set({oscillator:{partialCount:t}})},{min:0,automatable:!1,max:16,unit:"",defaultValue:0}),this.registerParameter(this.partialCountParameter),this.registerParameter(this.modulationIndexParameter)}},{key:"harmonicity",get:function(){return this.harmonicityParameter.get()},set:function(e){return this.harmonicityParameter.set(e)}},{key:"modulationIndex",get:function(){return this.modulationIndexParameter.get()},set:function(e){return this.modulationIndexParameter.set(e)}},{key:"partialCount",get:function(){return this.partialCountParameter.get()},set:function(e){return this.partialCountParameter.set(e)}},{key:"refreshParameters",value:function(){Object(Z.a)(Object(f.a)(n.prototype),"refreshParameters",this).call(this),this.harmonicity=this.harmonicity,this.modulationIndex=this.modulationIndex,this.partialCount=this.partialCount,this.harmonicityParameter.setAudioParams(this.synth.voices.map(function(e){return e.harmonicity})),this.modulationIndexParameter.setAudioParams(this.synth.voices.map(function(e){return e.modulationIndex}))}},{key:"getJson",value:function(){var e=Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{harmonicity:this.harmonicity,modulationIndex:this.modulationIndex,partialCount:this.partialCount});return e=Object(Q.b)(e,"harmonicityParameter",this.harmonicityParameter),e=Object(Q.b)(e,"modulationIndexParameter",this.modulationIndexParameter),e=Object(Q.b)(e,"partialCountParameter",this.partialCountParameter)}},{key:"fromJson",value:function(e){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,void 0,!0),console.log("osc =",e),this.harmonicity=parseFloat(e.harmonicity),this.modulationIndex=parseFloat(e.modulationIndex),this.partialCount=e.partialCount,Object(Q.a)(e,"harmonicityParameter",this.harmonicityParameter,this.sequencerEngine),Object(Q.a)(e,"modulationIndexParameter",this.modulationIndexParameter,this.sequencerEngine),Object(Q.a)(e,"partialCountParameter",this.partialCountParameter,this.sequencerEngine)}},{key:"mateJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"mateJson",this).call(this,e,t),this.mateParameter("harmonicity",e,this.harmonicityParameter,t),this.mateParameter("modulationIndex",e,this.modulationIndexParameter,t),this.mateParameter("partialCount",e,this.partialCountParameter,t)}}]),n}(ie),ce=function(){function e(t,n,r,a){Object(o.a)(this,e),this.sequencerEngine=t,this.store=t.store,this.mixSession=n,this.context=r.getCopy().forSubDevice(this),this.fmSynth=a,this.parameters=[],this.setupParameters()}return Object(s.a)(e,[{key:"synth",get:function(){return this.fmSynth.synth}},{key:"setupParameters",value:function(){this.oscillatorTypeParameter=new $.a("Oscillator Type",this,function(e,t){return e.synth.set({modulation:{type:t}})},{min:0,max:1,unit:"",defaultValue:"triangle",automatable:!1}),this.registerParameter(this.oscillatorTypeParameter),this.partialCountParameter=new $.a("Partial Count",this,function(e,t){return e.synth.set({modulation:{partialCount:t}})},{min:0,max:16,unit:"",defaultValue:0}),this.registerParameter(this.partialCountParameter)}},{key:"oscillatorType",get:function(){return this.oscillatorTypeParameter.get()},set:function(e){this.oscillatorTypeParameter.set(e)}},{key:"partialCount",get:function(){return this.partialCountParameter.get()},set:function(e){return this.partialCountParameter.set(e)}},{key:"refreshParameters",value:function(){this.oscillatorType=this.oscillatorType}},{key:"registerParameter",value:function(e,t){e.setStore(this.store),e.setMixSession(this.mixSession),e.setContext(this.context),e.setTrack(this.context.track),this.parameters.push(e)}},{key:"getJson",value:function(){var e={oscillatorType:this.oscillatorType,partialCount:this.partialCount};return e=Object(Q.b)(e,"partialCountParameter",this.partialCountParameter),Object(Q.b)(e,"oscillatorTypeParameter",this.oscillatorTypeParameter)}},{key:"fromJson",value:function(e){this.oscillatorType=e.oscillatorType,e.partialCount&&(this.partialCount=e.partialCount),Object(Q.a)(e,"oscillatorTypeParameter",this.oscillatorTypeParameter),Object(Q.a)(e,"partialCountParameter",this.partialCountParameter)}},{key:"mateJson",value:function(e,t){this.mateParameter("partialCount",e,this.partialCountParameter,t),this.mateParameter("oscillatorType",e,this.oscillatorTypeParameter,t)}},{key:"mateParameter",value:function(e,t,n,r){Object(W.b)(this.sequencerEngine,e,t,n,r)}}]),e}(),ue=n(129);window.FADER=.05;var le=function(){function e(t,n,r,a,i,s,c){Object(o.a)(this,e),this.sequencerEngine=t,this.store=this.sequencerEngine.store,this.id=Object(j.uuid)(),this.mixSession=n,this.context=r.getCopy().forSubDevice(this),this.envelope=c||new H.a.ScaledEnvelope,void 0!==a&&(this.audioNode=a,this.envelope.connect(a)),this.min=i,this.max=s,this.parameters=[],this.setupParameters(),this.savedFrequency=void 0}return Object(s.a)(e,[{key:"dispose",value:function(){this.parameters.forEach(function(e){return e.dispose(!0)}),this.envelope.dispose(),this.envelope=void 0,this.parameters=void 0}},{key:"connect",value:function(e){this.envelope.connect(e)}},{key:"disconnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.audioNode;this.envelope.disconnect(e)}},{key:"frequency",set:function(e){this.savedFrequency=e;var t=void 0;t=this.level>0?void 0!==this.max?e+this.level*(this.max-e):e+this.level*e*2:void 0!==this.min&&this.min<0?-1*this.level*(this.min+e):this.level*e,this.envelope.min=2*e,isNaN(t)||(this.envelope.max=t)}},{key:"level",get:function(){return void 0===this.levelParameter||void 0===this.levelParameter.get(!0)?0:this.levelParameter.get(!0)},set:function(e){this.levelParameter.set(e,!0,!0)}},{key:"triggerAttack",value:function(e,t){0!==this.level&&this.envelope.triggerAttack(e,t)}},{key:"triggerAttackRelease",value:function(e,t,n){0!==this.level&&(t=Math.max(t,0),this.envelope.triggerAttackRelease(e,t,n))}},{key:"triggerRelease",value:function(e){0!==this.level&&(e=Math.max(e,0),this.envelope.triggerRelease(e))}},{key:"setupParameters",value:function(){var e=this;this.attackParameter=new $.a("Attack",this.envelope,function(t,n){e.envelope&&(e.envelope.attack=(n+1e-6)/1e3)},{min:0,max:2e3,unit:"ms",defaultValue:10}),this.registerParameter(this.attackParameter),this.decayParameter=new $.a("Decay",this.envelope,function(t,n){e.envelope&&(e.envelope.decay=(n+1e-5)/1e3)},{min:0,max:3e3,unit:"ms",defaultValue:500}),this.registerParameter(this.decayParameter),this.sustainParameter=new $.a("Sustain",this.envelope,function(t,n){e.envelope&&(e.envelope.sustain=Math.min(n,.999))},{min:0,max:1,unit:"",defaultValue:.8}),this.registerParameter(this.sustainParameter),this.releaseParameter=new $.a("Release",this.envelope,function(t,n){e.envelope&&(e.envelope.release=(n+1e-6)/1e3)},{min:0,max:8e3,unit:"ms",defaultValue:200}),this.registerParameter(this.releaseParameter),this.attackCurveParameter=new $.a("Attack Curve",this.envelope,function(t,n){e.envelope&&(t.attackCurve=n)},{min:0,max:1e4,unit:"",defaultValue:"linear",automatable:!1}),this.registerParameter(this.attackCurveParameter),this.decayCurveParameter=new $.a("Decay Curve",this.envelope,function(e,t){return e.decayCurve=t},{min:0,max:1e4,unit:"",defaultValue:"exponential",automatable:!1}),this.registerParameter(this.decayCurveParameter),this.releaseCurveParameter=new $.a("Release Curve",this.envelope,function(e,t){return e.releaseCurve=t},{min:0,max:1e4,unit:"",defaultValue:"linear",automatable:!1}),this.registerParameter(this.releaseCurveParameter),this.levelParameter=new $.a("Level",this,function(t,n){e.envelope&&(e.frequency=e.savedFrequency||0)},{min:-1,max:1,unit:"",defaultValue:0}),this.registerParameter(this.levelParameter)}},{key:"refresh",value:function(){this.parameters.filter(function(e){return e.isConnectedToAnyLFO()}).forEach(function(e){return e.callSetter()})}},{key:"attack",get:function(){return this.attackParameter.get()},set:function(e){this.attackParameter.set(e,!0,!0)}},{key:"decay",get:function(){return this.decayParameter.get()},set:function(e){this.decayParameter.set(e,!0,!0)}},{key:"sustain",get:function(){return this.sustainParameter.get()},set:function(e){this.sustainParameter.set(e,!0,!0)}},{key:"release",get:function(){return this.releaseParameter.get()},set:function(e){this.releaseParameter.set(e,!0,!0)}},{key:"attackCurve",get:function(){return this.attackCurveParameter.get()},set:function(e){this.attackCurveParameter.set(e,!0,!0)}},{key:"decayCurve",get:function(){return this.decayCurveParameter.get()},set:function(e){this.decayCurveParameter.set(e,!0,!0)}},{key:"releaseCurve",get:function(){return this.releaseCurveParameter.get()},set:function(e){this.releaseCurveParameter.set(e,!0,!0)}},{key:"registerParameter",value:function(e){e.setStore(this.store),e.setMixSession(this.mixSession),e.setContext(this.context),e.setTrack(this.context.track),this.parameters.push(e)}},{key:"getJson",value:function(e){var t={level:this.level,attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release,attackCurve:this.attackCurve,decayCurve:this.decayCurve,releaseCurve:this.releaseCurve,x:this.x,y:this.y,width:this.width,height:this.height};return t=Object(Q.b)(t,"attackParameter",this.attackParameter,void 0,e),t=Object(Q.b)(t,"decayParameter",this.decayParameter,void 0,e),t=Object(Q.b)(t,"sustainParameter",this.sustainParameter,void 0,e),t=Object(Q.b)(t,"releaseParameter",this.releaseParameter,void 0,e),t=Object(Q.b)(t,"attackCurveParameter",this.attackCurveParameter,void 0,e),t=Object(Q.b)(t,"decayCurveParameter",this.decayCurveParameter,void 0,e),t=Object(Q.b)(t,"releaseCurveParameter",this.releaseCurveParameter,void 0,e),t=Object(Q.b)(t,"levelParameter",this.levelParameter,void 0,e)}},{key:"fromJson",value:function(e,t){var n={};return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,Object(ne.a)(this.attackParameter,e.attack,n),Object(ne.a)(this.decayParameter,e.decay,n),Object(ne.a)(this.sustainParameter,e.sustain,n),Object(ne.a)(this.releaseParameter,e.release,n),n=Object(p.a)({},n,Object(Q.a)(e,"attackParameter",this.attackParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"decayParameter",this.decayParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"sustainParameter",this.sustainParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"releaseParameter",this.releaseParameter,this.sequencerEngine,t,!0)),H.a.Master.context.isOffline?(Object(ne.a)(this.levelParameter,e.level,{}),Object(Q.a)(e,"levelParameter",this.levelParameter,this.sequencerEngine,t,!0)):(Object(ne.a)(this.levelParameter,e.level,n),n=Object(p.a)({},n,Object(Q.a)(e,"levelParameter",this.levelParameter,this.sequencerEngine,t,!0))),n}},{key:"mateJson",value:function(e,t){this.mateParameter("attack",e,this.attackParameter,t),this.mateParameter("decay",e,this.decayParameter,t),this.mateParameter("sustain",e,this.sustainParameter,t),this.mateParameter("release",e,this.releaseParameter,t)}},{key:"mateParameter",value:function(e,t,n,r){Object(W.b)(this.sequencerEngine,e,t,n,r)}}]),e}();function fe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var he=function(e){Object(u.a)(n,e);var t=fe(n);function n(e,r,a){var i;return Object(o.a)(this,n),(i=t.call(this)).notes=[],i.sequencerEngine=e,i.store=e.store,i.mixSession=r,i.context=a.getCopy().forInstrument(Object(c.a)(i)),i.ampEnvelope=new le(e,r,i.context),i.modulationEnvelope=new le(e,r,i.context),i.filter=new d.a.FilterEffect(e,X.a),i.filterEnvelope=new le(e,r,i.context,i.filter.effectNode.frequency,0,1e4),i.filterEnvelope2=new le(e,r,i.context,i.filter.effectNode.frequency,0,1e4),i.carrierOscillator=new se(e,r,i.context),i.modulatorOscillator=new ce(e,r,i.context,Object(c.a)(i)),i.noiseOscillator=new H.a.NoiseSynth,i.connectSynthToFilter(),i.parameters=[],i.setupParameters(),i.carrierOscillator.onNewSynth=function(){return i.onNewSynth()},i.lastTime=void 0,i.currentNotes=[],i}return Object(s.a)(n,[{key:"getSubDevices",value:function(){return[{label:"Filter",value:this},{label:"Carrier Oscillator",value:this.carrierOscillator},{label:"Modulator Oscillator",value:this.modulatorOscillator},{label:"Amp Envelope",value:this.ampEnvelope},{label:"Filter Envelope",value:this.filterEnvelope},{label:"Filter Envelope 2",value:this.filterEnvelope2},{label:"Modulation Envelope",value:this.modulationEnvelope}]}},{key:"synth",get:function(){return this.carrierOscillator.synth}},{key:"onNewSynth",value:function(){this.connectSynthToFilter(),this.modulatorOscillator.refreshParameters()}},{key:"triggerAttack",value:function(e,t,n){this.filterEnvelope.refresh(),this.filterEnvelope2.refresh();var r=this.carrierOscillator.getNoteFromTranspose(e);this.notes.push(r),this.filterEnvelope.triggerAttack(t,n),this.filterEnvelope2.triggerAttack(t,n),this.synth.triggerAttack(r,t,n),this.noiseOscillator.triggerAttack(t,n)}},{key:"triggerAttackRelease",value:function(e,t,n,r){var a=this.carrierOscillator.getNoteFromTranspose(e);this.notes.push(a),this.filterEnvelope.refresh(),this.filterEnvelope2.refresh(),this.filterEnvelope.triggerAttackRelease(t,n,r),this.filterEnvelope2.triggerAttackRelease(t,n,r),this.synth.triggerAttackRelease(a,t,n,r),this.noiseOscillator.triggerAttackRelease(t,n,r)}},{key:"triggerRelease",value:function(e){var t=this,n=e.map(function(e){return t.carrierOscillator.getNoteFromTranspose(e)});this.filterEnvelope.triggerRelease(),this.filterEnvelope2.triggerRelease(),this.synth.triggerRelease(n),this.noiseOscillator.triggerRelease(H.a.Master.context.currentTime)}},{key:"releaseAll",value:function(){this.synth.releaseAll(),this.notes=[]}},{key:"setEnvelopes",value:function(e){this.carrierOscillator.setEnvelopes(e,this.ampEnvelope),this.setModulationEnvelopes(),this.setAmpEnvelopeForNoise(e)}},{key:"setModulationEnvelopes",value:function(){this.synth.set({modulationEnvelope:{attack:new H.a.Time((1+this.modulationEnvelope.attack)/1e3),decay:new H.a.Time((1+this.modulationEnvelope.decay)/1e3),sustain:this.modulationEnvelope.sustain,release:new H.a.Time((1+this.modulationEnvelope.release)/1e3)}})}},{key:"setAmpEnvelopeForNoise",value:function(){this.noiseOscillator.envelope.attack=new H.a.Time((1+this.ampEnvelope.attack)/1e3),this.noiseOscillator.envelope.decay=new H.a.Time((1+this.ampEnvelope.decay)/1e3),this.noiseOscillator.envelope.sustain=this.ampEnvelope.sustain,this.noiseOscillator.envelope.release=new H.a.Time((1+this.ampEnvelope.release)/1e3)}},{key:"dispose",value:function(){this.noiseOscillator.dispose(),this.filterEnvelope.dispose(),this.filterEnvelope2.dispose(),this.filter.dispose(),this.carrierOscillator.dispose(),this.noiseOscillator=void 0,this.filterEnvelope=void 0,this.filterEnvelope2=void 0,this.filter=void 0,this.carrierOscillator=void 0}},{key:"connectSynthToFilter",value:function(){this.synth.connect(this.filter.effectNode),this.noiseOscillator.connect(this.filter.effectNode)}},{key:"connect",value:function(e){void 0!==e&&this.filter.connect(e)}},{key:"disconnect",value:function(e){this.filter.disconnect(e)}},{key:"setupParameters",value:function(){var e=this;this.filterCutoffParameter=new Y.a("Filter Cutoff",this.filter.effectNode.frequency,function(t,n){e.filterEnvelope.frequency=n,e.filterEnvelope2.frequency=n,e.filter.cutoffFrequency=n},{min:0,max:1e4,unit:"HZ",defaultValue:1200,constantAutomationRate:!0}),this.registerParameter(this.filterCutoffParameter,function(e){return e.filter.frequency}),this.filterQParameter=new Y.a("Filter Q",this.filter.effectNode.Q,function(t,n){return e.filter.Q=n},{min:0,max:9,unit:"",defaultValue:1}),this.registerParameter(this.filterQParameter,function(e){return e.filter.Q}),this.noiseVolumeParameter=new Y.a("noiseVolume",this.noiseOscillator.volume,function(t,n){return e.noiseOscillator.volume.value=n},{min:0,max:1,unit:"db",defaultValue:0}),this.registerParameter(this.noiseVolumeParameter)}},{key:"registerParameter",value:function(e){e.setStore(this.store),e.setMixSession(this.mixSession),e.setContext(this.context),e.setTrack(this.context.track),this.parameters.push(e)}},{key:"getParameters",value:function(){return[].concat(Object(h.a)(this.parameters),Object(h.a)(this.ampEnvelope.parameters),Object(h.a)(this.filterEnvelope.parameters),Object(h.a)(this.filterEnvelope2.parameters),Object(h.a)(this.modulationEnvelope.parameters),Object(h.a)(this.carrierOscillator.parameters),Object(h.a)(this.modulatorOscillator.parameters))}},{key:"filterCutoff",get:function(){return this.filterCutoffParameter.get()},set:function(e){this.filterCutoffParameter.set(e)}},{key:"filterQ",get:function(){return this.filterQParameter.get()},set:function(e){this.filterQParameter.set(e)}},{key:"isMonophonic",value:function(){return 1===this.carrierOscillator.polyphony}},{key:"refreshParameters",value:function(){this.filterQ=this.filterQ,this.filterCutoff=this.filterCutoff}},{key:"getName",value:function(){return"FM Synth"}},{key:"getInstrument",value:function(){return this}},{key:"getInstrumentType",value:function(){return z.c}},{key:"getJson",value:function(){var e={instrumentType:this.getInstrumentType(),filterCutoff:this.filterCutoff,filterQ:this.filterQ,carrierOscillator:this.carrierOscillator.getJson(),modulatorOscillator:this.modulatorOscillator.getJson(),ampEnvelope:this.ampEnvelope.getJson(),filterEnvelope:this.filterEnvelope.getJson(),filterEnvelope2:this.filterEnvelope2.getJson(),modulationEnvelope:this.modulationEnvelope.getJson(),noiseVolume:this.noiseVolumeParameter.get()};return e=Object(Q.b)(e,"filterCutoffParameter",this.filterCutoffParameter),e=Object(Q.b)(e,"filterQParameter",this.filterQParameter),e=Object(Q.b)(e,"noiseVolumeParameter",this.noiseVolumeParameter)}},{key:"fromJson",value:function(e){for(var t in this.instrumentType=e.instrumentType,this.filterCutoff=e.filterCutoff,this.filterQ=e.filterQ,e.lfos)this.lfos[t].fromJson(e.lfos[t]);this.carrierOscillator.fromJson(e.carrierOscillator),this.modulatorOscillator.fromJson(e.modulatorOscillator),this.filterEnvelope.fromJson(e.filterEnvelope),e.filterEnvelope2&&this.filterEnvelope2.fromJson(e.filterEnvelope2),this.ampEnvelope.fromJson(e.ampEnvelope),this.modulationEnvelope.fromJson(e.modulationEnvelope),Object(Q.a)(e,"filterCutoffParameter",this.filterCutoffParameter,this.sequencerEngine),Object(Q.a)(e,"filterQParameter",this.filterQParameter,this.sequencerEngine)}},{key:"getCopy",value:function(e){var t=new n(this.sequencerEngine,this.mixSession,e);return t.fromJson(this.getJson()),t}},{key:"mateJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;this.carrierOscillator.mateJson(e.carrierOscillator,t),this.modulatorOscillator.mateJson(e.modulatorOscillator,t),this.ampEnvelope.mateJson(e.ampEnvelope,t),this.filterEnvelope.mateJson(e.filterEnvelope,t),this.filterEnvelope2.mateJson(e.filterEnvelope2,t),this.modulationEnvelope.mateJson(e.modulationEnvelope,t),this.mateParameter("filterCutoff",e,this.filterCutoffParameter,t),this.mateParameter("filterQ",e,this.filterQParameter,t),this.mateParameter("noiseVolume",e,this.noiseVolumeParameter,t)}},{key:"mateParameter",value:function(e,t,n,r){Object(W.b)(this.sequencerEngine,e,t,n,r)}},{key:"findParameter",value:function(e,t){var n=e.envelopeType,r=this.getParameters();n===ue.a?r=this.ampEnvelope.parameters:n===ue.d?r=this.modulationEnvelope.parameters:n===ue.b?r=this.filterEnvelope.parameters:n===ue.c&&(r=this.filterEnvelope2.parameters);var a=r.filter(function(e){return e.name===t});if(0!==a.length)return a[0]}}]),n}(G),pe=n(77),de=function(e,t,n,r){var a=n.getAllSteps(),i=r.getAllSteps();for(var o in a){var s=a[o];if(0!==s.pLockedParameters.length){var c=i[o];for(var u in s.pLockedParameters){var l=s.pLockedParameters[u],f=me(l,t);f?(f.stepToValue[c.id]=l.stepToValue[s.id],delete l.stepToValue[c.id],delete f.stepToValue[s.id],c.pLockedParameters[u]=f):delete l.stepToValue[s.id]}}}},me=function(e,t){return[].concat(Object(h.a)(t.getAllParameters()),Object(h.a)(t.sequencerEngine.lfos.flatMap(function(e){return e.lfo.parameters}))).filter(function(t){return!!t.context&&(t.context.effect&&e.context.effect?t.context.effect.name===e.context.effect.name:t.context.midiEffect&&e.context.midiEffect?t.context.midiEffect.name===e.context.midiEffect.name:t.context.liveEffect&&e.context.liveEffect?t.context.liveEffect.name===e.context.liveEffect.name:t.context.instrument&&e.context.instrument&&t.context.subDevice&&e.context.subDevice?t.context.subDevice.name===e.context.subDevice.name:!(!t.context.lfoTrack||!e.context.lfoTrack)&&t.context.lfoTrack.number===e.context.lfoTrack.number)}).find(function(t){return t.name===e.name})};function ve(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var be=n(163),ge=n(89);function ye(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ke=n(211),Oe=n(825),je=n(46);function we(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ee=n(195),Se=n(216);function Pe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var xe=n(726),Te=n(207),Ce=n(183),Ne=(n(191),n(271));function Re(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Me(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ae=function(){function e(t,n,r){Object(o.a)(this,e),this.output=new H.a.Gain(1),this.parameters=[],this.number=r,this.frozenSettings=[],this.frozenSamples=[],this.frozenSamplers=[],this.sequencerEngine=t,this.track=n,this.store=t.store,this.playingParameter=new $.a("playing",this,function(e,t){return[]},{isAlwaysLocked:!0,min:0,max:32,unit:"",defaultValue:void 0,automatable:!0}),this.registerParameter(this.playingParameter),this.gainParameter=new Y.c("gain",this.output.gain,{isAlwaysLocked:!0,min:0,max:1,defaultValue:1}),this.registerParameter(this.gainParameter)}return Object(s.a)(e,[{key:"updateRedux",value:function(){this.store.dispatch(Object(C.oc)(this.track.id,this.number,Object(h.a)(this.frozenSamples)))}},{key:"registerParameter",value:function(e){this.parameters.push(e),e.setStore(this.store),e.setContext((new L.a).forTrack(this.track))}},{key:"playing",get:function(){var e=this.playingParameter.get();if(void 0!==e&&null!==e)return Math.round(e)},set:function(e){this.playingParameter.set(e)}},{key:"saveAndPlayFrozen",value:function(e){this.track.lastFrozenSettings=this.sequencerEngine.getTrackPreset(this.track.trackNumber),this.playing=e,this.track.clearEffectsAndSamplers(),this.track.effectsChains[0].initDefault(),this.track.applyWarp(),this.track.isFrozen=!0,this.track.isFrozenPlaying=!0,this.track.getTrackType()===A.b&&this.track.instrument.dispose()}},{key:"loadFrozenSample",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sequencerEngine.bpm;this.frozenSamples.push(e);var r={slices:void 0,offset:0,transpose:0,volume:0},a=new Ne.a(this.track,e,function(e){e.gainNode.connect(t.output)},void 0,r);return a.tempo=n,a.init(),this.output.gain.value=1,this.frozenSamplers.push(a),this.updateRedux(),a}},{key:"getJson",value:function(){var e={frozenSettings:this.frozenSettings,frozenSamples:this.frozenSamples.map(function(e){return e.getId()}),frozenTempos:this.frozenSamplers.map(function(e){return e.tempo})};return e=Object(Q.b)(e,"playingParameter",this.playingParameter),e=Object(Q.b)(e,"gainParameter",this.gainParameter)}},{key:"getJsonSync",value:function(){var e,t={frozenSettings:this.frozenSettings,frozenSamples:this.frozenSamples.map(function(e){return e.getCopy(!0)}),frozenTempos:this.frozenSamplers.map(function(e){return e.tempo})},n=Re(this.frozenSamplers);try{for(n.s();!(e=n.n()).done;){e.value.isCopied=!0}}catch(r){n.e(r)}finally{n.f()}return t=Object(Q.b)(t,"playingParameter",this.playingParameter),t=Object(Q.b)(t,"gainParameter",this.gainParameter)}},{key:"fromJsonSync",value:function(e){for(var t in this.frozenSettings=e.frozenSettings,e.frozenSamples){var n=e.frozenSamples[t];this.loadFrozenSample(n,e.frozenTempos[t]).isCopied=!0}Object(Q.a)(e,"playingParameter",this.playingParameter,this.sequencerEngine),Object(Q.a)(e,"gainParameter",this.gainParameter,this.sequencerEngine)}},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.frozenSettings=t.frozenSettings,e.t0=a.a.keys(t.frozenSamples);case 2:if((e.t1=e.t0()).done){e.next=11;break}return n=e.t1.value,r=t.frozenSamples[n],i=new R.a(r),e.next=8,i.load();case 8:this.loadFrozenSample(i,t.frozenTempos[n]),e.next=2;break;case 11:Object(Q.a)(t,"playingParameter",this.playingParameter,this.sequencerEngine);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.frozenSamples.length,this.frozenSamplers.forEach(function(e){return e.dispose()}),this.frozenSamples.forEach(function(e){return e.dispose()}),this.frozenSamplers=void 0,this.frozenSamples=void 0,this.output.dispose(),this.output=void 0}}]),e}(),qe=n(101),De=n(250);function Ie(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _e(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}new H.a.Time("16n");var Le=function(e){return function(e){Object(u.a)(n,e);var t=Fe(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).frozenSamplesToSave=[],e}return Object(s.a)(n,[{key:"frozenColumn",get:function(){return this.frozenColumns[0]}},{key:"newFrozenColumn",value:function(){if(void 0===this.frozenColumns){var e=new Ae(this.sequencerEngine,this,0);return e.output.connect(this.gainNode),this.frozenColumns=[e],e}var t=new Ae(this.sequencerEngine,this,this.frozenColumns.length);return t.output.connect(this.gainNode),this.frozenColumns=[].concat(Object(h.a)(this.frozenColumns),[t]),t}},{key:"freeze",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Array.isArray(e)||(e=[e]),!this.isAudioTrack){var r=this.state.effects.pulledEffects.filter(function(e){return(!e.context||e.context.track!==t)&&e.track!==t});this.dispatch(Object(C.we)(r));this.getAllParameters().forEach(function(e){return e.isMapped&&e.isMapped.unmap(e)})}var a=this.sample,i=this.isAudioTrack?this.newFrozenColumn():this.frozenColumns[0]||this.newFrozenColumn();a&&(e.forEach(function(e){return e.name=a.name}),e.forEach(function(e){return e.tags=e.tags.concat(a.tags)}),e.forEach(function(e){return e.videoId=a.videoId}),e.forEach(function(e){return e.sourceSample=a})),this.tagFrozenSamples(e),this.frozenSamplesToSave=[].concat(Object(h.a)(this.frozenSamplesToSave),Object(h.a)(e)),this.isFrozen||n||(this.lastFrozenSettings=this.sequencerEngine.getTrackPreset(this.trackNumber,!1)),i.frozenSettings.push(this.isAudioTrack?{}:this.lastFrozenSettings);var o=this.isFrozen;this.store.dispatch(Object(C.Vg)(this.subSequence.id,this.id,!0)),this.isAudioTrack||(this.clearEffectsAndSamplers(),this.effectsChains[0].initDefault(),this.applyWarp()),e.forEach(function(e){return i.loadFrozenSample(e,void 0)}),this.getTrackType()!==A.b||o?this.getTrackType()!==A.c||o||this.tracks.forEach(function(e){var t=e.track;return t.instrument&&t.instrument.dispose()}):this.instrument.dispose(),i.playing=i.frozenSamples.length-1,this.gated=!1,this.cachedPlayhead=void 0,this.parametersToScale=void 0,this.sequencerEngine.selectTrack(0),this.sequencerEngine.selectTrack(this.trackNumber),this.isEnabled&&!this.isAudioTrack&&this.setIsEnabled(!1),this.skipMidiMasterParameter.set(!0),this.trackIsLoading=!1}},{key:"clearEffectsAndSamplers",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.volumeParameter.deleteAutomations(),this.volumeParameter.deleteLocks(),this.effectsChains.forEach(function(e){return e.clear()}),this.midiEffects.effects=[],this.liveEffects.effects=[],this.tracks&&this.tracks.forEach(function(e){var t=e.track;t.effectsChains.forEach(function(e){return e.clear()}),t.midiEffects.effects=[],t.liveEffects.effects=[]});var e=this.getAllParameters().filter(function(e){return e.automations&&e.automations.length>0});this.sequencerEngine.store.dispatch(Object(C.d)(e))}},{key:"triggerFrozenSample",value:function(e){var t=new q.a;t.loadDefaults(),this.midiEffects.input(t,e,0)}},{key:"isFrozen",get:function(){return(this.store.getState().tracks.tracksFrozen[this.subSequence.id]||{})[this.id]},set:function(e){this.store.dispatch(Object(C.Vg)(this.subSequence.id,this.id,e))}},{key:"unfreeze",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s,c=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.cachedPlayhead=void 0,t=this.lastFrozenSettings,this.clearEffectsAndSamplers(),this.store.dispatch(Object(C.Vg)(this.subSequence.id,this.id,!1)),e.next=6,this.unfreezeInstrument(t);case 6:return this.trackData=new q.a(this.sequencerEngine,this.mix,(new L.a).forTrack(this)),this.trackData.loadDefaults(),t.trackParameters&&(this.gated=t.trackParameters.gated),this.trackData.loadFromJson(t.trackData,void 0,!1,!1,this.sequencerEngine),this.effectsChains[0].dispose(),e.next=13,this.sequencerEngine.loadEffectsPreset(t,!1,this);case 13:if(!this.tracks){e.next=34;break}n=0,r=Ie(this.tracks),e.prev=16,r.s();case 18:if((i=r.n()).done){e.next=26;break}return o=i.value,s=o.track,e.next=23,this.sequencerEngine.loadEffectsPreset(t.trackParameters.tracks[n],!1,s);case 23:n++;case 24:e.next=18;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(16),r.e(e.t0);case 31:return e.prev=31,r.f(),e.finish(31);case 34:this.skipMidiMasterParameter.set(!1),this.frozenColumns.forEach(function(e){return e.frozenSamplers.forEach(function(e){return e.release()})}),this.frozenColumns.forEach(function(e){return e.playing=void 0}),setTimeout(function(){c.loadLostParameters()},750);case 38:case"end":return e.stop()}},e,this,[[16,28,31,34]])}));return function(){return e.apply(this,arguments)}}()},{key:"unfreezeInstrument",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.frozenJson}},{key:"getFreezeJson",value:function(){return{lastFrozenSettings:this.lastFrozenSettings,frozenColumns:this.frozenColumns.map(function(e){return e.getJson()})}}},{key:"getFreezeJsonSync",value:function(){return{lastFrozenSettings:this.lastFrozenSettings,frozenColumns:this.frozenColumns.map(function(e){return e.getJsonSync()})}}},{key:"loadFreezeJsonSync",value:function(e){for(var t in this.lastFrozenSettings=e.lastFrozenSettings,e.frozenColumns){(this.frozenColumns[parseInt(t)]||this.newFrozenColumn()).fromJsonSync(e.frozenColumns[t])}}},{key:"loadFreezeJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.lastFrozenSettings=t.lastFrozenSettings,e.t0=a.a.keys(t.frozenColumns);case 2:if((e.t1=e.t0()).done){e.next=9;break}return n=e.t1.value,r=this.frozenColumns[parseInt(n)]||this.newFrozenColumn(),e.next=7,r.fromJson(t.frozenColumns[n]);case 7:e.next=2;break;case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"applyWarp",value:function(){this.operationManager.dispatch(Object(je.b)(new De.a(this),this))}},{key:"dragFreezeIntoColumn",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.newFrozenColumn(),r=void 0,a=void 0,i=void 0,o=Ie(this.frozenColumns);try{for(o.s();!(t=o.n()).done;){var s=t.value;for(var c in s.frozenSamples)if(s.frozenSamples[c].ipfsHash===e){a=s.frozenSamples[c],r=s.frozenSamplers[c],i=s.frozenSettings[c],s.frozenSamples.splice(c,1),s.frozenSettings.splice(c,1),s.frozenSamplers.splice(c,1),s.updateRedux();break}}}catch(u){o.e(u)}finally{o.f()}void 0!==r&&(r.gainNode.disconnect(),n.frozenSamplers.push(r),n.frozenSamples.push(a),n.frozenSettings.push(i),r.gainNode.connect(n.output),n.playing=0,n.updateRedux())}},{key:"disposeFreezes",value:function(){this.frozenColumns.forEach(function(e){return e.dispose()}),this.frozenColumns=void 0}},{key:"freezeAllPatterns",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.store.dispatch(Object(C.bd)("Freezing track's patterns")),e.next=3,Object(m.a)(250);case 3:return this.sequencerEngine.stop(),e.next=6,Object(Te.e)(this.sequencerEngine,this);case 6:return t=e.sent,e.next=9,Object(xe.a)(this.sequencerEngine,t,this.patterns.length,[this]);case 9:for(o in n=e.sent,this.freeze(n),r=this.sequencerEngine.state.freeze.loops,i=Object(Te.f)(this.sequencerEngine,0,this.sequencerEngine.tracks)*r,this.patterns){for(o=parseInt(o),this.switchToPattern(o),s=i/this.pattern.length(),c=0;c<Math.log2(s);c++)this.pattern.doubleTrackLength();this.frozenColumns[0].playing=o,this.store.dispatch(Object(C.bd)(void 0))}case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"tagFrozenSamples",value:function(e){var t=this;if(this.instrument){var n=z.d[this.instrument.getInstrumentType()];e.forEach(function(e){return e.tags.push(n)}),this.presetName&&e.forEach(function(e){return e.tags.push(t.presetName)})}}}]),n}(e)};function Be(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ze=new q.a,Ve=n(193),He=n(178);function Ue(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Je(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ge(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var We=["Duration","Transpose","Velocity","Chop","Panning","Slice"],Ke=function(e){Object(u.a)(n,e);var t=Ge(n);function n(e,r,a,i,s,c){var u;return Object(o.a)(this,n),(u=t.call(this,e,r,a,i,s,c)).annotations=[],u.setupAuxEventParameters(),u}return Object(s.a)(n,[{key:"getStepDataParams",value:function(){return We}},{key:"getCopy",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t,r,a,i,o){return new n(e,t,r,a,i,o)},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sequencerEngine,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.trackData.getCopy(void 0,void 0,void 0,void 0,!1),o=[].concat(this.soundIds),s=t(this.trackNumber,r,this.mixSession,this.patterns.length,this.update,r.currentSubSequence);s.stepGroups=this.stepGroups;var c=this.patterns.map(function(e){return e.getCopy(void 0,void 0,s)}),u=this.currentPattern,l=c[u];for(var f in c){var h=c[f];for(var p in h.stepBuckets)for(var d in h.stepBuckets[p].track=s,h.stepBuckets[p].steps)h.stepBuckets[p].steps[d].track=s;h.track=s}this.sample&&(s.sample=this.sample.getCopy()),s.lfosTrack&&s.lfosTrack.lfos.forEach(function(t,n){return t.lfo.fromJson(e.lfosTrack.lfos[n].getJson(),a)}),s.envelopesTrack&&s.envelopesTrack.envelopes.forEach(function(t,n){return t.envelope.fromJson(e.envelopesTrack.envelopes[n].getJson(),a)}),s.name=this.name,s.videoId=this.videoId,s.effectsChains[0].dispose(),s.effectsChains=this.effectsChains.map(function(e){return e.getCopy(s,r,a)}),s.midiEffects=this.midiEffects.getCopy(s,a),s.liveEffects=this.liveEffects.getCopy(s,a),s.trackData=i,s.patterns=c,s.currentPattern=u,s.pattern=l,s.soundIds=o,s.gated=this.gated;for(var m=0;m<c.length;m++)de(0,s,this.patterns[m],c[m]);var v,b=Ue(this.connectedEnvelopes.filter(function(e){return e.envelope}).map(function(e){return e.getJson()}));try{for(b.s();!(v=b.n()).done;){var g=v.value,y=r.envelopes[g.envelope];s.connectToEnvelope(y,g.mode)}}catch(E){b.e(E)}finally{b.f()}var k={};for(var O in this.samplers)k[O]=this.samplers[O].getCopy(function(e){return s.onNewSampler(s,e)},s);for(var j in s.samplers=k,s.updateSteps(!0),s.setSends(r.sends),s.sendNodeVolumeParameters)this.sendNodeVolumeParameters[j]&&s.sendNodeVolumeParameters[j].copyFrom(this.sendNodeVolumeParameters[j],r);if(s.volumeParameter.copyFrom(this.volumeParameter,r),s.isFrozen=this.isFrozen,s.isFrozen){var w=this.getFreezeJsonSync();s.loadFreezeJsonSync(w)}return this.samplesStream?s.samplesStream=this.samplesStream.getCopy(s.sample):s.samplesStream=new ke.a(s.sample,this.sequencerEngine),s.presetName=this.presetName,s}},{key:"addNotes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sequencerEngine.bpm,r=H.a.Time("16n").toMilliseconds();e=e.map(function(e){var a=e.velocity/127;return{transpose:e.pitch-60,startTime:1e3*e.startTime,velocity:a,duration:n/t.sequencerEngine.bpm*(1e3*(e.endTime-e.startTime))/r}});H.a.Time("32n").toMilliseconds();var a=-1;for(var i in e){var o=Object(Oe.a)(e[i].startTime,n,this.sequencerEngine.bpm);e[i].step=o.stepNumber,e[i].position=o.offset,e[i].step>a&&(a=e[i].step)}for(;a>=this.pattern.length();)this.sequencerEngine.doubleTrackLength(this.trackNumber);var s=this.getEasyPattern();e.forEach(function(e){return s.addStep(t.getStepDataForNote(e),e.step,pe.a.baseResolution,e.position,!1,!0)}),s.update(!1),this.updateSteps()}},{key:"getStepDataForNote",value:function(e){var t=new q.a(this.sequencerEngine,void 0,void 0,this);return t.on=!0,t.transpose=e.transpose,t.duration=e.duration,t.velocity=e.velocity,t}},{key:"toggleStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.store.getState().sequencer.resolution,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.pattern.toggleStep(pe.a.baseResolution.transformStepAtResolution(e,t),t,n,this.trackData.transpose===n),this.pattern.syncBuckets(),this.updateSteps()}},{key:"getStep",value:function(e){return this.pattern.getAnyStep(e%this.pattern.length())}},{key:"recordHit",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;t=t||pe.a.baseResolution;var s=new q.a(void 0,void 0,void 0,this);if(s.on=!0,s.slice=n,s.duration=r,s.transpose=a,s.velocity=i,s.release=o,void 0===this.currentPattern){var c=new I.a(this.sequencerEngine,this),u=e-e%t.transformStepAtResolution2(16,pe.a.baseResolution);c.startStep=pe.a.baseResolution.transformStepAtResolution2(u,t),this.patterns.push(c),this.switchToPattern(this.patterns.length-1),this.updateSteps()}void 0!==this.pattern.startStep&&(e-=t.transformStepAtResolution2(this.pattern.startStep,pe.a.baseResolution)),this.pattern.isRecording=!0,this.sequencerEngine.operationManager.dispatch(Object(je.o)(this,s,e,t,this.state.sequencer.displayResolution))}},{key:"syncBuckets",value:function(e){this.pattern.syncBuckets(e.isTriplet),this.pattern.clearCache()}},{key:"recordUnquantizedHit",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=pe.a.baseResolution,c=new q.a;c.on=!0,c.slice=t,c.velocity=i,c.duration=n,c.transpose=a,c.release=o;var u=(e+r)%this.pattern.length(s);this.sequencerEngine.operationManager.dispatch(Object(je.o)(this,c,Math.max(0,u),s,this.state.sequencer.displayResolution,!1))}},{key:"selectSlice",value:function(e,t){for(var n=-16,r=0;r<this.soundIds.length;r++){var a=this.samplers[this.soundIds[r]].getNumberOfSlices();n<a&&(n=a)}t%=n;var i=this.pattern.stepBuckets[e];for(var o in i.steps)i.steps[o].slice=t}}]),n}(Object(Ve.a)(function(e){return function(e){Object(u.a)(n,e);var t=Be(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).backStreams=[],e.forwardStreams=[],e}return Object(s.a)(n,[{key:"newSampleStream",value:function(e){this.samplesStream&&this.backStreams.push(this.samplesStream),this.forwardStreams.forEach(function(e){return e.dispose()}),this.forwardStreams=[],this.samplesStream=e}},{key:"backSamplesStream",value:function(){if(console.log("BACK SAMPLES STREAM CALLED"),0!==this.backStreams.length){var e=this.backStreams.pop();this.forwardStreams=[this.samplesStream].concat(Object(h.a)(this.forwardStreams)),this.samplesStream=e}}},{key:"forwardSamplesStream",value:function(){console.log("FWD SAMPLES STREAM CALLED");var e=this.forwardStreams.shift();this.backStreams.push(this.samplesStream),this.samplesStream=e}},{key:"getSamplesStream",value:function(){return this.samplesStream}},{key:"auditionNext",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o.length>0&&void 0!==o[0])||o[0],o.length>1&&void 0!==o[1]&&o[1],!this.isFrozen){e.next=4;break}return e.abrupt("return");case 4:if(t=this.instrumentRack?this.instrumentRack.trackNumber:this.trackNumber,this.store.dispatch(Object(C.Xg)(this.subSequence.id,t,!0)),(new Date).getTime(),e.prev=7,!this.loadingAudition){e.next=11;break}return this.store.dispatch(Object(C.Xg)(this.subSequence.id,t,!1)),e.abrupt("return");case 11:n=this.getSamplesStream(),r=0;case 13:if(!(r<8)||n.hasNext()){e.next=22;break}if(7!==r){e.next=17;break}return this.store.dispatch(Object(C.Xg)(this.subSequence.id,t,!1)),e.abrupt("return");case 17:return e.next=19,Object(m.a)(200);case 19:r++,e.next=13;break;case 22:return this.loadingAudition=!0,e.next=25,n.getNext();case 25:i=e.sent,this.store.dispatch(Object(C.Xg)(this.subSequence.id,t,!1)),this.loadingAudition=!1,this.releaseAll(),this.useNewSound(i),ze.track=this,ze.duration=4,this.sequencerEngine.playing||this.trigger(ze),this.addSoundToBrowsedSamples(i),(new Date).getTime(),e.next=41;break;case 38:e.prev=38,e.t0=e.catch(7),this.loadingAudition=!1;case 41:case"end":return e.stop()}},e,this,[[7,38]])}));return function(){return e.apply(this,arguments)}}()},{key:"auditionPrevious",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.length>0&&void 0!==i[0])||i[0],i.length>1&&void 0!==i[1]&&i[1],!this.isFrozen){e.next=4;break}return e.abrupt("return");case 4:if(t=this.instrumentRack?this.instrumentRack.trackNumber:this.trackNumber,this.store.dispatch(Object(C.Xg)(this.subSequence.id,t,!0)),e.prev=6,n=this.getSamplesStream(),!this.loadingAudition){e.next=11;break}return this.store.dispatch(Object(C.Xg)(this.subSequence.id,t,!1)),e.abrupt("return");case 11:if(n.hasPrevious()){e.next=14;break}return this.store.dispatch(Object(C.Xg)(this.subSequence.id,t,!1)),e.abrupt("return");case 14:return this.loadingAudition=!0,e.next=17,n.getPrevious();case 17:return r=e.sent,this.store.dispatch(Object(C.Xg)(this.subSequence.id,t,!1)),this.loadingAudition=!1,this.addSoundToBrowsedSamples(r),this.releaseAll(),e.next=24,this.useNewSound(r);case 24:ze.track=this,ze.duration=4,this.sequencerEngine.playing||this.trigger(ze),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(6),this.loadingAudition=!1;case 32:case"end":return e.stop()}},e,this,[[6,29]])}));return function(){return e.apply(this,arguments)}}()},{key:"useSound",value:function(e,t){if(t)for(var n in this.samplers)this.samplers[n].dispose(),delete this.samplers[n];this.sample=e,this.soundIds=[e.getId()],this.toAudition.push(e.getId()),this.loadTrackInfo(!0,e)}},{key:"loadAndUseNewSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoaded()){e.next=3;break}return e.next=3,t.load();case 3:for(n in this.samplers)this.samplers[n].isChosen=!1;this.samplers[t.getId()]?this.samplers[t.getId()].isChosen=!0:this.loadTrackInfo(!0,t),this.soundIds=[t.getId()],this.videoId=t.videoId,this.sample=t,void 0===this.videoId&&this.getTrackType(),this.name=t.name;case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"useNewSound",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object.keys(this.samplers)[0],a=this.samplers[r];if(!a)return this.useSound(e,!0),void(this.pad&&this.pad.sendTags());this.samplers[e.getId()]=a,delete this.samplers[r],a.sample=e,this.soundIds=[e.getId()],this.videoId=e.videoId,this.sample=e,void 0===this.videoId&&this.getTrackType(),this.name=e.name,a.replaceBuffer(e.audioBuffer,n),t&&(ze.track=this,ze.duration=4,this.sequencerEngine.playing||this.trigger(ze)),this.pad&&this.pad.sendTags()}},{key:"auditionSeek",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.store.dispatch(Object(C.Xg)(this.subSequence.id,this.trackNumber,!0)),e.next=3,this.samplesStream.seek(t);case 3:if(n=e.sent){e.next=7;break}return this.store.dispatch(Object(C.Xg)(this.subSequence.id,this.trackNumber,!1)),e.abrupt("return");case 7:return this.loadingAudition=!1,this.addSoundToBrowsedSamples(n),this.releaseAll(),e.next=12,this.useNewSound(n);case 12:ze.track=this,ze.duration=4,this.sequencerEngine.playing||this.trigger(ze),this.store.dispatch(Object(C.Xg)(this.subSequence.id,this.trackNumber,!1));case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"auditionSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]&&s[1],r=s.length>2?s[2]:void 0,i=!(s.length>3&&void 0!==s[3])||s[3],this.store.dispatch(Object(C.Xg)(this.subSequence.id,this.trackNumber,!0)),o=this.sample,"string"===typeof t&&(t=new R.a(t)),t.isLoaded()){e.next=10;break}return e.next=9,t.load();case 9:t.samplesStream&&(r=t.samplesStream.getCopy(t));case 10:this.savedSoundIds=Object(h.a)(this.soundIds),this.soundIds=[t.getId()],this.toAudition.push(t.getId()),this.auditionedSounds.push(t.getId()),r&&(r.counter=r.sounds.indexOf(t.getId())),this.samplesStream&&n&&this.samplesStream.dispose(),this.samplesStream=r||new ke.a(t,this.sequencerEngine),this.loadTrackInfo(!0,t),i&&this.addSoundToBrowsedSamples(t,o);case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addSoundToBrowsedSamples",value:function(e,t){var n=this,r=this.state.tracks.trackBrowsedSamples[this.id]||[];if(t){var a=r.indexOf(t);a>-1&&(r.slice(0,a).forEach(function(e){var t=e.ipfsHash,r=n.samplers[t];r&&(r.dispose(),delete n.samplers[t]),e.dispose(!0)}),r=r.slice(a))}if(!(r.indexOf(e)>-1)){var i=[e].concat(Object(h.a)(r.filter(function(t){return t.ipfsHash!==e.ipfsHash})));this.store.dispatch(Object(C.Rg)(this.id,i))}}},{key:"isAuditioning",value:function(){return this.auditionedSounds.length>0}},{key:"completeAudition",value:function(){for(var e in this.auditionedSounds)if(-1==this.soundIds.indexOf(this.auditionedSounds[e])){var t=this.samplers[this.auditionedSounds[e]];t&&(t.dispose(),delete this.samplers[this.auditionedSounds[e]])}this.auditionedSounds=[],this.store.dispatch(Object(C.Fe)(void 0))}},{key:"cancelAudition",value:function(){this.isAuditioning()&&(this.soundIds=this.savedSoundIds,this.revertAuditionedSounds()),this.store.dispatch(Object(C.Fe)(void 0))}},{key:"revertAuditionedSounds",value:function(){for(var e in this.auditionedSounds){var t=this.samplers[this.auditionedSounds[e]];t&&(t.dispose(),delete this.samplers[this.auditionedSounds[e]])}this.auditionedSounds=[]}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=ye(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"onRestart",value:function(e){"clear"!==e?void 0!==e.stepNumber?this.restartedAtStepNumber=e.stepNumber:this.restartedAtStepNumber=this.sequencerEngine.trackStep:this.restartedAtStepNumber=void 0}},{key:"getPatternStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isMetronome){var n=void 0===this.pattern.startStep?0:this.pattern.startStep,r=this.pattern.length();return this.subSequence.isTrack?e-n:e%r}if(!t)return!this.playheadEffect&&this.pattern&&1===this.speedFactor?e%this.length:this.lastPatternStep||0;void 0!==this.restartedAtStepNumber&&(e-=this.restartedAtStepNumber);var a=void 0===this.pattern.startStep?0:this.pattern.startStep,i=this.length,o=this.playheadDirection;if(o===be.a)return this.getBrownian(e,t);e=e*this.speedFactor+Math.floor(this.offset);var s=this.subSequence.isTrack?e-a:e%i;return t&this.speedFactor<1&&s===this.lastPatternStep?void 0:(o===be.c&&(o=Math.floor(e/i)%2===0?be.b:be.d),o===be.d&&(this.playheadDirection===be.c?(s=i-s)===i&&(s=i-2):s=i-s-2),this.lastPatternDirection=o,this.lastPatternStep=s,s)}},{key:"isPlayheadReversed",value:function(){return this.lastPatternDirection===be.d}},{key:"playheadEffect",get:function(){return this.cachedPlayhead?this.cachedPlayhead:(this.cachedPlayhead=this.liveEffects.effects.find(function(e){return e.effect===ge.e}),this.cachedPlayhead)}},{key:"playheadDirection",get:function(){var e=this.playheadEffect;return e?this.subSequencePlayhead.direction!==be.b?this.subSequencePlayhead.direction:e.direction:be.b}},{key:"subSequencePlayhead",get:function(){return this.subSequence.playhead}},{key:"speedFactor",get:function(){var e=this.playheadEffect;return(e?this.subSequence.playhead.speedFactor*e.speedFactor:this.subSequence.playhead?this.subSequence.playhead.speedFactor:1)*this.sequencerEngine.higherOrderSequencer.getSpeedForModule(this.subSequence)}},{key:"offset",get:function(){var e=this.playheadEffect;return e?e.offset:0}},{key:"walk",get:function(){var e=this.playheadEffect;return e?e.walk:2}},{key:"getBrownian",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===this.lastPatternStep&&t)return this.lastPatternStep=e,e;if(((e=this.lastPatternStep)+1)%this.walk===0){var n=Math.random();n<.5?e+=1:e-=n<.75?2*this.walk-1:this.walk-1,e<0?e=this.length-this.walk:e%=this.length}else e++;return t&&(this.lastPatternStep=e),e}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=ve(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getParametersToShow",value:function(){var e=Object(h.a)(this.effects);for(var t in this.effects){var n=this.effects[t];"Effect Rack"===n.name&&(e=[].concat(Object(h.a)(e),Object(h.a)(n.effects),Object(h.a)(n.macros.map(function(e){return e.macroParameter}))))}if(this.tracks)for(var r in this.tracks)e=[].concat(Object(h.a)(e),Object(h.a)(this.tracks[r].track.effects));var a=e.find(function(e){return"Filter"===e.name}),i=(e.find(function(e){return"EQ 8"===e.name}),e.find(function(e){return"Tape Delay"===e.name})),o=this.midiEffects.effects.find(function(e){return"Warp"===e.name}),s=this.midiEffects.effects.find(function(e){return"Tidal"===e.name}),c=[];return a&&c.push(a.cutoffParameter),i&&(c.push(i.rateParameter),c.push(i.wetParameter)),o&&c.push(o.loopLengthParameter),s&&c.push(s.cycleParameter),c}}]),n}(e)},Le,function(e){return function(e){Object(u.a)(n,e);var t=we(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"convertToSampledInstrument",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.pad,n=void 0,t&&(n=t.slots.indexOf(this)),r=this.sequencerEngine.addSampledInstrumentTrack(!1,!0),i=this.sample,r.instrument.newSample(0,i,this.samplesStream.getCopy(this.sample)),this.convertGenericTrack(r),r.sample=i,t&&t.addTrack(r,n);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"copyPatterns",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.patterns.map(function(e){return e.getCopy(void 0,void 0,t)}),e.next=3,Promise.all(n);case 3:for(r in n=e.sent){for(o in(i=n[r]).stepBuckets)for(s in i.stepBuckets[o].track=t,i.stepBuckets[o].steps)i.stepBuckets[o].steps[s].track=t;i.track=t}return e.abrupt("return",n);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"copyEffects",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.effectsChain.getJson(),e.next=3,t.midiEffects.fromJson(this.midiEffects.getJson());case 3:return e.next=5,t.effectsChain.fromJson(n,this.sequencerEngine.tracks,this.trackNumber);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"convertGenericTrack",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.copyPatterns(t);case 2:return t.patterns=e.sent,t.pattern=t.patterns[this.currentPattern],t.stepGroups=t.patterns.map(function(e){return e.getAllGroups()}).reduce(function(e,t){return[].concat(Object(h.a)(e),Object(h.a)(t))},[]),n=this.trackNumber,(r=this.sequencerEngine.tracks).splice(n,1),i=this.getAllParameters(),o=i.filter(function(e){return e.automations&&e.automations.length>0}),this.sequencerEngine.store.dispatch(Object(C.d)(o)),e.next=13,this.copyEffects(t);case 13:this.sequencerEngine.tracks=[].concat(Object(h.a)(r.slice(0,n)),[this],Object(h.a)(r.slice(n))),this.sequencerEngine.deleteTrack(n,t),t.pattern.updateStepResolutionTree(),this.sequencerEngine.updateSteps(),this.sequencerEngine.selectTrack(n),t.getAllParameters().filter(function(e){return e.automations&&e.automations.length>0}).forEach(function(e){return e.automation.updateRedux()}),setTimeout(function(){t.tracks?t.tracks[0].track.loadLostParameters():t.loadLostParameters()},250);case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"convertToInstrumentRack",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.sequencerEngine.addInstrumentRackTrack(!1,!0),(n=this.getTrackType())!==A.f){e.next=6;break}t.addSample(this.sample,this.samplesStream.getCopy(this.sample)),e.next=11;break;case 6:if(n!==A.b){e.next=11;break}return r=t.addInstrumentType(this.getInstrumentType()),i=this.getJson(),e.next=11,r.track.fromJson(i,void 0,!1,!1,!0,!0);case 11:return e.next=13,this.convertGenericTrack(t);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Pe(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setupAuxEventParameters",value:function(){this.createAuxEventType("A"),this.createAuxEventType("B"),this.createAuxEventType("C"),this.createAuxEventType("D"),this.accumulators={}}},{key:"createAuxEventType",value:function(e){var t="auxEvent"+e,n=new $.a(t+"Type",this,function(e,t){return[]},{defaultValue:Se.b,automatable:!1}),r=new $.a(t+"Variable",this,function(e,t){return[]},{defaultValue:"transpose",automatable:!1}),a=new $.a(t+"Limit",this,function(e,t){return[]},{defaultValue:1,automatable:!1,min:0,max:32}),i=new $.a(t+"Mode",this,function(e,t){return[]},{defaultValue:Ee.b,automatable:!1});this[t+"TypeParameter"]=n,this[t+"LimitParameter"]=a,this[t+"ModeParameter"]=i,this[t+"VariableParameter"]=r,this.registerParameter(n),this.registerParameter(a),this.registerParameter(i),this.registerParameter(r)}},{key:"auxEventAType",get:function(){return this.auxEventATypeParameter.get()}},{key:"auxEventBType",get:function(){return this.auxEventBTypeParameter.get()}},{key:"auxEventCType",get:function(){return this.auxEventCTypeParameter.get()}},{key:"auxEventDType",get:function(){return this.auxEventDTypeParameter.get()}},{key:"getAuxLimit",value:function(e){return this["auxEvent"+e.split(" ")[2]+"LimitParameter"].get()}},{key:"getAuxVariable",value:function(e){return this["auxEvent"+e.split(" ")[2]+"VariableParameter"].get()}},{key:"getAuxMode",value:function(e){return this["auxEvent"+e.split(" ")[2]+"ModeParameter"].get()}},{key:"getAuxJson",value:function(){for(var e={},t=0,n=["A","B","C","D"];t<n.length;t++){var r=n[t],a="auxEvent"+r+"TypeParameter",i="auxEvent"+r+"VariableParameter",o="auxEvent"+r+"LimitParameter",s="auxEvent"+r+"ModeParameter";e[a]=this[a].getJson(),e[i]=this[i].getJson(),e[o]=this[o].getJson(),e[s]=this[s].getJson()}return e}},{key:"fromAuxJson",value:function(e){for(var t=0,n=["A","B","C","D"];t<n.length;t++){var r=n[t],a="auxEvent"+r+"TypeParameter",i="auxEvent"+r+"VariableParameter",o="auxEvent"+r+"LimitParameter",s="auxEvent"+r+"ModeParameter";this[a].fromJson(e[a]),this[i].fromJson(e[i]),this[o].fromJson(e[o]),this[s].fromJson(e[s])}}}]),n}(e)})(pe.a.Track)),Xe=n(50),Qe=n(179),Ye=function(){function e(t,n,r,a){Object(o.a)(this,e),this.synth=t,this.store=n,this.mixSession=r,this.context=a,this.parameters=[],this.setupParameters()}return Object(s.a)(e,[{key:"onNewSynth",value:function(e){this.synth=e,this.refreshParameters()}},{key:"attack",get:function(){return this.attackParameter.get()},set:function(e){this.attackParameter.set(e)}},{key:"decay",get:function(){return this.decayParameter.get()},set:function(e){this.decayParameter.set(e)}},{key:"sustain",get:function(){return this.sustainParameter.get()},set:function(e){this.sustainParameter.set(e)}},{key:"release",get:function(){return this.releaseParameter.get()},set:function(e){this.releaseParameter.set(e)}},{key:"baseFrequency",get:function(){return this.baseFrequencyParameter.get()},set:function(e){this.baseFrequencyParameter.set(e)}},{key:"octaves",get:function(){return this.octavesParameter.get()},set:function(e){this.octavesParameter.set(e)}},{key:"refreshParameters",value:function(){this.baseFrequency=this.baseFrequency,this.octaves=this.octaves,this.attack=this.attack,this.decay=this.decay,this.sustain=this.sustain,this.release=this.release}},{key:"setupParameters",value:function(){this.attackParameter=new $.a("Filter Envelope Attack",this,function(e,t){return e.synth.set({filterEnvelope:{attack:t/1e3}})},{min:0,max:1e4,unit:"ms",defaultValue:60}),this.registerParameter(this.attackParameter),this.decayParameter=new $.a("Filter Envelope Decay",this,function(e,t){return e.synth.set({filterEnvelope:{decay:t/1e3}})},{min:0,max:1,unit:"ms",defaultValue:60}),this.registerParameter(this.decayParameter),this.sustainParameter=new $.a("Filter Envelope Sustain",this,function(e,t){return e.synth.set({filterEnvelope:{sustain:t}})},{min:0,max:1,unit:"",defaultValue:.9}),this.registerParameter(this.sustainParameter),this.releaseParameter=new $.a("Filter Envelope Release",this,function(e,t){return e.synth.set({filterEnvelope:{release:t/1e3}})},{min:0,max:1,unit:"ms",defaultValue:60}),this.registerParameter(this.releaseParameter),this.baseFrequencyParameter=new $.b("Filter Envelope Base Frequency",this,function(e,t){return e.synth.set({filterEnvelope:{baseFrequency:t}})},{min:0,max:1e4,unit:"HZ",defaultValue:100}),this.registerParameter(this.baseFrequencyParameter),this.octavesParameter=new $.b("Filter Envelope Octaves",this,function(e,t){return e.synth.set({filterEnvelope:{octaves:t}})},{min:0,max:10,unit:"",defaultValue:1}),this.registerParameter(this.octavesParameter)}},{key:"registerParameter",value:function(e){e.setStore(this.store),e.setMixSession(this.mixSession),e.setContext(this.context),this.parameters.push(e)}},{key:"copyFrom",value:function(e){this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.baseFrequency=e.baseFrequency,this.octaves=e.octaves}},{key:"getJson",value:function(){return{baseFrequency:this.baseFrequency,octaves:this.octaves,attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release}}},{key:"fromJson",value:function(e){"baseFrequency"in e&&(this.baseFrequency=e.baseFrequency),"octaves"in e&&(this.octaves=e.octaves),"attack"in e&&(this.attack=e.attack),"decay"in e&&(this.decay=e.decay),"sustain"in e&&(this.sustain=e.sustain),"releease"in e&&(this.release=e.release)}}]),e}(),Ze=n(375);function $e(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var et=function(e){Object(u.a)(n,e);var t=$e(n);function n(e,r,a){var i;return Object(o.a)(this,n),(i=t.call(this)).sequencerEngine=e,i.store=e.store,i.mixSession=r,i.context=a,i.synth=new H.a.PolySynth(1,H.a.MonoSynth),i.synth.volume.value=-4,i.lfos=[i.createLFO(),i.createLFO(),i.createLFO(),i.createLFO()],i.filterEnvelope=new Ye(i.synth,i.store,r,a),i.polyphonySet=!1,i.parameters=[],i.parameterToSignal={},i.parameterToLFOs={},i.setupParameters(),i.lfos.forEach(function(e){return e.start()}),i.refreshParameters(),i.node=void 0,i}return Object(s.a)(n,[{key:"getName",value:function(){return"Synth"}},{key:"isMonophonic",value:function(){return 1===this.polyphony}},{key:"getInstrument",value:function(){return this}},{key:"getInstrumentType",value:function(){return z.i}},{key:"hasLFO",value:function(){return!0}},{key:"start",value:function(){this.lfos.forEach(function(e){return e.start()})}},{key:"stop",value:function(){this.lfos.forEach(function(e){return e.stop()})}},{key:"oscillatorType",get:function(){return this.oscillatorTypeParameter.get()},set:function(e){var t=this.oscillatorTypeParameter.get();this.oscillatorTypeParameter.set(e),"pulse"===e&&t!==e&&this.onChangeToPulse()}},{key:"oscillatorFrequency",get:function(){return this.oscillatorFrequencyParameter.get()},set:function(e){this.oscillatorFrequencyParameter.set(e)}},{key:"filterCutoff",get:function(){return this.filterCutoffParameter.get()},set:function(e){this.filterCutoffParameter.set(e)}},{key:"filterQ",get:function(){return this.filterQParameter.get()},set:function(e){this.filterQParameter.set(e)}},{key:"portamento",get:function(){return this.portamentoParameter.get()},set:function(e){this.portamentoParameter.set(e)}},{key:"polyphony",get:function(){return void 0===this.polyphonyParameter?8:this.polyphonyParameter.get()},set:function(e){this.polyphonyParameter.set(e)}},{key:"detune",get:function(){return this.detuneParameter.get()},set:function(e){this.detuneParameter.set(e)}},{key:"pulseWidth",get:function(){return this.pulseWidthParameter.get()},set:function(e){this.pulseWidthParameter.set(e)}},{key:"ampAttack",get:function(){return this.ampAttackParameter.get()},set:function(e){return this.ampAttackParameter.set(e)}},{key:"ampDecay",get:function(){return this.ampDecayParameter.get()},set:function(e){return this.ampDecayParameter.set(e)}},{key:"ampSustain",get:function(){return this.ampSustainParameter.get()},set:function(e){return this.ampSustainParameter.set(e)}},{key:"ampRelease",get:function(){return this.ampReleaseParameter.get()},set:function(e){return this.ampReleaseParameter.set(e)}},{key:"refreshParameters",value:function(){this.pulseWidth=this.pulseWidth,this.oscillatorType=this.oscillatorType,this.filterQ=this.filterQ,this.portamento=this.portamento,this.filterCutoff=this.filterCutoff}},{key:"createNewSynth",value:function(e){var t=this.node;this.disconnect(t),this.synth=new H.a.PolySynth(e,H.a.MonoSynth),this.filterEnvelope.onNewSynth(this.synth),this.connect(t),this.polyphonySet=!1,this.refreshParameters(),this.reconnectAllLFOParameters()}},{key:"triggerAttack",value:function(e,t,n){var r=this.getNoteFromTranspose(e);this.synth.triggerAttack(r,t,n)}},{key:"triggerAttackRelease",value:function(e,t,n,r){var a=this.getNoteFromTranspose(e);this.synth.triggerAttackRelease(a,t,n,r)}},{key:"triggerRelease",value:function(e){var t=this,n=e.map(function(e){return t.getNoteFromTranspose(e)});this.synth.triggerRelease(n)}},{key:"createLFO",value:function(){return new Ze.a(this.sequencerEngine,this.mixSession,this.context)}},{key:"setupParameters",value:function(e){var t=this;this.oscillatorTypeParameter=new $.a("Oscillator Type",this,function(e,t){return e.synth.set({oscillator:{type:t}})},{min:0,max:1,unit:"",defaultValue:"triangle",automatable:!1}),this.registerParameter(this.oscillatorTypeParameter),this.oscillatorFrequencyParameter=new $.a("Oscillator Frequency",this,function(e,t){return[]},{min:0,max:1,unit:"",defaultValue:0,automatable:!1}),this.registerParameter(this.oscillatorFrequencyParameter),this.pulseWidthParameter=new $.a("Pulse Width",this,function(e,t){return e.synth.set({oscillator:{width:t}})},{min:0,max:1,unit:"",defaultValue:.1}),this.registerParameter(this.pulseWidthParameter,function(e){return e.oscillator.width}),this.filterCutoffParameter=new $.b("Filter Cutoff",this,function(e,t){e.synth.set({filter:{frequency:t}})},{min:0,max:1e4,unit:"HZ",defaultValue:1200}),this.registerParameter(this.filterCutoffParameter,function(e){return e.filter.frequency}),this.filterQParameter=new $.b("Filter Q",this,function(e,t){return e.synth.set({filter:{Q:t}})},{min:0,max:9,unit:"",defaultValue:1}),this.registerParameter(this.filterQParameter,function(e){return e.filter.Q}),this.portamentoParameter=new $.a("Portamento",this,function(e,t){return e.synth.set({portamento:t/20})},{min:0,max:10,unit:"",defaultValue:0}),this.registerParameter(this.portamentoParameter),this.detuneParameter=new $.b("Detune",this,function(e,t){e.synth.set({detune:t})},{min:-100,max:100,unit:"",defaultValue:0,automatable:!1}),this.parameterToSignal[this.detuneParameter.name]=function(e){return e.oscillator.detune},this.registerParameter(this.detuneParameter),this.polyphonyParameter=new $.b("Polyphony",this,function(e,n){t.polyphonySet&&t.createNewSynth(n),t.polyphonySet=!0},{min:0,max:16,unit:"",defaultValue:1,automatable:!1}),this.registerParameter(this.polyphonyParameter),this.ampAttackParameter=new $.a("Amp Attack",this,function(e,t){return t},{min:0,max:1e4,unit:"",defaultValue:10}),this.registerParameter(this.ampAttackParameter),this.ampDecayParameter=new $.a("Amp Decay",this,function(e,t){return t},{min:0,max:1e4,unit:"",defaultValue:10}),this.registerParameter(this.ampDecayParameter),this.ampSustainParameter=new $.a("Amp Sustain",this,function(e,t){return t},{min:0,max:1,unit:"",defaultValue:1}),this.registerParameter(this.ampSustainParameter),this.ampReleaseParameter=new $.a("Amp Release",this,function(e,t){return t},{min:0,max:1e4,unit:"",defaultValue:10}),this.registerParameter(this.ampReleaseParameter)}},{key:"registerParameter",value:function(e,t){void 0!==t&&(this.parameterToSignal[e.name]=t),e.setStore(this.store),e.setMixSession(this.mixSession),e.setContext(this.context),e.setTrack(this.context.track),this.parameters.push(e)}},{key:"getCopy",value:function(e){var t=this,r=new n(this.store,this.mixSession,e);for(var a in r.instrumentType=this.instrumentType,r.oscillatorFrequency=this.oscillatorFrequency,r.filterCutoff=this.filterCutoff,r.filterQ=this.filterQ,r.polyphony=this.polyphony,r.portamento=this.portamento,r.filterEnvelope.copyFrom(this.filterEnvelope),r.oscillatorType=this.oscillatorType,r.pulseWidth=this.pulseWidth,r.lfos)r.lfos[a].copyFrom(this.lfos[a]);r.parameterToLFOs={};var i=function(e){var n=t.parameterToLFOs[e],a=r.getParameterByName(e);n.forEach(function(e){var n=r.lfos[t.lfos.indexOf(e)];r.connectLFOToParameter(n,a)})};for(var o in this.parameterToLFOs)i(o);return r}},{key:"getParameters",value:function(){return[].concat(Object(h.a)(this.parameters),Object(h.a)(this.filterEnvelope.parameters))}},{key:"getJson",value:function(){var e={instrumentType:this.getInstrumentType(),oscillatorType:this.oscillatorType,oscillatorFrequency:this.oscillatorFrequency,filterCutoff:this.filterCutoff,filterQ:this.filterQ,polyphony:this.polyphony,portamento:this.portamento,pulseWidth:this.pulseWidth,lfos:this.lfos.map(function(e){return e.getJson()}),parameterToLFOs:this.getParameterToLFOsJson(),filterEnvelope:this.filterEnvelope.getJson(),ampAttack:this.ampAttack,ampDecay:this.ampDecay,ampSustain:this.ampSustain,ampRelease:this.ampRelease};return e=Object(Q.b)(e,"filterCutoffParameter",this.filterCutoffParameter),e=Object(Q.b)(e,"filterQParameter",this.filterQParameter),e=Object(Q.b)(e,"portamentoParameter",this.portamentoParameter),e=Object(Q.b)(e,"pulseWidthParameter",this.pulseWidthParameter),e=Object(Q.b)(e,"oscillatorFrequencyParameter",this.oscillatorFrequencyParameter),e=Object(Q.b)(e,"oscillatorTypeParameter",this.oscillatorTypeParameter),e=Object(Q.b)(e,"ampAttackParameter",this.ampAttackParameter),e=Object(Q.b)(e,"ampDecayParameter",this.ampDecayParameter),e=Object(Q.b)(e,"ampSustainParameter",this.ampSustainParameter),e=Object(Q.b)(e,"ampReleaseParameter",this.ampReleaseParameter)}},{key:"getParameterToLFOsJson",value:function(){var e=this,t={},n=function(n){var r=[];e.parameterToLFOs[n].forEach(function(t){return r.push(e.lfos.indexOf(t))}),t[n]=r};for(var r in this.parameterToLFOs)n(r);return t}},{key:"fromJson",value:function(e){if("instrumentType"in e&&(this.instrumentType=e.instrumentType),"polyphony"in e&&(this.polyphony=e.polyphony),"oscillatorFrequency"in e&&(this.oscillatorFrequency=e.oscillatorFrequency),"pulseWidth"in e&&(this.pulseWidth=e.pulseWidth),"oscillatorType"in e&&(this.oscillatorType=e.oscillatorType),"filterCutoff"in e&&(this.filterCutoff=e.filterCutoff),"filterQ"in e&&(this.filterQ=e.filterQ),"portamento"in e&&(this.portamento=e.portamento),"filterEnvelope"in e&&this.filterEnvelope.fromJson(e.filterEnvelope),"lfos"in e)for(var t in e.lfos)this.lfos[t].fromJson(e.lfos[t]);"parameterToLFOs"in e&&this.loadParameterToLFOsJson(e.parameterToLFOs),"ampAttack"in e&&(this.ampAttack=e.ampAttack),"ampDecay"in e&&(this.ampDecay=e.ampDecay),"ampSustain"in e&&(this.ampSustain=e.ampSustain),"ampRelease"in e&&(this.ampRelease=e.ampRelease),Object(Q.a)(e,"filterCutoffParameter",this.filterCutoffParameter,this.sequencerEngine),Object(Q.a)(e,"filterQParameter",this.filterQParameter,this.sequencerEngine),Object(Q.a)(e,"portamentoParameter",this.portamentoParameter,this.sequencerEngine),Object(Q.a)(e,"pulseWidthParameter",this.pulseWidthParameter,this.sequencerEngine),Object(Q.a)(e,"oscillatorFrequencyParameter",this.oscillatorFrequencyParameter,this.sequencerEngine),Object(Q.a)(e,"oscillatorTypeParameter",this.oscillatorTypeParameter,this.sequencerEngine),Object(Q.a)(e,"ampAttackParameter",this.ampAttackParameter,this.sequencerEngine),Object(Q.a)(e,"ampDecayParameter",this.ampDecayParameter,this.sequencerEngine),Object(Q.a)(e,"ampSustainParameter",this.ampSustainParameter,this.sequencerEngine),Object(Q.a)(e,"ampReleaseParameter",this.ampReleaseParameter,this.sequencerEngine)}},{key:"getParameterByName",value:function(e){var t=this.parameters.filter(function(t){return t.name===e});if(!(t.length<1))return t[0]}},{key:"loadParameterToLFOsJson",value:function(e){var t=this,n=function(n){var r=t.getParameterByName(n);if(void 0===r)return"continue";e[n].forEach(function(e){return t.connectLFOToParameter(t.lfos[e],r)})};for(var r in e)n(r)}},{key:"connectLFOToParameter",value:function(e,t){var n=this,r=!1;void 0!==this.parameterToSignal[t.name]&&(this.synth.voices.forEach(function(a,i){var o=n.parameterToSignal[t.name](a);void 0===o?r=!0:e.connect(o,t,i)}),r||(t.name in this.parameterToLFOs?this.parameterToLFOs[t.name].add(e):this.parameterToLFOs[t.name]=new Set([e]),this.refreshParameters()))}},{key:"disconnectLFOToParameter",value:function(e,t){var n=this;this.parameterToLFOs[t.name].has(e)&&(this.synth.voices.forEach(function(r,a){e.disconnect(n.parameterToSignal[t.name](r),t,a)}),this.parameterToLFOs[t.name].delete(e))}},{key:"isParameterConnectedToLFO",value:function(e,t){return e.name in this.parameterToLFOs&&this.parameterToLFOs[e.name].has(t)}},{key:"toggleParameterWithLFO",value:function(e,t){this.isParameterConnectedToLFO(e,t)?this.disconnectLFOToParameter(t,e):this.connectLFOToParameter(t,e)}},{key:"reconnectAllLFOParameters",value:function(){var e=this,t=function(t){var n=e.parameterToLFOs[t],r=e.getParameterByName(t);n.forEach(function(t){return e.connectLFOToParameter(t,r)})};for(var n in this.parameterToLFOs)t(n)}},{key:"onChangeToPulse",value:function(){var e=this;this.pulseWidthParameter.name in this.parameterToLFOs&&this.parameterToLFOs[this.pulseWidthParameter.name].forEach(function(t){return e.connectLFOToParameter(t,e.pulseWidthParameter,!0)})}},{key:"connect",value:function(e){void 0!==e&&(this.synth.connect(e),this.node=e)}},{key:"disconnect",value:function(e){this.synth.disconnect(e),this.node=void 0}},{key:"getEnvelopes",value:function(){return this.synth.voices.map(function(e){return e.envelope})}},{key:"releaseAll",value:function(){this.synth.voices.forEach(function(e){return e.triggerRelease()})}},{key:"getNoteFromTranspose",value:function(e){return e+=this.sequencerEngine.transpose,this.getDefaultNote().transpose(e+this.oscillatorFrequency)}},{key:"setEnvelopes",value:function(e){var t=this,n=this.getEnvelopes();n.forEach(function(e){return e.attack=new H.a.Time((1+t.ampAttack)/1e3)}),n.forEach(function(e){return e.release=new H.a.Time((1+t.ampRelease)/1e3)}),n.forEach(function(e){return e.sustain=Math.min(.99,t.ampSustain)}),n.forEach(function(e){return e.decay=new H.a.Time((1+t.ampDecay)/1e3)})}}]),n}(G);function tt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var nt=function(e){Object(u.a)(n,e);var t=tt(n);function n(e,r,a,i,s,u){var l,f=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return Object(o.a)(this,n),(l=t.call(this,e,r,a,i,s,u)).setupEffects(),l.instrument=void 0,f&&l.setInstrument(new et(r,a,(new L.a).forTrack(Object(c.a)(l)))),l.preset=new Qe.a,l.preset.track=Object(c.a)(l),l}return Object(s.a)(n,[{key:"auditionNext",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var r,i,o,s=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]&&s[1],!this.isFrozen&&!r){e.next=3;break}return e.abrupt("return");case 3:if(this.getInstrumentType()!==z.g||this.preset&&this.preset.contentHash){e.next=7;break}return e.next=6,Object(Z.a)(Object(f.a)(n.prototype),"auditionNext",this).call(this);case 6:case 7:return e.abrupt("return");case 11:if(this.instrument.loaded){e.next=13;break}return e.abrupt("return");case 13:if(this.instrument.loaded=!1,this.trackIsLoading=!0,i=0,!this.preset||!this.preset.contentHash){e.next=21;break}if(i=(void 0).map(function(e){return e.contentHash}).indexOf(this.preset.contentHash),!(++i>=(void 0).length)){e.next=21;break}return e.abrupt("return");case 21:return o=(void 0)[i],e.next=24,this.sequencerEngine.auditionPreset(o,this.trackNumber,!0,!0);case 24:this.trackIsLoading=!1;case 25:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"auditionPrevious",value:function(){var e=Object(i.a)(a.a.mark(function e(t,r){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFrozen&&!r){e.next=2;break}return e.abrupt("return");case 2:if(this.getInstrumentType()!==z.g||this.preset&&this.preset.contentHash){e.next=6;break}return e.next=5,Object(Z.a)(Object(f.a)(n.prototype),"auditionPrevious",this).call(this);case 5:case 6:return e.abrupt("return");case 10:if(this.instrument.loaded){e.next=12;break}return e.abrupt("return");case 12:if(this.trackIsLoading=!0,i=0,!this.preset||!this.preset.contentHash){e.next=19;break}if(i=(void 0).map(function(e){return e.contentHash}).indexOf(this.preset.contentHash),!(--i<0)){e.next=19;break}return e.abrupt("return");case 19:return o=(void 0)[i],this.mute(!0),e.next=23,this.sequencerEngine.auditionPreset(o,this.trackNumber,!0,!0);case 23:this.mute(!1),this.trackIsLoading=!1;case 25:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setIsEnabled",value:function(e){Object(Z.a)(Object(f.a)(n.prototype),"setIsEnabled",this).call(this,e),e||this.isFrozen||this.sequencerEngine.playing||this.getInstrument().releaseAll()}},{key:"makePublicIfNeeded",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.isFrozen;this.midiEffects.dispose(),!t&&this.instrument&&(this.instrument.dispose(),this.instrument=void 0),Object(Z.a)(Object(f.a)(n.prototype),"dispose",this).call(this,!t)}},{key:"getAllParameters",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=Object(Z.a)(Object(f.a)(n.prototype),"getAllParameters",this).call(this,e);if(this.isFrozen||void 0===this.instrument)return t;var r=this.getInstrument().getParameters();return[].concat(Object(h.a)(t),Object(h.a)(r))}},{key:"getAllPatternLockedParameters",value:function(e,t){var r=Object(Z.a)(Object(f.a)(n.prototype),"getAllPatternLockedParameters",this).call(this,e,t);if(this.isFrozen)return r;var a=this.getInstrument().getParameters();return a=a.filter(function(n){return n.hasPatternLockedValues(e,t)}),r.concat(a)}},{key:"getCopy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sequencerEngine,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e(this.trackNumber,t,this.mixSession,this.patterns.length,this.update,t.currentSubSequence);if(!this.isFrozen){var i=this.instrument.getCopy((new L.a).forTrack(a),a,t,r);a.setInstrument(i)}return Object(Z.a)(Object(f.a)(n.prototype),"getCopy",this).call(this,function(){return a},t,r),a}},{key:"getName",value:function(){return void 0===this.instrument?"Instrument":this.instrument.getName()}},{key:"getTrackType",value:function(){return A.b}},{key:"getInstrument",value:function(){return this.instrument}},{key:"setInstrument",value:function(e){void 0!==this.instrument&&this.instrument.disconnect(this.gainNode),this.instrument=e,void 0!==this.instrument&&this.instrument.connect(this.gainNode)}},{key:"liveTrigger",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.isFrozen||(this.storeStepData(e,n),this.trigger(e,n,!0))}},{key:"liveTriggerRelease",value:function(e){this.isFrozen||(this.triggerRelease(e),this.currentStepDatas&&(this.currentStepDatas=this.currentStepDatas.filter(function(t){return t.transpose!==e})))}},{key:"trigger",value:function(e,t,r){this.isFrozen?Object(Z.a)(Object(f.a)(n.prototype),"trigger",this).call(this,e,t,r):void 0!==this.instrument&&(this.storeStepData(e,t),this.instrument.trigger(e,t))}},{key:"triggerRelease",value:function(e){this.isFrozen||void 0!==this.instrument&&this.instrument.release(e)}},{key:"getJson",value:function(e,t){var r=this.instrumentRack?this.instrumentRack.isFrozen:this.isFrozen;return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this,e),{instrumentType:this.instrument?this.instrument.getInstrumentType():this.getInstrumentType(),instrument:r?void 0:this.instrument.getJson(t),presetName:this.presetName,preset:this.preset.getJson()})}},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var r,i,o,s,c,u,l=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(l.length>1&&void 0!==l[1])||l[1],i=!(l.length>2&&void 0!==l[2])||l[2],o=l.length>3&&void 0!==l[3]&&l[3],s=l.length>4?l[4]:void 0,Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,t,s),this.parametersToScale=void 0,r&&this.store.dispatch(Object(C.Xg)(this.subSequence.id,this.trackNumber,!0)),t.envelopes)for(c in t.envelopes)this.connectToEnvelope(this.sequencerEngine.envelopes[t.envelopes[c]]);if(u={},!t.isFrozen){e.next=13;break}e.next=17;break;case 13:return this.instrument||this.createNewInstrument(),e.next=16,this.instrument.fromJson(t.instrument,o,s);case 16:u=e.sent;case 17:if(void 0!==t.presetName&&(this.presetName=t.presetName),!t.preset){e.next=24;break}if(!i){e.next=24;break}return this.preset.fromJson(t.preset),e.next=23,this.preset.load();case 23:this.preset.name&&(this.presetName=this.preset.name);case 24:return r&&this.store.dispatch(Object(C.Xg)(this.subSequence.id,this.trackNumber,!1)),e.abrupt("return",u);case 26:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unfreezeInstrument",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.frozenJson,this.createNewInstrument(),e.next=4,this.instrument.fromJson(t.trackParameters.instrument);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createNewInstrument",value:function(){}},{key:"isMonohonic",value:function(){return this.tracks.every(function(e){return e.track.isMonophonic()})}}]),n}(Ke);function rt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var at=function(e){Object(u.a)(n,e);var t=rt(n);function n(e,r,a,i,s,u){var l;return Object(o.a)(this,n),(l=t.call(this,e,r,a,i,s,u,!1)).setInstrument(new he(r,a,(new L.a).forTrack(Object(c.a)(l)))),l}return n}(nt);function it(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ot=function(e){Object(u.a)(n,e);var t=it(n);function n(e,r,a){var i;!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Object(o.a)(this,n),(i=t.call(this)).sequencerEngine=e,i.store=e.store,i.mixSession=r,i.context=a.getCopy().forInstrument(Object(c.a)(i)),i.parameters=[],i}return Object(s.a)(n,[{key:"getName",value:function(){return"Synth"}},{key:"name",get:function(){return this.getName()}},{key:"getInstrument",value:function(){return this}},{key:"getInstrumentType",value:function(){return z.f}},{key:"createLFO",value:function(){return new Ze.a(this.sequencerEngine,this.mixSession,this.context)}},{key:"getCopy",value:function(e){var t=new n(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sequencerEngine,this.mixSession,e);return t.fromJsonSync(this.getJson()),t}},{key:"mateJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;for(var n in e.oscillators){this.getOscillator(n).mateJson(e.oscillators[n])}this.ampEnvelope.mateJson(e.ampEnvelope,t),this.filterEnvelope.mateJson(e.filterEnvelope,t),this.pitchEnvelope.mateJson(e.pitchEnvelope,t),this.mateParameter("filterCutoff",e,this.filterCutoffParameter,t),this.mateParameter("filterQ",e,this.filterQParameter,t),this.mateParameter("noiseVolume",e,this.noiseVolumeParameter,t)}},{key:"mateParameter",value:function(e,t,n,r){Object(W.b)(this.sequencerEngine,e,t,n,r)}},{key:"dispose",value:function(){this.detuneSignal.dispose(),this.detuneParameter.dispose();var e=Object(h.a)(this.oscillatorNodes);e.reverse(),e.forEach(function(e){return e.dispose()}),this.filter.dispose(),this.hpFilter.dispose(),this.pitchEnvelope.dispose(),this.filterEnvelope.dispose(),this.hpFilterEnvelope.dispose(),this.ampEnvelope.dispose(),this.oscillatorNodes=void 0,this.filter=void 0,this.hpFilter=void 0,this.pitchEnvelope=void 0,this.filterEnvelope=void 0,this.ampEnvelope=void 0,this.parameters.forEach(function(e){return e.dispose()}),this.parameters=void 0,this._disposed=!0}},{key:"disposed",get:function(){return this._disposed}}]),n}(G);function st(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ct=n(311),ut=n(532);function lt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ft=new(function(){function e(){Object(o.a)(this,e),this.voices=[]}return Object(s.a)(e,[{key:"newVoice",value:function(e,t,n){if(!H.a.Master.context.isOffline&&this.voices.length>0){var r=this.voices.find(function(e){return e.name===t});if(r){var a=this.voices.indexOf(r);return this.voices.splice(a,1),e&&(e.includes("fat")&&(r.oscillator.type="sine"),r.oscillator.type=e),r}}if(e){var i=new H.a.MonoSynth({oscillator:{type:e}});return e.includes("fat")&&(i.type="sine",i.type=e),i.id=0,i}var o=new H.a.MonoSynth;return o.id=0,o}},{key:"releaseVoice",value:function(e,t,n){e.disconnectFM(),e.disconnect(),n.isOffline||this.voices.push(e)}}]),e}());function ht(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var mt=function(e){return function(e){Object(u.a)(n,e);var t=dt(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"scaleByKey",value:function(e,t,n){if(!this.track.parametersToScale){var r=this.track?this.track.getAllParameters():this.getParameters();this.track.parametersToScale=r.filter(function(e){return e.keyScaling})}var a,i=(t- -32)/92,o=H.a.Master.context.isOffline,s=ht(this.track.parametersToScale);try{for(s.s();!(a=s.n()).done;){var c=a.value,u=c.keyScaling;if(u&&c.get(!0)!==c.min){var l=c.get(!0)+u.min+(u.max-u.min)*i;if(c._audioParams){var f=c._audioParams.length;o?c._audioParams[n%f].value=l:c._audioParams[n%f].linearRampToValueAtTime(l,e+.01)}else c.audioParam&&c.audioParam.linearRampToValueAtTime?o?c.audioParam.value=l:c.audioParam.linearRampToValueAtTime(l,e+.01):c.audioParams&&c.audioParams[n]?o?c.audioParams[n].value=l:c.audioParams[n].linearRampToValueAtTime(l,e+.01):c.setter(c.object,l)}}}catch(h){s.e(h)}finally{s.f()}}}]),n}(e)};function vt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function bt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var kt="C",Ot="A",jt="B1",wt="B2",Et="X",St="Y";function Pt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var xt=function(e){Object(u.a)(n,e);var t=Pt(n);function n(e,r,a,i){var s;return Object(o.a)(this,n),s=t.call(this,e,r,a,void 0,void 0,void 0,new H.a.AmplitudeEnvelope(10,10,1,100)),i&&i.connect(s.envelope),s.envelope.releaseCurve="linear",s.envelope.attackCurve="linear",s.envelope.decayCurve="linear",s}return Object(s.a)(n,[{key:"dispose",value:function(){Object(Z.a)(Object(f.a)(n.prototype),"dispose",this).call(this)}},{key:"connect",value:function(e){this.envelope.connect(e)}}]),n}(le),Tt=function(){function e(t,n,r,a,i){Object(o.a)(this,e),this.sequencerEngine=t,this.id=Object(j.uuid)(),this.instrument=i,this.store=this.sequencerEngine.store,this.mixSession=n,this.context=r.getCopy().forSubDevice(this),this.ampEnvelopes=a,this.parameters=[],this.setupParameters()}return Object(s.a)(e,[{key:"registerParameter",value:function(e){e.setStore(this.store),e.setMixSession(this.mixSession),e.setContext(this.context),e.setTrack(this.context.track),this.parameters.push(e)}},{key:"refresh",value:function(){this.attack=this.attack,this.decay=this.decay,this.sustain=this.sustain,this.release=this.release}},{key:"attack",get:function(){return this.attackParameter.get()},set:function(e){this.attackParameter.set(e,!0,!0)}},{key:"decay",get:function(){return this.decayParameter.get()},set:function(e){this.decayParameter.set(e,!0,!0)}},{key:"sustain",get:function(){return this.sustainParameter.get()},set:function(e){this.sustainParameter.set(e,!0,!0)}},{key:"release",get:function(){return this.releaseParameter.get()},set:function(e){this.releaseParameter.set(e,!0,!0)}},{key:"setupParameters",value:function(){var e=this;this.attackParameter=new $.a("Attack",this.envelope,function(t,n){return e.ampEnvelopes.forEach(function(e){return e.attack=n})},{min:0,max:1e4,unit:"ms",defaultValue:80,onChange:function(t){e.instrument.controller&&e.instrument.controller.sendADSRLevels()}}),this.registerParameter(this.attackParameter),this.decayParameter=new $.a("Decay",this.envelope,function(t,n){return e.ampEnvelopes.forEach(function(e){return e.decay=n})},{min:0,max:3e3,unit:"ms",defaultValue:500,onChange:function(t){e.instrument.controller&&e.instrument.controller.sendADSRLevels()}}),this.registerParameter(this.decayParameter),this.sustainParameter=new $.a("Sustain",this.envelope,function(t,n){return e.ampEnvelopes.forEach(function(e){return e.sustain=n})},{min:0,max:1,unit:"",defaultValue:.8,onChange:function(t){e.instrument.controller&&e.instrument.controller.sendADSRLevels()}}),this.registerParameter(this.sustainParameter),this.releaseParameter=new $.a("Release",this.envelope,function(t,n){return e.ampEnvelopes.forEach(function(e){return e.release=n})},{min:0,max:3e3,unit:"ms",defaultValue:100,onChange:function(t){e.instrument.controller&&e.instrument.controller.sendADSRLevels()}}),this.registerParameter(this.releaseParameter)}},{key:"getJson",value:function(){var e={attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release,x:this.x,y:this.y,width:this.width,height:this.height};return e=Object(Q.b)(e,"attackParameter",this.attackParameter),e=Object(Q.b)(e,"decayParameter",this.decayParameter),e=Object(Q.b)(e,"sustainParameter",this.sustainParameter),e=Object(Q.b)(e,"releaseParameter",this.releaseParameter)}},{key:"fromJson",value:function(e){var t={};return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,Object(ne.a)(this.attackParameter,e.attack,t),Object(ne.a)(this.decayParameter,e.decay,t),Object(ne.a)(this.sustainParameter,e.sustain,t),Object(ne.a)(this.releaseParameter,e.release,t),t=Object(p.a)({},t,Object(Q.a)(e,"attackParameter",this.attackParameter,this.sequencerEngine,!1,!0),Object(Q.a)(e,"decayParameter",this.decayParameter,this.sequencerEngine,!1,!0),Object(Q.a)(e,"sustainParameter",this.sustainParameter,this.sequencerEngine,!1,!0),Object(Q.a)(e,"releaseParameter",this.releaseParameter,this.sequencerEngine,!1,!0))}},{key:"dispose",value:function(){}}]),e}(),Ct=n(315),Nt=n(321),Rt=function(){function e(t,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;Object(o.a)(this,e),this.name=i,this.sequencerEngine=n,this.store=n.store,this.operator=t,this.outputNumber=a,this.effect=t,this.modulatorNodes=[];for(var s=0;s<t.voices.length;s++)this.modulatorNodes.push(new H.a.Gain(0));this.loadSynth(t),this.parameters=[],this.gainParameter=new Y.a("Gain",this,function(e,t){return r.modulatorNodes.forEach(function(e){return e.gain.value=t})},{min:0,max:6,defaultValue:0}),this.registerParameter(this.gainParameter),this.gainParameter.setAudioParams(this.modulatorNodes.map(function(e){return e.gain}))}return Object(s.a)(e,[{key:"loadSynth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.operator;if(t.synth)for(var n in this.operator.voices){var r=t.voices[n];e&&this.modulatorNodes[n].disconnect(),this.modulatorNodes[n].connect(r.oscillator.frequency)}else;}},{key:"registerParameter",value:function(e){void 0!==e&&(e.name=e.name,e.effectName=this.name,e.setStore(this.store),this.parameters.push(e))}},{key:"getWeight",value:function(){return 1}},{key:"getJson",value:function(){return{}}},{key:"fromJson",value:function(){}},{key:"getCopy",value:function(){var t=new e(this.operator,this.sequencerEngine,this.outputNumber);return t.gainParameter.set(t.gainParameter.get()),t}},{key:"dispose",value:function(){this.gainParameter.dispose(),this.modulatorNodes.forEach(function(e){return e.dispose()}),this.gainParameter=void 0,this.modulatorNodes=void 0}}]),e}(),Mt=n(313);function At(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function qt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function It(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function _t(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ft(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ft(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Bt=function(){function e(t,n,r,a){Object(o.a)(this,e),this.oscillator=t,this.sequencerEngine=n,this.mixSession=r,this.context=a,this.ampEnvelopes=[new xt(n,r,a)],this.connected=!1}return Object(s.a)(e,[{key:"dispose",value:function(){this.ampEnvelopes.forEach(function(e){return e.dispose()}),this.ampEnvelopes=void 0}},{key:"newVoice",value:function(){this.ampEnvelopes.push(new xt(this.sequencerEngine,this.mixSession,this.context))}},{key:"removeVoice",value:function(){this.ampEnvelopes[this.ampEnvelopes.length-1].dispose(),this.ampEnvelopes.splice(this.ampEnvelopes.length-1,1)}}]),e}(),zt=function(){function e(t,n,r,a,i,s,c){Object(o.a)(this,e),this.sequencerEngine=i,this.mixSession=s,this.context=c,this.id=n,this.name=t,this.synth=r,this.crossFadeIndex=a,this.outputs={},this.voices=[]}return Object(s.a)(e,[{key:"dispose",value:function(){for(var e in this.outputs)this.outputs[e].dispose();this.outputs={}}},{key:"newVoice",value:function(){for(var e in this.outputs)this.outputs[e].newVoice()}},{key:"removeVoice",value:function(){for(var e in this.outputs)this.outputs[e].removeVoice()}},{key:"stealOrMake",value:function(e){if(this.outputs[e.name])return this.outputs[e.name];for(var t in this.outputs)if(!this.outputs[t].connected){var n=this.outputs[t];return delete this.outputs[t],n}return new Bt(e,this.sequencerEngine,this.mixSession,this.context)}},{key:"noiseSources",get:function(){return this.synth.noiseSources}},{key:"connect",value:function(e){var t=this,n=this.stealOrMake(e);for(var r in this.outputs[e.name]=n,e.voices){var a=e.voices[r];n.ampEnvelopes[r]||n.newVoice();var i=n.ampEnvelopes[r].envelope;a.connect(i)}if("C"===e.name)for(var o in this.noiseSources){var s=e.voices[o];this.noiseSources[o].connect(s._volume)}return n.connected=!0,n.ampEnvelopes.forEach(function(t){return t.envelope.connect(e.formantsManager.input)}),e.formantsManager.output.connect(this.synth.outputCrossFade,0,this.crossFadeIndex),function(){if(n.connected=!1,n.ampEnvelopes.forEach(function(t){return t.envelope.disconnect(e.formantsManager.input)}),e.voices.forEach(function(e,t){e.disconnect(n.ampEnvelopes[t].envelope)}),"C"===e.name)for(var r in t.noiseSources){var a=e.voices[r];t.noiseSources[r].disconnect(a._volume)}e.formantsManager.output.disconnect(t.synth.outputCrossFade,0,t.crossFadeIndex),n.disconnect=void 0}}}]),e}();function Vt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ht(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ut(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Jt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Gt=n(248);function Wt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Kt=new H.a.Frequency("C3"),Xt=n(882);function Qt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function $t(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var en={0:"sine",.2:"triangle",.4:"square",.6:"sawtooth",.8:"pulse",1:"fatsine",1.2:"fattriangle",1.4:"fatsquare",1.8:"fatsawtooth"};window.lpf=1e3,window.len=Math.pow(2,10),window.start=88200;function tn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function nn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function rn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var an=function(e,t,n){return!t||n?e:e+1};function on(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function sn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return cn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cn(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function un(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}window.envelopeTest=!1,window.p1=.05,window.p2=.008,window.fuck=2;var ln=function(e){Object(u.a)(n,e);var t=un(n);function n(e,r,a,i){var s,c=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],u=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,f=arguments.length>7?arguments[7]:void 0;return Object(o.a)(this,n),(s=t.call(this,e,r,a,function(e){return 0},i,c,l)).name=u,s.track=l,s.instrument=f,s.create(),s.setupEnvelopes(),s.setupFormants(),s.preset=new Qe.a,s}return Object(s.a)(n,[{key:"initializeNewVoice",value:function(e){return e?new H.a.MonoSynth({oscillator:{type:e}}):new H.a.MonoSynth}},{key:"documentation",get:function(){var e=this.name;return"You can connect LFOs to Operator ".concat(e," by dragging a line from an LFO to the circles above the node")}},{key:"getEffectType",value:function(){return re.d}},{key:"disposeSynth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.synth;e._voices[0].context.isOffline;this.destroyFormants(e,!0),e.formantsManager.dispose();var t,n=sn(e.voices);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.disconnectFM(),r.disconnect()}}catch(a){n.e(a)}finally{n.f()}e._voices.forEach(function(e){return e.dispose()}),e._voices=void 0}}]),n}(Object(Ve.a)(function(e){return function(e){Object(u.a)(n,e);var t=on(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a)))._voices=[],e}return Object(s.a)(n,[{key:"releaseVoice",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];ft.releaseVoice(e,t,this.sequencerEngine)}},{key:"onPolyphonyChanged",value:function(e){var t=this;if(e>this._voices.length){for(var n=this._voices.length;n<e;n++){var r=this.newVoice();this.fm(this.carrier,!0,r,n),this._voices.push(r)}this.customOscillatorType&&this.customOscillatorTypeParameter.updateRedux(),this.setAudioParamsForParameters()}else e<this._voices.length&&(this._voices.slice(e).forEach(function(e){return t.releaseVoice(e)}),this._voices=this._voices.slice(0,e));this.oscillatorTypeParameter&&"pulse"===this.oscillatorTypeParameter.get()&&this.pulseWidthParameter.setAudioParams(this.voices.map(function(e){return e.oscillator.width}))}},{key:"initVoices",value:function(){this._voices=[this.newVoice()]}},{key:"voices",get:function(){return this._voices?this.polyphonyParameter?this._voices.slice(0,this.polyphonyParameter.get()):this._voices:[]}},{key:"synth",get:function(){return this}},{key:"newVoice",value:function(){var e=this;if(this.oscillatorTypeParameter&&this.oscillatorType){var t=ft.newVoice(this.oscillatorType,this.name);return this.oscillatorType.includes("fat")&&(this._voices.forEach(function(e){return e.oscillator.type="sine"}),this._voices.forEach(function(t){t.oscillator.type=e.oscillatorType,t.oscillator.count=e.countParameter.get(),t.oscillator.spread=e.spreadParameter.get()})),t}return ft.newVoice(void 0,this.name)}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Zt(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).parameters=[],e}return Object(s.a)(n,[{key:"isEnabled",value:function(){return this.enabled}},{key:"setupParameters",value:function(){var e=this;this.enabledParameter=new $.a("Enabled",this,function(e,t){},{documentation:["Turns the operator on/off.","If you`re running low on CPU, try turning off some operators."],min:!1,max:!0,unit:"",defaultValue:!0,automatable:!1}),this.registerParameter(this.enabledParameter),this.name,this.voices.map(function(e){return e.volume.value=0}),this.oscillatorLevelParameter=new te.a("Oscillator Level",this.voices.map(function(e){return e.volume}),{documentation:"Controls the volume for this operator",min:0,max:1,defaultValue:.3,onChange:function(t){e.instrument.controller&&e.instrument.controller.sendOscillatorLevels()}}),this.registerParameter(this.oscillatorLevelParameter),this.pwmParameter=new $.a("PWM",this,function(t,n){return e.voices.forEach(function(e){return 0})},{min:0,max:20,unit:"",defaultValue:0,automatable:!1}),this.registerParameter(this.pwmParameter),this.countParameter=new $.a("count",this,function(t,n){return e.voices.forEach(function(e){return e.oscillator.count=n})},{min:0,max:20,unit:"",defaultValue:3,automatable:!1}),this.registerParameter(this.countParameter),this.spreadParameter=new $.a("spread",this,function(t,n){return e.voices.forEach(function(e){return e.oscillator.spread=n})},{min:1,max:200,unit:"",defaultValue:20,automatable:!1}),this.registerParameter(this.spreadParameter),this.oscillatorFrequencyParameter=new $.a("Oscillator Frequency",this,function(e,t){return[]},{documentation:"Controls the root note for the synth.",min:0,max:1,unit:"",defaultValue:0,automatable:!1}),this.registerParameter(this.oscillatorFrequencyParameter),this.detuneParameter=new te.a("Detune",this.voices.map(function(e){return e.detune}),{documentation:"Controls the detuning for this operator",min:-100,max:100,unit:"",defaultValue:0}),this.registerParameter(this.detuneParameter),this.portamentoParameter=new $.a("Portamento",this,function(t,n){return e.voices.forEach(function(e){return e.portamento=n/20})},{documentation:"Controls the gliding between notes for this operator",min:0,max:5,unit:"",defaultValue:0}),this.registerParameter(this.portamentoParameter),this.polyphonyParameter=new $.b("Polyphony",this,function(t,n){e.onPolyphonyChanged(n)},{min:0,max:16,unit:"",defaultValue:1,automatable:!1}),this.registerParameter(this.polyphonyParameter)}},{key:"enabled",get:function(){return this.enabledParameter.get(!0)},set:function(e){this.enabledParameter.set(e)}},{key:"oscillatorLevel",get:function(){return this.oscillatorLevelParameter.get(!0)},set:function(e){return this.oscillatorLevelParameter.set(e)}},{key:"oscillatorFrequency",get:function(){return this.oscillatorFrequencyParameter.get(!0)},set:function(e){this.oscillatorFrequencyParameter.set(e)}},{key:"detune",get:function(){return this.detuneParameter.get(!0)},set:function(e){this.detuneParameter.set(e)}},{key:"pulseWidth",get:function(){return this.pulseWidthParameter.get(!0)},set:function(e){this.pulseWidthParameter.set(e)}},{key:"portamento",get:function(){return this.portamentoParameter.get(!0)},set:function(e){this.portamentoParameter.set(e)}},{key:"harmonics",get:function(){return this.harmonicsParameter.get(!0)},set:function(e){this.harmonicsParameter.set(e)}},{key:"polyphony",get:function(){return void 0===this.polyphonyParameter?8:this.polyphonyParameter.get(!0)},set:function(e){this.polyphonyParameter.set(e,!0,!0)}},{key:"registerParameter",value:function(e,t){var n=e.setStore(this.store);this.bulk=Object(p.a)({},this.bulk,n),e.setMixSession(this.mixSession),e.setContext(this.context),e.setTrack(this.context.track),this.parameters.push(e)}},{key:"registerContext",value:function(e){}},{key:"getParameters",value:function(){var e,t=this.parameters,n=Qt(this.formants);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=[].concat(Object(h.a)(t),Object(h.a)(r.getParameters()))}}catch(a){n.e(a)}finally{n.f()}return[].concat(Object(h.a)(t),Object(h.a)(this.ampEnvelope.parameters))}},{key:"refreshParameters",value:function(){this.customOscillatorType||(this.oscillatorTypeParameter.set(this.oscillatorType,!0,!0),null!==this.partials&&this.partialsParameter.set(this.partials,!0,!0)),this.customOscillatorTypeParameter.set(this.customOscillatorType,!0,!0),this.portamentoParameter.set(this.portamento,!0,!0),this.harmonicsParameter.set(this.harmonics,!0,!0),this.pulseWidthParameter.set(this.pulseWidth,!0,!0)}},{key:"oscillatorOctave",get:function(){return this.oscillatorOctaveParameter.get()}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Wt(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"triggerAttack",value:function(e,t,n,r){if(this.enabled){var a=this.getNoteFromTranspose(e);this.lastNote=e,r.triggerAttack(a,t,n)}}},{key:"triggerAttackRelease",value:function(e,t,n,r,a){if(this.enabled){var i=this.getNoteFromTranspose(e);a.triggerAttackRelease(i,t,n,r)}}},{key:"triggerRelease",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:H.a.Master.context.currentTime,a=arguments.length>3?arguments[3]:void 0;if(this.enabled&&(e&&void 0===e.map&&(e=[e]),!e||1!=this.polyphony||e[0]===this.lastNote)){var i=e&&e.map(function(e){return n.getNoteFromTranspose(e)});void 0!==t?(this.pitchEnvelope.triggerRelease(t.slotNumber),t.triggerRelease(r,a)):i&&this.triggerRelease(i,r)}}},{key:"getNoteFromTranspose",value:function(e){return this.getDefaultNote().transpose(e+this.oscillatorFrequency)}},{key:"getDefaultNote",value:function(){return Kt}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=nn(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"fm",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.carrier,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.voices[0],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;r.envelope.releaseCurve="end",r.name=this.name,r.isCarrier=!t;var i=void 0===t;i&&(r._frequencyNode||(r.frequency=new H.a.Signal(440,H.a.Type.Frequency),r._frequencyNode=r.frequency)),r.operatorFrequency||(r.operatorFrequency=r.oscillator.frequency),r.harmonicity?(r.volume.value=0,r.octaves.output.gain.value=0,r.harmonicity.output.gain.value=0,r.modulationIndex.output.gain.value=0,r.feedback.gain.value=0,r.detune.value=0):(r.harmonicity=new H.a.Multiply(0),r.harmonicity.units=H.a.Type.Positive,r.octaves=new H.a.Multiply(0),r.octaves.units=H.a.Type.Positive,r.modulationIndex=new H.a.Multiply(0),r.modulationIndex.units=H.a.Type.Positive,r.feedback=new H.a.Gain(0)),i?(r.frequency.connect(r.octaves),r.octaves.connect(r.harmonicity)):(t.voices[a].frequency.connect(r.octaves),r.octaves.connect(r.harmonicity),t.voices[a].frequency.connect(r.modulationIndex)),r.harmonicity.connect(r.oscillator.frequency),r.oscillator.frequency.connect(r.feedback),this.feedback&&(this.feedbackEdge||(this.feedbackEdge=new Rt(this,this.sequencerEngine,0,"Feedback "+this.name)),this.connectFeedbackEdge(this.feedbackEdge,r,a)),r.disconnectFM=function(n){e.feedback&&e.feedbackEdge.disconnect(r,a),r.oscillator.frequency.disconnect(r.feedback),e.harmonicityParameter.removeAudioParam(r.harmonicity.output.gain),e.oscillatorOctaveParameter.removeAudioParam(r.octaves.output.gain),e.oscillatorLevelParameter.removeAudioParam(r.volume),e.modulationIndexParameter.removeAudioParam(r.modulationIndex.output.gain),e.feedbackParameter.removeAudioParam(r.feedback.gain),e.detuneParameter.removeAudioParam(r.detune),t?(t._voices[a].frequency.disconnect(r.octaves),r.octaves.disconnect(r.harmonicity),t._voices[a].frequency.disconnect(r.modulationIndex)):(r.frequency.disconnect(r.octaves),r.octaves.disconnect(r.harmonicity))},n||(this.harmonicityParameter=new te.a("Harmonicity",this.voices.map(function(e){return e.harmonicity.output.gain}),{min:0,documentation:["Ratio between this operator`'s frequency, and the frequency of the inputed note.","Ex: A ratio of 2 is an octave above the inputed note"],max:20,unit:"",times:2,defaultValue:3},0),this.registerParameter(this.harmonicityParameter),this.oscillatorOctaveParameter=new te.a("octave",this.voices.map(function(e){return e.octaves.output.gain}),{min:0,documentation:["Controls octave"],max:8,unit:"",defaultValue:1,times:2},0),this.registerParameter(this.oscillatorOctaveParameter),this.modulationIndexParameter=new te.a("modulationIndex",this.voices.map(function(e){return e.modulationIndex.output.gain}),{documentation:"The level of modulation the operator will reach  at the maximum of it's envelope",min:0,max:120,unit:"",defaultValue:1}),this.registerParameter(this.modulationIndexParameter),this.feedbackParameter=new te.a("feedback",this.voices.map(function(e){return e.feedback.gain}),{documentation:"Controls the feedback,  bringing out the modulation for this operator.",min:0,max:10,unit:"",defaultValue:0,logDispose:!0}),this.registerParameter(this.feedbackParameter)),n&&(this.harmonicityParameter.set(this.harmonicityParameter.get(!0),!0,!0),this.oscillatorOctaveParameter.set(this.oscillatorOctaveParameter.get(!0),!0,!0),this.modulationIndexParameter.set(this.modulationIndexParameter.get(!0),!0,!0),this.feedbackParameter.set(this.feedbackParameter.get(!0),!0,!0))}},{key:"setAudioParamsForParameters",value:function(){this.oscillatorLevelParameter.setAudioParams(this.voices.map(function(e){return e.volume})),this.detuneParameter.setAudioParams(this.voices.map(function(e){return e.detune})),this.harmonicityParameter.setAudioParams(this.voices.map(function(e){return e.harmonicity.output.gain})),this.oscillatorOctaveParameter.setAudioParams(this.voices.map(function(e){return e.octaves.output.gain})),this.modulationIndexParameter.setAudioParams(this.voices.map(function(e){return e.modulationIndex.output.gain})),this.feedbackParameter.setAudioParams(this.voices.map(function(e){return e.feedback.gain}))}},{key:"connectFeedbackEdge",value:function(e,t,n){e||(this.feedbackEdge=new Rt(this,this.sequencerEngine,0,"Feedback "+this.name),e=this.feedbackEdge),e.modulatorNodes[n]||(e.modulatorNodes.push(new H.a.Gain(0)),e.modulatorNodes[n].connect(t.oscillator.frequency)),t.connect(e.modulatorNodes[n].gain),t.feedback.connect(e.modulatorNodes[n]),e.disconnect=function(t,n){t.disconnect(e.modulatorNodes[n].gain),t.feedback.disconnect(e.modulatorNodes[n])}}},{key:"connectEdge",value:function(e){var t=this;if(-2===e.operator.id||-3===e.operator.id){var n=-2===e.operator.id?this.instrument.outputNodeX:this.instrument.outputNodeY;return e.disconnect=n.connect(this),e}var r=[],a=function(n){var a=t.voices[n];a.connect(e.modulatorNodes[n].gain),e.operator.voices[n],a.modulationIndex.connect(e.modulatorNodes[n]),r.push(function(){a.disconnect(e.modulatorNodes[n].gain),a.modulationIndex.disconnect(e.modulatorNodes[n])})};for(var i in this.voices)a(i);return e.disconnect=function(){return r.forEach(function(e){return e()})},e}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=tn(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setupEnvelopes",value:function(){this.ampEnvelope=new le(this.sequencerEngine,this.mixSession,this.context),this.ampEnvelope.releaseParameter.automatable=!1,this.connectSynthToPitchEnvelope()}},{key:"setEnvelopes",value:function(e,t,n,r){var a=e&&null!==e.releaseParameter.get()?e.release:t.releaseParameter.getKeyScaledValue(n,!1);if("C"!==this.name){var i=a+window.fuck;this.ampEnvelope.releaseParameter.set(i,!0,!0)}this._setEnvelopes(e,this.ampEnvelope,n,r),e&&null!==e.releaseParameter.get()&&t.releaseParameter.set(e.release,!0,!0)}},{key:"_setEnvelopes",value:function(e,t,n,r){var a=e&&null!==e.releaseParameter.get()?e.release:t.releaseParameter.getKeyScaledValue(n);r.envelope.attack=new H.a.Time((1+t.attackParameter.getKeyScaledValue(n))/1e3),r.envelope.decay=new H.a.Time((1+t.decayParameter.getKeyScaledValue(n))/1e3),r.envelope.sustain=Math.min(t.sustainParameter.getKeyScaledValue(n),.99),r.envelope.release=new H.a.Time((1+a)/1e3)}},{key:"connectSynthToPitchEnvelope",value:function(){var e=this;this.getDetuneVoices().forEach(function(t){return e.pitchEnvelope.connect(t)})}},{key:"disconnectSynthFromPitchEnvelope",value:function(){var e=this;this.getDetuneVoices().forEach(function(t){return e.pitchEnvelope.disconnect(t)})}},{key:"getDetuneVoices",value:function(){return this.voices.map(function(e){return e.detune})}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=$t(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setupWaveformParameters",value:function(){var e=this;this.customOscillatorTypeParameter=new $.a("Custom Oscillator Type",this,function(t,n){n&&(e.oscillatorTypeParameter&&(e.oscillatorType=null),t._voices.forEach(function(e){return e.oscillator.type="sine"}),H.a.Master.context.isOffline?n&&e.setPeriodicWave(Object(ee.c)(n)):n&&Object(ee.b)(n).then(function(t){return e.setPeriodicWave(t)}))},{min:0,max:2,unit:"",defaultValue:null,uxAutomatable:!1}),this.registerParameter(this.customOscillatorTypeParameter),this.oscillatorTypeParameter=new Gt.a("Oscillator Type",this,function(t,n){if(void 0!==n){var r=t.oscillatorTypeParameter?t.oscillatorTypeParameter.getOptionFromNumber(n):en[n];e.customOscillatorType=null,(r=r||n)&&r.includes("fat")&&t._voices.forEach(function(e){return e.oscillator.type="sine"}),r!==t.voices[t.voices.length-1].oscillator.type&&(t.voices.forEach(function(e){return e.oscillator.type=r}),"pulse"===r?e.pulseWidthParameter.setAudioParams(t.voices.map(function(e){return e.oscillator.width})):e.pulseWidthParameter&&e.pulseWidthParameter._audioParams&&Object(h.a)(e.pulseWidthParameter._audioParams).forEach(function(t){return e.pulseWidthParameter.removeAudioParam(t)}))}},{min:0,max:1,unit:"",defaultValue:"sine",options:en,uxAutomatable:!1}),this.registerParameter(this.oscillatorTypeParameter),this.harmonicsParameter=new $.a("Harmonics",this,function(e,t){e.sequencerEngine.isOffline?e.updateHarmonicsSync(t):e.updateHarmonics(t)},{min:-1,max:1,unit:"",defaultValue:0,uxAutomatable:!1}),this.registerParameter(this.harmonicsParameter),this.partialCountParameter=new $.a("Partial Count",this,function(t,n){e.customOscillatorType||t.voices.forEach(function(e){return e.oscillator.partialCount=n})},{min:0,automatable:!1,max:24,unit:"",defaultValue:0,uxAutomatable:!1}),this.registerParameter(this.partialCountParameter),this.partialsParameter=new $.a("Partials",this,function(e,t){return t&&e.voices.forEach(function(e){return e.oscillator.partials=t})},{unit:"",defaultValue:null,automatable:!1,uxAutomatable:!1}),this.registerParameter(this.partialsParameter),this.pulseWidthParameter=new te.a("Pulse Width",void 0,{unit:"",defaultValue:.1,min:0,max:1,automatable:!1,uxAutomatable:!1}),this.registerParameter(this.pulseWidthParameter),this.waveformAParameter=new $.a("Waveform A",this,function(e,t){e.sequencerEngine.isOffline?e.updateHarmonicsSync():e.updateHarmonics()},{defaultValue:2,min:0,max:50}),this.registerParameter(this.waveformAParameter),this.waveformBParameter=new $.a("Waveform B",this,function(e,t){e.sequencerEngine.isOffline?e.updateHarmonicsSync():e.updateHarmonics()},{defaultValue:0,min:0,max:50}),this.registerParameter(this.waveformBParameter)}},{key:"updateHarmonics",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:this.harmonicsParameter.get(),this.customOscillatorType&&this.periodicWave){e.next=3;break}return e.abrupt("return");case 3:return n={imag:Object(h.a)(this.periodicWave.imag),real:Object(h.a)(this.periodicWave.real)},e.next=6,Object(ee.d)(this.waveformAParameter.get());case 6:return r=e.sent,e.next=9,Object(ee.d)(this.waveformBParameter.get());case 9:i=e.sent,o=t>0?i:r,this._updateHarmonics(t,n,o);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateHarmonicsSync",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.harmonicsParameter.get();if(this.customOscillatorType&&this.periodicWave){var t={imag:Object(h.a)(this.periodicWave.imag),real:Object(h.a)(this.periodicWave.real)},n=e>0?Object(ee.e)(this.waveformBParameter.get()):Object(ee.e)(this.waveformAParameter.get());this._updateHarmonics(e,t,n)}}},{key:"_updateHarmonics",value:function(e,t,n){e=Math.abs(e);for(var r=0;r<t.real.length;r++){var a=t.real[r],i=n.real[r];t.real[r]=a+(i-a)*Math.pow(e,2);var o=t.imag[r],s=n.imag[r];t.imag[r]=o+(s-o)*Math.pow(e,2)}this.setPeriodicWave(t,!0)}},{key:"setPeriodicWave",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(new Date).getTime(),t||(this.periodicWave=e);var n=H.a.Master.context.createPeriodicWave(new Float32Array(e.real),new Float32Array(e.imag));this._voices&&(this._voices.forEach(function(e){e.oscillator._wave=n,e._wave=n,e.oscillator._oscillator._wave=n,e.oscillator._type="custom",e.oscillator._oscillator._type="custom",e.oscillator._oscillator._oscillator&&e.oscillator._oscillator._oscillator.setPeriodicWave(n)}),t||(this.harmonics=this.harmonics),(new Date).getTime())}},{key:"setOscillatorSample",value:function(e){}},{key:"hasCustomWaveform",value:function(){return null!==this.partialsParameter.get()}},{key:"oscillatorType",get:function(){return this.oscillatorTypeParameter.get(!0)},set:function(e){this.oscillatorTypeParameter.set(e,!0,!0),"custom"===e&&(this.partials=[1,1,1,1,1,1,0,1,0,1,0,1].concat(Array(32).fill(0)))}},{key:"customOscillatorType",get:function(){return this.customOscillatorTypeParameter.get(!0)},set:function(e){this.customOscillatorTypeParameter.set(e,!0,!0)}},{key:"partials",get:function(){return this.partialsParameter.get(!0)},set:function(e){"custom"!==this.oscillatorType&&(this.oscillatorType="custom"),this.partialsParameter.set(e,!0,!0)}}]),n}(e)},Xt.a,function(e){return function(e){Object(u.a)(n,e);var t=rn(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getJson",value:function(e){var t=Object(p.a)({preset:this.preset.contentHash,isHarmonicityFixed:!0,enabled:this.enabled,oscillatorType:this.oscillatorType,oscillatorFrequency:this.oscillatorFrequency,oscillatorLevel:this.oscillatorLevel,polyphony:this.polyphony,portamento:this.portamento,oscillatorOctave:this.oscillatorOctave,detune:this.detune,partials:this.partials,customOscillatorType:this.customOscillatorType,harmonics:this.harmonics,pulseWidth:this.pulseWidth,spread:this.spreadParameter.get(),count:this.countParameter.get(),waveformA:this.waveformAParameter.get(),waveformB:this.waveformBParameter.get()},this.getFMJson(e));return t=Object(Q.b)(t,"oscillatorOctaveParameter",this.oscillatorOctaveParameter,void 0,e),t=Object(Q.b)(t,"waveformAParameter",this.waveformAParameter,void 0,e),t=Object(Q.b)(t,"waveformBParameter",this.waveformBParameter,void 0,e),t=Object(Q.b)(t,"pulseWidthParameter",this.pulseWidthParameter,void 0,e),t=Object(Q.b)(t,"enabledParameter",this.enabledParameter,void 0,e),t=Object(Q.b)(t,"oscillatorLevelParameter",this.oscillatorLevelParameter,void 0,e),t=Object(Q.b)(t,"detuneParameter",this.detuneParameter,void 0,e),t=Object(Q.b)(t,"portamentoParameter",this.portamentoParameter,void 0,e),t=Object(Q.b)(t,"oscillatorFrequencyParameter",this.oscillatorFrequencyParameter,void 0,e),t=Object(Q.b)(t,"harmonicsParameter",this.harmonicsParameter,void 0,e),t=Object(Q.b)(t,"oscillatorTypeParameter",this.oscillatorTypeParameter,void 0,e),t=Object(Q.b)(t,"partialsParameter",this.partialsParameter,void 0,e),t=Object(Q.b)(t,"customOscillatorTypeParameter",this.customOscillatorTypeParameter,void 0,e)}},{key:"getFMJson",value:function(e){var t={harmonicity:this.harmonicityParameter.get(!0),modulationIndex:this.modulationIndexParameter.get(!0),feedback:this.feedbackParameter.get(!0),ampEnvelope:this.ampEnvelope.getJson(),partialCount:this.partialCountParameter.get(!0),formants:this.getFormantsJson()};return t=Object(Q.b)(t,"harmonicityParameter",this.harmonicityParameter,void 0,e),t=Object(Q.b)(t,"modulationIndexParameter",this.modulationIndexParameter,void 0,e),t=Object(Q.b)(t,"feedbackParameter",this.feedbackParameter,void 0,e),t=Object(Q.b)(t,"partialCountParameter",this.partialCountParameter,void 0,e)}},{key:"fromJson",value:function(e,t){if((new Date).getTime(),void 0===e)return{};e.preset&&(this.preset.contentHash=e.preset);var n=this.fromFMJson(e,t);(new Date).getTime(),Object(ne.a)(this.enabledParameter,e.enabled,n),Object(ne.a)(this.pulseWidthParameter,e.pulseWidth,n);var r=e.oscillatorType;return Object(ne.a)(this.oscillatorFrequencyParameter,e.oscillatorFrequency,n),Object(ne.a)(this.portamentoParameter,e.portamento,n),void 0!==e.oscillatorOctave?Object(ne.a)(this.oscillatorOctaveParameter,e.oscillatorOctave,n):Object(ne.a)(this.oscillatorOctaveParameter,1,n),e.customOscillatorType?Object(ne.a)(this.customOscillatorTypeParameter,e.customOscillatorType,n):Object(ne.a)(this.oscillatorTypeParameter,r,n),e.harmonics&&Object(ne.a)(this.harmonicsParameter,e.harmonics,n),void 0!==e.partials&&null!==e.partials&&("custom"!==this.oscillatorType||this.customOscillatorType||Object(ne.a)(this.partialsParameter,e.partials,n)),e.spread&&Object(ne.a)(this.spreadParameter,e.spread,n),e.count&&Object(ne.a)(this.countParameter,e.count,n),n=Object(p.a)({},n,Object(Q.a)(e,"oscillatorOctaveParameter",this.oscillatorOctaveParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"pulseWidthParameter",this.pulseWidthParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"enabledParameter",this.enabledParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"portamentoParameter",this.portamentoParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"detuneParameter",this.detuneParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"oscillatorFrequencyParameter",this.oscillatorFrequencyParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"oscillatorTypeParameter",this.oscillatorTypeParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"partialsParameter",this.partialsParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"customOscillatorTypeParameter",this.customOscillatorTypeParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"harmonicsParameter",this.harmonicsParameter,this.sequencerEngine,t,!0)),this.customOscillatorType&&(e.waveformA?Object(ne.a)(this.waveformAParameter,e.waveformA,n):Object(ne.a)(this.waveformAParameter,2,n),e.waveformB?Object(ne.a)(this.waveformBParameter,e.waveformB,n):Object(ne.a)(this.waveformBParameter,0,n),n=Object(p.a)({},n,Object(Q.a)(e,"waveformAParameter",this.waveformAParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"waveformBParameter",this.waveformBParameter,this.sequencerEngine,t,!0))),Object(ae.a)(e.detune)&&Object(ne.a)(this.detuneParameter,e.detune,n),Object(ne.a)(this.oscillatorLevelParameter,e.oscillatorLevel,n),n=Object(p.a)({},n,Object(Q.a)(e,"detuneParameter",this.detuneParameter,this.sequencerEngine,t),Object(Q.a)(e,"oscillatorLevelParameter",this.oscillatorLevelParameter,this.sequencerEngine,t))}},{key:"isCarrier",get:function(){return 0===this.instrument.oscillatorNodes.indexOf(this)}},{key:"fromFMJson",value:function(e,t){if(void 0===e)return{};var n={};return void 0!==e.harmonicity&&(e.harmonicity=an(e.harmonicity,this.isCarrier,e.isHarmonicityFixed),Object(ne.a)(this.harmonicityParameter,e.harmonicity,n)),void 0!==e.partialCount&&Object(ne.a)(this.partialCountParameter,e.partialCount,n),void 0!==e.modulationIndex&&Object(ne.a)(this.modulationIndexParameter,e.modulationIndex,n),void 0!==e.feedback&&Object(ne.a)(this.feedbackParameter,e.feedback,n),void 0!==e.ampEnvelope&&(n=Object(p.a)({},n,this.ampEnvelope.fromJson(e.ampEnvelope))),n=Object(p.a)({},n,Object(Q.a)(e,"feedbackParameter",this.feedbackParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"partialCountParameter",this.partialCountParameter,this.sequencerEngine,t,!0)),e.harmonicityParameter&&(e.harmonicityParameter.unlockedValue=an(e.harmonicityParameter.unlockedValue,this.isCarrier,e.isHarmonicityFixed),e.harmonicityParameter.value=an(e.harmonicityParameter.value,this.isCarrier,e.isHarmonicityFixed)),n=Object(p.a)({},n,Object(Q.a)(e,"harmonicityParameter",this.harmonicityParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"modulationIndexParameter",this.modulationIndexParameter,this.sequencerEngine,t,!0)),(new Date).getTime(),"formants"in e?n=Object(p.a)({},n,this.loadFormantsJson(e.formants,t)):(this.formants.forEach(function(e){return e.ripMods()}),this.formants.forEach(function(e){return Object(ne.a)(e.enabledParameter,!1,n)})),(new Date).getTime(),n}},{key:"mateParameter",value:function(e,t,n,r){Object(W.b)(this.sequencerEngine,e,t,n,r)}},{key:"mateJson",value:function(e,t){this.mateParameter("enabled",e,this.enabledParameter,t),this.enabled&&(this.enabled=!0,this.mateParameter("polyphony",e,this.polyphonyParameter,t),this.mateParameter("oscillatorType",e,this.oscillatorTypeParameter,t),this.mateParameter("oscillatorFrequency",e,this.oscillatorFrequencyParameter,t),this.mateParameter("detune",e,this.detuneParameter,t),this.mateParameter("portamento",e,this.portamentoParameter,t))}}]),n}(e)})(ie)),fn=function(){function e(t,n,r){Object(o.a)(this,e),this.sequencerEngine=t,this.store=t.store,this.mixSession=n,this.context=r.getCopy().forSubDevice(this),this.parameters=[],this.envelope=new le(this.sequencerEngine,this.mixSession,this.context,void 0,-2e3,2e3),this.setupParameters()}return Object(s.a)(e,[{key:"setupParameters",value:function(){var e=this;this.attackParameter=new $.a("Attack",this,function(t,n){e.envelope&&(e.envelope.attack=n)},{min:0,max:1e4,unit:"ms",defaultValue:1e3}),this.registerParameter(this.attackParameter),this.decayParameter=new $.a("Decay",this,function(t,n){e.envelope&&(e.envelope.decay=n)},{min:0,max:4e3,unit:"ms",defaultValue:1e3}),this.registerParameter(this.decayParameter),this.sustainParameter=new $.a("Sustain",this,function(t,n){e.envelope&&(e.envelope.sustain=n)},{min:0,max:1,unit:"",defaultValue:.5}),this.registerParameter(this.sustainParameter),this.releaseParameter=new $.a("Release",this.envelope,function(t,n){e.envelope&&(e.envelope.release=n)},{min:0,max:5e3,unit:"ms",defaultValue:1e3}),this.registerParameter(this.releaseParameter),this.levelParameter=new $.a("Level",this,function(t,n){e.envelope&&(e.envelope.level=n)},{min:-1,max:1,unit:"",defaultValue:0}),this.registerParameter(this.levelParameter),this.attackCurveParameter=new $.a("Attack Curve",this.envelope,function(e,t){return e.attackCurve=t},{min:0,max:1e4,unit:"",defaultValue:"linear",automatable:!1}),this.registerParameter(this.attackCurveParameter),this.decayCurveParameter=new $.a("Decay Curve",this.envelope,function(e,t){return e.decayCurve=t},{min:0,max:1e4,unit:"",automatable:!1,defaultValue:"linear"}),this.registerParameter(this.decayCurveParameter),this.releaseCurveParameter=new $.a("Release Curve",this.envelope,function(e,t){return e.releaseCurve=t},{min:0,max:1e4,unit:"",automatable:!1,defaultValue:"exponential"}),this.registerParameter(this.releaseCurveParameter)}},{key:"registerParameter",value:function(e){e.setStore(this.store),e.setMixSession(this.mixSession),e.setContext(this.context),e.setTrack(this.context.track),this.parameters.push(e)}},{key:"getJson",value:function(e){var t={level:this.level,attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release,attackCurve:this.attackCurve,decayCurve:this.decayCurve,releaseCurve:this.releaseCurve};return t=Object(Q.b)(t,"attackParameter",this.attackParameter,void 0,e),t=Object(Q.b)(t,"decayParameter",this.decayParameter,void 0,e),t=Object(Q.b)(t,"sustainParameter",this.sustainParameter,void 0,e),t=Object(Q.b)(t,"releaseParameter",this.releaseParameter,void 0,e),t=Object(Q.b)(t,"levelParameter",this.levelParameter,void 0,e),t=Object(Q.b)(t,"attackCurveParameter",this.attackCurveParameter,void 0,e),t=Object(Q.b)(t,"decayCurveParameter",this.decayCurveParameter,void 0,e),t=Object(Q.b)(t,"releaseCurveParameter",this.releaseCurveParameter,void 0,e)}},{key:"fromJson",value:function(e){var t={};return Object(ne.a)(this.attackParameter,e.attack,t),Object(ne.a)(this.decayParameter,e.decay,t),Object(ne.a)(this.sustainParameter,e.sustain,t),Object(ne.a)(this.releaseParameter,e.release,t),Object(ne.a)(this.levelParameter,e.level,t),e.attackCurve&&Object(ne.a)(this.attackCurveParameter,e.attackCurve,t),e.decayCurve&&Object(ne.a)(this.decayCurveParameter,e.decayCurve,t),e.releaseCurve&&Object(ne.a)(this.releaseCurveParameter,e.releaseCurve,t),t=Object(p.a)({},t,Object(Q.a)(e,"attackParameter",this.attackParameter,this.sequencerEngine),Object(Q.a)(e,"decayParameter",this.decayParameter,this.sequencerEngine),Object(Q.a)(e,"sustainParameter",this.sustainParameter,this.sequencerEngine),Object(Q.a)(e,"releaseParameter",this.releaseParameter,this.sequencerEngine),Object(Q.a)(e,"levelParameter",this.levelParameter,this.sequencerEngine),Object(Q.a)(e,"attackCurveParameter",this.attackCurveParameter,this.sequencerEngine),Object(Q.a)(e,"decayCurveParameter",this.decayCurveParameter,this.sequencerEngine),Object(Q.a)(e,"releaseCurveParameter",this.releaseCurveParameter,this.sequencerEngine))}},{key:"getCopy",value:function(t){var n=new e(this.sequencerEngine,this.mixSession,t);return n.fromJson(this.getJson()),n}},{key:"attack",get:function(){return this.attackParameter.get()},set:function(e){this.attackParameter.set(e)}},{key:"decay",get:function(){return this.decayParameter.get()},set:function(e){this.decayParameter.set(e)}},{key:"sustain",get:function(){return this.sustainParameter.get()},set:function(e){this.sustainParameter.set(e)}},{key:"release",get:function(){return this.releaseParameter.get()},set:function(e){this.releaseParameter.set(e)}},{key:"level",get:function(){return this.levelParameter.get()},set:function(e){this.levelParameter.set(e)}},{key:"attackCurve",get:function(){return this.attackCurveParameter.get()},set:function(e){this.attackCurveParameter.set(e)}},{key:"decayCurve",get:function(){return this.decayCurveParameter.get()},set:function(e){this.decayCurveParameter.set(e)}},{key:"releaseCurve",get:function(){return this.releaseCurveParameter.get()},set:function(e){this.releaseCurveParameter.set(e)}},{key:"refresh",value:function(){this.attackParameter.callSetter(),this.decayParameter.callSetter(),this.sustainParameter.callSetter(),this.releaseParameter.callSetter(),this.levelParameter.callSetter()}},{key:"mateJson",value:function(e,t){this.mateParameter("attack",e,this.attackParameter,t),this.mateParameter("decay",e,this.decayParameter,t),this.mateParameter("sustain",e,this.sustainParameter,t),this.mateParameter("release",e,this.releaseParameter,t)}},{key:"mateParameter",value:function(e,t,n,r){Object(W.b)(this.sequencerEngine,e,t,n,r)}},{key:"dispose",value:function(){this.envelope.dispose(),this.envelope=void 0}}]),e}();function hn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var pn=n(28),dn=n(95);function mn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vn(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var gn=function(e,t){var n=new H.a.Frequency(e).toMidi()+1;return e+t/100*(new H.a.Frequency(n,"midi").toFrequency()-e)},yn=function e(t,n,r){Object(o.a)(this,e),this.carrier=t,this.modulators=n,this.slotNumber=r,this.voiceNumber=r};function kn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function On(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var jn=function(e){Object(u.a)(n,e);var t=On(n);function n(e,r,a,i){var s;return Object(o.a)(this,n),(s=t.call(this,e,r,a,!1)).track=i,s.id=Object(j.uuid)(),s.initializeConfigurations(s.adjacencyLists),s.loaded=!0,Object(ee.b)("01_Saw"),Object(ee.b)("03_Square"),s.setupOscillators(),s.setupOutputs(),s.setupFilters(),s.outputNode=s.filter.effectNode,s.outputNode.x=180,s.outputNode.y=200,s.setupFM(),s.setupPitchBend(),s.getParameters().forEach(function(e){return e.isLoaded=!0}),s.setupParameters(),s.refreshParameters(),s.voiceFactory=ft,s.sequencerEngine.dispatch(Object(C.Vb)(s.initialBulkValues)),s.setupSlide(),s.polyphonyParameter.set(5),s.algorithmParameter.set(3),s.connectNoise(),s.setupNoiseParameters(),e.isOffline||setTimeout(function(){s.polyphonyParameter.set(6)},500),s}return Object(s.a)(n,[{key:"detuneSignal",get:function(){return this.pitchBendSignal}},{key:"detuneParameter",get:function(){return this.pitchBendParameter}},{key:"detuneSignals",get:function(){var e=[];return this.oscillators.forEach(function(t){return t.voices.forEach(function(t){return e.push(t.detune)})}),e}},{key:"effects",get:function(){return this.oscillatorNodes},set:function(e){}},{key:"newEdge",value:function(e,t){return new Rt(e,this.sequencerEngine,t)}},{key:"connectEdge",value:function(e,t){return Object(Z.a)(Object(f.a)(n.prototype),"connectEdge",this).call(this,e,t),e.connectEdge(t),t}},{key:"deleteEdge",value:function(e){var t=this;if(!e.modulator){var r=function(n){t.adjacencyLists[n].indexOf(e)>-1&&(t.effects.find(function(e){return e.id===n})&&e.disconnect&&e.disconnect())};for(var a in this.adjacencyLists)r(a)}Object(Z.a)(Object(f.a)(n.prototype),"deleteEdge",this).call(this,e)}},{key:"getEffectType",value:function(){return re.d}},{key:"modulators",get:function(){return Object(h.a)(this.sequencerEngine.lfos.map(function(e){return e.lfo}))}},{key:"setSize",value:function(e,t,n,r){this.inputNode.x=0,this.inputNode.y=0,this.outputNodeX.x=e-32,this.outputNodeX.y=10,this.outputNodeY.x=e-32,this.outputNodeY.y=45}},{key:"dispose",value:function(){this.deleteAlgorithmRouting(),this.disposeOutputs(),this.disposeNoise(),Object(Z.a)(Object(f.a)(n.prototype),"dispose",this).call(this)}},{key:"getCopy",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sequencerEngine,a=arguments.length>3?arguments[3]:void 0,i=new n(r,this.mixSession,e,t);return i.fromJsonSync(this.getJson(),a),i}},{key:"simplifyPatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e/2;Object(Z.a)(Object(f.a)(n.prototype),"simplifyPatch",this).call(this,e);var r=this.oscillators.flatMap(function(e){return e.formantsManager.formants}).filter(function(e){return e.isEnabled});r=Object(ct.a)(r);for(var a=Math.floor(r.length*t/100),i=0;i<a;i++){var o=r[i];o.getParameters().filter(function(e){return e.isMapped}).forEach(function(e){return e.isMapped.unmap(e)}),o.effect&&o.bypassEffect(),o.enabledParameter.set(!1)}}}]),n}(Object(Ve.a)(function(e){return function(e){Object(u.a)(n,e);var t=kn(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).voiceCounter=0,e.voiceToTranspose={},e.frequencyToVoice={},e.voiceToFrequency={},e.voicesUsed=[],e.numberToVoice={},e}return Object(s.a)(n,[{key:"useVoice",value:function(e,t){var n=this.findFreeVoice(t,e);return this.buildVoice(n)}},{key:"buildVoice",value:function(e){return new yn(this.carrierOscillator.voices[e],this.modulatorOscillators.map(function(t){return t.voices[e]}),e)}},{key:"findFreeVoice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H.a.Master.context.currentTime,t=arguments.length>1?arguments[1]:void 0,n=this.oscillators[0].getNoteFromTranspose(t).toFrequency();for(var r in this.voiceToFrequency)if(!(parseInt(r)>=this.polyphonyParameter.get())&&this.voiceToFrequency[r]===n)return parseInt(r);for(var a=this.oscillators[0].voices,i=this.voiceCounter,o=0;o<this.polyphonyParameter.get();o++){var s=(i+o)%a.length;if(0===a[s].envelope.getValueAtTime(e))return parseInt(s)}for(var c=[],u=this.voicesUsed.length-1;u>=0;u--)if((c=Array.from(new Set([].concat(Object(h.a)(c),[this.voicesUsed[u]])))).length===this.polyphonyParameter.get())return this.voicesUsed[u];return this.polyphonyParameter.get()-1}},{key:"storeVoiceFrequency",value:function(e,t,n){var r=this.oscillators[0].getNoteFromTranspose(e);this.frequencyToVoice[r.toFrequency()]=t,this.voiceToFrequency[t]=r.toFrequency(),this.voiceCounter=(this.voiceCounter+1)%this.polyphonyParameter.get(),this.numberToVoice[t]=n}},{key:"clearVoiceData",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.releaseAll(),this.voiceCounter=0,this.voiceToTranspose={},this.frequencyToVoice={},this.voiceToFrequency={},this.voicesUsed=[],this.numberToVoice={}}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=bn(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getJson",value:function(e){var t,n=(t={id:this.id,mix:this.mixParameter.get(!0),algorithm:this.algorithmParameter.get(!0),ampEnvelope:this.ampEnvelope.getJson(e),polyphony:this.polyphonyParameter.get(),instrumentType:this.getInstrumentType(),filterCutoff:this.filterCutoff,filterQ:this.filterQ,hpFilterCutoff:this.hpFilterCutoff,fmParameters:this.fmParameters,hpFilterQ:this.hpFilterQ},Object(pn.a)(t,"ampEnvelope",this.ampEnvelope.getJson(e)),Object(pn.a)(t,"filterEnvelope",this.filterEnvelope.getJson(e)),Object(pn.a)(t,"hpFilterEnvelope",this.hpFilterEnvelope.getJson(e)),Object(pn.a)(t,"pitchEnvelope",this.pitchEnvelope.getJson(e)),Object(pn.a)(t,"oscillators",this.oscillatorNodes.map(function(t){return t.getJson(e)})),Object(pn.a)(t,"noiseLevel",this.noiseLevelParameter.get(!0)),Object(pn.a)(t,"pitchBend",this.pitchBendParameter.get(!0)),t);return n=Object(Q.b)(n,"noiseLevelParameter",this.noiseLevelParameter,void 0,e),n=Object(Q.b)(n,"filterCutoffParameter",this.filterCutoffParameter,void 0,e),n=Object(Q.b)(n,"hpFilterCutoffParameter",this.hpFilterCutoffParameter,void 0,e),n=Object(Q.b)(n,"hpFilterQParameter",this.hpFilterQParameter,void 0,e),n=Object(Q.b)(n,"filterQParameter",this.filterQParameter,void 0,e),n=Object(Q.b)(n,"algorithmParameter",this.algorithmParameter,void 0,e),n=Object(Q.b)(n,"mixParameter",this.mixParameter,void 0,e),n=Object(Q.b)(n,"pitchBendParameter",this.pitchBendParameter,void 0,e)}},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]&&l[1],r=l.length>2&&void 0!==l[2]&&l[2],i=0,t){e.next=5;break}return e.abrupt("return",{});case 5:t.fmParameters&&!n&&(this.fmParameters=t.fmParameters),!n&&t.id&&(this.id=t.id);case 7:if(Object(ee.c)("01_Saw")&&Object(ee.c)("03_Square")){e.next=14;break}return e.next=10,Object(m.a)(100);case 10:if(!(++i>50)){e.next=12;break}return e.abrupt("return");case 12:e.next=7;break;case 14:return this.ampEnvelope.release=50,this.clearVoiceData(),(new Date).getTime(),this.loaded=!1,this.track.trackIsLoading=!0,e.next=21,Object(m.a)(220);case 21:return this.getParameters().forEach(function(e){return e.isLoaded=!1}),o={},void 0!==t.polyphony&&(s=this.polyphonyParameter.set(t.polyphony,void 0,!0),c=s.id,u=s.value,o[c]=u),e.t0=p.a,e.t1={},e.t2=o,e.next=29,this.fromOscillatorsJson(t,n);case 29:return e.t3=e.sent,o=(0,e.t0)(e.t1,e.t2,e.t3),void 0!==t.algorithm&&Object(ne.a)(this.algorithmParameter,t.algorithm,o),r&&(o=Object(p.a)({},o,this.scaleToC())),o=Object(p.a)({},o,this.fromJsonRest(t,n)),(new Date).getTime(),this.keepParametersInSync(),e.abrupt("return",o);case 37:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fromJsonSync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!t&&e.id&&(this.id=e.id),this.loaded=!1,this.track.trackIsLoading=!0,this.getParameters().forEach(function(e){return e.isLoaded=!1});var n={};if(void 0!==e.polyphony){var r=this.polyphonyParameter.set(e.polyphony,void 0,!0),a=r.id,i=r.value;n[a]=i}void 0!==e.algorithm&&Object(ne.a)(this.algorithmParameter,e.algorithm,n),n=Object(p.a)({},n,this.fromOscillatorsJsonSync(e,t),this.fromJsonRest(e,t))}},{key:"fromJsonRest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,{});if(n=Object(p.a)({},n,this.ampEnvelope.fromJson(e.ampEnvelope)),void 0!==e.noiseLevel?(Object(ne.a)(this.noiseLevelParameter,e.noiseLevel,n),n=Object(p.a)({},n,Object(Q.a)(e,"noiseLevelParameter",this.mixParameter,this.sequencerEngine,t))):this.noiseLevelParameter.set(0),n=Object(p.a)({},n,Object(Q.a)(e,"mixParameter",this.mixParameter,this.sequencerEngine,t),Object(Q.a)(e,"algorithmParameter",this.algorithmParameter,this.sequencerEngine,t),Object(Q.a)(e,"pitchBendParameter",this.pitchBendParameter,this.sequencerEngine,t)),e.pitchBend?Object(ne.a)(this.pitchBendParameter,e.pitchBend,n):Object(ne.a)(this.pitchBendParameter,0,n),void 0!==e.mix&&Object(ne.a)(this.mixParameter,e.mix,n),this.detuneOffset){var r=this.pitchBendParameter.set(this.pitchBendParameter.get(!0)+this.detuneOffset),a=r.id,i=r.value;n[a]=i}return n}},{key:"keepParametersInSync",value:function(){this.getParameters().forEach(function(e){e.depthSignal&&e.depthParameter&&e.depthSignal.value!==e.depthParameter.get(!0)&&e.depthParameter.refresh(!0,!0),e._audioParams&&e._audioParams.filter(function(e){return e.input&&0!==e.value}).forEach(function(e){e.value=0}),e.audioParam&&e.audioParam.value!==e.get(!0)&&e.refresh(!0,!0)}),this.loaded=!0,this.getParameters().forEach(function(e){return e.isLoaded=!0}),this.track.trackIsLoading=!1}},{key:"fromOscillatorsJsonSync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};for(var r in this.instrumentType=e.instrumentType,this.oscillatorNodes){r=parseInt(r);var a=this.oscillatorNodes[r];n=Object(p.a)({},n,a.fromJson(e.oscillators[r],t))}return Object(p.a)({},n,this.loadFilterJson(e,t))}},{key:"loadOscillators",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]&&s[1],(new Date).getTime(),e.t0=p.a,e.t1={},e.t2=r,e.next=8,this.oscillatorNodes[0].fromJson(t.oscillators[0],n);case 8:e.t3=e.sent,r=(0,e.t0)(e.t1,e.t2,e.t3),e.t4=a.a.keys(this.oscillatorNodes);case 11:if((e.t5=e.t4()).done){e.next=20;break}if(i=e.t5.value,0!==(i=parseInt(i))){e.next=16;break}return e.abrupt("continue",11);case 16:o=this.oscillatorNodes[i],r=Object(p.a)({},r,o.fromJson(t.oscillators[i],n)),e.next=11;break;case 20:return(new Date).getTime(),e.abrupt("return",r);case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fromOscillatorsJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],this.instrumentType=t.instrumentType,e.next=4,this.loadOscillators(t,n);case 4:return r=e.sent,e.abrupt("return",Object(p.a)({},r,this.loadFilterJson(t,n)));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadFilterJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};return n=Object(p.a)({},n,this.filterEnvelope.fromJson(e.filterEnvelope,t),this.ampEnvelope.fromJson(e.ampEnvelope,t),this.pitchEnvelope.fromJson(e.pitchEnvelope,t),Object(Q.a)(e,"filterCutoffParameter",this.filterCutoffParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"filterQParameter",this.filterQParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"hpFilterCutoffParameter",this.hpFilterCutoffParameter,this.sequencerEngine,t,!0),Object(Q.a)(e,"hpFilterQParameter",this.hpFilterQParameter,this.sequencerEngine,t,!0)),e.hpFilterEnvelope&&(n=Object(p.a)({},n,this.hpFilterEnvelope.fromJson(e.hpFilterEnvelope))),Object(ne.a)(this.filterCutoffParameter,e.filterCutoff,n),Object(ne.a)(this.filterQParameter,e.filterQ,n),void 0!==e.hpFilterCutoff&&(Object(ne.a)(this.hpFilterCutoffParameter,e.hpFilterCutoff,n),Object(ne.a)(this.hpFilterQParameter,e.hpFilterQ,n)),n}},{key:"scaleToC",value:function(){var e=this.getLoudestOsc(),t=e.harmonicityParameter.get(!0),n=e.detuneParameter.get(!0),r=this.carrierOscillator.oscillatorFrequencyParameter.get(!0),a=new H.a.Frequency("C3").toFrequency(),i=a,o=a+((a+gn(a,n))*t-i),s=new H.a.Frequency(o).toMidi(),c=s-new H.a.Frequency("C3").toMidi(),u=new H.a.Frequency(s,"midi").toFrequency(),l=o-u;l<0?(new H.a.Frequency(s-1,"midi").toFrequency(),this.detuneOffset=0):(new H.a.Frequency(s+1,"midi").toFrequency(),this.detuneOffset=0);var f=-c,h=Object(dn.a)(f,12);f=12*Math.floor(r/12)+h;var p=this.carrier.oscillatorFrequencyParameter.set(f,!1,!0),d=p.id,m=p.value,v={};return v[d]=m,v}},{key:"getLoudestOsc",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.oscillators;if(0!==e.length){var t,n,r=[],a=mn(this.oscillators);try{for(a.s();!(t=a.n()).done;){var i=t.value;this.adjacencyLists[i.id].some(function(e){return"X"===e.effect.name||"Y"===e.effect.name})&&r.push(i)}}catch(f){a.e(f)}finally{a.f()}var o,s=-1/0,c=mn(e);try{for(c.s();!(o=c.n()).done;){var u=o.value;if(r.includes(u)){var l=u.oscillatorLevelParameter.get(!0);l>s&&(n=u,s=l)}}}catch(f){c.e(f)}finally{c.f()}return n}}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=hn(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setupOscillators",value:function(){this.pitchEnvelope=new fn(this.sequencerEngine,this.mixSession,this.context),this.pitchEnvelope.name="Pitch Envelope",this.oscillatorNodes=[this.createNewOscillator(!0,"C"),this.createNewOscillator(!0,"A"),this.createNewOscillator(!0,"B1"),this.createNewOscillator(!0,"B2")],this.oscillators[0].enabled=!0,this.oscillators[1].enabled=!0,this.oscillators[2].enabled=!0,this.oscillators[3].enabled=!0}},{key:"carrierOscillator",get:function(){if(this.oscillatorNodes)return this.oscillatorNodes[0]}},{key:"modulatorOscillators",get:function(){if(this.oscillatorNodes)return this.oscillators.slice(1)}},{key:"oscillators",get:function(){return this.oscillatorNodes?this.oscillatorNodes.filter(function(e){return e.enabled}):[]}},{key:"getOscillator",value:function(e){return this.oscillatorNodes?this.oscillatorNodes[e]:[]}},{key:"createNewOscillator",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"A";return new ln(this.sequencerEngine,this.mixSession,this.context,this.pitchEnvelope.envelope,e,t,this.track,this)}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Jt(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setupFM",value:function(){var e=this,t=this.track;this.fmParameters={id:Object(j.uuid)()},this.oscillators[0].track=t,this.oscillators[0].x=83,this.oscillators[0].y=9,this.oscillators[1].track=t,this.oscillators[1].x=26,this.oscillators[1].y=9,this.oscillators[3].track=t,this.oscillators[3].x=26,this.oscillators[3].y=45,this.oscillators[2].track=t,this.oscillators[2].x=83,this.oscillators[2].y=45,this.carrier=this.oscillators[0],this.oscillators.forEach(function(t){return t===e.carrier?t.fm(void 0,!1):t.fm(e.carrier,!1)});var n=this.oscillators.reduce(function(e,t){return Object(p.a)({},e,t.bulk)},{});this.sequencerEngine.dispatch(Object(C.Vb)(n)),this.oscillators[0].ampEnvelope=this.ampEnvelope,this.oscillators[0].harmonicityParameter.set(.5),this.oscillators[0].modulationIndexParameter.set(24),this.oscillators[1].harmonicityParameter.set(1),this.oscillators[2].harmonicityParameter.set(4),this.oscillators[2].modulationIndexParameter.set(32),this.oscillators[3].harmonicityParameter.set(2),this.oscillators[3].modulationIndexParameter.set(15),this.carrier=this.oscillators[0],this.oscillators[1].carrier=this.carrier,this.oscillators[2].carrier=this.carrier,this.oscillators[3].carrier=this.carrier}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Ut(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"onChangePolyphony",value:function(e){var t=this.oscillatorNodes[0].voices;if(e!==t.length){if(e>t.length)for(var n=t.length;n<e;n++)this.outputNodeX.newVoice(),this.outputNodeY.newVoice();else for(var r=e;r<t.length;r++)this.outputNodeX.removeVoice(),this.outputNodeY.removeVoice();this.refreshAmpEnvelopes()}}},{key:"refreshAmpEnvelopes",value:function(){this.ampEnvelope.ampEnvelopes=this.ampEnvelopes,this.ampEnvelope.refresh()}},{key:"setupOutputs",value:function(){var e=this.sequencerEngine,t=this.mixSession;this.outputNodeX=new zt("X",-2,this,0,e,t,this.context),this.outputNodeY=new zt("Y",-3,this,1,e,t,this.context),this.outputCrossFade=new H.a.CrossFade(.5),this.ampEnvelope=new Tt(e,t,this.context,this.ampEnvelopes,this),this.ampEnvelope.name="Amp Envelope";var n,r=Vt(this.oscillatorNodes);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.ampEnvelope.name="Envelope "+a.name}}catch(i){r.e(i)}finally{r.f()}}},{key:"forSlot",value:function(e){var t=this.outputNodeX,n=this.outputNodeY,r=[];for(var a in t.outputs)t.outputs[a].ampEnvelopes[e]||t.newVoice(),r=[].concat(Object(h.a)(r),[t.outputs[a].ampEnvelopes[e]]);for(var i in n.outputs)n.outputs[i].ampEnvelopes[e]||n.newVoice(),r=[].concat(Object(h.a)(r),[n.outputs[i].ampEnvelopes[e]]);return r}},{key:"ampEnvelopes",get:function(){var e=this.outputNodeX,t=this.outputNodeY,n=[];for(var r in e.outputs)n=[].concat(Object(h.a)(n),Object(h.a)(e.outputs[r].ampEnvelopes));for(var a in t.outputs)n=[].concat(Object(h.a)(n),Object(h.a)(t.outputs[a].ampEnvelopes));return n}},{key:"disposeOutputs",value:function(){this.outputNodeX.dispose(),this.outputNodeY.dispose(),this.outputCrossFade.dispose(),this.outputNodeX=void 0,this.outputNodeY=void 0,this.outputCrossFade=void 0}},{key:"connectNoise",value:function(){}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=It(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"triggerAttack",value:function(e,t,n,r,a){var i=this;if(this.loaded||H.a.Master.context.isOffline){t=H.a.Master.context.isOffline?H.a.Master.context._currentTime:H.a.Master.context.currentTime;var o=this.useVoice(e,t);if(o){var s=o.voiceNumber;this.voicesUsed.push(s),this.setEnvelopes(a,e,o),this.triggerAttackEnvelopes(t,n,o.slotNumber),this.scaleByKey(t,e,s),this.carrierOscillator.triggerAttack(e,t,n,o.carrier),o.modulators.filter(function(e,t){return i.oscillatorNodes[t].enabled}).forEach(function(e){e._triggerEnvelopeAttack(t,n)}),this.storeVoiceFrequency(e,s,o)}}}},{key:"triggerAttackRelease",value:function(e,t,n,r,a,i){var o=this;if(this.loaded||H.a.Master.context.isOffline){n=new H.a.Time(n),r>1&&(r=1);var s=this.useVoice(e,n);if(s){var c=s.voiceNumber;this.voicesUsed.push(c),this.setEnvelopes(i,void 0,s),this.triggerAttackReleaseEnvelopes(t,n,r,s.slotNumber),this.scaleByKey(n,e,c),this.carrierOscillator.triggerAttackRelease(e,t,n,r,s.carrier),s.modulators.filter(function(e,t){return o.oscillatorNodes[t].enabled}).forEach(function(e){e._triggerEnvelopeAttack(n,r),e._triggerEnvelopeRelease(n+t)}),this.storeVoiceFrequency(e,c,s),this.lastTranspose=e}}}},{key:"triggerRelease",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H.a.Master.context.currentTime,r=arguments.length>2?arguments[2]:void 0,a=(e&&e.map(function(e){return t.oscillators[0].getNoteFromTranspose(e)}))[0].toFrequency(),i=void 0===e?0:this.frequencyToVoice[a];if(this.voiceToFrequency[i]===a){var o=this.numberToVoice[i];this.setEnvelopes(void 0,void 0,o),this.triggerReleaseEnvelopes(n,o.slotNumber,r),this.voiceToTranspose[i]=e&&e[0],void 0===r&&this.carrierOscillator.triggerRelease(e,o.carrier,n,r),o.modulators.forEach(function(e){e._triggerEnvelopeRelease(n,r)})}}},{key:"isLastVoice",value:function(e){for(var t=this.oscillators[0].voices,n=(this.voiceCounter,0),r=0;r<this.polyphonyParameter.get();r++)if(t[r].envelope.getValueAtTime(e)>0&&n++,n>1)return!1;return!0}},{key:"releaseAll",value:function(){if(!this.disposed){var e,t=qt(this.oscillatorNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;n._voices.forEach(function(e){return e.envelope.release=.01}),n._voices.forEach(function(e){return e.triggerRelease()})}}catch(r){t.e(r)}finally{t.f()}this.clearSlide(),this.releaseSlide(),this.detuneSignal.value=this.detuneParameter.get(!0),this.lastTranspose=0,this.clearVoiceData(!1)}}},{key:"setEnvelopes",value:function(e,t,n){var r=this;this.ampEnvelope.refresh(),this.pitchEnvelope.refresh(),this.filterEnvelope.refresh(),this.hpFilterEnvelope.refresh(),this.carrierOscillator.setEnvelopes(e,this.ampEnvelope,t,n.carrier),this.modulatorOscillators.forEach(function(a,i){return a.setEnvelopes(e,r.ampEnvelope,t,n.modulators[i])})}},{key:"triggerAttackEnvelopes",value:function(e,t,n){this.forSlot(n).forEach(function(n){return n.envelope.triggerAttack(e,t)}),this.filterEnvelope.triggerAttack(e,t),this.hpFilterEnvelope.triggerAttack(e,t),this.pitchEnvelope.envelope.triggerAttack(e,t)}},{key:"triggerReleaseEnvelopes",value:function(e,t,n){this.forSlot(t).forEach(function(t){return t.envelope.triggerRelease(e+1/H.a.Master.context.sampleRate,n)}),this.isLastVoice(e)&&(this.filterEnvelope.triggerRelease(e),this.hpFilterEnvelope.triggerRelease(e),this.pitchEnvelope.envelope.triggerRelease(e))}},{key:"triggerAttackReleaseEnvelopes",value:function(e,t,n,r){this.forSlot(r).forEach(function(r){return r.envelope.triggerAttackRelease(e,t,n)}),this.filterEnvelope.triggerAttackRelease(e,t,n),this.hpFilterEnvelope.triggerAttackRelease(e,t,n),this.pitchEnvelope.envelope.triggerAttackRelease(e,t,n)}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Lt(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setupParameters",value:function(){var e=this;this.polyphonyParameter=new $.b("Polyphony",this,function(t,n){if(e.oscillators[0].voices.length!==n&&e.algorithmParameter){e.deleteAlgorithmRouting(),e.onChangePolyphony(n),e.onPolyNoise(n),e.clearVoiceData();var r=Object(h.a)(e.oscillatorNodes);n<r[0]._voices.length&&r.reverse(),r.forEach(function(e){return e.polyphony=n}),e.currentAlgo=void 0,e.changeAlgorithm(e.algorithmParameter.get(),void 0,void 0,!0),e.connectPitchBend()}},{documentation:["The number of voices in the synth.","When set 1, it becomes monophonic (i.e. only 1 note can be played at a time)"],min:0,max:16,unit:"",defaultValue:1,automatable:!1}),this.registerParameter(this.polyphonyParameter),this.algorithmParameter=new $.b("Algorithm",this,function(t,n){e.changeAlgorithm(n)},{documentation:["Choose the configuration for how the operators connect with one another.","Can get wildly different timbres this way"],min:1,max:8,unit:"",defaultValue:1}),this.registerParameter(this.algorithmParameter),this.mixParameter=new Y.c("Mix",this.outputCrossFade.fade,{documentation:"Controls the mix between the operators set to X and Y.",min:0,max:1,defaultValue:.5}),this.registerParameter(this.mixParameter)}},{key:"getParameters",value:function(){if(!this.parameters)return[];var e=Object(h.a)(this.parameters);for(var t in this.oscillatorNodes)e=e.concat(this.oscillatorNodes[t].getParameters());return(e=e.concat(this.ampEnvelope.parameters).concat(this.pitchEnvelope.parameters).concat(this.hpFilterEnvelope.parameters).concat(this.filterEnvelope.parameters)).filter(function(e){return void 0!==e})}},{key:"getSubDevices",value:function(){var e,t=[{value:this.oscillatorNodes[0],label:"Operator C"},{value:this.oscillatorNodes[1],label:"Operator A"},{value:this.oscillatorNodes[2],label:"Operator B1"},{value:this.oscillatorNodes[3],label:"Operator B2"},{value:this,label:"Mix & Filter"},{value:this.ampEnvelope,label:"Amp Env."},{value:this.oscillatorNodes[1].ampEnvelope,label:"Mod A Env."},{value:this.oscillatorNodes[2].ampEnvelope,label:"Mod B1 Env."},{value:this.oscillatorNodes[3].ampEnvelope,label:"Mod B2 Env."},{value:this.filterEnvelope,label:"Filter Env."},{value:this.pitchEnvelope,label:"Pitch Env."},{value:this.hpfilterEnvelope,label:"HP Filter Env."}],n=_t(this.oscillatorNodes);try{for(n.s();!(e=n.n()).done;)for(var r=e.value,a=0;a<r.formants.length;a++){var i=r.formants[a];t.push({value:i,label:"Formant "+(a+1)+" "+r.name})}}catch(o){n.e(o)}finally{n.f()}return t}},{key:"getSubDeviceIndex",value:function(e){return this.getSubDevices().map(function(e){return e.value}).indexOf(e)}},{key:"getSubDevice",value:function(e){var t=this.getSubDevices()[e];if(t)return t.value}},{key:"findParameter",value:function(e,t){var n=e.envelopeType,r=this.getParameters();n===ue.a?r=this.ampEnvelope.parameters:n===ue.h?r=this.pitchEnvelope.parameters:n===ue.b&&(r=this.filterEnvelope.parameters);var a=r.filter(function(e){return e.name===t});if(0!==a.length)return a[0]}},{key:"filterCutoff",get:function(){return this.filterCutoffParameter.get()},set:function(e){this.filterCutoffParameter.set(e,!0,!0)}},{key:"filterQ",get:function(){return this.filterQParameter.get()},set:function(e){this.filterQParameter.set(e)}},{key:"hpFilterCutoff",get:function(){return this.hpFilterCutoffParameter.get()},set:function(e){this.hpFilterCutoffParameter.set(e)}},{key:"hpFilterQ",get:function(){return this.hpFilterQParameter.get()},set:function(e){this.hpFilterQParameter.set(e)}},{key:"isMonophonic",value:function(){return 1===this.polyphonyParameter.get()}},{key:"refreshParameters",value:function(){this.filterQ=this.filterQ,this.filterCutoff=this.filterCutoff,this.hpFilterCutoff=this.hpFilterCutoff}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=At(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setupFilters",value:function(){this.filter=new d.a.FilterEffect(this.sequencerEngine),this.hpFilter=new d.a.FilterEffect(this.sequencerEngine),this.hpFilter.hipass(),this.filter.connect(this.hpFilter.effectNode),this.filterEnvelope=new le(this.sequencerEngine,this.mixSession,this.context,this.filter.effectNode.frequency,0,1e4),this.filterEnvelope.name="Filter Envelope (LP)",this.filterEnvelope.attackCurve="linear",this.filterEnvelope.decayCurve="linear",this.filterEnvelope.releaseCurve="linear",this.hpFilterEnvelope=new le(this.sequencerEngine,this.mixSession,this.context,this.hpFilter.effectNode.frequency,0,1e4),this.hpFilterEnvelope.name="Filter Envelope (HP)",this.hpFilterEnvelope.attackCurve="linear",this.hpFilterEnvelope.decayCurve="linear",this.hpFilterEnvelope.releaseCurve="linear",this.filter.cutoffParameter.audioParam.input.automationRate="a-rate",this.outputCrossFade.connect(this.filter.effectNode),this.setupFilterParameters()}},{key:"connect",value:function(e){void 0!==e&&this.hpFilter.connect(e)}},{key:"disconnect",value:function(e){this.hpFilter.disconnect(e)}},{key:"setupFilterParameters",value:function(){var e=this;this.filterCutoffParameter=new Y.a("Filter Cutoff",this.filter.effectNode.frequency,function(t,n){e.filter&&(isNaN(n)||(e.filterEnvelope&&(e.filterEnvelope.frequency=n),e.filter&&(e.filter.cutoffFrequency=n),e.oscillators&&e.oscillators.forEach(function(e){return e.cutoffFrequency=n})))},{min:0,max:1e4,unit:"HZ",defaultValue:1e4,constantAutomationRate:!0,documentation:["Controls the frequency at which filtering works at. ","Frequencies above this value will be cut."]}),this.registerParameter(this.filterCutoffParameter,function(e){return e.filter.frequency}),this.filterQParameter=new Y.a("Filter Q",this.filter.effectNode.Q,function(t,n){e.filter&&(e.filter.Q=n)},{min:0,max:9,unit:"",defaultValue:1}),this.registerParameter(this.filterQParameter,function(e){return e.filter.Q}),this.hpFilterCutoffParameter=new Y.a("Filter Cutoff (hi-pass)",this.hpFilter.effectNode.frequency,function(t,n){e.hpFilter&&!isNaN(n)&&(e.hpFilterEnvelope.frequency=n,e.hpFilter.cutoffFrequency=n)},{documentation:["Controls the frequency at which filtering works at. ","Frequencies below this value will be cut."],min:0,max:1e4,unit:"HZ",defaultValue:0,constantAutomationRate:!0}),this.registerParameter(this.hpFilterCutoffParameter),this.hpFilterQParameter=new Y.a("Filter Q (hi-pass)",this.filter.effectNode.Q,function(t,n){e.hpFilter||(e.hpFilter.Q=n)},{min:0,max:9,unit:"",defaultValue:1}),this.registerParameter(this.hpFilterQParameter)}}]),n}(e)},mt,function(e){return function(e){Object(u.a)(n,e);var t=vt(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setupPitchBend",value:function(){this.pitchBendSignal=new H.a.Signal(0),this.pitchBendParameter=new Y.c("pitchBend",this.pitchBendSignal,{min:-200,max:200,defaultValue:0,automationRate:X.a}),this.registerParameter(this.pitchBendParameter),this.connectPitchBend()}},{key:"onPitchBend",value:function(e){this.pitchBendParameter.set(200*e,!1,!0)}},{key:"connectPitchBend",value:function(){var e=this;this.pitchBendSignal.disconnect(),this.detuneSignals.forEach(function(t){return e.pitchBendSignal.connect(t)})}}]),n}(e)},Mt.a,Nt.a,function(e){return function(e){Object(u.a)(n,e);var t=yt(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).currentAlgo=void 0,e.algorithms={1:{A:{feedback:!0,edges:[kt]},B2:{edges:[jt]},B1:{edges:[kt,St]},C:{edges:[Et]}},2:{A:{edges:[kt]},B2:{edges:[jt],feedback:!0},B1:{edges:[St]},C:{edges:[Et]}},3:{A:{edges:[kt,wt,jt],feedback:!0},B2:{edges:[Et]},B1:{edges:[St]},C:{edges:[Et]}},4:{A:{edges:[kt]},B2:{edges:[jt],feedback:!0},B1:{edges:[Ot,St]},C:{edges:[Et]}},5:{A:{edges:[kt,St]},B2:{edges:[jt,Ot]},B1:{edges:[Ot],feedback:!0},C:{edges:[Et]}},6:{A:{edges:[kt,jt],feedback:!0},B2:{edges:[kt,jt]},B1:{edges:[St]},C:{edges:[Et]}},7:{A:{edges:[kt,Et],feedback:!0},B2:{edges:[jt,St]},B1:{edges:[St]},C:{edges:[Et]}},8:{A:{edges:[kt]},B2:{edges:[Et]},B1:{edges:[St],feedback:!0},C:{edges:[Et]}},9:{A:{feedback:!0,edges:[kt]},B2:{edges:[jt,Et]},B1:{edges:[kt,St]},C:{edges:[Et]}}},e}return Object(s.a)(n,[{key:"changeAlgorithm",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.outputNodeX,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.outputNodeY,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e!==this.currentAlgo){var a=this.algorithms[e];for(var i in r||this.deleteAlgorithmRouting(void 0,t,n),a){var o=a[i],s=this.getNodeByName(i,t,n);s.feedback=o.feedback;var c,u=bt(o.edges);try{for(u.s();!(c=u.n()).done;){var l=c.value,f=this.getNodeByName(l,t,n);this.connectNodes(s,f)}}catch(m){u.e(m)}finally{u.f()}if(s.feedback){for(var h in s.voices){var d=s.voices[h];s.connectFeedbackEdge(s.feedbackEdge,d,parseInt(h))}this.feedbackParameter=s.feedbackParameter}}this.adjacencyLists=Object(p.a)({},this.adjacencyLists),this.currentAlgo=e,this.refreshAmpEnvelopes()}}},{key:"deleteAlgorithmRouting",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var n in t||this.oscillatorNodes.forEach(function(t){t.feedback&&t.voices.forEach(function(e,n){return t.feedbackEdge.disconnect(e,n)}),t.feedback=!1,e.loaded&&t.feedbackParameter.set(0,!0,!0)}),this.adjacencyLists)Object(h.a)(this.adjacencyLists[n]).forEach(function(t){return e.deleteEdge(t)});this.currentAlgo=-1}},{key:"getNodeByName",value:function(e,t,n){return e===Et?t:e==St?n:this.oscillatorNodes.find(function(t){return t.name===e})}},{key:"testAlgo",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=1,n=0;case 2:if(!(n<100)){e.next=11;break}return this.algorithmParameter.set(t,!1,!1),e.next=6,Object(m.a)(200);case 6:++t>=9&&(t=1);case 8:n++,e.next=2;break;case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(e)},ut.a,function(e){return function(e){Object(u.a)(n,e);var t=lt(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getModulatedParameters",value:function(){for(var e=[],t=0,n=Array.from(new Set(this.getParameters()));t<n.length;t++){var r=n[t];r.lfos.length+r.envelopes.length>0&&e.push(r)}return e}},{key:"getStats",value:function(){for(var e=0,t=0,n=Array.from(new Set(this.getParameters()));t<n.length;t++){var r=n[t];r.lfos.length,r.envelopes.length,e+=r.lfos.length+r.envelopes.length}return e}},{key:"simplifyPatch",value:function(e){for(var t=this.getModulatedParameters(),n=Math.floor(t.length*e/100),r=0;r<n;r++)t[r].disconnectFromAllModulators()}}]),n}(e)},Ct.a,function(e){return function(e){Object(u.a)(n,e);var t=st(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).noiseSources=[],e}return Object(s.a)(n,[{key:"disposeNoise",value:function(){this.noiseSources.forEach(function(e){return e.dispose()}),this.noiseLevelParameter.dispose(),this.noiseSources=void 0}},{key:"setupNoiseParameters",value:function(){this.noiseLevelParameter=new te.a("Noise Level",this.noiseSources.map(function(e){return e.volume}),{documentation:"Controls the volume for the noise",min:0,max:1,defaultValue:0}),this.registerParameter(this.noiseLevelParameter),this.refreshNoiseParameters()}},{key:"refreshNoiseParameters",value:function(){this.noiseLevelParameter&&(this.noiseLevelParameter.setAudioParams(this.noiseSources.map(function(e){return e.volume})),this.noiseSources.forEach(function(e){return e.start()}))}},{key:"createAndAttachNoise",value:function(){var e=this.newNoiseVoice();this.noiseSources.push(e),this.refreshNoiseParameters()}},{key:"onPolyNoise",value:function(e){if(e<this.noiseSources.length){for(var t=e;e>this.noiseSources.length;)this.noiseSources[e-1].disconnect();this.noiseSources=this.noiseSources.slice(0,t)}else for(;e>this.noiseSources.length;)this.createAndAttachNoise()}},{key:"newNoiseVoice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pink",t=new H.a.Noise(e);return t.volume.value=0,t}}]),n}(e)})(ot)),wn=n(447),En=n(199);var Sn=function(){function e(t,n,r){Object(o.a)(this,e),this.sequencerEngine=t,this.subSequence=n,this.store=t.store,this.lfos=[],this.lfos=function(e,t,n){var r=[];return r.push(new wn.a(e,t,e.mixSession,1,n)),r.push(new wn.a(e,t,e.mixSession,2,n)),r.push(new wn.a(e,t,e.mixSession,3,n)),r.push(new wn.a(e,t,e.mixSession,4,n)),r}(t,this,r),this.currentPattern=0,this.context=r}return Object(s.a)(e,[{key:"switchToPattern",value:function(e,t){return this.currentPattern=t,this.updateRedux(e,t)}},{key:"updateRedux",value:function(e,t){var n=this.getAllPatternLockedParameters(e,t),r=[];for(var a in n){var i=n[a].updateRedux(!0);void 0!==i&&(r[i.id]=i.value)}return r}},{key:"patternLocks",get:function(){var e=this.store.getState().tracks.lfoPatternLocks[this.subSequence.id]||{};return Object(p.a)({},e)}},{key:"deletePattern",value:function(e){var t=this.patternLocks;this.store.dispatch(Object(C.Sc)(this.subSequence.id,Object(En.a)(e,t)))}},{key:"movePatternTo",value:function(e,t){var n=this.patternLocks;this.store.dispatch(Object(C.Sc)(this.subSequence.id,Object(En.b)(e,t,n)))}},{key:"getAllPatternLockedParameters",value:function(e,t){var n=[];return this.lfos.forEach(function(r){return r.lfo.parameters.filter(function(n){return n.hasPatternLockedValues(e,t)}).forEach(function(e){return n.push(e)})}),n}},{key:"newPattern",value:function(e){var t=this,n=e-1;this.getAllPatternLockedParameters().forEach(function(e){return e.newPattern(t.currentPattern,n)});var r=this.patternLocks;r[n]=this.patternLocked,this.store.dispatch(Object(C.Sc)(this.subSequence.id,r))}},{key:"patternLocked",get:function(){return this.patternLocks[this.currentPattern]||!1},set:function(e){var t=this.patternLocks;t[this.currentPattern]=e,this.store.dispatch(Object(C.Sc)(this.subSequence.id,t)),this.updateRedux()}},{key:"togglePatternLocked",value:function(){this.patternLocked=!this.patternLocked}},{key:"start",value:function(e){for(var t in this.lfos){this.lfos[t].start(e)}}},{key:"stop",value:function(){for(var e in this.lfos){this.lfos[e].stop()}}},{key:"onBPMUpdated",value:function(){this.lfos.forEach(function(e){return e.lfo.onBPMUpdated()})}}]),e}(),Pn=new(function(){function e(){Object(o.a)(this,e),this.chains=[]}return Object(s.a)(e,[{key:"useChain",value:function(e,t){var n=void 0;this.chains.length>0&&!t.isOffline?n=this.chains.pop():n=[new H.a.Scale(e.min,e.max),new H.a.Gain(1)];return n[0].min=e.min,n[0].max=e.max,n}},{key:"disposeChain",value:function(e){e.forEach(function(e){return e.dispose()})}},{key:"releaseChain",value:function(e,t){if(t.isOffline)this.disposeChain(e);else{if(this.chains.length>=50){var n=this.chains[0];this.disposeChain(n),this.chains=this.chains.slice(1)}this.chains.push(e)}}}]),e}()),xn=n(820),Tn=n(104);function Cn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}window.offsetTime=.009;var Nn=function(e){Object(u.a)(n,e);var t=Cn(n);function n(e,r,a,i){var s;return Object(o.a)(this,n),(s=t.call(this,e,r,a,i)).disable=!1,s.id=Object(j.uuid)(),s.lastValue=void 0,s.lastStep=void 0,s.envelope=new H.a.ScaledEnvelope,s.meter=new H.a.Analyser("waveform",32),s.envelope.connect(s.meter),s.envelope.min=0,s.envelope.max=1,s.parameters=[],s.setupParameters(),s.savedFrequency=void 0,s.parameterIdToVoiceToNode={},s}return Object(s.a)(n,[{key:"name",get:function(){return"Env "+this.number}},{key:"getType",value:function(){return Tn.a}},{key:"dispose",value:function(){for(var e in this.envelope.dispose(),this.meter.dispose(),this.parameterIdToVoiceToNode){var t=this.parameterIdToVoiceToNode[e];for(var n in t){t[n].filter(function(e){return e.dispose&&e.input}).forEach(function(e){return e.dispose()})}}this.parameterIdToVoiceToNode=void 0,this.envelope=void 0,this.meter=void 0,this.parameters=void 0}},{key:"getValue",value:function(e){var t=this.lastTriggerAttackRelease;if(void 0===t)return 0;var n=void 0!==t.duration,r=H.a.Master.context.isOffline?H.a.Master.context._currentTime:H.a.Master.context.currentTime,a=t.time,i=r-a,o=t.time+t.duration;if(r>=a&&(!n||r<=o))return i<=this.attack/1e3?i/(this.attack/1e3):i<=(this.attack+this.decay)/1e3?1+(i-this.attack/1e3)/(this.decay/1e3)*(this.sustain-1):this.sustain;if(r>=o&&r<=o+this.release/1e3){var s=(r-o)/(this.release/1e3);return this.sustain-this.sustain*s}return 0}},{key:"getChain",value:function(e,t){return[].concat(Object(h.a)(Pn.useChain(e,this.sequencerEngine)),[t])}},{key:"releaseChain",value:function(e){Pn.releaseChain(e.slice(0,e.length-1),this.sequencerEngine)}},{key:"getModulator",value:function(){return this.envelope}},{key:"triggerAttack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.disabled||(e=e||(H.a.Master.context.isOffline?H.a.Master.context._currentTime:H.a.Master.context.currentTime),this.envelope.triggerAttack(e,t),this.lastTriggerAttackRelease={time:e,velocity:t})}},{key:"triggerAttackRelease",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;this.disabled||(t=Math.max(t,0),isNaN(e)||isNaN(t)||isNaN(n)||(this.envelope.triggerAttackRelease(e,t,n),this.lastTriggerAttackRelease={duration:e,time:t,velocity:n}))}},{key:"triggerRelease",value:function(e){this.disabled||(this.envelope.triggerRelease(e),e=e||(H.a.Master.context.isOffline?H.a.Master.context._currentTime:H.a.Master.context.currentTime),this.lastTriggerAttackRelease&&(this.lastTriggerAttackRelease=Object(p.a)({},this.lastTriggerAttackRelease,{duration:e-this.lastTriggerAttackRelease.time})))}},{key:"setupParameters",value:function(){this.attackParameter=new $.a("Attack",this.envelope,function(e,t){e&&(e.attack=(t+1e-6)/1e3)},{min:0,max:1e4,unit:"ms",defaultValue:15}),this.registerParameter(this.attackParameter),this.decayParameter=new $.a("Decay",this.envelope,function(e,t){e&&(e.decay=(t+1e-5)/1e3)},{min:0,max:1e4,unit:"ms",defaultValue:1e3}),this.registerParameter(this.decayParameter),this.sustainParameter=new $.a("Sustain",this.envelope,function(e,t){e&&(e.sustain=t)},{min:0,max:1,unit:"",defaultValue:.9}),this.registerParameter(this.sustainParameter),this.releaseParameter=new $.a("Release",this.envelope,function(e,t){e&&(e.release=(t+1e-6)/1e3)},{min:0,max:1e4,unit:"ms",defaultValue:150}),this.registerParameter(this.releaseParameter),this.attackCurveParameter=new $.a("Attack Curve",this.envelope,function(e,t){e&&(e.attackCurve=t)},{min:0,max:1e4,unit:"",defaultValue:"linear"}),this.registerParameter(this.attackCurveParameter),this.decayCurveParameter=new $.a("Decay Curve",this.envelope,function(e,t){e&&(e.decayCurve=t)},{min:0,max:1e4,unit:"",defaultValue:"linear"}),this.registerParameter(this.decayCurveParameter),this.releaseCurveParameter=new $.a("Release Curve",this.envelope,function(e,t){e&&(e.releaseCurve=t)},{min:0,max:1e4,unit:"",defaultValue:"linear"}),this.registerParameter(this.releaseCurveParameter)}},{key:"refresh",value:function(){}},{key:"attack",get:function(){return this.attackParameter.get()},set:function(e){this.attackParameter.set(e)}},{key:"decay",get:function(){return this.decayParameter.get()},set:function(e){this.decayParameter.set(e)}},{key:"sustain",get:function(){return this.sustainParameter.get()},set:function(e){this.sustainParameter.set(e)}},{key:"release",get:function(){return this.releaseParameter.get()},set:function(e){this.releaseParameter.set(e)}},{key:"attackCurve",get:function(){return this.attackCurveParameter.get()},set:function(e){this.attackCurveParameter.set(e)}},{key:"decayCurve",get:function(){return this.decayCurveParameter.get()},set:function(e){this.decayCurveParameter.set(e)}},{key:"releaseCurve",get:function(){return this.releaseCurveParameter.get()},set:function(e){this.releaseCurveParameter.set(e)}},{key:"registerParameter",value:function(e){e.setStore(this.store),e.setMixSession(this.mixSession),e.setContext(this.context),e.setTrack(this.context.track),this.parameters.push(e)}},{key:"getJson",value:function(){var e={id:this.id,attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release,attackCurve:this.attackCurve,decayCurve:this.decayCurve,releaseCurve:this.releaseCurve};return e=Object(Q.b)(e,"attackParameter",this.attackParameter),e=Object(Q.b)(e,"decayParameter",this.decayParameter),e=Object(Q.b)(e,"sustainParameter",this.sustainParameter),e=Object(Q.b)(e,"releaseParameter",this.releaseParameter),e=Object(Q.b)(e,"attackCurveParameter",this.attackCurveParameter),e=Object(Q.b)(e,"decayCurveParameter",this.decayCurveParameter),e=Object(Q.b)(e,"releaseCurveParameter",this.releaseCurveParameter)}},{key:"fromJson",value:function(e){this.disconnectAllModulators();var t={};e.id&&(this.id=e.id),Object(ne.a)(this.attackParameter,e.attack,t),Object(ne.a)(this.decayParameter,e.decay,t),Object(ne.a)(this.sustainParameter,e.sustain,t),Object(ne.a)(this.releaseParameter,e.release,t),e.attackCurve&&Object(ne.a)(this.attackCurveParameter,e.attackCurve,t),e.decayCurve&&Object(ne.a)(this.decayCurveParameter,e.decayCurve,t),e.releaseCurve&&Object(ne.a)(this.releaseCurveParameter,e.releaseCurve,t),t=Object(p.a)({},t,Object(Q.a)(e,"attackParameter",this.attackParameter,this.sequencerEngine,!1,!0),Object(Q.a)(e,"decayParameter",this.decayParameter,this.sequencerEngine,!1,!0),Object(Q.a)(e,"sustainParameter",this.sustainParameter,this.sequencerEngine,!1,!0),Object(Q.a)(e,"releaseParameter",this.releaseParameter,this.sequencerEngine,!1,!0),Object(Q.a)(e,"attackCurveParameter",this.attackCurveParameter,this.sequencerEngine,!1,!0),Object(Q.a)(e,"decayCurveParameter",this.decayCurveParameter,this.sequencerEngine,!1,!0),Object(Q.a)(e,"releaseCurveParameter",this.releaseCurveParameter,this.sequencerEngine,!1,!0))}},{key:"getScaleFromChain",value:function(e){return e[0]}},{key:"getDepthFromChain",value:function(e){return e[1]}},{key:"mate",value:function(e,t){this.mateParameter(this.attackParameter,e.attackParameter,t),this.mateParameter(this.decayParameter,e.decayParameter,t),this.mateParameter(this.sustainParameter,e.sustainParameter,t),this.mateParameter(this.releaseParameter,e.releaseParameter,t)}},{key:"mateParameter",value:function(e,t,n){Object(W.b)(this.sequencerEngine,e,t,n)}}]),n}(xn.a),Rn=function(){function e(t,n,r,a){Object(o.a)(this,e),this.store=t.store,this.sequencerEngine=t,this.number=a,this.envelope=new Nn(t,n,(new L.a).forEnvelopeTrack(this,r),a)}return Object(s.a)(e,[{key:"name",get:function(){return"Envelope "+this.number}},{key:"getJson",value:function(){return this.envelope.getJson()}}]),e}();var Mn=function(){function e(t,n){Object(o.a)(this,e),this.sequencerEngine=t,this.subSequence=n,this.store=t.store,this.envelopes=function(e,t){var n=[];return n.push(new Rn(e,e.mixSession,t,1)),n.push(new Rn(e,e.mixSession,t,2)),n.push(new Rn(e,e.mixSession,t,3)),n.push(new Rn(e,e.mixSession,t,4)),n}(t,this),this.currentPattern=0}return Object(s.a)(e,[{key:"switchToPattern",value:function(e,t){return this.currentPattern=t,this.updateRedux(e,t)}},{key:"updateRedux",value:function(e,t){var n=this.getAllPatternLockedParameters(e,t),r=[];for(var a in n){var i=n[a].updateRedux(!0);void 0!==i&&(r[i.id]=i.value)}return r}},{key:"deletePattern",value:function(e){this.store.dispatch(Object(C.dc)(this.subSequence.id,Object(En.a)(e,this.patternLocks)))}},{key:"patternLocks",get:function(){var e=this.store.getState().tracks.envelopePatternLocks[this.subSequence.id]||{};return Object(p.a)({},e)}},{key:"movePatternTo",value:function(e,t){this.store.dispatch(Object(C.dc)(this.subSequence.id,Object(En.b)(e,t,this.patternLocks)))}},{key:"getAllPatternLockedParameters",value:function(e,t){var n=[];return this.envelopes.forEach(function(r){return r.envelope.parameters.filter(function(n){return n.hasPatternLockedValues(e,t)}).forEach(function(e){return n.push(e)})}),n}},{key:"newPattern",value:function(e){var t=this,n=e-1;this.getAllPatternLockedParameters().forEach(function(e){return e.newPattern(t.currentPattern,n)});var r=this.patternLocks;r[n]=this.patternLocked,this.store.dispatch(Object(C.dc)(this.subSequence.id,r))}},{key:"patternLocked",get:function(){return this.patternLocks[this.currentPattern]||!1},set:function(e){var t=this.patternLocks;t[this.currentPattern]=e,this.store.dispatch(Object(C.dc)(this.subSequence.id,t)),this.updateRedux()}},{key:"togglePatternLocked",value:function(){this.patternLocked=!this.patternLocked}}]),e}();function An(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function qn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Dn=function(e){Object(u.a)(n,e);var t=qn(n);function n(e,r,a,i,s,u){var l,f=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return Object(o.a)(this,n),(l=t.call(this,e,r,a,i,s,u,!1)).initModulators(),f&&l.setInstrument(new jn(r,a,(new L.a).forTrack(Object(c.a)(l)),Object(c.a)(l))),l}return Object(s.a)(n,[{key:"getInstrumentType",value:function(){return z.f}},{key:"createNewInstrument",value:function(){this.instrument=void 0,this.setInstrument(new jn(this.sequencerEngine,this.mixSession,(new L.a).forTrack(this),this))}},{key:"getAllParameters",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=Object(Z.a)(Object(f.a)(n.prototype),"getAllParameters",this).call(this,e);return[].concat(Object(h.a)(t),Object(h.a)(this.lfosTrack.lfos.flatMap(function(e){return e.lfo.parameters})),Object(h.a)(this.envelopesTrack.envelopes.flatMap(function(e){return e.envelope.parameters})))}},{key:"getCopy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sequencerEngine,r=arguments.length>2?arguments[2]:void 0;return Object(Z.a)(Object(f.a)(n.prototype),"getCopy",this).call(this,function(e,t,r,a,i,o){return new n(e,t,r,a,i,o,!1)},t,r)}}]),n}(function(e){Object(u.a)(n,e);var t=An(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"initModulators",value:function(){this.lfosTrack=new Sn(this.sequencerEngine,this.subSequence,(new L.a).forTrack(this)),this.envelopesTrack=new Mn(this.sequencerEngine,this.subSequence)}},{key:"hasModulators",get:function(){return!0}}]),n}(nt)),In=n(30),_n=function(){function e(t,n){if(Object(o.a)(this,e),this.track=t,this.instrumentRack=n,this.track.instrumentRack=this.instrumentRack,this.sequencerEngine=t.sequencerEngine,this.store=this.sequencerEngine.store,this.parameters=[],this.volumeParameter=new Y.c("volume",this.track.volumeNode.volume,{min:0,max:1,unit:"db",defaultValue:0}),this.registerParameter(this.volumeParameter),this.track.effectsChains[0].parameterContext=(new L.a).forTrack(n),this.track.instrument){var r=this.track.instrument.parameters;for(var a in r)r[a].setContext(r[a].context.forSubDevice(r[a].track).forTrack(n))}this.track.instrumentRack=n}return Object(s.a)(e,[{key:"dispose",value:function(){this.track.dispose(void 0,this.instrumentRack.isFrozen)}},{key:"effectsChains",get:function(){return this.track.effectsChains}},{key:"presetName",get:function(){return this.track.presetName}},{key:"getName",value:function(){return this.track.getName()}},{key:"trackNumber",get:function(){return this.track.trackNumber}},{key:"registerParameter",value:function(e){e.setStore(this.store),e.setContext((new L.a).forTrack(this.instrumentRack)),this.parameters.push(e)}},{key:"getJson",value:function(e){var t={track:this.track.getJson(e),effectsChains:this.track.effectsChains.map(function(e){return e.getJson()}),midiEffects:this.track.midiEffects.getJson(),volume:this.volumeParameter.get(),sendVolumes:this.track.getSendNodes().map(function(e){return e.volume.value})};return t=Object(Q.b)(t,"volumeParameter",this.volumeParameter)}},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.track.fromJson(t.track,!1);case 2:if(this.track.effectsChains[0].clear(),this.track.effectsChains[0].fromJson(t.effectsChains[0],this.sequencerEngine.tracks,n),this.track.midiEffects.fromJson(t.midiEffects),this.volumeParameter.set(t.volume),t.sendVolumes)for(r=this.track.getSendNodes(),i=0;i<Math.min(t.sendVolumes.length,r.length);i++)r[i].volume.value=t.sendVolumes[i];Object(Q.a)(t,"volumeParameter",this.volumeParameter,this.sequencerEngine);case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getCopy",value:function(){var t=Object(i.a)(a.a.mark(function t(){var n,r,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.track.getCopy();case 2:return n=t.sent,r=new e(n,this.instrumentRack),i=this.getJson(),t.next=7,r.fromJson(i);case 7:return t.abrupt("return",r);case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"getAllParameters",value:function(){return[].concat(Object(h.a)(this.parameters),Object(h.a)(this.track.getAllParameters()))}}]),e}();function Fn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ln(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ln(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Ln(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var zn=In.a.presets,Vn=function(e){Object(u.a)(n,e);var t=Bn(n);function n(e,r,a,i,s,u){var l;!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return Object(o.a)(this,n),(l=t.call(this,e,r,a,i,s,u)).setupEffects(),l.tracks=[],l.name="Instrument Rack",l.preset=new Qe.a,l.preset.track=Object(c.a)(l),l}return Object(s.a)(n,[{key:"addPreset",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.title,e.next=3,zn.getPresetData(t);case 3:return r=e.sent,e.next=6,this.sequencerEngine.loadTrackPreset(r,void 0,!0,!1,n,void 0,t);case 6:return(i=e.sent).presetName=n,o=new _n(i,this),setTimeout(function(){i.loadLostParameters()},[750]),e.abrupt("return",this.addInstrument(o));case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addSample",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=this.addInstrumentType(z.g)).track.sample=t,e.next=4,r.track.instrument.newSample(0,t,n);case 4:return n&&(r.track.samplesStream=n,r.track.samplesStream.initBuffers()),r.track.presetName=t.name,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSubDevices",value:function(){return this.tracks.map(function(e){return{value:e,label:e.presetName||e.getName()}})}},{key:"getSubDeviceIndex",value:function(e){return this.tracks.indexOf(e)}},{key:"getSubDevice",value:function(e){return this.tracks[e]}},{key:"getSamplesStream",value:function(){var e=this.getSelectedTrack();if(e)return e.track.samplesStream}},{key:"getSelectedTrack",value:function(){return this.sequencerEngine.state.tracks.selectedRackSubTrack[this.id]}},{key:"loadTrackInfo",value:function(e,t){var n=this.getSelectedTrack();n?(n.track.loadTrackInfo(e,t),this.tracks=Object(h.a)(this.tracks)):(this.addSample(t),this.tracks=Object(h.a)(this.tracks)),this.updateSteps()}},{key:"addInstrumentType",value:function(e){var t=pr(this.sequencerEngine,"INSTRUMENT",e);t.setSends(this.sequencerEngine.sends),t.effectsChains[0].clear();var n=new _n(t,this);return this.addInstrument(n)}},{key:"getName",value:function(){return"Instrument Rack"}},{key:"getTrackType",value:function(){return A.c}},{key:"getInstrumentType",value:function(){return A.c}},{key:"instrument",get:function(){return this}},{key:"inputNode",get:function(){return this.gainNode}},{key:"addInstrument",value:function(e){var t=e.track;return t.trackNumber=this.tracks.length,this.tracks=[].concat(Object(h.a)(this.tracks),[e]),t.muteableNode.connect(this.gainNode),t.group=this,e}},{key:"deleteInstrument",value:function(e){var t=this.tracks.indexOf(e);-1!==t&&(this.tracks.splice(t,1),e.track.dispose())}},{key:"dispose",value:function(){this.tracks.forEach(function(e){return e.dispose()}),this.tracks=void 0,Object(Z.a)(Object(f.a)(n.prototype),"dispose",this).call(this,!1)}},{key:"liveTrigger",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isFrozen||this.tracks.forEach(function(t){return t.track.midiEffects.liveInputTrigger(e)})}},{key:"releaseAll",value:function(e){this.isFrozen||this.tracks.forEach(function(t){return t.track.releaseAll(e)})}},{key:"liveTriggerRelease",value:function(e,t){this.isFrozen||this.tracks.forEach(function(n){return n.track.midiEffects.liveInputRelease(e,t)})}},{key:"trigger",value:function(e,t,r){this.isFrozen?Object(Z.a)(Object(f.a)(n.prototype),"trigger",this).call(this,e,t,r):(this.tracks.forEach(function(n){n.track.midiEffects.input(e,t,r)}),this.onStepEnded(t,r))}},{key:"triggerSamples",value:function(e,t){this.isFrozen||this.tracks.forEach(function(n){return n.track.triggerSamples(e,t)})}},{key:"triggerSlice",value:function(e){this.isFrozen||this.tracks.forEach(function(t){return t.track.triggerSlice(e)})}},{key:"triggerSample",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isFrozen||this.tracks.forEach(function(r){return r.track.triggerSample(e,t,n)})}},{key:"triggerRelease",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isFrozen||this.tracks.forEach(function(n){return n.track.triggerRelease(e,t)})}},{key:"getJson",value:function(e){var t=Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this,e);return t.tracks=this.tracks.map(function(t){return t.getJson(e)}),t}},{key:"onBPMUpdated",value:function(){for(var e in this.effectsChains.forEach(function(e){return e.onBPMUpdated()}),this.tracks)for(var t in this.tracks[e].effectsChains)this.tracks[e].effectsChains[t].onBPMUpdated()}},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var r,i,o,s,c,u,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._loaded){e.next=2;break}return e.abrupt("return",{});case 2:Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,t),this.store.dispatch(Object(C.Xg)(this.subSequence.id,this.trackNumber,!0)),r={},e.t0=a.a.keys(t.tracks);case 6:if((e.t1=e.t0()).done){e.next=22;break}return i=e.t1.value,o=t.tracks[i].track,s=o.type,c=o.instrumentType,(u=pr(this.sequencerEngine,s,c)).setSends(this.sequencerEngine.sends),l=new _n(u,this),e.t2=p.a,e.t3={},e.t4=r,e.next=17,l.fromJson(t.tracks[i],!1);case 17:e.t5=e.sent,r=(0,e.t2)(e.t3,e.t4,e.t5),this.addInstrument(l),e.next=6;break;case 22:return this.store.dispatch(Object(C.Xg)(this.subSequence.id,this.trackNumber,!1)),this._loaded=!0,e.abrupt("return",r);case 25:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onNewStep",value:function(e){this.isFrozen?Object(Z.a)(Object(f.a)(n.prototype),"onNewStep",this).call(this):(Object(Z.a)(Object(f.a)(n.prototype),"onNewStep",this).call(this),this.tracks.forEach(function(t){return t.track.onNewStep(e)}))}},{key:"onStepEnded",value:function(e,t){var r=this;if(this.isFrozen)Object(Z.a)(Object(f.a)(n.prototype),"onNewStep",this).call(this);else{var a=function(n){var a=r.tracks[n].track;a.midiEffects.output(e,t,t).forEach(function(e){return a.trigger(e.stepData,e.time,t)})};for(var i in this.tracks)a(i)}}},{key:"start",value:function(){Object(Z.a)(Object(f.a)(n.prototype),"start",this).call(this),this.isFrozen||this.tracks.forEach(function(e){return e.track.start()})}},{key:"solo",value:function(e){Object(Z.a)(Object(f.a)(n.prototype),"solo",this).call(this,e),this.tracks.forEach(function(t){return t.track.solo(e,void 0,!1)})}},{key:"getCopy",value:function(e,t){var r=this,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Object(Z.a)(Object(f.a)(n.prototype),"getCopy",this).call(this,function(e,t,r,a,i,o){return new n(e,t,r,a,i,o)},t,a),o=function(e){var n=r.tracks[e].track,o=n.getCopy(void 0,t,a),s=new _n(o,i);o.effectsChains[0].dispose(),o.effectsChains=n.effectsChains.map(function(e){return e.getCopy(o,t,a)}),o.effectsChains[0].updateEffects(),s.volumeParameter.copyFrom(r.tracks[e].volumeParameter),i.addInstrument(s)};for(var s in this.tracks)o(s);return i}},{key:"getAllParameters",value:function(){var e=Object(Z.a)(Object(f.a)(n.prototype),"getAllParameters",this).call(this);if(this.isFrozen)return e;for(var t in this.tracks)e=[].concat(Object(h.a)(e),Object(h.a)(this.tracks[t].getAllParameters()));return e}},{key:"makePublicIfNeeded",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=a.a.keys(this.tracks);case 1:if((e.t1=e.t0()).done){e.next=7;break}return t=e.t1.value,e.next=5,this.tracks[t].track.makePublicIfNeeded();case 5:e.next=1;break;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"unfreezeInstrument",value:function(){var e,t=0,n=Fn((arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.frozenJson).trackParameters.tracks);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.tracks[t].track.createNewInstrument(),this.tracks[t].track.instrument.fromJson(r.track.instrument),t++}}catch(a){n.e(a)}finally{n.f()}}}]),n}(Ke);function Hn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Un=function(e){Object(u.a)(n,e);var t=Hn(n);function n(e,r,a,i,s){var u;return Object(o.a)(this,n),(u=t.call(this,e,r,a,i,s,!0)).parameters=[],u.onParameter=new $.a("on",Object(c.a)(u),function(e,t){return[]},{min:!1,max:!0,unit:"",defaultValue:!1}),u.registerParameter(u.onParameter),u.loopParameter=new $.a("loop",Object(c.a)(u),function(e,t){return[]},{min:!1,max:!0,unit:"",defaultValue:!1}),u.registerParameter(u.loopParameter),u.loadFromJson(s),u.startTime=void 0,u.endTime=void 0,u.samplesStream=new ke.a(r,e.sequencerEngine),u.isSimple=!0,u}return Object(s.a)(n,[{key:"gainNode",get:function(){return this.sampler.output}},{key:"auditionSound",value:function(e){this.sample=e,this.audioBuffer=e.audioBuffer,this.baseBuffer=new H.a.Buffer(e.audioBuffer),this.sampler._buffers._buffers[48]=this.baseBuffer,this.slice(0,0,this.getDuration()),this.registerParameter(this.volumeParameter)}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.samplerData,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sliceData,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(Z.a)(Object(f.a)(n.prototype),"init",this).call(this,e,t,r),this.sampler=new H.a.Sampler({C3:this.baseBuffer},{curve:"linear"}),this.reversedBuffer=new H.a.Buffer,1===this.baseBuffer.numberOfChannels?this.reversedBuffer.fromArray(this.baseBuffer.getChannelData(0)):this.reversedBuffer.fromArray([this.baseBuffer.getChannelData(0),this.baseBuffer.getChannelData(1)]),this.reversedBuffer.reverse=!0,this.reversedSampler=new H.a.Sampler({C3:this.reversedBuffer},{curve:"linear"}),this.volumeParameter=new Y.c("volume",this.sampler.output.gain,{min:0,max:1,defaultValue:1}),this.registerParameter(this.volumeParameter),this}},{key:"dispose",value:function(){this.sample.dispose(),this.sampler.dispose(),this.baseBuffer.dispose(),this.reversedBuffer.dispose(),this.reversedSampler.dispose(),this.slices=[],this.detuneSignal.dispose(),this.pitchEnvelopes.forEach(function(e){return e.dispose()}),this.sample=void 0,this.sampler=void 0,this.baseBuffer=void 0,this.pitchEnvelopes=void 0,this.detuneSignal=void 0}},{key:"isDisposed",value:function(){return void 0===this.sampler}},{key:"getSlice",value:function(){var e=this;return{buffer:this.baseBuffer,startTime:this.startTime,endTime:this.endTime,getDuration:function(){return e.endTime-e.startTime}}}},{key:"get",value:function(){return this.sampler}},{key:"newSlice",value:function(e,t){return this.startTime=e,this.endTime=t,this.slices.push(new Jn(this.baseBuffer,e,t)),this.sliceData.push({startTime:e,endTime:t}),this.slice(this.slices.length-1,e,t,!0),this.slices[this.slices.length-1]}},{key:"slice",value:function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var r=this.slices[e];n=void 0==n?this.getDuration():n,r.startTime=t,r.endTime=n;this.alpha;this.sliceData[e]={startTime:t,endTime:n},this.startTime=t,this.endTime=n,this.updateSlicesState()}},{key:"loadFromJson",value:function(e){this.onParameter.set(void 0===e.on||e.on),Object(Q.a)(e,"onParameter",this.onParameter),this.loop=e.loop||!1,Object(Q.a)(e,"loopParameter",this.loopParameter),this.detune=e.detune||0,Object(Q.a)(e,"detuneParameter",this.detuneParameter)}},{key:"detune",get:function(){return this.detuneParameter.get()},set:function(e){this.detuneParameter.set(e)}},{key:"on",get:function(){return this.onParameter.get()},set:function(e){this.onParameter.set(e)}},{key:"loop",get:function(){return this.loopParameter.get()},set:function(e){this.loopParameter.set(e)}},{key:"getJson",value:function(){var e=Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{on:this.onParameter.get(),loop:this.loop,detune:this.detune});return e=Object(Q.b)(e,"onParameter",this.onParameter),e=Object(Q.b)(e,"loopParameter",this.loopParameter),e=Object(Q.b)(e,"detuneParameter",this.detuneParameter)}},{key:"triggerAttack",value:function(){var e=Object(i.a)(a.a.mark(function e(t,r,i,o,s,c){var u,l,h,p,d,m,v,b=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=b.length>6&&void 0!==b[6]&&b[6],t=this.getNoteFromTranspose(t),l=u?this.reversedSampler:this.get(0),h=o.start,h=this.convertToStartTime(0,h),h+=this.startTime,l.loop=this.loop,p=this.getLoopPoints(o),d=p.loopStart,m=p.loopEnd,h=d,l.loopStart=d,l.loopEnd=m,v=[],s&&v.push(s),this.triggerWaveformAnimation(r,void 0,0,0,h),e.next=16,Object(Z.a)(Object(f.a)(n.prototype),"triggerAttack",this).call(this,l,t,r,i,v,h,c,u);case 16:case"end":return e.stop()}},e,this)}));return function(t,n,r,a,i,o){return e.apply(this,arguments)}}()},{key:"triggerAttackRelease",value:function(){var e=Object(i.a)(a.a.mark(function e(t,r,i,o,s,c,u){var l,h,p,d,m,v,b,g,y=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=y.length>7&&void 0!==y[7]?y[7]:0,h=y.length>8&&void 0!==y[8]&&y[8],t=this.getNoteFromTranspose(t),p=s.start,p=this.convertToStartTime(0,p),p+=this.startTime,(d=h?this.reversedSampler:this.get(0)).loop=this.loop,m=this.getLoopPoints(s),v=m.loopStart,b=m.loopEnd,p=v,p+=this.convertToStartTime(0,l),d.loopStart=v,d.loopEnd=b,this.triggerWaveformAnimation(i,r,0,0,p),g=[],c&&g.push(c),e.next=18,Object(Z.a)(Object(f.a)(n.prototype),"triggerAttackRelease",this).call(this,d,t,r,i,o,g,p,u,h);case 18:case"end":return e.stop()}},e,this)}));return function(t,n,r,a,i,o,s){return e.apply(this,arguments)}}()},{key:"triggerRelease",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.triggerReleaseWaveformAnimation(),e=e.map(function(e){return t.getNoteFromTranspose(e)}),(n?this.reversedSampler:this.get(0)).triggerRelease(e,H.a.Master.context.currentTime)}},{key:"getLoopPoints",value:function(e){var t=e.loopStart,n=e.loopLength,r=(t=this.startTime+this.getDuration()*(t/100))+this.getDuration()*(n/100);return{loopStart:t,loopEnd:Math.min(r,this.endTime)}}},{key:"setLoopPoints",value:function(e){var t=this.getLoopPoints(e),n=t.loopStart,r=t.loopEnd;for(var a in this.sampler._activeSources){this.sampler._activeSources[a].forEach(function(e){e.loopStart=n,e.loopEnd=r})}}}]),n}(Ne.a),Jn=function(){function e(t,n,r){Object(o.a)(this,e),this.buffer=t,this.originalBuffer=t,this.startTime=n,this.endTime=r}return Object(s.a)(e,[{key:"getCopy",value:function(){return new e(this.buffer,this.startTime,this.endTime)}},{key:"getJson",value:function(){return{buffer:this.buffer,startTime:this.startTime,endTime:this.endTime}}},{key:"dispose",value:function(){}}]),e}(),Gn=Un;var Wn=function(){function e(t){Object(o.a)(this,e),this.input=this.output=new H.a.Gain(1)}return Object(s.a)(e,[{key:"loop",set:function(e){e&&void 0===this.lfo?(this.lfo=new H.a.LFO({type:"triangle",phase:90,min:.7,max:1}),this.lfo.connect(this.input.gain)):e||void 0===this.lfo||(this.lfo.dispose(),this.lfo=void 0)}},{key:"smooth",set:function(e){this.lfo&&(this.lfo.min=e)}},{key:"restart",value:function(e){this.lfo&&(this.lfo.stop(e),this.lfo.start(e))}},{key:"onTick",value:function(e){}},{key:"trigger",value:function(e,t,n){var r=t.loopLengthSeconds;if(void 0!==this.lfo&&!(r<=0)){var a=H.a.Frequency(r,"s").transpose(n);isNaN(a)||void 0===a||(this.lfo.frequency.value=a),this.restart(e)}}}]),e}(),Kn=3,Xn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;arguments.length>1&&arguments[1];Object(o.a)(this,e),this.outputNode=new H.a.Gain(1),this.voiceNumber=t,this.ampEnvelope=new H.a.AmplitudeEnvelope(10,10,1,100),this.ampLFO=new Wn,this.ampEnvelope.connect(this.ampLFO.input),this.ampLFO.output.connect(this.outputNode),this.crossFade=new H.a.CrossFade(0),this.crossFade.connect(this.ampEnvelope),this.ampEnvelope.releaseCurve="linear",this.ampEnvelope.attackCurve="linear",this.ampEnvelope.decayCurve="linear",this.samplerToTriggers={},this.samplerToTransposes={},this.idToSampler={},this.samplerLimit=Kn}return Object(s.a)(e,[{key:"clear",value:function(e){this.samplerToTriggers={},this.idToSampler={}}},{key:"connect",value:function(e){this.outputNode.connect(e)}},{key:"dispose",value:function(){this.outputNode.dispose(),this.ampEnvelope.dispose(),this.outputNode=void 0,this.ampEnvelope=void 0,this.samplerToTriggers=void 0}},{key:"useSampler",value:function(e,t,n,r){t||(t=H.a.Master.context.currentTime),void 0!==this.samplerToTriggers[e.id]&&void 0!==this.samplerToTriggers[e.id][n]&&0!==this.samplerToTriggers[e.id][n]||(this.samplerToTriggers[e.id]={},this.samplerToTriggers[e.id][n]=0),this.samplerToTriggers[e.id][n]++,this.idToSampler[e.id]=e,this.ampLFO.trigger(t,r,n+e.transpose),this.tooManyTriggers()>0&&this.releaseOldestTrigger(e,0,t)}},{key:"onVoiceRelease",value:function(e,t){this.samplerToTriggers[e.id]&&delete this.samplerToTriggers[e.id][t]}},{key:"disconnectSampler",value:function(e,t){return void 0===this.samplerToTriggers[e.id]||void 0===this.samplerToTriggers[e.id][t]||0===this.samplerToTriggers[e.id][t]&&(delete this.samplerToTriggers[e.id][t],!0)}},{key:"isUsed",value:function(){return Object.keys(this.samplerToTriggers).length>0}},{key:"isUsingSampler",value:function(e){return void 0!==this.samplerToTriggers[e.id]&&Object.keys(this.samplerToTriggers[e.id]).length>0}},{key:"totalTriggers",get:function(){var e=0;for(var t in this.samplerToTriggers){var n=this.samplerToTriggers[t];for(var r in n)e+=n[r]}return e}},{key:"tooManyTriggers",value:function(){return this.totalTriggers-Kn}},{key:"getFromMap",value:function(e,t){return Object.keys(e).filter(function(t){return e[t]&&e[t].length>0})[t]}},{key:"releaseOldestTrigger",value:function(e,t,n){for(var r in void 0===n?n=H.a.Master.context.currentTime:(n-=.005)<0&&(n=0),this.idToSampler){this.idToSampler[r];var a=this.idToSampler[r].sampler,i=this.getFromMap(a._activeSources,t);if(void 0!==i){new H.a.Midi(i).toFrequency();return void a.triggerRelease(new H.a.Midi(i).toFrequency(),n,.1)}}var o=e.sampler,s=this.getFromMap(o._activeSources,t);o.triggerRelease(new H.a.Midi(s).toFrequency(),n,.1)}}]),e}(),Qn=function(){function e(t,n,r){Object(o.a)(this,e),this.sampledInstrument=r,this.voices=[],this.outputNode=new H.a.Gain(1);for(var a=0;a<t;a++){var i=new Xn(a,r);i.connect(this.outputNode),this.voices.push(i)}this.unusedVoices=Object(h.a)(this.voices),this.outputNode.connect(n),this.numVoices=t,this.samplersUsed=new Set}return Object(s.a)(e,[{key:"getVoices",value:function(){return 1===this.numVoices?[this.voices[0]]:this.voices}},{key:"clear",value:function(){this.voices.forEach(function(e){return e.clear()}),this.samplersUsed=new Set}},{key:"dispose",value:function(){this.voices.forEach(function(e){return e.dispose()}),this.outputNode.dispose(),this.voices=void 0,this.outputNode=void 0}},{key:"ampEnvelopes",get:function(){return this.voices.map(function(e){return e.ampEnvelope})}},{key:"getUnusedVoiceIfAny",value:function(e){return 1===this.numVoices?this.voices[0]:0===this.unusedVoices.length?this.voices[Math.floor(Math.random()*this.numVoices)]:this.unusedVoices.shift()}},{key:"getVoiceUsingSampler",value:function(e,t){return this.voices.find(function(n){return n.samplerToTriggers[e.id]&&n.samplerToTriggers[e.id][t]})}},{key:"useSamplerWithVoice",value:function(e,t,n,r,a){t.useSampler(e,n,r,a),this.samplersUsed.add(e)}},{key:"disconnectSamplerFromVoice",value:function(e,t,n){t.disconnectSampler(e,n)&&(t.isUsed()||(this.unusedVoices.push(t),this.samplersUsed.delete(e)))}},{key:"triggerAttack",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r,i,o,s){var c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=this.getUnusedVoiceIfAny(t),this.useSamplerWithVoice(t,c,r,n,o),c.ampEnvelope.triggerAttack(r,i),u=[t.triggerAttack(n,r,i,o,s,c.crossFade.input[0],!1)],this.sampledInstrument.crossFadeParameter.get()>0&&u.push(t.triggerAttack(n,r,i,o,s,c.crossFade.input[1],!0)),e.next=7,Promise.all(u);case 7:t.loop||this.disconnectSamplerFromVoice(t,c,n);case 8:case"end":return e.stop()}},e,this)}));return function(t,n,r,a,i,o){return e.apply(this,arguments)}}()},{key:"triggerAttackRelease",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r,i,o,s,c,u){var l,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=this.getUnusedVoiceIfAny(t),this.useSamplerWithVoice(t,l,i,n,s),l.ampEnvelope.triggerAttackRelease(r,i,o,s),f=[t.triggerAttackRelease(n,r,i,o,s,c,l.crossFade.input[0],u,!1)],this.sampledInstrument.crossFadeParameter.get()>0&&f.push(t.triggerAttackRelease(n,r,i,o,s,c,l.crossFade.input[1],u,!0)),e.next=7,Promise.all(f);case 7:l.onVoiceRelease(t,n),this.disconnectSamplerFromVoice(t,l,n);case 9:case"end":return e.stop()}},e,this)}));return function(t,n,r,a,i,o,s,c){return e.apply(this,arguments)}}()},{key:"triggerRelease",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.triggerRelease(n,!1),this.sampledInstrument.crossFadeParameter.get()>0&&t.triggerRelease(n,!0),void 0!==(r=this.getVoiceUsingSampler(t,n[0]))){e.next=5;break}return e.abrupt("return");case 5:r.totalTriggers<=1&&r.ampEnvelope.triggerRelease(H.a.Master.context.currentTime),r.onVoiceRelease(t,n[0]);case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setCrossFade",value:function(e){this.voices.forEach(function(t){return e.connect(t.crossFade.fade)})}}]),e}(),Yn=n(693),Zn=(n(901),n(317)),$n=function(){function e(){Object(o.a)(this,e),this.isRecording=!1}return Object(s.a)(e,[{key:"input",set:function(e){if(void 0===e)return this.recorder.clear(),this.recorder.stop(),this.recorder=void 0,void(this.isRecording=!1);this.recorder=new window.Recorder(e,{numChannels:2,bufferLen:1024}),this.recorder.record((new Date).getTime()),this.startRecordLoop()}},{key:"startRecordLoop",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("start record loop");case 1:if(void 0===this.recorder){e.next=7;break}return e.next=4,this.sleep(1e4);case 4:this.isRecording||(console.log("clearing"),this.recorder.clear()),e.next=1;break;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sleep",value:function(e){return new Promise(function(){var t=Object(i.a)(a.a.mark(function t(n,r){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:setTimeout(function(){n()},e);case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"start",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.recorder.clear(),this.isRecording=!0}},{key:"stop",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.sleep(t);case 2:e.recorder.getBuffer(function(t){var n=e.getSample(t);e.recorder.clear(),e.isRecording=!1,r(n)});case 3:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getSample",value:function(e){var t=e[0].length,n=H.a.Master.context.createBuffer(2,t,H.a.Master.context.sampleRate);n.copyToChannel(e[0],0,0),n.copyToChannel(e[1],1,0);var r=new R.a;return r.audioBuffer=n,r}}]),e}(),er=n(301),tr=n(224);var nr=.025,rr=800;function ar(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nr,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rr,a=e.getChannelData(0),i=window.api.create_buffer(a.length);window.Module.HEAPF32.set(a,i>>2),window.api.findLoop(i,a.length,t,n,r);var o=window.api.get_result_pointer(),s=new Uint16Array(window.Module.HEAP16.buffer,o,2);if(console.log("resultView = ",s),0!=s[0]||0!=s[1]){var c={start:s[0],end:s[1],difference:1};return window.api.destroy_buffer(i),c}}function ir(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return or(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return or(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function or(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var cr=8,ur=function(e){Object(u.a)(n,e);var t=sr(n);function n(e,r,a,i){var s;return Object(o.a)(this,n),(s=t.call(this)).cache={},s.sequencerEngine=e,s.store=e.store,s.mixSession=r,s.context=a,s.track=i,s.solutionNumber=0,s.outputNode=new H.a.Gain(1),s.voices=new Qn(cr,s.outputNode,Object(c.a)(s)),s.resampler=new $n,s.samplers={},s.interpolationModeParameter=new $.a("interpolationMode",Object(c.a)(s),function(e,t){return[]},{min:er.a,max:er.b,unit:"",defaultValue:er.b,automatable:!1}),s.registerParameter(s.interpolationModeParameter),s.mixModeParameter=new Gt.a("mixMode",Object(c.a)(s),function(e,t){return[]},{min:0,prettyName:"Mix Mode",options:{0:tr.c,.5:tr.b,1:tr.a},max:1,unit:"",defaultValue:tr.c,uxAutomatable:!1}),s.registerParameter(s.mixModeParameter),s.monophonicParameter=new $.a("monophonic",Object(c.a)(s),function(e,t){s.voices.numVoices=t?1:cr},{min:!1,max:!0,unit:"",defaultValue:!1,automatable:!1}),s.registerParameter(s.monophonicParameter),s.crossFadeSignal=new H.a.Signal(0),s.crossFadeParameter=new Y.c("crossFade",s.crossFadeSignal,{min:0,max:1,defaultValue:0,automationRate:X.a}),s.registerParameter(s.crossFadeParameter),s.detuneSignal=new H.a.Signal(1e3),s.detuneParameter=new Y.c("detune",s.detuneSignal,{min:-1e4,max:1e4,defaultValue:0,automationRate:X.a}),s.registerParameter(s.detuneParameter),s.setupLoopParameters(),s.setupAmpEnvelopeParameters(),s.smoothParameter=new $.a("smooth",Object(c.a)(s),function(e,t){var n=1-t;s.voices.voices.forEach(function(e){return e.ampLFO.smooth=n})},{min:0,max:1,unit:"",defaultValue:!1,uxAutomatable:!1}),s.registerParameter(s.smoothParameter),s.glideParameter=new $.a("glide",Object(c.a)(s),function(e,t){return[]},{min:0,max:1e3,unit:"",defaultValue:0}),s.registerParameter(s.glideParameter),s.lastTranspose=void 0,s.triggerCounters={},s.loaded=!0,s.getParameters().forEach(function(e){return e.isLoaded=!0}),s.voices.setCrossFade(s.crossFadeSignal),s.glideTransposes={},s.setupSlide(),s}return Object(s.a)(n,[{key:"allSamplers",get:function(){var e=[];for(var t in this.samplers)e=[].concat(Object(h.a)(e),Object(h.a)(this.samplers[t]));return e}},{key:"onAttackChanged",value:function(e){for(var t in this.ampEnvelopes)this.ampEnvelopes[t].attack=e/1e3}},{key:"onDecayChanged",value:function(e){for(var t in this.ampEnvelopes)this.ampEnvelopes[t].decay=e/1e3}},{key:"onSustainChanged",value:function(e){for(var t in this.ampEnvelopes)this.ampEnvelopes[t].sustain=Math.min(.99,e)}},{key:"onReleaseChanged",value:function(e){for(var t in this.ampEnvelopes)this.ampEnvelopes[t].release=e/1e3}},{key:"loop",get:function(){return this.allSamplers.every(function(e){return e.loop})},set:function(e){this.allSamplers.forEach(function(t){return t.loop=e})}},{key:"ampEnvelopes",get:function(){return this.voices.ampEnvelopes}},{key:"setupAmpEnvelopeParameters",value:function(){var e=this;this.ampAttackParameter=new $.a("Attack",this,function(t,n){e.onAttackChanged(n)},{min:0,max:5e3,unit:"",defaultValue:10}),this.registerParameter(this.ampAttackParameter),this.ampDecayParameter=new $.a("Decay",this,function(t,n){for(var r in e.ampEnvelopes)e.ampEnvelopes[r].decay=n/1e3},{min:0,max:5e3,unit:"",defaultValue:10}),this.registerParameter(this.ampDecayParameter),this.ampSustainParameter=new $.a("Sustain",this,function(t,n){e.onSustainChanged(n)},{min:0,max:1,unit:"",defaultValue:.8}),this.registerParameter(this.ampSustainParameter),this.ampReleaseParameter=new $.a("Release",this,function(t,n){e.onReleaseChanged(n)},{min:0,max:5e3,unit:"",defaultValue:10}),this.registerParameter(this.ampReleaseParameter),this.attackParameter=this.ampAttackParameter,this.decayParameter=this.ampDecayParameter,this.sustainParameter=this.ampSustainParameter,this.releaseParameter=this.ampReleaseParameter}},{key:"setupLoopParameters",value:function(){var e=this;this.loopParameter=new $.a("loop",this,function(t,n){e.loop=n},{min:!1,max:!0,unit:"",defaultValue:!1}),this.registerParameter(this.loopParameter),this.loopStartParameter=new $.a("loopStart",this,function(t,n){Array.from(e.voices.samplersUsed).forEach(function(t){return t.setLoopPoints({loopStart:n,loopLength:e.loopLength})})},{min:0,max:100,unit:"",defaultValue:0}),this.registerParameter(this.loopStartParameter),this.loopLengthParameter=new $.a("loopLength",this,function(t,n){Array.from(e.voices.samplersUsed).forEach(function(t){return t.setLoopPoints({loopStart:e.loopStart,loopLength:n})})},{min:0,max:100,unit:"",defaultValue:100}),this.registerParameter(this.loopLengthParameter)}},{key:"loopStart",get:function(){return this.loopStartParameter.getAtStep(this.currentStep)}},{key:"loopLength",get:function(){return this.loopLengthParameter.getAtStep(this.currentStep)}},{key:"onNewStep",value:function(e,t){var n=this;if(this.currentStep=e,this.oldMixMode!==this.mixMode&&(this.cache={}),this.oldMixMode=this.mixMode,this.onAttackChanged(this.ampAttack),this.onDecayChanged(this.ampDecay),this.onSustainChanged(this.ampSustain),this.onReleaseChanged(this.ampRelease),this.loop&&(this.loopStartParameter.isConnectedToAnyModulator()||this.loopLengthParameter.isConnectedToAnyModulator()||0!==this.loopStartParameter.automations.length||0!==this.loopLengthParameter.automations.length)){var r=1-this.smoothParameter.get();this.voices.voices.filter(function(e){return e.ampLFO.lfo}).forEach(function(e){return e.ampLFO.lfo.min=r});var a=this.loopStart,i=this.loopLength;H.a.Master.context.setTimeout(function(){Array.from(n.voices.samplersUsed).forEach(function(e){return e.setLoopPoints({loopStart:a,loopLength:i})})},1/H.a.Master.context.sampleRate)}}},{key:"glide",get:function(){return this.glideParameter.getAtStep(this.trackStep)},set:function(e){this.glideParameter.set(e)}},{key:"interpolationMode",get:function(){return this.interpolationModeParameter.getAtStep(this.trackStep)},set:function(e){this.interpolationModeParameter.set(e),this.cache={}}},{key:"monophonic",get:function(){return this.monophonicParameter.get()},set:function(e){this.monophonicParameter.set(e)}},{key:"mixMode",get:function(){return this.mixModeParameter.get()},set:function(e){this.mixModeParameter.set(e),this.cache={}}},{key:"trackStep",get:function(){return this.sequencerEngine.trackStep}},{key:"ampAttack",get:function(){return this.ampAttackParameter.getAtStep(this.currentStep)}},{key:"ampDecay",get:function(){return this.ampDecayParameter.getAtStep(this.currentStep)}},{key:"ampSustain",get:function(){return this.ampSustainParameter.getAtStep(this.currentStep)}},{key:"ampRelease",get:function(){return this.ampReleaseParameter.getAtStep(this.currentStep)}},{key:"connect",value:function(e){this.outputNode.connect(e)}},{key:"disconnect",value:function(){this.outputNode.disconnect()}},{key:"connectToTrack",value:function(e){if(!e)return this.connectedTrack=void 0,void(this.resampler.input=void 0);this.connectedTrack=e,this.resampler.input=e.volumeNode}},{key:"getInstrument",value:function(){return this}},{key:"getInstrumentType",value:function(){return z.g}},{key:"getName",value:function(){return"Sampled Instrument"}},{key:"getPitchEnvelope",value:function(e){if(0!==this.glide){var t=100*(e-(void 0===this.lastTranspose?e:this.lastTranspose)),n=new H.a.ScaledEnvelope({attack:this.glide/1e3,decay:2,min:0,max:t,sustain:1,release:.001,curve:"linear"});return n._releaseCurve="linear",n._decayCurve="linear",n}}},{key:"triggerAttack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0,i=this.getSampler(e,!1),o=i.samplers,s=i.closest;if(void 0!==o){t||(t=new H.a.Time(H.a.Master.context.currentTime)),this.scaleByKey(t,e),this.setEnvelopes(a,e);var c=this.getPitchEnvelope(e);for(var u in this.monophonic&&this.releaseAll(t),o)o[u].sampler.attack=this.ampAttackParameter.getKeyScaledValue(e)/1e3,o[u].sampler.release=Math.max(4,this.ampReleaseParameter.getKeyScaledValue(e)/1e3),this.voices.triggerAttack(o[u],0!==this.glide&&void 0!==this.lastTranspose?this.lastTranspose-s:e-s,t,n,this.getLoopPoints(r,o[u]),c);this.glideTransposes[e]=this.lastTranspose,this.lastTranspose=parseFloat(e)}}},{key:"playSampler",value:function(e){this.voices.triggerAttack(e,0,0,1,0,void 0)}},{key:"triggerAttackRelease",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r,i,o,s){var c,u,l,f,h,p;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=this.getSampler(t,!0),u=c.samplers,l=c.closest,void 0!==u){e.next=3;break}return e.abrupt("return");case 3:for(h in this.scaleByKey(r,t),this.setEnvelopes(s,t),this.monophonic&&!s.slide&&this.releaseAll(r),f=this.getPitchEnvelope(t),u)(p=u[h]).sampler.release=this.ampReleaseParameter.getKeyScaledValue(t)/1e3,p.sampler.attack=this.ampAttackParameter.getKeyScaledValue(t)/1e3,this.voices.triggerAttackRelease(p,0!==this.glide&&void 0!==this.lastTranspose?this.lastTranspose-l:t-l,n,r,i,this.getLoopPoints(o,p),f,o);this.glideTransposes[t]=this.lastTranspose,this.lastTranspose=parseFloat(t);case 10:case"end":return e.stop()}},e,this)}));return function(t,n,r,a,i,o){return e.apply(this,arguments)}}()},{key:"getLoopPoints",value:function(e,t){return{start:e,loopStart:this.loopStart,loopLength:this.loopLength,loopLengthSeconds:(t.endTime-t.startTime)*(this.loopLength/100)}}},{key:"triggerRelease",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s,c,u,l,f=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=f.length>0&&void 0!==f[0]?f[0]:[0],this.releaseParameter.set(this.releaseParameter.get(),!0,!0),e.t0=a.a.keys(t);case 3:if((e.t1=e.t0()).done){e.next=13;break}if(n=e.t1.value,r=t[n],i=this.getSampler(r,!0),o=i.samplers,s=i.closest,void 0!==o){e.next=9;break}return e.abrupt("continue",3);case 9:for(u in c=0!==this.glide&&this.glideTransposes[r]||r,o)l=o[u],o[u].sampler.release=this.ampRelease/1e3,this.voices.triggerRelease(l,[c-s]);e.next=3;break;case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"releaseAll",value:function(e){for(var t in this.voices.clear(),e||(this.clearSlide(),this.detuneSignal.value=this.detuneParameter.get(!0),this.lastTranspose=0),this.samplers){this.samplers[t].forEach(function(t){t.get(0).releaseAll(e||new H.a.Time(H.a.Master.context.currentTime),.01)})}}},{key:"newSample",value:function(e,t,n){var r=this;return new Promise(function(){var o=Object(i.a)(a.a.mark(function o(s,c){var u,l;return a.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if("string"===typeof t&&(t=new R.a(t)),t=t.getCopy(),r.track.samplesStream=n||new ke.a(t,r.sequencerEngine),void 0!==t.audioBuffer){o.next=6;break}return o.next=6,t.load();case 6:u={slices:void 0,offset:0,transpose:0,volume:0},(l=new Gn(r.track,t,function(){return[]},void 0,u)).samplesStream=n,setTimeout(Object(i.a)(a.a.mark(function n(){var i,o;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(l.init(),r.detuneSignal.connect(l.detuneSignal.input),r.detuneParameter.set(r.detuneParameter.get()),void 0!==e){n.next=10;break}return n.next=6,r.getPitch(t);case 6:void 0===(i=n.sent)?void 0===e&&(e=0):(void 0===e&&(e=i),(o=e-i)<-30&&(o+=36),l.transpose=o),n.next=11;break;case 10:case 11:r.cache={},void 0===r.samplers[e]&&(r.samplers[e]=[]),r.samplers[e]=[].concat(Object(h.a)(r.samplers[e]),[l]),r.selectSampler(e,l),s({sampler:l,samplers:r.samplers[e]});case 16:case"end":return n.stop()}},n)})),500);case 10:case"end":return o.stop()}},o)}));return function(e,t){return o.apply(this,arguments)}}())}},{key:"getTriggerCount",value:function(e){return this.triggerCounters[e]||0}},{key:"numberOfSamplers",get:function(){var e=0;for(var t in this.samplers)e+=this.samplers[t].length;return e}},{key:"defaultSampler",get:function(){if(void 0!==this.samplers){var e=Object.keys(this.samplers)[0];if(void 0!==e)return this.samplers[e][0]}}},{key:"getAllSamplersAtExactTranspose",value:function(e){var t=this.samplers[e];return this.mixMode===tr.a&&(t=this.samplers[e].filter(function(e){return e.on})),t}},{key:"filterNeededSamplers",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==e){if(this.mixMode===tr.c){var r=[e[this.getTriggerCount(t)%e.length]];return n&&(this.triggerCounters[t]=this.getTriggerCount(t)+1),r}return e}}},{key:"getSampler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e in this.cache){var n=this.cache[e];return Object(p.a)({},n,{samplers:this.filterNeededSamplers(n.samplers,e,t)})}var r=e;e in this.samplers||(r=this.findClosest(e));var a=this.getAllSamplersAtExactTranspose(r);return this.cache[e]={closest:parseFloat(r),samplers:a},{closest:parseFloat(r),samplers:this.filterNeededSamplers(a,e,t)}}},{key:"findClosest",value:function(e){return this.interpolationMode===er.a?function(e,t){var n=void 0,r=void 0;for(var a in t){a=parseInt(a);var i=Math.abs(e-a);void 0!==n?i<r&&(n=a,r=i):(n=a,r=i)}return parseFloat(n)}(e,this.samplers):function(e,t){var n=K.a.fromTranspose(e);n.octave=0;var r=void 0,a=void 0,i=void 0;for(var o in t){var s=K.a.fromTranspose(o);s.octave=0;var c=Math.abs(n.getTranspose()-s.getTranspose()),u=Math.abs(e-o);(void 0===i||c<i||c===i&&u<a)&&(r=o,i=c,a=u)}return parseFloat(r)}(e,this.samplers)}},{key:"getJson",value:function(){var e=Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{ampAttack:this.ampAttack,ampDecay:this.ampDecay,ampSustain:this.ampSustain,ampRelease:this.ampRelease,crossFade:this.crossFadeParameter.get(),interpolationMode:this.interpolationMode,mixMode:this.mixMode,samplers:{},glide:this.glide,monophonic:this.monophonic,detune:this.detuneParameter.get(),loopStart:this.loopStart,loopLength:this.loopLength,loop:this.loopParameter.get(),smooth:this.smoothParameter.get()});for(var t in this.samplers)e.samplers[t]=this.samplers[t].map(function(e){return e.getJson()});return e=Object(Q.b)(e,"ampAttackParameter",this.ampAttackParameter),e=Object(Q.b)(e,"ampDecayParameter",this.ampDecayParameter),e=Object(Q.b)(e,"ampSustainParameter",this.ampSustainParameter),e=Object(Q.b)(e,"ampReleaseParameter",this.ampReleaseParameter),e=Object(Q.b)(e,"interpolationModeParameter",this.interpolationModeParameter),e=Object(Q.b)(e,"mixModeParameter",this.mixModeParameter),e=Object(Q.b)(e,"glideParameter",this.glideParameter),e=Object(Q.b)(e,"monophonicParameter",this.monophonicParameter),e=Object(Q.b)(e,"detuneParameter",this.detuneParameter),e=Object(Q.b)(e,"loopStartParameter",this.loopStartParameter),e=Object(Q.b)(e,"loopLengthParameter",this.loopLengthParameter),e=Object(Q.b)(e,"smoothParameter",this.smoothParameter),e=Object(Q.b)(e,"loopParameter",this.loopParameter),e=Object(Q.b)(e,"crossFadeParameter",this.crossFadeParameter)}},{key:"fromJsonSync",value:function(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&this.clearSamples(),this.ampAttackParameter.set(e.ampAttack),this.ampDecayParameter.set(e.ampDecay),this.ampSustainParameter.set(e.ampSustain),this.ampReleaseParameter.set(e.ampRelease),void 0!==e.loopStart&&this.loopStartParameter.set(e.loopStart),void 0!==e.loopLength&&this.loopLengthParameter.set(e.loopLength),void 0!==e.loop&&this.loopParameter.set(e.loop),void 0!==e.crossFade&&this.crossFadeParameter.set(e.crossFade),e.interpolationMode&&(this.interpolationMode=e.interpolationMode),void 0!==e.mixMode&&(this.mixMode=Object(ae.a)(e.mixMode)?tr.c:e.mixMode),void 0!==e.glide&&(this.glide=e.glide),void 0!==e.monophonic&&(this.monophonic=e.monophonic),void 0!==e.smooth&&this.smoothParameter.set(e.smooth),Object(Q.a)(e,"ampAttackParameter",this.ampAttackParameter,this.sequencerEngine),Object(Q.a)(e,"ampDecayParameter",this.ampDecayParameter,this.sequencerEngine),Object(Q.a)(e,"ampSustainParameter",this.ampSustainParameter,this.sequencerEngine),Object(Q.a)(e,"ampReleaseParameter",this.ampReleaseParameter,this.sequencerEngine),Object(Q.a)(e,"interpolationModeParameter",this.interpolationModeParameter),Object(Q.a)(e,"mixModeParameter",this.mixModeParameter),Object(Q.a)(e,"glideParameter",this.glideParameter,this.sequencerEngine),Object(Q.a)(e,"monophonicParameter",this.monophonicParameter,this.sequencerEngine),Object(Q.a)(e,"detuneParameter",this.detuneParameter,this.sequencerEngine),Object(Q.a)(e,"loopStartParameter",this.loopStartParameter,this.sequencerEngine),Object(Q.a)(e,"loopLengthParameter",this.loopLengthParameter,this.sequencerEngine),Object(Q.a)(e,"loopParameter",this.loopParameter,this.sequencerEngine),Object(Q.a)(e,"smoothParameter",this.smoothParameter,this.sequencerEngine),Object(Q.a)(e,"crossFadeParameter",this.crossFadeParameter,this.sequencerEngine),t)for(var n in t){var r=t[n];for(var a in r){var i=r[a].sample,o=e.samplers[n][a];this.setSampleForTranspose(n,i.getCopy(!0),o,r[a].tempo)}}this.samples=Object(p.a)({},this.samplers),this.loop=this.loop,void 0!==e.detune?this.detuneParameter.set(e.detune):this.detuneParameter.set(0)}},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in r=u.length>2&&void 0!==u[2]&&u[2],this.loaded=!1,this.store.dispatch(Object(C.Xg)(this.track.subSequence.id,this.track.trackNumber,!0)),this.getParameters().forEach(function(e){return e.isLoaded=!1}),this.fromJsonSync(t,void 0,r),i=[],t.samplers)if(void 0!==t.samplers[o].length)for(s in t.samplers[o])c=t.samplers[o][s],i.push(this.loadSamplerFromJson(parseFloat(o),c));else i.push(this.loadSamplerFromJson(parseFloat(o),t.samplers[o]));return e.next=9,Promise.all(i);case 9:if(this.loaded=!0,this.track.sample=this.defaultSampler&&this.defaultSampler.sample,!this.defaultSampler){e.next=15;break}return e.next=14,this.defaultSampler.samplesStream.fetch();case 14:this.track.samplesStream=this.defaultSampler.samplesStream;case 15:this.getParameters().forEach(function(e){return e.isLoaded=!0}),this.store.dispatch(Object(C.Xg)(this.track.subSequence.id,this.track.trackNumber,!1));case 17:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setSampleForTranspose",value:function(e,t,n,r){var a=new Gn(this.track,t,function(){return[]},n.slices,n);void 0!==r&&(a.tempo=r),a.init(void 0,void 0,!0),this.detuneSignal.connect(a.detuneSignal,0,0),void 0===this.samplers[e]&&(this.samplers[e]=[]),this.samplers[e].push(a),this.cache={}}},{key:"loadSamplerFromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new R.a(n.sampleId,this.sequencerEngine.encryptedIpfs),e.prev=1,e.next=4,r.load();case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return");case 9:this.setSampleForTranspose(t,r,n);case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"clearSamples",value:function(){for(var e in this.samplers){for(var t in this.samplers[e])this.samplers[e][t].dispose();delete this.samplers[e]}this.voices.clear(),this.ripMods()}},{key:"getSamples",value:function(){var e=[];for(var t in this.samplers)for(var n in this.samplers[t])e.push(this.samplers[t][n].sample);return e}},{key:"ripMods",value:function(){if(void 0!==this.parameters){var e,t=ir(this.parameters);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.object&&n.isConnectedToAnyModulator()&&n.disconnectFromAllModulators()}}catch(r){t.e(r)}finally{t.f()}}}},{key:"dispose",value:function(){this.clearSamples(),this.voices.dispose(),this.voices=void 0,this.samplers=void 0,this.outputNode.dispose(),this.outputNode=void 0,this.parameters=void 0}},{key:"getPitch",value:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s,c;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===(o=t.getNoteFromName(e.name))){n.next=4;break}return r(o),n.abrupt("return");case 4:return r(void 0),n.abrupt("return");case 10:(s=n.sent).notes.length>0&&(s.notes.sort(function(e,t){return t.endTime-t.starTime-(e.endTime-e.startTime)}),c=s.notes[0].pitch-48,r(c)),r(void 0);case 13:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"deleteSampler",value:function(e){for(var t in this.samplers){var n=this.samplers[t].indexOf(e);n>-1&&(this.samplers[t].splice(n,1),e.dispose()),0===this.samplers[t].length&&delete this.samplers[t]}this.cache={},this.voices.clear()}},{key:"selectSampler",value:function(e,t){this.cache={},this.samplers[e].filter(function(e){return e!==t}).forEach(function(e){return e.on=!1}),t.on=!0}},{key:"getNoteFromName",value:function(e){var t=void 0,n=e.match(/([A-G]||[a-g])([#b])?\d/);if(n&&!(n[0].length<2)&&(2===(e=n[0].toUpperCase()).length?t=e.substring(0,1):3===e.length&&(t=e.substring(0,2)),t&&K.a.baseNotes.indexOf(t)>-1))return K.a.fromString(e).getTranspose()}},{key:"findLoop",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o,s,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(this.solutionNumber+=500,t=this.solutionNumber),i=this.getAllSamplersAtExactTranspose(0)[0],o=ar(i.audioBuffer,t,n,r),s=o.start,!((c=o.end)<s)){e.next=7;break}return this.solutionNumber=Math.ceil(10*Math.random()),this.findLoop(void 0,n,r),e.abrupt("return");case 7:u=100*s/(H.a.Master.context.sampleRate*i.getDuration()),this.loopStartParameter.set(u),this.loopLengthParameter.set(100*(c-s)/(H.a.Master.context.sampleRate*i.getDuration()));case 10:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.context,t=arguments.length>1?arguments[1]:void 0,r=new n(arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sequencerEngine,this.mixSession,e,t);return r.fromJsonSync(this.getJson(),this.samplers),r}},{key:"makePublicIfNeeded",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=a.a.keys(this.samplers);case 1:if((e.t1=e.t0()).done){e.next=21;break}t=e.t1.value,n=this.samplers[t],e.t2=a.a.keys(n);case 5:if((e.t3=e.t2()).done){e.next=19;break}return r=e.t3.value,i=this.samplers[t][r],o=i.sample,e.next=11,In.a.guildSamples.getGuildIdForSound(o.getId());case 11:if(void 0===(s=e.sent)||0===s){e.next=17;break}return e.next=15,In.a.guildSamples.saveSample(o);case 15:c=e.sent,o.ipfsHash=c;case 17:e.next=5;break;case 19:e.next=1;break;case 21:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setEnvelopes",value:function(e,t){var n=this.ampAttackParameter.getKeyScaledValue(t),r=this.ampDecayParameter.getKeyScaledValue(t),a=this.ampSustainParameter.getKeyScaledValue(t),i=this.ampReleaseParameter.getKeyScaledValue(t);this.onAttackChanged(n),this.onDecayChanged(r),this.onSustainChanged(a),this.onReleaseChanged(i),null!==e.releaseParameter.get()&&this.releaseParameter.set(e.releaseParameter.get())}}]),n}(Object(ut.a)(mt(G)));function lr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var fr=In.a.presets,hr=function(e){Object(u.a)(n,e);var t=lr(n);function n(e,r,a,i,s,u){var l;!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return Object(o.a)(this,n),(l=t.call(this,e,r,a,i,s,u,!1)).setInstrument(new ur(r,a,(new L.a).forTrack(Object(c.a)(l)),Object(c.a)(l))),l.name="Sampled Instrument",l.gated=!0,l}return Object(s.a)(n,[{key:"getInstrumentType",value:function(){return z.g}},{key:"createNewInstrument",value:function(){this.instrument=void 0,this.setInstrument(new ur(this.sequencerEngine,this.mixSession,(new L.a).forTrack(this),this)),this.gated=!0}},{key:"tempo",get:function(){var e=this.selectedSampler||this.instrument.defaultSampler;return void 0===e?0:e.tempo}},{key:"auditionPreset",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,e.next=3,fr.getPresetData(t);case 3:r=e.sent,this.fromJson(r.trackParameters),this.presetName=n,this.update();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t,r,i,o,s){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,t,r,i,o,s);case 2:this.instrument.defaultSampler&&(this.sample=this.instrument.defaultSampler.sample);case 3:case"end":return e.stop()}},e,this)}));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"loadTrackInfo",value:function(e,t){var n=this.selectedSampler||this.instrument.defaultSampler;n&&(this.sample=t,n.auditionSound(t),this.presetName=t.name,this.sequencerEngine.update()),this.store.dispatch(Object(C.Xg)(this.subSequence.id,this.trackNumber,!1))}},{key:"restart",value:function(){Object(Z.a)(Object(f.a)(n.prototype),"restart",this).call(this),this.isFrozen||(this.instrument.triggerCounters={},this.instrument.cache={},this.instrument.voices.clear())}},{key:"start",value:function(){Object(Z.a)(Object(f.a)(n.prototype),"start",this).call(this),this.isFrozen||this.restart()}},{key:"onNewStep",value:function(e,t){this.isFrozen?Object(Z.a)(Object(f.a)(n.prototype),"onNewStep",this).call(this):(Object(Z.a)(Object(f.a)(n.prototype),"onNewStep",this).call(this),this.instrument.onNewStep(e,t))}},{key:"getSamplesStream",value:function(){var e=this.selectedSampler||this.instrument.defaultSampler;return e?e.samplesStream:this.samplesStream}},{key:"getCopy",value:function(e,t){return Object(Z.a)(Object(f.a)(n.prototype),"getCopy",this).call(this,function(e,t,r,a,i,o){return new n(e,t,r,a,i,o)},t)}},{key:"makePublicIfNeeded",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instrument.makePublicIfNeeded();case 2:e.t0=a.a.keys(this.effectsChains);case 3:if((e.t1=e.t0()).done){e.next=9;break}return t=e.t1.value,e.next=7,this.effectsChains[t].makePublicIfNeeded();case 7:e.next=3;break;case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"isMonophonic",value:function(){return this.instrument.monophonic}}]),n}(nt);function pr(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.numberOfPatterns(),a=void 0;if(t===A.b)switch(n){case z.c:a=new at(e.tracks.length,e,e.mixSession,r,function(){return e.update()},e.currentSubSequence);break;case z.f:a=new Dn(e.tracks.length,e,e.mixSession,r,function(){return e.update()},e.currentSubSequence);break;case z.i:a=new nt(e.tracks.length,e,e.mixSession,r,function(){return e.update()},e.currentSubSequence);break;case z.g:a=new hr(e.tracks.length,e,e.mixSession,r,function(){return e.update()},e.currentSubSequence)}else t===A.c&&(a=new Vn(e.tracks.length,e,e.mixSession,r,function(){return e.update()},e.currentSubSequence));if(void 0!==a)return a}var dr=n(646),mr=n(610),vr=n(431),br=(n(425),n(33)),gr=n(47),yr=n(826);function kr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Or=function(e){Object(u.a)(n,e);var t=kr(n);function n(e,r,a,i,s,c){var u;return Object(o.a)(this,n),(u=t.call(this,e,r,a,i,s,c)).audioInputChannel=void 0,u.isRecording=!1,u.samplesToUpload=[],u.soundUploader=new Ce.a(1,function(e,t,n){return u.onSoundUploaded(t,n)}),u}return Object(s.a)(n,[{key:"isRecordable",value:function(){return!0}},{key:"onSoundUploaded",value:function(e,t){}},{key:"setAudioInputManager",value:function(e){this.audioInputManager=e,this.audioInputManager.monitorVolume.gain.value=0}},{key:"setAudioInput",value:function(e){void 0!==this.audioInputChannel&&this.disconnectAudioInput(this.audioInputChannel),this.audioInputChannel=e,void 0!==e?(this.audioInputManager.connect(this.gainNode,e),this.recorder=this.audioInputManager.getRecorder()):this.disconnectAudioInput(this.audioInputChannel)}},{key:"disconnectAudioInput",value:function(e){console.log("disconnecting channel = "+e),this.audioInputManager.disconnect(this.gainNode,e),this.audioInputChannel=void 0}},{key:"isAudioInputChannelConnected",value:function(e){return this.audioInputChannel===e}},{key:"recording",value:function(e){this.isRecording=e}},{key:"startRecording",value:function(e){if(void 0!==this.recorder){var t=this,n=Object(Zn.a)(e);setTimeout(function(){t.recorder.clear(),t.recorder.record()},n+0)}}},{key:"stopRecording",value:function(e){if(void 0!==this.recorder){var t=this;setTimeout(function(){t.recorder.stop(),t.recorder.getBuffer(function(e){t.saveBuffer(e)})},Object(Zn.a)(e)+10)}}},{key:"saveBuffer",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this,{slices:void 0,offset:0,transpose:0,volume:4},n=t[0].length,(r=H.a.Master.context.createBuffer(2,n,H.a.Master.context.sampleRate)).copyToChannel(t[0],0,0),r.copyToChannel(t[0],1,0),[{startTime:0,endTime:r.duration}],i=new R.a,this.sample=i,i.isResampled=!0,i.tags=["Recorded"],i.name="Recorded",i.audioBuffer=r,this.freeze([i]),e.next=16,this.soundUploader.uploadBufferToIpfs(t,!0,0);case 16:o=e.sent,i.ipfsHash=o;case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onNewRecordedSampler",value:function(e,t){t.gainNode.connect(this.gainNode),e.switchToPattern(e.currentPattern),e.setVolume(e.getVolume()),e.setPanning(e.getPanning())}}]),n}(Le(Object(yr.a)(Ke)));n(226);function jr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var wr=new H.a.Time("16n"),Er=function(e){Object(u.a)(n,e);var t=jr(n);function n(e,r,a,i,s,c,u){var l;return Object(o.a)(this,n),(l=t.call(this,e,r,a,i,s,c)).midiOutputs=new Set,l.midiEngine=void 0,l.isRecordingMidi=!1,l.isEnabled=!1,l.recordedTriggers={},void 0!=u&&u||l.setupEffects(),l.audioInputManager=void 0,l.midiChannel=void 0,l.gated=!0,l.latency=0,l.ccParameters=[],l}return Object(s.a)(n,[{key:"setupCCParameters",value:function(e){console.log("OUTPUT =",e),this.ccParameters=[];for(var t=1;t<120;t++){var n=new dr.a("Midi CC "+t,t,e);this.registerParameter(n,!1),this.ccParameters.push(n)}}},{key:"getParameters",value:function(){return[].concat(Object(h.a)(Object(Z.a)(Object(f.a)(n.prototype),"getParameters",this).call(this)),Object(h.a)(this.ccParameters))}},{key:"getInstrumentType",value:function(){return z.b}},{key:"getName",value:function(){return"External Instrument"}},{key:"getCopy",value:function(){var e=Object(Z.a)(Object(f.a)(n.prototype),"getCopy",this).call(this,function(e,t,r,a,i,o){return new n(e,t,r,a,i,o)});return e.setMidiEngine(this.midiEngine),e.midiChannel=this.middieChannel,e.sequencerEngine=this.sequencerEngine,e.midiOutputs=new Set(this.midiOutputs),e.latency=this.latency,e}},{key:"getSoundUploader",value:function(){return this.soundUploader}},{key:"setAudioSettings",value:function(e){this.audioSettings=e}},{key:"setSequencerEngine",value:function(e){this.sequencerEngine=e}},{key:"recording",value:function(e){this.isRecordingMidi=e}},{key:"toggleRecording",value:function(e){this.pattern.loopsPlaying[e]=!this.pattern.loopsPlaying[e]}},{key:"isRecordingPlaying",value:function(e){return this.pattern.loopsPlaying[e]}},{key:"getRecordings",value:function(){return this.getSamplers()}},{key:"deleteMidiOutput",value:function(e){this.midiOutputs.has(e)&&this.midiOutputs.delete(e)}},{key:"addMidiOutput",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.midiOutputs.add(e),this.setupCCParameters(this.sequencerEngine.midi.deviceToMidiCC[e.name])}},{key:"addMidiInterfaceEffect",value:function(e,t){if(!this.midiEffects.effects.filter(function(e){return"Midi Interface"===e.name})[0]){var n=new vr.a(this);n.setConfig(e,t),this.midiEffects.addEffect(n),this.sequencerEngine.update()}}},{key:"setAudioInputManager",value:function(e){this.audioInputManager=e}},{key:"onLoadTrackUrl",value:function(e,t,r){return Object(Z.a)(Object(f.a)(n.prototype),"onLoadTrackUrl",this).call(this,e,t,r)}},{key:"disconnect",value:function(){void 0!==this.audioChannel&&this.audioInputManager.disconnect(this.gainNode,this.audioChannel),this.audioChannel=void 0}},{key:"getMidiOutputs",value:function(){return this.midiOutputs}},{key:"setMidiEngine",value:function(e){this.midiEngine=e;var t=this;setTimeout(function(){t.setupMidiInput()},1e3)}},{key:"inputNoteForStep",value:function(e,t){var n=K.a.fromString(t).getTranspose();this.getStepsAtResolution(this.sequencerEngine.resolution)[e].transpose=n,this.syncBuckets(this.sequencerEngine.resolution),this.update()}},{key:"triggerMidiNoteOn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.onNoteOn(void 0,K.a.fromTranspose(e).toString(),t)}},{key:"onNoteOn",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;void 0!==this.sequencerEngine.cursor.step&&this.sequencerEngine.cursor.show&&this.inputNoteForStep(this.sequencerEngine.cursor.getStep(this.sequencerEngine.resolution),t),this.isEnabled&&(this.midiOutputs.size>0&&this.midiOutputs.forEach(function(e){return n.midiEngine.playNoteSimple(e,t,n.midiChannel,0,0,r)}),this.isRecordingMidi)}},{key:"triggerMidiNoteOff",value:function(e){this.onNoteOff(void 0,K.a.fromTranspose(e).toString())}},{key:"onNoteOff",value:function(e,t){var n=this;this.midiOutputs.size>0&&this.midiOutputs.forEach(function(e){return n.midiEngine.releaseNoteSimple(e,t,n.midiChannel,0)}),this.isRecordingMidi&&this.recordedTriggers}},{key:"setupMidiInput",value:function(){}},{key:"getTrackType",value:function(){return A.d}},{key:"liveTrigger",value:function(e){this.triggerMidiNoteOn(e.transpose)}},{key:"liveTriggerRelease",value:function(e){this.triggerMidiNoteOff(e)}},{key:"trigger",value:function(){var e=Object(i.a)(a.a.mark(function e(t,r){var i,o,s,c,u,l,h,p,d=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFrozen){e.next=3;break}return Object(Z.a)(Object(f.a)(n.prototype),"trigger",this).call(this,t,r),e.abrupt("return");case 3:for(r-=this.latency/1e3,i=t.transpose,o=new H.a.Time(new H.a.Time(t.duration)*wr),Object(Zn.a)(r),s=t.release/16,c=t.chop,u=(null==o?wr:o)/c,l=r,h=t.velocity,h*=1-t.start,p=0;p<c;p++)this.midiOutputs.forEach(function(e){return d.midiEngine.playNote(e,d.midiChannel,i,Object(Zn.a)(l),o.toMilliseconds(),s,h)}),l+=u;case 15:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"expandRecordedTracks",value:function(){var e=this,t=Object.keys(this.pattern.loopsPlaying).filter(function(t){return e.pattern.loopsPlaying[t]});console.log("loops playing = "),console.log(t),console.log(this.samplers),t.forEach(function(t){return e.sequencerEngine.addSound(t,void 0,void 0,void 0,!0)})}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{latency:this.latency})}},{key:"fromJson",value:function(e){e.latency&&(this.latency=e.latency)}}]),n}(Or);function Sr(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Pr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pr(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Tr=function(e){Object(u.a)(n,e);var t=xr(n);function n(e,r,a,i,s,c){var u;!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return Object(o.a)(this,n),(u=t.call(this,e,r,a,i,s,c)).setupEffects(),u}return Object(s.a)(n,[{key:"getSampler",value:function(){var e=this.frozenColumns[0].playing||0;return this.frozenColumns[0].frozenSamplers[e]}},{key:"sample",get:function(){if(this.frozenColumns&&this.frozenColumns[0]){var e=this.frozenColumns[0].playing||0;return this.frozenColumns[0].frozenSamples[e]}}},{key:"getName",value:function(){return"Multi Freeze"}},{key:"getTrackType",value:function(){return A.e}},{key:"unfreeze",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s,c,u,l,f,p,d,m,v,b,g,y,k,O,j,w,E,S,P,x,T,N,R,M,A=this,q=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=q.length>0&&void 0!==q[0]?q[0]:this.frozenGroup,n=q.length>1&&void 0!==q[1]?q[1]:this.frozenTracks,r=q.length>2?q[2]:void 0,this.sequencerEngine.dispatch(Object(C.bd)("Unfreezing Tracks")),i=this.currentPattern,o=this.sequencerEngine,s=[],c=Object(h.a)(o.tracks),u=Sr(n),e.prev=9,u.s();case 11:if((l=u.n()).done){e.next=27;break}if(f=l.value,!r||r===f){e.next=15;break}return e.abrupt("continue",25);case 15:if(f){e.next=19;break}return c.push(!1),s.push(!1),e.abrupt("continue",25);case 19:return p=f.patterns,d=f.trackData,f.trackEffectChains,f.trackMidiEffects,e.next=22,Fr(o,d,p,0,this.sequencerEngine.currentSubSequence);case 22:m=e.sent,c.push(m),s.push(m);case 25:e.next=11;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(9),u.e(e.t0);case 32:return e.prev=32,u.f(),e.finish(32);case 35:v=0,e.t1=a.a.keys(n);case 37:if((e.t2=e.t1()).done){e.next=72;break}if(b=e.t2.value,!r||n[b]===r){e.next=41;break}return e.abrupt("continue",37);case 41:if((g=s[v++])&&n[b]){e.next=44;break}return e.abrupt("continue",37);case 44:return y=n[b],k=y.patterns,O=y.patternsConfig,j=y.trackData,w=y.trackEffectChains,E=y.trackMidiEffects,e.next=47,Lr({sequencerEngine:o,track:g,tracks:c,patterns:k,trackData:j,trackEffectChains:w,trackMidiEffects:E,subSequence:o.currentSubSequence});case 47:if(!O){e.next=70;break}if(S=this.patterns.length,P=O.length,o.switchToPattern(S-1),!(P>S)){e.next=61;break}x=S;case 53:if(!(x<P)){e.next=59;break}return e.next=56,o.newPattern(!0);case 56:x++,e.next=53;break;case 59:e.next=69;break;case 61:if(!(P<S)){e.next=69;break}T=P;case 63:if(!(T<S)){e.next=69;break}return e.next=66,g.newPattern(!0);case 66:T++,e.next=63;break;case 69:for(N=0;N<S;N++)g.patterns[N].loadFromJson(O[Math.min(N,O.length-1)]);case 70:e.next=37;break;case 72:if(R=this.sequencerEngine.groups.newGroup(),s.filter(function(e){return e}).forEach(function(e){return e.subSequence=A.subSequence}),s.filter(function(e){return e}).forEach(function(e){return R.addTrack(e)}),!t){e.next=79;break}return t.tracks=[],e.next=79,R.fromJson(t,this.sequencerEngine);case 79:this.sequencerEngine.tracks=c.filter(function(e){return e}),this.sequencerEngine.groups.updateGroupNumbers(),this.sequencerEngine.groups.groups.forEach(function(e){return e.updateRedux()}),this.sequencerEngine.switchToPattern(i),this.sequencerEngine.updateTracks(!0),this.sequencerEngine.selectTrack(this.sequencerEngine.tracks.length-s.length),this.sequencerEngine.dispatch(Object(C.bd)(void 0)),s.filter(function(e){return e}).forEach(function(e){return e.midiEffects.effects.filter(function(e){return e.lostParameters&&e.lostParameters.length>0}).forEach(function(e){return e.loadParameters(e.lostParameters)})}),t||(M=this.pad,s.filter(function(e){return e}).forEach(function(e,t){var n=M.slots.indexOf(!1);-1===n&&(M=A.subSequence.createPad()),M.addTrack(e,n),e.trackIsLoading=!1}));case 88:case"end":return e.stop()}},e,this,[[9,29,32,35]])}));return function(){return e.apply(this,arguments)}}()},{key:"fromJson",value:function(e){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e),this.frozenGroup=e.frozenGroup,this.frozenTracks=e.frozenTracks}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{frozenGroup:this.frozenGroup,frozenTracks:this.frozenTracks})}}]),n}(Ke),Cr=n(169);function Nr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Rr=function(e){Object(u.a)(n,e);var t=Nr(n);function n(e,r,a,i,s,c){var u;return Object(o.a)(this,n),(u=t.call(this,e,r,a,i,s,c)).setupEffects(),u.recordingMode=Cr.a,u.deleteInlet("trigger "),u.deleteInlet("audition sample"),u.deleteInlet("restart"),u.deleteOutlet(Xe.q),u}return Object(s.a)(n,[{key:"selectedRecording",get:function(){return this.trackData.selectedRecording},set:function(e){this.trackData.selectedRecording=e}},{key:"isRecorable",value:function(){return!0}},{key:"getCopy",value:function(){var e=Object(Z.a)(Object(f.a)(n.prototype),"getCopy",this).call(this,function(e,t,r,a,i,o){return new n(e,t,r,i,a,i,o)});return e.selectedRecording=this.selectedRecording,e}},{key:"getName",value:function(){return"Audio Track"}},{key:"getSelectedRecording",value:function(){return this.selectedRecording}},{key:"setSelectedRecording",value:function(e){this.selectedRecording=e}},{key:"getRecordings",value:function(){return Object(Z.a)(Object(f.a)(n.prototype),"getSamplers",this).call(this)}},{key:"saveBuffer",value:function(e){Object(Z.a)(Object(f.a)(n.prototype),"saveBuffer",this).call(this,e),this.setSelectedRecording(0)}},{key:"getJson",value:function(){var e=Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this);return e.selectedRecording=this.selectedRecording,e}},{key:"getSelectedRecordingSampler",value:function(){return Object(Z.a)(Object(f.a)(n.prototype),"getSamplers",this).call(this)[this.selectedRecording]}},{key:"getSelectedRecordingSoundId",value:function(){return this.soundIds[this.selectedRecording]}},{key:"getTrackType",value:function(){return A.a}},{key:"toggleEnabled",value:function(){Object(Z.a)(Object(f.a)(n.prototype),"toggleEnabled",this).call(this)}},{key:"setIsEnabled",value:function(e){Object(Z.a)(Object(f.a)(n.prototype),"setIsEnabled",this).call(this,e);var t=this.audioInputManager;t&&(t.monitorVolume.gain.value=this.isEnabled?1:0)}},{key:"length",get:function(){if(0===this.frozenColumns.length||this.frozenColumns.every(function(e){return!e.frozenSamplers[e.playing]}))return Object(Z.a)(Object(f.a)(n.prototype),"length",this);var e=this.frozenColumns.map(function(e){return e.frozenSamplers[e.playing]}).filter(function(e){return e}),t=this.getMaxDuration(),r=e[0].tempo/this.sequencerEngine.bpm;return Mr(r*t/H.a.Time("32n").toSeconds())}},{key:"getMaxDuration",value:function(){var e=this.frozenColumns.map(function(e){return e.frozenSamplers[e.playing]}).filter(function(e){return e});return 0===e.length?1:Math.max.apply(Math,Object(h.a)(e.map(function(e){return e.getDuration()})))}},{key:"isAudioTrack",get:function(){return!0}},{key:"scheduleAnyRecording",value:function(e,t){e%(this.length/2)===0||e%this.length===0?this.recordingMode===Cr.b?(this.startRecording(t),this.recordingMode=Cr.c):this.recordingMode===Cr.d&&(this.stopRecording(t),this.recordingMode=Cr.a):this.countdown=Math.min(this.length/2-e%(this.length/2),this.length-e%this.length)}},{key:"getSampler",value:function(){return this.frozenColumns.map(function(e){return e.frozenSamplers[e.playing]}).filter(function(e){return e})[0]}}]),n}(Or),Mr=function(e){Math.round(e);return e-e%32},Ar=Rr;function qr(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Dr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dr(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ir=pe.a.baseResolution,_r=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l,f,h,p,d,m;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.sequencerEngine,r=t.trackData,i=t.patterns,o=t.trackNumber,s=t.subSequence,c=t.patternParameters,u=t.tracks,l=t.trackEffects,f=t.trackMidiEffects,h=t.trackEffectChains,p=t.patternToLoad,d=t.numPatterns,e.next=3,Fr(n,r,i,o,s);case 3:return m=e.sent,e.next=6,Lr({sequencerEngine:n,track:m,tracks:u,patterns:i,trackData:r,trackEffects:l,trackMidiEffects:f,patternParameters:c,trackEffectChains:h,subSequence:s,numPatterns:d,patternToLoad:p});case 6:return m.loadLostParameters(),e.abrupt("return",m);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Fr=function(){var e=Object(i.a)(a.a.mark(function e(t,n,r,i,o){var s,c,u,l,f,h=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=h.length>5&&void 0!==h[5]?h[5]:r.length,"type"in n&&"MIDI"===n.type,c=n.type,u=void 0,c===A.d?u=new Er(i,t,t.mixSession,s,function(){return t.update()},t.sends):c===A.f?(u=new Ke(i,t,t.mixSession,s,function(){return t.update()},o)).trackNumber=i:c===A.a?u=new Ar(i,t,t.mixSesion,s,function(){return t.update()},o):c===A.e?u=new Tr(i,t,t.mixSession,s,function(){return t.update()},o):c!==A.b&&c!==A.c||(l=n.instrumentType,u=pr(t,c,l)),u.trackNumber=i,u.setSends(t.sends),e.next=9,u.fromJson(n);case 9:return(f=e.sent)&&u.sequencerEngine.dispatch(Object(C.Vb)(f)),e.abrupt("return",u);case 12:case"end":return e.stop()}},e)}));return function(t,n,r,a,i){return e.apply(this,arguments)}}(),Lr=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l,f,h,d,m,v,b,g,y,k,O,j,w,E,S,P,x,T,N,R,A,D,_,F,L,B;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.sequencerEngine,r=t.track,i=t.tracks,o=t.patterns,s=t.trackData,c=t.patternParameters,u=t.trackEffects,l=t.trackMidiEffects,f=t.trackEffectChains,h=t.subSequence,d=t.numPatterns,m=void 0===d?o.length:d,v=t.patternToLoad,b=-16,g=[],y={},e.next=6,Br({sequencerEngine:n,trackEffectChains:f,trackEffects:u,track:r,trackNumber:r.trackNumber,tracks:i});case 6:k=e.sent,O=k.effects,j=zr(l,r),w=j.effects,y=Object(p.a)({},y,k.bulk,j.bulk),E=0;case 12:if(!(E<m)){e.next=39;break}S=[],P=o[v||E],(x="size"in P?P.size:Ir)>b&&(b=x),T="buckets"in P,(N=new I.a(n,r)).changeLength(x,!1),R=0;case 21:if(!(R<x)){e.next=33;break}if(R in P){e.next=26;break}return A=N.stepBuckets[R],S.push(A),e.abrupt("continue",30);case 26:if(D=N.stepBuckets[R],_=P[R],T)for(L in _)(B=D.steps[L]||new q.a).track=r,B.stepNumber=R,B.simpleLoad(_[L],O,r,w),D.steps[L]=B;else(F=D.steps[0]).track=r,F.stepNumber=R,F.simpleLoad(P[R],O,r,w),D.steps[0]=F;S.push(D);case 30:R++,e.next=21;break;case 33:N.loadStepBuckets(void 0,!0),c&&N.loadFromJson(c[E]),g.push(N);case 36:E++,e.next=12;break;case 39:return r.patterns=g,r.pattern.muted=s.muted,r.gated=s.gated,e.next=44,M(r,s,h);case 44:r.setupEffects(),n.dispatch(Object(C.Vb)(y));case 46:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Br=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l,f,h,d,m,v,b,g,y,k,O,j,w;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sequencerEngine,r=t.track,i=t.trackEffects,o=t.trackEffectChains,s=t.trackNumber,c=t.tracks,u={},l=[],f=r.effectsChains[0],void 0===i){e.next=28;break}h=qr(i),e.prev=6,h.s();case 8:if((d=h.n()).done){e.next=17;break}return m=d.value,e.t0=l,e.next=13,Object(F.a)(m,c,n,s);case 13:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 15:e.next=8;break;case 17:e.next=22;break;case 19:e.prev=19,e.t2=e.catch(6),h.e(e.t2);case 22:return e.prev=22,h.f(),e.finish(22);case 25:f.updateEffects(l.map(function(e){return e.effect})),e.next=29;break;case 28:if(void 0!==o){v=[],b=qr(o);try{for(b.s();!(g=b.n()).done;){for(O in y=g.value,k=new _.a(r.gainNode,r.trackNode,(new L.a).forTrack(r),n),y)j=y[O],w=Object(F.a)(j,c,n,s),k.addEffect(w.effect),u=Object(p.a)({},u,w.bulk);k.updateEffects(),v.push(k)}}catch(a){b.e(a)}finally{b.f()}r.effectsChains.forEach(function(e){return e.dispose()}),r.effectsChains=v}else l=Object(B.a)(n),f.updateEffects(l);case 29:return e.abrupt("return",{effects:l,bulk:u});case 30:case"end":return e.stop()}},e,null,[[6,19,22,25]])}));return function(t){return e.apply(this,arguments)}}(),zr=function(e,t){if(void 0!==e){var n=t.midiEffects.fromJson(e);return t.updateMidiEffectsRedux(),{effects:t.midiEffects.effects,bulk:n}}return{effects:[],bulk:{}}},Vr=(n(457),n(52)),Hr=n(11),Ur=n(270),Jr=n(363),Gr=n(364),Wr=function(){function e(t,n,r,a,i){Object(o.a)(this,e),this.id=Object(j.uuid)(),this.tracks=[],this.subSequence=i,this.sequencerEngine=a,this.groupNumber=r,this.tags=t,this.inputNode=new V.Volume,this.outputNode=new V.PanVol,this.muteableNode=new V.Volume,this.muteableNode.connect(this.outputNode),this.meter=new V.Meter(.9),this.outputNode.connect(this.meter),this.effectsChain=new _.a(this.inputNode,this.muteableNode,(new L.a).forGroup(this),a),this.effectsChain.setupEffects(),this.setVolume(-2),this.channelMixer=n,this.outputs=void 0,this.muted=!1,this.panning=0}return Object(s.a)(e,[{key:"updateRedux",value:function(){this.sequencerEngine.store.dispatch(Object(C.uc)(this.id,Object(h.a)(this.tracks)))}},{key:"mix",get:function(){return this.subSequence.mix}},{key:"solo",get:function(){var e=!1;for(var t in this.tracks)e=e||this.tracks[t].getSolo();return e},set:function(e){this.tracks.forEach(function(t){return t.solo(e)})}},{key:"effects",get:function(){return this.effectsChain.effects}},{key:"getEffectNumber",value:function(e,t){return this.effects.indexOf(e)}},{key:"dispose",value:function(){this.outputs=this.channelMixer.disconnect(this.outputNode,this.outputs),this.inputNode.dispose(),this.muteableNode.dispose(),this.outputNode.dispose(),this.inputNode=void 0,this.outputNode=void 0,this.effectsChain.dispose(),this.effectsChain=void 0}},{key:"mute",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.sequencerEngine.store.getState().mix.isRecordingMix&&this.mix.addEvent(new Gr.a(this.groupNumber,e)),this.muted=e,this.muteableNode.volume.value=e?-125:0}},{key:"moveEffectTo",value:function(e,t){this.effectsChain.moveEffectTo(e,t)}},{key:"deleteEffect",value:function(e){this.effectsChain.deleteEffect(e)}},{key:"connectAudio",value:function(e){this.outputs=this.channelMixer.connect(this.outputNode)}},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u,l,f,h,d;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t.newVolume?this.setVolume(Object(Ur.b)(t.volume,0,128)):t.newestVolume?this.setVolume(t.volume):(r=128*(t.volume+40)/43,this.setVolume(r)),i=[],o=0;o<t.tracks.length;o++)void 0!==(s=n.tracks[t.tracks[o]])&&(s.getTrackType()===A.f&&s.sample&&i.push(s.sample.fetchTags()),this.addTrack(s));c={},u=0;case 5:if(!(u<t.effects.length)){e.next=14;break}return e.next=8,Object(F.a)(t.effects[u],n.tracks,n);case 8:l=e.sent,this.effectsChain.addEffect(l.effect),c=Object(p.a)({},c,l.bulk);case 11:u++,e.next=5;break;case 14:return Object.keys(c).length>0&&this.sequencerEngine.store.dispatch(Object(C.Vb)(c)),e.next=17,Promise.all(i);case 17:for(f=e.sent,h=new Set,d=0;d<f.length;d++)f[d].forEach(function(e){return h.add(e)});return this.tags=Array.from(h),e.abrupt("return",this);case 22:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSendNodes",value:function(){return[]}},{key:"addTrack",value:function(e){this.hasTrack(e)||(this.tracks.push(e),e.addToGroup(this))}},{key:"hasTrack",value:function(e){return this.tracks.indexOf(e)>-1}},{key:"setVolume",value:function(e){e=Math.min(1,e),this.sequencerEngine.store.getState().mix.isRecordingMix&&this.mix.addEvent(new Jr.a(this.groupNumber,e)),this.volume=e,this.outputNode.volume.linearRampToValueAtTime(e,V.Master.context.currentTime+.01),this.sequencerEngine.store.dispatch(Object(C.vc)(this.groupNumber,e)),this.subSequence.groups.sendVolumes()}},{key:"setPanning",value:function(e){this.panning=e,this.outputNode.pan.value=e}},{key:"updateEffects",value:function(e){this.effectsChain.updateEffects()}},{key:"getJson",value:function(e){return{newestVolume:!0,tracks:this.tracks.map(function(e){return e.trackNumber}),effects:this.effectsChain.getJson(),volume:this.volume,outputs:this.outputs}}}]),e}(),Kr=new(function(){function e(){Object(o.a)(this,e),this.groups=[]}return Object(s.a)(e,[{key:"useGroup",value:function(e,t,n,r,a){if(0===this.groups.length||!window.explore)return new Wr(e,t,n,r,a);var i=this.groups.pop();return i.subSequence=a,i.channelMixer=t,i.sequencerEngine=r,i.tags=e,i.groupNumber=n,i.subSequence=a,i}},{key:"releaseGroup",value:function(e){window.explore?(e.outputNode.disconnect(),e.tracks=[],e.updateRedux(),e.effectsChain.clear(),this.groups.push(e)):e.dispose()}}]),e}());function Xr(e,t){return e.filter(function(e){return-1!==t.indexOf(e)})}var Qr=function(){function e(t,n,r,a){Object(o.a)(this,e),this.groups=[],this.subSequence=a,this.channelMixer=t,this.sends=n,this.sequencerEngine=r,this.doneLoading=!1}return Object(s.a)(e,[{key:"startSendingLevels",value:function(){var e=this;setInterval(function(){if(e.zObject){var t=e.groups.map(function(e){var t=e.meter.getLevel();return t<-80?0:Math.pow((t+80)/86,2)});e.zObject.sendMessage("group levels",t)}},20)}},{key:"sendVolumes",value:function(){this.zObject&&this.zObject.sendLevels()}},{key:"deleteGroup",value:function(e){e.tracks.forEach(function(e){return e.dispose()}),e.dispose();var t=this.groups.indexOf(e);this.groups.splice(t,1),this.updateGroupNumbers()}},{key:"updateGroupNumbers",value:function(){for(var e=0;e<this.groups.length;e++)this.groups[e].groupNumber=e}},{key:"newGroup",value:function(e){var t=Kr.useGroup([],this.channelMixer,this.groups.length,this.sequencerEngine,this.subSequence);return this.groups.push(t),t.connectAudio(this.getMaxChannel()),e&&this.addToGroup(e,t),t}},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(i.a)(a.a.mark(function e(i,o){var s,c,u,l,f,h;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=4;break}return r.sequencerEngine.tracks.forEach(function(e){return r.addTrack(e)}),i(),e.abrupt("return");case 4:s=0;case 5:if(!(s<t.length)){e.next=15;break}return c=t[s],e.next=9,Kr.useGroup([],r.channelMixer,r.groups.length,r.sequencerEngine,r.subSequence).fromJson(c,n);case 9:(u=e.sent).tracks.length>0&&(u.connectAudio(r.getMaxChannel()),r.groups.push(u)),c.outputs&&(l=Object(Hr.a)(c.outputs,2),f=l[0],h=l[1],r.channelMixer.switchChannelOutput(u.outputNode,f,h)&&(u.outputs=[f,h]));case 12:s++,e.next=5;break;case 15:i();case 16:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateGroups",value:function(){this.groups.forEach(function(e){return e.setVolume(e.volume)}),this.groups.forEach(function(e){return e.setPanning(e.panning)})}},{key:"addToGroup",value:function(e,t){var n=e.group,r=1==n.tracks.length,a=this.groups.indexOf(n);e.disconnectFromGroup(),t.addTrack(e),t.tags=Array.from(new Set(t.tags.concat(n.tags))),r?(this.groups.splice(a,1),n.dispose(),this.groups.forEach(function(e,t){return e.groupNumber=t})):(a=n.tracks.indexOf(e),n.tracks.splice(a,1)),t.updateRedux(),n.updateRedux()}},{key:"deleteTrack",value:function(e){var t=e.group;if(void 0!==t&&null!==t){var n=1==t.tracks.length,r=this.groups.indexOf(t);e.disconnectFromGroup(),n?(this.groups.splice(r,1),t.dispose()):(r=t.tracks.indexOf(e),t.tracks.splice(r,1))}}},{key:"addTrack",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.getTrackType(),e.next=e.t0===A.f?3:10;break;case 3:if(void 0!==(n=t.sample.tags)){e.next=8;break}return e.next=7,t.sample.fetchTags();case 7:n=e.sent;case 8:return this.resolveTrackTags(t,n),e.abrupt("break",11);case 10:this.resolveTrackTags(t,[t.getTrackType()]);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addMidiTrack",value:function(e){this.resolveTrackTags(e,["Midi Tracks"])}},{key:"resolveTrackTags",value:function(e,t){var n=0,r=null;if(this.groups.length>=4)r=this.groups[Math.floor(4*Math.random())];else for(var a in this.groups){var i=this.groups[a],o=Xr(i.tags,t);o.length>n&&(r=i,n=o.length)}null!=r?(r.tags=Xr(r.tags,t),r.addTrack(e)):this.newGroup().addTrack(e)}},{key:"dispose",value:function(){this.groups.forEach(function(e){return Kr.releaseGroup(e)}),this.groups=void 0}},{key:"getJson",value:function(e){return this.groups.map(function(t){return t.getJson(e)})}},{key:"getMaxChannel",value:function(){var e=[];this.groups.map(function(e){return e.outputs}).filter(function(e){return void 0!==e}).forEach(function(t){return e=e.concat(t)}),this.sends.sends.map(function(e){return e.outputs}).filter(function(e){return void 0!==e}).forEach(function(t){return e=e.concat(t)});var t=e.sort(function(e,t){return e-t}).reverse();if(0===t.length)return-1;for(var n=t[0],r=0;r<n;r+=2)if(-1==t.indexOf(r)&&-1==t.indexOf(r+1))return r-1;return n}}]),e}(),Yr=n(290),Zr=n(97);function $r(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ea=n(823),ta=n(821),na=n(796);function ra(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var aa=function(e){return function(e){Object(u.a)(n,e);var t=ra(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"dispatch",value:function(e){this.sequencerEngine.dispatch(e)}},{key:"state",get:function(){return this.sequencerEngine.state}}]),n}(e)},ia=n(294),oa=n(441),sa=n(86);function ca(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function ua(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return la(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return la(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function la(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ha=function(e){Object(u.a)(n,e);var t=fa(n);function n(e,r){var a;return Object(o.a)(this,n),(a=t.call(this))._subSequence=e,a.sequencerEngine=r,a.effects=[],a.inputedTriggers=[],a.initShadowEffects(),a}return Object(s.a)(n,[{key:"subSequence",get:function(){return this._subSequence}},{key:"linkEffectParameters",value:function(){var e=this;[].concat(Object(h.a)(this.effects),Object(h.a)(this.shadowEffects)).forEach(function(t){t.registerContext((new L.a).forSubSequence(e.subSequence))});var t,n={},r=ua(this.effects);try{for(r.s();!(t=r.n()).done;){var a,i=ua(t.value.getParameters());try{for(i.s();!(a=i.n()).done;){var o=a.value;n=Object(p.a)({},n,o.setStore(this.sequencerEngine.store))}}catch(s){i.e(s)}finally{i.f()}}}catch(s){r.e(s)}finally{r.f()}this.sequencerEngine.dispatch(Object(C.Vb)(n))}},{key:"stop",value:function(){Object(Z.a)(Object(f.a)(n.prototype),"stop",this).call(this),this.shadowEffects.forEach(function(e){return e.stop()})}},{key:"clear",value:function(){Object(Z.a)(Object(f.a)(n.prototype),"clear",this).call(this),this.shadowEffects.forEach(function(e){return e.clear()})}},{key:"dispatch",value:function(e){this.sequencerEngine.dispatch(e)}},{key:"state",get:function(){return this.sequencerEngine.state}},{key:"input",value:function(e){this.inputedTriggers.push(e)}},{key:"output",value:function(e,t,n){var r=this,a=this.inputedTriggers,i=[].concat(Object(h.a)(this.effects),Object(h.a)(this.shadowEffects));for(var o in i){var s=i[o];if(s.isEnabled()){for(var c in a){var u=a[c];s.input(u)}a=s.output(e,t,n)}}return 0!==this.transposeParameter.get()?a.map(function(e,t){return(e=r.shadowEffects[0].copyTrigger(e,t<16)).stepData.transpose+=r.transposeParameter.get(),e}):a}},{key:"getJson",value:function(){var e=Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),t=this.shadowEffects.map(function(e){return Object(p.a)({},e.getJson(),{isShadowEffect:!0})});return t.push({isShadowEffect:!0,transposeParameter:this.transposeParameter.getJson()}),[].concat(Object(h.a)(e),Object(h.a)(t))}},{key:"fromJson",value:function(e){var t=e.filter(function(e){return!e.isShadowEffect}),r=Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,t),a=e.filter(function(e){return e.isShadowEffect});for(var i in a)a[i=parseInt(i)].transposeParameter?this.transposeParameter.fromJson(a[i].transposeParameter):r=Object(p.a)({},this.shadowEffects[i].fromJson(a[i]),r);return r}},{key:"onNewStep",value:function(){this.inputedTriggers=[],[].concat(Object(h.a)(this.effects),Object(h.a)(this.shadowEffects)).forEach(function(e){return e.onNewStep()})}},{key:"triggerAttackPostFXEnvelopes",value:function(e){}},{key:"triggerAttackPreFXEnvelopes",value:function(e,t){}},{key:"triggerReleasePostFXEnvelopes",value:function(e){}},{key:"triggerReleasePreFXEnvelopes",value:function(e,t){}}]),n}(function(e){return function(e){Object(u.a)(n,e);var t=ca(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).shadowEffects=[],e}return Object(s.a)(n,[{key:"initShadowEffects",value:function(){var e=this;this.transposeParameter=new $.a("transpose",this,function(){return[]},{min:-32,max:32,defaultValue:0}),this.transposeParameter.setStore(this.sequencerEngine.store),this.transposeParameter.setContext((new L.a).forSubSequence(this.subSequence)),this.shadowEffects=[Object(sa.c)("Sparse",this._subSequence),Object(sa.c)("Stats",this._subSequence),Object(sa.c)("Note Display",this._subSequence)],this.shadowEffects.forEach(function(t){return t._subSequence=e._subSequence})}}]),n}(e)}(oa.a)),pa=n(324),da=n(79);function ma(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function va(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ba(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ba(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ga=function(e,t){return e.adjacencyLists[t.id].map(function(e){return{edge:e,effect:e.effect}})},ya=function(e,t){var n=e.adjacencyLists,r=[],a=function(a){n[a].filter(function(e){return e.effect===t}).forEach(function(t){var n="-1"===a?e.inputNode:"-2"===a?e.outputNode:e.effects.find(function(e){return e.id===a});r.push({effect:n,edge:t})})};for(var i in n)a(i);return r},ka={shuffle:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n[0],i=n[1],o=e.effectRack,s=Object(h.a)(o.effects);s.sort(function(e,t){return e.id.localeCompare(t.id)});var c=s[i],u=s[a];if(c&&u&&c!==u){var l=ga(o,c),f=ya(o,c),p=ga(o,u),d=ya(o,u);[].concat(Object(h.a)(l),Object(h.a)(f),Object(h.a)(p),Object(h.a)(d)).forEach(function(e){var t=e.edge;o.deleteEdge(t)});var m,v=va(f);try{for(v.s();!(m=v.n()).done;){var b=m.value,g=b.effect;b.effect===u&&(g=c),g!==u&&o.connectNodes(g,u)}}catch(R){v.e(R)}finally{v.f()}var y,k=va(d);try{for(k.s();!(y=k.n()).done;){var O=y.value,j=O.effect;O.effect===c&&(j=u),j!==c&&o.connectNodes(j,c)}}catch(R){k.e(R)}finally{k.f()}var w,E=va(l);try{for(E.s();!(w=E.n()).done;){var S=w.value,P=S.effect;S.effect===u&&(P=c),o.connectNodes(u,P)}}catch(R){E.e(R)}finally{E.f()}var x,T=va(p);try{for(T.s();!(x=T.n()).done;){var C=x.value,N=C.effect;C.effect===c&&(N=u),o.connectNodes(c,N)}}catch(R){T.e(R)}finally{T.f()}}}},Oa=n(694),ja=n(215),wa=n(102),Ea=(n(68),n(19));Object(Ea.a)("!",{n:"Number to compare to"},"Not boolean",function(){return 1},{inlets:1,tags:["Math"]});Object(Ea.a)("<",{n:"Number to compare to"},"Allows messages to pass if they are less than a given number",function(){return 2},{inlets:2,tags:["Math"]});Object(Ea.a)(">",{n:"Number to compare to"},"Allows messages to pass if they are greater than a given number",function(){return 2},{inlets:2,tags:["Math"]});Object(Ea.a)("=",{n:"Number to compare to"},"Allows messages to pass if they are equal to a given number",function(){return 2},{inlets:2,tags:["Math"]});Object(Ea.a)("<=",{n:"Number to compare to"},"Allows messages to pass if they are less than or equal to a given number",function(){return 2},{tags:["Math"]});Object(Ea.a)(">=",{n:"Number to compare to"},"Allows messages to pass if they are greater than or equal to a given number",function(){return 2},{tags:["Math"]});Object(Ea.a)("&&",{a:"Number to compare to"},"Applies logical AND to the arguments",void 0,{inlets:2,tags:["Math"],isHot:!0});Object(Ea.a)("||",{a:"Number to compare to"},"Applies logical OR to the arguments",void 0,{isHot:!0,inlets:2,tags:["Math"]});var Sa={"=":function(e,t){return function(e){try{return parseFloat(e[0])===parseFloat(t())?["bang"]:[void 0,"bang"]}catch(n){return}}},"<":function(e,t){return function(e){try{return parseFloat(e[0])<parseFloat(t())?["bang"]:[void 0,"bang"]}catch(n){return[void 0,"bang"]}}},">":function(e,t){return function(e){try{return parseFloat(e[0])>parseFloat(t())?["bang"]:[void 0,"bang"]}catch(n){return}}},"<=":function(e,t){return function(e){try{return parseFloat(e[0])<=parseFloat(t())?["bang"]:[void 0,"bang"]}catch(n){return}}},">=":function(e,t){return function(e){try{return parseFloat(e[0])>=parseFloat(t())?["bang"]:[void 0,"bang"]}catch(n){return}}},"&&":function(e,t,n){return function(e){return e[0]&&t()?["bang"]:void 0}},"||":function(e,t){return function(e){return t()||e[0]?["bang"]:void 0}},"!":function(e){return function(e){try{return!parseFloat(e[0])}catch(t){return[void 0,"bang"]}}}};function Pa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var xa=function(e){Object(u.a)(n,e);var t=Pa(n);function n(e){var r,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o.a)(this,n),(r=t.call(this)).id=Object(j.uuid)(),r.zObject=e,a&&(r.zObject.effect=Object(c.a)(r)),r.subSequence=e.subSequence,r.sequencerEngine=r.subSequence.sequencerEngine,r.sequencerEngine.idToObject[r.id]=Object(c.a)(r),r.zObject.newAttribute("fill subpatch",!1),r}return Object(s.a)(n,[{key:"getParameters",value:function(){return[]}},{key:"fromJson",value:function(e,t){t||(this.id=e.id,this.sequencerEngine.idToObject[this.id]=this)}},{key:"getJson",value:function(){return{id:this.id}}}]),n}(Object(wa.a)(function(){return function e(){Object(o.a)(this,e)}}()));function Ta(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ca=function(e){Object(u.a)(n,e);var t=Ta(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet("url",function(e){return r.url=e[0]}),r}return n}(xa);Object(Ea.a)("icon",{},"creates an icon with supplied",function(){return 0},{inlets:0});Object(Ea.a)("document.title",{title:""},"Sets the title of the webpage to the argument passed");Object(Ea.a)("modal",{show:"1 to show 0 to hide",text:"The main text (arrays are seperated by lines)","ok button text":"","cancel button text":"","link text":"","link url":""},"Creates a modal",function(){return 2},{inlets:6});Object(Ea.a)("progressbar",{"start/stop":"",text:""},"Shows a progressbar spinner",function(){return 0},{inlets:2});var Na=n(746),Ra=n(93);Object(Ea.a)("spore",{"spore hash":"ipfs hash of new spore sound",tokenID:"tokenID of spores.vision ERC720"},"Creates a new spore",function(){return 1},{inlets:2});Object(Ea.a)("haptic.vibrate",{ms:"milliseconds to vibrate"},"Vibrates on mobile for specified time");function Ma(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Aa=function(e){Object(u.a)(n,e);var t=Ma(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newOutlet("on pressed"),r.newOutlet("on released"),r}return n}(xa);Object(Ea.a)("buttonPresser",{},"Sends a bang thru one outlet on press and thru another one release",function(){return 0},{inlets:0});function qa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Da=function(e){Object(u.a)(n,e);var t=qa(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).envelope=new Nn(r.sequencerEngine,r.sequencerEngine.mixSession,(new L.a).forZObject(r.zObject),0),r.envelope.attack=5,r.envelope.decay=90,r.envelope.sustain=.1,r.envelope.release=15,r.newInlet("modulate parameter",function(e){var t=Object(Hr.a)(e,1)[0];return r.onParameter(t)}),r.newInlet("trigger attack release",function(e){var t=Object(Hr.a)(e,1)[0];return r.onTriggerAttackRelease(t)}),r.newInlet("attack",function(e){var t=Object(Hr.a)(e,1)[0];return r.envelope.attack=t}),r.newInlet("decay",function(e){var t=Object(Hr.a)(e,1)[0];return r.envelope.decay=t}),r.newInlet("release",function(e){var t=Object(Hr.a)(e,1)[0];return r.envelope.release=t}),r.newInlet("sustain",function(e){var t=Object(Hr.a)(e,1)[0];return r.envelope.sustain=t}),r.newOutlet("depth mapped"),r}return Object(s.a)(n,[{key:"onParameter",value:function(e){if(Array.isArray(e)){var t=Object(Hr.a)(e,4),n=t[0],r=t[1],a=t[2],i=t[3];if(r&&n){var o=n.parameters.find(function(e){return e.name.toLowerCase().includes(r.toLowerCase())});if(console.log("parameter found=",o),o&&o.audioParam){if(o.depthParameter||o.initDepth(),this.envelope.connect(o.audioParam,o,0),o.connectToDepth(void 0,this.envelope,!1),void 0!==a&&void 0!==i){var s=this.envelope.getScaleForParameter(o);s.min=a,s.max=i}console.log("sending depth mapped=",o.depthParameter),this.sendMessage("depth mapped",o.depthParameter)}}}}},{key:"onTriggerAttackRelease",value:function(e){var t=e.time,n=e.duration,r=e.velocity;this.envelope.triggerAttackRelease(n,t,r)}}]),n}(xa);Object(Ea.a)("envelope",{},"Creates a new envelope that can control parameters",function(){return 0},{inlets:0});var Ia={envelope:function(e){new Da(e);return e.attributes["primary-color"]="#cb3737",e.attributes["secondary-color"]="#1c1c1c",function(){return 0}}},_a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(isNaN(e))return e;var n=Math.pow(10,t);return Math.round(n*e)/n},Fa=n(125),La=function(e){return function(e){var t=new Set;return function e(n){if(n&&"object"===typeof n){if(-1!==t.has(n))return!0;for(var r in t.add(n),n)if(n.hasOwnProperty(r)&&e(n[r]))return!0}return!1}(e)}(e)?Array.isArray(e)?JSON.stringify(e):"object":JSON.stringify(e)};function Ba(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var za=function(e){return function(e){Object(u.a)(n,e);var t=Ba(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).attributes={},e.attributeCallbacks={},e}return Object(s.a)(n,[{key:"newAttribute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;this.attributes[e]=t,this.attributeCallbacks[e]=n}},{key:"setAttribute",value:function(e,t){this.attributes[e]=t,this.attributeCallbacks[e]&&this.attributeCallbacks[e](t)}}]),n}(e)};function Va(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ha=function(e){Object(u.a)(n,e);var t=Va(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ra.d,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(o.a)(this,n),(r=t.call(this)).subSequence=e,r.sequencerEngine=e.sequencerEngine,r.text="",r.type=a,r.window={id:Object(j.uuid)()},a===Ra.a?(r.message=Ra.a,r.storedMesage=Ra.a):a===Ra.c&&(r.text=0),r.id=s||Object(j.uuid)(),r.sequencerEngine.idToObject[r.id]=Object(c.a)(r),i?r.newInlet("Input",function(e){r._onExecute?r._onExecute(e[0]):i.apply(void 0,[e[0]].concat(Object(h.a)(e.splice(1))))}):r.newInlet("Input",function(e){r.type!==Ra.c||isNaN(e[0])?"bang"===e[0]?r.execute():(r.storedMessage=r.pipeText(e[0]),r.execute(r.storedMessage)):(r._text=e[0],r.storedMessage=e[0],r.execute(r.storedMessage))}),a!==Ra.a&&r.newInlet("Replace",function(e){return r.onReplaceText(e)}),r.newOutlet("Output"),a!==Ra.c&&r.newOutlet("Message Send"),r.min=0,r.max=100,r.round=!1,r.newAttribute("primary-color"),r.newAttribute("secondary-color"),r.newAttribute("background-color"),r.newAttribute("width",0),r.newAttribute("align to center",!1),r.newAttribute("Include in Presentation",!1),r}return Object(s.a)(n,[{key:"getObjectType",value:function(){return Zr.d}},{key:"getAllParameters",value:function(){return[]}},{key:"getJson",value:function(){return{id:this.id,attributes:this.attributes,isDeleted:this.isDeleted,type:this.type,text:this._text,message:this.type===Ra.c?this.message:void 0,inletNumber:this.inletNumber,outletNumber:this.outletNumber,min:this.min,max:this.max,round:this.round}}},{key:"fromJson",value:function(e,t){if(t||(this.id=e.id,this.sequencerEngine.idToObject[this.id]=this),void 0!==e.type&&(this.type=e.type),this.isDeleted=e.isDeleted,e.type,Ra.c,this.text=e.text,void 0!==e.type&&(this.type=e.type,this.type===Ra.a&&(this.message=Ra.a,this.storedMessage=Ra.a)),this.inletNumber=e.inletNumber,this.outletNumber=e.outletNumber,void 0!==this.inletNumber&&(this.isInlet=!0),void 0!==this.outletNumber&&(this.isOutlet=!0),void 0!==e.min&&(this.min=e.min),void 0!==e.max&&(this.max=e.max),void 0!==e.round&&(this.round=e.round),e.attributes)for(var n in e.attributes)this.setAttribute(n,e.attributes[n])}},{key:"sendReplacement",value:function(e){if(e=e[0],"string"===typeof this.message){var t=this.message.replaceAll("$1",e);this.execute(t)}else this.execute(e)}},{key:"pipeText",value:function(e){if(this.type===Ra.b){var t=Array.isArray(e)?e:[e];return this.message.map(function(e){var n=e;if("string"===typeof e){for(var r=0;r<t.length;r++)n=n.replaceAll("$"+(r+1),t[r]);Object(ae.a)(n)&&(n=parseFloat(n))}return n})}if("string"!==typeof this.message)return this.message;var n=this.message;if(Array.isArray(e))for(var r=0;r<e.length;r++)n=n.replaceAll("$"+(r+1),_a(e[r],3));else n="string"===typeof e?n.replaceAll("$1",e):n.replaceAll("$1",_a(e,3));return n}},{key:"onReplaceText",value:function(e){if(null!==e[0]){if(this.message=e[0],this.lastMessage=this.message,Array.isArray(this.message))this._text=this.message.map(function(e){return"object"===typeof e?La(e):e}).join(" ");else if(ArrayBuffer.isView(this.message))this._text=Array.from(this.message).join(" ");else if(Array.isArray(e[0]))this._text=e[0].join(" ");else if("string"===typeof e[0]||"number"===typeof e[0])this._text=e[0];else if(e[0])if(e[0].getJson)this._text=La(e[0].getJson());else try{this._text=La(e[0])}catch(t){this._text="input"}this.storedMessage=this.message}}},{key:"text",set:function(e){if(this.subSequence.propagate(Object(Fa.s)(this,e)),this.type===Ra.c)return this._text=e,this.message=e,void(this.storedMessage=this.message);if(e||(e=""),e=e.toString(),this.type===Ra.c)return this._text=e,this.message=parseFloat(e),void(this.storedMessage=this.message);this._text=e;var t=e.split(" ").filter(function(e){return""!=e});if(t.length>1){var n=[];this.type=Ra.b;try{if((n=t.map(function(e){return e.startsWith("$")?e:parseFloat(e)})).some(function(e){return(!e.startsWith||!e.startsWith("$"))&&isNaN(e)}))return this.message=e,this.storedMessage=this.message,void(this.type=Ra.d)}catch(r){return this.type=Ra.d,this.storedMessage=this.message,void(this.message=e)}this.message=n,this.storedMessage=this.message}else try{this.message=Object(ae.a)(e)?parseFloat(e):e,this.storedMessage=this.message,isNaN(this.message)&&(this.message=e)}catch(r){this.message=e,this.storedMessage=this.message}}},{key:"refresh",value:function(){this.lastSentMessage&&this.execute(this.lastSentMessage)}},{key:"execute",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.storedMessage;this.lastSentMessage=e,this.sendMessage("Output",e),this.sendMessage("Message Send",Ra.a)}},{key:"duplicate",value:function(){var e=this.getJson(),t=this.state.windows.windowPositions[this.id],n=t.x,r=t.y,a=this.width||200,i=(this.width,this.subSequence.createZMessage(n+a,r,this.dataType));i.fromJson(e,!0);var o=this.state.windows.presentationWindowPositions[this.id];o&&this.dispatch(Object(C.qe)(i.id,{x:o.x+a,y:o.y}))}}]),n}(za(aa(Object(wa.a)(function(){return function e(){Object(o.a)(this,e)}}()))));function Ua(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ja=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=new Ha(e.subSequence,Ra.c);return a.text=t,a.min=n,a.max=r,a},Ga=function(e){Object(u.a)(n,e);var t=Ua(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).x=Ja(Object(c.a)(r),0),r.y=Ja(Object(c.a)(r),0),r.z=Ja(Object(c.a)(r),0),r.zObject.hasInletFields=!0,r.newInlet("x",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.x,t)}),r.newInlet("y",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.y,t)}),r.newInlet("z",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.z,t)}),r.newOutlet("Vec3"),r}return Object(s.a)(n,[{key:"on",value:function(e,t){isNaN(t)||(e.text=t,this.sendObject())}},{key:"sendObject",value:function(){var e=[this.x._text,this.y._text,this.z._text];this.sendMessage("Vec3",e)}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{x:this.x._text,y:this.y._text,z:this.z._text})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.x.text=e.x,this.y.text=e.y,this.z.text=e.z}}]),n}(xa),Wa=n(37),Ka=n(166),Xa=n(78),Qa=n(80);Object(Ea.a)("gl.uniform",{value:"",name:"",skipRender:""},"Creates a new uniform variable with value from left-inlet, in GLSL.",function(){return 1},{tags:"GLSL",inlets:3});var Ya=function(e,t,n){e.needsHotReload=!0,e.needsLoad=!0;var r={};e.uniforms=r;var a={},i=void 0,o=void 0;return function(e,s){var c=Object(Hr.a)(e,1)[0],u=!!n&&n();if("start"===c){if(void 0!==o)return void(c=o);c=0}if("bang"===c&&(c=0),i!==t()&&0,i=t(),o=c,r[t()]){r[t()].value=c;var l=r[t()].update||window.fallBackUpdate[t()];if(l&&(l(c,u),!s))return}else r[t()]={value:c};return a.code=t(),a.uniforms=r,a.hashCode=Object(Ka.a)(a.code),a}};Object(Ea.a)("gl.variable",{value:"",name:"",type:""},"Creates a new uniform variable with value from left-inlet, in GLSL.",function(){return 1},{tags:"GLSL",inlets:3});var Za=function(e,t,n){e.needsHotReload=!0;var r={};return function(a){var i=Object(Hr.a)(a,1)[0];return r.code=t(),i&&i.uniforms?r.uniforms=i.uniforms:r.uniforms={},i&&i.functions&&(r.functions=i.functions),i&&i.variables?r.variables=Object(p.a)({},i.variables):r.variables={},r.variables[t()]={code:i&&i.code?i.code:Object(Wa.b)(i),type:n()},r.hashCode=Object(Ka.a)(r.code),e.flash(),r}},$a=n(422);Object(Ea.a)("gl.vec3",{x:"",y:"",z:""},"Creates a GLSL expression representing a 3-component vector, from each inlet",function(){return 1},{isHot:!0,tags:"GLSL",inlets:3});var ei=function(e,t,n){return Object(Xa.a)(function(r){var a=Object(Qa.a)(r,t,n);return e.flash(),"vec3(".concat(Object(Wa.b)(a[0]),", ").concat(Object(Wa.b)(a[1]),", ").concat(Object(Wa.b)(a[2]),")")},t,n)};Object(Ea.a)("gl.vec2",{x:"",y:""},"Creates a GLSL expression representing a 2-component vector, from each inlet",function(){return 1},{isHot:!0,tags:"GLSL",inlets:2});var ti=function(e,t){return Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"vec2(".concat(Object(Wa.b)(r[0]),", ").concat(Object(Wa.b)(r[1]),")")},t)};Object(Ea.a)("gl.vec4",{x:"",y:"",z:"",w:""},"Creates a GLSL expression representing a 4-component vector, from each inlet",function(){return 1},{isHot:!0,inlets:4,tags:"GLSL",connects:{object:"gl.fragColor"}});var ni={"gl.vec2":ti,"gl.vec3":ei,"gl.vec4":function(e,t,n,r){return Object(Xa.a)(function(a){var i=Object(Qa.a)(a,t,n,r);return e.flash(),"vec4(".concat(Object(Wa.b)(i[0]),", ").concat(Object(Wa.b)(i[1]),", ").concat(Object(Wa.b)(i[2]),", ").concat(Object(Wa.b)(i[3]),")")},t,n,r)}};function ri(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ai=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-10,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,a=new Ha(e.subSequence,Ra.c);return a.text=t,a.min=n,a.max=r,a},ii=function(e){Object(u.a)(n,e);var t=ri(n);function n(e){var r;Object(o.a)(this,n),(r=t.call(this,e)).x=ai(Object(c.a)(r),0),r.y=ai(Object(c.a)(r),0),r.zObject.hasInletFields=!0,r.newInlet("x",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.x,t)}),r.newInlet("y",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.y,t)}),r.newOutlet("List"),r.newOutlet("Vec2");var a=r.id.replaceAll("-","");return r.xUniform=Ya({},function(){return"vec2x"+a},function(){return!0}),r.yUniform=Ya({},function(){return"vec2y"+a},function(){return!0}),r.vec2=ti(r.zObject,function(){return r.yUniform([r.y._text],!0)}),r}return Object(s.a)(n,[{key:"on",value:function(e,t){isNaN(t)||(e.text=t,this.sendObject())}},{key:"sendObject",value:function(){var e=[this.x._text,this.y._text],t=this.xUniform([this.x._text],!0);this.yUniform([this.y._text],!0);this.sendMessage("List",e),this.sendMessage("Vec2",this.vec2([t]))}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{x:this.x._text,y:this.y._text})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.x.text=e.x,this.y.text=e.y}}]),n}(xa);Object(Ea.a)("vec3",{},"Creates a 3-component list made out of numbers",function(){return 0},{inlets:0});Object(Ea.a)("vec2",{},"Creates a 2-component list made out of numbers",function(){return 0},{inlets:0});var oi=n(149);function si(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ci(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ci(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ci(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(Ea.a)("rubik.init",{},"Initializes a rubiks cube returning a list of indices");var ui=[6,3,0,7,4,1,8,5,2],li=[2,5,8,1,4,7,0,3,6];Object(Ea.a)("rubik.turnFace",{face:"List of indices representing the face being turned",direction:"0 for left and 1 for right",dimension:"x or y"},"Turn a face (represented as list of indices) either left (0) or right (1)",function(){return 1},{inlets:3});Object(Ea.a)("rubik.getFace",{indices:"list of indices of the rubik cube (in its current configuration)",value:"value in dimension we want to acces",dimension:"x,y,z"},"Gets a list of indices representing a desired face",function(){return 1},{inlets:3});var fi=[[0,1,2,3,4,5,6,7,8],[9,10,11,12,13,14,15,16,17],[18,19,20,21,22,23,24,25,26]],hi=[[0,1,2,9,10,11,18,19,20],[3,4,5,12,13,14,21,22,23],[6,7,8,15,16,17,24,25,26]];Object(Ea.a)("rubik.setFace",{indices:"list of indices of the rubik cube (in its current configuration)",value:"value in dimension we want to acces",dimension:"x,y,z"},"Sets a list of indices representing a desired face in the rubiks indices and return the new cube",function(){return 1},{inlets:4});Object(Ea.a)("rubik.applyIndices",{"list to shuffle":"",indices:""},"Transforms a given a list using the indices passed in the right inlet",function(){return 1},{inlets:2});var pi={"rubik.turnFace":function(e,t,n){return function(e){var r,a=Object(Hr.a)(e,1)[0],i=[],o=0,s=si(("y"===n()?!t():t())?ui:li);try{for(s.s();!(r=s.n()).done;){var c=r.value;i[o]=a[c],o++}}catch(u){s.e(u)}finally{s.f()}return[i]}},"rubik.init":function(){return function(e){Object(oi.a)(e);for(var t=[],n=0;n<27;n++)t.push(n);return[t]}},"rubik.getFace":function(e,t,n){return function(e){for(var r=Object(Hr.a)(e,1)[0],a=t(),i="y"===n()?fi[a]:hi[a],o=[],s=0;s<i.length;s++)o.push(r[i[s]]);return[o]}},"rubik.setFace":function(e,t,n,r){return function(e){var a=Object(Hr.a)(e,1)[0],i=n(),o=r(),s=t();Object(h.a)(a),a=Object(h.a)(a);for(var c="y"===o?fi[i]:hi[i],u=0;u<c.length;u++)a[c[u]]=s[u];return[a]}},"rubik.applyIndices":function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0],r=t();if(!r)return[n];for(var a=[],i=0;i<n.length;i++){var o=n[i];a[r[i]]=o}return[a]}}};Object(Ea.a)("list.fillIndex",{size:""},"Creates a list of size n with elements from 0...n");var di={"list.fillIndex":function(){return function(e){for(var t=Object(Hr.a)(e,1)[0],n=[],r=0;r<t;r++)n.push(r);return[n]}}};function mi(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return vi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vi(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function vi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bi=["A","B","C","D","E"];Object(Ea.a)("audioFX",{name:""},"Creates an audio fx (to be put somewhere",function(){return 1},{inlets:2});Object(Ea.a)("mixChannel",{},"Controls effects in the mix channel");Object(Ea.a)("sendChannel",{name:""},"Controls effects in a send channel",function(){return 2},{outlets:["Effects","Send"]});Object(Ea.a)("sendVolumes",{name:""},"Controls send volumes of tracks",function(e){return 1},{});Object(Ea.a)("groupSendVolumes",{name:""},"Controls send volumes of groups of tracks",function(e){return 1},{});var gi={audioFX:function(e,t){return function(n){Object(Hr.a)(n,1)[0];var r=Object(sa.b)(t(),e.sequencerEngine);if(r)return[r]}},mixChannel:function(e){return function(t){var n=Object(Hr.a)(t,1)[0],r=e.sequencerEngine.channelMixer.masterChannel.effectsChain,a=r.effects.find(function(e){return e.name===n.name});return a?[a]:(r.addEffect(n),[n])}},sendChannel:function(e,t){return function(n){var r=Object(Hr.a)(n,1)[0],a=e.sequencerEngine.sends.sends.find(function(e){return e.name.toLowerCase()===t().toLowerCase()}),i=a.effectsChain,o=i.effects.find(function(e){return e.name===r.name});return o?[o,a]:(i.addEffect(r),[r,a])}},sendVolumes:function(e,t){return function(n){var r=Object(Hr.a)(n,1)[0];if(Array.isArray(r)){var a=Object(Hr.a)(r,2),i=a[0],o=a[1],s=e.sequencerEngine.tracks[i];if(s){var c=s.sendNodeVolumeParameters[bi.indexOf(t())];if(c){var u=If(o,-80,2,1);c.set(u,!1)}}}}},groupSendVolumes:function(e,t){return function(n){var r=Object(Hr.a)(n,1)[0];if(Array.isArray(r)){var a=Object(Hr.a)(r,2),i=a[0],o=a[1],s=e.sequencerEngine.groups.groups[i];if(s){var c,u=mi(s.tracks);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(!l)return;var f=l.sendNodeVolumeParameters[bi.indexOf(t())];if(!f)return;var h=If(o,-80,2,1);f.set(h,!1)}}catch(p){u.e(p)}finally{u.f()}}}}}};function yi(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ki(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ki(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ki(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ji=function(e){Object(u.a)(n,e);var t=Oi(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet("Playback Speed",function(e){var t=Object(Hr.a)(e,1)[0];return r.onPlaybackSpeed(t)}),r.bpm=r.sequencerEngine.bpm,r}return Object(s.a)(n,[{key:"onPlaybackSpeed",value:function(e){var t=50+(this.bpm-50)*(1-e),n=2e3*(1-e)-2e3;this.sequencerEngine.bpmParameter.set(t,!1);var r,a=yi(this.sequencerEngine.tracks);try{for(a.s();!(r=a.n()).done;){var i=r.value;i.instrument?i.instrument.detuneParameter&&i.instrument.detuneParameter.set(n,!1):i.getSamplers().forEach(function(e){return e.detuneParameter.set(n,!1)})}}catch(o){a.e(o)}finally{a.f()}}}]),n}(xa);Object(Ea.a)("playback",{},"",function(){return 0},{inlets:0});function wi(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ei(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ei(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Si(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Pi=function(e){Object(u.a)(n,e);var t=Si(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet("group volumes",function(e){var t=Object(Hr.a)(e,1)[0];return r.onLevels(t)}),r.newOutlet("group volumes "),r.newOutlet("group levels"),r.sequencerEngine.groups.zObject=Object(c.a)(r),r.sequencerEngine.groups.startSendingLevels(),r}return Object(s.a)(n,[{key:"groups",get:function(){return this.sequencerEngine.groups.groups}},{key:"sendLevels",value:function(){var e,t=[],n=wi(this.groups);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r){var a=r.volume;t.push(a<qf?0:Math.pow((a-qf)/(1-qf),window.ROOTY))}else t.push(0)}}catch(i){n.e(i)}finally{n.f()}this.sendMessage("group volumes ",t)}},{key:"onLevels",value:function(e){console.log("on levels=",e);for(var t=0;t<e.length;t++){var n=e[t];if(!isNaN(n)){var r=this.groups[t];if(r){var a=If(n,qf,1,1);r.volume!==a&&(console.log("sending %s to group",n,r,r.volume),r.setVolume(a,!1,!1))}}}}}]),n}(xa);Object(Ea.a)("groups",{"":""},"Controls groups",function(){return 0},{inlets:0});Object(Ea.a)("repeatList",{listToRepeat:"","number of repeats":""},"repeats an inputed list for a number of times",function(){return 1},{inlets:2});var xi={repeatList:function(e,t){return function(e){for(var n=Object(Hr.a)(e,1)[0],r=[],a=t()||1,i=0;i<a;i++)for(var o=0;o<n.length;o++)r.push(n[o]);return[r]}}};Object(Ea.a)("hexToRGB",{"hexadecimal color string":""},"Returns rgb/rgba values in 3/4-part array for hexadecimal string");var Ti={hexToRGB:function(e){return function(e){var t=Object(Hr.a)(e,1)[0];if("string"===typeof t&&"#"===t[0]){var n=(t=t.slice(1)).slice(0,2),r=t.slice(2,4),a=t.slice(4,6),i=t.slice(6,8),o=[parseInt(n,16)/255,parseInt(r,16)/255,parseInt(a,16)/255];return""!==i&&o.push(parseInt(i,16)/255),[o]}}}},Ci={moveTo:function(e,t,n,r){t.moveTo(n,r)},clear:function(e,t){t.clearRect(0,0,2*e.zObject.width,2*e.zObject.height)},rect:function(e,t,n,r,a,i){t.beginPath(),t.rect(n,r,a,i)},lineTo:function(e,t,n,r){t.lineTo(n,r)},beginPath:function(e,t){t.beginPath()},closePath:function(e,t){t.closePath()},circle:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;t.beginPath(),a>0&&t.arc(n,r,a,i,o)},stroke:function(e,t,n){t.strokeStyle=n,t.stroke()},lineWidth:function(e,t,n){t.lineWidth=n},fill:function(e,t,n){t.fillStyle=n,t.fill()},triangle:function(e,t,n,r,a,i,o,s){t.beginPath(),t.moveTo(n,r),t.lineTo(a,i),t.lineTo(o,s),t.closePath()}},Ni=(n(2349),Object(p.a)({},Ci,{drawArray:function(e,t,n,r,a){t.fillStyle=r;for(var i=0;i<a.length;i+=2){var o=a[i],s=a[i+1];if(!(o>e.zObject.width||s>e.zObject.height)){t.beginPath();var c=o%n;o-=c,o+=n-c,s-=s%n,t.rect(o,s,n,n),t.fill()}}},drawTriangles:function(e,t,n,r){if(!window.arrDebug){t.strokeStyle=n;for(var a=0;a<r.length;a+=6)t.beginPath(),t.moveTo(r[a],r[a+1]),t.lineTo(r[a+2],r[a+3]),t.lineTo(r[a+4],r[a+5]),t.stroke()}}}));function Ri(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Mi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mi(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Mi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ai(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var qi=function(e){Object(u.a)(n,e);var t=Ai(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet("operation",function(e){var t=Object(Hr.a)(e,1)[0];return r.onOperation(t)}),r.customAttributes=[],r}return Object(s.a)(n,[{key:"subpatch",get:function(){if(this.subSequence.zObject)return this.subSequence}},{key:"loadBang",value:function(){if(this.subpatch){var e=this.subpatch.zObject.attributes;for(var t in e)this.subpatch.zObject.setAttribute(t,e[t])}}},{key:"onOperation",value:function(e){var t=this;if(this.subpatch){var n=e.split(" ");"create"===n[0]&&(this.customAttributes.push(n[1]),this.newOutlet("Attribute "+n[1]),this.subpatch.zObject.newAttribute(n[1],"",function(e){t.sendMessage("Attribute "+n[1],e)}))}}},{key:"getJson",value:function(e){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this,e),{customAttributes:this.customAttributes})}},{key:"fromJson",value:function(e,t){if(Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e),e.customAttributes){e.customAttributes=Array.from(new Set(e.customAttributes));var r,a=Ri(e.customAttributes);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.onOperation("create "+i)}}catch(o){a.e(o)}finally{a.f()}}}}]),n}(xa);Object(Ea.a)("attributes",{operation:""},"Allows creating and controlling attributes for the containing subpatch dynamically",function(){return 0},{inlets:0});var Di=n(49);function Ii(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var _i=function(e){Object(u.a)(n,e);var t=Ii(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).loader=new Di.M,r.newOutlet("texture"),r}return Object(s.a)(n,[{key:"loadImage",value:function(e){var t=this;if(e===this.imageHash&&this.texture)this.sendMessage("texture",this.texture);else{this.imageHash=e;var n="https://zequencer.io/ipfs/"+e;this.sendMessage("texture",this.loader.load(n,function(e){t.texture=e}))}}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{imageHash:this.imageHash})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.imageHash=e.imageHash,console.log("FROM JSON IMAGE HASH=",e.imageHash)}}]),n}(xa);Object(Ea.a)("three.dataTexture",{dataArray:"",width:"",height:""},"Creates a three.js data texture out of an array of data and optional width/height",function(){return 1},{isHot:!0,inlets:3});Object(Ea.a)("three.textureLoader",{},"Load images into three.js textures",function(){return 0});var Fi={"three.dataTexture":function(e,t,n){var r,a=void 0;return function(e){var i=Object(Hr.a)(e,1)[0];if(Array.isArray(i)||ArrayBuffer.isView(i)){var o=t()||Math.round(Math.sqrt(i.length)),s=n()||Math.round(Math.sqrt(i.length));return ArrayBuffer.isView(i)?a=i:(a&&a.length===i.length||(a=new Uint8Array(o*s*4)),i.length<=a.length?a.set(i):a.set(i.slice(0,a.length))),r&&r.width===o&&r.height===s&&r.data.length===a.length?(r.image.data=a,r.needsUpdate=!0):r=new Di.k(a,o,s,Di.F,void 0,void 0,void 0,void 0,void 0),r}}},"three.textureLoader":function(e){return e.effect=new _i(e),e.needsLoad=!0,function(t){Object(oi.a)(t),e.effect.imageHash&&e.effect.loadImage(e.effect.imageHash)}}};Object(Ea.a)("print",{message:"to print"},"prints to javascript console");function Li(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Bi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bi(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Vi=function(e){Object(u.a)(n,e);var t=zi(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet("ADSR Levels",function(e){return r.onADSRLevels(e[0])}),r.newOutlet("ADSR levels"),r.newInlet("Oscillator Levels",function(e){return r.onOscillatorLevels(e[0])}),r.newOutlet("Oscillator levels"),r}return Object(s.a)(n,[{key:"sendOscillatorLevels",value:function(){if(this.synth){var e=this.synth.oscillatorNodes.map(function(e){return e.oscillatorLevelParameter.get(!0)});this.sendMessage("Oscillator levels",e)}}},{key:"sendADSRLevels",value:function(){if(this.synth){this.synth.ampEnvelope;this.sendMessage("ADSR levels",[this.attack,this.decay,this.sustain,this.release])}}},{key:"amp",get:function(){return this.synth.ampEnvelope}},{key:"attack",get:function(){if(this.synth)return Ui(this.amp.attack,this.amp.attackParameter.min,this.amp.attackParameter.max)},set:function(e){if(this.synth){var t=Hi(e,this.amp.attackParameter.min,this.amp.attackParameter.max);t!==this.amp.attack&&this.amp.attackParameter.set(t,!1)}}},{key:"decay",get:function(){if(this.synth)return Ui(this.amp.decay,this.amp.decayParameter.min,this.amp.decayParameter.max)},set:function(e){if(this.synth){var t=Hi(e,this.amp.decayParameter.min,this.amp.decayParameter.max);t!==this.amp.decay&&this.amp.decayParameter.set(t,!1)}}},{key:"sustain",get:function(){if(this.synth)return this.amp.sustain},set:function(e){this.synth&&e!==this.amp.sustain&&this.amp.sustainParameter.set(e,!1)}},{key:"release",get:function(){if(this.synth)return Ui(this.amp.release,this.amp.releaseParameter.min,this.amp.releaseParameter.max)},set:function(e){if(this.synth){var t=Hi(e,this.amp.releaseParameter.min,this.amp.releaseParameter.max);t!==this.amp.release&&this.amp.releaseParameter.set(t,!1)}}},{key:"onOscillatorLevels",value:function(e){this.synth&&Array.isArray(e)&&this.synth.oscillatorNodes.forEach(function(t,n){var r=e[n%e.length];r!==t.oscillatorLevelParameter.get(!0)&&t.oscillatorLevelParameter.set(r,!1)})}},{key:"onADSRLevels",value:function(e){this.synth&&Array.isArray(e)&&(isNaN(e[0])||(this.attack=e[0]),isNaN(e[1])||(this.decay=e[1]),isNaN(e[2])||(this.sustain=e[2]),isNaN(e[3])||(this.release=e[3]))}},{key:"linkSynth",value:function(e){this.synth=e,this.synth.controller=this}},{key:"getJson",value:function(e){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this,e),{synthId:this.synth.id})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t);var r,a=Li(this.subSequence.getRootSubSequence().tracks);try{for(a.s();!(r=a.n()).done;){var i=r.value;i&&i.instrument&&i.instrument.id===e.synthId&&this.linkSynth(i.instrument)}}catch(o){a.e(o)}finally{a.f()}}}]),n}(xa),Hi=function(e,t,n){return(e=Math.max(0,e))*(n-t)},Ui=function(e,t,n){return e=Math.max(0,e),Math.pow((e-t)/(n-t),1)};Object(Ea.a)("synthcontrol",{},"FUCK",function(){return 0},{inlets:0});Object(Ea.a)("switch",{switchNumber:""},"switch inlets based on first inlet",void 0,{isHot:!0,inlets:function(e){return e+1}});Object(Ea.a)("outSwitch",{switchNumber:""},"switch inlets based on first inlet",function(e){return e},{inlets:function(e){return 2}});function Ji(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}console.error;window.errors=[],console.error=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window.errors.push(t)};var Gi=function(e){Object(u.a)(n,e);var t=Ji(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet("vertex shader",function(e){var t=Object(Hr.a)(e,1)[0];return r.onVertexShader(t)}),r.newInlet("fragment shader",function(e){var t=Object(Hr.a)(e,1)[0];return r.onFragmentShader(t)}),r.newOutlet("material"),r.uniforms={},r}return Object(s.a)(n,[{key:"getJson",value:function(e){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this,e),{uniforms:Object.keys(this.uniforms)})}},{key:"fromJson",value:function(e,t){var r=this;Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),e.uniforms&&e.uniforms.forEach(function(e){return r.createUniform(e,0)})}},{key:"onVertexShader",value:function(e){this.vertexShader=e,this.updateMaterial()}},{key:"onFragmentShader",value:function(e){this.fragmentShader=e,this.updateMaterial()}},{key:"createUniform",value:function(e,t){var n=this;if(e in this.uniforms)return this.uniforms[e].value=t,isNaN(t)&&(this.uniforms[e].type="t"),void(this.material&&(this.material.uniformsNeedUpdate=!0));this.uniforms[e]={value:t},isNaN(t)&&(this.uniforms[e].type="t"),this.newInlet(e,function(t){var r=Object(Hr.a)(t,1)[0];n.uniforms[e].value=r,isNaN(r)&&(n.uniforms[e].type="t"),n.material&&(n.material.uniformsNeedUpdate=!0,n.sendMessage("material",n.material))})}},{key:"updateMaterial",value:function(){if(this.fragmentShader&&this.vertexShader){window.errors.length;this.material?(this.material.fragmentShader=this.fragmentShader,this.material.vertexShader=this.vertexShader,this.material.needsUpdate=!0):this.material=new Di.I({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,transparent:!0,depthWrite:!1,blending:Di.y});window.errors.length;this.sendMessage("material",this.material)}}}]),n}(xa),Wi=0;Object(Ea.a)("gl.material",{fragColor:"",size:""},"Outputs a material from the shader expression given in the inlet",void 0,{tags:"GLSL",isHot:!0,inlets:2,connects:{object:"three.planeRenderer"}});window.fallBackUpdate={};var Ki=function(e){return function(t,n){var r=t.code,a=t.uniforms,i=t.variables,o=t.functions,s="\n";for(var c in a)if(!c.includes("$")){var u=a[c].value,l=Array.isArray(u)&&Array.isArray(u[0])?"mat3":4===u.length?"vec4":3==u.length?"vec3":2==u.length?"vec2":isNaN(a[c].value)?"sampler2D":"float";c.includes("tex")&&(l="sampler2D"),s+="uniform "+l+" "+c+"; \n"}!function(e,t,n){var r=function(r){if(t[r].update)return"continue";t[r].update=function(t,a){if(Array.isArray(t))if(Array.isArray(t[0])){if(3===t.length){var i=new Di.t;i.set.apply(i,Object(h.a)(t.flat(6))),t=i}}else 2===t.length?t=new Di.O(t[0],t[1]):3===t.length?t=new Di.P(t[0],t[1],t[2]):4===t.length&&(t=new Di.Q(t[0],t[1],t[2],t[3]));e.createUniform(r,t),window.stopRender||a||n.sendMessage(n.outputByNumber(0),e.material)};var a=t[r].value;if(Array.isArray(a))if(Array.isArray(a[0])){if(3===a.length){var i=new Di.t;i.set.apply(i,Object(h.a)(a.flat(6))),a=i}}else 2===a.length?a=new Di.O(a[0],a[1]):3===a.length?a=new Di.P(a[0],a[1],a[2]):4===a.length&&(a=new Di.Q(a[0],a[1],a[2],a[3]));window.fallBackUpdate[r]=t[r].update,e.createUniform(r,a)};for(var a in t)r(a)}(n,a,e),s+="\n\nconst float EPSILON = 0.0001;\n#define PI 3.141592653589793\n\n#define cx_mul(a, b) vec2(a.x*b.x - a.y*b.y, a.x*b.y + a.y*b.x)\n#define cx_div(a, b) vec2(((a.x*b.x + a.y*b.y)/(b.x*b.x + b.y*b.y)),((a.y*b.x - a.x*b.y)/(b.x*b.x + b.y*b.y)))\n#define cx_sin(a) vec2(sin(a.x) * cosh(a.y), cos(a.x) * sinh(a.y))\n#define cx_cos(a) vec2(cos(a.x) * cosh(a.y), -sin(a.x) * sinh(a.y))\n\n// Identity matrix.\nconst mat3 identity =  mat3(\n        vec3(1, 0, 0),\n        vec3(0, 1, 0),\n        vec3(0, 0, 1)\n    );\n\nmat2 rotate2D(float angle) {\n    return mat2(\ncos(angle), -sin(angle),sin(angle),cos(angle));\n}\n\nmat4 lookAt(vec3 eye, vec3 target, vec3 up) {\n    vec3 z = normalize(eye - target);\n    vec3 x = normalize(cross(up, z));\n    vec3 y = normalize(cross(z, x));\n    mat4 translation = mat4(\n        vec4(1.0, 0.0, 0.0, eye.x),\n    \tvec4(0.0, 1.0, 0.0, eye.y),\n        vec4(0.0, 0.0, 1.0, eye.z),\n        vec4(0.0, 0.0, 0.0, 1.0)\n    );\n    mat4 rotation = ".concat(O.isMobile?"translation":"transpose(mat4(vec4(x, 0.0),vec4(y, 0.0),vec4(z, 0.0),vec4(0.0, 0.0, 0.0, 1.0)))",";\n    return translation * rotation;\n}\n\nvec3 getRayDir(mat4 camera, float fov) {\n    fov = radians(fov);\n    vec2 p = 1.0*((gl_FragCoord.xy-vec2(width, height)))/vec2(width, height);\n    vec2 h = vec2(\n        tan(fov / 2.0) * (width / height), \n        tan(fov / 2.0)\n    );\n    vec3 pCam = vec3(p * h, -1.0);\n    return normalize((").concat(O.isMobile?"camera":"inverse(camera)"," * vec4(pCam, 0.0)).xyz);\n}\n\nfloat sdRoundBoxCoord( vec2 p, vec2 off, vec2 b, float r, mat3 transform, float angle ) \n{\n  vec3 p3 = vec3(p, 0.0);\n  vec3 off3 = vec3(off, 0.0);\n  p3 = (p3 - off3)*transform;\n  p.x = p3.x;\n  p.y = p3.y;\n  p *= rotate2D(angle);\n  vec2 q = abs(p)-b+r;\n  return min(max(q.x,q.y),0.0) + length(max(q,0.)) - r;\n}\n\nfloat sdRoundBox3DCoord( vec3 p, vec3 off, vec3 b, float r, mat3 transform, float pivot) \n{\n  vec3 q = abs(p) - b;\n  return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0) - r;\n}\n\nfloat sdRoundBox( vec2 off, vec2 b, float r ) \n{\n  vec2 p = (1.0*gl_FragCoord.xy-vec2(width, height))/height;\n  return sdRoundBoxCoord(p, off, b, r, identity, 0.0);\n}\n\nfloat ATan2(float x, float y)\n{\n    float angle = asin(x) > 0.0 ? acos(y) : -acos(y);\n    return angle;\n}\n\nvec3 hsl2rgb(vec3 c) {\n    vec3 rgb = clamp(abs(mod(c.x * 6.0 + vec3(0.0,4.0,2.0), 6.0) - 3.0) - 1.0, 0.0, 1.0);\n        return c.z + c.y * (rgb - 0.5) * (1.0 - abs(2.0 * c.z - 1.0));\n}\nvec3 rgb2hsl(vec3 c) {\n    float h = 0.0;\n    float s = 0.0;\n    float l = 0.0;\n    float r = c.r;\n    float g = c.g;\n    float b = c.b;\n    float cMin = min( r, min( g, b ) );\n    float cMax = max( r, max( g, b ) );\n    l = ( cMax + cMin ) / 2.0;\n    if ( cMax > cMin ) {\n        float cDelta = cMax - cMin;\n        s = l < .0 ? cDelta / ( cMax + cMin ) : cDelta / ( 2.0 - ( cMax + cMin ) );\n        if ( r == cMax ) {\n            h = ( g - b ) / cDelta;\n        } else if ( g == cMax ) {\n            h = 2.0 + ( b - r ) / cDelta;\n        } else {\n            h = 4.0 + ( r - g ) / cDelta;\n        }\n        if ( h < 0.0) {\n            h += 6.0;\n        }\n        h = h / 6.0;\n     }\n     return vec3( h, s, l );\n}\n\nvec4 rainbow(float level)\n{\n\t/*\n\t\tTarget colors\n\t\t=============\n\t\t\n\t\tL  x   color\n\t\t0  0.0 vec4(1.0, 0.0, 0.0, 1.0);\n\t\t1  0.2 vec4(1.0, 0.5, 0.0, 1.0);\n\t\t2  0.4 vec4(1.0, 1.0, 0.0, 1.0);\n\t\t3  0.6 vec4(0.0, 0.5, 0.0, 1.0);\n\t\t4  0.8 vec4(0.0, 0.0, 1.0, 1.0);\n\t\t5  1.0 vec4(0.5, 0.0, 0.5, 1.0);\n\t*/\n\t\n\tfloat r = float(level <= 2.0) + float(level > 4.0) * 0.5;\n\tfloat g = max(1.0 - abs(level - 2.0) * 0.5, 0.0);\n\tfloat b = (1.0 - (level - 4.0) * 0.5) * float(level >= 4.0);\n\treturn vec4(r, g, b, 1.0);\n}\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\n");var f=Object.keys(o).filter(function(e){return e.startsWith("sdf")}),p=Object.keys(o).filter(function(e){return e.includes("generated")}),d=Object.keys(o).filter(function(e){return e.startsWith("scene")}),m=Object.keys(o).filter(function(e){return!e.startsWith("sdf")&&!e.startsWith("scene")&&!e.includes("generated")}),v={};for(var b in p.forEach(function(e){return v[e]=o[e]}),f.forEach(function(e){return v[e]=o[e]}),d.forEach(function(e){return v[e]=o[e]}),m.forEach(function(e){return v[e]=o[e]}),o=v)s+=Qi(b,o[b])+"\n";if(s+="\nvoid main() {\n",i)for(var g in i){var y=i[g];s+=y.type+" "+g+" = "+y.code+";\n"}return s+="\n".concat(r,"\n}\n"),r,s,s}};Object(Ea.a)("mouseSDF",{coord:"",position:"",size:"",cornerRadius:"",resolution:""},"Calculates SDF for a given mouse coord",function(){return 1},{inlets:5});var Xi=function(e,t){if(!e||!t)return"full";for(var n="",r=0,a=0;a<e.length;a++)e[a]!==t[a]&&r++<10&&(n+=e[a]);return n},Qi=function(e,t){var n=t.body,r=t.args,a=t.returnType+" "+e+"("+Object.keys(r).map(function(e){return r[e]+" "+e}).join(",")+") {\n";return a+=n+"\n}"};Object(Ea.a)("globalReverse",{},"When 1 is received from inlet, whole track is reversed. When 0 whole track is not reversed",function(){return 0},{inlets:1});Object(Ea.a)("loop",{"looping on":"","loop length (bars)":""},"When 1 is received in left inlet, looping starts. O stops loop and continues play",function(){return 0},{inlets:2,isHot:!0});Object(Ea.a)("gl.cx_div",{a:"vec2",b:"vec2"},"Complex division in glsl",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.cx_mul",{a:"vec2",b:"vec2"},"Complex division in glsl",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.cx_sin",{a:"vec2"},"Complex sin in glsl",function(){return 1},{isHot:!0,inlets:1});Object(Ea.a)("gl.cx_cos",{a:"vec2"},"Complex cos in glsl",function(){return 1},{isHot:!0,inlets:1});Object(Ea.a)("gl.cx_tan",{a:"vec2"},"Complex cos in glsl",function(){return 1},{isHot:!0,inlets:1});var Yi={args:{z:"vec2"},returnType:"vec2",body:"\n    return vec2(\n    length(z),\n    atan(z.y, z.x)\n  );\n"};Object(Ea.a)("gl.cx_log",{a:"vec2"},"Complex tan in glsl");Object(Ea.a)("gl.cx_pow",{a:"vec2",b:"float"},"Complex power in glsl",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.im",{a:"vec2"},"Complex imaginary part in glsl",function(){return 1},{isHot:!0,inlets:1});var Zi={"gl.cx_pow":function(e,t){return e.needsHotReload=!0,function(e){var n=Object(Hr.a)(e,1)[0],r=Object(Wa.a)(n,t),a=r.codes,i=r.uniforms,o=r.functions,s=r.variables;return o.as_polar=Yi,o.cx_pow={args:{v:"vec2",p:"float"},returnType:"vec2",body:"\n    vec2 z = as_polar(v);\n    return pow(z.x, p) * vec2(cos(z.y * p), sin(z.y * p));\n"},{code:"cx_pow(".concat(Object(Wa.b)(a[0]),", ").concat(Object(Wa.b)(a[1]),")"),uniforms:i,functions:o,variables:s}}},"gl.cx_div":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(e){var n=Object(Qa.a)(e,t),r=Object(Hr.a)(n,2),a=r[0],i=r[1];return a="("+Object(Wa.b)(a)+")",i="("+Object(Wa.b)(i)+")","cx_div(".concat(a,", ").concat(i,")")},t)},"gl.cx_sin":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(e){var t=Object(Qa.a)(e),n=Object(Hr.a)(t,1)[0];return n="("+Object(Wa.b)(n)+")","cx_sin(".concat(n,")")})},"gl.cx_cos":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(e){var t=Object(Qa.a)(e),n=Object(Hr.a)(t,1)[0];return n="("+Object(Wa.b)(n)+")","cx_cos(".concat(n,")")})},"gl.cx_mul":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(e){var n=Object(Qa.a)(e,t),r=Object(Hr.a)(n,2),a=r[0],i=r[1];return a="("+Object(Wa.b)(a)+")",i="("+Object(Wa.b)(i)+")","cx_mul(".concat(a,", ").concat(i,")")},t)},"gl.cx_log":function(e){return e.needsHotReload=!0,function(e){var t=Object(Hr.a)(e,1)[0],n=Object(Wa.a)(t),r=n.codes,a=n.uniforms,i=n.functions,o=n.variables;return o=t.variables,i.as_polar=Yi,i.cx_log={args:{a:"vec2"},returnType:"vec2",body:"\n    vec2 polar = as_polar(a);\n    float rpart = polar.x;\n    float ipart = polar.y;\n    if (ipart > PI) ipart=ipart-(2.0*PI);\n    return vec2(log(rpart),ipart);\n"},{code:"cx_log(".concat(Object(Wa.b)(r[0]),")"),uniforms:a,functions:i,variables:o}}}};function $i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return eo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eo(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(Ea.a)("gl.genArg",{name:"Name of the function argument",type:"Type of the function argument"},"Generates a vec3 arguement that can be used in a function definition",function(){return 1},{inlets:2});Object(Ea.a)("gl.genFunction",{network:"Name of the function that is generated",name:"Name of the function that is generated",returnType:"Name of the function that is generated","argument name list":"exact name of arguments (in list)"},"Generates a function",function(){return 1},{inlets:4});var to={"gl.genArg":function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0];console.log("GEN ARG CALLED=",n);var r={};return r[n]=t(),{code:"(".concat(n,")"),uniforms:{},variables:{},closure:r}}},"gl.genFunction":function(e,t,n,r){var a=Object(j.uuid)().replaceAll("-","");return function(e){var i=Object(Hr.a)(e,1)[0],o=t()+"generated"+a,s=Object(Wa.a)(i,t),c=s.codes,u=s.uniforms,l=s.functions,f=s.closure;return r()&&(f=function(e,t){var n,r={},a=$i(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;r[i]=e[i]}}catch(o){a.e(o)}finally{a.f()}return r}(f,r())),console.log("CLOSURES =",f,r()),l[o]={args:f,returnType:n(),body:"\nreturn ".concat(c[0],";\n")},{codeEvaluator:function(e){return"(".concat(o,"(").concat(e,"))")},uniforms:u,variables:{},functions:l}}}};Object(Ea.a)("sdf.translate",{"sdf list":"",x:"",y:""},"Translate group of sdfs",function(){return 1},{isHot:!0,inlets:3});Object(Ea.a)("sdf.scale",{"sdf list":"",scale:""},"Translate group of sdfs",function(){return 1},{isHot:!0,inlets:2});var no={"sdf.translate":function(e,t,n){return function(e){var r=Object(Hr.a)(e,1)[0];if(Array.isArray(r))return void 0===t()||void 0===n()?[r]:[r.map(function(e){if(Array.isArray(e)){var r=Object(h.a)(e);return r[1]+=t(),r[2]+=n(),r}}).filter(function(e){return e})]}},"sdf.scale":function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0];if(Array.isArray(n))return void 0===t()?[n]:[n.map(function(e){if(Array.isArray(e)){var n=Object(h.a)(e);return n[1]*=t(),n[2]*=t(),n[3]*=t(),n[4]*=t(),n[5]*=t(),n}}).filter(function(e){return e})]}}};Object(Ea.a)("gl.mat3",{x:"",y:"",z:""},"Creates a GLSL expression representing a 3x3 matrix",function(){return 1},{isHot:!0,tags:"GLSL",inlets:3});var ro=n(99),ao={depth:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n[0],i=n[1];if(e.dimensionFactors[a]=[0,0,i],e.dimensions[a]){var o=e.dimensions[a][2],s=Object(Hr.a)(e.dimensionsUniforms[a],3);s[0],s[1],(0,s[2])([o*i])}}};function io(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}Object(Ea.a)("gl.length",{vector:""},"Returns the gl expression that calculates length of vector",function(){return 1},{inlets:1});Object(Ea.a)("gl.sdRoundBox",{position:"",size:"",cornerRadius:""},"Fuck",function(){return 1},{isHot:!0,inlets:3});Object(Ea.a)("gl.sdRoundRect",{position:"",sizeVec:"",cornerRadius:""},"Fuck",function(){return 1},{isHot:!0,inlets:3});Object(Ea.a)("gl.circle",{position:"",radius:""},"Creates circle sdf for given radius and position",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.sdfMerge",{sdf:""},"Merges sdfs given as arguments",function(){return 1},{isHot:!0,inlets:function(e){return e}});var oo=function e(t){if(0===t.length)return Object(Wa.b)(0);var n=t[0];return 1===t.length?Object(Wa.b)(n):"min(".concat(Object(Wa.b)(n),", ").concat(e(t.slice(1)),")")};Object(Ea.a)("gl.between",{number:"",a:"",b:""},"Returns 1 if value is between a and b-- 0 otherwise",function(){return 1},{isHot:!0,inlets:3});var so=function(e,t,n){return Object(Xa.a)(function(e){var r=Object(Qa.a)(e,t,n);return"(".concat(Object(Wa.b)(r[0])," >= ").concat(Object(Wa.b)(r[1])," && ").concat(Object(Wa.b)(r[0])," < ").concat(Object(Wa.b)(r[2])," ? 1.0 : 0.0)")},t,n)},co={"gl.length":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(t){var n=Object(Qa.a)(t);return e.flash(),"length(".concat(Object(Wa.b)(n[0]),")")})},"gl.between":so,"gl.sdRoundBox":function(e,t,n){return e.needsHotReload=!0,Object(Xa.a)(function(r){var a=Object(Qa.a)(r,t,n);return e.flash(),"sdRoundBox(".concat(Object(Wa.b)(a[0]),", vec2(").concat(Object(Wa.b)(a[1]),"), (").concat(Object(Wa.b)(a[2]),"))")},t,n)},"gl.sdRoundRect":function(e,t,n){return e.needsHotReload=!0,Object(Xa.a)(function(r){var a=Object(Qa.a)(r,t,n);return e.flash(),"sdRoundBox(".concat(Object(Wa.b)(a[0]),", ").concat(Object(Wa.b)(a[1]),", (").concat(Object(Wa.b)(a[2]),"))")},t,n)},"gl.sdfMerge":function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.needsHotReload=!0,Xa.a.apply(void 0,[function(t){var r=[t].concat(Object(h.a)(n.filter(function(e){return 0!==e()&&void 0!==e()}).map(function(e){return e()}))),a=Qa.a.apply(void 0,Object(h.a)(r));return oo(a),e.flash(),oo(a)}].concat(n))},"gl.circle":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"length((gl_FragCoord.xy-vec2(width, height))/height - ".concat(Object(Wa.b)(r[0]),") - ").concat(Object(Wa.b)(r[1]))},t)}},uo=n(828);function lo(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return fo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fo(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function fo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(Ea.a)("gl.sdf",{position:"",type:"",sizeVec:"",cornerRadius:""},"Creates sdf for a type",function(){return 2},{isHot:!0,inlets:4});var ho=function(e,t,n,r,a,i,o,s){e.needsHotReload=!0;var c=Object(j.uuid)().replaceAll("-","");return function(u){var l=Object(Hr.a)(u,1)[0],f=Object(Wa.a)(l,t,n,r,a,i,o,s),h=f.codes,p=f.functions,d=f.variables,m=f.uniforms;0===Object.keys(h[4]).length&&(h[4]=void 0),e.flash();h[6];var v,b,g="(1.0*gl_FragCoord.xy-vec2(width, height))/height",y=uo.a[h[1]];if(y){var k="sdf"+c;p[k]=y(h),"box"!==h[1]&&"sphere"!==h[1]||(g="vec3((1.0*gl_FragCoord.xy-vec2(width, height))/height, 0.0)"),v=function(e){return"".concat(k,"(").concat(e,")")},b="".concat(k,"(").concat(g,")")}return[{id:c,code:v,functions:p,variables:d,uniforms:m},{id:c,code:b,functions:p,variables:d,uniforms:m}]}};Object(Ea.a)("gl.sdfScene",{"list of sdfs":"",type:"",morph:"",offset:"","operations list":""},"Creates a scene out of all the sdfs");var po=function(e,t,n){return function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;return n&&1===t.length?"scene = ".concat(t[0]):0===t.length?"scene = vec2(0.0, -1.0)":function(e,t,n,r){if(0===r||!r){var a="\n  if (".concat(e,".x < ").concat(n?t:"scene",".x) {\n    scene = ").concat(e,";\n  }\n");return n&&(a+="\n  else {\n    scene = ".concat(t,";\n  }\n")),a}if(1===r){var i="\n  if (".concat(e,".x < ").concat(n?t:"scene",".x) {\n    scene = ").concat(t,";\n  }\n");return n&&(i+="\n  else {\n    scene = ".concat(e,";\n  }\n")),i}if(2===r){var o="\n  if (-".concat(e,".x > ").concat(n?t:"scene",".x) {\n    scene = ").concat(e,";\n  }\n");return n&&(o+="\n  else {\n    scene = ".concat(t,";\n  }\n")),o}return""}(t[0],n?t[1]:"scene",n,r&&r[0])+(1===t.length?"":e(n?t.slice(2):t.slice(1),!1,r&&r.slice(1)))}(e.map(function(e){return e.code(t)}),!0,n)},mo=n(180);function vo(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return bo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bo(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function bo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function go(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}window.MIN_SDF_VALUE=.0051;function yo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function ko(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Oo=function(e){return!Array.isArray(e)};function jo(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return wo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wo(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function wo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Eo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function So(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Po(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Po(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Po(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var To=function(e){Object(u.a)(n,e);var t=xo(n);function n(e){var r;return Object(o.a)(this,n),r=t.call(this,e),e.skipHotReload=!0,r.skipHotReload=!0,r.dimensionVecs={},r.positionVecs={},r.indexedUniforms={},r.uniformValues={},r.positionUniforms=[],r.dimensionsUniforms=[],r.cornerUniforms=[],r.glSDFs=[],r.positions=[],r.dimensions=[],r.corners=[],r.newInlet("SDF List",function(e){var t=Object(Hr.a)(e,1)[0];return r.onSDFList(t)}),r.newInlet("mouse down",function(e){var t=Object(Hr.a)(e,1)[0];return r.onMouseDown(t)}),r.newInlet("mouse up",function(e){var t=Object(Hr.a)(e,1)[0];return r.onMouseUp(t)}),r.newInlet("mouse move",function(e){var t=Object(Hr.a)(e,1)[0];return r.onMouseMove(t)}),r.newInlet("slider values",function(e){var t=Object(Hr.a)(e,1)[0];return r.onSliderValues(t)}),r.newInlet("size",function(e){var t=Object(Hr.a)(e,1)[0];r.size=t}),r.newInlet("operations",function(e){var t=Object(Hr.a)(e,1)[0];return r.onOperation(t)}),r.newInlet("SDF Morpher",function(e){var t=Object(Hr.a)(e,1)[0];r.sdfMorpher=t,r.onSDFList(r.lastSDFs,!0)}),r.newInlet("SDF Offset",function(e){var t=Object(Hr.a)(e,1)[0];r.sdfOffset=t,r.onSDFList(r.lastSDFs,!0)}),r.newInlet("SDF Operation List",function(e){var t=Object(Hr.a)(e,1)[0];r.onSDFOperationList(t)}),r.newOutlet("Merged GL SDF"),r.newOutlet("GL SDF List"),r.newOutlet("GL SDF Evaluators"),r.newOutlet("vec2(sdf,index)"),r.newOutlet("Index Clicked"),r.newOutlet("On Slider Change"),r.newOutlet("On Slider SDF Change"),r.newInlet("transformation matrix",function(e){var t=Object(Hr.a)(e,1)[0];return r.onTransformationMatrix(t)}),r.newInlet("transformation matrix list",function(e){var t=Object(Hr.a)(e,1)[0];return r.onTransformationList(t)}),r.newOutlet("Transformed Positions"),r.setup(),r}return Object(s.a)(n,[{key:"hotReload",value:function(){if(this.lastSDFs&&(this.onSDFList(this.lastSDFs),this.lastSent))for(var e in this.lastSent)this.sendMessage(e,this.lastSent[e])}},{key:"onSDFList",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&(e=Ro(e),!(e=Co(e)).every(function(e){return e.copyId}))){if(this.lastSDFs=Object(h.a)(e),!n&&this.storedSDFs&&e.length===this.storedSDFs.length)return this.updateUniforms(e),void this.sendTransformedPositions();var r,a=[],i=[],o={},s=So(e);try{var c=function(){var n=r.value,s=n.id,c=t.getIndexForId(s);if(No(n)){var u=t.handleSDFCopy(c,n,e),l=u.sdf,f=u.sdfEvaluator,h=Object(ro.a)(u,["sdf","sdfEvaluator"]);return a.push(l),i.push(f),o=Object(p.a)({},o,h.uniforms),"continue"}var d=Object(Hr.a)(n,1)[0],m=Object(mo.a)(n),v=Object(mo.e)(n),b=t.getPosition(c,n),g=t.getDimensions(c,n),y=t.getCorner(c,m),k=t.getRotation(c,v),O=t.getRepeats(c,n);t.indexedUniforms[c]=Object(p.a)({},t.indexedUniforms[c],b.uniforms,g.uniforms,y.uniforms,k.uniforms,O.uniforms),o=Object(p.a)({},o,t.indexedUniforms[c]),b.uniforms=t.indexedUniforms[c],g.uniforms=t.indexedUniforms[c],y.uniforms=t.indexedUniforms[c],k.uniforms=t.indexedUniforms[c],O.uniforms=t.indexedUniforms[c];var j=c,w=t.glSDFs[c]||ho(t.zObject,function(){return d},function(){return g},function(){return y},function(){return t.transformationMatrices[j]||t.transformationMatrix},function(){return k},function(){return j},function(){return O});t.glSDFs[c]=w;var E=w([b])[1],S={},P=t.name("singleSDF",c);S[P]={code:"(("+E.code+").x)",type:"float"},E=Object(p.a)({},E,{variables:S,code:P}),a.push(E),i.push(w([b])[0])};for(s.s();!(r=s.n()).done;)c()}catch(w){s.e(w)}finally{s.f()}if(this.zObject.needsHotReload=!1,0!==a.length){this.storedSDFs=a;for(var u=Object(mo.f)(e[0]?e[0][0]:"box"),l=u?"vec3":"vec2",f=function(e,t,n,r,a){var i="scene"+Object(j.uuid)().replaceAll("-","");return function(e){var o=Object(Hr.a)(e,1)[0],s={},c={},u={},l={code:"1.0"};n&&void 0!==n()&&(s=(l=n()).functions,u=l.variables,c=l.uniforms);var f={code:"0.0"};r&&void 0!==r()&&(f=r(),s=Object(p.a)({},s,f.functions),u=Object(p.a)({},u,f.variables),c=Object(p.a)({},c,f.uniforms));var h,d=lo(o);try{for(d.s();!(h=d.n()).done;){var m=h.value;u=Object(p.a)({},u,m.variables),c=Object(p.a)({},c,m.uniforms),s=Object(p.a)({},s,m.functions)}}catch(w){d.e(w)}finally{d.f()}l.functions&&(s=Object(p.a)({},l.functions,s)),f.functions&&(s=Object(p.a)({},f.functions,s)),c=Object(p.a)({},c,l.uniforms,f.uniforms);var v=t()||"vec3",b=f.code;if(f.codeEvaluator){var g=f.functions[Object.keys(f.functions)[0]];b=2===Object.keys(g.args).length?f.codeEvaluator("p, scene"):f.codeEvaluator("p")}return s[i]={args:{p:v},returnType:"vec2",body:"\nvec2 scene = vec2(0.0, -1.0);\n".concat(po(o,"p",a()),";\nreturn  vec2(scene.x * (").concat(l.codeEvaluator?l.codeEvaluator("p"):l.code,") + \n(").concat(b,"), scene.y);\n")},{code:function(e){return i+"("+e+")"},functions:s,uniforms:c,variables:u}}}(this.zObject,function(){return l},function(){return t.sdfMorpher},function(){return t.sdfOffset},function(){return t.sdfOperationsList})([i]),d=u?"vec3((1.0*gl_FragCoord.xy-vec2(width, height))/height, 0.0)":"(1.0*gl_FragCoord.xy-vec2(width, height))/height",m=f.code(d),v=f.functions,b=0,g=a;b<g.length;b++){var y=g[b];v=Object(p.a)({},v,y.functions)}var k={code:"(("+m+").x)",functions:v,uniforms:Object(p.a)({},o,this.transformationMatrix.uniforms),variables:{}},O={code:m,functions:v,uniforms:Object(p.a)({},o,this.transformationMatrix.uniforms),variables:{}};this.lastSent={"Merged GL SDF":k,"vec2(sdf,index)":O,"GL SDF List":a,"GL SDF Evaluators":f},this.sendMessage("Merged GL SDF",k),this.sendMessage("vec2(sdf,index)",O),this.sendMessage("GL SDF List",a),this.sendMessage("GL SDF Evaluators",f),this.zObject.needsHotReload=!1,this.sendTransformedPositions()}}}},{key:"updateUniforms",value:function(e){this.zObject.needsHotReload=!1,window.stopRender=!0;var t,n=So(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.updateUniformsForSDF(r,e)}}catch(a){n.e(a)}finally{n.f()}}}]),n}(Object(Ve.a)(function(e){return function(e){Object(u.a)(n,e);var t=yo(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).idToIndex={},e.indexCounter=0,e}return Object(s.a)(n,[{key:"newSDF",value:function(e){var t=this.indexCounter;return this.idToIndex[e]=t,this.indexCounter++,t}},{key:"getIndexForId",value:function(e){var t=this.idToIndex[e];return void 0===t&&(t=this.newSDF(e)),t}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Eo(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setup",value:function(){this.tMatrix=[[1,0,0],[0,1,0],[0,0,1]];var e=this.name("globalMatrix",0);this.globalMatrixUniform=Ya({},function(){return e}),this.transformationMatrix=this.globalMatrixUniform([[[1,0,0],[0,1,0],[0,0,1]]],!0),this.transformationMatrices=[],this.transformationMatricesUniforms=[]}},{key:"onPivot",value:function(e){this.pivot=e,this.globalPivotUniform([e])}},{key:"onTransformationMatrix",value:function(e){if(!Array.isArray(e)&&"object"===typeof e)return this.userInputMatrix=e,void this.onSDFList(this.lastSDFs,!0);Array.isArray(e)&&!e.some(function(e){return!Array.isArray(e)})&&(this.userInputMatrix=void 0,this.tMatrix=e,this.globalMatrixUniform([e]))}},{key:"onTransformationList",value:function(e){var t,n,r=this,a=!1;window.stopRender=!0,this.currentTransformations=Object(h.a)(e);for(var i=0;i<e.length;i++){var o=e[i];Array.isArray(o)&&Array.isArray(o[0])&&(this.transformationMatrices[i]?this.transformationMatricesUniforms[i]([o]):function(){var e=r.name("sdfTransform",i);r.transformationMatricesUniforms[i]=Ya({},function(){return e}),r.transformationMatrices[i]=r.transformationMatricesUniforms[i]([o],!0),a=!0}(),t=this.transformationMatricesUniforms[i],n=o)}window.stopRender=!1,t&&t([n]),a&&this.onSDFList(this.lastSDFs,!0),this.sendTransformedPositions()}},{key:"sendTransformedPositions",value:function(){if(this.currentTransformations){var e,t=[],n=0,r=jo(this.positions);try{for(r.s();!(e=r.n()).done;){var a=e.value,i=Object(Hr.a)(a,3),o=i[0],s=i[1],c=i[2],u=this.currentTransformations[n];if(!u)return;var l=Object(Hr.a)(u,3),f=l[0],h=l[1],p=l[2];t.push([o*f[0]+s*f[1]+c*f[2],o*h[0]+s*h[1]+s*h[2],o*p[0]+s*p[1]+c*p[2]]),n++}}catch(d){r.e(d)}finally{r.f()}this.sendMessage("Transformed Positions",t)}}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=ko(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).glDimensions=[],e.glPositions=[],e.glCorners=[],e.rotations=[],e.rotationUniforms=[],e.glRepeats=[],e.repeats=[],e.repeatsUniforms=[],e.glRotations=[],e}return Object(s.a)(n,[{key:"getTypeForId",value:function(e){var t=this.lastSDFs.find(function(t){return t.id===e});if(t)return t[0]}},{key:"updateUniformsForSDF",value:function(e,t){var n=this.getIndexForId(e.id);if(this.getTypeForId(e.copyId||e.id),Oo(e)){var r=!0;return n===t.length-1&&(r=!1),void this.updateUniformsForCopy(n,e,t,r)}var a=Object(mo.a)(e),i=Object(mo.e)(e);this.positions[n]=Object(mo.c)(e),this.rotations[n]=i,this.dimensions[n]=Object(mo.b)(e),this.repeats[n]=Object(mo.d)(e),this.corners[n]=a;var o=this.positionUniforms[n],s=this.repeatsUniforms[n],c=Object(Hr.a)(this.dimensionsUniforms[n],3),u=c[0],l=c[1],f=c[2],h=this.cornerUniforms[n],p=this.rotationUniforms[n];if(o([this.positions[n]]),u([this.dimensions[n][0]]),l([this.dimensions[n][1]]),s([this.repeats[n]]),Object(mo.f)(e[0])){var d=this.dimensionFactors[n];d&&d[2],f([this.dimensions[n][2]])}e===t[t.length-1]&&(window.stopRender=!1),h([a]),p([i])}},{key:"updateUniformsForCopy",value:function(e,t,n,r){t.id;var a=t.offset,i=t.copyId,o=this.getTypeForId(i);Object(mo.f)(o)||(a=a.slice(0,2)),this.positions[e]=a;var s=this.positionUniforms[e];window.stopRender=r,s([this.positions[e]])}},{key:"handleSDFCopy",value:function(e,t,n){for(var r,a,i=this,o=(t.id,t.offset),s=t.copyId,c=0;c<n.length;c++){var u=n[c];if(u.id===s){a=c,r=u;break}}if(!r)return{sdf:void 0,sdfEvaluator:void 0};var l=this.glDimensions[a],f=this.glPositions[a],h=this.glCorners[a],p=this.glRotations[a],d=this.getTypeForId(s),m=is(this.zObject,function(){return f})(["circle"===d?-1:1]),v=as(this.zObject,function(){return m}),b=r;b[1]=o[0],b[2]=o[1],Object(mo.f)(d)&&(b[3]=o[2]);var g=v([this.getPosition(e,b)]),y=this.glSDFs[e]||ho(this.zObject,function(){return r[0]},function(){return l},function(){return h},function(){return i.transformationMatrices[e]||i.transformationMatrix},function(){return p},function(){return e});this.glSDFs[e]=y;var k=y([g]),O=Object(Hr.a)(k,2),j=O[0],w=O[1],E=w.uniforms;return this.indexedUniforms[e]=E,{sdf:w,sdfEvaluator:j,uniforms:E}}},{key:"getPosition",value:function(e,t){var n=Object(mo.c)(t),r=Object(Hr.a)(n,3);r[0],r[1],r[2],this.positions[e]=n;var a=this.name("position",e);this.uniformValues[a]=n;var i=this.positionUniforms[e]||Ya({},function(){return a});return this.positionUniforms[e]=i,this.glPositions[e]=i([n],!0),this.glPositions[e]}},{key:"getRepeats",value:function(e,t){var n=Object(mo.d)(t);this.repeats[e]=n;var r=this.name("repeats",e);this.uniformValues[r]=n;var a=this.repeatsUniforms[e]||Ya({},function(){return r});return this.repeatsUniforms[e]=a,this.glRepeats[e]=a([n],!0),this.glRepeats[e]}},{key:"name",value:function(e,t){return e+t+this.id.replaceAll("-","")}},{key:"getDimensions",value:function(e,t){var n=Object(mo.b)(t),r=Object(Hr.a)(n,3),a=r[0],i=r[1],o=r[2],s=this.name("dimWidth",e),c=this.name("dimHeight",e),u=this.name("dimDepth",e);this.dimensions[e]=n,this.uniformValues[s]=a,this.uniformValues[c]=i,this.uniformValues[u]=o;var l,f=this.dimensionsUniforms[e]||[Ya({},function(){return s}),Ya({},function(){return c}),Ya({},function(){return u})],h=Object(Hr.a)(f,3),p=h[0],d=h[1],m=h[2];return this.dimensionsUniforms[e]=[p,d,m],l=this.dimensionVecs[e]?this.dimensionVecs[e]:Object(mo.f)(t[0])?ei(this.zObject,function(){return d([i],!0)},function(){return m([o],!0)}):ti(this.zObject,function(){return d([i],!0)}),this.dimensionVecs[e]=l,this.glDimensions[e]=l([p([a],!0)]),this.glDimensions[e]}},{key:"getCorner",value:function(e,t){var n=this.name("corner",e),r=this.cornerUniforms[e]||Ya({},function(){return n});return this.corners[e]=t,this.cornerUniforms[e]=r,this.glCorners[e]=r([t],!0),this.glCorners[e]}},{key:"getRotation",value:function(e,t){var n=this.name("rotation",e),r=this.rotationUniforms[e]||Ya({},function(){return n});return this.rotations[e]=t,this.rotationUniforms[e]=r,this.glRotations[e]=r([t],!0),this.glRotations[e]}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=go(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"onMouseDown",value:function(e){for(var t=Object(Hr.a)(e,2),n=(t[0],t[1],0);n<this.lastSDFs.length;n++){var r=this.corners[n],a=this.positions[n],i=this.lastSDFs[n],o=this.dimensions[n];if(i&&i.copyId){var s,c=-1,u=0,l=vo(this.lastSDFs);try{for(l.s();!(s=l.n()).done;){if(s.value.id===i.copyId){c=u;break}u++}}catch(h){l.e(h)}finally{l.f()}if(c>-1){var f=this.positions[c];a[0]+=f[0],a[1]+=f[1],r=this.corners[c],o=this.dimensions[c]}}if(!(o[0]>.7)&&this.mouseSDF(e,n,a,o,r)<0)return this.mouseDown=n,this.sendMessage("Index Clicked",n),void this.onMouseMove(e)}this.mouseDown=void 0,this.sendMessage("Index Clicked",-1)}},{key:"screenToGLCoords",value:function(e,t){var n=[e,t],r=this.size||[400,400];return[(2*n[0]-r[0])/r[1],-(2*n[1]-r[1])/r[1]]}},{key:"mouseSDF",value:function(e,t,n,r,a){var i=this.size||[400,400],o=n||this.positions[t],s=r||this.dimensions[t],c=a||this.corners[t],u=[(2*e[0]-i[0])/i[1],-(2*e[1]-i[1])/i[1]];u=[u[0]-o[0],u[1]-o[1]];var l=[Math.abs(u[0])-s[0]+c,Math.abs(u[1])-s[1]+c];return Math.min(Math.max(l[0],l[1]),0)+Math.sqrt(Math.pow(Math.max(0,l[0]),2)+Math.pow(Math.max(0,l[1]),2))-c}},{key:"onMouseUp",value:function(e){this.mouseDown=void 0}},{key:"onSliderValues",value:function(e){if(this.storedSDFs){for(var t=[],n=0;n<e.length;n++){var r=e[n],a=this.dimensions[n];if(a){var i=-Math.min(a[0]+0,a[1]+0),o=i-r*i;t.push(Math.max(i+window.MIN_SDF_VALUE,o))}}this.sendMessage("On Slider SDF Change",t)}}},{key:"onMouseMove",value:function(e){if(void 0!==this.mouseDown){var t=this.mouseSDF(e,this.mouseDown),n=this.dimensions[this.mouseDown],r=this.screenToGLCoords(e[0],e[1]),a=this.positions[this.mouseDown],i=this.dimensions[this.mouseDown],o=this.corners[this.mouseDown];i[0]>i[1]&&(o*=.5);var s=a[1]+i[1]/2+o,c=a[1]-i[1]/2-o,u=(r[1]-c)/(s-c);u=Math.max(0,Math.min(1,u));var l=-Math.min(n[0]+0,n[1]+0);t=l-u*l;var f=u;t=Math.max(l+window.MIN_SDF_VALUE,t),this.sendMessage("On Slider Change",[this.mouseDown,Math.min(1,f)]),this.sendMessage("On Slider SDF Change",[this.mouseDown,Math.min(0,t)])}}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=io(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).dimensionFactors=[],e}return Object(s.a)(n,[{key:"onSDFOperationList",value:function(e){this.sdfOperationsList=e,this.lastSDFs&&this.onSDFList(this.lastSDFs,!0)}},{key:"onOperation",value:function(e){var t=e.split(" "),n=t[0],r=ao[n],a=t.slice(1).map(function(e){return parseFloat(e)});r&&r.apply(void 0,[this].concat(Object(h.a)(a)))}}]),n}(e)})(xa)),Co=function(e){var t=e.filter(function(e){return!No(e)}),n=e.filter(function(e){return No(e)});return[].concat(Object(h.a)(t),Object(h.a)(n))},No=function(e){return!Array.isArray(e)},Ro=function(e){e.some(function(e){return"number"===typeof e})&&(e=e.filter(function(e){return!Object(ae.a)(e)}));for(var t=0;t<e.length;t++){var n=e[t];if("string"===typeof n){var r=n.split(" ").map(function(e){return Object(ae.a)(e)?parseFloat(e):e});e[t]=r}e[t].id||(e[t].id=t)}return e};function Mo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ao=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=new Ha(e.subSequence,Ra.c);return a.text=t,a.min=n,a.max=r,a},qo=function(e){Object(u.a)(n,e);var t=Mo(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newOutlet("SDF Object"),r.type="box",r.zObject.setAttribute("primary-color","#545460"),r.zObject.hasInletFields=!0,r.x=Ao(Object(c.a)(r),0),r.y=Ao(Object(c.a)(r),0),r.z=Ao(Object(c.a)(r),0,-3,3),r.w=Ao(Object(c.a)(r),.1,0,1),r.h=Ao(Object(c.a)(r),.2,0,1),r.d=Ao(Object(c.a)(r),.1,0,1),r.c=Ao(Object(c.a)(r),.1,0,1),r.r=Ao(Object(c.a)(r),0,-Math.PI,Math.PI),r.repeatSpread=Ao(Object(c.a)(r),0,-1,1),r.repeatCountX=Ao(Object(c.a)(r),0,0,8),r.repeatCountX.round=!0,r.repeatCountY=Ao(Object(c.a)(r),0,0,8),r.repeatCountY.round=!0,r.repeatCountZ=Ao(Object(c.a)(r),0,0,8),r.repeatCountZ.round=!0,r.newInlet("x",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.x,t)}),r.newInlet("y",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.y,t)}),r.newInlet("z",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.z,t)}),r.newInlet("width",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.w,t)}),r.newInlet("height",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.h,t)}),r.newInlet("depth",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.d,t)}),r.newInlet("corner",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.c,t)}),r.newInlet("rotation",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.r,t)}),r.newInlet("repeat spread",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.repeatSpread,t)}),r.newInlet("repeat x",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.repeatCountX,t)}),r.newInlet("repeat y",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.repeatCountY,t)}),r.newInlet("repeat z",function(e){var t=Object(Hr.a)(e,1)[0];return r.on(r.repeatCountZ,t)}),r}return Object(s.a)(n,[{key:"on",value:function(e,t){isNaN(t)||(e.text=t,this.sendObject())}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{x:this.x._text,y:this.y._text,z:this.z._text,w:this.w._text,h:this.h._text,d:this.d._text,c:this.c._text,r:this.r._text,repeatSpread:this.repeatSpread._text,repeatCountX:this.repeatCountX._text,repeatCountY:this.repeatCountY._text,repeatCountZ:this.repeatCountZ._text,type:this.type})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),void 0!==e.x&&(this.x.text=e.x,this.y.text=e.y,this.z.text=e.z,this.w.text=e.w,this.h.text=e.h,this.d.text=e.d,isNaN(e.repeatCountX)||(this.repeatSpread.text=e.repeatSpread,this.repeatCountX.text=e.repeatCountX,this.repeatCountY.text=e.repeatCountY,this.repeatCountZ.text=e.repeatCountZ),isNaN(e.r)||(this.r.text=e.r),this.c.text=e.c,this.type=e.type)}},{key:"sendObject",value:function(){var e=[];(e=Object(mo.f)(this.type)?[this.type,this.x._text,this.y._text,this.z._text,this.w._text,this.h._text,this.d._text,this.c._text,this.r._text,[this.repeatSpread._text,this.repeatCountX._text,this.repeatCountY._text,this.repeatCountZ._text]]:[this.type,this.x._text,this.y._text,this.w._text,this.h._text,this.c._text,this.r._text]).id=this.id,this.sendMessage("SDF Object",e)}}]),n}(xa);Object(Ea.a)("gl.estimateNormal",{sdfs:"list of sdfs",rayOrigin:"",rayDirection:"","ray marched distance":""},"Estimates normal for list of sdfs (to be unioned together)",function(){return 1},{isHot:!0,inlets:4});var Do=function(e,t,n,r){var a="estimateNormal_"+Object(j.uuid)().replaceAll("-","").slice(0,4);return function(e){var i=Object(Hr.a)(e,1)[0],o=Object(Wa.a)(i,t,n,r),s=o.codes,c=o.uniforms,u=o.functions;return u[a]={args:{p:"vec3"},returnType:"vec3",body:"\nreturn normalize(vec3(\n        ".concat(i.code("vec3(p.x + EPSILON, p.y, p.z)"),".x - ").concat(i.code("vec3(p.x - EPSILON, p.y, p.z)"),".x,\n        ").concat(i.code("vec3(p.x, p.y + EPSILON, p.z)"),".x - ").concat(i.code("vec3(p.x, p.y - EPSILON, p.z)"),".x,\n        ").concat(i.code("vec3(p.x, p.y, p.z  + EPSILON)"),".x - ").concat(i.code("vec3(p.x, p.y, p.z - EPSILON)"),".x\n    ));\n")},{code:"".concat(a,"(").concat(s[1]," + ").concat(s[2]," * ").concat(s[3],")"),functions:u,uniforms:c}}};Object(Ea.a)("gl.diffusedLight",{normal:"",rayOrigin:"",rayDirection:"","ray marched distance":"","light position":"",d1:"",d2:""},"Calculates light",function(){return 1},{isHot:!0,inlets:7});var Io=function(e,t,n,r,a,i,o){return Object(Xa.a)(function(e){var s=Object(Qa.a)(e,t,n,r,a,i,o),c="(".concat(s[1]," + ").concat(s[2]," * ").concat(s[3],")"),u="normalize(".concat(s[4]," - ").concat(c,") * ").concat(Object(Wa.b)(s[5]));return"clamp(dot(".concat(s[0],", ").concat(u,"), 0., 1.) * ").concat(Object(Wa.b)(s[6])," + ").concat(Object(Wa.b)(s[6]))},t,n,r,a,i,o)};Object(Ea.a)("gl.raymarching3D",{sdfList:"list of sdf objects to be used for ray marching",rayOrigin:"origin of eye (vec3)",fieldOfView:"field of view angle (float)"},"Creates a new uniform variable with value from left-inlet, in GLSL.",function(){return 3},{isHot:!0,tags:"GLSL",inlets:3,outlets:["raymarched distance","ray direction","sdf value"]});var _o=function(e,t,n,r){e.needsHotReload=!0;var a=Object(j.uuid)(),i="raymarching_"+a.replaceAll("-","").slice(0,4),o="shadow_"+a.replaceAll("-","").slice(0,4),s="normal_"+a.replaceAll("-","").slice(0,4);return function(e){var a=Object(Hr.a)(e,1)[0],c=Object(Wa.a)(a,t,n,r),u=c.codes,l=c.uniforms,f=c.functions,h=c.variables;f[s]={args:{pos:"vec3"},returnType:"vec3",body:"\nvec2 e = vec2(1.0,-1.0)*0.5773;\n    const float eps = 0.0005;\n    return normalize( e.xyy*".concat(a.code("pos + e.xyy*eps"),".x + \n\te.yyx*").concat(a.code("pos + e.yyx*eps"),".x + \n\te.yxy*").concat(a.code("pos + e.yxy*eps"),".x + \n\te.xxx*").concat(a.code("pos + e.xxx*eps"),".x);\n")},f[o]={args:{ro:"vec3",rd:"vec3",tmin:"float",tmax:"float",k:"float"},returnType:"float",body:"\n    float res = 1.0;\n    float t = tmin;\n    for( int i=0; i<64; i++ )\n    {\n\tfloat h = ".concat(a.code("ro + rd*t"),".x;\n        res = min( res, k*h/t );\n        t += clamp( h, 0.003, 0.10 );\n        if( res<0.002 || t>tmax ) break;\n    }\n    return clamp( res, 0.0, 1.0 );\n")},f[i]={args:{rayOrigin:"vec3",fieldOfView:"float",rayDirection:"vec3"},returnType:"vec4",body:"\nfloat depth = ".concat(Object(Wa.b)(1e-4),";\nfloat index = -1.0;\nvec3 ogRayOrigin = rayOrigin;\nfloat dist = 0.0;\n\nfor(int i=0; i<").concat(90,";i++){\n    vec2 di =  ").concat(a.code("rayOrigin + depth*rayDirection"),";\n    dist = di.x;\n    if (dist < ").concat(1e-4,") {\n        // need to calculate the shadow \n        index = di.y;\n        break;\n    }\n    if (depth > ").concat(80.01,") {\n        break;\n    }\n    depth += dist;\n}\nif (depth < ").concat(80.01,") {\n/*\n  vec3 pos = rayOrigin + depth*rayDirection;\n  vec3 nor = ").concat(s,"(pos);\n  vec3 lig = ").concat(u[3],";\n  float dif = clamp( dot(nor,lig), 0.0, 1.0 );\n  if ( dif>0.001 ) dif *= ").concat(o,"( pos+nor*0.001, lig, 0.001, 1.0, 32.0 );\n  float amb = 0.5 + 0.5*dot(nor,vec3(0.0,1.0,0.0));\n*/\n  return vec4(depth, index, 0.0, 0.0);\n}\nreturn vec4(").concat(80.01,", index, 0., 0.);\n")},h||(h={}),h.rayDir={type:"vec3",code:"getRayDir(lookAt(".concat(Object(Wa.b)(u[1]),", vec3(0.0, 0.0, 0.0), vec3(0.0,0.0,0.5)), ").concat(Object(Wa.b)(u[2]),")")};var p="(".concat(i,"(").concat(Object(Wa.b)(u[1]),", ").concat(Object(Wa.b)(u[2]),", rayDir))"),d=a.code("vec3((1.0*gl_FragCoord.xy-vec2(width, height))/height, 0.0)");return[{code:p,variables:h,uniforms:l,functions:f,hashCode:Object(Ka.a)(p)},{code:"rayDir",variables:h,uniforms:l,functions:f,hashCode:Object(Ka.a)("rayDir")},{code:d,variables:h,uniforms:l,functions:f,hashCode:Object(Ka.a)(d)}]}},Fo={"gl.estimateNormal":Do,"gl.raymarching3D":_o,"gl.sdf":ho,"gl.diffusedLight":Io};Object(Ea.a)("sdf.softShadow",{scene:"scene to compute soft shadow for",rayOrigin:"origin of ray",rayDirection:"direction of ray",k:"softness of shadow"},"Creates a soft shadow",function(){return 1},{inlets:4});function Lo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Bo=function(e){Object(u.a)(n,e);var t=Lo(n);function n(e){var r;return Object(o.a)(this,n),r=t.call(this,e),e.skipHotReload=!0,r.skipHotReload=!0,r.setup(),r.newInlet("GL SDF Evaluators",function(e){var t=Object(Hr.a)(e,1)[0];return r.onSDFs(t)}),r.newInlet("Light Position",function(e){var t=Object(Hr.a)(e,1)[0];return r.onLightPosition(t)}),r.newInlet("Light Diffusion",function(e){var t=Object(Hr.a)(e,1)[0];return r.onLightDiffusion(t)}),r.newInlet("Camera Position",function(e){var t=Object(Hr.a)(e,1)[0];return r.onCameraPosition(t)}),r.newInlet("Field of View",function(e){var t=Object(Hr.a)(e,1)[0];return r.onFieldOfView(t)}),r.newOutlet("Light Strength"),r.newOutlet("Raw Light Strength"),r.newOutlet("Ray-Marched Distance"),r.newOutlet("Ray-Marched Index"),r.newOutlet("Normal"),r.newOutlet("Data"),r}return Object(s.a)(n,[{key:"hotReload",value:function(){this.lastSDFs&&this.onSDFs(this.lastSDFs)}},{key:"onCameraPosition",value:function(e){this._cameraPosition=e,this.rayOriginXUniform([e[0]]),this.rayOriginYUniform([e[1]]),this.rayOriginZUniform([e[2]])}},{key:"onLightDiffusion",value:function(e){this._lightDiffusion=e,this.lightDiffusionUniform([e])}},{key:"onLightPosition",value:function(e){Array.isArray(e)&&(this._lightPosition=e,this.lightPositionXUniform([e[0]]),this.lightPositionYUniform([e[1]]),this.lightPositionZUniform([e[2]]))}},{key:"setup",value:function(){var e=this;this.rayOriginXUniform=Ya({},function(){return e.name("rayOriginX")}),this.rayOriginYUniform=Ya({},function(){return e.name("rayOriginY")}),this.rayOriginZUniform=Ya({},function(){return e.name("rayOriginZ")}),this.rayOriginVec3=ei(this.zObject,function(){return e.rayOriginYUniform([e.rayOriginY],!0)},function(){return e.rayOriginZUniform([e.rayOriginZ],!0)}),this.fieldOfViewUniform=Ya({},function(){return e.name("fieldOfView")}),this.lightPositionXUniform=Ya({},function(){return e.name("lighPositionX")}),this.lightPositionYUniform=Ya({},function(){return e.name("lightPositionY")}),this.lightPositionZUniform=Ya({},function(){return e.name("lightPositionZ")}),this.lightDiffusionUniform=Ya({},function(){return e.name("lightDiffusion")}),this.lightPositionVec3=ei(this.zObject,function(){return e.lightPositionYUniform([e.lightPositionY],!0)},function(){return e.lightPositionZUniform([e.lightPositionZ],!0)}),this.raymarcher=_o(this.zObject,function(){return e.rayOrigin},function(){return e.fieldOfViewUniform([e.fieldOfView],!0)},function(){return e.lightPosition}),this.normalEstimator=Do(this.zObject,function(){return e.rayOrigin},function(){return e.rayDirection},function(){return e.rayMarchedDistance}),this.lightDiffuser=Io(this.zObject,function(){return e.rayOrigin},function(){return e.rayDirection},function(){return e.rayMarchedDistance},function(){return e.lightPosition},function(){return e.lightDiffusionUniform([e.lightDiffusion],!0)},function(){return.64}),this.occlusion=function(e,t,n,r,a){var i="ao"+Object(j.uuid)().replaceAll("-","");return function(e){var o=Object(Hr.a)(e,1)[0],s=Object(Wa.a)(o,t,n,r,a),c=s.codes,u=s.uniforms,l=s.functions,f=s.variables;return l[i]={args:{rayOrigin:"vec3",rayDirection:"vec3",distance:"float",nor:"vec3"},returnType:"float",body:"\n      vec3 pos = rayOrigin + rayDirection*distance;\n      float occ = 0.0;\n      float sca = 1.0;\n      for( int i=0; i<5; i++ )\n      {\n          float hr = 0.01 + 0.12 * float( i ) / 4.0;\n          vec3 aopos =  nor * hr + pos;\n          float dd = ".concat(o.code(" aopos "),".x;\n          occ += -(dd-hr)*sca;\n          sca *= 0.95;\n      }\n      return clamp( 1.0 - 3.0*occ, 0.0, 1.0 );    \n")},{code:"".concat(i,"(").concat(c.slice(1).map(function(e){return Object(Wa.b)(e)}).join(","),")"),uniforms:u,functions:l,variables:f}}}(this.zObject,function(){return e.rayOrigin},function(){return e.rayDirection},function(){return e.rayMarchedDistance},function(){return e.normal})}},{key:"onFieldOfView",value:function(e){this.fieldOfViewUniform([e])}},{key:"fieldOfView",get:function(){return 90}},{key:"lightDiffusion",get:function(){return void 0===this._lightDiffusion?1.96:this._lightDiffusion}},{key:"rayOriginX",get:function(){return this._cameraPosition?this._cameraPosition[0]:.2}},{key:"rayOriginY",get:function(){return this._cameraPosition?this._cameraPosition[1]:.2}},{key:"rayOriginZ",get:function(){return this._cameraPosition?this._cameraPosition[2]:1}},{key:"lightPositionX",get:function(){return this._lightPosition?this._lightPosition[0]:0}},{key:"lightPositionY",get:function(){return this._lightPosition?this._lightPosition[1]:1.8}},{key:"lightPositionZ",get:function(){return this._lightPosition?this._lightPosition[2]:1.8}},{key:"rayOrigin",get:function(){var e=this.rayOriginXUniform([this.rayOriginX],!0);return this.rayOriginVec3([e])}},{key:"lightPosition",get:function(){return this.lightPositionVec3([this.lightPositionXUniform([this.lightPositionX],!0)])}},{key:"onSDFs",value:function(e){var t=this;this.rayOriginXUniform([this.rayOriginX]),this.rayOriginYUniform([this.rayOriginY]),this.lastSDFs=e;var n=this.raymarcher([e]),r=Object(Hr.a)(n,2),a=r[0],i=r[1],o=this.name("rayMarchedReturn"),s=Object(p.a)({},a,{code:o+".x"}),c=Object(p.a)({},a,{code:o+".y"});this.rayMarchedReturn=Za(this.zObject,function(){return o},function(){return"vec4"})([a]),this.rayMarchedDistance=Za(this.zObject,function(){return t.name("rayMarchedDistance")},function(){return"float"})([s]),this.rayMarchedIndex=Za(this.zObject,function(){return t.name("rayMarchedIndex")},function(){return"float"})([c]),this.rayDirection=Za(this.zObject,function(){return t.name("rayDirection")},function(){return"vec3"})([i]);var u=this.normalEstimator([e]),l=u,f=this.lightDiffuser([l]),h=so(this.zObject,function(){return 0},function(){return 80.01});this.normal=l;var d=is(this.zObject,function(){return h([t.rayMarchedDistance])}),m=Za(this.zObject,function(){return t.name("shadow")},function(){return"float"})([Object(p.a)({},this.rayMarchedReturn,{code:this.rayMarchedReturn.code+".z"})]),v=Za(this.zObject,function(){return t.name("hitNormal")},function(){return"float"})([Object(p.a)({},this.rayMarchedReturn,{code:this.rayMarchedReturn.code+".w"})]),b=this.occlusion([this.lastSDFs]),g=Za(this.zObject,function(){return t.name("occlusion")},function(){return"float"})([b]),y=d([f]),k=e.functions;y.functions=Object(p.a)({},y.functions,u.functions,a.functions,b.functions,k),y.variables=Object(p.a)({},m.variables,v.variables,this.rayDirection.variables,this.rayMarchedReturn.variables,this.rayMarchedDistance.variables,this.rayMarchedIndex.variables,g.variables,y.variables,l.variables),this.rayMarchedIndex.variables=Object(p.a)({},m.variables,v.variables,this.rayDirection.variables,this.rayMarchedReturn.variables,this.rayMarchedDistance.variables,this.rayMarchedIndex.variables,g.variables,y.variables,l.variables),this.rayMarchedDistance.functions=Object(p.a)({},this.rayMarchedDistance.functions,b.functions),this.rayMarchedDistance.variables=Object(p.a)({},m.variables,v.variables,this.rayMarchedReturn.variables,this.rayMarchedIndex.variables,this.rayMarchedDistance.variables,g.variables),this.sendMessage("Light Strength",y),this.sendMessage("Ray-Marched Distance",this.rayMarchedDistance),this.sendMessage("Normal",l),this.sendMessage("Ray-Marched Index",this.rayMarchedIndex),this.sendMessage("Data",{occlusion:g,rayOrigin:this.rayOrigin,rayDirection:this.rayDirection,rayMarchedDistance:this.rayMarchedDistance,scene:this.lastSDFs,normal:l})}},{key:"name",value:function(e){return e+this.id.replaceAll("-","")}}]),n}(xa);Object(Ea.a)("gl.sdfManager",{},"Create and manage multiple SDF objects with mouse events",function(){return 0},{inlets:0,altName:"sdf.manager",connects:[{outlet:"GL SDF Evaluators",object:"raymarching.manager",inlet:"GL SDF Evaluators"}]});var zo=function(e){new To(e);return function(){}};Object(Ea.a)("gl.rayMarchingManager",{},"Manages ray marching for sdfs",function(){return 0},{inlets:0,altName:"raymarching.manager",connects:[{outlet:"Data",object:"gl.directionalLighting",inlet:"Input"}]});var Vo=function(e){new Bo(e);return function(){}};Object(Ea.a)("gl.sdfBuilder",{},"Graphically build sdf objects (to send to sdf-manager)",function(){return 0},{inlets:0,altName:"sdf.builder",connects:{object:"uniqueAppend"}});var Ho=function(e){var t=new qo(e);return e.needsLoad=!0,function(){t.sendObject()}};Object(Ea.a)("gl.unpack",{"vec2/vec3/vec4":""},"Unpacks a vector into its components, out of its outlets",function(){return 4},{inlets:1});Object(Ea.a)("gl.rgb2hsl",{"rgb vec3":""},"Returns a vec3 of hsl representation of rgb vec3 passed in",function(){return 1},{inlets:1});Object(Ea.a)("gl.hsl2rgb",{"hsl vec3":""},"Returns a vec3 of rgb representation of hsl vec3 passed in",function(){return 1},{inlets:1});Object(Ea.a)("gl.color",{hexColor:""},"Converts hex color into vec4 with uniforms",function(){return 1},{connects:{object:"gl.fragColor"}});Object(Ea.a)("gl.hueShift",{color:"","shift amount":""},"Shifts color's hue by a given amount",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.colorSwapRG",{color:"vec4",swap:"float"},"Conditionally swaps the R and G values in the vec4 passed in left-inlet, when 2nd inlet is 1.",function(){return 1},{isHot:!0,inlets:2});var Uo={"gl.hueShift":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(e){var n=Object(Qa.a)(e,t),r="rgb2hsl(vec3(".concat(Object(Wa.b)(n[0]),".x, ").concat(Object(Wa.b)(n[0]),".y, ").concat(Object(Wa.b)(n[0]),".z))"),a="hsl2rgb(vec3(mod((".concat(r,").x + ").concat(Object(Wa.b)(n[1]),", 1.0), ").concat(r,".y, ").concat(r,".z))");return"vec4(".concat(a,", (").concat(n[0],").w)")},t)},"gl.hsl2rgb":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(e){var t=Object(Qa.a)(e);return"hsl2rgb(".concat(Object(Wa.b)(t[0]),")")})},"gl.rgb2hsl":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(e){var t=Object(Qa.a)(e);return"rgb2hsl(".concat(Object(Wa.b)(t[0]),")")})},"gl.color":function(e){e.needsHotReload=!0;var t={};return function(n){var r=Object(Hr.a)(n,1)[0],a=(r=r.slice(1)).slice(0,2),i=r.slice(2,4),o=r.slice(4,6),s=(r.slice(6,8),[parseInt(a,16)/255,parseInt(i,16)/255,parseInt(o,16)/255]),c=e.id.replaceAll("-",""),u=t.r||Ya(e,function(){return"r"+c}),l=t.g||Ya(e,function(){return"g"+c}),f=t.b||Ya(e,function(){return"b"+c});t.r=u,t.g=l,t.b=f;var h=u([s[0]],!0),d=l([s[1]],!0),m=f([s[2]],!0),v="vec4(r".concat(c,", g").concat(c,", b").concat(c,", 1.0)");return[{code:v,hashCode:Object(Ka.a)(v),variables:{},functions:{},uniforms:Object(p.a)({},h.uniforms,d.uniforms,m.uniforms)}]}},"gl.colorSwapRG":function(e,t){return Object(Xa.a)(function(e){var n=Object(Qa.a)(e,t),r=Object(Hr.a)(n,2),a=r[0],i=r[1];return console.log("_swap =",i),a=Object(Wa.b)(a),i=Object(Wa.b)(i),"((".concat(i,") == 1.0 ? \n    vec4(").concat(a,".g, ").concat(a,".r, ").concat(a,".b, ").concat(a,".a) : ").concat(a,")")},t)}};Object(Ea.a)("gl.fwidth",{x:""},"Creates GLSL expression calculating fwidth (partial derivative) of inlet",function(){return 1},{tags:"GLSL",inlets:1});Object(Ea.a)("gl.sqrt",{x:""},"Creates GLSL expression calculating sqrt of inlet",function(){return 1},{tags:"GLSL",inlets:1});Object(Ea.a)("gl.floor",{x:""},"Creates GLSL expression calculating floor of inlet",function(){return 1},{tags:"GLSL",inlets:1});Object(Ea.a)("gl.ceil",{x:""},"Creates GLSL expression calculating ceil of inlet",function(){return 1},{tags:"GLSL",inlets:1});Object(Ea.a)("gl.rand",{x:""},"Creates GLSL expression for calculating a pseudo-random number given a vec2",function(){return 1},{tags:"GLSL",inlets:1});Object(Ea.a)("gl.sin",{x:""},"Creates GLSL expression calculating sin of inlet",function(){return 1},{tags:"GLSL",inlets:1});Object(Ea.a)("gl.cos",{x:""},"Creates GLSL expression calculating cosine of inlet",function(){return 1},{tags:"GLSL",inlets:1});Object(Ea.a)("gl.tan",{x:""},"Creates GLSL expression calculating tangent of inlet",function(){return 1},{tags:"GLSL",inlets:1});Object(Ea.a)("gl.atan",{y:"",x:""},"Creates GLSL expression calculating arc-tangent of inlets",function(){return 1},{isHot:!0,tags:"GLSL",inlets:2});Object(Ea.a)("gl.atan2",{y:"",x:""},"Creates GLSL expression calculating arc-tangent 2 of inlets",function(){return 1},{isHot:!0,tags:"GLSL",inlets:2});Object(Ea.a)("gl.pow",{y:"",x:""},"Creates GLSL expression calculating pow (exponent) of inlets",function(){return 1},{isHot:!0,tags:"GLSL",inlets:2});Object(Ea.a)("gl.smoothstep",{a:"",b:"",c:""},"Creates GLSL expression calculating smoothstep of inlets",function(){return 1},{isHot:!0,tags:"GLSL",inlets:3});var Jo={"gl.sin":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(t){var n=(t=t||{}).code||t||"0.";return e.flash(),"sin(".concat(Object(Wa.b)(n),")")})},"gl.cos":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(t){var n=(t=t||{}).code||t||"0.";return e.flash(),"cos(".concat(n,")")})},"gl.tan":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(t){var n=(t=t||{}).code||t||"0.";return e.flash(),"tan(".concat(Object(Wa.b)(n),")")})},"gl.atan":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"atan(".concat(Object(Wa.b)(r[0]),", ").concat(Object(Wa.b)(r[1]),")")},t)},"gl.atan2":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"ATan2(".concat(Object(Wa.b)(r[0]),", ").concat(Object(Wa.b)(r[1]),")")},t)},"gl.pow":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"pow(".concat(Object(Wa.b)(r[0]),", ").concat(Object(Wa.b)(r[1]),")")},t)},"gl.floor":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(t){var n=(t=t||{}).code||t||"0.";return e.flash(),"floor(".concat(Object(Wa.b)(n),")")})},"gl.ceil":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(t){var n=(t=t||{}).code||t||"0.";return e.flash(),"ceil(".concat(Object(Wa.b)(n),")")})},"gl.sqrt":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(t){var n=(t=t||{}).code||t||"0.";return e.flash(),"sqrt(".concat(Object(Wa.b)(n),")")})},"gl.smoothstep":function(e,t,n){return e.needsHotReload=!0,Object(Xa.a)(function(r){var a=Object(Qa.a)(r,t,n);return e.flash(),"smoothstep(".concat(Object(Wa.b)(a[0]),", ").concat(Object(Wa.b)(a[1]),", ").concat(Object(Wa.b)(a[2]),")")},t,n)},"gl.rand":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(t){var n=(t=t||{}).code||t||"vec2(0.,0.)";return e.flash(),"rand(".concat(Object(Wa.b)(n),")")})},"gl.fwidth":function(e){return e.needsHotReload=!0,Object(Xa.a)(function(t){var n=(t=t||{}).code||t||"0.";return e.flash(),"fwidth(".concat(Object(Wa.b)(n),")")})}};Object(Ea.a)("gl.texture2D",{texture:"",textureCoords:""},"Calls texture2D on texture and texture coords",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.eq",{},"Fuck",function(){return 1},{isHot:!0,inlets:2});var Go=function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(".concat(Object(Wa.b)(r[0])," == ").concat(Object(Wa.b)(r[1]),")")},t)};Object(Ea.a)("gl.gt",{},"Fuck",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.gte",{},"Fuck",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.lt",{},"Fuck",function(){return 1},{isHot:!0,inlets:2});var Wo=function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(".concat(Object(Wa.b)(r[0])," < ").concat(Object(Wa.b)(r[1]),")")},t)};Object(Ea.a)("gl.lte",{},"Fuck",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.and",{},"Fuck",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.cond",{},"Fuck",function(){return 1},{isHot:!0,inlets:3});var Ko=function(e,t,n){return e.needsHotReload=!0,Object(Xa.a)(function(r){var a=Object(Qa.a)(r,t,n);return e.flash(),"(\n    ".concat(Object(Wa.b)(a[0])," ? \n        ").concat(Object(Wa.b)(a[1])," : \n        ").concat(Object(Wa.b)(a[2]),")")},t,n)};Object(Ea.a)("gl.pass",{},"Fuck",function(){return 1},{isHot:!0,inlets:3});Object(Ea.a)("gl.switch",{switchNumber:""},"switches based on argument",function(){return 1},{inlets:function(e){return e+1}});Object(Ea.a)("gl.anyLTE",{"condition list":"",list:""},"Returns 1 if any of the elements in first inlet is below the 2nd",function(){return 1},{inlets:2});var Xo=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(0===r.length)return 0;var i=e(t,n.slice(1),r.slice(1),a+1),o=r[0],s=n[0];return Ko(t,function(){return 1},function(){return i})([Wo(t,function(){return s})([o])])};Object(Ea.a)("gl.listSwitch",{list:""},"Returns 1 if any of the elements in first inlet is below the 2nd",function(){return 1},{inlets:2});var Qo=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(1===r.length)return r[0]();var i=e(t,n,r.slice(1),a+1),o=a;return Ko(t,r[0],function(){return i})([Go(t,function(){return o})([n])])},Yo={"gl.switch":function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(t){var r=Object(Hr.a)(t,1)[0];return Qo(e,r,n.filter(function(e){return null!==e()&&void 0!==e()}),0)}},"gl.cond":Ko,"gl.gt":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(".concat(Object(Wa.b)(r[0])," > ").concat(Object(Wa.b)(r[1]),")")},t)},"gl.gte":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(".concat(Object(Wa.b)(r[0])," >= ").concat(Object(Wa.b)(r[1]),")")},t)},"gl.lt":Wo,"gl.lte":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(".concat(Object(Wa.b)(r[0])," <= ").concat(Object(Wa.b)(r[1]),")")},t)},"gl.and":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(".concat(Object(Wa.b)(r[0])," && ").concat(Object(Wa.b)(r[1]),")")},t)},"gl.eq":Go,"gl.pass":function(e,t,n){return e.needsHotReload=!0,Object(Xa.a)(function(r){var a=Object(Qa.a)(r,t,n);return e.flash(),"(".concat(Object(Wa.b)(a[1])," == ").concat(Object(Wa.b)(a[2])," ? ").concat(Object(Wa.b)(a[0])," : 0.0)")},t,n)},"gl.listSwitch":function(e,t){return function(n){var r=Object(Hr.a)(n,1)[0];if(t())return Qo(e,r,t().map(function(e){return function(){return e}}),0)}},"gl.anyLTE":function(e,t){return function(n){var r=Object(Hr.a)(n,1)[0];if(t()&&r)return Xo(e,r,t(),0)}}};Object(Ea.a)("gl.sdfCopy",{sdf:"",offset:""},"Takes an SDF and outputs an offsetted copy (SDF Manager will efficiently output it)",function(){return 1},{isHot:!0,inlets:2,altName:"sdf.copy"});var Zo=function(e,t){var n=Object(j.uuid)();return function(e){var r=Object(Hr.a)(e,1)[0],a=t();if(r&&r.id)return{id:n,copyId:r.id,offset:a}}};Object(Ea.a)("gl.sdfMultiCopies",{sdf:"",count:"",offset:""},"Takes an SDF and outputs an offsetted copy (SDF Manager will efficiently output it)",function(){return 1},{isHot:!0,inlets:3,altName:"sdf.multiCopies"});var $o=function(e,t,n){Object(j.uuid)();var r=void 0;return function(e){var a=Object(Hr.a)(e,1)[0];if(n()&&a&&a.id){if(!r||r.length<t())for(var i=function(e){r.push(Zo(0,function(){return[n()[0]*(e+1),n()[1]*(e+1),n()[2]*(e+1)]}))},o=(r=[]).length;o<t();o++)i(o);return[r.map(function(e){return e([a])})]}}};Object(Ea.a)("gl.sdfCubeLayout",{sdf:"",count:"",offset:""},"Takes an SDF and creates copies of it in a cube formantion",function(){return 1},{altName:"sdf.cubeLayout",isHot:!0,inlets:3});var es=function(e,t,n){Object(j.uuid)();var r=void 0,a=[];return function(e){var i=Object(Hr.a)(e,1)[0],o=n(),s=t();if(o&&i&&i.id){r||(r=[]);for(var c=0,u=[],l=[],f=function(e){for(var t=[],n=function(n){for(var i=[],u=function(t){if(0===e&&0===n&&0===t)return i.push(void 0),"continue";var s=[o*e,o*n,-o*t];i.push(s),l[c]=function(){return a[n][e][t]},r[c]||(r[c]=Zo(0,function(){return a[n][e][t]})),c++},f=0;f<s;f++)u(f);t.push(i)},i=0;i<s;i++)n(i);u.push(t)},p=0;p<s;p++)f(p);a=u;var d=r.map(function(e){return e([i])});return[[i].concat(Object(h.a)(d))]}}};Object(Ea.a)("gl.fog",{distance:"",amount:""},"Creates fog",function(){return 1},{inlets:2});function ts(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ns(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ns(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ns(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(Ea.a)("gl.directionalLighting",{Data:"",lightPosition:"vec3",lightAttentuation:"float",lightColor:"vec4",shininess:"float",fresnel:"vec3",diffuse:"float",specular:"float",ambient:"vec3",shadow:"float"},"Calculates how much lighting should occur at a given ray end point",function(){return 1},{isHot:!0,connects:[{outlet:"Output 1",object:"gl.fragColor",inlet:"Input"}],inlets:10});var rs={"gl.directionalLighting":function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=Object(j.uuid)().replaceAll("-",""),i="directionalLighting_"+a.slice(0,4),o=function(){var e=[],t=function(t,n,r){if(void 0===t)return r;if(!isNaN(t)||Array.isArray(t)){if(!e[n]){var a=Object(j.uuid)().replaceAll("-",""),i=Ya({},function(){return"arg_"+n+a});e[n]=i}return e[n]([t],!0)}return t};return function(e){return(e=Object(h.a)(e).map(function(e){return void 0===e||isNaN(e)&&0===Object.keys(e).length?void 0:e}).slice(0,9))[0]=t(e[0],0,"vec3(0.5, 0.8, 1.0)"),e[1]=t(e[1],1,"1.0"),e[2]=t(e[2],2,"vec4(0.9, 0.8, 1.0, 1.0)"),e[3]=t(e[3],3,"1.0"),e[4]=t(e[4],4,"vec3(0.5, 0.8, 1.0)"),e[5]=t(e[5],5,.8),e[6]=t(e[6],6,.8),e[7]=t(e[7],7,"vec4(0.3, 0.1, 0.2, 1.0)"),e[8]=t(e[8],8,"1.0"),e}}();return function(e){var t=Object(Hr.a)(e,1)[0],r=t.scene,s=Wa.a.apply(void 0,[t.scene,t.occlusion,t.rayOrigin,t.rayDirection,t.rayMarchedDistance,t.normal].concat(n)),c=s.codes,u=s.variables,l=s.uniforms,f=s.functions;c=[].concat(Object(h.a)(c.slice(0,6)),Object(h.a)(o(c.slice(6)))),l=Object(p.a)({},l,function(e){var t,n={},r=ts(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.uniforms&&(n=Object(p.a)({},n,a.uniforms))}}catch(i){r.e(i)}finally{r.f()}return n}(c)),c=c.map(function(e){return e.code?e.code:e});var d=t.rayMarchedDistance;l=Object(p.a)({},d.uniforms,l),f=Object(p.a)({},d.functions,f),u=Object(p.a)({},d.variables,u),f.calculateTransmittance={args:{ro:"vec3",rd:"vec3",tmin:"float",tmax:"float",atten:"float"},returnType:"vec3",body:"\n     const int MAX_DEPTH = 4;\n    float hitPoints[MAX_DEPTH];\n    int depth = 0;\n    \n    for (float t = tmin; t < tmax;)\n    {\n        float h = abs(".concat(r.code("ro + t * rd"),".x);\n        if (h < 1e-5) { hitPoints[depth++] = t; t += 0.01; };\n        if (depth >= MAX_DEPTH) break;\n        t += h;\n    }\n    \n    float thickness = 0.0;\n    for (int i = 0; i < depth - 1; i += 2) thickness += hitPoints[i+1] - hitPoints[i];\n    \n    return vec3(1.0) * exp(-atten * thickness * thickness);\n")};var m="softShadow"+a;return f[m]={args:{ro:"vec3",rd:"vec3",mint:"float",tmax:"float",k:"float"},returnType:"float",body:"\n         float res = 1.0;\n        float t = mint;\n\n        for( int i = 0; i < ".concat(4,"; i++ ) {\n          float h = ").concat(r.code("ro + rd * t"),".x;\n          res = min( res, k * h / t );\n          t += clamp( h, 0.02, 0.10 );\n          if( h<0.001 || t>tmax ) break;\n        }\n\n        return clamp( res, 0.0, 1.0 );\n")},f[i]={args:{occlusion:"float",rayOrigin:"vec3",rayDirection:"vec3",distance:"float",normal:"vec3",lightPosition:"vec3",lightAttenuation:"float",lightColorRaw:"vec4",shininess:"float",fresnel:"vec3",diffuse:"float",specular:"float",ambientRaw:"vec4",shadow:"float"},returnType:"vec4",body:"\n  vec3 lightColor = vec3(lightColorRaw.x, lightColorRaw.y, lightColorRaw.z);\n  vec3 ambient = vec3(ambientRaw.x, ambientRaw.y, ambientRaw.z);\n  vec3 surfacePosition = rayOrigin + rayDirection*distance;\n  vec3  outputColor   = vec3( 0. );\n  vec3 surfaceToLightDirection = normalize( lightPosition - surfacePosition );\n  vec3 lightDir = normalize(vec3(1.0, .5, -1.0));\n\n// todo: figure out translucency correctly opacity\n/*\n  float t = 0.8;\n  lightColor = t * lightColor * calculateTransmittance(surfacePosition+normal*vec3(0.01), lightDir, 0.01, 10.0, 2.0*lightAttenuation);\n  lightColor += (1.0 - t) * calculateTransmittance(surfacePosition+normal*vec3(0.01), rayDirection, 0.01, 10.0, 0.5*lightAttenuation);\n*/\n\n  // get similarity between normal and direction to light\n  float diffuseCoefficient = dot( normal, surfaceToLightDirection ); \n  // get reflection angle for light striking surface\n  vec3 angleOfReflection = reflect( -surfaceToLightDirection, normal );\n  // see if reflected light travels to camera and generate coefficient accordingly\n  float specularAngle = clamp( dot( angleOfReflection, -rayDirection ), 0., 1. );\n  float specularCoefficient = pow( specularAngle, shininess );\n  // lights should have an attenuation factor\n  float attenuation = 1. / ( lightAttenuation * pow( length( lightPosition - surfacePosition ), 2. ) ); \n  // bias, scale, power\n  float _fresnel = fresnel.x + fresnel.y * pow( 1.0 + dot( rayDirection, normal ), fresnel.z ); \n  // shadow was here\n  diffuseCoefficient *= ".concat(m,"( surfacePosition, normalize( lightPosition ), 0.02, 2.5, shadow);\n  vec3 color = vec3( 0. );\n  color += 1.2 * diffuseCoefficient * diffuse * lightColor;\n  color += 2.2 * specularCoefficient * specular * lightColor;\n  color += 0.3 * (ambient * lightColor) * occlusion;\n  color += (_fresnel * lightColor);\n  // texture\n  // gamma correction must occur before light attenuation\n  // which means it must be applied on a per-light basis unfortunately\n  vec3 gammaCorrectedColor = pow( color, vec3( 1./2.2 ) );\n  vec3 attenuatedColor = 2. * gammaCorrectedColor * attenuation; \n  outputColor += attenuatedColor;\n  return vec4(outputColor.x, outputColor.y, outputColor.z, 1.0);\n")},{code:"".concat(i,"(\n\t").concat(c.slice(1).join(",\n\t"),")"),functions:f,uniforms:l,variables:u}}}};Object(Ea.a)("gl.+",{x:"x",y:"y"},"Creates GLSL expression for addition",function(){return 1},{tags:"GLSL",isHot:!0,inlets:2});var as=function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(".concat(Object(Wa.b)(r[0]),") + (").concat(Object(Wa.b)(r[1]),")")},t)};Object(Ea.a)("gl.-",{x:"x",y:"y"},"Creates GLSL expression for subtraction",function(){return 1},{tags:"GLSL",isHot:!0,inlets:2});Object(Ea.a)("gl.*",{x:"",y:""},"Creates GLSL expression for multiplication",function(){return 1},{tags:"GLSL",isHot:!0,inlets:2});var is=function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(".concat(Object(Wa.b)(r[0]),") * (").concat(Object(Wa.b)(r[1]),")")},t)};Object(Ea.a)("gl./",{},"Fuck",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("gl.dot",{x:"x",y:"y"},"Creates GLSL expression for dot product of vectors",function(){return 1},{tags:"GLSL",isHot:!0,inlets:2});Object(Ea.a)("gl.resolution",{},"Creates GLSL expression for the resolution vec2",function(){return 1},{inlets:0,tags:"GLSL"});Object(Ea.a)("gl.xy",{},"Creates GLSL expression for the current pixel/'s x & y coordinates as a vec2",function(){return 1},{inlets:0,tags:"GLSL"});Object(Ea.a)("gl.bad_uv",{},"Creates GLSL expression for the current pixel/'s x & y coordinates as a vec2",function(){return 1},{inlets:0,tags:"GLSL"});Object(Ea.a)("gl.uv",{},"Creates GLSL expression for the current pixel/'s x & y coordinates as a vec2",function(){return 1},{inlets:0,tags:"GLSL"});Object(Ea.a)("gl.x",{},"Creates GLSL expression for the current pixel/'s x-coordinate",function(){return 1},{inlets:0,tags:"GLSL"});Object(Ea.a)("gl.y",{},"Creates an GLSL expression for the current pixel/'s y-coordinate",function(){return 1},{inlets:0,tags:"GLSL"});Object(Ea.a)("gl.fragColor",{"color (vec4)":""},"Outputs the GLSL vec4 in the inlet to the shader. Represents the final output for the shader",function(){return 1},{inlets:1,tags:"GLSL",connects:{object:"gl.material"}});Object(Ea.a)("gl.width",{},"Creates GLSL expression for the canvas/'s width",function(){return 1},{tags:"GLSL",isHot:!0,inlets:0});Object(Ea.a)("gl.height",{},"Creates GLSL expression for the canvas/'s height",function(){return 1},{tags:"GLSL",isHot:!0,inlets:0});var os=Object(p.a)({"gl.uniform":Ya,"gl.variable":Za,"gl.fragColor":function(e){return e.needsHotReload=!0,function(t){var n=Object(Hr.a)(t,1)[0],r=n.code||n,a=(n.uniforms,n.variables),i=n.functions;return e.flash(),Object($a.a)("gl_FragColor = "+r+";",n.uniforms,a,i)}},"gl.x":function(e){e.needsLoad=!0,e.needsHotReload=!0;var t={code:"gl_FragCoord.x",hashCode:"gl_FragCoord.x",variables:{},uniforms:{}};return function(){return t}},"gl.y":function(e){e.needsLoad=!0,e.needsHotReload=!0;var t={code:"gl_FragCoord.y",hashCode:Object(Ka.a)("gl_FragCoord.y"),variables:{},uniforms:{}};return function(){return e.flash(),t}},"gl.+":as,"gl.-":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(".concat(Object(Wa.b)(r[0]),") - (").concat(Object(Wa.b)(r[1]),")")},t)},"gl.*":is,"gl./":function(e,t){return e.needsHotReload=!0,e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(".concat(Object(Wa.b)(r[0]),") / (").concat(Object(Wa.b)(r[1]),")")},t)},"gl.dot":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(dot((".concat(Object(Wa.b)(r[0]),"), (").concat(Object(Wa.b)(r[1]),")))")},t)},"gl.xy":function(e){e.needsLoad=!0,e.needsHotReload=!0;var t={code:"gl_FragCoord.xy",hashCode:"gl_FragCoord.xy",variables:{},uniforms:{}};return function(){return t}},"gl.resolution":function(e){e.needsLoad=!0,e.needsHotReload=!0;var t={code:"vec2(width, height)",hashCode:"vec2(width, height)",variables:{},uniforms:{}};return function(){return t}},"gl.width":function(e){e.needsLoad=!0,e.needsHotReload=!0;var t={code:"width",hashCode:"width"};return function(n){return Object(Hr.a)(n,1)[0],e.flash(),t}},"gl.height":function(e){e.needsLoad=!0,e.needsHotReload=!0;var t={code:"height",hashCode:Object(Ka.a)("height")};return function(n){return Object(Hr.a)(n,1)[0],e.flash(),t}},"gl.texture2D":function(e,t){return e.needsHotReload=!0,Object(Xa.a)(function(n){var r=Object(Qa.a)(n,t);return e.flash(),"(texture2D((".concat(Object(Wa.b)(r[0]),"), (").concat(Object(Wa.b)(r[1]),")))")},t)}},Wa.c,Yo,co,ni,Jo,Uo,{"gl.unpack":function(e){e.needsHotReload=!0;return function(e){var t=Object(Hr.a)(e,1)[0],n=t.uniforms,r=t.functions,a=t.variables,i=t.closure,o=Object(Qa.a)(t),s={uniforms:n,variables:a,closure:i,functions:r};return[Object(p.a)({},s,{code:"(".concat(Object(Wa.b)(o[0]),".r)")}),Object(p.a)({},s,{code:"(".concat(Object(Wa.b)(o[0]),".g)")}),Object(p.a)({},s,{code:"(".concat(Object(Wa.b)(o[0]),".b)")}),Object(p.a)({},s,{code:"(".concat(Object(Wa.b)(o[0]),".a)")})]}},"gl.bad_uv":function(e){e.needsLoad=!0,e.needsHotReload=!0;var t={code:"bad_uv",hashCode:Object(Ka.a)("(1.0*gl_FragCoord.xy-vec2(width, height))/height"),variables:{bad_uv:{code:"(1.0*gl_FragCoord.xy-vec2(width, height))/height",type:"vec2"}},uniforms:{}};return function(){return t}}},Fo,{"gl.sdfManager":zo,"sdf.manager":zo,"gl.sdfBuilder":Ho,"sdf.builder":Ho,"gl.rayMarchingManager":Vo,"raymarching.manager":Vo,"gl.mat3":function(e,t,n){return Object(Xa.a)(function(r){var a=Object(Qa.a)(r,t,n);return e.flash(),"mat3(".concat(Object(Wa.b)(a[0]),", ").concat(Object(Wa.b)(a[1]),", ").concat(Object(Wa.b)(a[2]),")")},t,n)},"gl.sdfCopy":Zo,"sdf.copy":Zo,"gl.sdfMultiCopies":$o,"sdf.multiCopies":$o,"gl.sdfCubeLayout":es,"sdf.cubeLayout":es,"gl.uv":function(e){e.needsLoad=!0,e.needsHotReload=!0;var t={code:"uv_b",hashCode:Object(Ka.a)("((1.0*gl_FragCoord.xy-vec2(width, height))/vec(width, height))"),variables:{uv_b:{code:"((1.0*gl_FragCoord.xy-vec2(width, height))/vec2(width, height))",type:"vec2"}},uniforms:{}};return function(){return t}}},no,to,{"gl.fog":function(e,t){return Object(Xa.a)(function(e){var n=Object(Qa.a)(e,t);return"1. - exp( -".concat(Object(Wa.b)(n[0])," * ").concat(Object(Wa.b)(n[1]),")")},t)}},rs,Zi);function ss(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return cs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cs(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function cs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(Ea.a)("uniqueAppend",{value:"",limit:""},"Appends but keeping indices of elements w same id ",function(){return 1},{inlets:2,connects:[{outlet:"Output 1",object:"sdf.manager",inlet:"SDF List"}]});function us(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ls=function(e){Object(u.a)(n,e);var t=us(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return n}(xa);function fs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var hs=function(e){Object(u.a)(n,e);var t=fs(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newOutlet("playing"),r.newOutlet("stepNumber offset"),r.newOutlet("current stepNumber"),e.sequencerEngine.mixButtons.push(Object(c.a)(r)),r.newInlet("pause vs stop",function(e){var t=Object(Hr.a)(e,1)[0];return r.onPauseOrStop(t)}),r.newInlet("toggle play/stop",function(e){var t=Object(Hr.a)(e,1)[0];return r.onToggle(t)}),r.newInlet("stop",function(e){Object(Hr.a)(e,1)[0];return r.onStop()}),r}return Object(s.a)(n,[{key:"onToggle",value:function(e){this.sequencerEngine.schedulePlay()}},{key:"onStop",value:function(){this.sequencerEngine.stop(),this.sequencerEngine.seekToTrackStep(0),this.sequencerEngine.dispatch(Object(C.Zd)(void 0)),this.sequencerEngine.dispatch(Object(C.J)(void 0)),this.sequencerEngine.dispatch(Object(C.F)(0))}},{key:"sendCurrentStepNumber",value:function(e){this.sendMessage("current stepNumber",e)}},{key:"onPauseOrStop",value:function(e){this.pauseOrStop=e}},{key:"handleStop",value:function(){if(this.pauseOrStop){var e=this.sequencerEngine.lastTrackStep||0;e+=this.sequencerEngine.stepNumberOffset||0,this.sequencerEngine.stepNumberOffset=e,this.sendMessage("stepNumber offset",e)}}}]),n}(xa);Object(Ea.a)("submix",{},"Mix between sub-sequences");Object(Ea.a)("mixbuttons",{},"Buttons to start/stop/record",function(){return 0},{inlets:0});function ps(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ds=function(e){Object(u.a)(n,e);var t=ps(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet("roll",function(e){var t=Object(Hr.a)(e,1)[0];return r.onRoll(t)}),r.newInlet("triplet roll",function(e){var t=Object(Hr.a)(e,1)[0];return r.onRoll(t,!0)}),r.newInlet("enable roll-viewer",function(e){var t=Object(Hr.a)(e,1)[0];return r.enableRollViewer(t)}),r}return Object(s.a)(n,[{key:"enableRollViewer",value:function(e){e=!!e,this.zObject.dispatch(Object(C.cc)(e))}},{key:"onRoll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<=0)this.sequencerEngine.sequenceRolling=!1,this.sequencerEngine.trackRolling=!1;else{var n=new br.a(e,t);this.sequencerEngine.resolution=n,this.sequencerEngine.sequenceRolling=!0,this.sequencerEngine.trackRolling=!0}}}]),n}(xa);Object(Ea.a)("roll",{},"Roller",function(){return 0},{inlets:0});function ms(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var vs=function(e){Object(u.a)(n,e);var t=ms(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet("Speed",function(e){var t=Object(Hr.a)(e,1)[0];return r.onSpeed(t)}),r.newInlet("Density",function(e){var t=Object(Hr.a)(e,1)[0];return r.onDensity(t)}),r.newOutlet("Density "),r.newOutlet("Speed "),r.playhead.system5Objects.push(Object(c.a)(r)),r.densityEffect.system5Objects.push(Object(c.a)(r)),r}return Object(s.a)(n,[{key:"sendSpeeds",value:function(){this.sendMessage("Speed ",this.playhead.speedFactorParameter.get())}},{key:"sendDensities",value:function(){this.sendMessage("Density ",this.densityEffect.densityParameter.get())}},{key:"playhead",get:function(){return this.getRoot().playhead}},{key:"densityEffect",get:function(){return this.getRoot().midiEffects.shadowEffects[0]}},{key:"getRoot",value:function(){for(var e=this.subSequence;!e.tracks;)e=e.subSequence;return e}},{key:"onSpeed",value:function(e){this.playhead.speedFactorParameter.set(e)}},{key:"onDensity",value:function(e){this.getRoot().midiEffects.shadowEffects[0].densityParameter.set(e)}}]),n}(xa);Object(Ea.a)("system5",{},"Some system level controls over the subsequence");function bs(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return gs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gs(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function gs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ys(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ks=function(e){Object(u.a)(n,e);var t=ys(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).samples=[],r.newInlet("send sample",function(e){var t=Object(Hr.a)(e,1)[0];return r.sendSample(t)}),r.newOutlet("sample"),r.lastSampleSent=void 0,r}return Object(s.a)(n,[{key:"deleteSample",value:function(e){this.samples=this.samples.filter(function(t){return t!==e})}},{key:"sendSample",value:function(e){("number"!==typeof e||(e=this.samples[e%this.samples.length]))&&(this.sendMessage("sample",e),this.lastSampleSent=e)}},{key:"addSample",value:function(e){this.samples.includes(e)||(this.samples=[].concat(Object(h.a)(this.samples),[e]))}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{samples:this.samples.map(function(e){return e.getId()})})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.fetchSamples(e.samples)}},{key:"fetchSamples",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=bs(t),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=11;break}return i=r.value,o=new R.a(i),e.next=8,o.load(!1);case 8:this.addSample(o);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:case"end":return e.stop()}},e,this,[[1,13,16,19]])}));return function(t){return e.apply(this,arguments)}}()}]),n}(xa);Object(Ea.a)("sampleBank",{},"Store samples and send them to tracks",function(){return 0},{inlets:0});function Os(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var js=function(e){Object(u.a)(n,e);var t=Os(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return n}(xa);Object(Ea.a)("ztracker",{},"A tracker for showing/editing a pattern like in the 90s");var ws=n(273);Object(Ea.a)("tidal",{},"A tidal sequencer that sends triggers out",void 0,{});Object(Ea.a)("outputNumber",{n:"Slot number to send output"},"Sends triggers to specific slot in the pad (1-9)",void 0,{inlets:2});Object(Ea.a)("matrix",{},"Creates a 2D array",void 0,{operations:{set:{params:["x","y","value"],description:"Sets value at x, y position"}}});function Es(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ss=function(e){Object(u.a)(n,e);var t=Es(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).value=0,r.newInlet("input",function(e){var t=Object(Hr.a)(e,1)[0];return r.onInput(t)}),r.newOutlet("output"),r}return Object(s.a)(n,[{key:"onInput",value:function(e){"start"!==e?"bang"===e?this.toggle():0!==e&&1!==e||(this.value=e,this.sendMessage("output",this.value)):this.sendMessage("output",this.value)}},{key:"toggle",value:function(){return this.value=0===this.value?1:0,this.sendMessage("output",this.value),this.value}},{key:"getJson",value:function(e){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this,e),{value:this.value,needsLoad:!0})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.value=e.value,e.needsLoad?(this.zObject.needsLoad=!0,console.log("TOGGLE NEEDS LOAD = ",!0)):(this.zObject.needsLoad=!1,console.log("TOGGLE NEEDS LOAD = ",!1))}}]),n}(xa);Object(Ea.a)("toggle",{},"Toggles 0/1 when clicked",function(){return 0},{inlets:0});Object(Ea.a)("messageSplitter",{},"Splits multi-part message, sending out from each outlet",function(e){return e});Object(Ea.a)("messageFilter",{condition:""},"Lets messages pass through when condition is met.",void 0,{isHot:!0,inlets:2});Object(Ea.a)("messageFilterLazy",{condition:""},"Lets messages pass through when condition is met.",void 0,{inlets:2});Object(Ea.a)("dedupe",{},"only pass if different");Object(Ea.a)("record.messages",{messages:""},"Records incoming messages starting from when the record is engaged");Object(Ea.a)("play.messages",{messages:""},"Plays output of record.messages starting from when the play is engaged");var Ps={"play.messages":function(e){e.needsTick=!0;var t,n=[],r=[],a=!1,i=void 0,o=void 0,s=function(){a=!0,o=0,r=Object(h.a)(n),t=r.shift()};return function(c){var u=Object(oi.a)(c),l=u[0];switch(u.slice(1),l){case Xe.l:return;case 1:return void(a||s());case 0:return void(a=!1);case"play":return void s();case"stop":return void(a=!1);case Xe.o:if(i=e.sequencerEngine.trackStep,a&&t){var f=i-o;if(t[0]<=f){var h=t;return t=r.shift(),[h[1]]}}return;default:n=l}}},"record.messages":function(e){var t;e.needsTick=!0;var n=[],r=0;return function(a){var i=Object(oi.a)(a),o=i[0],s=i.slice(1);switch(o){case Xe.l:return;case Xe.o:return Object(Hr.a)(s,1)[0],void(t=e.sequencerEngine.trackStep);default:n.push([t-r,o])}return[n]}}};function xs(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ts(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ts(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ns=function(e){Object(u.a)(n,e);var t=Cs(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).snapshots=[],r.newInlet("cursor",function(e){var t=Object(Hr.a)(e,2),n=t[0],a=t[1];return r.cursor=[n,a]}),r.newInlet(Xe.p,function(e){var t=Object(Hr.a)(e,1)[0];r.tidals=t}),r.newInlet("take snapshot",function(e){return r.takeSnapshot(e)}),r.newInlet("use snapshot",function(e){var t=Object(Hr.a)(e,1)[0];return r.useSnapshot(t)}),r.newOutlet("cursor"),r}return Object(s.a)(n,[{key:"takeSnapshot",value:function(){if(this.tidals&&this.cursor){var e,t=[],n=xs(this.tidals);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=r.cycle,i=r.cycleLength;t.push([a,i])}}catch(o){n.e(o)}finally{n.f()}this.snapshots=[].concat(Object(h.a)(this.snapshots),[{tidals:t,cursor:this.cursor}])}}},{key:"useSnapshot",value:function(e){var t=this.snapshots[e];t&&this.sendMessage.apply(this,["cursor"].concat(Object(h.a)(t.cursor)))}}]),n}(xa);Object(Ea.a)("jsnapshot",{},"Takes snapshots of the jaki object parameters to be recalled and sequenced",function(){return 0},{inlets:0});function Rs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ms=function(e){Object(u.a)(n,e);var t=Rs(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newOutlet("up"),r.newOutlet("down"),r.newOutlet("right"),r.newOutlet("left"),r.newOutlet("A"),r.newOutlet("B"),r}return n}(xa);Object(Ea.a)("dpad",{},"A d-pad interface for controlling via bangs",function(){return 0},{inlets:0});function As(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var qs=function(e){Object(u.a)(n,e);var t=As(n);function n(e){var r;return Object(o.a)(this,n),r=t.call(this,e),e.setAttribute("primary-color","#cdcdcd"),e.setAttribute("secondary-color","#b4b4b4"),r}return n}(xa);Object(Ea.a)("cirklon",{},"Cirklon sequencer interface",function(){return 0},{inlets:0});function Ds(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Is=function(e){Object(u.a)(n,e);var t=Ds(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet("pattern switch",function(e){return r.patternSwitch([e])}),r.newOutlet("pattern switched"),r}return Object(s.a)(n,[{key:"patternSwitch",value:function(e){var t=this.zObject;e=Math.round(e);for(var n=t.subSequence;;){var r=t.subSequence;if(!r.zObject){n=t.subSequence;break}t=r.zObject}this.sequencerEngine.switchToPattern(e-1,!0,n)}}]),n}(xa);Object(Ea.a)("patterns",{},"Patterns manager",function(){return 0},{tags:"Sequencer",inlets:0});function _s(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Fs=function(e){Object(u.a)(n,e);var t=_s(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet(Xe.p,function(e){return r.tidals=e[0]}),r.newInlet("toggle lock",function(e){return r.lock(e[0])}),r}return Object(s.a)(n,[{key:"lock",value:function(e){this.tidals[e]&&this.tidals[e].lockGroove(!this.tidals[e].cycleParameter.immutable)}}]),n}(xa);Object(Ea.a)("jrepl",{},"Analyze & control underlying tidal patterns in a jaki object",function(){return 0},{inlets:0});var Ls=n(316),Bs=n(312),zs=n(276);function Vs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Hs=function(e){Object(u.a)(n,e);var t=Vs(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e,!1)).store=e.sequencerEngine.store,r.track=e,r.parameters=[],r.loaded=!0,r.valueParameter=new $.a("value",Object(c.a)(r),function(e,t,n,a){return r.onValue(t,a)},{defaultValue:0}),r.setupRampParameters(),e.effect=Object(c.a)(r),r.value=0,r.context=(new L.a).forZObject(Object(c.a)(r)),r.newInlet("value",function(e){var t=Object(Hr.a)(e,1)[0];return r.setValue(t)}),r.newInlet("map parameter",function(e){var t=Object(Hr.a)(e,1)[0];return r.onMapParameter(t)}),r.newOutlet("value changed"),r.newOutlet("map parameter "),r}return Object(s.a)(n,[{key:"onMapParameter",value:function(e){if(e.audioParam||Array.isArray(e)){var t,n;if(e.audioParam)"depth"===(t=e).name&&t.set(0),n=100;else{var r=Object(Hr.a)(e,3),a=r[0],i=r[1];if(n=r[2],!i||!a)return;t=a.parameters.find(function(e){return e.name.toLowerCase().includes(i.toLowerCase())})}t&&(this._parameters.includes(t)||this.lostParameters&&this.lostParameters.find&&this.lostParameters.find(function(e){return e.id===t.id})||this.setParameter(t),this.depthParameters[this._parameters.length-1]&&this.depthParameters[this._parameters.length-1].set(n||1))}}},{key:"getJson",value:function(){return Object(p.a)({},this.getMappableJson(),{id:this.id,value:this.value})}},{key:"fromJson",value:function(e){this.loaded=!1,this.id=e.id,this.sequencerEngine.idToObject[this.id]=this,e.value&&(this.value=e.value),Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e),this.loaded=!0}},{key:"sortParameters",value:function(){}},{key:"min",get:function(){return 0}},{key:"max",get:function(){return 1}},{key:"value",get:function(){return this.valueParameter.get()},set:function(e){this.valueParameter.set(e)}},{key:"setValue",value:function(e){this.valueParameter.set(e,!1)}},{key:"onValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.value,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H.a.Master.context.currentTime;if(this.loaded&&e!==this.lastValue){this.sequencerEngine.dispatch(Object(C.Ub)(this.id,e));for(var n={},r=0;r<this._parameters.length;r++){var a=this._parameters[r],i=a.max,o=a.min,s=this.getDepth(r),c=this.initialParameterValues[r],u=s<0?c-o:i-c,l=c+e*(this.getDepth(r)/100)*u,f=a.set(Math.min(i,Math.max(o,l)),!0,!0,t,this.rampTime/1e3),h=f.id,p=f.value;n[h]=p}this.lastValue=e,this.sequencerEngine.dispatch(Object(C.Vb)(n)),this.sendMessage("value changed",e)}}}]),n}(Object(Bs.a)(Object(zs.a)(Object(Ls.a)(xa))));Object(Ea.a)("macro",{name:""},"Map several parameters to a macro object to control",function(){return 0},{inlets:0});var Us=n(380),Js=Object(Us.a)();function Gs(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ws(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ws(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Ws(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ks(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Xs=function(e){Object(u.a)(n,e);var t=Ks(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newOutlet("script"),r.code="",r.logs=[],r.storedMatches=[],r}return Object(s.a)(n,[{key:"clearErrors",value:function(e){this.syntaxErrors=void 0}},{key:"onNewErrors",value:function(e){var t=e[0];if(!(t.length<7)){var n=t[6].split("\n"),r=t[7].split("\n"),a=this.checkCode(n,!0),i=this.checkCode(r);this.syntaxErrors=a||i}}},{key:"checkCode",value:function(e,t){var n,r=0,a=-1,i=-1,o=this.code.split("\n").filter(function(e){return""!==e}),s=Gs(e);try{for(s.s();!(n=s.n()).done;){var c=n.value;c.includes(o[0])&&(i=r),c.includes("1: #version 300 es")&&(a=r),c.includes("equirectUv")&&(i=r+6),t&&c.startsWith("57:")&&(i=r+1),r++}}catch(h){s.e(h)}finally{s.f()}var u,l=[],f=Gs(e.slice(1,a));try{for(f.s();!(u=f.n()).done;){var h=u.value;if(!h.includes("#version")){var p=h.split(" ")[1].split(":")[1],d=parseFloat(p)-i;d+=t?1:2,l.push({lineNumber:d,errorMessage:h.slice(h.indexOf(p)+p.length)})}}}catch(h){f.e(h)}finally{f.f()}var m=e.slice(i).map(function(e){return e.slice(e.indexOf(":")+2)}),v=this.parsedCode||this.code;if(1!==m.length)return m.every(function(e){return v.includes(e)})?l:void 0}},{key:"getJson",value:function(e){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this,e),{code:this.code})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.code=e.code}},{key:"doc",get:function(){return Js}},{key:"eval",value:function(e){this.code=e}},{key:"hasSyntaxError",value:function(e){return!1}},{key:"code",get:function(){return this._script},set:function(e){this._script=e,e=this.parseScript(e),this.sendMessage("script",e)}},{key:"parsedCode",get:function(){this.parseScript(this._script)}},{key:"parseScript",value:function(e){var t=this;if(e){var n=e.match(/@[a-z]*/g);if(!n)return e;var r,a=Gs(n);try{var i=function(){var n=r.value,a=n.slice(1);t.inlets[a]||t.newInlet(a,function(e){var n=Object(Hr.a)(e,1)[0];t.storedMatches[a]=n,t.eval(t.code)}),e=e.replaceAll(n,t.storedMatches[a]||"")};for(a.s();!(r=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return e}}}]),n}(xa);Object(Ea.a)("script",{},"Write script to control some other object that uses scripting",function(){return 0},{tags:"Scripting",inlets:0});Object(Ea.a)("envelope.attack",{number:""},"Triggers envelope specified by nnumber",function(){return 0});Object(Ea.a)("envelope.release",{number:""},"Triggers envelope specified by nnumber",function(){return 0});var Qs={"envelope.attack":function(e,t){return function(){for(var n=e.subSequence;!n.tracks&&n.subSequence;)n=n.subSequence;n.envelopesTrack.envelopes[t()||0].envelope.triggerAttack()}},"envelope.release":function(e,t){return function(){for(var n=e.subSequence;!n.tracks&&n.subSequence;)n=n.subSequence;n.envelopesTrack.envelopes[t()||0].envelope.triggerRelease()}}},Ys=n(454);Object(Ea.a)("key.shortcut",{bang:"",key:""},"Listens for key press events and triggers a bang when they occur",void 0,{tags:"Keyboard",isHot:!0,inlets:2});Object(Ea.a)("key.down",{bang:"",key:""},"Listens for key press events and triggers a bang when they occur",void 0,{tags:"Keyboard",isHot:!0,inlets:2});Object(Ea.a)("key.up",{bang:"",key:""},"Listens for key up events and triggers a bang when they occur",void 0,{tags:"Keyboard",isHot:!0,inlets:2});var Zs={"key.shortcut":function(e,t){var n=void 0;e.needsLoad=!0;var r=function(t){if(!Object(Ys.a)(t)&&t.key===n){if(e.sequencerEngine.isAnyTrackEnabled())return;e.sendMessage(e.outputByNumber(0),"bang")}};return window.addEventListener("keydown",r),function(a){var i=t();if("dispose"===a[0])return n&&e.sequencerEngine.keyListener&&e.sequencerEngine.keyListener.removeBinding(n),void window.removeEventListener("keydown",r);n&&i!==n&&e.sequencerEngine.keyListener&&e.sequencerEngine.keyListener.removeBinding(n),i&&i!==n&&e.sequencerEngine.keyListener&&e.sequencerEngine.keyListener.addBinding(i),n=i}},"key.up":function(e,t){var n=void 0;e.needsLoad=!0;var r=function(t){if(!Object(Ys.a)(t)&&t.key===n){if(e.sequencerEngine.isAnyTrackEnabled())return;e.sendMessage(e.outputByNumber(0),"bang")}};return window.addEventListener("keyup",r),function(a){var i=t();if("dispose"===a[0])return n&&e.sequencerEngine.keyListener&&e.sequencerEngine.keyListener.removeBinding(n),void window.removeEventListener("keyup",r);n&&i!==n&&e.sequencerEngine.keyListener&&e.sequencerEngine.keyListener.removeBinding(n),i&&i!==n&&e.sequencerEngine.keyListener&&e.sequencerEngine.keyListener.addBinding(i),n=i}},"key.down":function(e,t){var n=void 0;e.needsLoad=!0;var r=function(t){if(!Object(Ys.a)(t)&&t.key===n){if(e.sequencerEngine.isAnyTrackEnabled())return;e.sendMessage(e.outputByNumber(0),"bang")}};return window.addEventListener("keydown",r),function(a){var i=t();if("dispose"===a[0])return n&&e.sequencerEngine.keyListener&&e.sequencerEngine.keyListener.removeBinding&&e.sequencerEngine.keyListener.removeBinding(n),void window.removeEventListener("keydown",r);n&&i!==n&&e.sequencerEngine.keyListener&&e.sequencerEngine.keyListener.removeBinding(n),i&&i!==n&&e.sequencerEngine.keyListener&&e.sequencerEngine.keyListener.addBinding(i),n=i}}};Object(Ea.a)("store",{bang:"","stored message":""},"Stores a message until it receives a bang, which triggers it to send that stored message",void 0,{tags:"Messages",inlets:2});var $s=n(239),ec=(n(154),n(554));function tc(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return nc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nc(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function nc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(Ea.a)("centroid",{pts:""},"Centoid of ist of poinnts");var rc=function(){return function(e){for(var t=Object(Hr.a)(e,1)[0],n=0,r=0,a=0;a<t.length;a+=2)n+=t[a],r+=t[a];return[[n/(t.length/2),r/(t.length/2)]]}};Object(Ea.a)("dHull",{pts:"",length:""},"computes hull for pts index",void 0,{inlets:2,isHot:!0,tags:"Graphics"});var ac=function(e,t,n){return e<n&&n<t||e>n&&n>t},ic=function(e,t,n,r,a){if(1===e.length)return 0;for(var i=e.length,o=[],s=0;s<i;s++){var c=s,u=(s+1)%i;lc(n[2*c],n[2*c+1],n[2*u],n[2*u+1])<20||(ac(e[c],e[u],t)||s===i-1&&ac(e[c],2*Math.PI-e[u],t))&&o.push(c)}for(var l=1e5,f=void 0,h=0,p=o;h<p.length;h++){var d=p[h],m=d,v=(d+1)%i,b=(lc(n[2*m],n[2*m+1],r,a)+lc(n[2*v],n[2*v+1],r,a))/2;0===v&&(b*=1.7),b>140||b<l&&(l=b,f=v)}return f},oc=function(e,t,n){for(var r=0,a=0;a<e.length;a+=2){var i=a/2;t.includes(i)||(n[r++]=e[a],n[r++]=e[a+1])}};function sc(e,t,n){for(var r=arguments.length,a=new Array(r>3?r-3:0),i=3;i<r;i++)a[i-3]=arguments[i];return 1===arguments.length?e:(t=Math.max(t,0),n=Math.max(n,0),a=a||[],e.set(e.subarray(t+n,e.length-a.length),t+a.length),e.set(a,t),e)}var cc=function(e,t,n,r){r.sort(function(r,a){return uc(e,t,r,n)-uc(e,t,a,n)})},uc=function(e,t,n,r){var a,i=1e5,o=t[2*n],s=t[2*n+1],c=tc(r);try{for(c.s();!(a=c.n()).done;){var u=a.value,l=e[2*u],f=e[2*u+1],h=lc(l,f,o,s);h<10&&(h*=1e4),h<i&&(i=h)}}catch(p){c.e(p)}finally{c.f()}return i},lc=function(e,t,n,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))};Object(Ea.a)("loadBang",{},"Sends bang on load",void 0,{tags:"Bang"});Object(Ea.a)("startBang",{},"Sends bang on start",void 0,{tags:"Bang"});Object(Ea.a)("averageDistance",{a:"",b:""},"Computes average distance",void 0,{inlets:2});Object(Ea.a)("average",{list:"",b:""},"Computes average of list",void 0,{inlets:1});Object(Ea.a)("three.shaderMaterial",{},"Creates a material out of shaders",function(){return 0},{tags:"Graphics",inlets:0,connects:{object:"three.mesh",inlet:"1"}});Object(Ea.a)("three.basicMaterial",{color:"",wireframe:""},"Creates a basic material with color in 2nd inlet",void 0,{tags:"Graphics",isHot:!0,inlets:2,connects:{object:"three.mesh",inlet:"1"}});Object(Ea.a)("three.vertexColorsMaterial",{color:"",wireframe:""},"Creates a basic material with color in 2nd inlet",void 0,{tags:"Graphics",isHot:!0,inlets:2,connects:{object:"three.mesh",inlet:"1"}});Object(Ea.a)("three.setVertexColors",{color:"",wireframe:""},"Creates a basic material with color in 2nd inlet",void 0,{tags:"Graphics",isHot:!0,inlets:2,connects:{object:"three.mesh",inlet:"1"}});Object(Ea.a)("three.pointsMaterial",{color:""},"Creates a basic material with color in 2nd inlet",void 0,{tags:"Graphics",inlets:1});var fc={"three.vertexColorsMaterial":function(e,t){var n=new Di.v({vertexColors:!0,wireframe:!1,blending:Di.a});return n.side=Di.m,n.needsUpdate=!0,function(e){var r=Object(Hr.a)(e,1)[0];return r&&"string"===typeof r&&(r=new Di.j(r)),n.color=r||16777215,n.side=Di.m,n.wireframe=!!t(),n.needsUpdate=!0,[n]}},"three.setVertexColors":function(e,t){return function(e){for(var n=Object(Hr.a)(e,1)[0],r=n.getAttribute("position"),a=t()||[],i=[],o=new Di.j,s=0;s<r.count;s+=3)o.set(a[s%a.length]||16777215*Math.random()),i.push(o.r,o.g,o.b),i.push(o.r,o.g,o.b),i.push(o.r,o.g,o.b);return n.setAttribute("color",new Di.o(i,3)),[n]}},"three.pointsMaterial":function(e,t){var n=new Di.E({color:16777215,blending:Di.a});return n.needsUpdate=!0,function(e){var t=Object(Hr.a)(e,1)[0];return t&&"string"===typeof t&&(t=new Di.j(t)),n.color=t||16777215,n.needsUpdate=!0,[n]}},"three.basicMaterial":function(e,t){var n=new Di.v({color:16777215,wireframe:!1,blending:Di.a});return n.side=Di.m,n.needsUpdate=!0,function(e){var r=Object(Hr.a)(e,1)[0];return r&&"string"===typeof r&&(r=new Di.j(r)),n.color=r||16777215,n.side=Di.m,n.wireframe=!!t(),n.needsUpdate=!0,[n]}},"three.shaderMaterial":function(e){var t=new Gi(e);return e.effect=t,function(){}}};n(721);function hc(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return pc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pc(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function pc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(Ea.a)("spline",{tension:"",points:""},"Returns cubic spline",void 0,{tags:"Graphics",inlets:3});Object(Ea.a)("convexHull",{},"Returns convex hull as Float32Array of pts");Object(Ea.a)("bangbang",{},"Sends bang message to outlets in order (left-to-right). Each argument creates an outlet eg: bangbang 0 0 0 0 ceates 4 outlets)",function(e){return e},{inlets:1,tags:"Bang"});Object(Ea.a)("messagemessage",{},"Sends messages to outlets in order (left-to-right). Each argument creates an outlet eg: bangbang 0 0 0 0 ceates 4 outlets)",function(e){return e},{inlets:1,tags:"Bang"});Object(Ea.a)("altbang",{},"Sends bang message to outlet alternating order (left-to-right)",function(e){return e},{inlets:1,tags:"Bang"});Object(Ea.a)("alt",{},"Sends message to outlet alternating order (left-to-right)",function(e){return e},{inlets:1,tags:"Order"});Object(Ea.a)("ifSend",{},"Sends message if argument is true",function(e){return 1},{inlets:2});Object(Ea.a)("randomThru",{},"Sends message to a randomly selected outlet",function(e){return e},{inlets:1,tags:"Order"});var dc={randomThru:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.needsStart=!0,function(t){var r=Object(Hr.a)(t,1)[0];if(r!==Xe.l){var a=n.filter(function(e){return void 0!==e()}).length,i=Math.floor(Math.random()*a);e.sendMessage(e.outputByNumber(i),r)}}},ifSend:function(e,t){return function(e){if(t())return e}},messagemessage:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(e){var t=[];return n.forEach(function(n,r){void 0===n()&&t.push(void 0),t.push(e[0])}),t}},alt:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=0;return e.needsStart=!0,function(t){var r=Object(Hr.a)(t,1)[0];if(r!==Xe.l){var i=n.filter(function(e){return void 0!==e()}),o=a++%i.length;e.sendMessage(e.outputByNumber(o),r)}else a=0}},bangbang:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(t){n.forEach(function(t,n){void 0!==t()&&e.sendMessage(e.outputByNumber(n),"bang")})}},altbang:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=0;return e.needsStart=!0,function(t){if(Object(Hr.a)(t,1)[0]!==Xe.l){var r=n.filter(function(e){return void 0!==e()}),i=a++%r.length;e.sendMessage(e.outputByNumber(i),"bang")}else a=0}}};Object(Ea.a)("three.orthographicCamera",{left:"",right:"",top:"",bottom:"",near:"",far:""},"Create an orthographic camera ",void 0,{tags:"Graphics",isHot:!0,inlets:7,connects:{object:"three.render",inlet:"1"},operations:mc});var mc={position:{parameters:["x","y","z"],description:"Sets the position of the camera."},lookAt:{parameters:["x","y","z"],description:"Sets where the camera is pointing"},zoom:{parameters:["amount"],description:"Sets the zoom of the camera"}},vc=function(e){return e.split(" ").filter(function(e){return""!==e}).slice(1).map(function(e){return parseFloat(e)})},bc=function(e,t){if("bang"===t)return!1;if("string"===typeof t){if(t.startsWith("position")){var n=vc(t),r=Object(Hr.a)(n,3),a=r[0],i=r[1],o=r[2];return e.position.x=a,e.position.y=i,e.position.z=o,!0}if(t.startsWith("lookAt")){var s=vc(t),c=Object(Hr.a)(s,3),u=c[0],l=c[1],f=c[2];return e.lookAt(u,l,f),!0}if(t.startsWith("zoom")){var h=vc(t),p=Object(Hr.a)(h,1)[0];return e.zoom=p,!0}}return!1};Object(Ea.a)("three.perspectiveCamera",{fov:"",aspect:"",near:"",far:""},"Create a perspective camera ",void 0,{tags:"Graphics",isHot:!0,inlets:5,operations:mc,connects:{object:"three.render",inlet:"1"}});var gc=function(e,t){return void 0===e?t:e},yc={"three.orthographicCamera":function(e,t,n,r,a,i,o){e.needsStart=!0;var s=new Di.z(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-1e4,1e4);return s.position.z=0,s.position.y=0,s.position.x=0,function(e){var c=Object(Hr.a)(e,1)[0];bc(s,c);var u=gc(t(),-1),l=gc(n(),1),f=gc(r(),-1),h=gc(a(),1),p=gc(i(),1),d=gc(o(),1);return s.left=u,s.right=l,s.top=f,s.bottom=h,s.far=d,s.near=p,s.updateProjectionMatrix(),s}},"three.perspectiveCamera":function(e,t,n,r,a){var i=new Di.A(80,1,1,1e4);return i.position.z=5,e.needsStart=!0,function(e){var o=Object(Hr.a)(e,1)[0];bc(i,o);var s=gc(t(),80),c=gc(n(),1),u=gc(r(),1),l=gc(a(),1e4);return i.fov=s,i.aspect=c,i.far=l,i.near=u,i.updateProjectionMatrix(),[i]}}},kc=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"===typeof e?e.apply(void 0,n):e};Object(Ea.a)("three.mesh",{geometry:"",material:""},"Create a mesh out of geometry and material",function(){return 1},{isHot:!0,inlets:2,connects:{object:"three.scene"},operations:{position:{parameters:["x","y","z"],description:"Sets the position of the mesh."},rotation:{parameters:["x","y"],description:"Rotates the mesh."}}});var Oc=function(e,t){var n,r;return function(e){var a=Object(Hr.a)(e,1)[0];if("string"===typeof a)if(a.startsWith("position")){var i=a.split(" ").slice(1).map(function(e){return parseFloat(e)}),o=Object(Hr.a)(i,3),s=o[0],c=o[1],u=o[2];n&&(n.position.x=s,n.position.y=c,n.position.z=u)}else if(a.startsWith("rotation")){var l=a.split(" ").slice(1).map(function(e){return parseFloat(e)}),f=Object(Hr.a)(l,2),h=f[0];f[1];n&&(n.rotation.x=h,n.rotation.y=h)}if(a&&a.attributes||n)return(!n||kc(t)&&r!==kc(t))&&((r=kc(t)||new Di.v({color:4388225,wireframe:!0})).side=Di.m,r.needsUpdate=!0,n?n.material=r:n=new Di.u(a,r)),[n]}};Object(Ea.a)("three.cube",{x:"",y:"",z:""},"Create a cube",function(){return 1},{tags:"Graphics",isHot:!0,inlets:3});Object(Ea.a)("three.gridHelper",{},"Grid helper",function(){return 1},{tags:"Graphics"});Object(Ea.a)("three.points",{points:"",size:"",material:"",isStatic:""},"Creates an object of poinntss to be added to a scene",void 0,{tags:"Graphics",isHot:!0,inlets:4});Object(Ea.a)("three.attribute",{mesh:"",name:"",itemSize:"",array:""},"Receives a Mesh object and sets an attribute with the arguments",void 0,{tags:"Graphics",inlets:4});var jc={"three.attribute":function(e,t,n,r){var a=!1;return function(e){var i=Object(Hr.a)(e,1)[0];if(i&&i.geometry&&t()&&n()&&r()){var o=i.geometry;return a&&o.attributes[t()].array.length===r().length?(o.attributes[t()].array.set(r(),0),o.attributes[t()].needsUpdate=!0):o.setAttribute(t(),new Di.e(r(),n())),a=!0,[i]}}},"three.points":function(e,t,n,r){var a,i,o,s=void 0;return function(e){var c=Object(Hr.a)(e,1)[0];if(ArrayBuffer.isView(c))if(!a||n()&&n()!==o.material){a||(a=new Di.f);var u=c;r()||(u=new Float32Array(2*c.length)).set(c,0),a.setAttribute("position",new Di.o(u,3)),i=n()||new Di.E({color:10079487,size:t()||1}),o?(o.material=i,o.material.needsUpdate=!0):o=new Di.D(a,i),a.setDrawRange(0,c.length/3)}else!r()&&a.attributes.position.array.length<c.length?(a.setAttribute("position",new Di.o(c,3)),a.attributes.position.needsUpdate=!0):r()||(a.attributes.position.array.set(c,0),a.attributes.position.needsUpdate=!0),a.setDrawRange(0,c.length/3),s!==(t()||1)&&(o.material.size=t()||1,o.material.needsUpdate=!0,s=o.material.size);return[o]}},"three.gridHelper":function(){var e=new Di.p(10,10);return function(){return[e]}},"three.cube":function(e,t,n){var r=new Di.c(100,100,100),a=new Di.w;a.side=Di.m;var i=new Di.u(r,a);return function(e){var r=Object(Hr.a)(e,1)[0];return i.position.x=void 0===r?2:r,i.position.y=void 0===t()?2:t(),i.position.z=void 0===n()?2:n(),[i]}},"three.mesh":Oc};Object(Ea.a)("float32Array",{list:""},"creates a Float32Array out of a list",void 0,{tags:"List"});function wc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ec=function(e){Object(u.a)(n,e);var t=wc(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Di.J([new Di.O(0,.5),new Di.O(-.5,-.5),new Di.O(.5,-.5)]),a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return Object(o.a)(this,n),(e=t.call(this)).inited=!1,e.updateShapes(r,a),e}return Object(s.a)(n,[{key:"updateShapes",value:function(e,t){this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};var n=[],r=[],a=[],i=[],o=0,s=0;if(!1===Array.isArray(e))u(e);else for(var c=0;c<e.length;c++)u(e[c]),this.addGroup(o,s,c),o+=s,s=0;function u(e){var o=r.length/3,c=e.extractPoints(t),u=c.shape,l=c.holes;!1===Di.L.isClockWise(u)&&(u=u.reverse());for(var f=0,h=l.length;f<h;f++){var p=l[f];!0===Di.L.isClockWise(p)&&(l[f]=p.reverse())}for(var d=Di.L.triangulateShape(u,l),m=0,v=l.length;m<v;m++){var b=l[m];u=u.concat(b)}for(var g=0,y=u.length;g<y;g++){var k=u[g];r.push(k.x,k.y,0),a.push(0,0,1),i.push(k.x,k.y)}for(var O=0,j=d.length;O<j;O++){var w=d[O],E=w[0]+o,S=w[1]+o,P=w[2]+o;n.push(E,S,P),s+=3}}this.inited&&this.index.array.length>=n.length?(this.index.array.set(n,0),this.index.needsUpdate=!0):(this.setIndex(n),this.index.needsUpdate=!0),this.inited&&this.attributes.position.array.length>=r.length?(this.attributes.position.array.set(r,0),this.attributes.position.needsUpdate=!0):(this.setAttribute("position",new Di.o(r,3)),this.attributes.position.needsUpdate=!0),this.inited&&this.attributes.normal.array.length>=a.length?(this.attributes.normal.array.set(a,0),this.attributes.normal.needsUpdate=!0):(this.setAttribute("normal",new Di.o(a,3)),this.attributes.normal.needsUpdate=!0),this.inited&&this.attributes.uv.array.length>=i.length?(this.attributes.uv.array.set(i,0),this.attributes.uv.needsUpdate=!0):(this.setAttribute("uv",new Di.o(i,2)),this.attributes.uv.needsUpdate=!0),this.inited&&this.computeVertexNormals(),this.inited=!0,this.setDrawRange(0,n.length)}},{key:"toJSON",value:function(){var e=Object(Z.a)(Object(f.a)(n.prototype),"toJSON",this).call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var a=e[n];t.shapes.push(a.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}}],[{key:"fromJSON",value:function(e,t){for(var r=[],a=0,i=e.shapes.length;a<i;a++){var o=t[e.shapes[a]];r.push(o)}return new n(r,e.curveSegments)}}]),n}(Di.f);Object(Ea.a)("three.bufferGeometry",{vertices:"",itemSize:"",index:""},"Create a BufferGeometry (to be passed to three.mesh)",function(){return 1},{tags:"Graphics",inlets:3,connects:{object:"three.mesh"}});var Sc=function(e,t,n){var r=new Di.f,a=!1,i=!1;return function(e){var o=Object(Hr.a)(e,1)[0];if(o&&o.buffer){if(a)o.length>r.attributes.position.array.length?r.attributes.position.array=o:r.attributes.position.array.set(o,0),i=!1;else{var s=new Float32Array(2*o.length);s.set(o,0),r.setAttribute("position",new Di.e(s,kc(t)||3)),a=!0}r.attributes.position.needsUpdate=!0}if(kc(n)&&"string"!==typeof kc(n)&&!i){if(r.index&&r.index.array.length>=kc(n).length)r.index.array.set(kc(n),0);else{var c=new Uint32Array(2*kc(n).length);c.set(kc(n),0),r.setIndex(new Di.e(c,1))}r.index.needsUpdate=!0,r.computeVertexNormals(),r.attributes.normal.needsUpdate=!0,i=!0}if(kc(n)&&r.setDrawRange(0,kc(n).length),i)return[r]}};Object(Ea.a)("three.circleGeometry",{bang:"Sends the geometry out through the outlet"},"Create a simple circle geometry (to be passed to mesh)",function(){return 1},{tags:"Graphics",connects:{object:"three.mesh"}});Object(Ea.a)("three.planeGeometry",{width:"",height:""},"Create a PlaneGeometry(to be passed to three.mesh)",function(){return 1},{tags:"Graphics",inlets:2,connects:{object:"three.mesh"}});Object(Ea.a)("three.renderTarget",{width:"",height:""},"Set the renderTarget for a canvas",function(){return 2},{tags:"Graphics",inlets:2,outlets:["target","texture"],connects:{object:"three.canvas",inlet:"renderTarget"}});Object(Ea.a)("three.torus",{x:"",y:"",z:""},"Create a cube",function(){return 1},{tags:"Graphics",inlets:3});Object(Ea.a)("three.boxGeometry",{},"Create a simple box geometry (to be passed to mesh)",function(){return 1},{tags:"Graphics",connects:{object:"three.mesh"}});Object(Ea.a)("three.shapeGeometry",{vertices:"List of points",segmentLength:"Number of segments"},"Create a simple box geometry (to be passed to mesh)",function(){return 1},{tags:"Graphics",inlets:2,connects:{object:"three.mesh"}});var Pc={"three.shapeGeometry":function(e,t){var n;return function(e){for(var r=Object(Hr.a)(e,1)[0],a=[],i=0;i<r.length;i+=2)a.push(new Di.O(r[i],r[i+1]));var o=t()||200;return n?n.updateShapes(new Di.J(a),o):n=new Ec(new Di.J(a),o),[n]}},"three.circleGeometry":function(e){var t=new Di.h(133,64);return function(e){return Object(Hr.a)(e,1)[0],[t]}},"three.boxGeometry":function(e,t,n,r,a,i,o){return function(e){return Object(Hr.a)(e,1)[0],[new Di.d(t()||100,n()||100,r()||100,a()||10,i()||10,o()||10)]}},"three.torus":function(e,t,n){var r=new Di.N(100,25,15,30),a=new Di.v({color:5592405}),i=new Di.u(r,a);return function(e){return Object(Hr.a)(e,1)[0],[i]}},"three.renderTarget":function(e,t){var n=new Di.R(300,300,{minFilter:Di.s,magFilter:Di.s,format:Di.G});return function(e){var r=Object(Hr.a)(e,1)[0];return"texture"===r?[void 0,n.texture]:"bang"===r?[n]:(r&&t()&&(r!==n.width||t()!==n.height)&&(n=new Di.R(r,t(),{minFilter:Di.s,magFilter:Di.x,format:Di.G})),[n])}},"three.bufferGeometry":Sc,"three.planeGeometry":function(e,t){var n=new Di.C(300,300);return function(t){return Object(Hr.a)(t,1)[0],e.geometry=n,[n]}}};function xc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Tc=function(e){Object(u.a)(n,e);var t=xc(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e))._color="#000000",r.newInlet("operation",function(e){return r.onOperationHelper(e)}),r.queue=[],window.requestAnimationFrame(function(){return r.draw()}),r}return Object(s.a)(n,[{key:"onOperationHelper",value:function(e){if(Array.isArray(e)){var t=Object(oi.a)(e),n=t[0],r=t.slice(1);if("string"!==typeof n){if(Array.isArray(n)){var a=Object(oi.a)(n),i=a[0],o=a.slice(1);if(Array.isArray(i)){var s=Object(oi.a)(i),c=s[0],u=s.slice(1);this.onOperation.apply(this,[c].concat(Object(h.a)(u)))}else this.onOperation.apply(this,[i].concat(Object(h.a)(o)))}}else this.onOperation.apply(this,[n].concat(Object(h.a)(r)))}}},{key:"getFunctionDefinition",value:function(e){return Ni[e]}},{key:"enqueue",value:function(e){this.queue.push(e)}},{key:"onOperation",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];if(this.ctxt){var i=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];if(e.split){var i=e.split(" ").filter(function(e){return""!==e}),o=i[0],s=i.slice(1).map(function(e){return Object(ae.a)(e)?parseFloat(e):e}),c=t.getFunctionDefinition(o);if(c)return function(){return c.apply(void 0,[t,t.ctxt].concat(Object(h.a)(s),r))}}};if(Array.isArray(e)){e.map(function(e){return i.apply(void 0,[e].concat(r))}).filter(function(e){return e}).forEach(function(n){return t.enqueue.apply(t,[n,e].concat(r))});return this.requested||(window.requestedTime=(new Date).getTime(),this.first||(this.first=!0)),void(this.requested=!0)}var o=i.apply(void 0,[e].concat(r));o&&this.enqueue.apply(this,[o,e].concat(r)),this.requested||(window.requestedTime=(new Date).getTime(),this.first||(this.first=!0)),this.requested=!0}}},{key:"draw",value:function(){var e=this;window.zRender.push((new Date).getTime()-window.requestedTime),window.lastRenderTime=(new Date).getTime(),window.renderSize.push(this.queue.length),this.queueforEach(function(e){return e()}),this.queue.length=0,this.requested=!1,window.requestAnimationFrame(function(){return e.draw()})}}]),n}(xa);window.renderSize=[],window.zRender=[];var Cc=void 0,Nc=[],Rc={clear:function(e){e.renderer.clear()},addToScene:function(e,t,n){var r=e.camera;e.scene.add(n),r.position.z=3},cube:function(e,t,n){var r=e.camera;e.scene.add(n),r.position.z=5},camera:function(e,t,n,r,a){var i=e.camera;i.position.x=n,i.position.y=r,i.position.z=a},draw:function(e,t){},render:function(e,t,n,r){var a=(new Date).getTime();if(Cc){var i=1e3/(a-Cc);Nc.unshift(i),window.fps=function(e){for(var t=0,n=0,r=0;r<20;r++)e[r]&&(n+=e[r],t++);return n/t}(Nc)}Cc=a;var o=window.errors.length;if(e.renderer.render(n,r),window.errors.length-o>0)return window.errors.splice(o+1)},autoClear:function(e,t,n){e.renderer.autoClear=!1}},Mc=Object(p.a)({},Rc);function Ac(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return qc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qc(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function qc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ic=[],_c=function(e){Object(u.a)(n,e);var t=Dc(n);function n(e){var r;return Object(o.a)(this,n),r=t.call(this,e),Ic.push(Object(c.a)(r)),r.newInlet("render target",function(e){var t=Object(Hr.a)(e,1)[0];return r.onRenderTarget(t)}),r.newInlet("get image data",function(e){Object(Hr.a)(e,1)[0];return r.onGetImageData()}),r.newOutlet("mouse-move"),r.newOutlet("mouse-click"),r.newOutlet("mouse-down"),r.newOutlet("isMouseDown"),r.newOutlet("size"),r.newOutlet("image data"),r}return Object(s.a)(n,[{key:"onGetImageData",value:function(){if(this.ctxt){var e=this.ctxt,t=this.zObject.width*this.zObject.height*4*16;this.pixels&&this.pixels.length===t||(this.pixels=new Uint8Array(t));var n=this.pixels;e.getContext().readPixels(0,0,e.getContext().drawingBufferWidth,e.getContext().drawingBufferHeight,e.getContext().RGBA,e.getContext().UNSIGNED_BYTE,n);for(var r=[],a=0;a<n.length;a+=4)n[a]>0&&r.push(a/4);this.sendMessage("image data",n)}}},{key:"onMouseDown",value:function(e,t){this.sendMessage("mouse-down",[e,t]),this.sendMessage("isMouseDown",1)}},{key:"onMouseUp",value:function(){this.sendMessage("isMouseDown",0)}},{key:"enqueue",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];this.queue.push({fn:e,operation:t,vargs:r})}},{key:"onMouseMove",value:function(e,t){this.sendMessage("mouse-move",[e,t])}},{key:"onMouseClick",value:function(e,t){this.sendMessage("mouse-click",[e,t])}},{key:"width",get:function(){return this.zObject.width}},{key:"height",get:function(){return this.zObject.height}},{key:"onRenderTarget",value:function(e){var t=this;if(console.log("on render target called=",e),this.renderer){var n=e&&"null"!==e?e:null;this.enqueue(function(){console.log("setting render target=",n),t.renderer.setRenderTarget(n)},"setRenderTarget",[n])}}},{key:"getFunctionDefinition",value:function(e){return Mc[e]}},{key:"draw",value:function(){window.zRender.push((new Date).getTime()-window.requestedTime),window.lastRenderTime=(new Date).getTime();var e=this.dedupeQueue(this.queue);if(0===e.length)return this.requested=!1,void(this===Ic[0]&&window.requestAnimationFrame(function(){return Ic.forEach(function(e){return e.draw()})}));window.renderSize.push(e.length);var t=[];e.forEach(function(e){var n=(0,e.fn)();n&&(t=[].concat(Object(h.a)(t),Object(h.a)(n)))}),this.lastErrorsLength!==t.length&&(t.length>0?this.scripts.forEach(function(e){return e.effect.onNewErrors(t)}):this.scripts.forEach(function(e){return e.effect.clearErrors(t)}),this.lastErrorsLength=t.length),this.queue.length=0,this.requested=!1,this===Ic[0]&&window.requestAnimationFrame(function(){return Ic.forEach(function(e){return e.draw()})})}},{key:"scripts",get:function(){return Object(y.a)(this.subSequence.getRootSubSequence?this.subSequence.getRootSubSequence():this.subSequence).filter(function(e){return"script"===e.name})}},{key:"dedupeQueue",value:function(e){var t,n,r=[],a=Ac(e);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=(i.fn,i.operation),s=i.vargs;t&&o===t.operation&&s.every(function(e,n){return e===t.vargs[n]})||(r.push(i),t=i)}}catch(c){a.e(c)}finally{a.f()}return r}},{key:"fromJson",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this)).call.apply(e,[this].concat(r))}}]),n}(Tc);Object(Ea.a)("three.canvas",{},"Creates a threejs canvas (3D)",function(){return 0},{inlets:0,tags:"Graphics"});Object(Ea.a)("three.vector3",{},"Creates a 3-dimensional vector object",void 0,{isHot:!0,inlets:3,tags:"Graphics"});Object(Ea.a)("three.vector2",{},"Creates a 2-dimensional vector object",void 0,{isHot:!0,inlets:2,tags:"Graphics"});Object(Ea.a)("three.gray",{shade:""},"Gray");var Fc={"three.gray":function(e){return function(e){var t=Object(Hr.a)(e,1)[0];return new Di.j(t,t,t),[[t,t,t]]}},"three.vector3":function(e,t,n){return function(e){var r=Object(Hr.a)(e,1)[0];return new Di.P(r,t(),n())}},"three.vector2":function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0];return new Di.O(n,t())}},"three.canvas":function(e){var t=new _c(e);return e.effect=t,e.width=300,e.height=300,e.needsLoad=!0,function(t){Object(Hr.a)(t,1)[0]===Xe.l&&e.effect.sendMessage("size",[e.width,e.height])}}};Object(Ea.a)("three.scene",{},"Create a scene in three js, any objects sent to it are added to it.",void 0,{tags:"Graphics",connects:{object:"three.render"}});Object(Ea.a)("three.render",{scene:"",camera:""},"Render a scene and camera",void 0,{tags:"Graphics",isHot:!0,inlets:2,connects:{object:"three.canvas",inlet:"operation"}});Object(Ea.a)("three.ambientLight",{color:"",intensity:""},"Creates an ambient light (to be added to scene)",void 0,{tags:"Graphics",isHot:!0,inlets:2});Object(Ea.a)("three.directionalLight",{color:"",intensity:""},"Creates an ambient light (to be added to scene)",void 0,{tags:"Graphics",isHot:!0,inlets:2});var Lc={"three.ambientLight":function(e,t){var n=new Di.b(16777215,1);return function(e){var r=Object(Hr.a)(e,1)[0];return"bang"===r?[n]:(n.color=r||16777215,n.intensity=t()||1,[n])}},"three.directionalLight":function(e,t){var n=new Di.l(16777215,1);return n.position.setScalar(100),function(e){var r=Object(Hr.a)(e,1)[0];return"bang"===r?[n]:(n.color=r||16777215,n.intensity=t()||1,[n])}},"three.scene":function(e){var t=new Di.H;return function(e){var n=Object(oi.a)(e),r=n[0],a=n.slice(1);switch(r){case"remove":return t.remove.apply(t,Object(h.a)(a)),[t];case"bang":return[t];case"clear":return t.clear(),[t];default:return Array.isArray(r)?r.forEach(function(e){e&&!t.children.includes(e)&&t.add(e)}):t.children.includes(r)||t.add(r),[t]}}},"three.render":function(e,t){var n=new Di.z(0,150,0,150,-1,1);return function(r){var a=Object(Hr.a)(r,1)[0];if("dispose"!==a){var i=n;t()&&(i=t()),"bang"!==a&&i.lookAt(a.position),e.lastOutput=["render",a,i],e.sendMessage(e.outputByNumber(0),e.lastOutput)}}}};Object(Ea.a)("delaunay",{},"computes delaunay triangulation for pts",void 0,{tags:"Graphics"});Object(Ea.a)("delaunayIndex",{},"computes delaunay triangulation for pts index",void 0,{tags:"Graphics"});var Bc=function(e){var t;return function(e){var n=Object(Hr.a)(e,1)[0];if(n&&n&&(ArrayBuffer.isView(n)||Array.isArray(n)&&!n.some(function(e){return!Object(ae.a)(e)})))return t?(n.forEach(function(e,n){return t.coords[n]=e}),t.update()):t=new ec.a(n),[t.triangles]}},zc=n(553),Vc=n(624);Object(Ea.a)("canvas",{},"Javascript canvas for 2D drawing",function(){return 0},{tags:"Graphics"});Object(Ea.a)("coords",{},"Creates a coord object from arguments (x,y)",void 0,{inlets:2,isHot:!0});Object(Ea.a)("rasterTriangle",{},"Returns a list of coordinates representing the raster points",void 0,{inlets:4,isHot:!0});Object(Ea.a)("rasterTriangles",{},"Returns a list of coordinates representing the raster points",void 0,{inlets:2,isHot:!0});Object(Ea.a)("triangulate",{},"Returns a list of triangles for a set of points",void 0,{inlets:2,isHot:!0});Object(Ea.a)("drawArray",{size:""},"Returns a list of coordinates representing the raster points",void 0,{inlets:3});Object(Ea.a)("drawTriangles",{},"Returns a list of coordinates representing the raster points",void 0,{inlets:2});Object(Ea.a)("triangle",{},"Send draw triangle operation to canvas with the 3 inputed coords",void 0,{isHot:!0,inlets:4});function Hc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Uc=function(e){Object(u.a)(n,e);var t=Hc(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e))._color="#000000",r.newOutlet("color"),r}return Object(s.a)(n,[{key:"color",get:function(){return this._color},set:function(e){this._color=e,console.log("sending message out",e),this.sendMessage("color",e)}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{color:this.color})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.color=e.color}}]),n}(xa),Jc=n(29),Gc=new Jc.a;Object(Ea.a)("color",{},"Outputs a color",function(){return 0},{connects:{object:"gl.color"},tags:"Colors"});Object(Ea.a)("compliment",{rotate:""},"Rotates a color (0-10), complimenting it",void 0,{isHot:!0,inlets:2,tags:"Colors"});var Wc={color:function(e){var t=new Uc(e);return e.effect=t,e.needsLoad=!0,e.needsStart=!0,e.width=230,e.height=180,function(e){Object(Hr.a)(e,1)[0],t.color=t.color}},compliment:function(e,t){return function(e){return Gc.hslToHex(Gc.compliment(Gc.saturate(e[0],1),t()))}}};Object(Ea.a)("metro",{},"Sends tick every 1/32th step (when project is playing)",void 0,{tags:"Ticker"});Object(Ea.a)("syncedMetro",{},"Sends tick every 1/32th step (when project is playing)",void 0,{tags:"Ticker"});Object(Ea.a)("setInterval",{},"Sends every so often",void 0,{tags:"Ticker"});Object(Ea.a)("setIntervalFast",{},"Sends every so often",void 0,{tags:"Ticker"});var Kc=function(e,t){var n=t.zobject;e.instances.forEach(function(e){var t=e.lookupObject(n);console.log("DELETING OBJ=",n,t),t&&t.delete()})},Xc=function(e,t){var n=t.zmessage;e.instances.forEach(function(e){var t=e.lookupObject(n);console.log("DELETING OBJ=",n,t),t&&e.deleteNode(t)})},Qc=function(e,t){var n=t.zobject,r=n._text;e.instances.forEach(function(e){e.registerObject(n,e.createZObject(0,0,r))})},Yc=function(e,t){var n=t.zmessage,r=n.dataType;e.instances.forEach(function(e){var t=e.createZMessage(0,0,r);e.registerObject(n,t)})},Zc=function(e,t){var n=t.inlet,r=t.isInstanceInlet;e.instances.forEach(function(e){e.registerObject(n,r?e.newInstanceInlet():e.newInlet())})},$c=function(e,t){var n=t.outlet;e.instances.forEach(function(e){e.registerObject(n,e.newOutlet())})},eu=function(e,t){var n=t.sourceNode,r=t.destNode,a=t.sourceType,i=t.destType;e.instances.forEach(function(e){var t=e.lookupObject(n);e.lookupObject(r).connectInlet(i,t,a)})},tu=function(e,t){var n=t.sourceNode,r=t.destNode,a=t.sourceType,i=t.destType;e.instances.forEach(function(e){var t=e.lookupObject(n);e.lookupObject(r).disconnectInlet(i,t,a)})},nu=function(e,t){var n=t.zobject,r=t.text;e.instances.forEach(function(e){var t=e.lookupObject(n);t&&(t.text=r)})},ru=function(e,t){var n=t.zmessage,r=t.text;e.instances.forEach(function(e){var t=e.lookupObject(n);t&&(t.text=r)})},au=function(e,t){var n=t.inletNumber;e.instances.forEach(function(e){var t=e.inletObjects.find(function(e){return e.inletNumber===n});e.toggleInlet(t)})};function iu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function ou(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return su(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return su(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function su(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var cu=function(e,t){var n={};for(var r in t)n[e[r]||r]=t[r];return n},uu=function(e,t){var n={};for(var r in t){var a,i=lu(e,r),o=[],s=ou(t[r]);try{for(s.s();!(a=s.n()).done;){var c=a.value,u={};for(var l in c)u[l]=lu(e,c[l]);o.push(u)}}catch(f){s.e(f)}finally{s.f()}n[i]=o}return n},lu=function(e,t){var n=t.split(".");return 1===n.length?e[n[0]]||t:n[0]+"."+e[n[1]]};function fu(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return hu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hu(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function hu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function du(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return mu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mu(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function mu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var vu=function(e){var t={},n=[],r=[];for(var a in e){var i,o=[],s=du(e[a]);try{for(s.s();!(i=s.n()).done;){var c=i.value,u=c.node,l=c.type,f=void 0,h=void 0,p=void 0,d=void 0,m=void 0;u.zObject&&(u=u.zObject),u.getObjectType&&("zmessage"===u.getObjectType()&&(f=u.type,h=u.min,p=u.max,d=u.round,m=u.message),u.getObjectType()===Zr.a&&(u.getEffectType()===re.c&&n.push(u),u.getEffectType()===re.a&&r.push(u)),o.push({node:u.getObjectType(),type:l,subType:f,min:h,max:p,round:d,value:m,name:u.name}))}}catch(v){s.e(v)}finally{s.f()}t[a]=o}return{json:t,midiEffects:n,effects:r}},bu=function(e,t,n){if(n){if("three.canvas"!==n){var r=e.findNodeByName(n)[0];if(r)return{node:"pad"===n?r.effect.pad:r,zobject:r}}}};function gu(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return yu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yu(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function yu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ku=function(){function e(t){Object(o.a)(this,e),this.subpatch=t,this.nameToObject={},this.hiddenObjects=[],this.parameters=[]}return Object(s.a)(e,[{key:"createParameters",value:function(){var e=this;this.parameters=[],this.getOptionsAtLevel().filter(function(t){return!e.hiddenObjects.includes(t)}).forEach(function(t){return e.createParameter(t)})}},{key:"createParameter",value:function(e){var t=this.getVariableContext(e),n=this.getFullVariableName(""===t?e.id:t);this.parameters.push(new $.a(n,e,function(t,n){e.getObjectType()===Zr.d?(e.text=n,e.execute()):e.effect.setValue(n)},{min:this.getVariableMin(e),max:this.getVariableMax(e),defaultValue:this.getVariableValue(e)}))}},{key:"getVariableMin",value:function(e){return e.effect?0:e.min}},{key:"getVariableMax",value:function(e){return e.effect?0:e.max}},{key:"getVariableValue",value:function(e){return e.effect?e.effect.value:e.message}},{key:"getJson",value:function(){return{hiddenObjects:this.hiddenObjects.map(function(e){return e.id}),parameters:this.parameters.map(function(e){return{name:e.name,id:e.id,min:e.min,max:e.max,depth:e.depth}})}}},{key:"fromJson",value:function(e){if(e){var t=this.getOptionsAtLevel();if(this.hiddenObjects=e.hiddenObjects.map(function(e){return t.find(function(t){return t.id===e})}).filter(function(e){return e}),e.parameters&&e.parameters.length>0){this.createParameters();for(var n=0;n<e.parameters.length;n++){var r=this.parameters[n];r&&(r.id=e.parameters[n].id,r.name=e.parameters[n].name,e.parameters[n].min&&(r.min=e.parameters[n].min,r.max=e.parameters[n].max,r.depth=e.parameters[n].depth))}}}}},{key:"hideObject",value:function(e){this.hiddenObjects.push(e)}},{key:"registerPattr",value:function(e,t){this.nameToObject[e]=t}},{key:"getValue",value:function(e){return e.getObjectType()===Zr.d?e.message:e.effect?e.effect.value:0}},{key:"getFullVariableName",value:function(e){for(var t=this.subpatch,n=[""];t.getRootSubSequence;)t.zObject&&n.push(t.zObject.args[0]),t=t.subSequence;return n.reverse(),n.join("::")+e}},{key:"getOptionsAtLevel",value:function(){return[].concat(Object(h.a)(this.subpatch.zMessages.filter(function(e){return e.type===Ra.c})),Object(h.a)(this.subpatch.zObjects.filter(function(e){return"macro"===e.name})))}},{key:"getNextLevels",value:function(){return this.subpatch.zObjects.filter(function(e){return e.effect&&!e.effect.implements&&e.effect.pattr}).map(function(e){return e.effect.pattr})}},{key:"getVariableContext",value:function(e){var t=Object.values(e.getOutboundNodes()).flat(2).map(function(e){return e.node}),n=t.find(function(e){return"gl.uniform"===e.name});if(n)return n.args[0];var r=t.find(function(e){return e.name});return r?r.name:""}},{key:"getNestedParameters",value:function(){var e,t=Object(h.a)(this.parameters),n=gu(this.getNextLevels());try{for(n.s();!(e=n.n()).done;){var r=e.value;t=[].concat(Object(h.a)(t),Object(h.a)(r.getNestedParameters()))}}catch(a){n.e(a)}finally{n.f()}return t}}]),e}();function Ou(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ju(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ju(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ju(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Eu=function(e){return function(e){Object(u.a)(n,e);var t=wu(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).zObjects=[],e.zMessages=[],e}return Object(s.a)(n,[{key:"initPattr",value:function(){this.pattr=new ku(this)}},{key:"updateZObjectRedux",value:function(){this.sequencerEngine.isLoading||this.dispatch(Object(C.bi)(this.id,Object(h.a)(this.zObjects)))}},{key:"updateZMessageRedux",value:function(){this.sequencerEngine.isLoading||this.dispatch(Object(C.Rh)(this.id,Object(h.a)(this.zMessages)))}},{key:"createZObject",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this.newZObject();return n&&(a.text=n),e&&!this.sequencerEngine.isLoading&&this.dispatch(Object(C.Kh)(a.id,{x:e,y:t})),this.state.spatial.presentationMode&&a.setAttribute("Include in Presentation",!0),this.zObjects.push(a),this.updateZObjectRedux(),void 0===e||void 0===t?a:(!this.sequencerEngine.isLoading&&r&&this.dispatch(Object(C.uf)(a)),a)}},{key:"createZMessage",value:function(e,t,n,r,a,i){var o=new Ha(this,n,r,a);return i&&(o.text=i),this.state.spatial.presentationMode&&o.setAttribute("Include in Presentation",!0),e&&!this.sequencerEngine.isLoading&&this.dispatch(Object(C.Kh)(o.id,{x:e,y:t})),this.zMessages.push(o),this.updateZMessageRedux(),o}},{key:"getZObjectsJson",value:function(e){return{zObjects:this.zObjects.filter(function(e){return!e.doNotSave}).map(function(t){return t.getJson(e)}),zMessages:this.zMessages.map(function(e){return e.getJson()})}}},{key:"loadZObjectsJson",value:function(e){if(e){var t,n=e.zObjects,r=e.zMessages,a=Ou(n);try{for(a.s();!(t=a.n()).done;){var i=t.value;this.createZObject().fromJson(i)}}catch(u){a.e(u)}finally{a.f()}var o,s=Ou(r);try{for(s.s();!(o=s.n()).done;){var c=o.value;this.createZMessage().fromJson(c)}}catch(u){s.e(u)}finally{s.f()}}}},{key:"executeAllMessages",value:function(){this.zMessages.forEach(function(e){return e.execute()});var e,t=Ou(this.zObjects);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.isSubPatch&&n.effect.zMessages.forEach(function(e){return e.execute()})}}catch(r){t.e(r)}finally{t.f()}}},{key:"deleteNode",value:function(e,t){if(!t){var n=e,r=n.inletNumber,a=(n.outletNumber,n.isInlet),i=n.isOutlet;a?this.deleteInletObject(e,r):i&&this.deleteOutletObject(e,r)}if(this.zObjects.includes(e)||this.zMessages.includes(e)||!e.zObject||(e=e.zObject),e.plugin){var o=this.state.plugins.pluginsLoaded.filter(function(t){return t!==e.plugin});this.dispatch(Object(C.ne)(o))}e.pluginViewerFor&&e.pluginViewerFor.delete(),this.zObjects.includes(e)&&(this.propagate(Object(Fa.u)(e)),e.disposeMessaging(),this.zObjects=this.zObjects.filter(function(t){return t!==e}),this.dispatch(Object(C.bi)(this.id,Object(h.a)(this.zObjects)))),this.zMessages.includes(e)&&(this.propagate(Object(Fa.r)(e)),e.disposeMessaging(),this.zMessages=this.zMessages.filter(function(t){return t!==e}),this.dispatch(Object(C.Rh)(this.id,Object(h.a)(this.zMessages))))}},{key:"scheduleZObjects",value:function(e,t){var n,r=Ou(this.sequencerEngine.tickingObjects);try{for(r.s();!(n=r.n()).done;){n.value.sendMessageToInlet([Xe.o,t,e])}}catch(a){r.e(a)}finally{r.f()}}},{key:"stopZObjects",value:function(){var e,t=Ou(this.zObjects);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.needsTick)n.sendMessageToInlet([Xe.m]);else if(n.effect&&n.effect.zObjects){var r,a=Ou(n.effect.zObjects);try{for(a.s();!(r=a.n()).done;){var i=r.value;i.needsTick&&i.sendMessageToInlet([Xe.m])}}catch(o){a.e(o)}finally{a.f()}}}}catch(o){t.e(o)}finally{t.f()}}},{key:"loadBangZObjects",value:function(){if(!(this.instances&&this.instances.length>0)){(new Date).getTime();var e,t=Ou(this.zObjects);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.needsLoad)if("gl.uniform"===n.name){var r=Object.values(n.getInboundNodes()).flat().map(function(e){return e.node}).filter(function(e){return e.type===Ra.c});if(0===r.length){if(n.subSequence.implements)continue;n.sendMessageToInlet([Xe.l])}r.forEach(function(e){e.skipLoad=!0,e.execute(e.message)})}else n.sendMessageToInlet([Xe.l]);else n.effect&&n.effect.zObjects&&n.effect.loadBangZObjects()}}catch(s){t.e(s)}finally{t.f()}var a,i=Ou(this.zMessages);try{for(i.s();!(a=i.n()).done;){var o=a.value;o.skipLoad||o.type===Ra.c&&o.execute(o.message)}}catch(s){i.e(s)}finally{i.f()}(new Date).getTime()}}},{key:"loadNFTZObjects",value:function(){var e,t=Ou(this.zObjects);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.needsNFT)n.sendMessageToInlet([Xe.f]);else if(n.effect&&n.effect.zObjects){var r,a=Ou(n.effect.zObjects);try{for(a.s();!(r=a.n()).done;){var i=r.value;i.needsNFT&&i.sendMessageToInlet([Xe.f])}}catch(o){a.e(o)}finally{a.f()}}}}catch(o){t.e(o)}finally{t.f()}}},{key:"startZObjects",value:function(){var e,t=Ou(this.zObjects);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.needsTick||n.needsStart?n.name.includes("subpatch")||n.sendMessageToInlet([Xe.l]):n.effect&&n.effect.zObjects&&(n.name.includes("subpatch")||n.effect.startZObjects())}}catch(i){t.e(i)}finally{t.f()}var r,a=Ou(this.zMessages);try{for(a.s();!(r=a.n()).done;){r.value.type,Ra.c}}catch(i){a.e(i)}finally{a.f()}}},{key:"encapsulateObjects",value:function(e,t){var n,r=this,a=this.state.windows.selectedElements,i=Object.keys(a),o=i.map(function(e){return r.zObjects.find(function(t){return t.id===e})}).filter(function(e){return e}),s=i.map(function(e){return r.zMessages.find(function(t){return t.id===e})}).filter(function(e){return e}),c=[].concat(Object(h.a)(o),Object(h.a)(s),Object(h.a)(o.filter(function(e){return e.effect}).map(function(e){return e.effect}))),u=[],l=0,f=[],p=0,d={},m={},v=Ou(c);try{for(v.s();!(n=v.n()).done;){var b=n.value;if(b.getOutboundNodes){b.pad&&(b=b.pad);var g=b.getOutboundNodes(),y=b.getInboundNodes();for(var k in g){var O=g[k].filter(function(e){var t=e.node;return!c.includes(t)});if(0!==O.length){var j,w=!1,E=Ou(f);try{for(E.s();!(j=E.n()).done;){var S=j.value;S.connections[0].node===O[0].node&&k===S.type&&(w=!0)}}catch(oe){E.e(oe)}finally{E.f()}if(!w){p++;var P="string"===typeof b.name&&b.name||b.zObject&&b.zObject.name;m[p]=P+"."+k}f.push({connections:O,outletNumber:p,type:k,object:b})}}for(var x in y){var T=y[x].filter(function(e){var t=e.node;return!c.includes(t)});if(0!==T.length){var N,R=!1,M=Ou(u);try{for(M.s();!(N=M.n()).done;){var A=N.value;A.connections[0].node===T[0].node&&A.type===x&&(R=!0)}}catch(oe){M.e(oe)}finally{M.f()}if(!R){l++;var q="string"===typeof b.name&&b.name||b.zObject&&b.zObject.name;d[l]=q+"."+x}u.push({connections:T,inletNumber:l,type:x,object:b})}}}}}catch(oe){v.e(oe)}finally{v.f()}var D=this.createZObject(e,t);D.text="subpatch";var I=D.effect;I.zMessages=[].concat(Object(h.a)(I.zMessages),Object(h.a)(s)),this.zMessages=this.zMessages.filter(function(e){return!s.includes(e)}),I.zObjects=[].concat(Object(h.a)(I.zObjects),Object(h.a)(o)),this.zObjects=this.zObjects.filter(function(e){return!o.includes(e)}),this.updateZObjectRedux(),this.updateZMessageRedux();for(var _=2;_<=l;_++){I.newInlet(_)._text=d[_]}for(var F=2;F<=p;F++){I.newOutlet(F)._text=m[F]}I.updateZObjectRedux(),I.updateZMessageRedux();var L,B=Ou(s);try{for(B.s();!(L=B.n()).done;){var z=L.value;z.clearMessagingRedux(),z.subSequence=I,z.updateMessagingRedux()}}catch(oe){B.e(oe)}finally{B.f()}var V,H=Ou(o);try{for(H.s();!(V=H.n()).done;){var U=V.value;U.effect&&(U.effect.clearMessagingRedux(),U.effect.trackMeter||U.effect.tracks||(U.effect.subSequence=I),U.effect.updateMessagingRedux()),U.clearMessagingRedux(),U.subSequence=I,U.updateMessagingRedux()}}catch(oe){H.e(oe)}finally{H.f()}for(var J=function(){var e=W[G],t=e.connections,n=e.type,r=e.object,a=e.inletNumber;t.forEach(function(e){r.disconnectInlet(n,e.node,e.type),I.connectInlet("Input "+a,e.node,e.type)});var i=I.inletObjects[a-1];r.connectInlet(n,i,"Output")},G=0,W=u;G<W.length;G++)J();for(var K=function(){var e=Q[X],t=e.connections,n=e.type,r=e.object,a=e.outletNumber;t.forEach(function(e){e.node.disconnectInlet(e.type,r,n),e.node.connectInlet(e.type,I,"Output "+a)}),I.outletObjects[a-1].connectInlet("Input",r,n)},X=0,Q=f;X<Q.length;X++)K();var Y,Z=this.state.windows.windowPositions,$=i.map(function(e){return Z[e]}),ee=100-Math.min.apply(Math,Object(h.a)($.map(function(e){return e.x}))),te=100-Math.min.apply(Math,Object(h.a)($.map(function(e){return e.y}))),ne={},re=Ou(c);try{for(re.s();!(Y=re.n()).done;){var ae=Y.value,ie=ae.id;Z[ie]&&(ne[ie]={x:Z[ie].x+ee,y:Z[ie].y+te},ae.x=ne[ie].x,ae.y=ne[ie].y)}}catch(oe){re.e(oe)}finally{re.f()}this.dispatch(Object(C.gb)(ne))}},{key:"deleteInletObject",value:function(e,t){e.isDeleted=!0;var n=Object.keys(this.inlets)[t-1];this.disconnectFromInlet(n),this.inletObjects.filter(function(e){return!e.isDeleted}).forEach(function(e,t){return e.inletNumber=t+1})}},{key:"deleteOutletObject",value:function(e,t){var n=Object.keys(this.outlets)[t-1];this.deleteOutlet(n),this.outletObjects=this.outletObjects.filter(function(t){return t!==e}),this.outletObjects.forEach(function(e,t){return e.outletNumber=t+1})}},{key:"createZTrack",value:function(e,t,n){this.createZObject(t,n,"track "+(e.trackNumber+1))}},{key:"getMessagingEdgeById",value:function(e){var t,n=Ou([].concat(Object(h.a)(this.zObjects),Object(h.a)(this.zMessages)));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.effect&&r.effect.zObjects){var a=r.effect.getMessagingEdgeById(e);if(a)return a}for(var i in r.inlets){var o=r.inlets[i].connections.find(function(t){return t.id===e});if(o)return o}}}catch(s){n.e(s)}finally{n.f()}}},{key:"findNodeByName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(y.a)(this).filter(function(n){return"string"===typeof n.name&&(t?n.name===e:n.name.toLowerCase().includes(e.toLowerCase()))})}},{key:"moveObjectInto",value:function(e,t,n){if(!e.isInlet&&!e.isOutlet){for(var r in e.inlets)e.disconnectFromInlet(r);for(var a in e.outlets)e.disconnectFromOutlet(a);if(e.effect&&e.effect.inlets){for(var i in e.effect.inlets)e.effect.disconnectFromInlet(i);for(var o in e.effect.outlets)e.effect.disconnectFromOutlet(o)}var s=e.subSequence;s.zObjects.includes(e)&&(s.zObjects=s.zObjects.filter(function(t){return t!==e}),this.zObjects.push(e)),s.zMessages.includes(e)&&(s.zMessages=s.zMessages.filter(function(t){return t!==e}),this.zMessages.push(e)),this.updateZObjectRedux(),this.updateZMessageRedux(),s.updateZObjectRedux(),s.updateZMessageRedux(),e.subSequence=this,e.effect&&(e.effect.subSequence=this),this.dispatch(Object(C.zd)(void 0)),t&&n&&(this.dispatch(Object(C.Kh)(e.id,{x:t,y:n})),this.dispatch(Object(C.qe)(e.id,{x:t,y:n})))}}}]),n}(e)};function Su(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Pu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pu(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Pu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Tu=function(e){Object(u.a)(n,e);var t=xu(n);function n(e,r,a,i){var s;return Object(o.a)(this,n),(s=t.call(this)).id=Object(j.uuid)(),s.subSequence=e,s.sequencerEngine=r,s.sequencerEngine.idToObject[s.id]=Object(c.a)(s),s.zObject=a,s.name=i,s.trackData=new q.a,s.trackData.loadDefaults(),s.inletObjects=[],s.outletObjects=[],s.newInlet(1),s.newOutlet(1),s.zObject.newAction("Create Instance",function(){return s.newInstance()}),s.outletInstanceMapping={},s.inletInstanceMapping={},s.isInitialLoad=!0,s.initPattr(),s}return Object(s.a)(n,[{key:"getRootSubSequence",value:function(){return this.subSequence.getRootSubSequence?this.subSequence.getRootSubSequence():this.subSequence}},{key:"getJson",value:function(e,t){var n,r,a;if(e){var i=vu(this.getInboundNodes()),o=vu(this.getOutboundNodes()),s=Array.from(new Set([].concat(Object(h.a)(i.effects),Object(h.a)(o.effects)))),c=Array.from(new Set([].concat(Object(h.a)(i.midiEffects),Object(h.a)(o.midiEffects))));n=i.json,r=o.json,a={effects:s.map(function(e){return e.getJson()}),midiEffects:c.map(function(e){return e.getJson()})}}return Object(p.a)({id:this.id},this.getZObjectsJson(e),{numInlets:this.inletObjects.length,inbound:n,outbound:r,objectDependencies:a,fillColor:this.fillColor,numOutlets:this.outletObjects.length,isCustom:this.isCustom,width:this.width,height:this.height,inletObjects:this.inletObjects.map(function(e){return e.getJson()}),outletObjects:this.outletObjects.map(function(e){return e.getJson()}),instanceInlets:this.instanceInlets.filter(function(e){return e}).map(function(e){return e.id}),instances:this.instances.filter(function(e){return e}).map(function(e){return e.id}),outletInstanceMapping:this.outletInstanceMapping,inletInstanceMapping:this.inletInstanceMapping,pattr:this.pattr.getJson()})}},{key:"getParameters",value:function(){return this.zObjects.flatMap(function(e){return e.getAllParameters()})}},{key:"fromJson",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;this.zMessages.forEach(function(e){r&&(e.isInlet||e.isOutlet)||t.deleteNode(e,!0)}),this.zObjects.forEach(function(e){return t.deleteNode(e,!0)}),n||(this.id=e.id,this.sequencerEngine.idToObject[this.id]=this),this.fillColor=e.fillColor,this.isCustom=e.isCustom,this.width=e.width,this.height=e.height,this.isCustom&&(this.zObject.width=this.width,this.zObject.height=this.height);var o,s={},c=e.zObjects,u=e.zMessages,l=Su(c);try{for(l.s();!(o=l.n()).done;){var f=o.value,h=this.createZObject(),d=h.fromJson(f,n);(s=Object(p.a)({},s,d))[f.id]=h.id,h.effect&&f.effect&&(s[f.effect.id]=h.effect.id)}}catch(F){l.e(F)}finally{l.f()}this.zMessages=this.zMessages.filter(function(e){return r||!e.isOutlet&&!e.isInlet});var m,v=Su(u);try{for(v.s();!(m=v.n()).done;){var b=m.value;if(void 0!==b.outletNumber){var g="Output "+b.outletNumber;if(this.outlets[g]&&r){if(!this.outletInstanceMapping[b.id]){var y=Object(j.uuid)();this.outletInstanceMapping[b.id]=y;var k=[];this.outlets[g]&&(k=this.outlets["Output "+b.outletNumber].connections,this.deleteOutlet("Output "+b.outletNumber),this.outletObjects.splice(b.outletNumber-1,1)),this.newOutlet(b.outletNumber,y);var O,w=Su(k);try{for(w.s();!(O=w.n()).done;){var E=O.value,S=E.destNode,P=E.sourceType,x=E.destType;S.connectInlet(x,this,P)}}catch(F){w.e(F)}finally{w.f()}}s[b.id]=this.outletInstanceMapping[b.id]}else{this.outlets[g]&&(this.deleteOutlet("Output "+b.outletNumber),this.outletObjects.splice(b.outletNumber-1,1));var T=n?Object(j.uuid)():b.id;this.newOutlet(b.outletNumber,T),s[b.id]=T}}else if(void 0!==b.inletNumber)if(this.inlets["Input "+b.inletNumber]&&r){if(!this.inletInstanceMapping[b.id]){var N=Object(j.uuid)();this.inletInstanceMapping[b.id]=N,this.inlets["Input "+b.inletNumber]&&(this.deleteInlet("Input "+b.inletNunmber),this.inletObjects.splice(b.inletNumber-1,1)),this.newInlet(b.inletNumber,N)}s[b.id]=this.inletInstanceMapping[b.id]}else{this.inlets["Input "+b.inletNumber]&&(this.deleteInlet("Input "+b.inletNunmber),this.inletObjects.splice(b.inletNumber-1,1));var R=n?Object(j.uuid)():b.id;this.newInlet(b.inletNumber,R),s[b.id]=R,this.inletInstanceMapping[b.id]=R}else{var M=this.createZMessage();M.fromJson(b,n),s[b.id]=M.id}}}catch(F){v.e(F)}finally{v.f()}if(e.inletObjects){for(var A=0;A<e.inletObjects.length;A++)this.inletObjects[A]&&(this.inletObjects[A]._text=e.inletObjects[A].text);for(var q=0;q<e.outletObjects.length;q++)this.outletObjects[q]&&(this.outletObjects[q]._text=e.outletObjects[q].text)}if(e.instanceInlets&&!r){var D,I=Su(e.instanceInlets);try{var _=function(){var e=D.value,n=t.inletObjects.find(function(t){return t.id===e||t.id===s[e]});t.instanceInlets.push(n)};for(I.s();!(D=I.n()).done;)_()}catch(F){I.e(F)}finally{I.f()}}return e.instances&&!r&&(this.instanceIds=e.instances),!r&&a&&(e.outbound||e.inbound)&&(this.sequencerEngine.dispatch(Object(C.ad)(this.sequencerEngine.sequenceId,!1)),function(e,t,n,r,a){var i={},o=e.subSequence.getRootSubSequence?e.subSequence.getRootSubSequence():e.subSequence,s=[];if(r){var c=r.midiEffects,u=r.effects,l=e.sequencerEngine.getSelectedTrack();if(l){var f,h=du(c);try{for(h.s();!(f=h.n()).done;){var p=f.value,d=l.midiEffects.addEffectJson(p),m=d.effect;d.bulk,s.push(m)}}catch(F){h.e(F)}finally{h.f()}var v,b=du(u);try{for(b.s();!(v=b.n()).done;){var g=v.value,y=l.effectsChain.addEffectJson(g,e.sequencerEngine.tracks,l.trackNumber),k=y.effect;y.bulk,s.push(k)}}catch(F){b.e(F)}finally{b.f()}}}var O=0,j=[];for(var w in t){var E,S=du(t[w]);try{var P=function(){var t=E.value,n=t.node,r=t.name,c=t.type,u=t.value,l=t.subType,f=t.min,h=t.max,p=t.round;if(!r||"subpatch"===r)return"continue";var d=void 0;if("zmessage"===n&&l===Ra.c){var m=e.sequencerEngine.state.windows.windowPositions[e.zObject.id];O+=60;var v=m&&m.x+O,b=m&&Math.max(0,m.y-60);d={node:o.createZMessage(v,b,l)},i[d.node.id]={x:v,y:b}}else{var g=s.find(function(e){return e.name===r});g?d=g:"pad"===r?d=bu(o,0,r):(d=o.createZObject(1,1,r),a&&d.hide(),i[d.id]={x:1,y:1},s.push(d))}d.effect?e.connectInlet(w,d.effect,c):e.connectInlet(w,d.node||d,c),void 0!==u&&d&&d.node&&(d.node.min=f,d.node.max=h,d.node.round=p,d.node.text=parseFloat(u),d.node.storedMessage=parseFloat(u),j.push(d.node))};for(S.s();!(E=S.n()).done;)P()}catch(F){S.e(F)}finally{S.f()}}for(var x in n){var T,C=du(n[x]);try{var N=function(){var t=T.value,n=t.name,r=t.node,c=t.type,u=t.subType;if(!n)return"continue";var l=void 0;if("zmessage"===r&&u===Ra.c)l={node:o.createZMessage(void 0,void 0,u)};else{var f=s.find(function(e){return e.name===n});if(f)l=f;else{if("pad"===n)return l=bu(o,0,n),"continue";(l=bu(o,0,n))||(l=o.createZObject(1,1,n)),a&&l.hide(),i[l.id]={x:1,y:1},s.push(l)}}l.node?l.node.connectInlet(c,e,x):l.effect?l.effect.connectInlet(c,e,x):l.connectInlet(c,e,x)};for(C.s();!(T=C.n()).done;)N()}catch(F){C.e(F)}finally{C.f()}}j.forEach(function(e){e.execute()}),setTimeout(function(){j.forEach(function(e){e.execute()})},1e3)}(this,e.inbound,e.outbound,e.objectDependencies,i),this.sequencerEngine.dispatch(Object(C.ad)(this.sequencerEngine.sequenceId,!0))),this.updateMessagingRedux(),this.isInitialLoad=!1,this.pattr.fromJson(e.pattr),s}},{key:"deencapsulate",value:function(){var e=this;this.zMessages.forEach(function(e){e.isInlet=!1,e.isOutlet=!1}),this.subSequence.zMessages=[].concat(Object(h.a)(this.subSequence.zMessages),Object(h.a)(this.zMessages)),this.subSequence.zObjects=[].concat(Object(h.a)(this.subSequence.zObjects),Object(h.a)(this.zObjects)),this.subSequence.zObjects=this.subSequence.zObjects.filter(function(t){return t!==e.zObject}),this.subSequence.updateZObjectRedux(),this.subSequence.updateZMessageRedux();var t,n=Su(this.zMessages);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.clearMessagingRedux(),r.subSequence=this.subSequence,r.updateMessagingRedux()}}catch(s){n.e(s)}finally{n.f()}var a,i=Su(this.zObjects);try{for(i.s();!(a=i.n()).done;){var o=a.value;o.effect&&(o.effect.clearMessagingRedux&&o.effect.clearMessagingRedux(),o.effect.subSequence=this.subSequence,o.effect.updateMessagingRedux&&o.effect.updateMessagingRedux()),o.clearMessagingRedux(),o.subSequence=this.subSequence,o.updateMessagingRedux()}}catch(s){i.e(s)}finally{i.f()}this.zMessages=[],this.zObjects=[],this.updateZObjectRedux(),this.updateZMessageRedux(),this.dispatch(Object(C.Eh)([]))}},{key:"newZObject",value:function(){return new Sf(this)}},{key:"newInlet",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.inletObjects.length+1,r=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s="Input "+t;a=a||50+100*(t-1),i=i||50;var c=this.createZMessage(a,i,void 0,void 0,r);return c.isInlet=!0,c.inletNumber=t,c.deleteOutlet("Message Send"),this.inletObjects.push(c),Object(Z.a)(Object(f.a)(n.prototype),"newInlet",this).call(this,s,function(t){return e.onInletMessage(c,t)}),o&&this.propagate(Object(Fa.n)(c,!1)),c}},{key:"newOutlet",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.outletObjects.length+1,r=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o="Output "+t;Object(Z.a)(Object(f.a)(n.prototype),"newOutlet",this).call(this,o),a=a||50+100*(t-1),i=i||350;var s=this.createZMessage(a,i,void 0,function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return e.sendMessage.apply(e,[o,t].concat(r))},r);return s.linkedOutlet=this.outlets[o],s.outletNumber=t,s.isOutlet=!0,this.outletObjects.push(s),this.propagate(Object(Fa.p)(s)),s}},{key:"evaluateAsFunction",value:function(e){var t=this.inletObjects[0];if(t){this.outletObjects[0];for(var n=Cu(t.outlets);n;){var r=n.connections[0];if(!r)break;var a=r.destNode;if(a.isOutlet)break;e=a.function([e]),Array.isArray(e)&&(e=e[0]),n=Cu(a.outlets)}return e}}},{key:"dispose",value:function(){var e,t=Su(this.instances);try{for(t.s();!(e=t.n()).done;){e.value.zObject.delete()}}catch(n){t.e(n)}finally{t.f()}}},{key:"isDeletable",value:function(){return!0}},{key:"createZObject",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var i=(e=Object(Z.a)(Object(f.a)(n.prototype),"createZObject",this)).call.apply(e,[this].concat(r));return this.propagate(Object(Fa.t)(i)),i}},{key:"createZMessage",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var i=(e=Object(Z.a)(Object(f.a)(n.prototype),"createZMessage",this)).call.apply(e,[this].concat(r));return this.propagate(Object(Fa.q)(i)),i}}]),n}(function(e){return function(e){Object(u.a)(n,e);var t=iu(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"propagate",value:function(e){this.insideInstance()&&function(e,t){var n=void 0;switch(t.type){case Fa.i:n=Qc;break;case Fa.f:n=Yc;break;case Fa.k:n=nu;break;case Fa.h:n=ru;break;case Fa.c:n=Zc;break;case Fa.e:n=$c;break;case Fa.a:n=eu;break;case Fa.b:n=tu;break;case Fa.j:n=Kc;break;case Fa.g:n=Xc;break;case Fa.d:n=au}n&&n(e,t)}(this,e)}}]),n}(e)}(function(e){return function(e){Object(u.a)(n,e);var t=pu(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).instances=[],e.instanceInlets=[],e}return Object(s.a)(n,[{key:"newInstance",value:function(){var e=this.subSequence.createZObject(this.x,this.y,"instancedSubpatch").effect;e.implements=this,this.instances.push(e),this.copyIntoInstance(e),this.onChange()}},{key:"toggleInlet",value:function(e){this.instanceInlets.includes(e)?this.instanceInlets=this.instanceInlets.filteR(function(t){return t!==e}):this.instanceInlets.push(e),this.propagate(Object(Fa.o)(e.inletNumber))}},{key:"newInstanceInlet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.inletObjects.length+1,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=this.newInlet(e,t,n,r,!1);return this.instanceInlets.push(a),this.propagate(Object(Fa.n)(a,!0)),a}},{key:"onInletMessage",value:function(e,t){if(this.hasInstances&&!this.instanceInlets.includes(e)){var n,r=fu(this.instances);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=this.inletObjects.indexOf(e),o=a.inletObjects[i];o&&o.sendMessage.apply(o,["Output"].concat(Object(h.a)(t)))}}catch(s){r.e(s)}finally{r.f()}}else e.sendMessage.apply(e,["Output"].concat(Object(h.a)(t)))}},{key:"hasInstances",get:function(){return this.instances.length>0}},{key:"insideInstance",value:function(){return!!this.hasInstances||this.subSequence.insideInstance()}},{key:"onChange",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},{key:"copyIntoInstance",value:function(e){var t,n=this,r=fu(this.zObjects);try{for(r.s();!(t=r.n()).done;){var a=t.value;if("subpatch"===a.name){var i=a.effect;i.showAllOutlets=!0;var o=e.createZObject(0,0,"instancedSubpatch");e.registerObject(a,o),i.instances.push(o.effect),i.copyIntoInstance(o.effect),a.effect&&e.registerObject(a.effect,o.effect)}else{var s=e.createZObject(0,0,a.text);s.fromJson(a.getJson(),!0),e.registerObject(a,s),a.effect&&e.registerObject(a.effect,s.effect)}}}catch(h){r.e(h)}finally{r.f()}var c,u=fu(this.zMessages);try{for(u.s();!(c=u.n()).done;){var l=c.value;if((!l.isInlet||"continue"!==function(){var t=l.inletNumber,r=e.inletObjects.find(function(e){return e.inletNumber===t}),a=void 0;return r?(a=r,e.registerObject(l,r)):n.instanceInlets.includes(l)?(a=e.newInstanceInlet(),e.registerObject(l,a)):((a=e.newInlet())._text=l._text,e.registerObject(l,a)),a._text=l._text,"continue"}())&&(!l.isOutlet||"continue"!==function(){var t=l.outletNumber,n=e.outletObjects.find(function(e){return e.outletNumber===t});if(n)n._text=l._text,e.registerObject(l,n);else{var r=e.newOutlet();r._text=l._text,e.registerObject(l,r)}return"continue"}())){var f=e.createZMessage(0,0,l.dataType);f.fromJson(l.getJson(),!0),e.registerObject(l,f)}}}catch(h){u.e(h)}finally{u.f()}this.copyConnectionsIntoInstance(e)}},{key:"copyConnectionsIntoInstance",value:function(e){var t=this.zObject.getPresetJson().inletConnections,n={};for(var r in e.objectRegistry)n[r]=e.objectRegistry[r].id;t=uu(n,t),this.sequencerEngine.loadInletConnectionsForId(t,!0)}}]),n}(e)}(Object(wa.a)(Eu(aa(function(){return function e(){Object(o.a)(this,e)}}())))))),Cu=function(e){return e[Object.keys(e)[0]]},Nu=Tu;Object(Ea.a)("three.planeRenderer",{material:""},"Renders a material as a plane",function(){return 1},{connects:[{inlet:"operation",outlet:"Output 1",object:"three.canvas"}]});var Ru=n(223);function Mu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Au=function(e){Object(u.a)(n,e);var t=Mu(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this)).zObject=e,r.sequencerEngine=e.sequencerEngine,r.subSequence=e.subSequence,r.startUpNumber=0,r.newInlet("Start Up Calls",function(e){return r.startUpNumber=e[0]}),r.newOutlet("Random Number"),r}return Object(s.a)(n,[{key:"getJson",value:function(){return{startUpNumber:this.startUpNumber}}},{key:"fromJson",value:function(e){this.startUpNumber=e.startUpNumber}},{key:"getParameters",value:function(){return[]}},{key:"startUp",value:function(){for(var e=0;e<this.startUpNumber;e++)this.execute()}},{key:"execute",value:function(){console.log("executing random number"),this.sendMessage("Random Number",Object(Ru.b)())}}]),n}(Object(wa.a)(function(){return function e(){Object(o.a)(this,e)}}()));Object(Ea.a)("nft",{},"Random number generator based on NFT's token seed",function(e){return 0});Object(Ea.a)("erc720.tokenID",{},"Returns the tokenID URL param of this page (for ERC720 tokens)",function(e){return 1});var qu=n(83);function Du(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Iu=n(805),_u=n(87),Fu=n(48);function Lu(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Bu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bu(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Bu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}_u.a,_u.b;var zu=[_u.a,_u.b,Fu.a,Fu.e,Fu.j,Fu.g,Fu.f,Fu.h,Fu.c,Fu.d,Fu.i],Vu=function(e){return e.type?e.type.type||e.type:e},Hu=function(e,t){for(var n=[],r=function(e,t){return n.some(function(n){return n.some(function(n){return n.x===e&&n.y===t})})},a=function(n,r){for(var a=[],o=function(n){if(!e[r][n])return s=n,"break";if(a.push({x:n,y:r}),r>=t-1)return s=n,"continue";var o=i(n,r+1),c=[o],u=[o];if(e[r][n]===_u.a){var l=i(n+1,r+1);c.push(l),u.push(l)}for(var f=function(){var t=u.pop();if(0===t.length)return"continue";t.forEach(function(n){var r=i(n.x,t[0].y+1);if(r.length>0&&(c.push(r),u.push(r)),e[(n.x,t[0].y)]===_u.a){var a=i(n.x+1,t[0].y+1);a.length>0&&(c.push(a),u.push(a))}})};u.length>0;)f();c.forEach(function(e){return a=[].concat(Object(h.a)(a),Object(h.a)(e))}),e[r][n]===_u.a&&n++,s=n},s=n;s<t;s++){var c=o(s);if("break"===c)break}var u=[];return a.forEach(function(e){u.some(function(t){return t.x==e.x&&t.y===e.y})||u.push(e)}),u},i=function(n,r,a){if(r>=t)return[];for(var i=[],o=function(t){return!!e[r][t]&&(i.push({x:t,y:r}),!0)},s=n;s<t&&o(s);s++)e[r][s]===_u.a&&s++;for(var c=n-1;c<=0&&(o(c)||e[r][c-1]===_u.a);c--);return i},o=0;o<t;o++)for(var s=0;s<t;s++){if(e[o][s]&&!r(s,o)){var c=a(s,o);n.push(c)}}return n},Uu=function(e){return 1===e.length?e[0]:e},Ju=function(e){var t=[];return e.forEach(function(e){if(0===t.length)t.push([e]);else{var n=t[t.length-1];n[0].x===e.x?n.push(e):t.push([e])}}),t},Gu=function(e){return e.map(function(e){return e.type})},Wu=function(e,t,n){return e.filter(function(e){var r=e.x,a=e.y;return t[a][r]===n})},Ku=function(e,t){return e.filter(function(e){return e.x===t})},Xu=function(e,t){var n,r=[],a=Lu(e);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=i.x,s=i.y,c=t[s][o];c===_u.a?(r.push({x:o,y:s,type:Object(qu.b)(0)}),r.push({x:o+1,y:s,type:Object(qu.b)(1)})):c===_u.b?r.push({x:o,y:s,type:Object(qu.c)()}):r.push({x:o,y:s,type:c})}}catch(u){a.e(u)}finally{a.f()}return r},Qu=function(e,t){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Lu(zu);try{var i=function(){var a=n.value;if(e.some(function(e){return t[e.y][e.x]===a}))return{v:r?Vu(a):a}};for(a.s();!(n=a.n()).done;){var o=i();if("object"===typeof o)return o.v}}catch(s){a.e(s)}finally{a.f()}},Yu=function(e,t){var n={};return e.forEach(function(e){var r=Qu(e,t);n[r]||(n[r]=0),n[r]++}),n},Zu=Object(Us.a)(),$u=function(e){return e.reduce(function(e,t){return e[t.x]||(e[t.x]=[]),e[t.x].push(t),e},{})};Zu("delete",{blockNumber:"block to delete from"},"Deletes a cell in block inside the grid ");Zu("clearBlock",{blockNumber:"block to clear",ratio:"block to clear (0-1)"},"Deletes all cells in a block ");Zu("add",{blockNumber:"block to add to",position:"position to add it to",type:"type to add"},"Adds a cell to block at a certain position");var el=[Fu.j,Fu.e].map(function(e){return e.type}),tl=[Fu.f,Fu.g,Fu.h,Fu.a,Fu.i].map(function(e){return e.type}),nl=function(e,t,n){for(var r=0;r<t.length;r++){var a=t[r],i=a.x,o=a.y;if(rl(e[o][i].type,n.type))return{x:i,y:o}}},rl=function(e,t){return e===t||(!(!el.includes(e)||!el.includes(t))||!(!tl.includes(e)||!tl.includes(t)))};Zu("append",{blockNumber:"block to shift",type:"type to append [ACCENT, PIANO, PIANISSIMO, REST, REGULAR, LEGATO, STACCATO]"},"Shifts a block in grid by 1 to the right");function al(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return il(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return il(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function il(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Zu("shift",{blockNumber:"block to shift"},"Shifts a block in grid by 1 to the right");var ol=function(e,t,n,r,a,i){for(var o=function(r){if("-"===e[a][r-1])return"continue";e[a][r]||t.some(function(e){return e.x===r&&e.y===a})||n.some(function(e){return e.x===r&&e.y===a})||t.push({x:r,y:a})},s=r;s<i;s++)o(s)},sl=function(e,t){var n,r=$u(t),a=Object.keys(r).map(function(e){return parseInt(e)}),i=Math.max.apply(Math,Object(h.a)(a)),o=[],s=al(t);try{for(s.s();!(n=s.n()).done;){var c=n.value,u=c.x,l=c.y;"-"===e[l][u]?(ol(e,o,t,u,l+1,Math.max(u+2,i)),ol(e,o,t,u+2,l,Math.max(u+3,i))):ol(e,o,t,u,l,i)}}catch(p){s.e(p)}finally{s.f()}var f=[].concat(Object(h.a)(t),o);return f.sort(function(e,t){return e.x-t.x}),f},cl=function(e){for(var t=[],n=0;n<e.size;n++)t.push(Object(h.a)(e.cells[n]));e.savedCells=t},ul={clearBlock:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.cells,a=e.size,i=Hu(r,a);if(i&&!isNaN(t)){var o=(i=i.filter(function(e){return e.length>1}))[t%i.length];if(o){o=o.filter(function(e){var t=e.x,n=e.y;return r[n]&&"-"!==r[n][t]&&"."!==r[n][t]});var s=Math.floor(n*o.length);o.slice(0,s).forEach(function(t){var n=t.x,r=t.y;return e.set(n,r,!1)})}}},delete:function(e,t){var n=e.cells,r=e.size,a=Hu(n,r);if(a&&!isNaN(t)){var i=(a=a.filter(function(e){return e.length>1}))[t%a.length];if(i){var o=function(e){return e.reduce(function(e,t){return e[t.y]||(e[t.y]=[]),e[t.y].push(t),e},{})}(i=i.filter(function(e){var t=e.x,r=e.y;return n[r]&&"-"!==n[r][t]&&"."!==n[r][t]})),s=Object.keys(o).map(function(e){return parseInt(e)}),c=Math.max.apply(Math,Object(h.a)(s));if(o[c]){var u=o[c][0],l=u.x,f=u.y;e.set(l,f,!1)}}}},add:function(e,t,n,r){var a=e.cells,i=function(e,t){for(var n=[],r=function(e,t){return n.some(function(n){return n.some(function(n){return n.x===e&&n.y===t})})},a=function(n,r){var a=[],o=r,s=n;if(e[r][n]!==_u.a&&e[r][n]!==_u.b)for(var c=!1,u=r;u<t;u++){for(var l=n;l<t;l++){if(e[u][l]===_u.a||e[u][l]===_u.b){o=u,s=l,c=!0;break}if(!e[u][l]&&!e[u-1][l]&&!e[u-1][l-1])break}if(c)break}e[o][s]===_u.a?a=[{x:s-1,y:o-1},{x:s,y:o},{x:s+1,y:o},{x:s+2,y:o-1}]:e[o][s]===_u.b&&(a=[{x:s-1,y:o},{x:s,y:o+1},{x:s+1,y:o}]);for(var f=[],p=function(n){if(!e[r][n])return d=n,"break";if(f.push({x:n,y:r}),r>=t-1)return d=n,"continue";var a=i(n,r+1),o=[a],s=[a];if(e[r][n]===_u.a){var c=i(n+1,r+1);o.push(c),s.push(c)}for(var u=function(){var t=s.pop();if(0===t.length)return"continue";t.forEach(function(n){var r=i(n.x,t[0].y+1);if(r.length>0&&(o.push(r),s.push(r)),e[(n.x,t[0].y)]===_u.a){var a=i(n.x+1,t[0].y+1);a.length>0&&(o.push(a),s.push(a))}})};s.length>0;)u();o.forEach(function(e){return f=[].concat(Object(h.a)(f),Object(h.a)(e))}),e[r][n]===_u.a&&n++,d=n},d=n;d<t;d++){var m=p(d);if("break"===m)break}return f.forEach(function(e){a.some(function(t){return t.x==e.x&&t.y===e.y})||a.push(e)}),a},i=function(n,r,a){if(r>=t)return[];for(var i=[],o=function(t){return!!e[r][t]&&(i.push({x:t,y:r}),!0)},s=n;s<t&&o(s);s++)e[r][s]===_u.a&&s++;for(var c=n-1;c<=0&&(o(c)||e[r][c-1]===_u.a);c--);return i},o=0;o<t;o++)for(var s=0;s<t;s++)if(e[o][s]&&!r(s,o)){var c=a(s,o);n.push(c)}return n}(a,e.size),o=i[t%i.length];if(o&&r){var s=$u(o),c=Object.keys(s).map(function(e){return parseFloat(e)});if(void 0===n||-1===n){var u=1e3;for(var l in s)s[l].length<u&&(u=s[l].length,n=c.indexOf(parseInt(l)))}var f=c[n%c.length],p={type:r,value:""};if(void 0===f){var d=Qu(o,a),m=Wu(o,a,d)[0];if(m){var v=m.y,b=Math.max.apply(Math,Object(h.a)(o.map(function(e){return e.x})));"-"===d&&b===m.x&&b++,b++,e.set(b,v,p)}}else{var g=s[f=parseInt(f)],y=nl(e.cells,g,p);if(y)e.set(y.x,y.y,p);else{var k=Math.max.apply(Math,Object(h.a)(g.map(function(e){return e.y})))+1;e.set(f,k,p)}}}},append:function(e,t,n){var r=e.cells,a=e.size,i=Hu(r,a),o=i[t%i.length];if(o&&n){var s=$u(o),c=Object.keys(s).map(function(e){return parseInt(e)}),u={type:n,value:""},l=s[Math.max.apply(Math,Object(h.a)(c))][0],f=l.x,p=l.y;"-"===r[p][f]&&f++,f++,e.set(f,p,u)}},shift:function(e,t){var n=e.cells,r=e.size,a=Hu(n,r),i=a[t%a.length];if(i){var o=Qu(i,n);if(0!==(i=(i=sl(n,i)).filter(function(e){var t=e.x,r=e.y;return n[r][t]!==o})).length){for(var s=n[i[0].y][i[0].x],c=0;c<i.length;c+=1){i[c];var u=i[(c+1)%i.length],l=n[u.y][u.x];n[u.y][u.x-1]&&(s="-"===n[u.y][u.x-2]?n[u.y+1][u.x-1]:n[u.y][u.x-1]),n[u.y][u.x]=s,s=l}e.updateRedux(),e.calculateRules()}}},save:cl,restore:function(e){e.savedCells&&(e.cells=Object(h.a)(e.savedCells),cl(e),e.calculateRules(),e.updateRedux())}};function ll(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function fl(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return hl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hl(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function hl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pl(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function dl(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ml(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ml(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ml(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vl(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var bl=function(e){Object(u.a)(n,e);var t=vl(n);function n(e,r){var a;Object(o.a)(this,n),(a=t.call(this)).id=Object(j.uuid)(),a.subSequence=e,a.zObject=r,a.size=15,a.cells=[],a.symbols=[];for(var i=0;i<a.size;i++)a.cells.push(new Array(a.size).fill(!1));return a.newInlet(Xe.e,function(e){return a.onOperation(e[0])}),a.newOutlet(Xe.i),a.newInlet("save",function(){return a.save()}),a.newInlet("restore",function(e){var t=Object(Hr.a)(e,1)[0];return a.restore(t)}),a.newInlet("interpolate",function(e){var t=Object(Hr.a)(e,1)[0];return a.interpolate(t)}),a.newInlet("interpolation factor",function(e){var t=Object(Hr.a)(e,1)[0];isNaN(t)||(a.interpolationFactor=t)}),a.newOutlet("saved"),a.newOutlet("density"),a.interpolationFactor=.5,a}return Object(s.a)(n,[{key:"interpolate",value:function(e){if(!this.zObject.sequencerEngine.isLoading&&(this.lastStepNumber!==this.zObject.sequencerEngine.trackStep&&(this.operationsCount=0),!(this.operationsCount++>12))){this.lastStepNumber=this.zObject.sequencerEngine.trackStep;for(var t=0;t<e.length;t++)for(var n=e[t],r=0;r<n.length;r++){var a=n[r];Math.random()<this.interpolationFactor&&(this.cells[t][r]="object"===typeof a?Object(p.a)({},a):a)}this.updateRedux(),this.calculateRules()}}},{key:"current",get:function(){return this.cells},set:function(e){this.cells=e,this.calculateRules(),this.updateRedux()}},{key:"getCurrentCopy",value:function(){var e,t=[],n=dl(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.cells);try{for(n.s();!(e=n.n()).done;){var r,a=e.value,i=[],o=dl(a);try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push(!!s&&("string"===typeof s?s:Object(p.a)({},s)))}}catch(c){o.e(c)}finally{o.f()}t.push(i)}}catch(c){n.e(c)}finally{n.f()}return t}},{key:"getConnectedTidal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(Z.a)(Object(f.a)(n.prototype),"getConnectedTidal",this).call(this,e,"rules")}},{key:"set",value:function(e,t,n){e>=this.size||t>=this.size||(this.cells[t][e]=n,this.calculateRules(),this.updateRedux())}},{key:"drag",value:function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(e!==n||t!==r){var i=this.cells[t][e];return!this.cells[r][n]&&(this.cells[r][n]=i,this.cells[t][e]=!1,a&&(this.calculateRules(),this.updateRedux()),!0)}}},{key:"updateRedux",value:function(){this.zObject.dispatch(Object(C.Oc)(this.id,Object(h.a)(this.cells)))}},{key:"getParameters",value:function(){return[]}},{key:"getSelected",value:function(e){for(var t=e.x1,n=e.y1,r=e.x2,a=e.y2,i={},o=n;o<=a;o++)for(var s=t;s<=r;s++)this.cells[o][s]&&(i[s+","+o]=!0);return i}},{key:"getJson",value:function(){return{id:this.id,cells:this.cells}}},{key:"fromJson",value:function(e){e.id&&(this.id=e.id),e.cells&&(this.cells=e.cells,this.calculateRules())}}]),n}(function(e){return function(e){Object(u.a)(n,e);var t=Du(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).stack=[],e}return Object(s.a)(n,[{key:"save",value:function(){var e=this.getCurrentCopy();this.stack.push(e),this.updateRedux(),this.sendMessage("saved",this.getCurrentCopy())}},{key:"getCurrentCopy",value:function(){}},{key:"restore",value:function(e){if(Array.isArray(e))this.current=e;else if(0!==this.stack.length){var t=this.stack[this.stack.length-1];this.current=this.getCurrentCopy(t)}}}]),n}(e)}(function(e){return function(e){Object(u.a)(n,e);var t=ll(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).lastStepNumber=void 0,e.operationsCount=0,e}return Object(s.a)(n,[{key:"onOperation",value:function(e){if("string"===typeof e&&(this.lastStepNumber!==this.zObject.sequencerEngine.trackStep&&(this.operationsCount=0),!(this.operationsCount++>52))){var t=e.split(" ").filter(function(e){return""!==e}),n=t[0],r=t.slice(1).map(function(e){return Object(ae.a)(e)?parseFloat(e):e}),a=ul[n];a&&(a.apply(void 0,[this].concat(Object(h.a)(r))),this.lastStepNumber=this.zObject.sequencerEngine.trackStep)}}}]),n}(e)}(Object(Iu.a)(function(e){return function(e){Object(u.a)(n,e);var t=pl(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"calculateRules",value:function(){(new Date).getTime();var e=function(e,t){var n,r=function(t,n,r){var a=t.some(function(t){var n=t.x,r=t.y;return e[r][n]===_u.a});t.some(function(t){var n=t.x,r=t.y;return e[r][n]===_u.b}),(t=Xu(t,e)).sort(function(e,t){return e.x-t.x});var i=[],o=function(e,t,a){return e(t).every(n,r).always(Uu(Gu(a)))};if(a){var s=Wu(t,e,_u.a)[0],c=Ku(t,s.x-1);c.length>0&&i.push(o(Fu.o,Object(qu.b)(0),c));var u=Ku(t,s.x).filter(function(e){return Vu(e)!==_u.a});u.length>0&&i.push(o(Fu.r,Object(qu.b)(0),u));var l=Ku(t,s.x+1).filter(function(e){return Vu(e)!==_u.a});l.length>0&&i.push(o(Fu.r,Object(qu.b)(1),l));var f=t.filter(function(e){return e.x>s.x+1});if(f.length>0){var p,d=Ju(f).map(Gu).map(Uu);i.push((p=Object(Fu.l)(Object(qu.b)(1)).every(n,r)).series.apply(p,Object(h.a)(d)))}}else{var m=Qu(t,e,!1),v=Wu(t,e,m)[0];if(!v)return[];var b=Ku(t,v.x-1),g=Ku(t,v.x).filter(function(e){return Vu(e)!==m}),y=Ku(t,v.x+1),k=m===_u.b?Object(qu.c)():m;if(b.length>0&&i.push(o(Fu.o,k,b)),g.length>0&&i.push(o(Fu.r,k,g)),y.length>0){var O,j=Ju(y).map(Gu).map(Uu);i.push((O=Object(Fu.l)(k).every(n,r)).series.apply(O,Object(h.a)(j)))}}return i.forEach(function(e){return e.block=t}),i},a=Hu(e,t),i=[],o=Yu(a,e),s={},c=Lu(a);try{for(c.s();!(n=c.n()).done;){var u=n.value,l=Qu(u,e),f=s[l]||0;i=[].concat(Object(h.a)(i),Object(h.a)(r(u,o[l],f))),s[l]=f+1}}catch(p){c.e(p)}finally{c.f()}return i.push(Object(Fu.p)().always(Fu.i)),i}(this.cells,this.size);(new Date).getTime(),this.rules=e,this.sendMessage(Xe.i,e),this.sendMessage("density",this.getDensity())}},{key:"getDensity",value:function(){var e,t=0,n=0,r=fl(Hu(this.cells,this.size));try{for(r.s();!(e=r.n()).done;)t+=e.value.length,n+=5}catch(a){r.e(a)}finally{r.f()}return t/n}}]),n}(e)}(Object(wa.a)(function(){return function e(){Object(o.a)(this,e)}}()))))));function gl(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var yl=function(e){Object(u.a)(n,e);var t=gl(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).newInlet("choose",function(){return r.onChoose()}),r.newInlet("set probabilities",function(e){var t=Object(Hr.a)(e,1)[0];return r.setProbabilities(t)}),r.newOutlet("choice"),r.newOutlet("probabilities"),r.probabilities={rest:0,pianissimo:0,piano:0,regular:0,accent:0,staccato:0,legato:0,double:0,flam:0},r}return Object(s.a)(n,[{key:"setProbabilities",value:function(e){for(var t=Object.keys(this.probabilities),n=0;n<e.length;n++)this.setProbability(t[n],e[n]);this.probabilities=Object(p.a)({},this.probabilities)}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{probabilities:this.probabilities})}},{key:"fromJson",value:function(e){for(var t,r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];(t=Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this)).call.apply(t,[this,e].concat(a)),this.probabilities=e.probabilities}},{key:"setProbability",value:function(e,t){this.probabilities[e]=t,this.sendMessage("probabilities",Object.values(kl(this.probabilities)))}},{key:"onChoose",value:function(){var e=kl(this.probabilities),t=Math.random(),n=0;for(var r in e){if(t<n+e[r])return void this.sendMessage("choice",r);n+=e[r]}}}]),n}(xa),kl=function(e){var t=0;for(var n in e)t+=e[n];var r={};for(var a in e)r[a]=e[a]/t;return r};Object(Ea.a)("jgrid",{},"A grid based rule generator for the jaki object",function(e){return 0},{tags:"Rhythm",inlets:0,operationDocs:Zu,connects:{object:"jaki",inlet:"rules"}});Object(Ea.a)("jtypes",{},"Probabilistically choose a hit type based on user input",function(){return 0},{inlets:0});var Ol=n(280);function jl(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return wl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wl(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function wl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(Ea.a)("jpolygons",{tidals:""},"Converts Jaki object tidals into polygons to be rendered",void 0,{tags:"Rhythm"});var El=function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{x:e,y:e},o=arguments.length>6?arguments[6]:void 0;arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(null===o.transpose)return[void 0,void 0];var s=Pl(t,i,a,r),c=Pl((t+1)%n,i,a,r),u=Pl((t+2)%n,i,a,r),l=Pl((t+3)%n,i,a,r),f=Pl(Object(dn.a)(t-3,n),i,a,r),h=Pl(Object(dn.a)(t-2,n),i,a,r),p=Pl(Object(dn.a)(t-1,n),i,a,r),d=s,m=Object(Ol.a)(s,l,c,h),v=Object(Ol.a)(p,u,h,c),b=Object(Ol.a)(s,f,u,p),g=new Float32Array(8);return g[0]=d.x,g[1]=d.y,g[2]=m.x,g[3]=m.y,g[4]=v.x,g[5]=v.y,g[6]=b.x,g[7]=b.y,[Object($s.c)({x:e,y:e},v),g]},Sl=function(e,t,n,r,a,i){var o={x:e,y:e},s=Pl(n,o,r,a),c=Pl((n+1)%i,o,r,a),u=(Pl((n+2)%i,o,r,a),Pl((n+3)%i,o,r,a)),l=(Pl(Object(dn.a)(n-3,i),o,r,a),Pl(Object(dn.a)(n-2,i),o,r,a)),f=(Pl(Object(dn.a)(n-1,i),o,r,a),Object(Ol.a)(s,u,c,l)),h=new Float32Array(6);return h[0]=s.x,h[1]=s.y,h[2]=f.x,h[3]=f.y,h[4]=c.x,h[5]=c.y,h},Pl=function(e,t,n,r){r.flat(16);var a=r.length,i=2*Math.PI*e/a-.5*Math.PI;return{x:t.x+n*Math.cos(i),y:t.y+n*Math.sin(i),deg:i}};Object(Ea.a)("jhits",{"trigger-routing":"",tidals:""},"Outputs coords of triggers",void 0,{inlets:2});var xl=function(e){for(var t=void 0,n=[],r=0;r<e.length;r++){var a=e[r].cycle,i=t||Math.max(10,133-24*r);n.push(i);for(var o=a,s=o.length,c=0;c<o.length;c++){var u=o[c];Array.isArray(u)&&(u=u[0]);var l=El(140,c,s,a,i,{x:140,y:140},u),f=Object(Hr.a)(l,2),h=f[0];f[1];h&&(t=h)}}return n};Object(Ea.a)("jclock",{tidals:""},"Returns meshes for the clock hands",void 0,{inlets:1});function Tl(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Cl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Cl(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Cl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(Ea.a)("concat",{},"Concatenates the list arguments together",void 0,{tags:"List",inlets:function(e){return e},isHot:!0});Object(Ea.a)("lconcat",{},"Concatenates the list arguments together (lazily)",void 0,{tags:"List",inlets:function(e){return e}});Object(Ea.a)("list.prependIndex",{},"Prepends index at every element of inputted list");Object(Ea.a)("list.appendEvery",{toAppend:""},"Prepends index at every element of inputted list",function(){return 1},{inlets:2});Object(Ea.a)("listMax",{},"returns max number of list",function(){return 1},{inlets:1,tags:"List"});Object(Ea.a)("push",{length:"arg"},"Pushes msgs to beginning of list until length limit is met (First-in-first-out)",void 0,{tags:"List"});Object(Ea.a)("append",{length:"arg"},"Pushes msgs into list until limit (bang sends its stored list if needed)",void 0,{inlets:2,tags:"List"});Object(Ea.a)("appendList",{"list to append":"",limit:""},"Pushes msgs into list until limit",void 0,{inlets:2,tags:"List"});Object(Ea.a)("nth",{n:"n"},"Get nth element from list",void 0,{inlets:2,tags:"List",isHot:!0});Object(Ea.a)("map",{fn:""},"Applies function to each element of list",void 0,{tags:"List",inlets:["list","fn"]});Object(Ea.a)("interleaf",{value:"",position:""},"Interleaves a number every x many positions",void 0,{tags:"List",inlets:3});var Nl=function(e,t,n){var r;return function(e){var a=Object(Hr.a)(e,1)[0],i=kc(t)||0,o=kc(n)||2;if(ArrayBuffer.isView(a))return 0===a.length?a:[r=Rl(a,i,o,r)];if(Array.isArray(a)){for(var s=[],c=0;c<a.length;c++)c>0&&c%o===0&&s.push(i),s.push(a[c]);return a.length%o===0&&s.push(i),[s]}}},Rl=function(e,t,n,r){for(var a=e.length+Math.floor(e.length/n),i=r&&a.lengthh===r.length?r:new Float32Array(a),o=0,s=0;s<e.length;s++)s>0&&s%n===0&&(i[o++]=t),i[o++]=e[s];return e.length%n===0&&(i[i.length-1]=t),i};Object(Ea.a)("list",{},"Creates a list out of the inputed message (if possible",void 0,{tags:"List"});Object(Ea.a)("sublist",{},"Creates a list out of the inputed message (if possible",void 0,{tags:"List"});Object(Ea.a)("smokeVertices",{size:""},"Yo",void 0,{inlets:3});Object(Ea.a)("smokeColors",{size:""},"Yo");Object(Ea.a)("flattenList",{},"Flattens a list of lists",void 0,{tags:"List"});Object(Ea.a)("cList",{itemSize:""},"Turns a list into  [0,1,2,3]");Object(Ea.a)("list.partition",{list:"",size:""},"Partitions 1d list into groups based on size",void 0,{inlets:2});Object(Ea.a)("list.reverse",{list:""},"Reverse a list and outputs the reversed list out of outlet");Object(Ea.a)("list.indexOf",{},"Indexof in list",function(){return 1},{tags:"List",inlets:2,isHot:!0});Object(Ea.a)("fillArray",{val:"",start:"",end:"",length:""},"Fills a new array of given length from start to end with value",function(){return 1},{inlets:4});Object(Ea.a)("interleavedConcat",{lists:""},"Intereaves a list of lists");Object(Ea.a)("centerFillArray",{val:"",length:""},"Fills a new array of given length from start to end with value",function(){return 1},{inlets:2});Object(Ea.a)("listOsc",{"list of osc":""},"Returns a list for an oscilloscope ready to be thrown into a texture",function(){return 1},{inlets:1});Object(Ea.a)("sparseList",{"List of indices":"","Length of outputed list":"","Value to place in each slot":"","Chunk Size":"","Chunk Offset":"","Inputed Array":""},"Returns a list of given length w elements placed at indices of inputed list",function(){return 1},{inlets:6});Object(Ea.a)("singleSparseList",{"List of indices":"","Length of outputed list":"","Value to place in each slot":"","Chunk Size":"","Chunk Offset":"","Inputed Array":""},"Returns a list of given length w elements placed at indices of inputed list",function(){return 1},{inlets:5});Object(Ea.a)("sparseMerge",{},"Merges lists together into one list ",void 0,{tags:"List",inlets:function(e){return e},isHot:!0});function Ml(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Al(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Al(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Al(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(Ea.a)("polygonsToMeshes",{polygons:"",material:""},"Converts a list of polygon points to meshes",void 0,{tags:"Graphics",inlets:2});function ql(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Dl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dl(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Dl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Il=function(e){for(var t=e.tracks[0].patterns.length,n=[],r=0;r<t;r++)e.switchToPattern(r),n.push(e.length);return n},_l=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l,f,h,p,d,v,b,g;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.sequencerEngine).store.dispatch(Object(C.bd)("Freezing track's patterns")),e.next=4,Object(m.a)(100);case 4:return n.stop(),r=t.slots.filter(function(e){return e}),i=r[0].patterns.length,o=Il(n),n.switchToPattern(0),e.next=11,Object(Te.c)(n,t);case 11:return s=e.sent,e.next=14,Object(xe.a)(n,s,i,r);case 14:c=e.sent,u=Fl(t),l=u.frozenPad,f=u.frozenTracks,h=ql(r);try{for(h.s();!(p=h.n()).done;)d=p.value,n.deleteTrack(d.trackNumber)}catch(a){h.e(a)}finally{h.f()}v=n.addMultiFreezeTrack(),b=v.patterns.length;case 20:if(!(b<i)){e.next=26;break}return e.next=23,v.newPattern(!0);case 23:b++,e.next=20;break;case 26:for(v.freeze(c,!0),v.frozenPad=l,v.frozenTracks=f,g=0;g<i;g++)n.switchToPattern(g),v.currentPattern=g,v.pattern.changeLength(o[g]),v.frozenColumns[0].playing=g;n.switchToPattern(0),n.switchToPattern(n.currentPattern),n.store.dispatch(Object(C.bd)(void 0)),n.tracks.forEach(function(e){return e.trackIsLoading=!1});case 34:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Fl=function(e){var t,n=e.getJsonForPack(),r=[],a=ql(e.tracks);try{for(a.s();!(t=a.n()).done;){var i=t.value;r.push(!!i&&Object(N.a)(i))}}catch(o){a.e(o)}finally{a.f()}return{frozenPad:n,frozenTracks:r}};function Ll(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Bl=function(e){Object(u.a)(n,e);var t=Ll(n);function n(e){var r;return Object(o.a)(this,n),r=t.call(this,e),e.setAttribute("secondary-color","#cdcdcd"),e.setAttribute("primary-color","#b4b4b4"),e.newAttribute("slot-color"),e.newAttribute("slot-opacity"),e.newAttribute("Pads Per Row",3),e.newAttribute("Number of Pads",9,function(e){r.pad&&r.pad.onChangePadsCount(e)}),e.newAttribute("Show Track Names",!0),e.newAction("Clear Pattern",function(){return r.clearPattern()}),e.newAction("Freeze Pads",function(){return r.freezePads()}),r}return Object(s.a)(n,[{key:"clearPattern",value:function(){this.pad.slotTracks.forEach(function(e){return e.pattern.clear()}),this.sequencerEngine.updateTracks()}},{key:"isDeletable",value:function(){return this.pad&&0===this.pad.slots.filter(function(e){return e}).length}},{key:"dispose",value:function(){this.subSequence.deletePad(this.pad)}},{key:"freezePads",value:function(){_l(this.pad)}},{key:"linkPad",value:function(e){e&&(this.pad=e,this.pad.zObject=this.zObject,this.pad.onSizeChange(this.zObject.width,this.zObject.height))}},{key:"getJson",value:function(e){var t=Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this,e),r=void 0,a=void 0;if(e){var i=this.pad.getJsonForPack();r=[];for(var o=0;o<i.length;o++)r.push(i[o]);a=i.fx}return Object(p.a)({},t,{padId:this.pad.id,pad:r,fx:a})}},{key:"fromJson",value:function(e,t){var r=this;Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t);var a=e.padId,i=this.subSequence.getRootSubSequence?this.subSequence.getRootSubSequence():this.subSequence;e.pad?i.loadPackAsPads(e.pad,e.fx,this.pad).then(function(e){return r.linkPad(e)}):this.linkPad(i.pads.find(function(e){return e.id===a}))}}]),n}(xa);Object(Ea.a)("pad",{},"Drum pad for sounds",function(e){return 0},{inlets:0});Object(Ea.a)("zl",{mode:"mode"},"Concatenates the list arguments together",void 0,{isHot:!0});Object(Ea.a)("split",{min:"min",max:"max"},"Sends incoming msgs that are within a range out the left-inlet, and the rest through the right.",void 0,{tags:"Messages"});function zl(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}new Jc.a;Object(Ea.a)("comment",{},"Creates comment box");var Vl=function(e){Object(u.a)(n,e);var t=zl(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).text="",r}return Object(s.a)(n,[{key:"fromJson",value:function(e){this.text=e.text}},{key:"getJson",value:function(){return{text:this.text}}},{key:"getParameters",value:function(){return[]}}]),n}(xa);Object(Ea.a)("get",{field:"number"},"Gets field from meessage. I.E. get ",void 0,{tags:"Object Utilities"});Object(Ea.a)("set",{field:"number",value:"number"},"Sets field from message. I.E. set ",void 0,{tags:"Object Utilities"});function Hl(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Ul(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Jl=function(e){Object(u.a)(n,e);var t=Ul(n);function n(e,r,a){var i;return Object(o.a)(this,n),(i=t.call(this,e,r,a,"Instanced")).instanceObjectMapping={},i}return Object(s.a)(n,[{key:"fromJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];arguments.length>2&&arguments[2];return this.id=t?Object(j.uuid)():e.id,this.sequencerEngine.idToObject[this.id]=this,{}}},{key:"getJson",value:function(){return{id:this.id}}},{key:"dispose",value:function(){var e=this;this.implements&&(this.implements.instances=this.implements.instances.filter(function(t){return t!==e}))}},{key:"isDeletable",value:function(){return!0}}]),n}(function(e){return function(e){Object(u.a)(n,e);var t=Hl(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).objectRegistry={},e}return Object(s.a)(n,[{key:"registerObject",value:function(e,t){this.objectRegistry[e.id]=t}},{key:"lookupObject",value:function(e){return this.objectRegistry[e.id]}}]),n}(e)}(Nu));Object(Ea.a)("subpatch",{name:"Name of the subpatch"},"Creates an encapsulated patcher",function(){return 0},{inlets:[]});Object(Ea.a)("instancedSubpatch",{},"Creates an encapsulated patcher",function(){return 0},{inlets:[]});Object(Ea.a)("track",{},"Track object",function(){return 0},{inlets:0});Object(Ea.a)("counter",{min:"",max:""},"counts number of input messages received",function(){return 2},{tags:"Ticker",isHot:!0,inlets:["Input","Direction","Reset"]});Object(Ea.a)("simpleCounter",{value:"",min:"",max:""},"counts number of input messages received",void 0,{tags:"Ticker",isHot:!0,inlets:["decrement","increment","value"]});function Gl(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Wl=function(e){Object(u.a)(n,e);var t=Gl(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return n}(xa);Object(Ea.a)("varz",{},"View and control all variables nested inside patch",function(){return 0},{inlets:0});var Kl=1e-5;Object(Ea.a)("list.matrixMultiplyList",{"list of matrices (1&2)":""},"Takes 2 lists and multiples each pair of matrices together into a new list",function(){return 1},{isHot:!0,inlets:2});Object(Ea.a)("list.matrixMultiply",{"list of matrices 1":"","matrix of matrices 2":""},"Takes 2 lists and multiples each pair of matrices together into a new list",function(){return 1},{isHot:!0,inlets:2});function Xl(e,t){for(var n=e.length,r=e[0].length,a=(t.length,t[0].length),i=new Array(n),o=0;o<n;++o){i[o]=new Array(a);for(var s=0;s<a;++s){i[o][s]=0;for(var c=0;c<r;++c)i[o][s]+=e[o][c]*t[c][s],Math.abs(i[o][s]-0)<Kl&&(i[o][s]=0)}}return i}Object(Ea.a)("list.allIdentity",{"list of matrices 1":""},"Takes 2 lists and multiples each pair of matrices together into a new list",function(){return 1});var Ql=function(e){var t=Object(Hr.a)(e,3),n=t[0],r=t[1],a=t[2];return 1===n[0]&&0===n[1]&&0===n[2]&&0===r[0]&&1===r[1]&&0===r[2]&&0===a[0]&&0===a[1]&&1===a[2]},Yl={"list.matrixMultiply":function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0],r=t();if(!n&&r)return[r];if(!r)return[n];for(var a=[],i=0;i<n.length;i++){var o=n[i],s=r[i];if(o&&s){var c=Xl(o,s);a.push(c)}}return[a]}},"list.matrixMultiplyList":function(e){return function(e){var t=Object(Hr.a)(e,1)[0],n=Object(Hr.a)(t,2),r=n[0],a=n[1];if(!r&&a)return[a];if(!a)return[r];for(var i=[],o=0;o<r.length;o++){var s=r[o],c=a[o];if(s&&c){var u=Xl(s,c);i.push(u)}}return[i]}},"list.allIdentity":function(e){return function(e){var t=Object(Hr.a)(e,1)[0];if(Array.isArray(t))return t.every(function(e){return Ql(e)})?[0]:[t]}}},Zl=n(549);function $l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ef=function(e){Object(u.a)(n,e);var t=$l(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).color="#A19A9A",r.backgroundColor="#100B0B",r.fillColor="#757474",r.dotColor="#B5B5B5",r.newInlet("color",function(e){r.color=e[0]}),r.newInlet("backgroundColor",function(e){return r.backgroundColor=e[0]}),r.newInlet("fillColor",function(e){return r.fillColor=e[0]}),r.newInlet("dotColor",function(e){return r.dotColor=e[0]}),r}return n}(xa),tf=n(804),nf=n(806),rf=n(452);Object(Ea.a)("jaki",{},"Generative drums",["trigger-routing"],{inlets:[Xe.g,Xe.i,Xe.d],tags:"Rhythm",connects:[{outlet:Xe.p,object:"jgraphics",inlet:Xe.p},{outlet:"trigger-routing",object:"pad",inlet:"trigger-routing"}]});Object(Ea.a)("jparams",{},"Parameters for Jaki Object",void 0,{tags:"Rhythm",inlets:[],outlets:["params"],connects:{object:"jaki",inlet:"params"}});Object(Ea.a)("jrules",{},"Rules for Jaki Object",function(e){return 0},{});Object(Ea.a)("jfigures",{},"Figures for Jaki Object",["figures"],{tags:"Rhythm",connects:{object:"jaki",inlet:"figures"}});Object(Ea.a)("jgraphics",{},"Draws graphics for a Jaki object",void 0,{tags:"Rhythm",inlets:[Xe.p]});var af={jaki:function(e){var t=new q.a;t.loadDefaults(),t.velocity=.5,t.duration=1e6,e.needsTick=!0;var n=new Zl.a(e.subSequence,e);return e.effect=n,function(e){var r=Object(oi.a)(e),a=r[0],i=r.slice(1);switch(a){case Xe.o:var o=Object(Hr.a)(i,2),s=o[0],c=o[1];if(n.onNewStep(s,c),0===s){var u=new qe.a(t,c,s);n.input(u)}var l=n.output(c,s,s);return[[Xe.q,l]];case Xe.m:n.stop();break;case Xe.l:n.clear();break;case Xe.g:n.jakiParams=i[0];break;case Xe.i:var f=i[0];Array.isArray(f[0])?f.forEach(function(e,t){return n.rules[t].rules=e}):n.rules[0].rules=f;break;case Xe.d:n.figures=i[0]}}},jparams:function(e){var t=new tf.a(e.subSequence,e);return e.effect=t,e.needsStart=!0,function(e){return Object(Hr.a)(e,1)[0],t}},jrules:function(e){var t=new rf.a(e.subSequence,e);return e.width=340,e.height=240,t.width=340,t.height=240,e.effect=t,e.needsStart=!0,function(e){Object(Hr.a)(e,1)[0],t.publishRules()}},jfigures:function(e){var t=new nf.a(e.subSequence,e);return e.effect=t,e.needsLoad=!0,function(e){return Object(Hr.a)(e,1)[0],t}},jgraphics:function(e){var t=new ef(e);return e.effect=t,function(e){var n=Object(Hr.a)(e,2),r=n[0],a=n[1];switch(r){case Xe.p:t.tidals=a}}}};Object(Ea.a)("jwhen",{predicate:"predicate",action:"action"},"When predicate is met do action",void 0,{isHot:!0});Object(Ea.a)("jbefore",{predicate:"predicate",action:"action"},"When predicate is met do action",void 0,{isHot:!0});Object(Ea.a)("jafter",{predicate:"predicate",action:"action"},"When predicate is met do action",void 0,{isHot:!0});Object(Ea.a)("jotherwise",{action:"action"},"If no other predicates are met, do action",void 0,{isHot:!0});var of=function(e){switch(e){case"accent":return Fu.a;case"legato":return Fu.e;case"piano":return Fu.g;case"rest":return Fu.i;case"staccato":return Fu.j;case".":return Object(qu.c)();case"-":return Object(qu.b)(0);case"--":return Object(qu.b)(1);case"double":return Fu.c;case"flam":return Fu.d;case"after":return Fu.l;case"before":return Fu.o}},sf={jwhen:function(e,t,n){return function(){var e=of(t()),r=of(n());if(e&&r)return Object(Fu.r)(e).always(r)}},jotherwise:function(e,t){return function(){var e=of(t());if(e)return Object(Fu.p)().always(e)}},jafter:function(e,t,n){return function(){var e=of(t()),r=of(n());if(e&&r)return Object(Fu.l)(e).always(r)}},jbefore:function(e,t,n){return function(){var e=of(t()),r=of(n());if(e&&r)return Object(Fu.o)(e).always(r)}}};Object(Ea.a)("+",{},"Adds the inlets together outputting it from the outlet",void 0,{isHot:!0,inlets:2,tags:["Math"]});Object(Ea.a)("-",{},"Subtracts the 2nd inlet from the 1st, outputting it from the outlet",void 0,{isHot:!0,inlets:2,tags:["Math"]});Object(Ea.a)("*",{},"Multiplies the left and right inlets together",void 0,{isHot:!0,inlets:2,tags:["Math"]});Object(Ea.a)("/",{},"Divides the left and right inlets together",void 0,{isHot:!0,tags:["Math"],inlets:2});Object(Ea.a)("pow",{a:"",b:""},"Returns left inlet raised to power of right inlet",void 0,{inlets:2,isHot:!0,tags:["Math"]});Object(Ea.a)("sqrt",{},"Returns square-root of left inlet",void 0,{tags:["Math"]});Object(Ea.a)("sin",{},"Returns sine of left inlet",void 0,{tags:["Math"]});Object(Ea.a)("cos",{},"Returns cosine of left inlet",void 0,{tags:["Math"]});Object(Ea.a)("round",{},"Returns rounded value of left inlet",void 0,{tags:["Math"]});Object(Ea.a)("floor",{},"Returns floored value of left inlet",void 0,{tags:["Math"]});Object(Ea.a)("%",{a:""},"Returns remainder of the left-inlet divided by the right-inlet",void 0,{inlets:2,isHot:!0,tags:["Math"]});Object(Ea.a)("remainder",{a:""},"Returns remainder and divider of the left-inlet divided by the right-inlet",function(){return 2},{inlets:2,isHot:!0,tags:["Math"]});Object(Ea.a)("abs",{a:""},"Returns absolute value of the left-inlet",void 0,{inlets:1,tags:["Math"]});Object(Ea.a)("max",{a:"",b:""},"Returns max value of the left-inlet and right-inlet",void 0,{inlets:2,tags:["Math"]});Object(Ea.a)("min",{a:"",b:""},"Returns min value of the left-inlet and right-inlet",void 0,{inlets:2,tags:["Math"]});Object(Ea.a)("hexalist",{number:""},"Convert a number in base 10 to a list of numbers from 0-15 (i.e. hexa)",void 0,{inlets:1});Object(Ea.a)("clamp",{a:"",b:"",c:""},"Returns clamped value of inlet",void 0,{inlets:2,isHot:!0,tags:["Math"]});Object(Ea.a)("pi",{},"Returns value for pi when it receives a message");var cf={"+":function(e,t){return function(e){if(Array.isArray(e[0]))return[e[0].map(function(e,n){return Array.isArray(t())?isNaN(e)||isNaN(t()[n])?e:e+t()[n]:e+t()})];var n=t()+e[0];return isNaN(n)?1:n}},pi:function(e){return function(){return Math.PI}},min:function(e,t){return function(e){return Math.min(e[0],t())}},max:function(e,t){return function(e){return Math.max(e[0],t())}},clamp:function(e,t,n){return function(e){return Math.min(Math.max(e[0],t()),n())}},"-":function(e,t){return function(e){if(Array.isArray(e[0]))return[e[0].map(function(e,n){return Array.isArray(t())?e-t()[n]:e-t()})];var n=e[0]-t();return isNaN(n)?1:n}},"*":function(e,t){return function(e){if(Array.isArray(e[0]))return[e[0].map(function(e,n){return Array.isArray(t())?isNaN(e)||isNaN(t()[n%t().length])?e:e*t()[n%t().length]:isNaN(t())||isNaN(e)?e:e*t()})];var n=t()*e[0];return isNaN(n)?1:n}},"/":function(e,t){return function(e){if(Array.isArray(e[0]))return[e[0].map(function(e,n){return Array.isArray(t())?e/t()[n]:e/t()})];var n=e[0]/t();return isNaN(n)?1:n}},"%":function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0];if(Array.isArray(n)){var r=t();return[n.map(function(e){return Object(dn.a)(e,r)})]}return Object(dn.a)(n,t())}},pow:function(e,t){return function(e){var n=t();isNaN(n)&&(n=1);var r=e[0];return Array.isArray(r)?[r.map(function(e){return Math.pow(e,n)})]:Math.pow(e[0],n)}},sqrt:function(){return function(e){return Math.sqrt(e[0])}},round:function(){return function(e){var t=Math.round(e[0]);if(!isNaN(t))return t}},floor:function(){return function(e){var t=Math.floor(e[0]);if(!isNaN(t))return t}},abs:function(e){return function(e){return Array.isArray(e[0])?[e[0].map(function(e){return Math.abs(e)})]:Math.abs(e[0])}},hexalist:function(e){return function(e){for(var t=e[0].toString(16),n=[],r=0;r<t.length;r++)n.push(parseInt(t[r],16));return[n]}},remainder:function(e,t){return function(e){return[[Object(dn.a)(e[0],t()),Math.floor(e[0]/t())]]}},sin:function(){return function(e){return Math.sin(e[0])}},cos:function(){return function(e){return Math.cos(e[0])}}};Object(Ea.a)("pack",{args:"args"},"Creats a list out of the inlets",void 0,{tags:"List",inlets:function(e){return e}});Object(Ea.a)("packFull",{args:"args"},"Creats a list out of the inlets (once all inlets are full)",void 0,{tags:"List",isHot:!0,inlets:function(e){return e}});Object(Ea.a)("pak",{args:"args"},"Creates a list out of the inlets (all hot inlets)",void 0,{tags:"List",inlets:function(e){return e},isHot:!0});Object(Ea.a)("unpack",{args:"args"},"Send a list out individual outlets",function(e){return e},{tags:"List"});Object(Ea.a)("replacepak",{list:"override list",args:"args"},"Pak but allows overriding the list",void 0,{tags:"List",inlets:function(e){return e+1},isHot:!0});Object(Ea.a)("indexpack",{"index + value pair":""},"Inserts into stored list at index",function(){return 1},{inlets:function(e){return e+1}});Object(Ea.a)("select",{args:"args"},"Matches messages by arguments and sends them to the respective output",function(e){return e},{tags:"Messages"});Object(Ea.a)("between",{args:"args"},"Matches messages by arguments and sends them to the respective output",function(e){return e+1},{tags:"Messages"});Object(Ea.a)("nameIndex",{args:"args"},"");var uf=function(e,t){try{return parseFloat(e)===parseFloat(t)}catch(n){return e===t}};function lf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ff=function(e){Object(u.a)(n,e);var t=lf(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).x=.5,r.y=.5,r.newInlet("xy",function(e){var t=Object(Hr.a)(e,1)[0];return r.onXY(t)}),r.newOutlet("xy"),r}return Object(s.a)(n,[{key:"onXY",value:function(e){var t=Object(Hr.a)(e,2),n=t[0],r=t[1];this.setXY(n,r)}},{key:"sendCoordinates",value:function(){this.sendMessage("xy",[this.x,this.y])}},{key:"setXY",value:function(e,t){this.x=e,this.y=t,this.sendCoordinates()}},{key:"x",get:function(){return this._x},set:function(e){this._x=e}},{key:"y",get:function(){return this._y},set:function(e){this._y=e}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{x:this.x,y:this.y})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.x=e.x,this.y=e.y}}]),n}(xa);function hf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var pf=function(e){Object(u.a)(n,e);var t=hf(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).coordinates=[],r.numberOfCoordinates=0,r.newCoordinates(),r.newCoordinates(),r.newOutlet("coordinates"),r.zObject.newAttribute("x-axis","x"),r.zObject.newAttribute("y-axis","y"),r}return Object(s.a)(n,[{key:"newCoordinates",value:function(){this.zObject.newAttribute("coordinate-color-"+(this.numberOfCoordinates+1),"#ffffff"),this.zObject.newAttribute("coordinate-name-"+(this.numberOfCoordinates+1),"type name"),this.coordinates[this.numberOfCoordinates]={x:.5,y:.5},this.coordinates=Object(h.a)(this.coordinates),this.numberOfCoordinates++}},{key:"sendCoordinates",value:function(){this.sendMessage("coordinates",this.coordinates.map(function(e){return[e.x,e.y]}))}},{key:"setXY",value:function(e,t,n){this.coordinates[n]={x:e,y:t},this.sendCoordinates()}},{key:"getJson",value:function(){return Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{coordinates:this.coordinates,numberOfCoordinates:this.numberOfCoordinates})}},{key:"fromJson",value:function(e,t){Object(Z.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t),this.numberOfCoordinates=2,this.coordinates=e.coordinates}}]),n}(xa);Object(Ea.a)("interface.xy",{},"Interface for controlling 2 numbers using x/y plane",function(){return 0},{inlets:0});Object(Ea.a)("interface.multiXY",{},"Interface for controlling multiple pairs of 2 numbers using x/y plane",function(){return 0},{inlets:0});var df=n(254);Object(Ea.a)("record.mix",{"start/stop":"1 for start to for stop"},"Records the global mix to a file",function(){return 3});Object(Ea.a)("record.pause",{"start/stop":"1 for start to for stop"},"Records the global mix to a file",function(){return 3});var mf=Object(p.a)({"record.mix":function(e){var t=e.sequencerEngine.channelMixer;return function(n){var r=Object(Hr.a)(n,1)[0],o=t.recorderWorklet;o&&(0===r?(o.stop(),e.sendMessage(e.outputByNumber(2),Ra.a),o.getBuffer().then(function(){var t=Object(i.a)(a.a.mark(function t(n){var r,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(df.a)(n);case 2:return r=t.sent,t.next=5,gr.a.addArrayBuffer(r);case 5:i=t.sent,e.sendMessage(e.outputByNumber(0),i),e.sendMessage(e.outputByNumber(1),r);case 8:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())):1===r&&o.record())}},"record.pause":function(e){var t=e.sequencerEngine.channelMixer;return function(e){Object(Hr.a)(e,1)[0];var n=t.recorderWorklet;n&&n.stop()}},spore:function(e,t){return function(n){var r=Object(Hr.a)(n,1)[0];Object(Na.a)(r,t()).then(function(t){e.sendMessage(e.outputByNumber(0),t)})}},"interface.xy":function(e){new ff(e);return e.width=300,e.height=300,function(e){Object(Hr.a)(e,1)[0]}},"interface.multiXY":function(e){new pf(e);return e.width=300,e.height=300,function(e){Object(Hr.a)(e,1)[0]}},indexpack:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=void 0;return function(e){var t=Object(Hr.a)(e,1)[0],r=n.filter(function(e){return void 0!==e()&&null!==e()}).length;if(t.length===r)return[a=Object(h.a)(t)];var i=Object(Hr.a)(t,2),o=i[0],s=i[1];if(!a){a=new Array(r).fill(0);for(var c=0;c<a.length;c++)a[c]=n[c]()}return a[o]=s,[a]}},replacepak:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a;return e.lastMessageReceived=0,function(t){var r=Object(Hr.a)(t,1)[0];if(r!==a&&Array.isArray(r))return e.args=Object(h.a)(r),void(a=r);a=r;var i=n.map(function(e){return e()}).filter(function(e){return void 0!==e});return i=i.slice(0,i.length),[Object(h.a)(i)]}}},Ti,Fi,Sa,{concat:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=[];return function(e){if("bang"===e[0])return a;var t=n.map(function(e){return e()}).filter(function(e){return void 0!==e}).flatMap(function(e){return e}),r=e[0]||[];return Array.isArray(r)||(r=[r]),a=[[].concat(Object(h.a)(r),Object(h.a)(t))]}},"list.indexOf":function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0];if(!Array.isArray(n))return-1;var r=t();return n.indexOf(r)}},"list.prependIndex":function(e){return function(e){for(var t=Object(Hr.a)(e,1)[0],n=[],r=0;r<t.length;r++)Array.isArray(t[r])&&n.push([r].concat(Object(h.a)(t[r])));return[n]}},"list.appendEvery":function(e,t){return function(e){for(var n=Object(Hr.a)(e,1)[0],r=[],a=t(),i=0;i<n.length;i++)Array.isArray(n[i])&&(Array.isArray(a)?r.push([].concat(Object(h.a)(n[i]),[a[i]])):r.push([].concat(Object(h.a)(n[i]),[a])));return[r]}},fillArray:function(e,t,n,r){return function(e){for(var a=Object(Hr.a)(e,1)[0],i=new Array(r()).fill(0),o=t();o<n();o++)i[o]=a;return[i]}},listOsc:function(e){var t=void 0,n=void 0,r=void 0;return function(e){var a=Object(Hr.a)(e,1)[0];if(a&&(Array.isArray(a)||ArrayBuffer.isView(a))){t&&Math.pow(a.length,2)===t.length||(t=new Uint8Array(Math.pow(a.length,2)),n=new Uint8Array(Math.pow(a.length,2))),r&&t.set(n);for(var i=a.length,o=0;o<a.length;o++){var s=a[o],c=Math.floor(Math.abs(s)*i/2);if(s<0)for(var u=i/2;u>i/2-c;u--)t[u*i+o]=100;else for(var l=i/2;l<i/2+c;l++)t[l*i+o]=100}return r=a,t}}},centerFillArray:function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0],r=new Array(t()).fill(0),a=Math.floor(Math.abs(n)*t()/2),i=0;if(n<0)for(var o=t()/2;o>t()/2-a;o--)r[o]=i++/a*100;else for(var s=t()/2;s<t()/2+a;s++)r[s]=i++/a*100;return r}},icon:function(e){new Ca(e);return function(){}},interleavedConcat:function(){var e=[];return function(t){var n=Object(Hr.a)(t,1)[0];if(!Array.isArray(n))return[];e.length=0;for(var r=0;r<n[0].length;r++){var a,i=Tl(n);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.push(o[r])}}catch(s){i.e(s)}finally{i.f()}}return[e]}},between:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(e){var t=Object(Hr.a)(e,1)[0];if(t<n[0]()){var r=new Array(n.length).fill(void 0);return r[0]=t,r}for(var a=n.filter(function(e){return e()}).length,i=0;i<a-1;i++){var o=n[i](),s=n[i+1]();if(o<=t&&t<s){var c=new Array(n.length).fill(void 0);return c[i+1]=t,c}}if(t>=n[a-1]()){var u=new Array(n.length).fill(void 0);return u[a]=t,u}}},nameIndex:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(e){var t=Object(Hr.a)(e,1)[0];return n.map(function(e){return e()}).indexOf(t)}},interleaf:Nl,"list.reverse":function(e){return function(e){var t=Object(Hr.a)(e,1)[0];return(t=Object(h.a)(t)).reverse(),[t]}},playback:function(e){new ji(e);return function(){}}},gi,{nth:function(e,t){return function(e){return e[0][t()%e[0].length]}},"document.title":function(){return function(e){var t=Object(Hr.a)(e,1)[0];window.document.title=t}},uniqueAppend:function(e,t){var n=[];return function(e){var r=Object(Hr.a)(e,1)[0];"object"!==typeof r[0]&&(r=[r]);var a,i=ss(r);try{for(i.s();!(a=i.n()).done;){for(var o=a.value,s=-1,c=0;c<n.length;c++)o.id===n[c].id&&(s=c);-1===s&&n.length<(t()||1)?n.push(o):n[s]=o,n.length>(t()||1)&&n.shift()}}catch(u){i.e(u)}finally{i.f()}if(n.length===(t()||1))return[n]}},modal:function(e,t,n,r,a,i){return function(o){if(Object(Hr.a)(o,1)[0]){var s=void 0,c=a(),u=i();if(Array.isArray(c)){s=[];for(var l=0;l<c.length;l++)s.push({text:c[l],url:u[l]})}else c&&u&&(s={text:c,url:u});e.dispatch(Object(C.Wh)({zobject:e,text:t(),link:s,okButtonText:n(),cancelButtonText:r()}))}else e.dispatch(Object(C.Wh)(void 0))}},progressbar:function(e,t){return function(n){Object(Hr.a)(n,1)[0]?e.dispatch(Object(C.Xh)(t())):e.dispatch(Object(C.Xh)(void 0))}},centroid:rc,"erc720.tokenID":function(e){return e.needsLoad=!0,function(t){return Object(Hr.a)(t,1)[0],[e.sequencerEngine.tokenID]}},"list.partition":function(e,t){return function(e){for(var n=Object(Hr.a)(e,1)[0],r=[],a=[],i=0;i<n.length;i++)a.length>0&&i%t()===0&&a.push(r),r.push(n[i]);return[a]}},messageSplitter:function(e){return function(t){for(var n=Object(oi.a)(t).slice(0),r=0;r<n.length;r++)e.sendMessage(e.outputByNumber(r),n[r])}},"three.planeRenderer":function(e){e.needsLoad=!0;var t=new Nu(e.subSequence,e.sequencerEngine,e,"planeRenderer"),n=t.createZObject(0,0,"three.planeGeometry"),r=t.createZObject(0,0,"three.orthographicCamera 0 150 0 150 -1 1"),a=t.createZObject(0,0,"three.scene"),i=t.createZObject(0,0,"three.mesh"),o=t.createZObject(0,0,"three.render");o.connectInlet("camera",r,"Output 1"),o.connectInlet("Input",a,"Output 1"),a.connectInlet("Input",i,"Output 1"),i.connectInlet("geometry",i,"Output 1");var s=new Ha(t,void 0,function(t){e.sendMessage(e.outputByNumber(0),t)});return s.connectInlet("Input",o,"Output 1"),console.log(s),function(e){var t=Object(Hr.a)(e,1)[0];if("dispose"!==t)return"start"===t?(n.bang(),void r.bang()):void(i.args&&t&&(n.bang(),r.bang(),i.lastMessageReceived=[n.geometry],i.onArg(1,[t])))}},messageFilter:function(e,t){return function(e){if(t())return e}},"haptic.vibrate":function(e){return function(e){var t=Object(Hr.a)(e,1)[0];"vibrate"in navigator&&navigator.vibrate(t)}},matrix:function(e){e.updates=0;var t=function(t,n){e.matrix=new Array(n);for(var r=0;r<n;r++)e.matrix[r]=new Array(t).fill(0);e.updates++};return t(5,5),function(n){var r=Object(Hr.a)(n,1)[0];if("string"===typeof r){var a=function(e){var t=e.split(" ");return[t[0],t.slice(1).map(function(e){return parseFloat(e)})]}(r),i=Object(Hr.a)(a,2),o=i[0],s=i[1];switch(o){case"set":return void(e.matrix[s[1]]&&s[0]<e.matrix[s[1]].length&&(e.matrix[s[1]][s[0]]=s[2],e.updates++));case"values":for(var c=[],u=0;u<e.matrix.length;u++)for(var l=e.matrix[u],f=0;f<l.length;f++)l[f]===s[0]&&c.push([f,u]);return[c];case"closests":for(var h=[],p=e.matrix[s[1]][s[0]],d=0;d<e.matrix.length;d++)for(var m=e.matrix[d],v=0;v<m.length;v++)if(v!==s[0]&&d!==s[1]){var b=m[v];h.push([v,d,Math.abs(b-p)])}return h.sort(function(e,t){return e[2]-t[2]}),[h.map(function(e){var t=Object(Hr.a)(e,2);return[t[0],t[1]]})];case"get":if(e.matrix[s[1]])return[e.matrix[s[1]][s[0]]];break;case"init":return void t(s[0],s[1])}}}},globalReverse:function(e){return function(t){var n=Object(Hr.a)(t,1)[0];e.sequencerEngine.reverse=!!n}},loop:function(e,t){return function(n){var r=Object(Hr.a)(n,1)[0],a=t()||0;0===a&&(r=!1),a=Math.pow(2,a)/8,r?e.sequencerEngine.startNewLoop(a):e.sequencerEngine.looping=!1}},push:function(e,t){var n=[];return function(e){return n.unshift(e[0]),n.length>t()&&n.pop(),[n]}},"gl.material":function(e,t){var n=new Gi(e);e.needsHotReload=!0,e.shader=n,e._effect=void 0,n.onVertexShader("\nvoid main() {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(\n    position, \n    1.0 );\n  \n}\n");var r=Ki(e),a=0;return function(i){var o=Object(Hr.a)(i,1)[0];if("bang"!==o){if(o.code){var s=t()||[300,300];Array.isArray(s)||(s=[300,300]);var c=s,u=Object(Hr.a)(c,2),l=u[0],f=u[1];o.uniforms.width={value:l},o.uniforms.height={value:f};var h=r(o,n);if(h!==n.fragmentShader&&!e.sequencerEngine.isLoading){var p=++a;setTimeout(function(){if(p===a){Xi(n.fragmentShader,h);console.log("COMPILING uni=%s iteration=%s",Object.keys(o.uniforms).length,Wi++),window.compiledCode=h,window.compiledUniforms=o.uniforms,n.onFragmentShader(h),e.sendMessage(e.outputByNumber(0),n.material)}},50)}}}else e.sendMessage(e.outputByNumber(0),n.material)}},vec3:function(e){var t=new Ga(e);return e.needsLoad=!0,function(){t.sendObject()}},vec2:function(e){var t=new ii(e);return e.needsLoad=!0,function(){t.sendObject()}},buttonPresser:function(e){new Aa(e);return e.newAttribute("button-color","#ffffff"),e.width=50,e.height=50,function(){}},groups:function(e){new Pi(e);return function(){}}},di,{select:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(e){for(var t=0;t<n.length;t++){var r=n[t]();if(uf(r,e[0])){var a=new Array(n.length).fill(void 0);return a[t]=e,a}}}}},xi,os,{attributes:function(e){var t=new qi(e);return e.needsLoad=!0,function(e){return Object(Hr.a)(e,1)[0],t.loadBang(),[]}}},Ps,{varz:function(e){return new Wl(e),function(){}},toggle:function(e){var t=new Ss(e);return e.needsLoad=!0,e.width=50,e.height=50,function(e){var n=Object(Hr.a)(e,1)[0];"start"===n&&t.onInput(n)}},sparseList:function(e,t,n,r,a,i){return function(e){var o=Object(Hr.a)(e,1)[0],s=n()||100;Array.isArray(s)||(s=[s]);var c=r()||1,u=a()||[0],l=Math.round(t()*c);if(!isNaN(l)){var f,p=(i()?Object(h.a)(i()):void 0)||new Array(l).fill(0),d=Tl(o);try{for(d.s();!(f=d.n()).done;){var m,v=f.value,b=0,g=Tl(u);try{for(g.s();!(m=g.n()).done;){var y=m.value;p[parseInt(v)*c+y]=s[b%s.length],b++}}catch(k){g.e(k)}finally{g.f()}}}catch(k){d.e(k)}finally{d.f()}return[p]}}},singleSparseList:function(e,t,n,r,a){return function(e){var i=Object(Hr.a)(e,1)[0],o=r()||1,s=a()||[0];Array.isArray(s)||(s=[s]);var c=Math.round(t()*o);if(!isNaN(c)){var u,l=new Array(c).fill(0),f=Tl(i);try{for(f.s();!(u=f.n()).done;){var h,p=u.value,d=Tl(s);try{for(d.s();!(h=d.n()).done;){var m=h.value;l[parseInt(p)*o+m]=n()}}catch(v){d.e(v)}finally{d.f()}}}catch(v){f.e(v)}finally{f.f()}return[l]}}},smokeColors:function(e){var t;return function(e){var n=Object(Hr.a)(e,1)[0];t||(t=new Float32Array(3*n.length));for(var r=0;r<n.length;r++){var a=Math.min(1,10*n[r]);t[3*r]=a,t[3*r+1]=a,t[3*r+2]=a}return[t]}},submix:function(e){new ls(e);return function(){}},mixbuttons:function(e){new hs(e);return function(){}},loadBang:function(e){return e.needsLoad=!0,function(){return["bang"]}},startBang:function(e){return e.needsStart=!0,function(){return["bang"]}},average:function(e){return function(e){var t=Object(Hr.a)(e,1)[0],n=0;if(!t)return 0;for(var r=0;r<t.length;r++)n+=t[r];return n/t.length}},roll:function(e){new ds(e);return function(){}},macro:function(e){var t=new Hs(e);return e.needsLoad=!0,function(e){Object(Hr.a)(e,1)[0],t.sendMessage("value changed",t.value)}},mouseSDF:function(e,t,n,r,a){return function(e){var i=Object(Hr.a)(e,1)[0],o=t(),s=n(),c=r()||0,u=a();if(s&&u&&o&&i){var l=[(2*i[0]-u[0])/u[1],(2*i[1]-u[1])/u[1]];l=[l[0]-o[0],l[1]-o[1]];var f=[Math.abs(l[0])-s[0]+c,Math.abs(l[1])-s[1]+c];return Math.min(Math.max(f[0],f[1]),0)+Math.sqrt(Math.pow(Math.max(0,f[0]),2)+Math.pow(Math.max(0,f[1]),2))-c}}},triangulate:function(e,t){return function(e){var n=e[0];if(n&&t())return[Object(zc.c)(n,t())]}},print:function(){return function(e){var t=Object(Hr.a)(e,1)[0];return console.log(t)}},averageDistance:function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0],r=t(),a=0;if(!n||!r)return 0;for(var i=0;i<n.length;i+=2){var o=n[i],s=n[i+1],c=r[i],u=r[i+1];a+=Math.sqrt(Math.pow(o-c,2)+Math.pow(s-u,2))}return a/(n.length/2)}},dpad:function(e){var t=new Ms(e);return e.effect=t,function(){}},system5:function(e){return e.effect=new vs(e),function(){}},sampleBank:function(e){return e.effect=new ks(e),function(){}},drawTriangles:function(e,t){return function(n){var r=n[0],a=t()||"#ffffff";e.sendMessage(e.outputByNumber(0),"drawTriangles",a,r)}},jrepl:function(e){new Fs(e);return function(){}},cirklon:function(e){return e.effect=new qs(e),function(){}},patterns:function(e){return e.effect=new Is(e),function(){}},store:function(e,t){return function(e){if("bang"===Object(Hr.a)(e,1)[0]){if(void 0===t())return;return[t()]}}},drawArray:function(e,t,n){return function(r){var a=r[0],i=t()||2,o=n()||"#ffffff";e.sendMessage(e.outputByNumber(0),"drawArray",i,o,a)}},polygonsToMeshes:function(e,t){var n=[],r=[],a=[],i=[];return function(o){var s=Object(Hr.a)(o,1)[0];if(s){var c,u=0,l=[],f=Ml(s);try{var h=function(){var e=c.value,o=Nl(0,0,2)([e]),s=Bc()([e]);i[u]=s&&s[0];var f=u;n[u]||(n[u]=Sc(0,void 0,function(){return i[f]}));var h=n[u](o);if(h){a[u]||(a[u]=Oc(0,function(){return t()}));var p=a[u](h);p&&(l.push(p[0]),r.push(p[0]))}u++};for(f.s();!(c=f.n()).done;)h()}catch(g){f.e(g)}finally{f.f()}var p,d=[],m=[],v=Ml(r);try{for(v.s();!(p=v.n()).done;){var b=p.value;l.includes(b)?m.push(b):d.push(b)}}catch(g){v.e(g)}finally{v.f()}return r=m,e.sendMessage.apply(e,[e.outputByNumber(0),"remove"].concat(d)),[l]}}},triangle:function(e,t,n,r){return function(a){var i=a[0],o=t(),s=n();i&&o&&s&&(e.sendMessage(e.outputByNumber(0),"triangle ".concat(i.x," ").concat(i.y," ").concat(o.x," ").concat(o.y," ").concat(s.x," ").concat(s.y)),e.sendMessage(e.outputByNumber(0),"fill ".concat(r())))}},synthcontrol:function(e){var t=new Vi(e);return e.needsLoad=!0,function(){t.sendADSRLevels(),t.sendOscillatorLevels()}},switch:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,i;return function(e){var t=Object(Hr.a)(e,1)[0]-1;if(n[t]){var r=n[t]();if(a!==t||i!==r)return i=r,a=t,[r];i=r,a=t}}},outSwitch:function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0],r=t(),a=new Array(r).fill(void 0);return a[r-1]=n,a}},dedupe:function(e){var t;return function(e){var n=Object(Hr.a)(e,1)[0];if(n!==t)return t=n,[n]}},messageFilterLazy:function(e,t){return function(e){if(t())return e}},jpolygons:function(e){return e.width=280,e.height=280,function(e){var t=Object(Hr.a)(e,1)[0];if(t.some(function(e){return e.needsUpdate})){t.forEach(function(e){return e.needsUpdate=!1}),t=t.filter(function(e){return e.inUse||e.lastUsed<1});for(var n=[],r=void 0,a=0;a<t.length;a++)for(var i=t[a].cycle,o=r||Math.max(10,133-24*a),s=i,c=s.length,u=0;u<s.length;u++){var l=s[u];Array.isArray(l)&&(l=l[0]);var f=El(140,u,c,i,o,{x:140,y:140},l),h=Object(Hr.a)(f,2),p=h[0],d=h[1];if(d&&n.push(d),p&&(r=p),l.type&&"-"===l.type.type&&0===l.type.value){var m=Sl(140,l,u,o,i,c);m&&n.push(m)}}return[n]}}},jhits:function(e,t){var n=[];return function(e){var r=e[0]&&e[0][1];if(r){var a=t();if(a){var i=xl(a),o=[];r.length>0&&r.map(function(e){return 6-e.outputNumber});var s,c=[],u=jl(n);try{for(u.s();!(s=u.n()).done;){var l=s.value,f=l.x,h=l.y,p=l.duration;p-=.5,l.duration=p,p>0&&(o.push(f),o.push(h),c.push(l))}}catch(O){u.e(O)}finally{u.f()}n=c;var d,m=jl(r);try{for(m.s();!(d=m.n()).done;){var v=d.value,b=v.outputNumber-1,g=Pl(v.stepData.leafNumber,{x:140,y:140},i[b],a[b].cycle,!0),y=g.x,k=g.y;o.push(y),o.push(k),n.push({x:y,y:k,duration:v.stepData.duration})}}catch(O){m.e(O)}finally{m.f()}return Float32Array.from(o)}}}},jclock:function(e){var t=new Di.r({color:16777215}),n=[];return function(e){var r=Object(Hr.a)(e,1)[0];if(r){for(var a=xl(r),i=0;i<r.length;i++)for(var o=r[i],s=o.cycle.flat(16),c=0;c<s.length;c++){var u=s[c];if(o.currentCycles&&o.currentCycles[u.id]){var l=Pl(c,{x:140,y:140},a[i],s).deg,f=new Di.n(140,140,a[i],a[i],1.5*Math.PI,l,!1,0).getSpacedPoints(c);if(n[i])n[i].geometry.setFromPoints(f),n[i].geometry.attributes.position.needsUpdate=!0;else{var h=(new Di.f).setFromPoints(f),p=new Di.q(h,t);n[i]=p}break}}return[n]}}},ztracker:function(e){return e.effect=new js(e),function(){}},coords:function(e,t){return function(e){return{x:e[0],y:t()}}},rasterTriangle:function(e,t,n,r){return function(e){var a=e[0];if(a&&t()&&n()&&r())return[Object(Vc.b)([a,t(),n()],Math.max(5,r()))]}},tidal:function(e){e.needsTick=!0;var t=new ws.a(e.subSequence,void 0,e);t.subSequence=e.subSequence,e.effect=t;var n=new q.a;return n.loadDefaults(),n.velocity=.5,n.duration=1e6,function(r){var a=Object(oi.a)(r),i=a[0],o=a.slice(1);switch(i){case"restart":break;case Xe.o:var s=Object(Hr.a)(o,2),c=s[0],u=s[1];if(t.onNewStep(c,u),0===c){var l=new qe.a(n,u,c);t.input(l)}var f=t.output(u,c,c);f.forEach(function(e){e.stepData.time=e.time,e.stepData.stepNumber=e.stepNumber,e.outputNumber=1}),f.forEach(function(t){var n=t.stepData;e.sendMessage(e.outputByNumber(0),n)})}}},outputNumber:function(e,t){return function(e){var n=Object(Hr.a)(e,1)[0];if(n[0]===Xe.q){var r=n[1];return r=r.map(function(e){return Object(p.a)({},e,{outputNumber:t()||1})}),[[Xe.q,r]]}}},rasterTriangles:function(e,t){return function(e){var n=t()||4,r=e[0];if(r&&n){var a=function(){for(var e=[],t=0;t<r.length;t+=6){var a=r.slice(t,t+6);Object(Vc.b)(a,Math.max(1,n)).forEach(function(t){return e.push(t)})}return{v:[e]}}();if("object"===typeof a)return a.v}}},metro:function(e,t){return e.needsTick=!0,function(e){return Xe.a}},syncedMetro:function(e,t){return e.needsTick=!0,function(t){var n=Object(Hr.a)(t,3),r=n[0],a=(n[1],n[2]);"tick"===r&&setTimeout(function(){e.sendMessage(e.outputByNumber(0),Xe.a)},1e3*(a-H.a.Master.context.currentTime))}},setInterval:function(e,t){var n=window.setInterval(function(){e&&e.function&&e.bang()},80);return function(e){if("dispose"!==e[0])return Xe.a;clearInterval(n)}},setIntervalFast:function(e,t){var n=window.setInterval(function(){e&&e.function&&e.bang()},15);return function(e){if("dispose"!==e[0])return Xe.a;clearInterval(n)}},lconcat:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=[];return function(e){if("bang"===e[0])return a;var t=n.map(function(e){return e()}).filter(function(e){return void 0!==e}).flatMap(function(e){return e}),r=e[0]||[];return Array.isArray(r)||(r=[r]),a=[[].concat(Object(h.a)(r),Object(h.a)(t))]}},jsnapshot:function(e){new Ns(e);return function(){}},counter:function(e,t,n){var r=0,a=1;return e.needsStart=!0,e.setAttribute("Send min on load",!0,function(e){}),function(e){var i=Object(Hr.a)(e,2),o=i[0],s=i[1];switch(o){case Xe.l:return void(r=t());case"Direction":return void(a=s);case"Reset":return[r=t()]}return(r+=a)>=n()?[r=t()+r-n(),"bang"]:r}},simpleCounter:function(e,t,n,r){var a=void 0;return function(e){void 0===a&&(a=t()||0);var i=Object(Hr.a)(e,2),o=i[0],s=i[1];switch(o){case"decrement":return--a<n()&&(a=n()),[a];case"increment":return++a>r()&&(a=r()),[a];case"value":return[a=s]}return a}}},Qs,{canvas:function(e){var t=new Tc(e);return e.effect=t,e.width=300,e.height=300,function(){}}},Fc,Pc,dc,Lc,fc,Zs,jc,yc,{script:function(e){var t=new Xs(e);return t.width=350,t.height=350,e.effect=t,e.needsLoad=!0,function(){t.code=t.code}},float32Array:function(e){return function(e){var t=Object(Hr.a)(e,1)[0];return[Float32Array.from(t)]}},map:function(e,t){var n;return function(t){var r=Object(Hr.a)(t,2),a=(r[0],r[1]);if(a&&(Array.isArray(a)||ArrayBuffer.isView(a))){var i=e.inlets.fn;if(i){var o=i.connections[0].sourceNode;if(ArrayBuffer.isView(a)){n||(n=new Float32Array(a.length));for(var s=0;s<a.length;s++){var c=a[s],u=o.evaluateAsFunction?o.evaluateAsFunction(c,s):o.function([c]);n[s]=u}}else n=a.map(function(e,t){return o.evaluateAsFunction?o.evaluateAsFunction(e,t):o.function([e])});return[n]}}}},spline:function(e,t,n){var r,a=void 0,i=[];return function(e){var o=Object(Hr.a)(e,1)[0];if(ArrayBuffer.isView(o)||Array.isArray(o)){i.length=0;for(var s=0;s<o.length;s+=2)i.push(new Di.P(o[s],o[s+1],0));a?(a.tension=t()||1,a.points=i):a=new Di.g(i,!0,"catmullrom",t()||1);var c=a.getPoints(n()||150),u=0;r&&2*c.length===r.length||(r=new Float32Array(2*c.length));var l,f=hc(c);try{for(f.s();!(l=f.n()).done;){var h=l.value;r[u++]=h.x,r[u++]=h.y}}catch(p){f.e(p)}finally{f.f()}return r}return[r]}},convexHull:function(){return function(e){var t=Object(Hr.a)(e,1)[0];return[Object($s.a)(t)]}},smokeVertices:function(e,t,n){var r;return function(e){var n=Object(Hr.a)(e,1)[0],a=t()||300,i=t()||300;return r||(r=new Float32Array(new Array(n.length).fill(0).flatMap(function(e,t){var n=t%66;return[a*(n/64),i*((t-n)/66/64),0]})))}},flattenList:function(e){return function(e){var t=Object(Hr.a)(e,1)[0];if(Array.isArray(t))return[t.flat(16)]}},cList:function(e,t){return function(e){for(var n=Object(Hr.a)(e,1)[0],r=[],a=0;a<n.length;a+=t())r.push(a/t());return[Float32Array.from(r)]}},listMax:function(e){return function(e){var t=Object(Hr.a)(e,1)[0];return[Math.max.apply(Math,Object(h.a)(t))]}},pack:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(e){var t=n.map(function(e){return e()}).filter(function(e){return void 0!==e});return t=t.slice(0,t.length-1),[[].concat(Object(h.a)(e),Object(h.a)(t))]}},packFull:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(e){var t=n.map(function(e){return e()}).filter(function(e){return void 0!==e});if(!(t=t.slice(0,t.length-1)).some(function(e){return!e}))return[[].concat(Object(h.a)(e),Object(h.a)(t))]}},pak:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(e){var t=n.map(function(e){return e()}).filter(function(e){return void 0!==e});return t=t.slice(0,t.length-1),[[].concat(Object(h.a)(e),Object(h.a)(t))]}},nft:function(e){var t=new Au(e);return e.effect=t,e.needsNFT=!0,function(e){switch(Object(Hr.a)(e,1)[0]){case Xe.f:t.startUp();break;default:t.execute()}}},append:function(e,t){var n=[];return function(e){if("bang"===e[0])return[n];for(n.push(e[0]);n.length>t();)n.shift();return[n]}},appendList:function(e,t){var n=[];return function(e){Array.isArray(e[0])||(e[0]=[e[0]]);var r,a=Tl(e[0]);try{for(a.s();!(r=a.n()).done;){var i=r.value;n.push(i)}}catch(o){a.e(o)}finally{a.f()}for(;n.length>t();)n.shift();return[n]}},pad:function(e){var t=new Bl(e);return t.zObject=e,e.effect=t,e.width=201,e.height=227,e.needsStart=!0,e.needsLoad=!0,function(t){Object(Hr.a)(t,1)[0],e.effect.pad&&(e.effect.pad.onSizeChange(e.width,e.height),e.effect.pad.sendTags())}},unpack:function(e){return function(e){return e[0]}},subpatch:function(e,t){var n=new Nu(e.subSequence,e.sequencerEngine,e,t);return e.effect=n,e.isSubPatch=!0,function(){}},instancedSubpatch:function(e){var t=new Jl(e.subSequence,e.sequencerEngine,e);return e.effect=t,e.isSubPatch=!0,function(){}},split:function(e,t,n){return function(e){return e=e[0],t()<=e&&e<=n()?[e]:[void 0,e]}},jgrid:function(e){var t=new bl(e.subSequence,e);return e.width=360,e.height=360,e.effect=t,e.needsLoad=!0,function(e){var n=Object(oi.a)(e),r=n[0];switch(n.slice(1),r){case Xe.l:t.calculateRules()}}},jtypes:function(e){new yl(e);return e.width=220,e.height=134,function(){}},track:function(e,t){var n=t()-1,r=e.subSequence;r.getRootSubSequence&&(r=r.getRootSubSequence()),console.log("sub sequence for track=",r);var a=r.tracks[n%r.tracks.length];return a?(e.id=a.id,e.width=80,e.height=80,a&&(e.effect=a,a.zObject=e),e.needsStart=!0,e.newAttribute("show-sequencer",!1),e.newAttribute("send-levels",!1,function(e){return a.sendLevels(e)}),e.newAttribute("level-smoothness",.9,function(e){return a.trackMeter.smoothness=e}),e.newAttribute("volume pattern-locked",!0),function(n){var a=t()-1,i=r.tracks[a];i&&(e.effect=i,i.zObject=e)}):function(){}},comment:function(e){var t=new Vl(e);e.sequencerEngine.state.sequencer.backgroundColor;return e.attributes["primary-color"]="#ffff13",e.attributes["secondary-color"]="#000000",e.width=100,e.height=25,e.effect=t,function(){}},delaunay:function(e){var t;return function(e){var n=Object(Hr.a)(e,1)[0];if(n&&Array.isArray(n)&&!n.some(function(e){return!Object(ae.a)(e)})){t?t=new ec.a(n):(n.forEach(function(e,n){return t.coords[n]=e}),t.update());for(var r=[],a=0;a<t.triangles.length;a+=3){var i=[t.triangles[a],t.triangles[a+1],t.triangles[a+2]];r.push(n[2*i[0]]),r.push(n[2*i[0]+1]),r.push(n[2*i[1]]),r.push(n[2*i[1]+1]),r.push(n[2*i[2]]),r.push(n[2*i[2]+1])}return[r]}}},delaunayIndex:Bc,dHull:function(e,t){var n,r,a,i=[];return function(e){var o=Object(Hr.a)(e,1)[0];if(o){n&&n.coords.length===o.length?(n.coords.set(o,0),n.update()):n=new ec.a(o);var s=n.hull,c=o.length/2-s.length;a&&a.length===2*c||(a=new Float32Array(2*c)),oc(o,s,a),r&&r.coords.length===a.length?(r.coords.set(0,a),r.update()):r=new ec.a(a);var u=r.hull;cc(o,a,s,u);var l,f=Math.min(t()||0,u.length),h=f+s.length,p=new Float32Array(2*h),d=0,m=tc(s);try{for(m.s();!(l=m.n()).done;){var v=l.value;p[d++]=o[2*v],p[d++]=o[2*v+1]}}catch(L){m.e(L)}finally{m.f()}var b=rc()([o]),g=Object(Hr.a)(b,1),y=Object(Hr.a)(g[0],2),k=y[0],O=y[1],j=0;i.length=0;var w,E=tc(s);try{for(E.s();!(w=E.n()).done;){var S=w.value,P=o[2*S],x=o[2*S+1],T=Object(dn.a)(Math.atan2(x-O,P-k),2*Math.PI);i.push(T)}}catch(L){E.e(L)}finally{E.f()}d=0;var C,N=tc(u);try{for(N.s();!(C=N.n()).done;){var R=C.value;if(++d>f)break;var M=[a[2*R],a[2*R+1]],A=M[0],q=M[1],D=Object(dn.a)(Math.atan2(q-O,A-k),2*Math.PI),I=ic(i,D,p,A,q);void 0!==I||(Math.PI,void 0!==(I=ic(i,D,p,A,q)))?(i.splice(I,0,D),sc(p,2*I,0,A,q)):j++}}catch(L){N.e(L)}finally{N.f()}if(j>0){for(var _=new Float32Array(p.length-2*j),F=0;F<p.length/2-j;F++)_[2*F]=p[2*F],_[2*F+1]=p[2*F+1];return _}return[p]}}},zl:function(e,t){var n=[];return function(e){e=e[0];var r=t();"string"===typeof e&&(r=e),n=e[0];var a=Object(h.a)(n);switch(r){case"rev":return[a.reverse()]}}},get:function(e,t){return function(e){if(null!==e[0][t()]&&void 0!==e[0][t()])return[e[0][t()]]}},set:function(e,t,n){return function(e){return e[0][t()]=n(),[n()]}}},Wc,cf,af,{list:function(){return function(e){var t=Object(Hr.a)(e,1)[0];return[Array.from(t)]}},sublist:function(e,t,n){return function(e){var r=Object(Hr.a)(e,1)[0];if(Array.isArray(r))return[r.slice(t(),n())]}}},sf,Ia,{sparseMerge:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(e){var t,r=Object(Hr.a)(e,1)[0],a=n.map(function(e){return e()}).filter(function(e){return void 0!==e}),i=[],o=Tl([r||[]].concat(Object(h.a)(a)));try{for(o.s();!(t=o.n()).done;)for(var s=t.value,c=0;c<s.length;c++)s[c]&&(i[c]=s[c])}catch(u){o.e(u)}finally{o.f()}return[i]}}},Yl,pi),vf=n(388);function bf(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return gf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gf(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function gf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function kf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Of(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return jf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jf(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function jf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ef=In.a.presets,Sf=function(e){Object(u.a)(n,e);var t=wf(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this)).arr=[],r.preset=new Qe.a,r.id=Object(j.uuid)(),r.subSequence=e,r.sequencerEngine=e.sequencerEngine,r.sequencerEngine.idToObject[r.id]=Object(c.a)(r),r.counter=0,r.text="",r.name="",r.args=[],r.function=void 0,r.mutations=new Array(16).fill(!1),r.window={id:Object(j.uuid)()},r.newInlet("Input",function(e){r.onInputMessage(e)}),r.newAttribute("primary-color"),r.newAttribute("secondary-color"),r.newAttribute("border-radius"),r.newAttribute("Include in Presentation",!1),r}return Object(s.a)(n,[{key:"getObjectType",value:function(){return Zr.e}},{key:"getInstrumentType",value:function(){return"zobject."+this.name}},{key:"getAllParameters",value:function(){return this.effect?this.effect.getParameters():[]}},{key:"effect",get:function(){return this._effect},set:function(e){this._effect=e;var t,n={},r=Of(e.getParameters());try{for(r.s();!(t=r.n()).done;){var a=t.value;n=Object(p.a)({},n,a.setStore(this.sequencerEngine.store))}}catch(i){r.e(i)}finally{r.f()}this.sequencerEngine.store.dispatch(Object(C.Vb)(n))}},{key:"bang",value:function(){this.onInputMessage([Xe.a])}},{key:"getJson",value:function(e){var t={id:this.id,text:this.text,width:this.width,height:this.height,attributes:this.attributes};if(this.plugin&&(t.plugin=this.plugin),this.effect&&(t.effect=this.effect&&this.effect.getJson(e)),this.height&&(t.height=this.height),this.width&&(t.width=this.width),this.mutations.some(function(e){return e})){var n=Object(h.a)(this.mutations);n.reverse();var r=n.indexOf(!0);t.mutations=this.mutations.slice(0,n.length-r)}return t}},{key:"fromJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i={};if(t||(this.id=e.id,this.sequencerEngine.idToObject[this.id]=this),i[e.id]=this.id,n||(this.text=e.text),e.mutations){this.dependencies=e.mutations;for(var o=this.dependencies.length;o<16;o++)this.dependencies.push(!1)}if(this.effect&&e.effect&&(i=Object(p.a)({},i,this.effect.fromJson(e.effect,t,n,r,a)),t&&!this.effect.zObjects&&(this.effect.id=Object(j.uuid)(),i[e.effect.id]=this.effect.id),this.sequencerEngine.idToObject[this.effect.id]=this.effect),e.width&&e.height&&(this.width=e.width,this.height=e.height),e.attributes)for(var s in e.attributes)this.setAttribute(s,e.attributes[s]);return e.plugin&&(this.plugin=e.plugin),i}},{key:"onNewFunction",value:function(e,t){var n=this;this.name=e;var r=Object(Ea.a)(e),a=r.outlets,i=r.isHot,o=r.inlets;this.isHot=i;var s=1,c=!1;a&&(Array.isArray(a)?(s=a.length,c=!0):s=a(t.length));var u=Object.keys(this.outlets).length;if(u>s){for(var l=u-1;l>s-1;l--)this.deleteOutlet(this.outputByNumber(l,!0),!1);this.updateMessagingRedux()}else if(u<s)for(var f=u;f<s;f++)this.newOutlet(c?a[f]:this.outputByNumber(f,!0));if(void 0!==o)if(Array.isArray(o)){for(var p in this.inlets)o.includes(p)||this.deleteInlet(p);var d,m=Of(o);try{var v=function(){var e=d.value;if(n.inlets[e])return"continue";n.newInlet(e,function(t){n.onInputMessage([e].concat(Object(h.a)(t)))})};for(m.s();!(d=m.n()).done;)v()}catch(b){m.e(b)}finally{m.f()}}else if("function"===typeof o)o=Math.max(0,o(t.length)),this.onNewArgs(new Array(Math.max(0,o-1)).fill(0));else if(this.onNewArgs(new Array(Math.max(0,o-1)).fill(0)),0===o)return!0}},{key:"onNewArgs",value:function(e){var t=this,n=Object.keys(this.inlets);if(this.previousArgs=Object(h.a)(this.args),this.args=e,this.mutations=new Array(16).fill(!1),n.length<=e.length)for(var r=function(e){t.newInlet(e,function(n){return t.onArg(e,n)})},a=n.length;a<=e.length;a++)r(a);else if(n.length>e.length)for(var i=n.length;i>e.length;i--)this.deleteInlet(i)}},{key:"onArg",value:function(e,t){this.previousArgs=Object(h.a)(this.args),this.args[e-1]=t[0],this.mutations[e-1]=!0,this.isHot&&void 0!==this.lastMessageReceived&&this.onInputMessage(this.lastMessageReceived)}},{key:"refresh",value:function(){this.sequencerEngine.isLoading||this.onInputMessage(this.lastMessageReceived||Xe.a)}},{key:"needsTick",get:function(){return this._needsTick},set:function(e){this._needsTick=e,this.sequencerEngine.tickingObjects.push(this)}},{key:"onInputMessage",value:function(e){if(!this._disposed&&this.function)if(e&&"clearAllMessages"===e[0]){console.log("clear all messages called"),this.lastMessageReceived=0;for(var t=0;t<this.args.length;t++)this.args[t]=void 0}else{if(this.dependencies&&this.isHot&&!this.needsLoad)for(var n=0;n<this.dependencies.length;n++)if(this.dependencies[n]&&!this.mutations[n])return this.wasSuppressed=!0,void(this.lastMessageReceived=e);Array.isArray(e)||(this.arr[0]=e,e=this.arr),this.lastMessageReceived=e;var r=this.function(e);if(void 0!==r){if(!Array.isArray(r))return void this.sendMessage(this.outputByNumber(0),r);for(var a=0;a<r.length;a++){var i=r[a];if(void 0!==i){this.outputByNumber(a);this.sendMessage(this.outputByNumber(a),i)}}}}}},{key:"outputByNumber",value:function(e,t){var n="Output "+(e+1);return this.outlets[n]||t?n:Object.keys(this.outlets)[e]}},{key:"sendMessageToInlet",value:function(e){this.onInputMessage(e)}},{key:"loadPresetJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=this.id;this.sequencerEngine.bulkConnections={},this.sequencerEngine.dispatch(Object(C.ad)(this.sequencerEngine.sequenceId,!0));var i=this.fromJson(e,!0,t,n,r);if(this.id=a,e.windowPositions&&e.inletConnections){this.dispatch(Object(C.gb)(cu(i,e.windowPositions))),e.presentationPositions&&this.dispatch(Object(C.fb)(cu(i,e.presentationPositions))),this.sequencerEngine.checkSubPatchInstances(i);var o=uu(i,e.inletConnections);for(var s in this.sequencerEngine.loadInletConnectionsForId(o),this.sequencerEngine.checkInstanceConnections(),this.effect&&this.effect.zObjects&&this.effect.loadBangZObjects(),this.sequencerEngine.dispatch(Object(C.ad)(this.sequencerEngine.sequenceId,!1)),this.sequencerEngine.bulkConnections){var c=this.state.windows.inletConnections[s]||{};this.dispatch(Object(C.Bc)(s,Object(p.a)({},c,this.sequencerEngine.bulkConnections[s])))}console.log("FINISHED YALL"),this.sequencerEngine.compile(),this.sequencerEngine.groups.sendVolumes()}else this.sequencerEngine.dispatch(Object(C.ad)(this.sequencerEngine.sequenceId,!1))}},{key:"position",get:function(){return this.state.windows.windowPositions[this.id]}},{key:"delete",value:function(){var e=this;console.log("delete called"),this.isDeletable()&&(console.log("trying to delete node"),this.subSequence.deleteNode(this),this.effect&&this.effect.dispose&&this.effect.dispose(),this.state.plugins.pluginsLoaded&&this.state.plugins.pluginsLoaded.includes(this)&&this.dispatch(Object(C.ne)(this.state.plugins.pluginsLoaded.filter(function(t){return t!==e}))))}},{key:"duplicate",value:function(){var e=this.getPresetJson(),t=this.state.windows.windowPositions[this.id],n=t.x,r=t.y,a=this.width||200,i=(this.width,this.subSequence.createZObject(n+a,r));i.loadPresetJson(e);var o=this.state.windows.presentationWindowPositions[this.id];o&&this.dispatch(Object(C.qe)(i.id,{x:o.x+a,y:o.y}))}},{key:"loadPreset",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.preset=new Qe.a(t.title,t.contentHash,t.user,t.blockNumber),e.next=3,Ef.getPresetData(t);case 3:n=e.sent,this.loadPresetJson(n,void 0,!0);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPresetJson",value:function(){var e=this,t=this.getJson(!0);if(!(this.effect&&this.effect.zObjects))return t;var n={},r=this.getAllInnerObjects();r.forEach(function(t){var r=t.id;return n[r]=e.state.windows.windowPositions[r]});var a={};r.forEach(function(t){var n=t.id;return a[n]=e.state.windows.presentationWindowPositions[n]});var i,o=this.state.windows.inletConnections[this.effect.id],s=Of(r);try{for(s.s();!(i=s.n()).done;){var c=i.value;c.effect&&c.effect.zObjects&&(o=Object(p.a)({},o,this.state.windows.inletConnections[c.effect.id]))}}catch(u){s.e(u)}finally{s.f()}return Object(p.a)({},t,{inletConnections:o,windowPositions:n,presentationPositions:a})}},{key:"getAllInnerObjects",value:function(){if(this.effect&&this.effect.zObjects){var e=this.effect;return[].concat(Object(h.a)(e.zObjects),Object(h.a)(e.zMessages),Object(h.a)(e.zObjects.flatMap(function(e){return e.getAllInnerObjects()})))}return[]}},{key:"disposeMessaging",value:function(){this._disposed=!0,this.function,Object(Z.a)(Object(f.a)(n.prototype),"disposeMessaging",this).call(this)}},{key:"isDeletable",value:function(){return!this.effect||!this.effect.isDeletable||this.effect.isDeletable()}},{key:"flash",value:function(){var e=this.state.zobject.viewableSubPatches;if(this.subSequence.getRootSubSequence){if(!e||e[e.length-1]!==this.subSequence)return}else;this.subSequence.hasInstances||this.sequencerEngine.isLoading||this.dispatch(Object(C.Uh)(this.id,(new Date).getTime()))}},{key:"hotReload",value:function(){Object(vf.a)(this)}},{key:"hide",value:function(){this.dispatch(Object(C.uh)(this.id,!0))}},{key:"isHidden",get:function(){return this.state.spatial.hiddenObjects[this.id]}}]),n}(function(e){return function(e){Object(u.a)(n,e);var t=kf(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).actions={},e}return Object(s.a)(n,[{key:"newAction",value:function(e,t){this.actions[e]=t}},{key:"executeAction",value:function(e){this.actions[e]()}}]),n}(e)}(za(aa(Object(wa.a)(function(e){return function(e){Object(u.a)(n,e);var t=yf(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"text",get:function(){return this._text},set:function(e){var t=this;this._text=e;var n=e.split(" ").filter(function(e){return" "!==e&&""!==e}),r=n[0];if(mf[r]){var a=this.args,i=this.name!==r,o=(this.name,mf[r]),s=this.parseArgs(n.splice(1)),c=this.onNewFunction(r,s);a===this.args&&(this.previousArgs=Object(h.a)(this.args)),this.args=Object(h.a)(s);var u=new Array(16).fill(void 0).map(function(e,n){return function(){return t.args[n]}});i?(this.dependencies=void 0,this.function=o.apply(void 0,[this].concat(Object(h.a)(u))),this.registerName(this.name,r)):this.previousArgs=this.args,c&&this.deleteInlet("Input"),this.needsLoad&&!this.sequencerEngine.isLoading&&this.onInputMessage(["start"]),this.needsHotReload&&!this.sequencerEngine.isLoading&&Object(vf.b)(this),this.subSequence.propagate(Object(Fa.v)(this,e))}else this.function=void 0}},{key:"isValid",value:function(){return void 0!==this.function}},{key:"parseArgs",value:function(e){var t,n=[],r=bf(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;Object(ae.a)(a)?n.push(parseFloat(a)):n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"registerName",value:function(e,t){var n=this,r=this.sequencerEngine.nameToObjects;r[t]||(r[t]=[]),r[t].push(this),r[e]&&(r[e]=r[e].filter(function(e){return e!==n}))}}]),n}(e)}(function(){return function e(){Object(o.a)(this,e)}}()))))));function Pf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var xf=n(827),Tf=n(322);function Cf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Nf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Rf(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Mf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mf(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Mf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Af(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var qf=-40,Df=9;function If(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=(e=Math.min(Math.max(0,e),r))/r;return t+(n-t)*Math.pow(a,1/window.ROOTY)}window.ROOTY=3;var _f=function(e){Object(u.a)(n,e);var t=Af(n);function n(e){var r,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(o.a)(this,n),(r=t.call(this)).subSequence=e,r.sequencerEngine=e.sequencerEngine,r.id=Object(j.uuid)(),r.sequencerEngine.idToObject[r.id]=Object(c.a)(r),r.tracks=new Array(Df).fill(!1),a&&r.createEffectRack(),r.newInlet(Xe.r,function(e){return r.onTrigger(e)}),r.newInlet(Xe.b,function(e){return r.onChoke(e)}),r.newInlet("slider values",function(e){return r.onSliderValues(e)}),r.newInlet("add effect",function(e){var t=Object(Hr.a)(e,1)[0];return r.onAddEffectMessage(t)}),r.registerOperations("effect",ka),r.newInlet("effect operation",function(e){var t=Object(Hr.a)(e,1)[0];return r.onOperation("effect",t)}),r.newOutlet("pads playing"),r.newOutlet("notes playing"),r.newOutlet("size"),r.newOutlet("slider levels"),r.newOutlet("mouse downs"),r.newOutlet("effect added"),r.isPad=!0,r.initShaderBackground(),r}return Object(s.a)(n,[{key:"onChangePadsCount",value:function(e){if(!isNaN(e))if(e>this.tracks.length){var t=new Array(e-this.tracks.length).fill(!1);this.tracks=[].concat(Object(h.a)(this.tracks),Object(h.a)(t))}else{for(var n=e;n<this.tracks.length;n++)this.tracks[n]&&this.removeTrack(this.tracks[n]);this.tracks=this.tracks.slice(0,e)}}},{key:"padFXMode",get:function(){return this.state.pads.padFXMode[this.id]||ja.a},set:function(e){var t,n=Rf(this.tracks);try{for(n.s();!(t=n.n()).done;){var r=t.value;r&&r.outputTypeParameter.set(e)}}catch(a){n.e(a)}finally{n.f()}this.dispatch(Object(C.Id)(this.id,e))}},{key:"getObjectType",value:function(){return Zr.b}},{key:"onSlots",value:function(e){e=e[0],this.slotsMapping=e}},{key:"onTrigger",value:function(e){if((e=e[0])&&e[1]){var t,n=Rf(e[1]);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=r.outputNumber-1;this.slotsMapping&&void 0!==this.slotsMapping[a]&&(a=this.slotsMapping[a]);var i=this.slots[a];if(i){(r=Object(p.a)({},r)).outputNumber=0;var o=r,s=o.stepData,c=o.time,u=o.stepNumber;(s=i.midiEffects.getStep(s)).track=i,i.midiEffects.input(s,c,u),i.midiEffects.receivedTriggers=i.midiEffects.inputedTriggers}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"onChoke",value:function(e){e=parseFloat(e[0]),isNaN(e)||(this.choking=2*e)}},{key:"onNewStep",value:function(){this.choking--}},{key:"slots",get:function(){return this.tracks}},{key:"containsSample",value:function(e){return this.tracks.filter(function(e){return!e.isFrozen}).find(function(t){return t&&t.sample===e})}},{key:"switch",value:function(e,t){var n=this.tracks[e],r=this.tracks[t];this.tracks[e]=r,this.tracks[t]=n,this.updateRedux()}},{key:"removeTrack",value:function(e){for(var t in this.tracks)this.tracks[t]===e&&(this.tracks[t]=!1);e.pad=void 0,this.updateRedux(),this.onTrackRemoved(e)}},{key:"slotTracks",get:function(){return this.tracks.filter(function(e){return e})}},{key:"patternLength",get:function(){return Math.max.apply(Math,Object(h.a)(this.slotTracks.filter(function(e){return e.pattern}).map(function(e){return e.pattern.length()})))}},{key:"addTrack",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){e.changeOutputType(this.padFXMode),this.slots[t]&&this.deleteTrack(this.slots[t]);var n=Object(h.a)(this.tracks);n[t]=e,this.tracks=n,e.pad&&e.pad.removeTrack(e),e.pad=this,this.updateRedux(),this.onTrackAdded(e),this.sendTags()}}},{key:"newSample",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sequencerEngine.addSound(t,void 0,void 0,void 0,void 0,void 0,!1);case 2:return r=e.sent,this.addTrack(r,n),e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateRedux",value:function(){this.tracks=Object(h.a)(this.tracks),this.dispatch(Object(C.Kd)(this.id,this.tracks))}},{key:"deleteTrack",value:function(e){var t=this.slots.indexOf(e);-1!==t&&(this.slots[t]=!1,e.pad=!1,this.updateRedux())}},{key:"getJson",value:function(){return{id:this.id,tracks:this.tracks.map(function(e){return!1===e?e:e.trackNumber}),x:this.x,name:this.name,y:this.y,padFXMode:this.padFXMode,fxMacroValue:this.fxMacro.macroParameter.get(!0),fxMacro:this.fxMacro.macroParameter.getJson()}}},{key:"getParameters",value:function(){return this.getAllParameters()}},{key:"getAllParameters",value:function(){return this.fxMacro&&this.effectRack?[this.fxMacro.macroParameter].concat(Object(h.a)(this.effectRack.getParameters())):[]}},{key:"getJsonForPack",value:function(){var e,t=[],n=Rf(this.tracks);try{for(n.s();!(e=n.n()).done;){var r=e.value;r?r.sample?t.push({type:"SAMPLE",contentHash:r.sample.getId(),preset:this.sequencerEngine.getTrackPreset(r.trackNumber)}):r.preset&&r.preset.contentHash?t.push({type:"PRESET",contentHash:r.preset.contentHash,preset:this.sequencerEngine.getTrackPreset(r.trackNumber)}):t.push(!1):t.push(!1)}}catch(a){n.e(a)}finally{n.f()}return t.fx=this.effectRack.getJson(),t}},{key:"fromJson",value:function(e){e.id&&(this.id=e.id,this.sequencerEngine.idToObject[this.id]=this);var t=0,n=[];Array.isArray(e)?n=e:(n=e.tracks,this.x=e.x,this.y=e.y),void 0===e.fxMacroValue?this.createEffectRack():this.linkEffectRackContext();for(var r=0;r<n.length;r++){var a=n[r];if(!1!==a){var i=this.subSequence.tracks[parseFloat(a)];this.addTrack(i,t)}t++}this.fxMacroValue=e.fxMacroValue,this.fxMacroJson=e.fxMacro,e.fx&&this.effectRack.fromJson(e.fx),e.padFXMode&&(this.padFXMode=e.padFXMode),this.name=e.name}},{key:"deletePad",value:function(){var e=this;if(this.subSequence.deletePad(this),this.sequencerEngine.sends.sends){var t=this.sequencerEngine.sends.sends.filter(function(t){return t.pad===e});this.sequencerEngine.sends.deleteSends(t)}}},{key:"sendPadMessages",value:function(e){for(var t=this,n=[],r=[],a=this.state.tracks.triggers,i=0;i<this.slots.length;i++){var o=this.slots[i];if(o){var s=[],c=a[o.trackNumber];if(c)for(var u in c){if(c[u])s=o.currentStepDatas?o.currentStepDatas.map(function(e){return e.transpose}):[],n.push(1);else;}if(o.notesTriggered&&Object.keys(o.notesTriggered).length>0){if(o.isFrozen){n.push(1),r.push(s);continue}var l=o.lastPlayedStepData?o.lastPlayedStepData.duration:1,f=o.lastPlayedStepData?o.lastPlayedStepData.velocity:1;s=o.currentStepDatas?o.currentStepDatas.map(function(e){return e.transpose}):[],n.push(f*(1+Math.max.apply(Math,Object(h.a)(Object.values(o.notesTriggered)))/l))}else n.push(0);r.push(s)}else n.push(0),r.push([])}e?setTimeout(function(){t.sendMessage("pads playing",n),t.sendMessage("notes playing",r)},1e3*(e-H.a.Master.context.currentTime)-10):(this.sendMessage("pads playing",n),this.sendMessage("notes playing",r),console.log("sending notes playing"))}},{key:"onSizeChange",value:function(e,t){this.sendMessage("size",[e,t])}},{key:"sendTags",value:function(){var e,t=[],n=Rf(this.slots);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r){var a=r.sample;t.push(Object(Oa.a)(r,a))}else t.push("")}}catch(i){n.e(i)}finally{n.f()}this.sendMessage("track types",t)}},{key:"mouseDown",value:function(e,t){var n=new Array(this.slots.length).fill(0);n[e]=t?1:0,this.sendMessage("mouse downs",n)}},{key:"sendSliderLevels",value:function(){var e,t=[],n=Rf(this.slots);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r){var a=r.volumeParameter.get(!0);t.push(a<qf?0:Math.pow((a-qf)/(0-qf),window.ROOTY))}else t.push(0)}}catch(i){n.e(i)}finally{n.f()}this.sendMessage("slider levels",t)}},{key:"onSliderValues",value:function(e){for(var t=Object(Hr.a)(e,1)[0],n=0;n<t.length;n++){var r=t[n],a=this.slots[n];if(a){var i=If(r,qf,0,1);a.volumeParameter.get(!0)!==i&&a.setVolume(i,!1,!1)}}}},{key:"onAddEffectMessage",value:function(e){var t=this.effectRack,n=t.effects.find(function(t){return t.name===e.name});t.isCollapsed=!0,n?this.sendMessage("effect added",n):(this.addRackEffect(e),this.sendMessage("effect added",e)),this.dispatch(Object(C.Tb)(this.effectRack.id,!0))}}]),n}(function(e){return function(e){Object(u.a)(n,e);var t=ma(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).operationsMap={},e}return Object(s.a)(n,[{key:"registerOperations",value:function(e,t){this.operationsMap[e]=t}},{key:"onOperation",value:function(e,t){var n=this.operationsMap[e];if(n){var r=t.split(" "),a=r[0],i=r.slice(1).map(function(e){return Object(ae.a)(e)?parseFloat(e):e}),o=n[a];o&&o.apply(void 0,[this].concat(Object(h.a)(i)))}}}]),n}(e)}(function(e){return function(e){Object(u.a)(n,e);var t=Pf(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).sliderCanvases={},e.sliderMeshes={},e.sliderPlanes={},e.sliderCameras={},e.sliderRenderers={},e}return Object(s.a)(n,[{key:"onSliderMaterial",value:function(e){for(var t in this.sliderMaterial=e,this.sliderMeshes){var n=this.sliderMeshes[t];if(n)if(0===n.inlets[1].connections.length){var r=this.inlets["sliders material"].connections[0].sourceNode;this.sliderMeshes[t].connectInlet("1",r,"Output 1"),this.sliderPlanes[t].bang(),this.sliderCameras[t].bang()}else this.sliderRenderers[t].onInputMessage(this.sliderRenderers[t].lastMessageReceived)}}},{key:"newZObject",value:function(e){var t=new Sf(this.subSequence);return t.text=e,t}},{key:"newSliderRenderer",value:function(e){var t=this.newZObject("three.planeGeometry"),n=this.newZObject("three.scene"),r=this.newZObject("three.mesh"),a=this.newZObject("three.orthographicCamera 0 150 0 150 -1 1"),i=this.newZObject("three.render");i.connectInlet("1",a,"Output 1"),i.connectInlet("Input",n,"Output 1"),n.connectInlet("Input",r,"Output 1"),r.connectInlet("Input",t,"Output 1");var o=this.newZObject("three.canvas");return o.effect.connectInlet("operation",i,"Output 1"),a.bang(),this.sliderPlanes[e]=t,this.sliderMeshes[e]=r,this.sliderCanvases[e]=o,this.sliderCameras[e]=a,this.sliderRenderers[e]=i,o}},{key:"freeSliderRenderer",value:function(e){this.sliderMeshes[e]=void 0,this.sliderCanvases[e]=void 0}}]),n}(e)}(function(e){return function(e){Object(u.a)(n,e);var t=Nf(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"initShaderBackground",value:function(){var e=this;this.scene=new Sf(this.subSequence),this.scene.text="three.scene",this.render=new Sf(this.subSequence),this.render.text="three.render",this.canvas=new Sf(this.subSequence),this.canvas.text="three.canvas",this.camera=new Sf(this.subSequence),this.camera.text="three.orthographicCamera 0 201 0 227 -1 1",this.render.connectInlet("camera",this.camera,"Output 1"),this.render.connectInlet("Input",this.scene,"Output 1"),this.canvas.effect.connectInlet("operation",this.render,"Output 1"),this.camera.bang(),this.newInlet("background scene",function(t){e.showCanvas=!0,e.scene.onInputMessage(t)})}}]),n}(e)}(Object(wa.a)(function(e){return function(e){Object(u.a)(n,e);var t=Cf(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"createEffectRack",value:function(){this.send=this.sequencerEngine.sends.createNewSend(this);var e=Object(sa.b)("Effect Rack",this.sequencerEngine);e.pad=this,e.context=(new L.a).forSubSequence(this.subSequence),this.effectRack=e,this.send.addEffect(e),this.fxMacro=new Tf.a("Pad Send",this.sequencerEngine,(new L.a).forSubSequence(this.subSequence)),this.fxMacro.macroParameter.isAlwaysLocked=!0}},{key:"linkEffectRackContext",value:function(){this.effectRack&&(this.effectRack.pad=this,this.effectRack.registerContext((new L.a).forSubSequence(this.subSequence)))}},{key:"effects",get:function(){return this.effectRack?this.effectRack.effects:[]}},{key:"effectsChain",get:function(){return this.effectRack}},{key:"sendNumber",get:function(){return this.sequencerEngine.sends.sends.indexOf(this.send)}},{key:"addRackEffect",value:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];(e=Object(Z.a)(Object(f.a)(n.prototype),"addRackEffect",this)).call.apply(e,[this].concat(r)),this.updateEffectRedux()}},{key:"updateEffectRedux",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(h.a)(this.effectRack.effects);this.dispatch(Object(C.Hd)(this.id,e))}},{key:"onTrackAdded",value:function(e){this.fxMacro&&this.fxMacro.addParameter(e.sendNodeVolumeParameters[this.sendNumber],0,1)}},{key:"syncTracksToEffects",value:function(){var e=this;this.fxMacro=new Tf.a("Pad Send",this.sequencerEngine,(new L.a).forSubSequence(this.subSequence)),this.fxMacro.macroParameter.isAlwaysLocked=!0,void 0!==this.fxMacroValue&&this.fxMacro.macroParameter.set(this.fxMacroValue),this.fxMacroJson&&this.fxMacro.macroParameter.fromJson(this.fxMacroJson,this.sequencerEngine),this.tracks.filter(function(e){return e}).forEach(function(t){return e.onTrackAdded(t)}),this.linkEffectRackContext()}},{key:"onTrackRemoved",value:function(e){this.fxMacro&&(this.fxMacro.unmapParameter(e.sendNodeVolumeParameters[this.sendNumber],!1),e.sendNodeVolumeParameters[this.sendNumber].set(0))}}]),n}(e)}(Object(xf.a)(aa(function(){return function e(){Object(o.a)(this,e)}}()))))))));function Ff(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Lf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lf(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Lf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var zf=n(43),Vf=n(829);function Hf(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Uf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uf(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Uf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Jf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Gf=function(e){Object(u.a)(n,e);var t=Jf(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this)).subSequence=e,r.sequencerEngine=e.sequencerEngine,r.id=Object(j.uuid)(),r.tracks=[],r.type=Vf.a,r}return Object(s.a)(n,[{key:"dispose",value:function(){this.tracks.forEach(function(e){return e.sequencer=void 0}),this.subSequence.removeSequencer(this)}},{key:"fromJson",value:function(e){var t=this;this.id=e.id,this.x=e.x,this.y=e.y,e.width&&e.height&&(this.width=e.width,this.height=e.height);var n,r=Hf(e.tracks);try{var a=function(){var e=n.value,r=t.subSequence.tracks.find(function(t){return t.id===e});r&&t.addTrack(r)};for(r.s();!(n=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}}},{key:"getJson",value:function(){return{id:this.id,x:this.x,y:this.y,width:this.width,height:this.height,tracks:this.tracks.map(function(e){return e.id})}}},{key:"removeTrack",value:function(e){this.tracks=this.tracks.filter(function(t){return t!==e}),e.sequencer=void 0,this.updateRedux()}},{key:"addTrack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tracks.length;this.tracks.includes(e)||(e.sequencer=this,this.tracks[t]=e,this.updateRedux())}},{key:"updateRedux",value:function(){this.tracks=Object(h.a)(this.tracks),this.dispatch(Object(C.Df)(this.id,this.tracks))}}]),n}(aa(function(){return function e(){Object(o.a)(this,e)}}()));function Wf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Kf(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Xf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xf(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Xf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Yf=["A","B","C","D","E","F","G","H","I","J","K","L","M","N"],Zf=function(e){Object(u.a)(n,e);var t=Qf(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(o.a)(this,n),(r=t.call(this)).sequencerEngine=e,r.store=e.store,r.isTrack=a,r.id=Object(j.uuid)(),r.groups=new Qr(e.channelMixer,e.sends,e,Object(c.a)(r)),r.lfosTrack=new Sn(e,Object(c.a)(r)),r.envelopesTrack=new Mn(e,Object(c.a)(r)),r.tracks=[],r.mix=new pa.a(e,Object(c.a)(r)),r.setAutomationToShow(zf.i),r.midiEffects=new ha(Object(c.a)(r),e),r.playhead=new ia.a(Object(c.a)(r)),r.playhead.registerContext((new L.a).forSubSequence(Object(c.a)(r))),r.subSequence=Object(c.a)(r),r.trackData=new q.a(e,r.mix,(new L.a).forSubSequence(Object(c.a)(r))),r.trackData.loadDefaults(),r.initColor(),r.higherRolling=void 0,r.initPattr(),r}return Object(s.a)(n,[{key:"state",get:function(){return this.sequencerEngine.state}},{key:"getEffectNumber",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.midiEffects.getEffectNumber(e):0}},{key:"moveMidiEffectTo",value:function(e,t){this.midiEffects.moveEffectTo(e,t)}},{key:"name",get:function(){var e=this.sequencerEngine.subSequences.indexOf(this);return Yf[e]}},{key:"linearRampFade",value:function(e,t,n){this.tracks.forEach(function(r){return r.linearRampFade(e,t,n)})}},{key:"fade",set:function(e){e=e||0,this.fadeVolume!==e&&(this.muted||this.tracks.forEach(function(t){return t.fade=e}),this.store.dispatch(Object(C.Gg)(this.id,e)))}},{key:"mute",set:function(e){var t=e?0:this.fadeVolume;this.tracks.forEach(function(e){return e.fade=t}),this.store.dispatch(Object(C.Hg)(this.id,e))}},{key:"disposeParameters",value:function(){this.lfos.forEach(function(e){return e.lfo.disposeParameters()}),this.envelopes.forEach(function(e){return e.disposeParameters()})}},{key:"dispose",value:function(){this.pads.forEach(function(e){return e.deletePad()}),this.tracks.forEach(function(e){return e.dispose()}),this.groups.dispose(),this.tracks=void 0,this.groups=void 0,this.envelopes.forEach(function(e){return e.dispose()}),this.lfos.forEach(function(e){return e.lfo.dispose()}),this.lfosTrack=void 0,this.envelopesTrack=void 0}},{key:"addTrack",value:function(e){e.subSequence=this,this.tracks.push(e),this.isTrack&&this.groups.addTrack(e)}},{key:"setId",value:function(e){this.id=e,e+1}},{key:"channelMixer",get:function(){return this.sequencerEngine.channelMixer}},{key:"sends",get:function(){return this.sequencerEngine.sends}},{key:"lfos",get:function(){return this.lfosTrack.lfos}},{key:"length",get:function(){var e,t=-1,n=Kf(this.tracks);try{for(n.s();!(e=n.n()).done;){var r=e.value.length;r>=t&&(t=r)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"envelopes",get:function(){return this.envelopesTrack.envelopes.map(function(e){return e.envelope})}},{key:"fadeVolume",get:function(){return this.store.getState().mix.subSequenceFades[this.id]||1}},{key:"setAutomationToShow",value:function(e){this.store.dispatch(Object(C.B)(this.id,e))}},{key:"volumeAutomationMix",get:function(){return this.mix.mixesByType[zf.l]}},{key:"loopStart",get:function(){return this.store.getState().arrangement.selection.start}},{key:"looping",get:function(){return this.store.getState().arrangement.selection.start}},{key:"updateVolumeFromAutomation",value:function(e){var t=this.volumeAutomationMix.getValueAtStep(e,this.fadeVolume);this.looping&&e===this.loopStart?(this.mix.restart(),this.fade=t):this.fadeVolume!==t&&this.store.dispatch(Object(C.Gg)(this.id,t))}},{key:"getJson",value:function(){return{id:this.id,isTrack:this.isTrack,playhead:this.playhead.getJson(),color:this.color,pattr:this.pattr.getJson()}}},{key:"fromJson",value:function(e){this.id=e.id,void 0!==e.isTrack&&(this.isTrack=e.isTrack),e.playhead&&this.playhead.fromJson(e.playhead),e.color?this.color=e.color:this.initColor(),this.pattr.fromJson(e.pattr)}},{key:"getAllParameters",value:function(){return[].concat(Object(h.a)(this.playhead.parameters),Object(h.a)(this.midiEffects.getAllParameters()),Object(h.a)(this.pads.flatMap(function(e){return e.getAllParameters()})))}},{key:"getAllEffects",value:function(){return[].concat(Object(h.a)(this.midiEffects.effects),Object(h.a)(this.pads.flatMap(function(e){return void 0===e.effectRack?[]:e.effectRack.effects})))}},{key:"newPattern",value:function(){if(0!==this.tracks.length){var e=this.tracks[0].patterns.length,t=this.tracks[0].currentPattern,n=this.getAllEffects();n.forEach(function(t){return t.locked&&t.lockPattern(e,!0)});var r=n.flatMap(function(e){return e.getParameters()}),a=this.pads.map(function(e){return e.fxMacro.macroParameter.get()});r.forEach(function(n){return n.newPattern(t,e)}),this.pads.forEach(function(e,t){return e.fxMacro.macroParameter.set(a[t])})}}},{key:"insideInstance",value:function(){return!1}},{key:"propagate",value:function(){}}]),n}(Object(ea.a)(function(e){return function(e){Object(u.a)(n,e);var t=$r(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"loadSubPatch",value:function(e){var t=this;return new Promise(function(n){Object(Yr.c)(void 0,"zobject.subpatch",[],0,void 0,!1).then(function(r){var a=r.find(function(t){return t.title.includes(e)});if(a){var i=t.createZObject(1,1,"subpatch",!1);i.loadPreset(a),i.isUI=!0,console.log("setting isUI =",i),n(i)}})})}}]),n}(e)}(Eu(function(e){return function(e){Object(u.a)(n,e);var t=Wf(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"newZObject",value:function(){return new Sf(this)}}]),n}(e)}(Object(ta.a)(Object(na.a)(aa(function(e){return function(e){Object(u.a)(n,e);var t=Jf(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).sequencers=[],e}return Object(s.a)(n,[{key:"createSequencer",value:function(){var e=new Gf(this);return this.sequencers=[].concat(Object(h.a)(this.sequencers),[e]),this.updateRedux(),e}},{key:"removeSequencer",value:function(e){this.sequencers=this.sequencers.filter(function(t){return t!==e}),this.updateRedux()}},{key:"deleteTrackFromSequencers",value:function(e){this.sequencers.filter(function(t){return t.tracks.includes(e)}).forEach(function(t){return t.removeTrack(e)})}},{key:"getSequencersJson",value:function(){return this.sequencers.map(function(e){return e.getJson()})}},{key:"loadSequencersJson",value:function(e){if(e){var t,n=Hf(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.createSequencer().fromJson(r)}}catch(a){n.e(a)}finally{n.f()}}}},{key:"updateRedux",value:function(){this.dispatch(Object(C.Ef)(this.id,this.sequencers))}}]),n}(e)}(function(e){return function(e){Object(u.a)(n,e);var t=Bf(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).pads=[],e}return Object(s.a)(n,[{key:"schedulePads",value:function(){this.pads.forEach(function(e){return e.onNewStep()})}},{key:"sendPadMessages",value:function(e){this.pads.forEach(function(t){return t.sendPadMessages(e)})}},{key:"loadPackAsPads",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r,i){var o,s,c,u,l,f,h,p,d,m;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=r||this.createPad(),s=[],o.packHash=i,c=0;case 4:if(!(c<t.length)){e.next=32;break}if(u=t[c]){e.next=8;break}return e.abrupt("continue",29);case 8:if(s.push(c),console.log(u),l=r&&r.slots[c]&&r.slots[c].getTrackType(),f=u.preset.trackData.trackType,!r||!r.slots[c]||l===f){e.next=20;break}return h=r.slots[c].trackNumber,r.removeTrack(r.slots[c]),this.sequencerEngine.deleteTrack(h),e.next=18,this.sequencerEngine.loadTrackPreset(u.preset,void 0,!0);case 18:p=e.sent,o.addTrack(p,c);case 20:if(!r||!r.slots[c]){e.next=25;break}return e.next=23,this.sequencerEngine.auditionPreset({data:u.preset},r.slots[c].trackNumber,void 0,!0,!1);case 23:e.next=29;break;case 25:return e.next=27,this.sequencerEngine.loadTrackPreset(u.preset,void 0,!0);case 27:d=e.sent,o.addTrack(d,c);case 29:c++,e.next=4;break;case 32:for(m=0;m<r.slots.length;m++)r.slots[m]&&!s.includes(m)&&this.sequencerEngine.deleteTrack(r.slots[m].trackNumber);n&&(o.effectRack.fromJson(n,void 0,void 0,!0),o.updateEffectRedux());case 34:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"deletePad",value:function(e){this.pads=this.pads.filter(function(t){return t!==e}),e.slotTracks.forEach(function(e){return e.pad=void 0}),this.updateRedux()}},{key:"deleteTrackFromPads",value:function(e){var t=this.pads.find(function(t){return t.slots.includes(e)});t&&t.deleteTrack(e)}},{key:"createPad",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=new _f(this,t),a=0===this.pads.length;if(n){var i=this.createZObject(5,5,"pad");if(i.effect.linkPad(r),this.state.samples.droppedSamples){var o=this.state.samples.droppedSamples;console.log("droppped samples =",o),o>9&&i.setAttribute("Number of Pads",o)}}if(this.pads=[].concat(Object(h.a)(this.pads),[r]),e){var s,c=0,u=Ff(this.tracks);try{for(u.s();!(s=u.n()).done;){var l=s.value;l.pad||r.addTrack(l,c++),c>=9&&(c=0,r=new _f(this),this.pads=[].concat(Object(h.a)(this.pads),[r]))}}catch(f){u.e(f)}finally{u.f()}}return this.updateRedux(),a&&!this.sequencerEngine.isOffline&&this.dispatch(Object(C.Uf)(r)),r}},{key:"checkPads",value:function(){var e,t=this.findNodeByName("pad",!0).map(function(e){return e.effect.pad}),n=Ff(this.pads);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!t.includes(r)){var a=this.state.windows.windowPositions[r.id]||{x:0,y:0};this.createZObject(a.x,a.y,"pad").effect.linkPad(r)}r.sendSliderLevels()}}catch(i){n.e(i)}finally{n.f()}}},{key:"updateRedux",value:function(){this.dispatch(Object(C.Ld)(this.id,this.pads))}},{key:"getPadsJson",value:function(){return this.pads.map(function(e){return e.getJson()})}},{key:"loadPadsJson",value:function(e){if(e){var t,n=Ff(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.createPad(void 0,!1,!1).fromJson(r)}}catch(a){n.e(a)}finally{n.f()}}}},{key:"addTrackToPadIfPossible",value:function(e){var t=void 0,n=void 0;if(this.state.spatial.showPadSequencer)!0===(t=this.state.spatial.showPadSequencer)&&(t=this.pads[0]),-1===(n=t.tracks.indexOf(!1))&&(t=void 0);else{var r,a=Ff(this.pads);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=i.tracks.indexOf(!1);o>-1&&!i.tracks.includes(e)&&(n=o,t=i)}}catch(c){a.e(c)}finally{a.f()}}if(t)t.addTrack(e,n,!0);else if(this.state.sequencer.viewMode===da.b){var s=this.createPad();this.dispatch(Object(C.Kh)(s.id,{x:5,y:5})),this.createZObject(0,310,"cirklon"),s.addTrack(e,0,!0),this.sequencerEngine.selectTrack(e.trackNumber)}}}]),n}(e)}(function(){return function e(){Object(o.a)(this,e)}}())))))))))),$f=n(822);n(1052),n(65);function eh(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var th=function(){function e(){Object(o.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"},{name:"name",type:"bytes32"}],name:"syncClockMaster",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"},{name:"name",type:"bytes32"}],name:"syncClockSlave",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"",type:"address"},{indexed:!0,name:"",type:"bytes32"},{indexed:!1,name:"index",type:"bytes32"}],name:"ClockSyncMaster",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"",type:"address"},{indexed:!0,name:"",type:"bytes32"},{indexed:!1,name:"index",type:"bytes32"}],name:"ClockSyncSlave",type:"event"}],this.contractAddress="0x17eafcd1dc39c8d78ff165e1dbd0fe9e82afbdc2"}return Object(s.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}(),nh=n(168),rh=n(176),ah=n(1043);function ih(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var oh=n(2350),sh=(In.a.web3,function(e){Object(u.a)(n,e);var t=ih(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this)).sequencerEngine=e,r.store=r.sequencerEngine.store,r.contract=(new th).getContract(In.a.web3),r.listeningForClockSyncs=!1,r.connected=!1,r.isInitial=!0,r.userToSignal={},r}return Object(s.a)(n,[{key:"setClockType",value:function(e){this.store.dispatch(Object(C.mb)(e)),this.initiator=e===nh.a,this.clockType=e,e!==nh.b&&(this.setupWebRTC(),this.listeningForClockSyncs!==e&&this.listenForClockSyncs(e))}},{key:"retry",value:function(){this.setupWebRTC()}},{key:"startListening",value:function(){this.connected?console.log("is connected"):this.listenForClockSyncs(nh.c)}},{key:"stopListening",value:function(){this.timer&&clearInterval(this.timer)}},{key:"listenForClockSyncs",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.timer&&clearInterval(this.timer),this.listeningForClockSyncs=t,this.isInitial||this.store.dispatch(Object(C.tb)(rh.d)),e.next=5,Vr.a.getAccount();case 5:n=e.sent,this.listenCallback(t,n),this.timer=setInterval(function(){r.listenCallback(t,n)},1e4);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"listenCallback",value:function(e,t){var n=this,r=e===nh.a?nh.c:nh.a;fetch("/getClockUsers/"+r+"/"+t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(){var r=Object(i.a)(a.a.mark(function r(i){var o,s,c,u,l,f;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!n.connected){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,i.json();case 4:o=r.sent,s=[],r.t0=a.a.keys(o);case 7:if((r.t1=r.t0()).done){r.next=20;break}if(c=r.t1.value,(u=o[c].userId)!==t){r.next=12;break}return r.abrupt("continue",7);case 12:return l=o[c].signal,r.next=15,In.a.users.getUserName(u);case 15:f=r.sent,e===nh.a?(n.signal(l),n.store.dispatch(Object(C.sb)(f))):u in n.userToSignal||(s.push(f),n.store.dispatch(Object(C.Z)(s))),n.userToSignal[u]=l,r.next=7;break;case 20:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}())}},{key:"syncToUser",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isInitial=!1,this.setClockType(nh.c),this.signal(this.userToSignal[t]),e.next=5,In.a.users.getUserName(t);case 5:n=e.sent,this.userToConnectTo=t,this.store.dispatch(Object(C.sb)(n));case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setupWebRTC",value:function(){var e=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise(function(t,n){e.connected=!1,e.peer=new oh({reconnectTimer:1e3,channelConfig:{maxRetransmits:5,reliable:!1,ordered:!1},initiator:e.initiator,trickle:!1}),e.peer.on("error",function(t){console.log(t),e.connected=!1,e.retry()}),e.peer.on("signal",function(t){return e.onSignal(t)}),e.peer.on("connect",function(){e.connected=!0,e.store.dispatch(Object(C.tb)(rh.c)),e.tellServerWeConnected(),clearInterval(e.timer)}),e.peer.on("data",function(t){return e.onMessageFromPeer(t)}),e.peer.on("close",function(){e.connected=!1,e.store.dispatch(Object(C.tb)(rh.a))}),t()})}},{key:"onSignal",value:function(e){var t=this;gr.a.addJson(e).then(function(){var e=Object(i.a)(a.a.mark(function e(n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.clockType===nh.a?t.publishMaster(n):t.publishSlave(n,t.userToConnectTo);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}},{key:"onMessageFromPeer",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,Object(ah.a)(t);case 3:e.t1=e.sent,n=e.t0.parse.call(e.t0,e.t1),e.t2=n.type,e.next=6===e.t2?8:1===e.t2?10:2===e.t2?17:4===e.t2?19:5===e.t2?21:3===e.t2?23:30;break;case 8:return this.onTransferTrack(n.payload),e.abrupt("break",30);case 10:return this.lastTickTime=(new Date).getTime(),this.step=parseInt(n.payload.step),this.time=parseFloat(n.payload.time),this.length=parseInt(n.payload.length),this.peer.send(JSON.stringify({type:2,payload:""})),this.updateClockTickUI(this.step),e.abrupt("break",30);case 17:return this.peer.send(JSON.stringify({type:3})),e.abrupt("break",30);case 19:return this.sequencerEngine.stop(),e.abrupt("break",30);case 21:return this.sequencerEngine.bpm=n.payload,e.abrupt("break",30);case 23:return this.rtt=(new Date).getTime()-this.lastTickTime,r=this.rtt/2,i=this.step%this.sequencerEngine.length,(o=this.sequencerEngine.length)>this.length&&(o=this.length),i!==o-2||this.initiator||this.sequencerEngine.playing||!this.isPlayScheduled||(s=this.lastTickTime-r+this.time-(new Date).getTime(),s+=new H.a.Time("32n").toMilliseconds(),this.sequencerEngine.timeToCompare=(new Date).getTime()+s,this.sequencerEngine.play()),e.abrupt("break",30);case 30:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateClockTickUI",value:function(e){var t=this.length||this.sequencerEngine.length;if(0===(e%=t)%4){var n=e/t*100,r=25;n>=25&&n<50?r=50:n>=50&&n<75?r=75:n>=75&&(r=100),this.store.dispatch(Object(C.lb)(r))}}},{key:"signal",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gr.a.getJson(t);case 2:n=e.sent,console.log("calling peer ignal with data =",n),this.peer.signal(n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"publishMaster",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.store.dispatch(Object(C.tb)(rh.d)),e.next=3,Vr.a.getAccount();case 3:r=e.sent,fetch("/publishClock/"+r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({clockType:nh.a,signal:t})});case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"askToConnect",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.store.dispatch(Object(C.tb)(rh.d)),this.setClockType(nh.a),e.next=4,Vr.a.getAccount();case 4:n=e.sent,fetch("/askToConnect/"+n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({userToConnectTo:t})});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"publishSlave",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.store.dispatch(Object(C.tb)(rh.d)),e.next=3,Vr.a.getAccount();case 3:r=e.sent,fetch("/publishClock/"+r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({clockType:nh.c,signal:t,userToConnectTo:n})});case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onStop",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.connected&&this.initiator&&this.peer.send(JSON.stringify({type:4}));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onBPMChanged",value:function(){var e=Object(i.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.connected&&this.clockType===nh.a&&this.peer.send(JSON.stringify({type:5,payload:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onTick",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.connected&&this.clockType===nh.a&&(this.peer.send(JSON.stringify({type:1,payload:{step:n,time:t,length:this.sequencerEngine.length}})),this.updateClockTickUI(n));case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"tellServerWeConnected",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vr.a.getAccount();case 2:t=e.sent,fetch("/clocksConnected/"+t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}});case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"state",get:function(){return this.store.getState()}},{key:"isPlayScheduled",get:function(){return this.state.clock.playScheduled}}]),n}(function(e){return function(e){Object(u.a)(n,e);var t=eh(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"onTransferTrack",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.preset,r=t.pattern,e.next=3,this.sequencerEngine.loadTrackPreset(n,void 0,!0);case 3:(i=e.sent).pattern.changeLength(r.size),e.t0=a.a.keys(r);case 6:if((e.t1=e.t0()).done){e.next=13;break}if("size"!==(o=e.t1.value)){e.next=10;break}return e.abrupt("continue",6);case 10:i.pattern.stepBuckets[o].fromJson(r[o]),e.next=6;break;case 13:i.pattern.syncBuckets(),this.sequencerEngine.updateSteps();case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"transferTrack",value:function(e){var t=this.sequencerEngine.getTrackPreset(e.trackNumber),n=e.pattern.stepBuckets,r={size:n.length};for(var a in n)n[a].anyOn()&&(r[a]=n[a].getJson());var i={preset:t,pattern:r};this.peer.send(JSON.stringify({type:6,payload:i})),this.sequencerEngine.deleteTrack(e.trackNumber)}}]),n}(e)}(function(){return function e(){Object(o.a)(this,e)}}()))),ch=n(302),uh=n.n(ch),lh=n(124);function fh(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var hh=0,ph=n(225);function dh(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var mh=function e(){Object(o.a)(this,e)},vh=function(){function e(t){Object(o.a)(this,e),this.sequencerEngine=t,this.ccToCallback={},this.callbacks=[]}return Object(s.a)(e,[{key:"setCallback",value:function(e,t){this.ccToCallback[e]=t}},{key:"send",value:function(e,t){(t=Math.round(t))<0?t=0:t>127&&(t=127),this.output.sendControlChange(e,t)}},{key:"onEvent",value:function(e){var t=this.ccToCallback[e.controller.number];t&&t(e.value),38!==e.controller.number&&6!==e.controller.number&&96!==e.controller.number&&97!==e.controller.number&&this.sequencerEngine.store.dispatch(Object(C.Tc)({number:e.controller.number,value:e.value}))}}]),e}(),bh="FILTER",gh="DELAY",yh="SEND_A",kh=function(){function e(t){Object(o.a)(this,e),this.action=t}return Object(s.a)(e,[{key:"onChange",value:function(e,t){this.action===yh&&e&&e.setSendVolume(0,Object(Ur.b)(t,0,128))}}]),e}(),Oh="RESOLUTION",jh="TRACK_ROLL",wh="SEQUENCE_ROLL",Eh={1:new br.a(4,!1),2:new br.a(4,!0),3:new br.a(8,!1),4:new br.a(8,!0),5:new br.a(16,!1),6:new br.a(16,!0),7:new br.a(32,!1),8:new br.a(32,!0)},Sh=0,Ph=function(){function e(t,n,r){Object(o.a)(this,e),this.cc=r,this.sequencerEngine=t,this.lastNumber=0,this.ccToAction=this.convertConfig(n.cc),n.actions&&(this.noteToAction=this.convertConfig2(n.actions)),n.note&&(this.noteToAction=this.convertConfig(n.note)),n.ccActions&&(this.ccToAction=this.convertConfig2(n.ccActions)),this.overwrittenCC=new Set,this.knob1Action=new kh(bh),this.knob2Action=new kh(gh),this.knob3Action=new kh(yh),this.rollingCount=0}return Object(s.a)(e,[{key:"state",get:function(){return this.sequencerEngine.state}},{key:"overwrite",value:function(e){this.overwrittenCC.add(e)}},{key:"onNoteOnEvent",value:function(e){var t=e.note.number;if(void 0!==this.noteToAction){var n=this.noteToAction[t];if(void 0!==n){switch(n.action){case wh:this.onSequenceRollOn(n.track);break;case"PLAY":this.onPlay();break;case"RECORD":this.onRecord();break;case"CLEAR":this.onClear();break;case"PATTERN_SWITCH":this.onPatternSwitch(n.track);break;case"NEXT_PATTERN":this.onNextPattern();break;case"PREVIOUS_PATTERN":this.onPreviousPattern();break;default:return!0}return!0}}}},{key:"onNoteOffEvent",value:function(e){var t=e.note.number;if(void 0!==this.noteToAction){var n=this.noteToAction[t];if(void 0!==n){switch(n.action){case wh:this.onSequenceRollOff(n.track);break;case"PATTERN_SWITCH":break;default:return!0}return!0}}}},{key:"onEvent",value:function(e,t){if(this.ccToAction){var n=this.ccToAction[e];if(void 0!==n&&!this.overwrittenCC.has(e))switch(n.action){case"VOLUME":this.onVolume(n.track,t);break;case"KNOB_1":this.onKnob1(n.track,t);break;case"KNOB_2":this.onKnob2(n.track,t);break;case"KNOB_3":this.onKnob3(n.track,t);break;case"CHANGE_SELECTED_TRACK":this.changeSelectedTrack(t);break;case"BROWSE_SOUNDS":this.browseSounds(t);break;case"CHANGE_TRANSPOSE":this.changeTranspose(t);break;case"CHANGE_START_SLICE":this.changeStartSlice(t);break;case"CHANGE_END_SLICE":this.changeEndSlice(t);break;case"CHANGE_VOLUME":this.changeVolume(t)}}}},{key:"onVolume",value:function(e,t){var n=this.sequencerEngine.subSequences[e];void 0!==n&&(n.fade=t/128)}},{key:"onKnob1",value:function(e,t){var n=this.getTrack(e);this.knob1Action.onChange(n,t);var r=this.sequencerEngine.subSequences[e];void 0!==r&&this.sequencerEngine.switchToSubSequence(r.id)}},{key:"onKnob2",value:function(e,t){var n=this.getTrack(e);this.knob2Action.onChange(n,t);var r=this.sequencerEngine.subSequences[e];void 0!==r&&this.sequencerEngine.switchToSubSequence(r.id)}},{key:"onKnob3",value:function(e,t){var n=this.getTrack(e);this.knob3Action.onChange(n,t);var r=this.sequencerEngine.subSequences[e];void 0!==r&&this.sequencerEngine.switchToSubSequence(r.id)}},{key:"convertConfig2",value:function(e){var t={};for(var n in e){t[e[n]]={action:n}}return t}},{key:"convertConfig",value:function(e){var t={};for(var n in e){var r={track:Object(ae.a)(n)?parseInt(n):n},a=e[n];for(var i in a){t[a[i]]=Object(p.a)({},r,{action:i})}}return t}},{key:"getTrack",value:function(e){if("MASTER"!==e)return this.sequencerEngine.tracks[e]}},{key:"onSequenceRollOn",value:function(e){var t=Eh[e];void 0!==t&&(this.sequencerEngine.resolution=t,this.sequencerEngine.trackRolling=!0,this.sequencerEngine.setSequenceRolling(!0,t),this.rollingCount++)}},{key:"onSequenceRollOff",value:function(e){this.rollingCount--,0===this.rollingCount&&(this.sequencerEngine.trackRolling=!1,this.sequencerEngine.setSequenceRolling(!1,void 0))}},{key:"onPatternSwitch",value:function(e){this.sequencerEngine.switchToPattern(e)}},{key:"onNextPattern",value:function(){this.sequencerEngine.switchToNextPattern()}},{key:"onPreviousPattern",value:function(){this.sequencerEngine.switchToPreviousPattern()}},{key:"onPlay",value:function(){this.sequencerEngine.play()}},{key:"onClear",value:function(){var e=this.sequencerEngine.getSelectedMidiTrack();e&&(e.pattern.clear(),e.updateSteps())}},{key:"onRecord",value:function(){this.sequencerEngine.recording(!this.sequencerEngine.isRecording)}},{key:"changeSelectedTrack",value:function(e){this.sequencerEngine.getSelectedMidiTrack();var t=Math.floor(e/128*this.sequencerEngine.tracks.length);this.sequencerEngine.selectTrack(t)}},{key:"browseSounds",value:function(e){var t=this,n=++Sh;setTimeout(function(){if(Sh===n){var r=t.sequencerEngine.getSelectedMidiTrack();if(void 0!==r)if(Math.abs(t.lastBrowseValue-e)<=2)e>=125&&t.resetBrowseToZero();else{var a=void 0===t.lastBrowseValue||e>=t.lastBrowseValue;t.lastBrowseValue=e,a?r.auditionNext(!0,!0):r.auditionPrevious(!0,!0),e>=125&&t.resetBrowseToZero()}}},50)}},{key:"resetBrowseToZero",value:function(){for(var e in this.lastBrowseValue=0,this.ccToAction)if("BROWSE_SOUNDS"===this.ccToAction[e].action)return void this.cc.send(parseInt(e),0)}},{key:"changeResolution",value:function(e){var t=1+Math.floor(e/128*8);this.sequencerEngine.resolution=Eh[t]}},{key:"changeStartSlice",value:function(e){var t=e/128,n=this.sequencerEngine.getSelectedMidiTrack();if(n){var r=Object.keys(n.samplers);if(0!==r.length){var a=n.samplers[r[r.length-1]],i=this.getSlice(n),o=a.getSlice(i),s=t*o.endTime;s<o.endTime&&a.slice(i,s,o.endTime,void 0,void 0,!0)}}}},{key:"getSlice",value:function(e){return this.state.tracks.selectedTrackSlice[e.id]||0}},{key:"changeEndSlice",value:function(e){var t=e/128,n=this.sequencerEngine.getSelectedMidiTrack();if(n){var r=Object.keys(n.samplers);if(0!==r.length){var a=n.samplers[r[r.length-1]],i=this.getSlice(n),o=a.getSlice(i),s=a.getDuration(),c=o.startTime+t*(s-o.startTime);c>o.startTime&&a.slice(i,o.startTime,c,void 0,void 0,!0)}}}},{key:"changeVolume",value:function(e){var t=e/128,n=this.sequencerEngine.getSelectedMidiTrack();if(n){var r=64*Math.pow(t,.5)-60;n.setVolume(r)}}},{key:"changeTranspose",value:function(e){var t=this.sequencerEngine.getSelectedMidiTrack();if(t){var n=e/128*48-24;t.trackData.transpose=n}}}]),e}(),xh=n(1498),Th=function(){function e(t,n,r){Object(o.a)(this,e),this.sequencerEngine=t,this.store=this.sequencerEngine.store,this.input=n,this.output=r,this.step=0,this.subSequenceNumber=0,this.patternNumber=0,this.numberOfPatterns=1,this.setupLights(),this.setupListeners()}return Object(s.a)(e,[{key:"setupListeners",value:function(){var e=this;this.input.addListener("noteon","all",function(e){}),this.input.addListener("noteoff","all",function(e){}),this.store.subscribe(function(){return e.onStateUpdate()})}},{key:"onStateUpdate",value:function(){var e=this.store.getState(),t=this.sequencerEngine.getSubSequence(e.sequencer.currentSubSequence);if(void 0!==t){var n=this.sequencerEngine.subSequences.indexOf(t),r=e.sequencer.currentPattern[t.id],a=e.sequencer.numberOfPatterns;this.subSequenceNumber===n&&this.patternNumber===r&&this.numberOfPatterns===a||(this.patternNumber=r,this.subSequenceNumber=n,this.idToPattern=e.sequencer.currentPattern,this.numberOfPatterns=a,this.onStateChanged())}}},{key:"onStateChanged",value:function(){this.pad.reset(8),console.log("patternNumber = "+this.patternNumber+" and subSequenceNumber = "+this.subSequenceNumber),this.color(this.pad.red,8,this.subSequenceNumber);for(var e=0;e<this.sequencerEngine.subSequences.length;e++)this.color(this.pad.red,0,e);for(var t in this.idToPattern){t=parseInt(t),console.log("id we got = "+t);var n=this.sequencerEngine.getSubSequence(t);if(void 0===n)return;var r=this.sequencerEngine.subSequences.indexOf(n),a=this.idToPattern[t],i=n.tracks[0];if(void 0!==i)for(var o=0;o<Math.min(8,i.patterns.length);o++)this.color(this.pad.yellow,o,r);console.log("coloring x = "+a+" y ="+r),this.color(this.pad.red,a,r)}}},{key:"onTick",value:function(){}},{key:"setupLights",value:function(){var e=this;this.pad=new xh.a,this.pad.connect().then(function(){e.pad.reset(8),e.pad.on("key",function(t){return e.handleKeyPressed(t)}),e.onStateUpdate()})}},{key:"handleKeyPressed",value:function(e){var t=e.x,n=e.y;if(e.pressed){var r=this.sequencerEngine.subSequences[n];if(void 0!==r){var a=r.tracks[0];void 0!==a&&t<a.patterns.length&&(this.sequencerEngine.switchToSubSequence(r.id),this.sequencerEngine.switchToPattern(t))}}}},{key:"color",value:function(e,t,n){this.pad.col(e,{0:t,1:n,x:t,y:n,length:2,pressed:!0})}}]),e}();function Ch(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Nh=["Launchpad Mini"],Rh=["IAC Driver Bus 1","IAC Driver Bus 2","IAC Driver Bus 3"],Mh={"Akai MPD26 Port 1":ph.i,"MPD218 Port A":ph.i},Ah=function(e){Object(u.a)(n,e);var t=Ch(n);function n(e,r,a){var i;Object(o.a)(this,n),i=t.call(this);Object(c.a)(i);return i.keyboardEngine=e,i.sequencerEngine=i.keyboardEngine.sequencerEngine,i.keyboardHelper=r,i.deviceToMidiCC={},i.sliders={},i.controllerInputs=[],i.controllerOutputs=[],i.inputToMode={},i.updateBpm=a,i.previousTimestamp=null,i.currentTimestamp=null,window.isNFT||uh.a.enable(function(e){e?console.log("WebMidi could not be enabled.",e):i.setup()},!0),i}return Object(s.a)(n,[{key:"setup",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadAvailableDevices();case 2:this.setupKeyboardRouting(),void 0!==this.onEnableCallback&&this.onEnableCallback();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"store",get:function(){return this.sequencerEngine.store}},{key:"state",get:function(){return this.store.getState()}},{key:"loadAvailableDevices",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){uh.a.inputs.filter(function(e){return!Nh.some(function(t){return t===e.name})&&!Rh.some(function(t){return t===e.name})}).forEach(function(e){return t.trackInput(e,Mh[e.name]||ph.h)});var r=uh.a.inputs.filter(function(e){return Nh.some(function(t){return t===e.name})}),a=uh.a.outputs.filter(function(e){return Nh.some(function(t){return t===e.name})});r.length>0&&void 0===t.launchPad&&(t.launchPad=new Th(t.sequencerEngine,r[0],a[0])),uh.a.outputs.map(function(e){return t.trackOutput(e)}),e()}));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"setStartCallback",value:function(e){this.startCallback=e}},{key:"setStopCallback",value:function(e){this.stopCallback=e}},{key:"getInputs",value:function(){return uh.a.inputs}},{key:"getOutputs",value:function(){return uh.a.outputs}},{key:"getTrackedInputs",value:function(){return this.controllerInputs}},{key:"getTrackedOutputs",value:function(){return this.controllerOutputs}},{key:"isOutputTracked",value:function(e){return this.controllerOutputs.some(function(t){return t.name==e.name})}},{key:"getOutput",value:function(e){var t=this.controllerOutputs.filter(function(e){return e.name==t.name});return t.length>0?t[0]:null}},{key:"playNote",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;t=t||"all",(n=Math.round(n))>70?n=70:n<-36&&(n=-36);var s=K.a.fromTranspose(n).toString();if(null!=e&&(r-=0,e.playNote(s,t,{velocity:o,time:"+"+r}),void 0!==a)){var c=r+a-20;c-r<10&&(c+=10-(c-r)),e.stopNote(s,t,{time:"+"+c,release:i})}}},{key:"playNoteSimple",value:function(e,t,n,r){n=n||"all",e.playNote(t,n,{release:r})}},{key:"releaseNoteSimple",value:function(e,t,n,r){n=n||"all",e.stopNote(t,n,{release:r})}},{key:"trackOutput",value:function(e){for(var t in this.controllerOutputs)if(this.controllerOutputs[t].name===e.name)return;this.controllerOutputs.push(e),void 0===this.deviceToMidiCC[e.name]&&(this.deviceToMidiCC[e.name]=new vh(this.sequencerEngine)),this.deviceToMidiCC[e.name].output=e}},{key:"untrackOutput",value:function(e){for(var t=-1,n=0;n<this.controllerOutputs.length;n++)if(this.controllerOutputs[n].name===e.name){t=n;break}t>-1&&(this.controllerOutputs.splice(t,1),delete this.inputToMode[e.name])}},{key:"trackInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ph.h;if(this.addControlChangeListeners(e),mr.a[e.name]&&void 0===this.sliders[e.name]){var n=mr.a[e.name];this.sliders[e.name]=new Ph(this.sequencerEngine,n,this.deviceToMidiCC[e.name])}for(var r in this.controllerInputs)if(this.controllerInputs[r].name===e.name)return;this.controllerInputs.push(e),this.setInputMode(e,t)}},{key:"isInputTracked",value:function(e){return this.controllerInputs.some(function(t){return t.name==e.name})}},{key:"isInputSynced",value:function(e){return void 0!==this.systemInput&&this.systemInput.name==e.name}},{key:"untrackInput",value:function(e){for(var t=-1,n=0;n<this.controllerInputs.length;n++)if(this.controllerInputs[n].name===e.name){t=n;break}t>-1&&(this.controllerInputs.splice(t,1),delete this.inputToMode[e.name])}},{key:"setInputMode",value:function(e,t){this.inputToMode[e.name]=t}},{key:"syncOutput",value:function(e){this.systemOutput===e?this.systemOutput=void 0:this.systemOutput=e}},{key:"onTick",value:function(e,t,n){if(void 0!==this.systemOutput){var r=new H.a.Time("32n").toMilliseconds()/3;e+=20;for(var a=0;a<3;a++)this.systemOutput.sendClock({time:"+"+e}),e+=r}this.launchPad&&this.launchPad.onTick(t,n)}},{key:"onPlay",value:function(){void 0!==this.systemOutput&&this.systemOutput.sendStart({time:"+0"})}},{key:"onStop",value:function(){void 0!==this.systemOutput&&this.systemOutput.sendStop()}},{key:"syncInput",value:function(e){void 0!==this.systemInput&&this.removeSystemListeners(),this.systemInput=e,this.addSystemInputListeners()}},{key:"unsyncInput",value:function(e){this.removeSystemListeners(),this.systemInput=void 0}},{key:"removeSystemListeners",value:function(){this.systemInput.removeListener("clock","all"),this.systemInput.removeListener("start","all"),this.systemInput.removeListener("stop","all")}},{key:"addSystemInputListeners",value:function(){var e=this;this.last10=[],this.systemInput.addListener("start","all",function(t){e.sequencerEngine.play(0,!0)}),this.systemInput.addListener("stop","all",function(t){e.sequencerEngine.stop()})}},{key:"onEnable",value:function(e){this.onEnableCallback=e}},{key:"addControlChangeListeners",value:function(e){var t=this;e.removeListener("pitchbend","all"),e.removeListener("controlchange","all"),void 0===this.deviceToMidiCC[e.name]&&(this.deviceToMidiCC[e.name]=new vh(this.sequencerEngine));var n=e.name,r=this.deviceToMidiCC[e.name];r.input=e,e.addListener("controlchange","all",function(e){var a=t.sliders[n];t.onControlChange(r,a,e)}),e.addListener("pitchbend","all",function(e){t.onPitchBend(e)})}},{key:"removeListeners",value:function(e){e.removeListener("noteon","all"),e.removeListener("noteoff","all")}},{key:"getInputsForMode",value:function(e){var t=this;return this.controllerInputs.filter(function(n){return n.name in t.inputToMode&&t.inputToMode[n.name]==e})}},{key:"getInputMode",value:function(e){return this.inputToMode[e]||ph.h}},{key:"setupKeyboardRouting",value:function(){var e=this;uh.a.inputs.forEach(function(t){return e.removeListeners(t)}),this.addNoteOnListener(function(t,n,r){r<.1||(window.triggerReceived=(new Date).getTime(),r=Math.min(1,r+.1),e.keyboardHelper.onNoteDown(n,!0,t,r))},void 0),this.addNoteOffListener(function(t,n){e.keyboardHelper.onNoteOff(n,!0,t)},void 0)}},{key:"addNoteOnListener",value:function(e,t){var n=this;void 0===t&&(t=function(){return n.controllerInputs});uh.a.inputs.map(function(r){return r.addListener("noteon","all",function(a){var i=n.sliders[r.name];if((!i||!i.onNoteOnEvent(a))&&t().some(function(e){return e.name==r.name})){var o=a.note.name+a.note.octave;e(r.name,o,a.velocity)}})})}},{key:"addNoteOffListener",value:function(e,t){var n=this;void 0===t&&(t=function(){return n.controllerInputs});uh.a.inputs.map(function(r){return r.addListener("noteoff","all",function(a){var i=n.sliders[r.name];if((!i||!i.onNoteOffEvent(a))&&t().some(function(e){return e.name==r.name})){var o=a.note.name+a.note.octave;e(r.name,o)}})})}},{key:"updateSteps",value:function(e){}}]),n}(function(e){return function(e){Object(u.a)(n,e);var t=dh(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"onControlChange",value:function(e,t,n){if(e.onEvent(n),t&&t.onEvent(n.controller.number,n.value),n.controller.number===ph.c)this.sequencerEngine.play();else if(n.controller.number===ph.f)this.sequencerEngine.stop();else if(n.controller.number===ph.e){var r=this.sequencerEngine.store.getState();this.sequencerEngine.recording(!r.sequencer.isRecording)}else n.controller.number===ph.b?this.sequencerEngine.switchToNextPattern():n.controller.number===ph.d?this.sequencerEngine.switchToPreviousPattern():n.controller.number===ph.g?this.sequencerEngine.sustain(n.value):n.controller.number===ph.a&&this.onModulationChange(n.value);if(n.controller.number>=1&&n.controller.number<=6){var a=this.sequencerEngine.groups.groups[n.controller.number-1];void 0!==a&&a.tracks.length}else this.onControllerAux(n)}},{key:"onPitchBend",value:function(e){var t=this.sequencerEngine.getSelectedTrack();t.instrument&&t.instrument.onPitchBend&&t.instrument.onPitchBend(e.value)}},{key:"onModulationChange",value:function(e){this.sequencerEngine.getSelectedTrack}}]),n}(e)}(function(e){return function(e){Object(u.a)(n,e);var t=fh(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"midiMappings",get:function(){return this.state.midi.mappings}},{key:"midiMapMode",get:function(){return this.state.midi.midiMapMode}},{key:"onMappedParameterChange",value:function(e){var t=this,n=this.midiMappings[e.controller.number].map(function(e){return t.sequencerEngine.idToParameter[e]}).filter(function(e){return e&&e.object}),r=e.value/127;if(n.length>0){var a=++hh,i=n[0];this.sequencerEngine.dispatch(Object(C.Sd)(i)),setTimeout(function(){hh===a&&t.sequencerEngine.dispatch(Object(C.Sd)(void 0))},150)}n.forEach(function(e){return e.normalizedSet(r)})}},{key:"isParameterMapped",value:function(e){var t=e.controller.number;return this.midiMappings[t]&&(void 0===this.parameterSelected||this.midiMappings[t].indexOf(this.parameterSelected)>-1)}},{key:"onControllerAux",value:function(e){var t=e.controller.number;this.midiMapMode===lh.a?this.store.dispatch(Object(C.e)(t)):this.isParameterMapped(e)?this.onMappedParameterChange(e):this.actionMappings[t]&&(void 0===this.actionSelected||this.actionMappings[t].indexOf(this.actionSelected)>-1)?this.actionMappings[t].forEach(function(t){return t.execute(e.value)}):this.midiMapMode===lh.b&&this.actionSelected?this.store.dispatch(Object(C.t)(this.actionSelected,t)):this.midiMapMode===lh.b&&this.parameterSelected&&this.store.dispatch(Object(C.Pd)(this.parameterSelected,t))}},{key:"parameterSelected",get:function(){return this.state.midi.parameterSelected}},{key:"actionSelected",get:function(){return this.state.midi.actionSelected}},{key:"actionMappings",get:function(){return this.state.midi.actionMappings}}]),n}(e)}(mh))),qh=n(824);function Dh(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ih=new br.a(4,!1),_h=function(e){Object(u.a)(n,e);var t=Dh(n);function n(e,r,a,i,s){var c;return Object(o.a)(this,n),(c=t.call(this,-1,e,r,a,i,{id:-1})).isMetronome=!0,s||c.initPattern(),c}return Object(s.a)(n,[{key:"getCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t,r,a,i,o){return new n(e,t,r,a,!0)},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sequencerEngine;return Object(Z.a)(Object(f.a)(n.prototype),"getCopy",this).call(this,e,t)}},{key:"newFrozenColumn",value:function(){}},{key:"dispose",value:function(){console.log("DISPOSING METRO"),Object(Z.a)(Object(f.a)(n.prototype),"dispose",this).call(this)}},{key:"initPattern",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("INIT PATTERN CALLED FOR METRONOME"),t=new R.a("QmfJwbUmKMiE1Mrme2xHpHUJP2bVM3BFeUtzQgpDqHssCw"),e.next=4,t.fetchAudio();case 4:this.addSound(t),(n=this.getEasyPattern()).addStep(this.getOnBeat(),0,Ih,0),n.addStep(this.getOffBeat(),1,Ih,0),n.addStep(this.getOffBeat(),2,Ih,0),n.addStep(this.getOffBeat(),3,Ih,0),this.muteableNode.toMaster(),this.mute(!0);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getOnBeat",value:function(){var e=new q.a;return e.on=!0,e.velocity=.7,e}},{key:"getOffBeat",value:function(){var e=new q.a;return e.on=!0,e.velocity=.2,e}},{key:"updateSteps",value:function(){}},{key:"getUpdateStepsAction",value:function(){return[]}}]),n}(Ke),Fh=(n(1038),function(e,t){return 1!==t.speedFactor&&((e=Uh(e)).duration/=t.speedFactor),Lh(t)?(e=Uh(e),e=Bh(e,e.auxEventAParameter,t.auxEventAType),e=Bh(e,e.auxEventBParameter,t.auxEventBType),e=Bh(e,e.auxEventCParameter,t.auxEventCType),e=Bh(e,e.auxEventDParameter,t.auxEventDType)):e}),Lh=function(e){return e.auxEventAType!==Se.b||e.auxEventBType!==Se.b||e.auxEventCType!==Se.b||e.auxEventDType!==Se.b},Bh=function(e,t,n){if(n===Se.b)return e;var r=t.get(),a=e.track,i=a.getAuxVariable(t.name);switch(n){case Se.c:zh(i,e,r);break;case Se.a:Vh(i,e,a,r,t)}return e},zh=function(e,t,n){t[e]+=Math.random()*n},Vh=function(e,t,n,r,a){void 0===n.accumulators[e]&&(n.accumulators[e]=0),n.accumulators[e]+=r;var i=n.getAuxLimit(a.name);n.getAuxMode(a.name);Hh(n,e)>i&&Hh(n,e,0),t[e]+=Hh(n,e)},Hh=function(e,t,n){if(void 0===n)return e.accumulators[t];e.accumulators[t]=n},Uh=function(e){var t=new q.a(void 0,void 0,void 0,e.track);return t.transpose=e.transpose,t.velocity=e.velocity,t.on=e.on,t.duration=e.duration,t.attack=e.attack,e.track.instrument?t.release=null:t.release=e.release,t.start=e.start,t.chop=e.chop,t.pitchAttack=e.pitchAttack,t.pitchSustain=e.pitchSustain,t.pitchRelease=e.pitchRelease,t.pitchDecay=e.pitchDecay,t.slice=e.slice,t.reverse=e.reverse,t.panning=e.panning,t.selectedRecording=e.selectedRecording,t.palette=e.palette,t.auxEventA=e.auxEventA,t.auxEventB=e.auxEventB,t.auxEventC=e.auxEventC,t.auxEventD=e.auxEventD,t},Jh=n(209);function Gh(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Wh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wh(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Wh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Kh=function(e){var t,n=new Set,r=0,a=Gh(e.subSequences);try{for(a.s();!(t=a.n()).done;){var i,o=Gh(t.value.tracks);try{for(o.s();!(i=o.n()).done;){var s=i.value;r+=s.triggerCount||0,Object.keys(s.notesTriggered||{}).forEach(function(e){return n.add(parseFloat(e))})}}catch(c){o.e(c)}finally{o.f()}}}catch(c){a.e(c)}finally{a.f()}Object(Jh.a)(Array.from(n)),Object(Jh.f)(r)};function Xh(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Qh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qh(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Qh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Yh(e,t,n,r,a){for(var i in t.filter(function(e){return void 0!==e}).forEach(function(e){return e.chokes.onStep()}),$h(n,t),n=Zh(n,t))if(void 0!==t[i]&&void 0!==t[i].chokes&&void 0!==t[i].chokes.choke){var o=t[i].chokes.choke,s=n[i];for(var c in s){var u=s[c],l=2*u.stepData.duration;o.chokes.newChoke(l,u.time)}}n=np(n,t,r,a);for(var f=[],d=Math.max.apply(Math,Object(h.a)(t.map(function(e){return e.trackNumber}))),m=function(e){var n=t.find(function(t){return t.trackNumber===e});f.push(n)},v=0;v<=d;v++)m(v);t=f;var b,g=Xh(e.subSequences);try{for(g.s();!(b=g.n()).done;){var y,k=Xh(b.value.tracks);try{for(k.s();!(y=k.n()).done;){var O=y.value;if(O){for(var j=O.notesTriggered||{},w=Object.keys(j),E=0,S=w;E<S.length;E++){var P=S[E];j[P]-=.5,j[P]<=-1.5&&delete j[P]}O.notesTriggered=Object(p.a)({},j)}}}catch(C){k.e(C)}finally{k.f()}}}catch(C){g.e(C)}finally{g.f()}var x=function(e){var i=t[e],o=i&&i.notesTriggered||{};return void 0===i||void 0===i.chokes||i.chokes.isChoked()?(i&&(i.triggerCount=0),"continue"):i.pad&&i.pad.choking>0?(i.triggerCount=0,"continue"):void 0===n[e]?(i.triggerCount=0,"continue"):(0===n[e].length?a%2===0&&(i.triggerCount=n[e].length):i.triggerCount=n[e].length,n[e].forEach(function(e){var t=Math.round(e.stepData.transpose),n=o[t]||0,s=i.isWarped()?2:0;o[t]=Math.max(n,e.stepData.duration+s);var c=Fh(e.stepData,i);c.stepNumber=a,c.time=r,i.trigger(c,e.time,a)}),void(i.notesTriggered=Object(p.a)({},o)))};for(var T in n)x(T);return Kh(e),n}var Zh=function(e){var t=new Set([]);for(var n in e){e[n].filter(function(e){return e.chokes&&e.chokes.length>0}).forEach(function(e){return e.chokes.forEach(function(e){return t.add(e.trackNumber)})})}var r={};for(var a in e)t.has(parseInt(a))||(r[a]=e[a]);return r},$h=function(e,t){for(var n in e)for(var r=e[n].filter(function(e){return e.grabs&&e.grabs.length>0}),a=0;r.length>0&&!(++a>=100);){var i,o=r.shift(),s=Xh(o.grabs);try{for(s.s();!(i=s.n()).done;){var c=i.value;if(ep(c,e)){r.push(o);break}tp(o,c,e,t),o.resolved=!0}}catch(u){s.e(u)}finally{s.f()}}},ep=function(e,t){var n=e.trackNumber,r=(e.fromParam,e.toParam,t[n]);if(void 0===r||0===r.length)return!1;var a=r[0];return a.grabs.length>0&&!a.resolved},tp=function(e,t,n,r){var a=t.trackNumber,i=t.add,o=t.fromParam,s=t.toParam,c=(t.isTime,n[a]),u=r[a];if(u){var l=void 0,f=e.stepData[s+"Parameter"],h=-32,p=32;if(void 0===c||0===c.length){if("transpose"!==o)return!1;if(u.notesTriggered){l=rp(u.notesTriggered);var d=u.notesTriggered[l];if(void 0===l||d<2)return!1;l=parseFloat(l)}}else{var m=c[0];if(t.isTime)return e.time=m.time,!0;var v=m.stepData[o+"Parameter"];if(void 0===v||void 0===f)return!1;l=v.get(),h=v.min,p=v.max}var b=(l-h)/(p-h),g=f.min+b*(f.max-f.min);f.set(i?f.get()+g:g)}},np=function(e,t,n,r){if(0===t.length)return e;var a=t[0].subSequence;a.midiEffects.onNewStep();var i={};for(var o in e){var s=e[o],c=t[o];c&&c.isFrozen&&c.skipMidiMaster||c&&c.skipMidiMaster?(i[c.trackNumber]||(i[c.trackNumber]=[]),i[c.trackNumber]=s):s.forEach(function(e){return a.midiEffects.input(e)})}var u,l=Xh(a.midiEffects.output(n,r,r));try{for(l.s();!(u=l.n()).done;){var f=u.value;if(f.stepData&&f.stepData.track){var h=f.stepData.track.trackNumber;if(void 0===h)continue;i[h]||(i[h]=[]),i[h].push(f)}}}catch(p){l.e(p)}finally{l.f()}return i},rp=function(e){var t=-4,n=void 0;for(var r in e)t<e[r]&&(n=r,t=e[r]);return n},ap=n(221);function ip(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return op(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return op(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function op(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return cp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function cp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function up(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var lp=new H.a.Time("32n"),fp=n(198),hp=n(106),pp=n(111),dp=n(281),mp=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(var r in Object(o.a)(this,e),this.name=t,this.id=Object(j.uuid)(),this.patterns=n,this.algorithmTypes=[],this.durationPercentages=[],n)this.algorithmTypes.push(dp.d),this.durationPercentages.push(100)}return Object(s.a)(e,[{key:"deleteSubSequence",value:function(e){this.patterns.splice(e,1)}},{key:"getJson",value:function(){return{name:this.name,patterns:this.patterns,algorithmTypes:this.algorithmTypes,durationPercentages:this.durationPercentages}}}]),e}();function vp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return bp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function bp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var gp=function(){function e(t){Object(o.a)(this,e),this.sequencerEngine=t,this.scenes=[]}return Object(s.a)(e,[{key:"subSequences",get:function(){return this.sequencerEngine.subSequences}},{key:"state",get:function(){return this.sequencerEngine.state}},{key:"newScene",value:function(){var e,t="Scene "+(this.scenes.length+1),n=[],r=vp(this.subSequences);try{for(r.s();!(e=r.n()).done;){var a=e.value;n.push(a.tracks[0].currentPattern)}}catch(o){r.e(o)}finally{r.f()}var i=new mp(t,n);this.scenes=[].concat(Object(h.a)(this.scenes),[i]),this.sequencerEngine.dispatch(Object(C.Pe)(this.scenes)),this.sequencerEngine.dispatch(Object(C.Bb)(i))}},{key:"moveScene",value:function(e,t){var n=Object(En.b)(e,t,this.scenes);this.scenes=Object.keys(n).map(function(e){return n[e]}),this.sequencerEngine.dispatch(Object(C.Pe)(Object(h.a)(this.scenes)))}},{key:"deleteSubSequence",value:function(e){this.scenes.forEach(function(t){return t.patterns.splice(e,1)}),this.scenes.forEach(function(t){return t.algorithmTypes.splice(e,1)}),this.scenes.forEach(function(t){return t.durationPercentages.splice(e,1)})}},{key:"newSubSequence",value:function(){this.scenes.forEach(function(e){return e.patterns.push(0)}),this.scenes.forEach(function(e){return e.algorithmTypes.push(dp.d)}),this.scenes.forEach(function(e){return e.durationPercentages.push(100)})}},{key:"deleteScene",value:function(e){var t=this.scenes.indexOf(e);this.scenes.splice(t,1),this.sequencerEngine.dispatch(Object(C.Pe)(Object(h.a)(this.scenes))),this.sequencerEngine.dispatch(Object(C.Bb)(void 0))}},{key:"switchToScene",value:function(e){if(e){for(var t in this.subSequences){var n=this.subSequences[t],r=e.patterns[t];this.sequencerEngine.switchToPattern(r,!1,n)}this.sequencerEngine.dispatch(Object(C.Bb)(e))}}},{key:"currentScene",get:function(){return this.state.sequencer.currentScene}},{key:"onNewStep",value:function(e){var t=this.currentScene;if(!(void 0===t||e<=1))for(var n in t.algorithmTypes){var r=this.subSequences[n],a=t.algorithmTypes[n],i=t.durationPercentages[n];if(e%Math.round(r.length*i/100)===0&&r.tracks[0]){var o=r.tracks[0].currentPattern,s=r.tracks[0].patterns.length;switch(a){case dp.b:this.sequencerEngine.switchToPattern((o+1)%s,!1,r,!0);continue;case dp.c:(o-=1)<0&&(o=s-1),this.sequencerEngine.switchToPattern(o,!1,r,!0);continue;case dp.a:var c=Math.random();if(c<.5)continue;c<.75?this.sequencerEngine.switchToPattern((o+1)%s,!1,r,!0):((o-=1)<0&&(o=s-1),this.sequencerEngine.switchToPattern(o,!1,r,!0))}}}}},{key:"getJson",value:function(){return this.scenes.map(function(e){return e.getJson()})}},{key:"fromJson",value:function(e){var t,n=vp(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=new mp(r.name,r.patterns);r.algorithmTypes&&(a.algorithmTypes=r.algorithmTypes),r.durationPercentages&&(a.durationPercentages=r.durationPercentages),this.scenes.push(a)}}catch(i){n.e(i)}finally{n.f()}this.sequencerEngine.dispatch(Object(C.Pe)(Object(h.a)(this.scenes)))}}]),e}();function yp(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}n(401);var kp=n(234),Op=function(){function e(){Object(o.a)(this,e),this.trackToSlices={},this.trackToTransposes={}}return Object(s.a)(e,[{key:"clear",value:function(){this.trackToSlices={},this.trackToTransposes={}}},{key:"addTrackSlice",value:function(e,t,n){void 0===n?e in this.trackToSlices?this.trackToSlices[e].add(t):this.trackToSlices[e]=new Set([t]):e in this.trackToTransposes?this.trackToTransposes[e].add(n):this.trackToTransposes[e]=new Set([n])}},{key:"deleteTrack",value:function(e){e in this.trackToSlices&&delete this.trackToSlices[e],e in this.trackToTransposes&&delete this.trackToTransposes[e]}},{key:"removeTrackSlice",value:function(e,t,n){if(void 0!==n){var r=this.trackToTransposes[e];void 0===r||(r.size<=1?delete this.trackToTransposes[e]:this.trackToTransposes[e].delete(n))}else{var a=this.trackToSlices[e];void 0===a||(a.size<=1?delete this.trackToSlices[e]:this.trackToSlices[e].delete(t))}}},{key:"getTrackSlicesRolling",value:function(e){var t=e.trackNumber,n=[];return(this.trackToTransposes[t]||[]).forEach(function(e){return n.push(new jp(parseInt(t),0,e))}),(this.trackToSlices[t]||[]).forEach(function(e){return n.push(new jp(parseInt(t),e,void 0))}),n}},{key:"getTriggerTimes",value:function(e,t){return Object(ap.a)(e,t)}},{key:"getTrackRollEffectIfAny",value:function(e){for(var t in e.liveEffects.effects){var n=e.liveEffects.effects[t];if(n.effect===ge.f)return n}}},{key:"getTriggers",value:function(e,t,n){var r=this.getTrackRollEffectIfAny(n);if(r){var a=r.rollFactor;(t=t.getCopy()).resolution*=a}var i=this.getTriggerTimes(e,t),o=[];return 0==i.length?o:(this.getTrackSlicesRolling(n).forEach(function(e){return i.forEach(function(t){return o.push(new wp(e,t.time,t.step))})}),o)}}]),e}(),jp=function e(t,n,r){Object(o.a)(this,e),this.trackNumber=t,this.sliceNumber=n,this.transpose=r},wp=function e(t,n,r){Object(o.a)(this,e),this.trackSlice=t,this.time=n,this.step=r},Ep=Op,Sp=(n(196),function(){function e(t){Object(o.a)(this,e),this.type=t}return Object(s.a)(e,[{key:"execute",value:function(e){}}]),e}());function Pp(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var xp=function(e){Object(u.a)(n,e);var t=Pp(n);function n(e,r){var a;return Object(o.a)(this,n),(a=t.call(this,Oh)).sequencerEngine=e,a.resolution=r,a}return Object(s.a)(n,[{key:"execute",value:function(e){var t=this,n=Tp.filter(function(e){return e.isTriplet===t.resolution.isTriplet}),r=127/n.length,a=Math.floor(e/r);a>=n.length&&(a=n.length-1);var i=n[a];this.sequencerEngine.resolution.equals(i)||(this.sequencerEngine.resolution=i)}}]),n}(Sp),Tp=[new br.a(4,!1),new br.a(4,!0),new br.a(8,!1),new br.a(8,!0),new br.a(16,!1),new br.a(16,!0),new br.a(32,!1),new br.a(32,!0)],Cp=xp,Np=function(){function e(){Object(o.a)(this,e),this.parameterLocks=[]}return Object(s.a)(e,[{key:"addParameterLock",value:function(e,t,n,r,a){this.parameterLocks.push(new Rp(e,t,n,r,a))}},{key:"deleteParameterLock",value:function(e){var t=this.parameterLocks.indexOf(e);t>-1&&this.parameterLocks.splice(t,1)}},{key:"fromJson",value:function(e,t){for(var n in e){var r=e[n],a=void 0===r.effectNumber?this.getTrackParameterFromJson(r,t):this.getEffectParameterFromJson(r,t);void 0!==a&&this.parameterLocks.push(new Rp(r.trackNumber,r.groupNumber,r.sendNumber,r.effectNumber,a))}}},{key:"getTrackParameterFromJson",value:function(e,t){var n=e.trackNumber;if(void 0!==n){var r=t.tracks[n].trackData,a=e.parameter.name,i=r.parameters.filter(function(e){return e.name===a});if(!(i.length<1)){var o=i[0];return o.min=e.parameter.min,o.max=e.parameter.max,o}}}},{key:"getEffectParameterFromJson",value:function(e,t){var n=void 0;if(void 0!==e.trackNumber)n=t.tracks[e.trackNumber].effects[e.effectNumber];else if(void 0!==e.groupNumber){var r=t.groups.groups[e.groupNumber];if(void 0===r)return;n=r.effects[e.effectNumber]}else if(void 0!==e.sendNumber){n=t.sends.sends[e.sendNumber].effects[e.effectNumber]}if(void 0!==n){var a=e.parameter.name,i=n.parameters.filter(function(e){return e.name===a});if(!(i.length<1)){var o=i[0];return o.min=e.parameter.min,o.max=e.parameter.max,o}}}},{key:"getJson",value:function(){return this.parameterLocks.map(function(e){return e.getJson()})}}]),e}(),Rp=function(){function e(t,n,r,a,i){Object(o.a)(this,e),this.trackNumber=t,this.sendNumber=r,this.groupNumber=n,this.effectNumber=a,this.parameter=i}return Object(s.a)(e,[{key:"getJson",value:function(){var e={parameter:this.parameter.getJson(),effectNumber:this.effectNumber};return void 0!==this.trackNumber&&(e.trackNumber=this.trackNumber),void 0!==this.groupNumber&&(e.groupNumber=this.groupNumber),void 0!==this.sendNumber&&(e.sendNumber=this.sendNumber),e}}]),e}(),Mp=Np,Ap=(n(501),n(424),new fp.a(0),n(1513));function qp(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Dp=function(e){Object(u.a)(n,e);var t=qp(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e,"recorder-processor")).counter_=0,r.port.onmessage=r.handleMessage_.bind(Object(c.a)(r)),r}return Object(s.a)(n,[{key:"record",value:function(){this.port.postMessage({message:"record",contextTimestamp:this.context.currentTime})}},{key:"stop",value:function(){this.port.postMessage({message:"stop",contextTimestamp:this.context.currentTime})}},{key:"getBuffer",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.buffer=void 0,this.port.postMessage({message:"get_buffer",contextTimestamp:this.context.currentTime});case 2:if(void 0!==this.buffer){e.next=7;break}return e.next=5,this.sleep(10);case 5:e.next=2;break;case 7:return e.abrupt("return",this.buffer);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sleep",value:function(){var e=Object(i.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){setTimeout(function(){e()},t)}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleMessage_",value:function(e){console.log("[Node:handleMessage_] "+e.data.message+" ("+e.data.contextTimestamp+")");var t=e.data.message;"get_buffer"===t.type&&(this.buffer=t.data)}}]),n}(Object(Ap.a)(AudioWorkletNode)),Ip=function(){function e(t){Object(o.a)(this,e),this.sequencerEngine=t,this.output=new H.a.Volume,this.input=new H.a.Gain(1),this.effectsChain=new _.a(this.input,this.output,(new L.a).forSend(this),t),this.effectsChain.setupEffects()}return Object(s.a)(e,[{key:"getJson",value:function(){return this.effectsChain.getJson()}},{key:"fromJson",value:function(e){this.effectsChain.clear(),this.effectsChain.fromJson(e,this.sequencerEngine.tracks)}},{key:"dispose",value:function(){this.output.dispose(),this.input.dispose(),this.effectsChain.dispose(),this.output=void 0,this.input=void 0,this.effectsChain=void 0}},{key:"disconnect",value:function(e){this.output.disconnect(e)}},{key:"connect",value:function(e){this.output.connect(e)}},{key:"addEffect",value:function(e){this.effectsChain.addEffect(e),this.effectsChain.linkEffectParameters()}},{key:"moveEffectTo",value:function(e,t){this.effectsChain.moveEffectTo(e,t)}},{key:"deleteEffect",value:function(e){this.effectsChain.deleteEffect(e)}},{key:"copyFrom",value:function(e){this.effectsChain.fromJson(e.effectsChain.getJson(),void 0,void 0,!0)}}]),e}(),_p=n(293),Fp=(n(1531),d.a.FilterEffect),Lp=function(){function e(t,n,r){Object(o.a)(this,e),this.input=n,this.output=r,this.sequencerEngine=t,this.eq=new _p.a(t,!1),this.auxSend=new H.a.Gain(0),this.getLowEQ().frequencyParameter.set(250),this.getMidEQ().frequencyParameter.set(1e3),this.getMidEQ().qParameter.set(.9),this.getHighEQ().frequencyParameter.set(3400),this.input.connect(this.eq.effectNode),this.eq.outputNode.connect(this.auxSend),this.hp=new Fp(t,!1),this.hp.hipass(),this.lp=new Fp(t,!1),this.lp.lowpass(),this.hp.cutoffFrequency=0,this.lp.cutoffFrequency=3e4,this.eq.connect(this.hp.effectNode),this.hp.connect(this.lp.effectNode),this.lp.connect(this.output)}return Object(s.a)(e,[{key:"resetFilters",value:function(){this.hp.cutoffFrequency=0,this.lp.cutoffFrequency=3e4}},{key:"filter",set:function(e){if(e>=.5){var t=(e-.5)/.5;this.hp.cutoffFrequency=1e4*Math.pow(t,4)+5,this.lp.cutoffFrequency=30040}else{var n=e/.5;this.hp.cutoffFrequency=5,this.lp.cutoffFrequency=3e4*Math.pow(n,4)+40}}},{key:"dispose",value:function(){this.eq.dispose(),this.auxSend.dispose(),this.hp.dispose(),this.lp.dispose(),this.auxSend=void 0,this.eq=void 0,this.input=void 0,this.output=void 0,this.hp=void 0,this.lp=void 0}},{key:"color",set:function(e){this.auxSend.gain.value=e}},{key:"getLowEQ",value:function(){return this.eq.equalizerPoints[0]}},{key:"getMidEQ",value:function(){return this.eq.equalizerPoints[4]}},{key:"getHighEQ",value:function(){return this.eq.equalizerPoints[7]}}]),e}(),Bp=function(){function e(t){Object(o.a)(this,e),this.sequencerEngine=t,this.isMulti=!1,this.lazyConnections=[],this.ctxt=H.a.Master.context._context,this.ctxt.destination.maxChannelCount>=2&&(this.ctxt.destination.channelCount=this.ctxt.destination.maxChannelCount,this.ctxt.destination.channelCountMode="explicit",this.ctxt.destination.channelInterpretation="discrete"),this.masterChannel=new Ip(t),this.stereoOnly=t.stereoOnly,this.maxChannel=0,this.stereoConnected=!0,this.masterChannel.connect(H.a.Master),this.outputConnections=[],this.stereoOnly,this.setupAudioWorklet()}return Object(s.a)(e,[{key:"channelCount",get:function(){return this.multiMerger.numberOfInputs}},{key:"updateChannelCount",value:function(){H.a.Master.context._context.destination.maxChannelCount>=2&&(this.ctxt.destination.channelCount=this.ctxt.destination.maxChannelCount,this.ctxt.destination.channelCountMode="explicit",this.ctxt.destination.channelInterpretation="discrete")}},{key:"connectMixEffects",value:function(){this.mixEffects||(this.masterChannel.disconnect(),this.mixEffects=new Lp(this.sequencerEngine,this.masterChannel.output,H.a.Master))}},{key:"dispose",value:function(){this.mixEffects&&this.mixEffects.dispose(),this.masterChannel.dispose(),this.masterChannel=null}},{key:"setVolume",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.05;this.masterChannel.output.volume.exponentialRampToValueAtTime(e,t),this.sequencerEngine.store.dispatch(Object(C.fd)(this.sequencerEngine.getSequenceId(),e))}},{key:"numberOfChannels",value:function(){return this.stereoConnected?2:this.ctxt.destination.channelCount}},{key:"disconnect",value:function(e,t){e.disconnect()}},{key:"switchChannelOutput",value:function(e,t,n){if(this.stereoOnly||t>=this.numberOfChannels()||n>=this.numberOfChannels())return!1;var r=this.outputConnections.find(function(t){return t.output===e});return!!r&&(r.splitter.disconnect(),r.splitter.connect(this.multiMerger,0,t),n&&r.splitter.connect(this.multiMerger,1,n),!0)}},{key:"connect",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.maxChannel;if(e.connect(this.masterChannel.input),!this.stereoOnly){var r=function(){var r=H.a.Master.context.createChannelSplitter(2);e.connect(r);var a=n%t.channelCount,i=(n+1)%t.channelCount;return r.connect(t.multiMerger,0,a),r.connect(t.multiMerger,1,i),{splitter:r,output:e,leftChannel:a,rightChannel:i}};this.isMulti?this.outputConnections.push(r()):this.lazyConnections.push(r)}return[n%32,(n+1)%32]}},{key:"switchOutputs",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("SWITCHING OUTPUTS"),this.isMulti=t,t?(this.stereoOnly||(void 0===this.multiMerger&&(this.stereoOnly||(this.multiMerger=H.a.Master.context.createChannelMerger(32))),this.multiMerger.connect(H.a.Master),H.a.Master.channelCount=32,this.lazyConnections.forEach(function(t){e.outputConnections.push(t())}),this.lazyConnections=[]),this.stereoConnected&&this.masterChannel.disconnect(H.a.Master)):(this.masterChannel.connect(H.a.Master),this.stereoConnected||this.stereoOnly||this.multiMerger.disconnect(H.a.Master)),this.stereoConnected=!t}},{key:"setupAudioWorklet",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!O.isMobile){e.next=2;break}return e.abrupt("return");case 2:return t=H.a.Master.context._context,console.log("initializing audio worklet"),e.next=6,t.audioWorklet.addModule(window.isNFT?"RecorderWorklet.js":"/RecorderWorklet.js");case 6:console.log("finished initializing audio worklet"),this.recorderWorklet=new Dp(H.a.Master.context._context),this.masterChannel.output.connect(this.recorderWorklet);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),zp=new(function(){function e(){Object(o.a)(this,e),this.channelMixers=[]}return Object(s.a)(e,[{key:"use",value:function(e){if(0===this.channelMixers.length||!window.explore)return new Bp(e);var t=this.channelMixers.pop();return t.sequencerEngine=e,t.mixEffects&&(t.mixEffects.hp.cutoffFrequency=0,t.mixEffects.lp.cutoffFrequency=3e4),t}},{key:"release",value:function(e){this.channelMixers.push(e)}}]),e}());function Vp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Hp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Hp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Up(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Jp=["Mutate","Duration"],Gp=function(e){Object(u.a)(n,e);var t=Up(n);function n(e,r,a,i,s,c){var u;return Object(o.a)(this,n),(u=t.call(this,e,r,a,i,s,c)).controlParameters=[],u}return Object(s.a)(n,[{key:"getName",value:function(){return"Z4 Control"}},{key:"getTrackType",value:function(){return A.g}},{key:"trigger",value:function(e,t,n){if(null!==e.mutate){var r,a={},i=Vp(this.controlParameters);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.get();if(e.mutate<0?s+=.01*e.mutate*(s-o.min):s+=.01*e.mutate*(o.max-s),s<=o.max&&s>=o.min){var c=o.set(s,!0,!0,t),u=c.id,l=c.value;a[u]=l}}}catch(f){i.e(f)}finally{i.f()}this.store.dispatch(Object(C.Vb)(a))}}},{key:"triggerRelease",value:function(e){}},{key:"getStepDataParams",value:function(){return Jp}}]),n}(Ke);function Wp(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Kp=function(e){Object(u.a)(n,e);var t=Wp(n);function n(e,r,a){var i;return Object(o.a)(this,n),(i=t.call(this)).sequencerEngine=e,i.store=e.store,i.mixSession=r,i.context=a,i.synth=new H.a.MetalSynth,i.setupParameters(),i}return Object(s.a)(n,[{key:"getInstrumentType",value:function(){return z.e}},{key:"getName",value:function(){return"Metal Synth"}},{key:"setupParameters",value:function(){var e=this;this.frequencyParameter=new $.a("Frequency",this,function(t,n){return e.synth.frequency.value=n},{min:0,max:15e3,unit:"",defaultValue:200}),this.registerParameter(this.frequencyParameter),this.resonanceParameter=new $.a("Resonance",this,function(t,n){return e.synth.resonance=n},{min:0,max:1e4,unit:"",defaultValue:100}),this.registerParameter(this.resonanceParameter),this.harmonicityParameter=new $.a("Harmonicity",this,function(t,n){return e.synth.harmonicity=n},{min:0,max:200,unit:"",defaultValue:100}),this.registerParameter(this.harmonicityParameter),this.modulationIndexParameter=new $.a("Modulation Index",this,function(t,n){return e.synth.modulationIndex=n},{min:0,max:200,unit:"",defaultValue:20}),this.registerParameter(this.modulationIndexParameter),this.attackParameter=new $.a("Attack",this,function(e,t){return t},{min:0,max:1e4,unit:"",defaultValue:10}),this.registerParameter(this.attackParameter),this.decayParameter=new $.a("Decay",this,function(e,t){return t},{min:0,max:1e4,unit:"",defaultValue:200}),this.registerParameter(this.decayParameter),this.sustainParameter=new $.a("Sustain",this,function(e,t){return t},{min:0,max:1,unit:"",defaultValue:1}),this.registerParameter(this.sustainParameter),this.releaseParameter=new $.a("Release",this,function(e,t){return t},{min:0,max:1e4,unit:"",defaultValue:1e3}),this.registerParameter(this.releaseParameter)}},{key:"frequency",get:function(){return this.frequencyParameter.get()},set:function(e){this.frequencyParameter.set(e)}},{key:"resonance",get:function(){return this.resonanceParameter.get()},set:function(e){this.resonanceParameter.set(e)}},{key:"harmonicity",get:function(){return this.harmonicityParameter.get()},set:function(e){this.harmonicityParameter.set(e)}},{key:"modulationIndex",get:function(){return this.modulationIndexParameter.get()},set:function(e){this.modulationIndexParameter.set(e)}},{key:"ampAttack",get:function(){return this.attackParameter.get()},set:function(e){this.attackParameter.set(e)}},{key:"ampDecay",get:function(){return this.decayParameter.get()},set:function(e){this.decayParameter.set(e)}},{key:"ampSustain",get:function(){return this.sustainParameter.get()},set:function(e){this.sustainParameter.set(e)}},{key:"ampRelease",get:function(){return this.releaseParameter.get()},set:function(e){this.releaseParameter.set(e)}},{key:"setEnvelopes",value:function(e){var t=this,n=this.getEnvelopes();n.forEach(function(e){return e.attack=new H.a.Time((1+t.ampAttack)/1e3)}),n.forEach(function(e){return e.release=new H.a.Time((1+t.ampRelease)/1e3)}),n.forEach(function(e){return e.sustain=t.ampSustain}),n.forEach(function(e){return e.decay=new H.a.Time((1+t.ampDecay)/1e3)})}},{key:"getInstrument",value:function(){return this.synth}},{key:"getEnvelopes",value:function(){return[this.synth.envelope]}},{key:"hasNotes",value:function(){return!1}},{key:"getJson",value:function(){var e=Object(p.a)({},Object(Z.a)(Object(f.a)(n.prototype),"getJson",this).call(this),{frequency:this.frequency,resonance:this.resonance,harmonicity:this.harmonicity,modulationIndex:this.modulationIndex,ampAttack:this.ampAttack,ampDecay:this.ampDecay,ampSustain:this.ampSustain,ampRelease:this.ampRelease});return e=Object(Q.b)(e,"frequencyParameter",this.frequencyParameter),e=Object(Q.b)(e,"resonanceParameter",this.resonanceParameter),e=Object(Q.b)(e,"harmonicityParameter",this.harmonicityParameter),e=Object(Q.b)(e,"modulationIndexParameter",this.modulationIndexParameter),e=Object(Q.b)(e,"attackParameter",this.attackParameter),e=Object(Q.b)(e,"decayParameter",this.decayParameter),e=Object(Q.b)(e,"sustainParameter",this.sustainParameter),e=Object(Q.b)(e,"releaseParameter",this.releaseParameter)}},{key:"fromJson",value:function(e){this.frequency=e.frequency,this.resonance=e.resonance,this.harmonicity=e.harmonicity,this.modulationIndex=e.modulationIndex,this.ampAttack=e.ampAttack,this.ampDecay=e.ampDecay,this.ampSustain=e.ampSustain,this.ampRelease=e.ampRelease,Object(Q.a)(e,"frequencyParameter",this.frequencyParameter),Object(Q.a)(e,"resonanceParameter",this.resonanceParameter),Object(Q.a)(e,"modulationIndexParameter",this.modulationIndexParameter),Object(Q.a)(e,"harmonicityParameter",this.harmonicityParameter),Object(Q.a)(e,"attackParameter",this.attackParameter),Object(Q.a)(e,"decayParameter",this.decayParameter),Object(Q.a)(e,"sustainParameter",this.sustainParameter),Object(Q.a)(e,"releaseParameter",this.releaseParameter)}}]),n}(G);function Xp(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Qp=function(e){Object(u.a)(n,e);var t=Xp(n);function n(e,r,a,i,s,u){var l;return Object(o.a)(this,n),(l=t.call(this,e,r,a,i,s,u)).setInstrument(new Kp(r,a,(new L.a).forTrack(Object(c.a)(l)))),l}return n}(nt),Yp=n(238),Zp=n(292),$p=n(232);function ed(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return td(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return td(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function td(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var nd=["A","B","C","D","E","F","G","H"],rd=function(){function e(t,n,r){Object(o.a)(this,e),this.sends=[],this.channelMixer=n,this.sequencerEngine=r,this.masterBus=new ad("Master Bus",void 0,void 0,void 0,r);var a=new ad("A",this.masterBus,n,0,r),i=new Zp.a(r);i.enable(!0),i.setWet(1),a.addEffect(i);var s=new ad("B",this.masterBus,n,1,r),c=new $p.a(r);c.enable(!0),c.setWet(1),s.addEffect(c),this.sends.push(a),this.sends.push(s),a.setSends(this),s.setSends(this)}return Object(s.a)(e,[{key:"createNewSend",value:function(e){var t=new ad(nd[this.sends.length],this.masterBus,this.channelMixer,this.sends.length,this.sequencerEngine,e);for(var n in t.setSends(this),this.sends.push(t),this.sequencerEngine.subSequences){var r=this.sequencerEngine.subSequences[n];for(var a in r.tracks)r.tracks[a].newSend(t)}return t}},{key:"dispose",value:function(){this.sends.forEach(function(e){return e.dispose()}),this.masterBus.dispose(),this.sends=void 0}},{key:"deleteSends",value:function(e){this.sends=this.sends.filter(function(t){return!e.includes(t)}),e.map(function(e){return e.dispose()})}},{key:"getSends",value:function(){return this.sends}},{key:"getJson",value:function(){return this.sends.map(function(e){return e.getJson()})}},{key:"loadFromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<t.length)){e.next=12;break}if(i=t[r],void 0===n||void 0!==i.pad){e.next=5;break}return e.abrupt("continue",9);case 5:return o=r,(i.pad||r>=this.sends.length)&&(this.createNewSend(),o=this.sends.length-1),e.next=9,this.sends[o].fromJson(i);case 9:r++,e.next=1;break;case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"copyFrom",value:function(e){var t=this;for(var n in e.sends){var r=e.sends[n].effects.map(function(e){return e.getEffectCopy(t.sequencerEngine,!1)});this.sends[n]||this.createNewSend(),this.sends[n].replaceEffects(r)}}}]),e}(),ad=function(){function e(t,n,r,a,i,s){Object(o.a)(this,e),this.name=t,this.sequencerEngine=i,this.sendNumber=a,this.inputVolume=new H.a.Volume(0),this.outputVolume=new H.a.Volume(0),this.muteableNode=new H.a.Volume(0),this.muteableNode.connect(this.outputVolume),this.pad=s,this.tracks=[],this.muted=!1,this.effectsChain=new _.a(this.inputVolume,this.muteableNode,(new L.a).forSend(this),i),void 0===n?this.inputVolume.connect(this.outputVolume):this.outputs=r.connect(this.outputVolume),this.sendNodes=[],this.channelMixer=r}return Object(s.a)(e,[{key:"outputNode",get:function(){return this.outputVolume}},{key:"dispose",value:function(){this.inputVolume.dispose(),this.outputVolume.dispose(),this.muteableNode.dispose(),this.effectsChain.dispose(),this.effectsChain=void 0,this.inputVolume=void 0,this.outputVolume=void 0,this.muteableNode=void 0,this.effectsChain=void 0}},{key:"newSend",value:function(e){var t=new H.a.Volume(-100);this.outputVolume.connect(t),e.connectToTrack(t),this.sendNodes.push(t)}},{key:"getSendNodes",value:function(){return this.sendNodes}},{key:"setSends",value:function(e){this.sends=e}},{key:"moveEffectTo",value:function(e,t){this.effectsChain.moveEffectTo(e,t)}},{key:"deleteEffect",value:function(e){this.effectsChain.deleteEffect(e)}},{key:"mute",value:function(e){this.muted=e,this.muteableNode.volume.value=e?-120:0}},{key:"updateEffects",value:function(){this.effectsChain.updateEffects()}},{key:"getVolume",value:function(){return this.outputVolume.volume.value}},{key:"setVolume",value:function(e){this.outputVolume.volume.value=e}},{key:"connectToTrack",value:function(e,t){(t=t||!1)&&e.disconnect(this.inputVolume),e.connect(this.inputVolume)}},{key:"getEffects",value:function(){return this.effectsChain.effects}},{key:"getName",value:function(){return this.name}},{key:"addEffect",value:function(e){this.effectsChain.addEffect(e),this.effectsChain.linkEffectParameters()}},{key:"getLastEffect",value:function(){return 0==this.effectsChain.effects.length?this.inputVolume:this.effectsChain.effects[this.effectsChain.effects.length-1]}},{key:"getJson",value:function(){return{pad:this.pad?this.pad.id:void 0,volume:this.getVolume(),effectsChain:this.effectsChain.getJson(),outputs:this.outputs}}},{key:"replaceEffects",value:function(e){var t=this;this.effectsChain.clear(),e.map(function(e){return t.effectsChain.addEffect(e)})}},{key:"effects",get:function(){return this.effectsChain.effects}},{key:"fromJson",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setVolume(t.volume),n=[],this.effectsChain.effects.forEach(function(e){return e.dispose()}),this.effectsChain.effects=[],n=t.effectsChain?t.effectsChain:t.effects,this.effectsJson=n,t.outputs&&(r=Object(Hr.a)(t.outputs,2),i=r[0],o=r[1],this.channelMixer.switchChannelOutput(this.outputNode,i,o)&&(this.outputs=[i,o])),t.pad&&(t.pad,this.padId=t.pad);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"hookupPads",value:function(){var e=this;if(this.pad)return!0;if(!this.padId)return this.loadEffectsJson(),!0;var t,n=void 0,r=ed(this.sequencerEngine.subSequences);try{for(r.s();!(t=r.n()).done;){var a=t.value.pads.find(function(t){return t.id===e.padId});if(a){this.pad=a,n=a;break}}}catch(i){r.e(i)}finally{r.f()}return n&&this.sequencerEngine.switchToSubSequence(n.subSequence.id),this.loadEffectsJson(),n&&(this.pad.effectRack=this.effects[0],this.pad.send=this,this.pad.syncTracksToEffects(),this.pad.updateEffectRedux()),void 0!==n}},{key:"loadEffectsJson",value:function(){if(!this._loaded){var e=this.effectsJson,t={};for(var n in e){var r=Object(F.a)(e[n],void 0,this.sequencerEngine,void 0,this.pad&&(new L.a).forSubSequence(this.pad.subSequence));this.effectsChain.addEffect(r.effect),t=Object(p.a)({},t,r.bulk)}this.sequencerEngine.store.dispatch(Object(C.Vb)(t)),this._loaded=!0}}}]),e}(),id=rd,od=function(){function e(t){Object(o.a)(this,e),this.store=t,console.log("AUDIO INPUT MANAGER"),this.input=void 0,H.a.Master.context.isOffline?console.log("offline"):(this.setupRecording(),this.splitter=void 0,this.init(),this.deviceId=void 0)}return Object(s.a)(e,[{key:"init",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("INIT CALLED"),!window.explore&&!window.isNFT){e.next=3;break}return e.abrupt("return");case 3:if(t=!window.isNFT&&k.a.getItem("deviceId"),console.log("DEVICE ID =",t),void 0===t){e.next=18;break}if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){e.next=9;break}return console.log("no media"),e.abrupt("return");case 9:return e.next=11,navigator.mediaDevices.enumerateDevices();case 11:if(!e.sent.some(function(e){return e.deviceId===t})){e.next=18;break}return e.next=15,navigator.mediaDevices.getUserMedia({audio:{deviceId:t,echoCancellation:!1}});case 15:n=e.sent,console.log("setting to input = "+t),this.newInputSource(n,t);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getInputChannels",value:function(){return void 0===this.input?[]:[1,2]}},{key:"connect",value:function(e,t){1==t?this.splitter.left.connect(e):this.splitter.right.connect(e)}},{key:"disconnect",value:function(e,t){1==t?this.splitter.left.disconnect():this.splitter.right.disconnect()}},{key:"getRecorder",value:function(){return new window.Recorder(this.input,{numChannels:1,bufferLen:1024})}},{key:"newInputSource",value:function(e,t){this.input&&this.splitter,this.startUserMedia(e),t&&(this.deviceId=t),this.store.dispatch(Object(C.S)(t))}},{key:"startUserMedia",value:function(e){H.a.Master.context.isOffline||(this.input=this.audioContext.createMediaStreamSource(e),console.log("created input=",this.input),this.monitorVolume=new H.a.Gain(1),this.splitter=new H.a.Split,this.input.chain(this.monitorVolume,this.splitter))}},{key:"dispose",value:function(){this.splitter&&this.splitter.dispose(),this.input&&this.input.disconnect(),this.input=void 0,this.splitter=void 0}},{key:"setupRecording",value:function(){var e=this;if(console.log("SETUP RECORDING"),H.a.Master.context.isOffline||window.explore||window.isNFT)console.log("YO");else{try{window.AudioContext=H.a.Master.context,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia,window.URL=window.URL||window.webkitURL,this.audioContext=H.a.Master.context}catch(t){console.log("No web audio support in this browser!")}void 0!==navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({audio:{mandatory:{echoCancellation:!1}}}).then(function(t){return e.startUserMedia(t)}).catch(function(e){console.log("No live audio input: "+e)})}}}]),e}(),sd=function(){function e(){Object(o.a)(this,e),this.latency=0}return Object(s.a)(e,[{key:"getLatency",value:function(){return this.latency}},{key:"setLatency",value:function(e){this.latency=e}}]),e}(),cd=n(67),ud=function(){function e(t){Object(o.a)(this,e),this.sequencerEngine=t}return Object(s.a)(e,[{key:"state",get:function(){return this.sequencerEngine.state}},{key:"execute",value:function(){}},{key:"undo",value:function(){}},{key:"roomName",get:function(){return"test"}},{key:"serialize",value:function(e,t){var n=Object(p.a)({},e);return n.payload=Object(p.a)({},n.payload),n.payload.track&&(n.payload.track.subSequence&&(n.payload.subSequence=n.payload.track.subSequence.id),n.payload.track=n.payload.track.trackNumber),n.contentId=this.getContentId(e),{type:"operation",operation:Object(p.a)({},n,{uuid:t,timestamp:Date.now()})}}},{key:"deserialize",value:function(e){var t=Object(p.a)({},e.payload);if(void 0!==t.track)if(void 0!==t.subSequence){var n=this.sequencerEngine.getSubSequence(t.subSequence);n&&(t.track=n.tracks[e.payload.track])}else t.track=this.sequencerEngine.tracks[e.payload.track];return e.payload.resolution&&(t.resolution=(new br.a).fromJson(e.payload.resolution)),Object(p.a)({},e,{payload:t})}},{key:"deserializeStep",value:function(e,t,n){var r=new q.a;return r.track=t,r.stepNumber=n,r.loadFromJson(e,t.effects,void 0,void 0,void 0,t,t.midiEffects),r.id=e.id,r}},{key:"getStepLocations",value:function(e,t,n){var r=e.getStepNumbers(t),a=[];for(var i in r){var o=r[i][0];a.push({id:o.id,transpose:o.transpose,stepNumber:n?r[i][1]+o.position:r[i][1]})}return a}},{key:"getStepsForStepNumbers",value:function(e,t){var n=t.getEasyPattern(),r=[],a=function(t){var a=e[t],i=n.getAllSteps().find(function(e){return e.id===a.id});i&&r.push(i)};for(var i in e)a(i);return r}},{key:"sleep",value:function(e){return new Promise(function(){var t=Object(i.a)(a.a.mark(function t(n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:setTimeout(n,e);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}},{key:"getContentId",value:function(){return 0}},{key:"getDependentActions",value:function(){return[]}},{key:"dependsOn",value:function(e){return this.getDependentActions().indexOf(e)>-1}},{key:"conflictsWith",value:function(e,t){return this.dependsOn(t.type)&&e.contentId===t.contentId}}]),e}();function ld(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var fd=function(e){Object(u.a)(n,e);var t=ld(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"serialize",value:function(e,t){var r=Object(Z.a)(Object(f.a)(n.prototype),"serialize",this).call(this,e,t),a=r.operation;return a.payload.step=a.payload.step.getJson(),r}},{key:"deserialize",value:function(e){var t=Object(Z.a)(Object(f.a)(n.prototype),"deserialize",this).call(this,e),r=t.payload,a=r.track;if(void 0!==a)return r.step=this.deserializeStep(r.step,a,r.stepNumber),t}}]),n}(ud);function hd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var pd=function(e){Object(u.a)(n,e);var t=hd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,n=e.step,r=e.stepNumber,a=e.resolution,i=void 0===a?pe.a.baseResolution:a,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=Math.floor(r);return t.sequencerEngine.resolution=i,t.getEasyPattern().deleteStepAtStepNumber(n,s,i,o),o?t.updateSteps():t.pattern.needsSync=!0,{}}},{key:"undo",value:function(e){new md(this.sequencerEngine).execute(e.payload.track,e.payload.step,e.payload.stepNumber,e.payload.resolution),e.payload.track.updateSteps()}},{key:"getContentId",value:function(e){return e.payload.step.id}}]),n}(fd);function dd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var md=function(e){Object(u.a)(n,e);var t=dd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,n=e.step,r=e.stepNumber,a=e.resolution,i=void 0===a?pe.a.baseResolution:a,o=e.displayResolution,s=void 0===o?pe.a.baseResolution:o,c=e.isRecording,u=void 0===c||c,l=e.isQuantized,f=void 0===l||l,h=e.slide,p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===t)return{};var d=Math.floor(r),m=r-d;n.slide=h;var v=t.getEasyPattern();return v.addStep(n,d,i,m,void 0,void 0,u),!f&&s.isTriplet&&v.update(),p&&this.updateRedux(n,d,m,t,i,s),{}}},{key:"state",get:function(){return this.sequencerEngine.store.getState()}},{key:"updateRedux",value:function(e,t,n,r,a,i){var o=i.transformStepAtResolution2(t+n,a);n=o-(t=Math.floor(o));var s=r.subSequence.isTrack?r.subSequence.id:r.id,c=Object(h.a)(this.state.tracks.trackSteps[s]||[]),u=Object(p.a)({},this.state.tracks.trackFills[s]||[]),l=Object(h.a)(this.state.tracks.trackStepIds[s]||[]),f=this.state.tracks.trackPianoRollSteps[s]||{},d=Object(p.a)({},this.state.tracks.trackPianoRollPositions[s]),m=this.state.tracks.trackPianoRollDurations[s]||{},v=this.state.tracks.trackPatternSteps[s]||{};f[e.transpose]=Object(p.a)({},f[e.transpose]),d[e.transpose]=Object(p.a)({},d[e.transpose]),m[e.transpose]=Object(p.a)({},m[e.transpose]),u=u||new Array(c.length).fill(!1),c[t]=!0,l[t]=e,v[r.currentPattern]=Object(h.a)(c),f[e.transpose][t]=!0,d[e.transpose][t]=n;var b=new br.a(16,!1);m[e.transpose][t]=a.transformStepAtResolution2(e.duration,b);for(var g=0;g<e.duration;g++)u[(g+t)%c.length]=!0;this.sequencerEngine.store.dispatch(Object(C.y)(s,c,f,u,l,d,m,v))}},{key:"undo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];new pd(this.sequencerEngine).execute(e.payload,t),t&&e.payload.track.updateSteps()}},{key:"getContentId",value:function(e){return e.payload.step.id}}]),n}(fd);function vd(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return bd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bd(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function bd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var yd=function(e){Object(u.a)(n,e);var t=gd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t,n=e.effect,r=e.parameters,a=(!(arguments.length>1&&void 0!==arguments[1])||arguments[1],{}),i=vd(r);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.hasGroup&&(a[o.id]=o.hasGroup);var s=n._parameters.indexOf(o);n.unmapParameter(s)}}catch(c){i.e(c)}finally{i.f()}return{idToGroup:a}}},{key:"undo",value:function(e){var t=e.payload,n=t.parameters,r=t.idToGroup,a=t.effect;n.forEach(function(e){a.setParameter(e),r[e.id]&&(r[e.id]._parameters.push(e),e.hasGroup=r[e.id])})}}]),n}(ud),kd=n(186);function Od(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var jd=function(e){Object(u.a)(n,e);var t=Od(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){e.effect,e.track,e.group,e.send}},{key:"undo",value:function(e){}},{key:"serialize",value:function(e,t){var r=Object(Z.a)(Object(f.a)(n.prototype),"serialize",this).call(this,e,t),a=r.operation,i=a.payload;return void 0!==i.group&&(i.group=i.group.groupNumber),void 0!==a.send&&(i.send=i.send.sendNumber),i.isMidiEffect=i.effect.isMidiEffect(),i.effect=i.effectJson,r}},{key:"deserialize",value:function(e){var t,r=Object(Z.a)(Object(f.a)(n.prototype),"deserialize",this).call(this,e),a=r.payload,i=a.track||a.group||a.send;return a.isMidiEffect?void 0===(t=i.midiEffects.getEffectById(a.effect.id))&&(t=Object(kd.a)(a.effect,i)).fromJson(a.effect):void 0===(t=i.effectsChain.getEffectById(a.effect.id))&&(t=Object(sa.b)(a.effect.name,this.sequencerEngine)).fromJson(a.effect,this.sequencerEngine.tracks,a.track.trackNumber),a.effect=t,r}}]),n}(ud);function wd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ed=function(e){Object(u.a)(n,e);var t=wd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.effect,n=e.track,r=e.group,a=e.send,i=n||r||a;t.isMidiEffect()?i.midiEffects.addEffect(t):i.effectsChain.addEffect(t)}}]),n}(jd);function Sd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Pd=function(e){Object(u.a)(n,e);var t=Sd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.effect,n=e.track,r=e.group,a=e.send,i=n||r||a,o=t.getJson();switch(t.getEffectType()){case re.a:i.effectsChain.deleteEffect(t);break;case re.c:i.midiEffects.deleteEffect(t);break;case re.b:i.liveEffects.deleteEffect(t)}return this.sequencerEngine.selectEffect(void 0),{effectJson:o}}}]),n}(jd);function xd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Td=function(e){Object(u.a)(n,e);var t=xd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.effect,n=e.track,r=e.group,a=e.send,i=n||r||a;t.toggleEnabled(),i&&!t.isMidiEffect()&&i.effectsChain&&i.effectsChain.updateEffects()}}]),n}(jd);function Cd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Nd=function(e){Object(u.a)(n,e);var t=Cd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.from,n=e.to,r=e.isMidiEffect,a=void 0!==r&&r,i=e.track,o=e.group,s=e.send,c=i||o||s;a?c.midiEffects.moveEffectTo(t,n):c.effectsChain.moveEffectTo(t,n),i&&i.updateSteps()}},{key:"undo",value:function(e){}},{key:"serialize",value:function(e,t){var r=Object(Z.a)(Object(f.a)(n.prototype),"serialize",this).call(this,e,t),a=r.operation,i=a.payload;return void 0!==i.group&&(i.group=i.group.groupNumber),void 0!==a.send&&(i.send=i.send.sendNumber),r}}]),n}(ud);function Rd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Md=function(e){Object(u.a)(n,e);var t=Rd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,n=e.stepNumber,r=e.resolution,a=void 0===r?pe.a.baseResolution:r,i=t.getEasyPattern(),o=i.getStepsAtStepNumber(n,a),s=o.map(function(e){return Object(p.a)({},e,{step:e.step.getCopy()})});return i.deleteSteps(o.map(function(e){return e.step})),t.updateSteps(),{stepsDeleted:s}}},{key:"undo",value:function(e){}}]),n}(ud);function Ad(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return qd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qd(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function qd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Id=0,_d=function(e){Object(u.a)(n,e);var t=Dd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,n=e.steps,r=e.transformation,a=e.resolution,i=void 0===a?pe.a.baseResolution:a,o=e.wrap,s=void 0===o||o,c=e.isPianoRoll,u=void 0!==c&&c,l=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],f=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return{};var p=t.getEasyPattern(),d=p.getStepNumbers(n,i).filter(function(e){return e[0]}),m=new Set(d.filter(function(e){return e&&e[0]}).map(function(e){return e[0].transpose})),v=t.getEasyPattern().transformSteps(n,d,r,i,s,u),b=new Set(v.filter(function(e){return e}).map(function(e){return e.transpose}));if(l)if(f){var g=++Id;setTimeout(function(){g===Id&&t.updateSteps(!u,!0,i.isTriplet)},50)}else u&&this.sequencerEngine.state.sequencer.displayResolution.isTriplet&&p.update(),u||i.isTriplet||t.getEasyPattern().pattern.syncMatrix(),u?this.updateReduxForRows(m,b,t,i.isTriplet):t.updateSteps(!u&&i.isTriplet,!0,i.isTriplet);var y=this.sequencerEngine.store.getState().keyboard.selectedPianoRollSteps;if(l&&!f&&y){var k=function(e){if(y[e]){var t=v.find(function(t){return t&&t.id===y[e].id});y[e]=t}};for(var O in y)k(O);this.sequencerEngine.store.dispatch(Object(C.jf)(Object(h.a)(y)))}return{stepNumbers:d}}},{key:"updateReduxForRows",value:function(e,t,n,r){if(n){var a,i=n.id,o=Object(p.a)({},this.state.tracks.trackPianoRollSteps[i]),s=Object(p.a)({},this.state.tracks.trackPianoRollPositions[i]),c=Object(p.a)({},this.state.tracks.trackPianoRollDurations[i]),u=n.getEasyPattern().pattern.getUpdateStepsAction(r),l=Ad([].concat(Object(h.a)(Array.from(e)),Object(h.a)(Array.from(t))));try{for(l.s();!(a=l.n()).done;){var f=a.value;o[f]=u.pianoRollSteps[f],c[f]=u.pianoRollDurations[f],s[f]=u.pianoRollPositions[f]}}catch(m){l.e(m)}finally{l.f()}var d=this.state.tracks.trackPatternSteps[i]||{};d[n.currentPattern]=u.steps,this.sequencerEngine.store.dispatch(Object(C.y)(i,u.steps,o,u.trackFills,u.stepToId,s,c,d))}}},{key:"undo",value:function(e){var t=Object(p.a)({},e.payload.transformation);t.stepDifference=-1*t.stepDifference,t.transposeDifference=-1*t.transposeDifference,this.execute(Object(p.a)({},e.payload,{transformation:t}))}},{key:"serialize",value:function(){var e=Object(i.a)(a.a.mark(function e(t,r){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(Z.a)(Object(f.a)(n.prototype),"serialize",this).call(this,t,r),(o=i.operation).payload.steps=o.payload.steps.filter(function(e){return e}).map(function(e){return e.id}),o.payload.stepNumbers=o.payload.stepNumbers.filter(function(e){var t=Object(Hr.a)(e,2),n=t[0];t[1];return n}).map(function(e){var t=Object(Hr.a)(e,2),n=t[0],r=t[1];return[n.id,r]}),e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"deserialize",value:function(e){var t=Object(Z.a)(Object(f.a)(n.prototype),"deserialize",this).call(this,e),r=t.payload,a=r.track;if(void 0!==a){var i=r.steps;return r.steps=this.getStepsForStepNumbers(i.map(function(e){return{id:e}}),a,pe.a.baseResolution),t}}},{key:"getContentId",value:function(e){return e.payload.steps.map(function(e){return e&&e.id})}}]),n}(ud);function Fd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ld=function(e){Object(u.a)(n,e);var t=Fd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,n=e.steps,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===t)return{stepsDeleted:[]};var a=t.getEasyPattern().getStepNumbers(n,pe.a.baseResolution);return t.getEasyPattern().deleteSteps(n),r&&t.updateSteps(),t.sequencerEngine.dispatch(Object(C.jf)(void 0)),{stepsDeleted:a}}},{key:"undo",value:function(e){var t=new md(this.sequencerEngine),n=e.payload.stepsDeleted;for(var r in n)t.execute({track:e.payload.track,step:n[r][0],stepNumber:n[r][1],resolution:pe.a.baseResolution});e.payload.track.updateSteps()}},{key:"serialize",value:function(e,t){var r=Object(Z.a)(Object(f.a)(n.prototype),"serialize",this).call(this,e,t),a=r.operation;return a.payload.steps=a.payload.steps.map(function(e){return e.getJson()}),a.payload.stepsDeleted=a.payload.stepsDeleted.map(function(e){var t=Object(Hr.a)(e,2),n=t[0],r=t[1];return[n.getJson(),r]}),r}},{key:"deserialize",value:function(e){var t=this,r=Object(Z.a)(Object(f.a)(n.prototype),"deserialize",this).call(this,e),a=r.payload,i=a.track;if(void 0!==i){var o=a.steps.map(function(e){return t.deserializeStep(e,i,e.stepNumber)});return a.steps=this.getStepsForStepNumbers(o,i,pe.a.baseResolution),r}}},{key:"getContentId",value:function(e){return e.payload.steps.map(function(e){return e&&e.id})}}]),n}(ud);function Bd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var zd=function(e){Object(u.a)(n,e);var t=Bd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,n=e.steps,r=e.stepNumber,a=e.resolution,i=void 0===a?pe.a.baseResolution:a,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===t)return{steps:[]};t.instrumentTrack&&(t=t.instrumentTrack);var s=t.getEasyPattern().pattern.getStepResolutionTree(i.isTriplet).search(r,i).toggle(n&&n[0]?n[0].stepBucket.steps[0].id:void 0);return t.pattern.syncMatrix(),o&&(t.pattern.syncBucketsAtStep(r,i),t.updateSteps(void 0,!0)),t.pattern.needsSync=!0,{steps:s}}},{key:"undo",value:function(e){var t=e.payload.track.getEasyPattern();if(void 0!==e.payload.steps){var n=e.payload.resolution.isTriplet?t.pattern.tripletStepBuckets:t.pattern.stepBuckets;for(var r in e.payload.steps){var a=e.payload.steps[r];n[a.stepNumber]=a.stepBucket}}t.update(e.payload.resolution.isTriplet),e.payload.track.updateSteps()}},{key:"serialize",value:function(e,t){var r=Object(Z.a)(Object(f.a)(n.prototype),"serialize",this).call(this,e,t),a=r.operation;return a.payload.steps&&(a.payload.steps=a.payload.steps.map(function(e){return Object(p.a)({},e,{stepBucket:e.stepBucket.getJson()})})),r}},{key:"deserialize",value:function(e){var t=Object(Z.a)(Object(f.a)(n.prototype),"deserialize",this).call(this,e),r=t.payload;if(void 0!==r.track){var a=r.track,i=[];if(e.payload.steps)for(var o in e.payload.steps){var s=e.payload.steps[o],c=s.stepBucket,u=s.stepNumber,l=new D.a(a,c.isTriplet);for(var h in c){var p=c[h],d=new q.a;d.track=a,d.stepNumber=u,d.loadFromJson(p,a.effects,void 0,void 0,void 0,a,a.midiEffects),d.id=p.id,l.steps[h]=d}i.push({stepNumber:u,stepBucket:l})}return r.steps=i,t}}},{key:"getContentId",value:function(e){return e.payload.steps[0].id}}]),n}(ud);function Vd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Hd=function(e){Object(u.a)(n,e);var t=Vd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.patternNumber,n=this.sequencerEngine.tracks.map(function(e){return e.patterns[t]});return this.sequencerEngine.deletePattern(t),{patterns:n,patternNumber:t}}},{key:"undo",value:function(e){var t=e.payload.patterns,n=e.payload.patternNumber;for(var r in t){var a=this.sequencerEngine.tracks[r],i=a.patterns.slice(0,n).concat([t[r]]).concat(a.patterns.slice(n));a.patterns=i,a.switchToPattern(a.currentPattern),a.updateSteps()}this.sequencerEngine.store.dispatch(Object(C.yd)(this.sequencerEngine.numberOfPatterns()))}}]),n}(ud);function Ud(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Jd=function(e){Object(u.a)(n,e);var t=Ud(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,r=e.step,a=e.stepNumber,i=e.resolution,o=void 0===i?pe.a.baseResolution:i,s=e.displayResolution,c=void 0===s?pe.a.baseResolution:s,u=e.isQuantized,l=void 0===u||u,h=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(Z.a)(Object(f.a)(n.prototype),"execute",this).call(this,{track:t,step:r,stepNumber:a,resolution:o,isRecording:!0,displayResolution:c,isQuantized:l},h)}}]),n}(md);function Gd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Wd=0,Kd=function(e){Object(u.a)(n,e);var t=Gd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,n=(e.step,e.parameter),r=e.value,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=n.get();if(n.set(r),a)if(i){var s=++Wd;setTimeout(function(){s===Wd&&t.updateSteps()},50)}else t.updateSteps();return{previousValue:o}}},{key:"state",get:function(){return this.sequencerEngine.store.getState()}},{key:"undo",value:function(e){var t=e.payload;this.execute(Object(p.a)({},t,{value:t.savedValue}))}},{key:"serialize",value:function(e,t){var r=Object(Z.a)(Object(f.a)(n.prototype),"serialize",this).call(this,e,t),a=r.operation;return a.payload.step=a.payload.step.id,a.payload.parameter=a.payload.parameter.name,r}},{key:"deserialize",value:function(e){var t=Object(Z.a)(Object(f.a)(n.prototype),"deserialize",this).call(this,e),r=t.payload,a=r.track;if(void 0!==a&&(r.step=this.getStepsForStepNumbers([{id:r.step}],a)[0],void 0!==r.step))return r.parameter=r.step.parameters.find(function(e){return e.name===r.parameter}),t}},{key:"getContentId",value:function(e){return[e.payload.parameter.id,e.payload.step.id]}}]),n}(ud);function Xd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Qd=function(e){Object(u.a)(n,e);var t=Xd(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"serialize",value:function(e,t){var r=Object(Z.a)(Object(f.a)(n.prototype),"serialize",this).call(this,e,t),a=r.operation.payload;if(a.parameter){var i=a.parameter,o=i.id,s=i.context,c=i.name;a.parameter={id:o,context:s&&s.getJson(),name:c}}if(a.automation){var u=a.automation.parameter;u&&(a.parameter=u.getJson()),a.automation=a.automation.id}return r}},{key:"deserialize",value:function(e){var t=Object(Z.a)(Object(f.a)(n.prototype),"deserialize",this).call(this,e),r=t.payload,a=r.parameter,i=(a.id,a.name),o=a.context;if(void 0!==o.track&&(r.track=this.sequencerEngine.tracks[o.track]),void 0!==o.subTrack&&(r.track=r.track.tracks[o.subTrack].track),void 0!==o.midiEffect){if(r.track){var s=r.track.midiEffects.effects[o.midiEffect].parameters.find(function(e){return e.name===i});r.parameter=s||void 0}}else if(void 0!==o.effect&&-1!==o.effect){if(r.track){var c=r.track.effects[o.effect];o.subDevice&&(c=c.getSubDevice(o.subDevice)),o.macro&&(c=c.macros.find(function(e){return e.id===o.macro}));var u=c.getParameters().find(function(e){return e.name===i});r.parameter=u||void 0}}else if(o.isInstrument)if(r.instrument=r.track.instrument,o.subDevice){var l=r.instrument.getSubDevice(o.subDevice);r.parameter=l.parameters.find(function(e){return e.name===i})}else r.parameter=r.instrument.parameters.find(function(e){return e.name===i});else r.parameter=void 0;return r.automation&&r.parameter&&(r.automation=r.parameter.unlockedAutomation),t}},{key:"getContentId",value:function(e){var t=e.payload;return t.point?t.point.id:t.parameter?t.parameter.id:0}}]),n}(ud);function Yd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Zd=function(e){Object(u.a)(n,e);var t=Yd(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.parameter,n=e.value,r=e.automation,a=void 0!==r&&r,i=e.isBulk,o=void 0!==i&&i;void 0!==t&&t.set(n,a,o)}},{key:"undo",value:function(e){var t=e.payload;t.parameter.set(t.savedValue)}},{key:"getContentId",value:function(e){return e.payload.parameter.id}}]),n}(Qd);function $d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var em=function(e){Object(u.a)(n,e);var t=$d(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,n=e.steps,r=e.resolution,a=void 0===r?pe.a.baseResolution:r,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=t.getEasyPattern(),s=o.getStepNumbers(n,a);for(var c in s){var u=s[c][0];u&&(s[c][1]=s[c][1]+u.position,s[c][0]=u.id)}var l=this.getStepLocations(o,n,!0);o.snapToGrid(n,a);var f=this.getStepLocations(o,n,!1);for(var h in f)f[h].stepDifference=f[h].stepNumber-l[h].stepNumber,f[h].transposeDifference=f[h].transpose-l[h].transpose;return i&&(a.isTriplet?t.updateSteps(void 0,void 0,!0):t.updateSteps()),{stepNumbers:s,stepLocations:f}}},{key:"undo",value:function(e){var t=e.payload,n=t.stepNumbers,r=t.steps,a=t.track,i=t.resolution,o=a.getEasyPattern().getStepNumbers(r,i),s=new _d(this.sequencerEngine);for(var c in o){var u=o[c][1],l=n[c][1],f=(r[c],{stepDifference:l-u,transposeDifference:0});s.execute({track:a,steps:r,transformation:f,resolution:i})}}},{key:"serialize",value:function(e,t){var r=Object(Z.a)(Object(f.a)(n.prototype),"serialize",this).call(this,e,t),a=r.operation;return a.payload.steps=a.payload.steps.map(function(e){return e.getJson()}),r}},{key:"deserialize",value:function(e){var t=this,r=Object(Z.a)(Object(f.a)(n.prototype),"deserialize",this).call(this,e),a=r.payload,i=a.track;if(void 0!==i){var o=a.steps.map(function(e){return t.deserializeStep(e,i,e.stepNumber)});return a.steps=this.getStepsForStepNumbers(o,i,pe.a.baseResolution),r}}},{key:"getContentId",value:function(e){return e.payload.steps.map(function(e){return e.id})}}]),n}(ud);function tm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var nm=function(e){Object(u.a)(n,e);var t=tm(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,n=e.value;t&&!isNaN(n)&&t.setVolume(n)}}]),n}(ud);function rm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var am=function(e){Object(u.a)(n,e);var t=rm(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.track,n=e.mute;t&&t.mute(n)}}]),n}(ud);function im(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var om=function(e){Object(u.a)(n,e);var t=im(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.automation,n=e.step,r=e.value,a=e.pointId;return{point:t.addBreakPoint(n,r,a)}}},{key:"undo",value:function(e){var t=e.payload;t.automation.removeBreakPoint(t.point)}}]),n}(Qd);function sm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var cm=function(e){Object(u.a)(n,e);var t=sm(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.automation,n=e.point;t.removeBreakPoint(n)}},{key:"undo",value:function(e){var t=e.payload;t.automation.addBreakPoint(t.point.step,t.point.value,t.point.id)}}]),n}(Qd);function um(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var lm=function(e){Object(u.a)(n,e);var t=um(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.automation,n=e.points;t.removeBreakPoints(n)}},{key:"undo",value:function(e){var t=e.payload,n=t.automation;t.points.forEach(function(e){return n.addBreakPoint(e.step,e.value,e.id)})}}]),n}(Qd);function fm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var hm=function(e){Object(u.a)(n,e);var t=fm(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.automation,n=e.point,r=e.step,a=e.value;t.movePoint(n,r,a)}},{key:"undo",value:function(e){var t=e.payload;this.execute(Object(p.a)({},t,{step:t.savedStep,value:t.savedValue}))}}]),n}(Qd);function pm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var dm=function(e){Object(u.a)(n,e);var t=pm(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.automation,n=e.points,r=e.stepDiff,a=e.valueDiff;t.movePoints(n,r,a)}}]),n}(Qd);function mm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var vm=function(e){Object(u.a)(n,e);var t=mm(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.automation,n=e.point,r=n.getJson?n.getJson():n;return t.quantizePoint(n),{savedPoint:r}}},{key:"undo",value:function(e){var t=e.payload;t.automation.movePoint(t.point,t.savedPoint.step,t.savedPoint.value)}}]),n}(Qd);function bm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function gm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ym=function(e){Object(u.a)(n,e);var t=gm(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.automation,n=e.value,r=e.oldValue;return{points:t.record(n,r),automation:t}}},{key:"undo",value:function(e){var t=e.payload;t.points.forEach(function(e){return t.automation.removeBreakPoint(e)})}}]),n}(function(e){Object(u.a)(n,e);var t=bm(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"serialize",value:function(e,t){var r=Object(Z.a)(Object(f.a)(n.prototype),"serialize",this).call(this,e,t);if(void 0===(e=e.payload))return r;var a=e.automation;if(void 0===a)return r;var i=a.parameter;return r.automation=a.id,r.parameter=i,r}},{key:"deserialize",value:function(e){var t=Object(Z.a)(Object(f.a)(n.prototype),"deserialize",this).call(this,e);t.payload;return t}}]),n}(ud));function km(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Om(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Om(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Om(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var wm=function(e){Object(u.a)(n,e);var t=jm(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e.tracks,n=e.patternToLoad,r=[],a=1;this.sequencerEngine.tracks.length>0&&(a=this.sequencerEngine.tracks[0].patterns.length),this.sequencerEngine.loadLFOsAndEnvelopes(t[0]);var i,o=km(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;r.push(_r(Object(p.a)({},s,{subSequence:this.sequencerEngine.currentSubSequence,sequencerEngine:this.sequencerEngine,tracks:this.sequencerEngine.tracks,numPatterns:a,patternToLoad:n})))}}catch(u){o.e(u)}finally{o.f()}var c=this.sequencerEngine;return Promise.all(r).then(function(e){var t=c.groups.newGroup();e.forEach(function(e){var n=c.tracks.length;c.setupNewTrack(e,void 0,!0,!1),e.setupEffects(),e.trackNumber=n,t.addTrack(e)}),c.updateTracks(!0)}),{addedTracks:r}}},{key:"undo",value:function(e){var t=this,n=e.payload;Promise.all(n.addedTracks).then(function(e){t.sequencerEngine.deleteTracks(e),t.sequencerEngine.updateTracks()})}}]),n}(ud);function Em(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Sm=function(e){Object(u.a)(n,e);var t=Em(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"execute",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.preset,i=t.loadMods,o=t.loadEffects,s=this.sequencerEngine.getTrackPreset(n.trackNumber),c=n.preset?n.preset.name:void 0,u=n.preset,e.next=6,this.sequencerEngine.auditionPreset(r,n.trackNumber,i,o);case 6:return e.abrupt("return",{presetJson:s,presetName:c,savedPreset:u});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"undo",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,r=n.track,i=n.presetJson,o=n.presetName,s=n.savedPreset,e.next=4,this.sequencerEngine.auditionPreset({data:i,presetName:o},r.trackNumber,!0,!0,!1);case 4:r.presetName=o,s&&(r.preset=s,r.preset.name=o);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),n}(ud),Pm=function(){function e(t){Object(o.a)(this,e),this.addStepAction=new md(t),this.deleteStepAction=new pd(t),this.deleteStepNumberAction=new Md(t),this.moveStepsAction=new _d(t),this.deleteStepsAction=new Ld(t),this.toggleStepAction=new zd(t),this.deletePatternAction=new Hd(t),this.recordStepAction=new Jd(t),this.updateStepParameterAction=new Kd(t),this.addEffectAction=new Ed(t),this.deleteEffectAction=new Pd(t),this.toggleEffectAction=new Td(t),this.moveEffectAction=new Nd(t),this.updateParameterAction=new Zd(t),this.updateTrackVolumeAction=new nm(t),this.updateTrackMuteAction=new am(t),this.addAutomationBreakPointAction=new om(t),this.removeAutomationBreakPointAction=new cm(t),this.removeAutomationBreakPointsAction=new lm(t),this.moveAutomationBreakPointAction=new hm(t),this.moveAutomationBreakPointsAction=new dm(t),this.snapToGridAction=new em(t),this.snapAutomationBreakPoint=new vm(t),this.recordAutomationAction=new ym(t),this.loadProjectTracks=new wm(t),this.unmapPlanarParameters=new yd(t),this.auditionPreset=new Sm(t)}return Object(s.a)(e,[{key:"getAction",value:function(e){switch(e.type){case cd.c:return this.addStepAction;case cd.h:return this.deleteStepAction;case cd.j:return this.deleteStepNumberAction;case cd.q:return this.recordStepAction;case cd.o:return this.moveStepsAction;case cd.i:return this.deleteStepsAction;case cd.w:return this.toggleStepAction;case cd.g:return this.deletePatternAction;case cd.z:return this.updateStepParameterAction;case cd.b:return this.addEffectAction;case cd.f:return this.deleteEffectAction;case cd.v:return this.toggleEffectAction;case cd.n:return this.moveEffectAction;case cd.y:return this.updateParameterAction;case cd.B:return this.updateTrackVolumeAction;case cd.A:return this.updateTrackMuteAction;case cd.a:return this.addAutomationBreakPointAction;case cd.r:return this.removeAutomationBreakPointAction;case cd.s:return this.removeAutomationBreakPointsAction;case cd.l:return this.moveAutomationBreakPointAction;case cd.m:return this.moveAutomationBreakPointsAction;case cd.u:return this.snapToGridAction;case cd.t:return this.snapAutomationBreakPoint;case cd.k:return this.loadProjectTracks;case cd.d:return this.auditionPreset;case cd.p:return this.recordAutomationAction;case cd.x:return this.unmapPlanarParameters;default:return}}},{key:"makeCopyOfAction",value:function(e){var t;switch(e.type){case cd.c:case cd.h:case cd.q:return(t=Object(p.a)({},e)).payload.step=t.payload.step.getCopy(!0,!0,!0),t;case cd.o:return(t=Object(p.a)({},e)).payload.steps=e.payload.steps,t;case cd.i:return(t=Object(p.a)({},e)).payload.steps=e.payload.steps.map(function(e){return e.getCopy(!0,!0,!0)}),t;case cd.z:case cd.y:return(t=Object(p.a)({},e)).payload.savedValue=e.payload.parameter.get(),t;case cd.l:return(t=Object(p.a)({},e)).payload.savedStep=e.payload.point.step,t.payload.savedValue=e.payload.point.value,t;default:return Object(p.a)({},e)}}}]),e}();function xm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Tm=function(e,t){return Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]),e.sort(),t.sort(),e.length===t.length&&e.every(function(e,n){return e===t[n]})},Cm=function(e,t){var n=e.operation;if(Mm(n.type))return Nm(e,t);for(var r=t.length-1;r>=0;r--){if(!Rm(n,t[r]))break}var a=t[r+1];return a&&void 0!==a.operation.payload.savedValue&&(e.operation.payload.savedValue=a.operation.payload.savedValue),[].concat(Object(h.a)(t.slice(0,r+1)),[e])},Nm=function(e,t){for(var n=e.operation,r=t.length-1;r>=0;r--){var a=t[r];if(!Rm(n,a)){r++;break}n=Im(n,a.operation)}return[].concat(Object(h.a)(t.slice(0,r)),[Object(p.a)({},e,{operation:n})])};function Rm(e,t){return t.length&&(t=t[t.length-1]),t.operation&&(t=t.operation),(e.type===t.type||e.type===cd.u&&t.type===cd.o)&&(!!qm(e.type)&&Tm(e.contentId,t.contentId))}var Mm=function(e){return Am.has(e)},Am=new Set([cd.o,cd.u]),qm=function(e){return Dm.has(e)},Dm=new Set([cd.z,cd.B,cd.l,cd.m,cd.o,cd.u]),Im=function(e,t){var n=e.payload,r=t.payload;if(e.type===cd.o){var a=n.transformation,i=r.transformation,o={stepDifference:a.stepDifference+i.stepDifference,transposeDifference:a.transposeDifference+i.transposeDifference};return Object(p.a)({},t,{payload:Object(p.a)({},r,{transformation:o})})}if(e.type===cd.u&&t.type===cd.o){var s=e.payload.stepLocations,c=r.transformation,u={stepDifference:c.stepDifference+s[0].stepDifference,transposeDifference:c.transposeDifference+s[0].transposeDifference};return Object(p.a)({},t,{payload:Object(p.a)({},r,{transformation:u})})}return e};function _m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Fm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Lm=function(e){Object(u.a)(n,e);var t=Fm(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).sequencerEngine=e,r.uuids=new Set,r}return Object(s.a)(n,[{key:"dispatch",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]&&s[1],r=s.length>2&&void 0!==s[2]&&s[2],!(!n&&this.roomActionsManager&&this.roomActionsManager.actionsRemaining<=0)){e.next=4;break}return e.abrupt("return",{});case 4:if(i=this.makeCopyOfAction(t),void 0!==this.getAction(t)){e.next=7;break}return e.abrupt("return",{});case 7:return e.next=9,this.runAction(t,!r,n);case 9:if(o=e.sent,i.payload=Object(p.a)({},i.payload,o),n){e.next=14;break}return e.next=14,this.logAction(i);case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"runAction",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getAction(e);if(void 0!==r)return r.execute(e.payload,t,n)}}]),n}(function(e){return function(e){Object(u.a)(n,e);var t=_m(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).executedActions=[],e.undoneActions=[],e.queuedActions=[],e.queuedContentIds=[],e}return Object(s.a)(n,[{key:"logAction",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(j.uuid)(),r=this.getAction(t),e.next=4,this._logAction(n,r,t);case 4:i=e.sent,t=Object(p.a)({},t,{payload:Object(p.a)({},t.payload),contentId:r.getContentId(t)}),Mm(t.type)?void 0===(o=this.lastAction)?this.executedActions.push(t):(s=this.getAction(o.operation).deserialize(o.operation),i?this.executedActions[this.executedActions.length-1]=s:this.executedActions.push(s)):i?this.executedActions[this.executedActions.length-1]=this.combineWithLast(t):this.executedActions.push(Object(p.a)({},t,{uuid:n})),this.executedActions[this.executedActions.length-1].uuid=this.lastAction?this.lastAction.operation.uuid:n;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"undo",value:function(){if(this.executedActions.length>0){var e=this.executedActions.pop();if(this.undoAction(e,!1),this.undoneActions.push(e),cd.e.indexOf(e.type)>-1){var t=this.executedActions[this.executedActions.length-1];if(void 0===t)return void this.sequencerEngine.updateTracks(!0);this.shouldAlsoUndo(e,t)?this.undo():this.sequencerEngine.updateTracks(!0)}else console.log("NOTE BATCHED SO UPDATE"),this.sequencerEngine.updateTracks(!0)}}},{key:"undoAction",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAction(e);return void 0===n?{}:(this.roomActionsManager&&this.roomActionsManager.removeActionWithId(e.uuid),n.undo(e,t))}},{key:"shouldAlsoUndo",value:function(e,t){return-1!==cd.e.indexOf(t.type)&&Math.abs(e.timestamp-t.timestamp)<5e3}},{key:"redo",value:function(){if(this.undoneActions.length>0){var e=this.undoneActions.pop();this.runAction(e),this.logAction(e),this.sequencerEngine.updateTracks(!0)}}},{key:"_logAction",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.serialize(r,t);case 2:if(!(i=e.sent)){e.next=10;break}return o=this.queuedActions.length,this.queuedActions=Cm(i,this.queuedActions),s=this.queuedActions.length,this.updateQueuedContentIds(),this.queuedActions[this.queuedActions.length-1].operation.uuid=t,e.abrupt("return",s===o);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"updateQueuedContentIds",value:function(){var e=new Set;for(var t in this.queuedActions){var n=this.queuedActions[t].operation;Array.isArray(n.contentId)?n.contentId.forEach(function(t){return e.add(t)}):e.add(n.contentId)}e.size!==this.queuedContentIds.length&&(this.queuedContentIds=Array.from(e))}},{key:"combineWithLast",value:function(e){var t=this.executedActions[this.executedActions.length-1];return t&&void 0!==t.payload.savedValue&&(e.payload.savedValue=t.payload.savedValue),e}},{key:"lastAction",get:function(){return this.queuedActions[this.queuedActions.length-1]}}]),n}(e)}(function(e){return function(e){Object(u.a)(n,e);var t=xm(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setupSyncing",value:function(){}},{key:"onSyncedOperation",value:function(e){var t=e.operation,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.uuids.has(t.uuid)){var r=this.getAction(t);void 0!==r&&void 0!==(r=r.deserialize(t))&&this.dispatch(r,!0,n)}}}]),n}(e)}(Pm))),Bm=n(423);function zm(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Vm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vm(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Vm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Hm=0;window.Tone=H.a;var Um=function(){function e(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:H.a.Transport;var n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;Object(o.a)(this,e),this.isOffline=a,this.idToParameter={},this.stereoOnly=r,this.engineId=Hm++,this.transport.swingSubvision="16n",this.ethereum=In.a,this.context=H.a.Master.context,this.idToObject={},this.nameToObjects={},this.tickingObjects=[],this.store=t,this.encryptedIpfs=new Bm.a(this.store,In.a.guilds,In.a.encryption,In.a.crypto),this.mix=new pa.a(this),this.channelMixer=zp.use(this),this.audioInputManager=new od(this.store),this.sends=new id(!1,this.channelMixer,this),this.subSequences=[],this.newSubSequence(),this.audioSettings=new sd,this.recordingsCounter=1,this.operationManager=new Lm(this),this.parameterLocks=[new Mp,new Mp],void 0!==n?this.aubio=n:this.initAubio(),window.sequencerEngine=this,this.resampleConfig={samplesPerNote:1}}return Object(s.a)(e,[{key:"initAudioWorklets",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.audioWorkletsInitialized){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,H.a.Master.context.audioWorklet.addModule(window.isNFT?"clipper.js":"/clipper.js");case 4:console.log("INITIALIZING WAVE FOLDER"),this.audioWorkletsInitialized=!0;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"transport",get:function(){return H.a.Transport}},{key:"initAubio",value:function(){var e=this;window.Aubio().then(function(t){e.aubio=t}),window.genish.export(window),window.utilities.ctx=this.context._context,window.play=function(e,t){var n="ugen"+Math.round(1e5*Math.random());return window.utilities.playWorklet(e,n,void 0,void 0,!1,!1,t)}}},{key:"newSubSequence",value:function(e,t){var n=new Zf(this,void 0!==t);return t&&n.addTrack(t),void 0!==e&&n.setId(e),this.addSubSequence(n,void 0===t),this.scenes&&this.scenes.newSubSequence(),n}},{key:"deleteSubSequence",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentSubSequence.id;if(1!==this.subSequences.length){var t=-1;for(var n in this.subSequences)if(this.subSequences[n].id===e){t=n;break}if(!(t<0)){this.scenes.deleteSubSequence(t);var r=this.subSequences.filter(function(t){return t.id!==e})[0];this.switchToSubSequence(r.id),this.subSequences[t].dispose(),this.subSequences.splice(t,1),this.store.dispatch(Object(C.Jg)(this.engineId,this.subSequences.map(function(e){return e.id})))}}}},{key:"addSubSequence",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.subSequences.push(e),this.currentSubSequence=e,this.store.dispatch(Object(C.Jg)(this.engineId,this.subSequences.map(function(e){return e.id}))),this.store.dispatch(Object(C.Ab)(e.id,0)),t&&this.store.dispatch(Object(C.Db)(this.engineId,this.currentSubSequence.id))}},{key:"switchToSubSequence",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.subSequences.filter(function(t){return t.id===e})[0];void 0!==n&&(this.currentSubSequence=n,this.store.dispatch(Object(C.Db)(this.engineId,this.currentSubSequence.id)),this.store.dispatch(Object(C.yd)(this.currentSubSequence.id,this.numberOfPatterns())),t&&(this.updateTracks(),this.tracks[0]&&this.switchToPattern(this.tracks[0].currentPattern)),this.groups.updateGroups())}},{key:"switchToNextSubSequence",value:function(){var e=this.subSequences.indexOf(this.currentSubSequence);e<this.subSequences.length-1?e++:e=0,this.switchToSubSequence(this.subSequences[e].id)}},{key:"switchToPreviousSubSequence",value:function(){var e=this.subSequences.indexOf(this.currentSubSequence);e>0?e--:e=this.subSequences.length-1,this.switchToSubSequence(this.subSequences[e].id)}},{key:"mixes",get:function(){return[].concat(Object(h.a)(this.subSequences.map(function(e){return e.mix})),[this.mix])}},{key:"tracks",get:function(){return this.currentSubSequence.tracks},set:function(e){this.currentSubSequence.tracks=e}},{key:"groups",get:function(){return this.currentSubSequence.groups},set:function(e){this.currentSubSequence.groups=e}},{key:"sequenceId",get:function(){return this.getSequenceId()}},{key:"getSequenceId",value:function(){return void 0===this.loadedSequenceId?0:this.loadedSequenceId}},{key:"setMasterVolume",value:function(e,t){this.groups.channelMixer.setVolume(e,t)}},{key:"getMasterVolume",value:function(){this.groups.channelMixer.getVolume()}},{key:"rollingResolution",get:function(){if(this.store.getState().mix.isPlayingMix){var e=this.mix.getEvent(zf.k,this.automationStep);if(void 0!==e)return e.getSubEvent(this.automationStep).getValue()}return this.resolution},set:function(e){if(this.store.getState().mix.isRecordingMix){var t=this.mix.getEvent(zf.k,this.automationStep),n=new Yp.a(e);n.step=this.automationStep,t.addSubEvent(n)}else this.state.mix.isPlayingMix&&this.mix.holdEvent(new Yp.a(e))}},{key:"resolution",get:function(){return this.state.sequencer.resolution},set:function(e){if(this.resolution.isTriplet!==e.isTriplet)for(var t in this.subSequences)for(var n in this.subSequences[t].tracks){var r=this.subSequences[t].tracks[n];r.pattern.needsSync&&r.pattern.syncBuckets(this.resolution.isTriplet)}this.rollingResolution=e,this.state.midi.midiMapMode===lh.b&&this.store.dispatch(Object(C.s)(new Cp(this,e))),this.store.dispatch(Object(C.Ce)(e)),this.tracks.forEach(function(t){return t.updatePatternRollStepNumber(e)})}},{key:"displayResolution",get:function(){return this.state.sequencer.displayResolution}},{key:"state",get:function(){return this.store.getState()}},{key:"getSubSequenceName",value:function(e){for(var t=["A","B","C","D","E","F","G","H","I","J","K"],n=0;n<this.subSequences.length;n++)if(this.subSequences[n].id===e)return t[n];return""}},{key:"getSubSequence",value:function(e){return this.subSequences.filter(function(t){return t.id===e})[0]}},{key:"auditionSound",value:function(e,t){var n=this.tracks[t];this.tracks.filter(function(e){return e!==n}).filter(function(e){return e.isAuditioning()}).forEach(function(e){return e.completeAudition()}),n.auditionSound(e)}},{key:"addSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r,i){var o,s,c,u,l,f=this,h=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=h.length>4&&void 0!==h[4]&&h[4],s=h.length>5?h[5]:void 0,c=!(h.length>6&&void 0!==h[6])||h[6],h.length>7?h[7]:void 0,u={slices:void 0===r||0==r.length?void 0:r,offset:0,transpose:0,volume:0},void 0!==n){e.next=23;break}return(l=new Ke(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return f.update()},this.currentSubSequence)).setSends(this.sends),l.setupEffects(),this.currentSubSequence.addTrack(l),l.switchToPattern(this.currentPattern),e.next=13,l.addSound(t,u,!0);case 13:return this.groups.addTrack(l),o&&(this.recordingsCounter++,this.newRecordingToSaveLater(t)),s&&(l.samplesStream=s),this.state.selector.sourceExploring||this.selectTrack(this.tracks.length-1),this.tracks.filter(function(e){return e.isAuditioning()}).forEach(function(e){return e.completeAudition()}),l.updateSteps(),c&&this.currentSubSequence.addTrackToPadIfPossible(l),e.abrupt("return",l);case 23:if(!(this.tracks.length>n)){e.next=28;break}return(l=this.tracks[n]).addSound(t,u),this.selectTrack(n),e.abrupt("return",l);case 28:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"transcribeIntoMidi",value:function(e){var t=this;return new Promise(function(n,r){var a=e.getSamplers()[0],i=a.getSlice(0);Object(Yn.a)(i.buffer._buffer).then(function(e){var r=e.notes;t.addMultiSynthTrack().addNotes(r,a.tempo),n()})})}},{key:"duplicateTrack",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.tracks[t]){e.next=2;break}return e.abrupt("return");case 2:n=this.tracks[t].pad,r=this.tracks[t].getCopy(void 0,this),this.setupNewTrack(r,!0,!0),r.setupEffects(),n&&((i=n.slots.indexOf(!1))>-1?n.addTrack(r,i):this.currentSubSequence.createPad().addTrack(r,0)),this.currentSubSequence.addTrack(r),this.updateTracks(),this.groups.addTrack(r),this.update();case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteTracks",value:function(e){this.tracks=this.tracks.filter(function(t){return!e.includes(t)}),e.forEach(function(e){return e.dispose()})}},{key:"deleteTrack",value:function(e,t){"MIDI"==this.tracks[e].getTrackType()&&this.tracks[e].disconnect();var n=this.tracks[e],r=n.sample,a=this.samplesToSync.indexOf(r);for(var i in a>-1&&this.samplesToSync.splice(a,1),this.tracks)this.tracks[i].chokes.choke===n&&(this.tracks[i].chokes.choke=void 0);n.group;this.groups.deleteTrack(n),this.groups.updateGroupNumbers(),this.rollingManager.deleteTrack(n),n.subSequence.deleteTrackFromPads(n),n.subSequence.deleteTrackFromSequencers(n),t?this.tracks[e]=t:this.tracks.splice(e,1),this.tracks=Object(h.a)(this.tracks),this.cursor.track>=e&&(this.cursor.track--,this.cursor.track<0&&(this.cursor.track=0)),this.scripting.deleteHistoryForTrack(e),this.keyboardEngine&&this.keyboardEngine.deleteTrack(e),this.tracks.forEach(function(e,t){e.trackNumber=t}),this.tracks.forEach(function(e,t){return e.updateSteps()});var o=n.subSequence.id,s=this.state.effects.effectsChainToShow[o]||{};this.store.dispatch(Object(C.ac)(o,Object(En.a)(e,s))),this.dispatch(Object(C.g)(n.id)),this.updateSteps(),this.update(),this.selectTrack(Math.max(e-1,0));var c=this.tracks.map(function(e){return e.isWarped()});this.store.dispatch(Object(C.Ig)(o,c)),n.dispose(),0===this.tracks.length&&this.dispatch(Object(C.Wf)(!1))}},{key:"deleteGroup",value:function(e){this.tracks=this.tracks.filter(function(t){return-1===e.tracks.indexOf(t)}),this.groups.deleteGroup(e),this.store.dispatch(Object(C.uc)(e.id,[])),this.updateSteps(),this.update()}},{key:"length",get:function(){var e=-1;for(var t in this.subSequences)for(var n in this.subSequences[t].tracks){var r=this.subSequences[t].tracks[n].length;r>=e&&(e=r)}return e}},{key:"newPattern",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.currentSubSequence.pads.map(function(e){return e.fxMacro.macroParameter.get()}),r=this.numberOfPatterns()+1,(new Date).getTime(),this.currentSubSequence.newPattern(),i=this.tracks.map(function(e){return e.newPattern(t)}),e.next=7,Promise.all(i);case 7:(new Date).getTime(),this.switchToPattern(this.tracks[0].patterns.length-1),this.currentSubSequence.pads.forEach(function(e,t){return e.fxMacro.macroParameter.set(n[t])}),this.store.dispatch(Object(C.yd)(this.currentSubSequence.id,r)),this.lfosTrack.newPattern(r),this.envelopesTrack.newPattern(r);case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deletePattern",value:function(e){if(0!=this.tracks.length&&1!=this.tracks[0].patterns.length){e=e||this.tracks[0].currentPattern,this.tracks.map(function(t){return t.deletePattern(e)});var t=e>0?e-1:0;this.switchToPattern(t),this.store.dispatch(Object(C.yd)(this.currentSubSequence.id,this.numberOfPatterns())),this.lfosTrack.deletePattern(e),this.envelopesTrack.deletePattern(e)}}},{key:"subSequenceMix",get:function(){return this.currentSubSequence.mix}},{key:"switchToPattern",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.currentSubSequence,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!(e<0||n.tracks.length<=0||n.tracks[0].patterns.length<=e)){var o=this.currentPattern;if(this.currentPattern!==e){Object(Jh.b)(n,e),r||this.dispatch(Object(C.Bb)(void 0)),this.state.mix.isRecordingMix&&!t?n.mix.addEvent(new fp.a(e)):t&&!i||n.mix.holdEvent(new fp.a(e));var s=n.lfosTrack.switchToPattern(o,e);s=Object(p.a)({},s,n.envelopesTrack.switchToPattern(o,e)),this.switchToPatternHelper(e,n,s,a),this.getAllPatternLockedParameters(o,e).forEach(function(e){return e.updateRedux()}),n.findNodeByName("patterns").forEach(function(t){return t.effect.sendMessage("pattern switched",e+1)}),n.pads.forEach(function(e){return e.sendSliderLevels()})}}}},{key:"currentPattern",get:function(){return this.getCurrentPattern(this.currentSubSequence)}},{key:"getCurrentPattern",value:function(e){return this.store.getState().sequencer.currentPattern[e.id]}},{key:"switchToPatternHelper",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentSubSequence,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=t.tracks.map(function(t){return t.switchToPattern(e,void 0,r)});if(!window.explore){var i={};for(var o in a){var s=a[o];s.volume&&(i[s.volume.id]={volume:s.volume.volume,panning:s.panning.panning,mute:s.mute.mute}),n=Object(p.a)({},n,a[o].bulkUpdate)}this.store.dispatch(Object(C.Vb)(n)),this.store.dispatch(Object(C.lh)(i))}this.store.dispatch(Object(C.Ab)(t.id,e)),this.viewMode!==da.a&&this.updateSteps()}},{key:"updateSteps",value:function(e){var t=this.tracks.map(function(e){return e.getUpdateStepsAction()});this.store.dispatch(Object(C.hi)(t))}},{key:"switchToLastPattern",value:function(){0!=this.tracks.length&&this.switchToPattern(this.numberOfPatterns()-1)}},{key:"switchToPreviousPattern",value:function(){if(0!=this.tracks.length){var e=this.tracks[0].currentPattern-1%this.tracks[0].patterns.length;this.switchToPattern(e)}}},{key:"switchToNextPattern",value:function(){if(0!=this.tracks.length){var e=this.tracks[0].currentPattern+1%this.tracks[0].patterns.length;this.switchToPattern(e)}}},{key:"movePatternTo",value:function(e,t){this.tracks.forEach(function(n){return n.movePatternTo(e,t)}),this.switchToPattern(t),this.lfosTrack.movePatternTo(e,t)}},{key:"numberOfPatterns",value:function(){return 0==this.tracks.length?1:this.tracks[0].patterns.length}},{key:"isLoaded",value:function(e){return void 0!==this.tracks&&void 0!==this.tracks[e]&&this.tracks[e].isLoaded()}},{key:"setUpdateCallback",value:function(e){this.callback=e}},{key:"update",value:function(e){window.isNFT||window.projectId||!e||window.multiMix||window.documentation||window.landing||this.tokenId||window.history.pushState("page2","Title","/v3/"+e)}},{key:"addTrack",value:function(e){this.currentSubSequence.addTrack(e),e.setupEffects(),this.groups.addTrack(e),this.setupNewTrack(e)}},{key:"addAudioTrack",value:function(){var e=this,t=new Ar(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence);return this.setupNewTrack(t),t.warp(),t}},{key:"addMultiFreezeTrack",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1]),n=new Tr(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence);return this.groups.addTrack(n),this.setupNewTrack(n,t),n}},{key:"addZ4Track",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1]),n=new Gp(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence);return this.groups.addTrack(n),this.setupNewTrack(n,t),n}},{key:"addSampledInstrumentTrack",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1]),n=new hr(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence);return this.groups.addTrack(n),this.setupNewTrack(n,t),n}},{key:"addInstrumentRackTrack",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1]),n=new Vn(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence);return this.groups.addTrack(n),this.setupNewTrack(n,t),n}},{key:"addInstrumentTrack",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],new nt(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence));return this.groups.addTrack(t),this.setupNewTrack(t),t}},{key:"addFMSynthTrack",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],new at(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence));return this.groups.addTrack(t),this.setupNewTrack(t),t}},{key:"addMetalSynthTrack",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],new Qp(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence));return this.groups.addTrack(t),this.setupNewTrack(t),t}},{key:"addMultiSynthTrack",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],new Dn(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence,!0));return this.groups.addTrack(t),this.setupNewTrack(t),t.preset.name="Empty Patch",t.presetName="Empty Patch",t}},{key:"addMidiTrack",value:function(){var e=this,t=new Er(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence);return t.setMidiEngine(this.midi),t.setAudioSettings(this.audioSettings),this.setupNewTrack(t),t}},{key:"setupNewTrack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];e.isRecordable()&&this.setupRecordableTrack(e,t),e.sequencerEngine=this,n||e.setSends(this.sends),e.setKeyboardEngine(this.keyboardEngine),t||this.currentSubSequence.addTrack(e),t?e.switchToPattern(0):(e.switchToPattern(this.tracks[0].currentPattern),a||this.currentSubSequence.addTrackToPadIfPossible(e)),r&&(this.update(),this.updateTracks())}},{key:"setupRecordableTrack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.setAudioInputManager(this.audioInputManager),t||this.groups.addTrack(e),e.setSequencerEngine(this)}},{key:"updateTracks",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.tracks.forEach(function(t,n){t.trackNumber=n,t.sequencerEngine=e,t.patterns.forEach(function(t){return t.sequencerEngine=e})}),!window.explore){var n=this.tracks.map(function(e){return e.getUpdateStepsAction(t)});this.store.dispatch(Object(C.hi)(n))}}},{key:"dispose",value:function(){for(var e in this.playSequence&&this.playSequence.dispose(),this.loadedSamples)this.loadedSamples[e].dispose();this.metronome&&this.metronome.dispose(),this.metronome=void 0,this.loadedSamples={},zp.release(this.channelMixer),this.channelMixer=void 0,this.sends.dispose(),this.subSequences.forEach(function(e){return e.disposeParameters()}),this.subSequences.forEach(function(e){return e.dispose()}),this.store.dispatch(Object(C.c)(this.sequenceId)),this.audioInputManager.dispose(),this.idToParameter={}}},{key:"newSequence",value:function(){for(var e in this.subSequences){this.subSequences[e].dispose()}this.subSequences=[],this.newSubSequence(),this.mix=new pa.a(this),this.update(),this.store.dispatch(Object(C.yd)(this.currentSubSequence.id,1)),this.store.dispatch(Object(C.p)()),this.loadedSequenceId=void 0,this.stop()}},{key:"scrollToSelectedTrack",value:function(){}},{key:"patternLocks",set:function(e){this.store.dispatch(Object(C.Af)(e))}},{key:"togglePatternLock",value:function(){this.store.dispatch(Object(C.zf)(this.currentPattern,!this.patternLocked))}},{key:"viewMode",get:function(){return this.state.sequencer.viewMode}},{key:"patternLocked",get:function(){return this.store.getState().sequencer.patternLocks[this.currentPattern]||!1}},{key:"getAllPatternLockedParameters",value:function(){return[].concat(Object(h.a)(this.parameters),Object(h.a)(this.currentSubSequence.getAllParameters())).filter(function(e){return e.hasPatternLockedValues()})}},{key:"guildId",get:function(){return this.state.guilds.selectedGuild?this.state.guilds.selectedGuild.guildId:0}},{key:"metronomeOn",get:function(){return this.metronome&&!this.metronome.muted},set:function(e){this.metronome.mute(!e)}},{key:"getScale",value:function(){var e=new Set;for(var t in this.tracks){var n=this.tracks[t];for(var r in n.patterns)n.patterns[r].getEasyPattern().getAllSteps().map(function(t){return e.add(K.a.fromTranspose(t.transpose).note)})}return Array.from(e)}},{key:"dispatch",value:function(e){this.store.dispatch(e)}},{key:"createPad",value:function(e){this.currentSubSequence.createPad(e)}},{key:"getSamplesPerTrack",value:function(){return Object(b.e)(this)}},{key:"compile",value:function(){var e,t=zm(this.subSequences);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.findNodeByName("three.canvas").forEach(function(e){return e.effect.sendMessage("size",[e.effect.width,e.effect.height])});var r,a=zm(n.findNodeByName("gl.material"));try{for(a.s();!(r=a.n()).done;){r.value.refresh()}}catch(i){a.e(i)}finally{a.f()}}}catch(i){t.e(i)}finally{t.f()}}},{key:"getPhotos",value:function(){return Object(b.c)(this)}}]),e}();n(103);function Jm(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Gm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gm(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Gm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Km(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Xm(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Qm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qm(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Qm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ym=function(){function e(){Object(o.a)(this,e),this.addListeners(),this.currentChord=void 0,this.lastChordTime=void 0,this.newChordListeners=[],this.sameChordListeners=[],this.octaveUpListeners=[],this.octaveDownListeners=[]}return Object(s.a)(e,[{key:"addListeners",value:function(){}},{key:"setCurrentChord",value:function(e){this.currentChord=e,this.lastChordTime=(new Date).getTime()}},{key:"chordOn",value:function(e){}},{key:"dispatchEvent",value:function(e){var t=new Event(e);t.chord=this.currentChord,window.dispatchEvent(t)}},{key:"sameChord",value:function(){this.dispatchEvent("SAME_CHORD")}},{key:"octaveDown",value:function(e){this.dispatchEvent("OCTAVE_DOWN")}},{key:"twoOctavesDown",value:function(e){this.dispatchEvent("TWO_OCTAVES_DOWN")}},{key:"octaveUp",value:function(e){this.dispatchEvent("OCTAVE_UP")}},{key:"twoOctavesUp",value:function(e){this.dispatchEvent("TWO_OCTAVES_UP")}},{key:"newChord",value:function(e){this.setCurrentChord(e),this.dispatchEvent("NEW_CHORD")}},{key:"stripOctave",value:function(e){return new Set(Array.from(e).map(function(e){return K.a.fromString(e).note}))}},{key:"chordContains",value:function(e,t){e=this.stripOctave(e);var n,r=Xm(t=this.stripOctave(t));try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!e.has(a))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}},{key:"isOctaveUp",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=!0,i=Xm(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=K.a.fromString(o).addTranspose(12*r).toString();t.has(s)||(a=!1)}}catch(c){i.e(c)}finally{i.f()}return a}},{key:"isOctaveDown",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=!0,i=Xm(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=K.a.fromString(o).addTranspose(-12*r).toString();t.has(s)||(a=!1)}}catch(c){i.e(c)}finally{i.f()}return a}},{key:"isSameChord",value:function(e,t){return this.eqSet(e,t)}},{key:"eqSet",value:function(e,t){if(e.size!==t.size)return!1;var n,r=Xm(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!t.has(a))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}},{key:"chordOff",value:function(e){}},{key:"addCallback",value:function(){}}]),e}(),Zm=function(){function e(t,n){Object(o.a)(this,e),this.chordsManager=new Ym,this.sequencerEngine=t,this.store=this.sequencerEngine.store,this.keyboardEngine=n,this.recordedTriggers={},this.notesDown=new Set}return Object(s.a)(e,[{key:"onNoteDown",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(n&&this.addNoteOn(e),!(e in this.recordedTriggers)){var i=this.store.getState().sequencer.resolution,o=this.store.getState().sequencer.quantized;this.keyboardEngine.onKeyDown(e,i,!this.sequencerEngine.rolling,n,r,a);var s=this.keyboardEngine.recordHit(e,n,i,o,r,a);null!=s&&("tracks"in s?s.recordedTriggers.forEach(function(e){e.release=t.release;t.sequencerEngine.tracks[e.trackNumber];t.sequencerEngine.rollingManager.addTrackSlice(e.trackNumber,0,s.transpose),t.store.dispatch(Object(C.ei)(e.trackNumber,e.sliceNumber))}):(this.sequencerEngine.rollingManager.addTrackSlice(s.trackNumber,s.sliceNumber),this.store.dispatch(Object(C.ei)(s.trackNumber,s.sliceNumber))),this.recordedTriggers[e]=s)}}},{key:"onAlphabetKeyDown",value:function(e){this.onNoteDown(e.key,!1)}},{key:"addNoteOn",value:function(e){}},{key:"addNoteOff",value:function(e){}},{key:"onNoteOff",value:function(e){var t=this;if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&this.addNoteOff(e),e in this.recordedTriggers){var n=this.recordedTriggers[e];if(void 0!==n.tracks)n.recordedTriggers.forEach(function(e){return t.store.dispatch(Object(C.fi)(e.trackNumber,e.sliceNumber))}),n.recordedTriggers.filter(function(e){return e.rolling}).forEach(function(e){e.track;t.sequencerEngine.rollingManager.removeTrackSlice(e.trackNumber,0,n.transpose)}),n.tracks.filter(function(e){return e.trackData}).filter(function(e){return!e.rolling}).forEach(function(r){t.releaseAndRecord(r,n,e,!0)});else{var r=this.sequencerEngine.tracks[n.trackNumber];if(void 0===r)return;this.sequencerEngine.rollingManager.removeTrackSlice(n.trackNumber,n.sliceNumber,void 0),this.store.dispatch(Object(C.fi)(n.trackNumber,n.sliceNumber)),r.rolling||this.releaseAndRecord(r,n,e)}delete this.recordedTriggers[e]}}},{key:"onKeyUp",value:function(e){this.onNoteOff(e.key)}},{key:"releaseAndRecord",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t.transpose;void 0===a&&(a=e.trackData.transpose),e.midiEffects.liveInputRelease(r?a+e.trackData.transpose:a,t.sliceNumber),(e.sequencerEngine.playing&&this.store.getState().sequencer.isRecording||e.subSequence.isTrack&&this.store.getState().mix.isRecordingMix)&&t.record(this.sequencerEngine)}}]),e}();function $m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ev=function(e){Object(u.a)(n,e);var t=$m(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,jh)).sequencerEngine=e,r}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e>63.5;this.sequencerEngine.trackRolling=t}}]),n}(Sp);function tv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var nv=function(e){Object(u.a)(n,e);var t=tv(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,wh)).sequencerEngine=e,r}return Object(s.a)(n,[{key:"execute",value:function(e){var t=e>63.5;console.log("excecuting sequence roll action"),this.sequencerEngine.sequenceRolling=t}}]),n}(Sp);function rv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function av(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return iv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iv(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function iv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ov(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var sv=new H.a.Time("16n"),cv=new H.a.Time("32n"),uv=function(e){Object(u.a)(n,e);var t=ov(n);function n(e,r,a,i,s,u){var l;return Object(o.a)(this,n),(l=t.call(this,e,r,a,i,u)).currentStepTime=null,l.previousStepTime=null,l.lastTrackStep=void 0,l.tracksToRecord={},l.tracksRecording={},l.tracksToStopRecording={},l.rollingManager=new Ep,l.mixButtons=[],l.nextTimeScheduled=void 0,l.nextStepScheduled=void 0,l.startedTransportExplicitly=!1,l.patternSwitchScheduled=null,l.stepNumberOffset=0,l.isRecording=!1,l.playing=!1,l.sequenceRolling=!1,l.resampler=void 0,l.automationStep=0,l.bpmParameter=new Y.a("BPM",l.transport.bpm,function(e,t,n){return l.onNewBpm(t,n)},{min:1,max:500,unit:""}),l.bpmParameter.setContext((new L.a).forSequencerEngine(Object(c.a)(l))),window.explore?l.bpmParameter.set(H.a.Transport.bpm.value):l.bpmParameter.set(lv()),l.swingParameter=new $.a("Swing",Object(c.a)(l),function(e,t){l.onNewSwing(t)},{min:50,max:75,unit:"",defaultValue:50}),l.parameters=[],l.registerParameter(l.bpmParameter),l.registerParameter(l.swingParameter),l.latency=void 0,l.clockSync=new sh(Object(c.a)(l)),l.masterResampler=new qh.a(Object(c.a)(l),l.groups.channelMixer.stereoMerger,!0),l.transpose=0,l.autoResampleMode=!1,l.metronome=!s&&new _h(Object(c.a)(l),l.mixSession,1,function(){return[]}),l.deleting=!1,l.scenes=new gp(Object(c.a)(l)),l.parametersToUpdate={},l.initAudition(),l}return Object(s.a)(n,[{key:"registerParameter",value:function(e){this.parameters.push(e),e.setContext((new L.a).forSequencerEngine(this));var t=e.setStore(this.store);this.dispatch(Object(C.Vb)(t))}},{key:"startPlaySequence",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.playSequence.cancel(),this.playSequence.start(t),this.getSamplerPlaySequence&&this.getSamplerPlaySequence().start(t);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"schedulePlay",value:function(){!this.playing&&this.clockSync.connected&&this.clockSync.clockType===nh.c?this.store.dispatch(Object(C.le)(!0)):this.play()}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.keyboardHelper&&(this.keyboardHelper.release=void 0),this.playTimestamp=(new Date).getTime(),this.playing=!this.playing,this.latency=void 0,this.firstStep=!0,this.trackStep=this.isLooping?this.loopStart:this.startStep,this.state.keyboard.cursor&&this.isShowingPianoRoll()&&(this.trackStep=pe.a.baseResolution.transformStepAtResolution2(this.state.keyboard.cursor,this.displayResolution)),this.currentStep=0,this.previousStep=0,this.previousStepTime=void 0,this.currentStepTime=void 0,this.playing){t||this.hasAtleastOneSequencerEnginePlaying()||this.updateBpm(this.bpm),this.startPlaySequence(e,t),!t&&this.hasAtleastOneSequencerEnginePlaying()||(this.startedTransportExplicitly=!0,this.transport.start("+0.00001"),this.midi&&this.midi.onPlay()),this.restartAllMixes();var n,r=av(this.subSequences);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.startZObjects(),a.midiEffects.clear(),a.tracks.forEach(function(e){return e.restart()}),a.tracks.forEach(function(e){return e.start()})}}catch(i){r.e(i)}finally{r.f()}this.store.dispatch(Object(C.Gc)(this.getSequenceId(),!0))}else this.stop();this.store.dispatch(Object(C.le)(!1)),this.sendPlayChange(this.playing)}},{key:"restartAllMixes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.isLooping;for(var t in this.mixes.forEach(function(t){return t.restart(e)}),this.setSequenceRolling(!1,void 0,!0),this.subSequences)for(var n in this.subSequences[t].tracks){this.subSequences[t].tracks[n].patternRollStepNumber=void 0}this.schedulePatternBufferClear=!1}},{key:"stop",value:function(){var e=this;this.restartAllMixes(),this.latency=void 0,this.playing=!1;this.trackStepReal;for(var t in this.trackStepReal=0,this.higherOrderSequencer.stop(),this.playSequence.stop(),this.startedTransportExplicitly=!1,this.clearScheduledAutomations(),this.hasMultipleSequencerEnginesPlaying()||(this.transport.stop("+0.01"),this.midi&&this.midi.onStop()),this.subSequences)this.subSequences[t].lfosTrack.stop(),this.subSequences[t].stopZObjects();this.tracks.forEach(function(e){return e.effects.filter(function(e){return e.syncable()}).forEach(function(e){return e.stop()})}),Object(pp.a)();var n,r=av(this.subSequences);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.midiEffects.stop(),a.tracks.forEach(function(t){t.stepGroups.length>0&&(t.pattern.transformStepBuckets=[],t.pattern.isTransformed=!1,t.subSequence===e.currentSubSeuqence&&t.updateSteps()),t.resetAnyPLockedParameters(),t.midiEffects.stop(),t.notesTriggered={},!t.isFrozen&&t.instrument&&t.instrument.releaseAll&&t.instrument.releaseAll(),t.tracks&&t.tracks.forEach(function(e){return e.track.midiEffects.stop()})})}}catch(o){r.e(o)}finally{r.f()}for(var i in this.store.dispatch(Object(C.Gc)(this.getSequenceId(),!1)),this.state.sequencer.viewMode!==da.a&&this.store.dispatch(Object(C.Hc)(!1)),this.clockSync&&this.clockSync.onStop(),this.subSequences)this.subSequences[i].tracks.forEach(function(e){e.chokes.chokingDuration=0,e.chokes.liveRelease()});this.resetAutomationParameters(),this.playSequence.cancel(),this.loadNewSequence(),this.handleStopMode()}},{key:"startStep",get:function(){var e=this.state.sequencer.viewMode;return void 0===this.state.arrangement.cursorStep||e===da.e&&!this.isLooping?0:this.state.arrangement.cursorStep}},{key:"seekToTrackStep",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.isLooping&&(this.looping=!1),this.trackStep=e,this.store.dispatch(Object(C.zb)(this.getSequenceId(),e)),this.mixes.forEach(function(t){return t.seekToTrackStep(e)}),this.stepNumberOffset=0,0==e&&n&&(this.isShowingPianoRoll()||this.switchToPatternHelper(0)),this.subSequences.forEach(function(e){return e.tracks.forEach(function(e){return e.scheduleTrackPatternChangeIfAny(t.trackStep,!0)})})}},{key:"loadNewSequence",value:function(){this.playSequence&&this.playSequence.dispose(),this.playSequence=this.getPlaySequence()}},{key:"sleep",value:function(){var e=Object(i.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){setTimeout(function(){return e(t)},t)}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"isLooping",get:function(){return this.state.arrangement.looping}},{key:"looping",set:function(e){this.store.dispatch(Object(C.H)(e))}},{key:"loopStart",get:function(){return this.state.arrangement.selection.start}},{key:"loopEnd",get:function(){return this.state.arrangement.selection.end}},{key:"startNewLoop",value:function(){var e=32*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1),t=this.trackStep;for(t-=Object(dn.a)(t+(this.stepNumberOffset||0),e);t<0;)t+=16;this.dispatch(Object(C.Q)(t,t+e)),this.looping=!0}},{key:"getPlaySequence",value:function(){var e=this,t=Array(16).fill(1).map(function(e,t){return t}),n=new H.a.Sequence(function(t,n){e.scheduleStep(t,n)},t,"32n");return n.loop=!0,n}},{key:"getLoopedStep",value:function(e){if(this.isLooping){var t=(e-this.loopStart)%(this.loopEnd-this.loopStart);return e=this.loopStart+t}return e}},{key:"handleLatency",value:function(e){if(void 0===this.latency&&!this.clockSync.initiator){this.timeToCompare=this.timeToCompare-(new Date).getTime(),this.latency=this.timeToCompare-this.getMilliseconds(e),this.latency+=cv.toMilliseconds();var t=(new Date).getTime()-this.playTimestamp;this.latency-=t/2}return this.latency&&(e+=this.latency/1e3),e+=this.state.sequencer.latency/1e3}},{key:"handleMixSessionStep",value:function(e){var t=this;if(this.state.mix.isPlayingMix){for(var n in this.isLooping&&this.trackStep===this.loopStart&&this.restartAllMixes(!0),this.subSequences){var r=this.subSequences[n],a=this.subSequences[n].mix.getValue(zf.i,this.automationStep);void 0!==a&&a!==this.getCurrentPattern(r)&&this.switchToPattern(a,!0,r,void 0,e)}var i=this.isSequenceRollingAtStep(this.automationStep);void 0!==i&&i!==this.isSequenceRolling&&this.setSequenceRolling(i,void 0,!0);try{this.mixes.forEach(function(n){return n.scheduleNext(t.trackStep,e)})}catch(o){console.log("caught err while scheduling automation = "),console.log(o)}}}},{key:"scheduleParametersToRecord",value:function(e){if(this.isRecording){var t=this.state.tracks.parametersToRecord,n=function(n){var r=t[n];if(!r||!r.context)return"continue";if(r.context.track){var a=r.context.track,i=a.pattern,o=e%a.length,s=i.stepBuckets[o];for(var c in s.steps){var u=s.steps[c];if(u.on)u.parameters.filter(function(e){return e.name===r.name}).forEach(function(e){return e.set(r.get())})}}};for(var r in t)n(r)}}},{key:"scheduleAnyTrackRecording",value:function(e,t){this.store.getState();this.tracksToRecord[e.trackNumber]?(e.startRecording(t),this.store.dispatch(Object(C.gi)(e.trackNumber,!0)),this.tracksRecording[e.trackNumber]=!0,delete this.tracksToRecord[e.trackNumber]):this.tracksToStopRecording[e.trackNumber]&&(e.stopRecording(t),this.store.dispatch(Object(C.gi)(e.trackNumber,!1)),delete this.tracksRecording[e.trackNumber],delete this.tracksToStopRecording[e.trackNumber])}},{key:"scheduleAnyMasterResampling",value:function(e){var t=this.store.getState();void 0!==this.resampler&&(this.resampler.resamplingDurationElapsed++,this.resampler.resamplingDurationElapsed==t.tracks.resampleDuration&&(this.resampler.stop(e),this.resampler=void 0)),t.sequencer.resampleMaster&&(this.store.dispatch(Object(C.Be)(!1)),this.resampler=this.masterResampler,this.resampler.start(e))}},{key:"scheduleAnyTrackResampling",value:function(e,t){var n=this.store.getState();if(e.subSequence===this.currentSubSequence){void 0!==e.resampler&&(e.resampler.resamplingDurationElapsed++,e.resampler.resamplingDurationElapsed==n.tracks.resampleDuration&&(e.resampler.stop(t),e.resampler=void 0));var r=n.tracks.tracksToResample,a=r.indexOf(e.trackNumber);a>-1&&(r.splice(a,1),this.store.dispatch(Object(C.qh)(r)),e.resampler=e.masterResampler,e.resampler.start(t)),n.tracks.trackToFreeze&&n.tracks.trackToFreeze.trackNumber===e.trackNumber&&n.tracks.trackToFreeze.subSequenceId===e.subSequence.id&&(e.resampler=e.masterResampler,e.resampler.start(t,e,!0),this.store.dispatch(Object(C.kh)(void 0)))}}},{key:"scheduleAnyFrozenTrackPlaying",value:function(e,t){}},{key:"scheduleAnyAudioTrackPlaying",value:function(e,t){if("MIDI"===e.getTrackType()&&Object.keys(e.samplers).length>0){var n=new q.a;n.loadDefaults(),n.attack=80,n.release=sv.toMilliseconds()/4,e.triggerSamples(n,t)}}},{key:"scheduleTrackRolling",value:function(e,t,n){var r=this;e.subSequence.isTrack||(t=e.getPatternStep(t));var a=this.getMilliseconds(n),i=e.getFactoredResolution();setTimeout(function(){var a=r.rollingManager.getTriggers(t,i,e);if(a.filter(function(t){return t.trackSlice.trackNumber===e.trackNumber}).length>0){e.onNewStep(),a.forEach(function(a){if(void 0!==(e=r.tracks[a.trackSlice.trackNumber])){var o=new q.a;o.slice=a.trackSlice.sliceNumber,o.velocity=e.trackData.velocity,o.transpose=void 0===a.trackSlice.transpose?e.trackData.transpose:a.trackSlice.transpose+e.trackData.transpose,o=e.getStepDataForStep(o);var s=new H.a.Time(n)+a.time;o.track=e,e.midiEffects.input(o,s,t),(r.isRecording||e.subSequence.isTrack&&r.isRecordingMix)&&e.recordHit(a.step,i,o.slice,null,o.transpose,o.velocity,r.keyboardHelper.release)}}),a=e.midiEffects.output(n,t);var o=[e],s={};s[e.trackNumber]=a,Yh(r,o,s,n,t),e.onStepEnded(n,t)}},a-20)}},{key:"scheduleSamplesRolling",value:function(e,t){var n=this;this.tracks.filter(function(e){return e.rolling}).forEach(function(r){return n.scheduleTrackRolling(r,e,t)})}},{key:"missedNextScheduledStep",value:function(){return H.a.Master.context.currentTime<=this.nextTimeScheduled}},{key:"scheduleNext",value:function(e,t,n){var r=this,a=this.tracks[e];if(a.getTrackType()!==A.b){var i=this.rollingManager.getTriggerTimes(this.nextStepScheduled,this.resolution,a),o=a.getFactoredResolution();i.forEach(function(e){var i=new q.a;i.slice=t,i.transpose=void 0===n?a.trackData.transpose:n+a.trackData.transpose,i=a.getStepDataForStep(i),a.trigger(i,r.nextTimeScheduled+e.time),r.isRecording&&(a.recordHit(e.step,o,t,i.duration,i.transpose),a.updateSteps())})}}},{key:"getCurrentStepTime",value:function(){var e=this.getMilliseconds(this.latestStepTime),t=new H.a.Time(H.a.Master.context.currentTime).toMilliseconds()-new H.a.Time(this.previousStepTime).toMilliseconds();return t<0||e>0&&e>t?this.previousStepTime:this.latestStepTime}},{key:"getCurrentStep",value:function(e,t){Math.abs(new H.a.Time(H.a.Master.context.currentTime)-new H.a.Time(this.latestAbsoluteTime)),Math.abs(new H.a.Time(H.a.Master.context.currentTime)-new H.a.Time(this.previousAbsoluteTime));var n=void 0;n=t?t.subSequence.isTrack?1e6:t.pattern.length():this.length;var r=this.lastTrackStep%n;return e=e||pe.a.baseResolution,Math.floor(r/(pe.a.baseResolution.numSteps()/e.numSteps()))}},{key:"getMilliseconds",value:function(e){return new H.a.Time(e).toMilliseconds()-new H.a.Time(H.a.Master.context.currentTime).toMilliseconds()}},{key:"recordTrack",value:function(e){this.tracksToRecord[e]=!0}},{key:"stopRecordingTrack",value:function(e){this.tracksToStopRecording[e]=!0}},{key:"isTrackRecording",value:function(e){return this.tracksRecording[e]}},{key:"doubleTrackLength",value:function(e){this.tracks[e].doubleTrackLength(),this.transport.loopStart="0:0:0",this.transport.loopEnd=this.length/32+":0:0"}},{key:"halfTrackLength",value:function(e){this.tracks[e].halfTrackLength(),this.transport.loopStart="0:0:0",this.transport.loopEnd=this.length/32+":0:0"}},{key:"isRecordingMix",get:function(){return this.store.getState().mix.isRecordingMix}},{key:"lfos",get:function(){return this.lfosTrack.lfos}},{key:"envelopesTrack",get:function(){return this.currentSubSequence.envelopesTrack}},{key:"lfosTrack",get:function(){return this.currentSubSequence.lfosTrack}},{key:"envelopes",get:function(){return this.envelopesTrack.envelopes.map(function(e){return e.envelope})}},{key:"onNewBpm",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],void 0!==t&&t<500&&t>=1){for(r in n||(this.transport.bpm.value=t),this.store.dispatch(Object(C.ab)(t)),this.subSequences)this.subSequences[r].lfosTrack.onBPMUpdated();this.tracks.forEach(function(e){return e.onBPMUpdated()}),this.clockSync&&this.clockSync.onBPMChanged(t)}case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"bpm",get:function(){return this.bpmParameter.get()},set:function(e){this.bpmParameter.set(e,!1)}},{key:"swing",get:function(){return this.swingParameter.get()},set:function(e){this.swingParameter.set(e)}},{key:"updateBpm",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],this.bpm=t,!n){for(r in this.subSequences)this.subSequences[r].lfosTrack.onBPMUpdated();this.tracks.forEach(function(e){return e.onBPMUpdated()})}case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onNewSwing",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=(t-50)/50,this.transport.swing=n;case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateSwing",value:function(e){this.swing=e}},{key:"recording",value:function(e){this.store.dispatch(Object(C.Jc)(e)),this.isRecording=e,this.tracks.filter(function(e){return"MIDI"===e.getTrackType()}).map(function(t){return t.recording(e)})}},{key:"connectToKeyboardEngine",value:function(e){var t=this;this.keyboardEngine=e,this.keyboardHelper=new Zm(this,e),this.midi=new Ah(e,this.keyboardHelper,function(e){return t.updateBpm(e)}),this.midi.setStartCallback(function(){return t.play()}),this.midi.setStopCallback(function(){return t.stop()})}},{key:"hasMultipleSequencerEnginesPlaying",value:function(){var e=this.store.getState().sequencer.isPlaying;return Object.keys(e).filter(function(t){return e[t]}).length>1}},{key:"hasAtleastOneSequencerEnginePlaying",value:function(){var e=this.store.getState().sequencer.isPlaying;return Object.keys(e).filter(function(t){return e[t]}).length>0}},{key:"state",get:function(){return this.store.getState()}},{key:"isLoading",get:function(){var e=this.state.sequencer.loadingSequence;return Object.keys(e).some(function(t){return!0===e[t]})}},{key:"sustain",value:function(e){var t,n=this,r=av(this.tracks.filter(function(e){return e.isEnabled}));try{var a=function(){var r=t.value,a=void 0;if(r.getTrackType()!==A.b)return"continue";var i=r.instrument;a=i.getInstrumentType()===z.f?i.ampEnvelope:i;var o=n.keyboardHelper,s=0;for(var c in 127===e?(a.releaseParameter.set(2500,!0),s=2500):(a.releaseParameter.set(100,!0),s=100),o.release=s,o.recordedTriggers){var u=o.recordedTriggers[c];u.recordedTriggers&&u.recordedTriggers.forEach(function(e){return e.release=s})}};for(r.s();!(t=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}}},{key:"isShowingPianoRoll",value:function(){return this.state.sequencer.showPianoRoll&&this.state.arrangement.bottomMode===hp.d}},{key:"isAnyTrackEnabled",value:function(){var e,t=av(this.subSequences);try{for(t.s();!(e=t.n()).done;){if(e.value.tracks.some(function(e){return e.isEnabled}))return!0}}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"sendPlayChange",value:function(e){this.subSequences.forEach(function(t){t.findNodeByName("mixbuttons").forEach(function(t){t.effect.sendMessage("playing",e?1:0)})})}},{key:"handleStopMode",value:function(){this.subSequences.forEach(function(e){e.findNodeByName("mixbuttons").forEach(function(e){e.effect.handleStop()})})}}]),n}(Object(Ve.a)(function(e){return function(e){Object(u.a)(n,e);var t=yp(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"initAudition",value:function(){var e=this,t=new Ke(this.tracks.length,this,this.mixSession,this.numberOfPatterns(),function(){return e.update()},this.currentSubSequence);t.setSends(this.sends),t.setupEffects(),t.trackNumber=-2,t.trackNode.connect(H.a.Master),this.auditionTrack=t}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=rv(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"rolling",get:function(){return this.store.getState().sequencer.trackRolling}},{key:"trackRolling",set:function(e){this.state.midi.midiMapMode===lh.b&&this.store.dispatch(Object(C.s)(new ev(this))),this.store.dispatch(Object(C.gh)(e)),this.rollingManager.clear()}},{key:"setSequenceRolling",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rollingResolution,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.automationStep,a=arguments.length>4?arguments[4]:void 0;if(Object(Jh.d)(e,t.resolution,t.isTriplet),this.state.midi.midiMapMode===lh.b&&this.store.dispatch(Object(C.s)(new nv(this))),e){if(e!=this.isSequenceRolling||a){var i=t.getNumberOfStepsAtBaseResolution();for(var o in r-=r%i,this.subSequences)this.subSequences[o].initPatternBuffer(r),this.subSequences[o].tracks.forEach(function(e){return e.initPatternBuffer(r)});n&&(this.trackRolling=!0)}}else this.schedulePatternBufferClear=!0;if(this.isSequenceRolling=e,!n)if(this.store.getState().mix.isRecordingMix){var s=this.resolution;this.mix.addEvent(new kp.a(e,s))}else this.store.getState().mix.isPlayingMix&&this.mix.holdEvent(new kp.a(e,this.resolution))}},{key:"isSequenceRollingAtStep",value:function(e){if(this.store.getState().mix.isPlayingMix){var t=this.mix.getValue(zf.k,e);return this.mix.getValue(zf.k,e-1),t}return this.isSequenceRolling}},{key:"sequenceRolling",set:function(e){this.setSequenceRolling(e)}},{key:"scheduleSequenceRollingIfNeeded",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.store.getState(),this.schedulePatternBufferClear?(e.patternRollStepNumber=void 0,this.schedulePatternBufferClear=!1,!1):!(!this.isSequenceRolling||!r&&!e.rolling)&&!(!r&&void 0!==e.subSequence.higherRolling&&!1===e.subSequence.higherRolling)&&(e.updatePatternRollStepNumber(this.rollingResolution),!0)}},{key:"rollingResolution",get:function(){if(this.store.getState().mix.isPlayingMix){var e=this.mix.getEvent(zf.k,this.automationStep);if(void 0!==e)return e.getSubEvent(this.automationStep).getValue()}return this.resolution},set:function(e){if(this.store.getState().mix.isRecordingMix){var t=this.mix.getEvent(zf.k,this.automationStep),n=new Yp.a(e);n.step=this.automationStep,t.addSubEvent(n)}else this.state.mix.isPlayingMix&&this.mix.holdEvent(new Yp.a(e))}},{key:"resolution",get:function(){return this.state.sequencer.resolution},set:function(e){if(this.resolution.isTriplet!==e.isTriplet)for(var t in this.subSequences)for(var n in this.subSequences[t].tracks){var r=this.subSequences[t].tracks[n];r.pattern.needsSync&&r.pattern.syncBuckets(this.resolution.isTriplet)}this.rollingResolution=e,this.state.midi.midiMapMode===lh.b&&this.store.dispatch(Object(C.s)(new Cp(this,e))),this.store.dispatch(Object(C.Ce)(e)),this.tracks.forEach(function(t){return t.updatePatternRollStepNumber(e)})}},{key:"displayResolution",get:function(){return this.state.sequencer.displayResolution}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=up(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputTriggers=[],e.inputTracks=[],e.resolvedInputTriggers=[],e.otherModules=[],e.otherTriggers=[],e}return Object(s.a)(n,[{key:"scheduleStep",value:function(e,t){var n=this;e=this.handleLatency(e);var r=this.storeStepAndTime(t,e);this.handleMixSessionStep(e),this.higherOrderSequencer.onNewStep(this.trackStep,e),this.applyHigherOrderSequencing(this.trackStep),this.scenes.onNewStep(this.trackStep),this.mixButtons.forEach(function(e){return e.sendCurrentStepNumber(n.trackStep)}),void 0!==this.stepOneCallback&&(this.startedTransportExplicitly&&15==t?this.stepOneCallback(e):this.startedTransportExplicitly||0!=t||this.stepOneCallback(e)),t=this.trackStep,this.scripting&&this.scripting.onStepReached(t),t%this.length===0&&this.scheduleAnyMasterResampling(e),this.scheduleParametersToRecord(t),r?this.scheduleParameterAutomations(t,e,!0):this.isLooping&&t===this.loopStart?this.scheduleParameterAutomations(t,e,!0):this.scheduleParameterAutomations(t,e,!1),this.scheduleSubSequences(t,e),this.metronome&&this.scheduleTrack(this.metronome,t,e).forEach(function(e){return n.metronome.trigger(e.stepData,e.time,t)}),this.scheduleSamplesRolling(t,e),t%=this.length;var a=this.storeLastStepAndTime(t,e);this.clockSync.onTick(this.getMilliseconds(e),t),this.midi&&this.midi.onTick(this.getMilliseconds(e),t,this.resolution),Object.keys(this.parametersToUpdate).length>0&&(this.dispatch(Object(C.Vb)(this.parametersToUpdate)),this.parametersToUpdate={}),H.a.context.setTimeout(function(){n.playing&&(n.lastTrackStepReal=a,n.previousStepReal=n.trackStepReal,n.previousStepTimeReal=n.currentStepTime,n.trackStepReal=a,n.currentStepTime=e,n.store.dispatch(Object(C.xb)(n.getSequenceId(),t,n.trackStep)))},this.getMilliseconds(e)/1e3)}},{key:"scheduleSubSequences",value:function(e,t){var n=this,r=this.higherOrderSequencer,a=r.inputModules,i=this.inputTriggers,o=this.inputTracks,s=this.resolvedInputTriggers,c=this.otherModules,u=this.otherTriggers;i.length=0,o.length=0,s.length=0,c.length=0,u.length=0;var l,f=sp(a);try{for(f.s();!(l=f.n()).done;){var p=l.value;if(r.shouldPlayModule(p)){o.push(p.tracks);var d=r.getStepForModule(e,p);i.push(this.scheduleTracks(Object(h.a)(p.tracks),d,t))}}}catch(x){f.e(x)}finally{f.f()}i.forEach(function(r,a){return s.push(Yh(n,o[a],r,t,e))});var m=s.flatMap(function(e,t){return a[t].tracks.flatMap(function(t){var n=t.trackNumber;return e[n]})}).filter(function(e){return e});r.input(m),r.output(t,e),this.subSequences.forEach(function(e){a.includes(e)||c.push(e)});var v,b=[],g=sp(c);try{for(g.s();!(v=g.n()).done;){var y=v.value;if(this.state.mix.isPlayingMix&&y.updateVolumeFromAutomation(e),r.shouldPlayModule(y)){var k=this.higherOrderSequencer.getStepForModule(e,y);y.schedulePads(t,k),this.scheduleSubSequenceZObjects(y,t,k);var O,j=this.scheduleTracks(Object(h.a)(y.tracks),k,t),w=sp(r.getOutputForModule(y));try{for(w.s();!(O=w.n()).done;){var E=O.value;u.push(j),b.push(E.tracks)}}catch(x){w.e(x)}finally{w.f()}}}}catch(x){g.e(x)}finally{g.f()}u.forEach(function(r,a){return Yh(n,b[a],r,t,e)});var S,P=sp(this.subSequences);try{for(P.s();!(S=P.n()).done;)S.value.sendPadMessages(t)}catch(x){P.e(x)}finally{P.f()}}},{key:"scheduleSubSequenceZObjects",value:function(e,t,n){if(n=Math.floor(n*e.playhead.speedFactor),e.lastPatternStep!==n)if(e.lastPatternStep=n,this.scheduleSequenceRollingIfNeeded(e,n,t,!0)){var r=this.resolution,a=r.getNumberOfStepsAtBaseResolution(),i=e.patternRollStepNumber+n%a;if(!r.isTriplet)return void e.scheduleZObjects(t,i);var o=Math.floor(i);H.a.Time("32n"),i=o;var s,c=sp(Object(ap.a)(i,r,!0));try{for(c.s();!(s=c.n()).done;){var u=s.value;e.scheduleZObjects(t+u.time,i)}}catch(l){c.e(l)}finally{c.f()}}else e.scheduleZObjects(t,n)}},{key:"scheduleTracks",value:function(e,t,n){var r=this;if(void 0!==e){e=function(e){if(H.a.Master.context.isOffline)return e;var t,n=[],r=ip(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.midiEffects.effects.find(function(e){return"User Script"===e.name&&e.code.match(/receive\(.*[\"|\'].*\.trigger/)})&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}var i=e.filter(function(e){return!n.includes(e)});return[].concat(Object(h.a)(i),n)}(e);var a,i={},o=sp(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.setGroupBits(s,t)}}catch(u){o.e(u)}finally{o.f()}for(var c=0;c<e.length;c++)try{!function(){var a=e[c],o=r.scheduleTrack(e[c],t,n);i[a.trackNumber]=o,o.forEach(function(e){return Object(Jh.e)(a,e)})}()}catch(u){console.log("caught error while scheduling track err = "),console.log(u)}return i}}},{key:"scheduleTrack",value:function(e,t,n){if(e.disabled)return[];e.subSequence.isTrack&&e.scheduleTrackPatternChangeIfAny(t);var r=e.getPatternStep(t,!0);e.sendMessage("pattern progress",100*r/e.length);var a=Math.floor(r),i=new H.a.Time("32n")*(r-a);e.isEnabled;try{e.pattern.mix.scheduleNext(a,n,this)}catch(y){console.log("caught an error while scheduling pattern events = "),console.log(y)}if(e.scheduleAnyRecording(r,n),this.deleting&&e.deleteAtStep(a),0==a&&(this.scheduleAnyFrozenTrackPlaying(e,n),this.scheduleAnyTrackRecording(e,n),this.scheduleAnyTrackResampling(e,n),this.scheduleAnyAudioTrackPlaying(e,n),this.scheduleAnyStepGroups(e,n)),this.scheduleSequenceRollingIfNeeded(e,a,n)){var o=e.getFactoredResolution(),s=o.getNumberOfStepsAtBaseResolution(),c=e.patternRollStepNumber+r%s;if(c%=e.pattern.stepBuckets.length,!o.isTriplet)return this.getTrackTriggers(e,n,c,e.pattern,r);var u=Math.floor(c),l=(c-u)*H.a.Time("32n");e.isPlayheadReversed()&&(l*=-1),c=u;var f,p=[],d=0,m=sp(Object(ap.a)(c,o,!0));try{for(m.s();!(f=m.n()).done;){var v=f.value;p=[].concat(Object(h.a)(p),Object(h.a)(this.getTrackTriggers(e,n-l+v.time,c,e.pattern,r,0===d))),d++}}catch(y){m.e(y)}finally{m.f()}return 0===p.length?this.getTrackTriggers(e,n-l,c,e.pattern,r):p}if(!e.isMetronome&&e.speedFactor>1){for(var b=[],g=1;g<=e.speedFactor;g++)b=[].concat(Object(h.a)(b),Object(h.a)(this.getTrackTriggers(e,n+i,r,e.pattern,r))),n+=new H.a.Time("32n"),r++;return b}return this.getTrackTriggers(e,n+i,r,e.pattern,r)}},{key:"getTrackTriggers",value:function(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=e.isPlayheadReversed(a),s=r.getBucket(n);i&&e.onNewStep(n,t);var c=s?s.steps:[],u=[];if(e.isFrozen||e.getTrackType()===A.a)0===n&&e.triggerFrozenSample(t);else for(var l in c){var f=c[l];o&&(l*=-1);var p=new H.a.Time(t)+lp*l,d=f.getPolyphony();for(var m in d=[].concat(Object(h.a)(d.filter(function(e){return!e.slide})),Object(h.a)(d.filter(function(e){return e.slide})))){var v=d[m];if(e.deleting)u.push(v);else if(!this.isStepMasked(v)){var b=this.transformStep(v,p,a),g=b.time,y=b.step;y.slide||e.handlePLockedAutomations(y,g),e.midiEffects.input(y,g,a)}}}if(e.deleting)return u.length>0&&this.operationManager.dispatch(Object(je.h)(e,u)),[];var k=e.midiEffects.output(t,n,a).filter(function(e){return e.stepData&&e.stepData.track});return this.shouldPlayStep(a)?k:[]}},{key:"storeLastStepAndTime",value:function(e,t){this.nextStepScheduled=e;var n=this.getLoopedStep(this.trackStep+1),r=this.trackStep;this.lastTrackStep=this.trackStep,this.trackStep=n,this.previousStepTime=this.latestStepTime,this.latestStepTime=t,new H.a.Time(this.latestStepTime);var a=this.currentStep;return this.currentStep=e,this.previousStep=a,r}},{key:"storeStepAndTime",value:function(e,t){var n=this.firstStep;if(this.firstStep){var r,a=sp(this.subSequences);try{for(a.s();!(r=a.n()).done;){var i=r.value;i.lfosTrack.start(t),i.tracks.filter(function(e){return e.lfosTrack}).forEach(function(e){return e.lfosTrack.start(t)})}}catch(o){a.e(o)}finally{a.f()}this.firstStep=!1}return this.lastTrackStep===this.trackStep&&(this.trackStep+=1),this.nextTimeScheduled=t,this.automationStep,this.automationStep=this.getLoopedStep(this.trackStep),n}},{key:"shouldPlayStep",value:function(e){return e%=32,e=Math.floor(e/2),this.state.steps.masterStepToggles[e]}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Wm(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setGroupBits",value:function(e,t){if(0===e.getPatternStep(t)){var n,r=Jm(e.stepGroups);try{for(r.s();!(n=r.n()).done;){var a=n.value;Object(He.g)(a)}}catch(i){r.e(i)}finally{r.f()}}}},{key:"scheduleAnyStepGroups",value:function(e,t){e.stepGroups.length>0&&(e.pattern.transform(),this.state.groups.stepsGroupMode&&e.subSequence===this.currentSubSequence&&e.updateSteps())}},{key:"transformStep",value:function(e,t,n){return e.group?Object(He.j)(e,e.group,t,n):{step:e,time:t}}},{key:"isStepMasked",value:function(e){var t=e.probability/100,n=Math.random();return!e.on||n>t||Object(He.h)(e)}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Km(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"resetAutomationParameters",value:function(){}},{key:"clearScheduledAutomations",value:function(){var e=this.state.automation.automationSchedulers[this.sequenceId]||{},t=this.state.automation.automationMixSchedulers[this.sequenceId]||{},n=Object(p.a)({},e,t),r={};for(var a in n)if(n[a].clear(),n[a].parameter){var i=n[a].parameter.updateRedux();if(i){var o=i.id,s=i.value;r[o]=s}}Object.keys(r).length>0&&this.store.dispatch(Object(C.Vb)(r))}},{key:"scheduleParameterAutomations",value:function(e,t,n){this.multiSequencerEngine&&(e=this.multiSequencerEngine.trackStep);var r=this.state.automation.automationSchedulers[this.sequenceId]||{},a=this.state.mix.isPlayingMix&&this.state.automation.automationMixSchedulers[this.sequenceId]||{},i=Object(p.a)({},r,a),o={};for(var s in i){var c=i[s],u=c.parameter;if(void 0!==u&&(!c.isMix||this.state.mix.isPlayingMix)){var l=u.track,f=this.length;if(void 0!==l){if(l.instrumentRack&&(l=l.instrumentRack),void 0===l.pattern)continue;f=l.length}if(c.isMix?(n&&c.start(t),0===c.eventIds.length&&c.automations.some(function(t){return t.step>=e&&t.step<e+32})&&c.schedule(e,t,Math.max(0,t-.001))):e%f===0&&c.schedule(e,t),u.onNewStep(e),u.context&&u.context.macro){var h=u.context.macro.subMacros;for(var d in h){var m=h[d].parameter;m.onNewStep(e),o[m.id]=m.getAtStep(e)}}this.trackStep%2===0&&-1===this.state.automation.parameterSliderDown.indexOf(u)&&c.automations.length>0&&(c.isMix&&!c.hasEventsAfterStep(e)||(o[u.id]=c.getValueAtStep(e)))}}this.trackStep%2===0&&Object.keys(o).length>0&&this.store.dispatch(Object(C.Vb)(o))}},{key:"updateAutomationRedux",value:function(e,t){this.store.dispatch(Object(C.o)(e,t))}}]),n}(e)})(Um)),lv=function(){return 60+Math.floor(120*Math.random())},fv=uv,hv=n(518),pv=n(297),dv=n(341),mv=(n(1053),n(141));function vv(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return bv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bv(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function bv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var yv=In.a.presets,kv=function(e){Object(u.a)(n,e);var t=gv(n);function n(e,r,a,i,s,c){var u;return Object(o.a)(this,n),(u=t.call(this,e,r,a,i,s,c)).recordingsToSave=[],u.loadedSequenceId=void 0,u.samplesToSync=[],u.loadedSamples={},u.editHistory=[],u}return Object(s.a)(n,[{key:"save",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mv.c,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0,u=void 0!==o&&n!=mv.c?o.guildId:0;return new Promise(function(){var l=Object(i.a)(a.a.mark(function i(l,f){var h,p,d,m,v;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return h=t.currentSubSequence,p=t.sequenceId,a.next=4,t.saveAnyNewRecordings(u,r,void 0!==s);case 4:for(m in d={hasPatterns:!0,subSequences:t.getSubSequences(),sendVolumes:t.getSendVolumesToSave(),bpm:t.bpm,swing:t.swing,resolution:pe.a.baseResolution.toString(),gateMode:t.gateMode,scripting:t.scripting.getJson(),parameterLocks:t.parameterLocks.map(function(e){return e.getJson()}),effectsCollapsed:t.state.effects.effectCollapsed,cableSegmentations:t.state.spatial.cableSegmentations,modulesCollapsed:t.state.pads.modulesCollapsed,effectStarred:t.state.effects.effectStarred,mix:t.mix.getJson(),sends:t.sends.getJson(),patternColors:t.store.getState().toolbar.patternColors,lfos:t.lfos.map(function(e){return e.getJson()}),envelopes:t.envelopes.map(function(e){return e.getJson()}),lfoPatternLocks:t.state.tracks.lfoPatternLocks,envelopePatternLocks:t.state.tracks.envelopePatternLocks,hiddenObjects:t.state.spatial.hiddenObjects,theme:t.state.sequencer.theme,effectPatternLocks:t.state.effects.effectPatternLocks,patternLocks:t.state.sequencer.patternLocks,trackPatternLocks:t.state.tracks.trackPatternLocks,scenes:t.scenes.getJson(),windowPositions:Ev(t.state.windows.windowPositions,t),presentationWindowPositions:t.state.windows.presentationWindowPositions,presentationMode:t.state.spatial.presentationMode,higherOrderSequencer:t.higherOrderSequencer.getJson(),inletConnections:wv(t.state.windows.inletConnections,t),lockedObjects:t.state.spatial.lockedObjects,samplesMetadata:Object(b.b)(t),pluginsLoaded:t.state.plugins.pluginsLoaded&&t.state.plugins.pluginsLoaded.map(function(e){return e.id}),pulledEffects:t.state.effects.pulledEffects.map(function(e){return e.type&&!e.getEffectType?{x:e.x,y:e.y,width:e.width,height:e.height,id:e.id||e.instrument.id,instrumentId:e.instrument.id,type:e.type,subType:e.subType}:e.id}),masterChannel:t.channelMixer.masterChannel.getJson()},console.log("json = ",d),s&&(d.nftZObject=s.id),t.state.sequencer.wallpaper&&(d.wallpaper=t.state.sequencer.wallpaper),d)d[m]&&0!==d[m].length||delete d[m];d=Object(Q.b)(d,"bpmParameter",t.bpmParameter),d=Object(Q.b)(d,"swingParameter",t.swingParameter),t.switchToSubSequence(h.id),v=new hv.a(!0),n===mv.b?In.a.crypto.encryptAndSave(e,d,t.loadedSequenceId,r).then(function(e){t.update(e),t.saveProjectMetadata(e),l(e)}):n===mv.a?In.a.guildSequences.newGuildSequence(d,e,t.loadedSequenceId,o.guildId).then(function(e){t.update(e),t.saveProjectMetadata(e),l(e)}):n===mv.c&&v.save(e,d,t.loadedSequenceId,t.getSamples(),r,c,t.bpm).then(function(e){t.update(e.ipfsHash),r&&t.saveProjectMetadata(e.ipfsHash),t.loadedSequenceId=e.ipfsHash,t.updateAutomationRedux(p,t.loadedSequenceId),l(c?{ipfsHash:e.ipfsHash,json:d}:e.ipfsHash)});case 15:case"end":return a.stop()}},i)}));return function(e,t){return l.apply(this,arguments)}}())}},{key:"getTrackMidiEffectsToSave",value:function(){var e=[];for(var t in this.tracks)e.push(this.tracks[t].midiEffects.getJson());return e}},{key:"getTrackLiveEffectsToSave",value:function(){var e=[];for(var t in this.tracks)e.push(this.tracks[t].liveEffects.getJson());return e}},{key:"getTrackEffectsToSave",value:function(){var e=[];for(var t in this.tracks){for(var n=[],r=this.tracks[t].effects,a=0;a<r.length;a++)n.push(r[a].getJson());e.push(n)}return e}},{key:"getTrackEffectsChainsToSave",value:function(){var e=[];for(var t in this.tracks)e.push(this.tracks[t].effectsChains.map(function(e){return e.getJson()}));return e}},{key:"getSubSequences",value:function(){var e=[];for(var t in this.subSequences){this.switchToSubSequence(this.subSequences[t].id,!1);for(var n=[],r=[],a=0;a<this.subSequences[t].tracks.length;a++){var i=this.subSequences[t].tracks[a],o=Object(N.a)(i),s=o.patterns,c=o.trackData;r.push(c),n.push(s)}var u=this.subSequences[t].groups.getJson(),l=this.subSequences[t].lfosTrack.lfos.map(function(e){return e.getJson()}),f=this.subSequences[t].envelopesTrack.envelopes.map(function(e){return e.getJson()});e.push(Object(p.a)({},this.subSequences[t].getJson(),{tracks:n,tracksData:r,lfos:l,envelopes:f,groups:u,tracksPatterns:this.getTracksPatternsToSave(),tracksEffectsChains:this.getTrackEffectsChainsToSave(),tracksMidiEffects:this.getTrackMidiEffectsToSave(),tracksLiveEffects:this.getTrackLiveEffectsToSave(),tracksParameters:this.getTracksParametersToSave(),sendVolumes:this.getSendVolumesToSave(),mix:this.subSequences[t].mix.getJson(),id:this.subSequences[t].id,midiEffects:this.subSequences[t].midiEffects.getJson(),pads:this.subSequences[t].getPadsJson(),sequencers:this.subSequences[t].getSequencersJson(),zobjects:this.subSequences[t].getZObjectsJson()}))}return e}},{key:"getSendVolumesToSave",value:function(){return this.tracks.map(function(e){return e.getSendNodes().map(function(e){return e.volume.value})})}},{key:"getTracksPatternsToSave",value:function(){return this.tracks.map(function(e){return e.patterns.map(function(e){return e.getJson()})})}},{key:"getTracksParametersToSave",value:function(){return this.tracks.map(function(e){return e.trackData.getJson()})}},{key:"loadSubSequences",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,o,s,c=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=[],0===this.tracks.length&&this.subSequences.length<=1&&(this.subSequences.forEach(function(e){return e.dispose()}),this.subSequences=[]),o=a.a.mark(function e(o){var s,u,l,f,h,p,d;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n||parseInt(o)===n){e.next=2;break}return e.abrupt("return","continue");case 2:return s=t.subSequences[o],u=s.id,l=c.newSubSequence(u),f=s.tracks.map(function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fr(c,s.tracksData[n],t,n,l);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),e.next=8,Promise.all(f);case 8:for(p in h=e.sent,s.tracksData)"chokes"in(d=s.tracksData[p])&&h[p].chokes.fromJson(d.chokes,h);h.forEach(function(e){return l.addTrack(e)}),l.fromJson(s),r.push(l);case 13:case"end":return e.stop()}},e)}),e.t0=a.a.keys(t.subSequences);case 4:if((e.t1=e.t0()).done){e.next=12;break}return s=e.t1.value,e.delegateYield(o(s),"t2",7);case 7:if("continue"!==e.t2){e.next=10;break}return e.abrupt("continue",4);case 10:e.next=4;break;case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getAllRecordingsToSave",value:function(){var e=this.recordingsToSave.filter(function(e){return void 0!==e.audioBuffer});for(var t in this.subSequences){var n=this.subSequences[t];for(var r in n.tracks)e=[].concat(Object(h.a)(e),Object(h.a)(n.tracks[r].frozenSamplesToSave))}return[].concat(Object(h.a)(e),Object(h.a)(this.samplesToSync))}},{key:"saveAnyNewRecordings",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l,f,p,d,m,v,b,g,y,k,O,j,w,E,S,P,x,T,C,N,R=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=R.length>1&&void 0!==R[1]&&R[1],r=R.length>2?R[2]:void 0,i=this.recordingsToSave.filter(function(e){return void 0!==e.audioBuffer}),e.t0=a.a.keys(this.subSequences);case 4:if((e.t1=e.t0()).done){e.next=19;break}o=e.t1.value,s=this.subSequences[o],e.t2=a.a.keys(s.tracks);case 8:if((e.t3=e.t2()).done){e.next=17;break}if(c=e.t3.value,0!==t||!n&&!r||window.installation){e.next=14;break}if(!r){e.next=14;break}return e.next=14,s.tracks[c].makePublicIfNeeded();case 14:i=[].concat(Object(h.a)(i),Object(h.a)(s.tracks[c].frozenSamplesToSave)),e.next=8;break;case 17:e.next=4;break;case 19:for(f in u=new pv.a,l=[],i){for(p=i[f],d=p.name,m=["","","",""],v=p.videoId||"",b=p.getTagsToSave(),g=(new Date).getFullYear(),b.length>4&&(b=b.slice(0,4)),y=b.length;y<4;y++)b.push("");"",k=p.getId(),l.push({ipfsHash:k,title:d,videoId:v,tags:b,styles:m,country:"",year:g,coverArt:void 0,discogsId:void 0})}for(O in this.samplesToSync){for(j=this.samplesToSync[O],w=j.name,E=["","","",""],S=j.videoId||"",(P=j.tags).length>4&&(P.reverse(),P=P.slice(0,4)),x=P.length;x<4;x++)P.push("");T=j.year||2020,C=j.country||"",N=j.getId(),l.push({ipfsHash:N,title:w,videoId:S,tags:P,styles:E,country:C,year:T,coverArt:j.coverArtHash,discogsId:j.discogsId})}if(0!==l.length){e.next=25;break}return e.abrupt("return");case 25:0!==t?In.a.newEncryptedSamples(l,t,u):In.a.newSamplesWithMetadata(l,0);case 26:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadTrackPatternLocks",value:function(e){var t=Object(p.a)({},e.trackPatternLocks);e.tracks&&((t={})[this.currentSubSequence.id]=e.trackPatternLocks),t=Object(p.a)({},this.state.tracks.trackPatternLocks,t),this.store.dispatch(Object(C.x)(t))}},{key:"loadTrackMidiEffects",value:function(e,t,n){if(void 0!==e.tracksMidiEffects){var r=n[t].midiEffects.fromJson(e.tracksMidiEffects[t]);return{effects:n[t].midiEffects.effects,bulk:r}}return{effects:[],bulk:{}}}},{key:"loadTrackEffects",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o,s,c,u,l,f,h,d,m,v,b,g;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=[],o=r[n].effectsChains[0],s={},void 0===t.tracksEffects){e.next=17;break}c=0;case 5:if(!(c<t.tracksEffects[n].length)){e.next=14;break}return e.t0=i,e.next=9,Object(F.a)(t.tracksEffects[n][c],r,this,n);case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 11:c++,e.next=5;break;case 14:o.updateEffects(i.map(function(e){return e.effect})),e.next=47;break;case 17:if(void 0===t.tracksEffectsChains){e.next=45;break}u=r[n],l=t.tracksEffectsChains[n],f=[],e.t2=a.a.keys(l);case 22:if((e.t3=e.t2()).done){e.next=41;break}h=e.t3.value,d=new _.a(u.gainNode,u.trackNode,(new L.a).forTrack(u),this),m=l[h],e.t4=a.a.keys(m);case 27:if((e.t5=e.t4()).done){e.next=37;break}return v=e.t5.value,b=m[v],e.next=32,Object(F.a)(b,r,this,n);case 32:g=e.sent,d.addEffect(g.effect),s=Object(p.a)({},s,g.bulk),e.next=27;break;case 37:d.updateEffects(),f.push(d),e.next=22;break;case 41:u.effectsChains.forEach(function(e){return e.dispose()}),u.effectsChains=f,e.next=47;break;case 45:i=Object(B.a)(this),o.updateEffects(i);case 47:return e.abrupt("return",{effects:i,bulk:s});case 48:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"loadSubSequenceMix",value:function(e,t){t.mix.loadFromJson(e.mix,this)}},{key:"sleep",value:function(e){return new Promise(function(){var t=Object(i.a)(a.a.mark(function t(n,r){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:setTimeout(function(){return n()},e);case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getSleepTime",value:function(){return this.state.mix.isPlayingMix?100:0}},{key:"loadSubSequencePatterns",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o,s,c,u=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:!(u.length>3&&void 0!==u[3])||u[3],i={},o=n.tracks,s=0;case 4:if(!(s<t.tracks.length)){e.next=11;break}return c=o[s],e.next=8,Lr({sequencerEngine:this,track:c,tracks:o,patterns:t.tracks[s],trackData:t.tracksData[s],trackEffects:t.tracksEffects&&t.tracksEffects[s],trackEffectChains:t.tracksEffectsChains&&t.tracksEffectsChains[s],trackMidiEffects:t.tracksMidiEffects[s],patternParameters:t.tracksPatterns[s],subSequence:n});case 8:s++,e.next=4;break;case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"loadSubSequenceTracksParameters",value:function(e,t){for(var n in e.tracksParameters){var r=e.tracksParameters[n];t[n].trackData.loadFromJson(r,void 0,!1,!1,this),t[n].pattern.calculateFills(r)}}},{key:"loadSubSequencePatternParameters",value:function(e,t){for(var n in t)for(var r=t[n],a=0;a<r.patterns.length;a++)r.patterns.length>a&&r.patterns[a].loadFromJson(e.tracksPatterns[n][a])}},{key:"loadSubSequenceEffects",value:function(e,t){for(var n in t){var r=t[n];this.setupNewTrack(r,!0,!0,!1);for(var a=r.getSendNodes(),i=0;i<e.sendVolumes[n].length;i++)a[i]&&(a[i].volume.value=e.sendVolumes[n][i]);void 0!==e.tracksLiveEffects&&r.liveEffects.fromJson(e.tracksLiveEffects[n])}if(e.midiEffects){var o=this.currentSubSequence.midiEffects.fromJson(e.midiEffects);this.dispatch(Object(C.Vb)(o))}}},{key:"getMaxSubSequenceId",value:function(){var e=-1;for(var t in this.subSequences){var n=this.subSequences[t].id;n>e&&(e=n)}return e}},{key:"loadSubSequenceLFOs",value:function(e,t){var n={};for(var r in e.lfos){var a=e.lfos[r];n=Object(p.a)({},n,t.lfos[parseInt(r)].lfo.fromJson(a))}return n}},{key:"loadSubSequenceEnvelopes",value:function(e,t){for(var n in e.envelopes){var r=e.envelopes[n];t.envelopes[parseInt(n)].fromJson(r)}}},{key:"normalizeSubSequenceIds",value:function(e){var t=this,n={},r=function(r){var a=e.subSequences[r].id;jv(a)||t.subSequences.some(function(e){return e.id===a})?n[a]=Object(j.uuid)():n[a]=a};for(var a in e.subSequences)r(a);this.convertSubSequenceIds(e,n)}},{key:"convertSubSequenceIds",value:function(e,t){for(var n in e.subSequences){var r=e.subSequences[n];void 0!==t[r.id]&&(r.id=t[r.id]),e.subSequences[n]=r}var a={},i={},o={},s=new Set(Object.values(t));for(var c in e.trackPatternLocks){if(void 0!==t[c])a[t[c]]=e.trackPatternLocks[c];else s.has(c)||(a[c]=e.trackPatternLocks[c])}for(var u in e.envelopePatternLocks){if(void 0!==t[u])o[t[u]]=e.envelopePatternLocks[u];else s.has(u)||(o[u]=e.envelopePatternLocks[u])}for(var l in e.lfoPatternLocks){if(void 0!==t[l])i[t[l]]=e.lfoPatternLocks[l];else s.has(l)||(i[l]=e.lfoPatternLocks[l])}e.trackPatternLocks=a,e.lfoPatternLocks=i,e.envelopePatternLocks=o}},{key:"loadSequence",value:function(e,t){var n=this;return this.setLoadingProgress(e,0),new Promise(function(){var r=Object(i.a)(a.a.mark(function r(o,s){var c,u,l,f,h,d;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.store.dispatch(Object(C.ad)(e,!0)),r.next=3,Vr.a.getAccount();case 3:if(c=r.sent,u=void 0,r.prev=5,window.isNFT||k.a.getItem("projectHash")!==e){r.next=10;break}u=k.a.getItem("projectData"),r.next=36;break;case 10:if(window.isNFT||!k.a.getItem("sequence."+e)){r.next=14;break}u=k.a.getItem("sequence."+e),r.next=36;break;case 14:if(void 0===c){r.next=36;break}return r.next=17,In.a.guildSequences.getGuildSequence(e);case 17:if(void 0!==(l=r.sent)){r.next=23;break}return r.next=21,In.a.encryption.getSequencesSharedWithUser(e);case 21:l=(l=r.sent)[0];case 23:if(void 0===l){r.next=29;break}return r.next=26,In.a.crypto.fetchAndDecrypt(e,l);case 26:u=r.sent,r.next=36;break;case 29:return r.next=31,In.a.encryption.getEncryptedSequenceIfAny(e);case 31:if(void 0===(f=r.sent)){r.next=36;break}return r.next=35,In.a.crypto.fetchAndDecrypt(e,f);case 35:u=r.sent;case 36:r.next=40;break;case 38:r.prev=38,r.t0=r.catch(5);case 40:h=!1,0==n.tracks.length&&(h=!0),d=new hv.a(!jv(e),jv(e)?e:void 0,jv(e)?void 0:e,u),void 0===t&&d.loadTitle().then(function(e){n.store.dispatch(Object(C.yf)(e))}),n.dispatch(Object(C.rb)(!1)),d.load().then(function(){var r=Object(i.a)(a.a.mark(function r(i){var s,c,u,l,f,d,m,v,b,y,k,j,w,E,S,P,x,T,N,R,M,A,q,D,I,_,F,L,B,z,V,H,U,J,G,W,K,X,Y,Z,$,ee,te,ne,re,ae;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n.bulkConnections={},n.loadedSequenceId=e,console.log(Object(p.a)({},i)),void 0===t&&(n._wallpaper=i.wallpaper),i.wallpaper&&(window.exhibit||!window.explore||O.isMobile)&&void 0===t&&n.dispatch(Object(C.Gh)(i.wallpaper)),!((s=Object(dv.a)(i)).length<=5)){r.next=10;break}return r.next=9,Object(dv.b)(s,n.encryptedIpfs,n.getSleepTime(),n);case 9:n.loadedSamples=r.sent;case 10:if(n.setLoadingProgress(e,25),n.normalizeSubSequenceIds(i),n.length,c=pe.a.oldDefaultResolution,i.groups,n.hasAtleastOneSequencerEnginePlaying()||void 0===t&&(n.updateBpm(i.bpm),Object(Q.a)(i,"bpmParameter",n.bpmParameter)),"samplesMetadata"in i&&(window.samplesMetadata=i.samplesMetadata),void 0===i.subSequences){for(l in i.subSequences=[{id:0,tracks:i.tracks,tracksData:i.tracksData,groups:i.groups,envelopes:i.envelopes,lfos:i.lfos,tracksParameters:i.tracksParameters,tracksPatterns:i.tracksPatterns,tracksEffects:i.tracksEffects,tracksMidiEffects:i.tracksMidiEffects,tracksLiveEffects:i.tracksLiveEffects,sendVolumes:i.sendVolumes}],u={},i.tracksData)f=i.tracksData[l],u[l]=f.patternLocks;i.trackPatternLocks=u}return n.normalizeSubSequenceIds(i),"swing"in i&&(n.updateSwing(i.swing),Object(Q.a)(i,"swingParameter",n.swingParameter)),c=Ov(i.resolution),d=!1,"hasPatterns"in i&&(d=!0),h&&(n.playSequence=n.getPlaySequence()),r.next=26,n.loadSubSequences(i,t);case 26:if(m=r.sent,n.loadTrackPatternLocks(i),!("sends"in i)){r.next=31;break}return r.next=31,n.sends.loadFromJson(i.sends,t);case 31:n.setLoadingProgress(e,35),v={},r.t0=a.a.keys(m);case 34:if((r.t1=r.t0()).done){r.next=59;break}return b=r.t1.value,n.setLoadingProgress(e,35+parseFloat(b)/m.length*35),(new Date).getTime(),y=void 0!==t?t:b,n.switchToSubSequence(m[b].id,!1),r.t2=p.a,r.t3={},r.t4=v,r.next=45,n.loadSubSequencePatterns(i.subSequences[y],m[b],c,d);case 45:r.t5=r.sent,v=(0,r.t2)(r.t3,r.t4,r.t5),n.loadSubSequenceTracksParameters(i.subSequences[y],m[b].tracks),n.loadSubSequenceEffects(i.subSequences[y],m[b].tracks),v=Object(p.a)({},v,n.loadSubSequenceLFOs(i.subSequences[y],m[b])),n.loadSubSequenceEnvelopes(i.subSequences[y],m[b]),n.loadSubSequenceMix(i.subSequences[y],m[b]),m[b].loadPadsJson(i.subSequences[y].pads),m[b].loadSequencersJson(i.subSequences[y].sequencers),(new Date).getTime(),m[b].loadZObjectsJson(i.subSequences[y].zobjects),(new Date).getTime(),r.next=34;break;case 59:n.switchToSubSequence(m[0].id,!1),n.store.dispatch(Object(C.Vb)(v)),"effectPatternLocks"in i&&n.dispatch(Object(C.u)(i.effectPatternLocks)),"lfoPatternLocks"in i&&(k=Object(p.a)({},i.lfoPatternLocks),i.tracks&&((k={})[n.currentSubSequence.id]=i.lfoPatternLocks),k=Object(p.a)({},n.state.tracks.lfoPatternLocks,k),n.store.dispatch(Object(C.w)(k))),n.setLoadingProgress(e,80),"theme"in i&&n.dispatch(Object(C.Kg)(i.theme)),"envelopePatternLocks"in i&&(j=Object(p.a)({},i.envelopePatternLocks),i.tracks&&((j={})[n.currentSubSequence.id]=i.envelopePatternLocks),j=Object(p.a)({},n.state.tracks.envelopePatternLocks,j),n.store.dispatch(Object(C.v)(j))),n.gateMode=!("gateMode"in i)||i.gateMode,r.t6=a.a.keys(m);case 68:if((r.t7=r.t6()).done){r.next=76;break}return w=r.t7.value,E=void 0!==t?t:w,n.switchToSubSequence(m[w].id,!1),r.next=74,m[w].groups.fromJson(i.subSequences[E].groups,n);case 74:r.next=68;break;case 76:return n.setLoadingProgress(e,90),"mix"in i&&n.mix.loadFromJson(i.mix,n),n.loadParameterLocks(i),r.next=81,n.sleep(n.getSleepTime());case 81:for(S in n.setLoadingProgress(e,95),m)for(x in(P=m[S]).tracks)void 0===(T=P.tracks[x]).group&&("MIDI"===T.getTrackType()?P.groups.addMidiTrack(T):void 0!==T.sample&&void 0!==T.sample.ipfsHash&&P.groups.addTrack(T)),n.loadPulledEffects(i.pulledEffects);N=vv(m);try{for(M=function(){var e=R.value;setTimeout(function(){e.loadLostParameters(!0);var t,n=vv(e.tracks);try{for(n.s();!(t=n.n()).done;){var r,a=t.value,i=vv(a.patterns);try{for(i.s();!(r=i.n()).done;){r.value.getAllSteps().forEach(function(e){return e.loadParameterLocks()})}}catch(o){i.e(o)}finally{i.f()}a.updateSteps()}}catch(o){n.e(o)}finally{n.f()}},750)},N.s();!(R=N.n()).done;)M()}catch(ie){N.e(ie)}finally{N.f()}if("lockedObjects"in i&&n.store.dispatch(Object(C.wh)(i.lockedObjects)),"masterChannel"in i&&void 0===t&&n.channelMixer.masterChannel.fromJson(i.masterChannel),"patternColors"in i)for(A in i.patternColors)n.store.dispatch(Object(C.Wd)(parseInt(A),i.patternColors[A]));"scenes"in i&&n.scenes.fromJson(i.scenes),"effectsCollapsed"in i&&n.dispatch(Object(C.db)(i.effectsCollapsed)),"cableSegmentations"in i&&n.dispatch(Object(C.ib)(i.cableSegmentations)),"effectStarred"in i&&n.dispatch(Object(C.eb)(i.effectStarred)),q=n.sends.sends.filter(function(e){return!e.hookupPads()}),void 0!==t&&n.sends.deleteSends(q),D=(new Date).getTime(),n.checkSubPatchInstances(),I=(new Date).getTime(),console.log("check substance instances  took %s ms",I-D),"inletConnections"in i&&n.loadInletConnections(i.inletConnections),console.log("loaded inlet connections took %s ms",(new Date).getTime()-I),console.log("checking instance connections"),_=(new Date).getTime(),n.checkInstanceConnections(),F=(new Date).getTime(),console.log("checked instance took %s ms",F-_),"higherOrderSequencer"in i&&void 0===t&&n.higherOrderSequencer.fromJson(i.higherOrderSequencer),"nftZObject"in i&&(n.nftZObject=n.findNodeById(i.nftZObject)),n.updateTracks(),n.store.dispatch(Object(C.yd)(n.numberOfPatterns())),void 0!==n.update&&n.update(e),n.selectTrack(0),L=(new Date).getTime();for(B=m.length-1;B>=0;B--){n.switchToSubSequence(m[B].id,!0),n.currentSubSequence.loadBangZObjects(),n.currentSubSequence.loadNFTZObjects(),z=vv(n.tracks);try{for(z.s();!(V=z.n()).done;)V.value.midiEffects.setupMessageReader()}catch(ie){z.e(ie)}finally{z.f()}}for(U in H=(new Date).getTime(),console.log("load bangs took %s ms",H-L),n.checkPads(),console.log("check pads took %s ms",(new Date).getTime()-H),n.setLoadingProgress(e,100),n.store.dispatch(Object(C.ad)(e,!1)),n.bulkConnections)J=n.state.windows.inletConnections[U]||{},n.dispatch(Object(C.Bc)(U,Object(p.a)({},J,n.bulkConnections[U])));if("presentationMode"in i&&n.dispatch(Object(C.pe)(i.presentationMode)),"presentationWindowPositions"in i&&n.dispatch(Object(C.fb)(i.presentationWindowPositions)),!("windowPositions"in i)){r.next=143;break}if(!Array.isArray(i.windowPositions)){r.next=142;break}G={},W=n.getAllZObjects(),W.map(function(e){return e.id}),K=0;case 129:if(!(K<i.windowPositions.length)){r.next=139;break}if(X=i.windowPositions[K],Y=i.windowPositions[K+1],W[K/2]){r.next=134;break}return r.abrupt("continue",136);case 134:Z=W[K/2].id,null!==X&&null!==Y&&(G[Z]={x:X,y:Y});case 136:K+=2,r.next=129;break;case 139:n.dispatch(Object(C.gb)(G)),r.next=143;break;case 142:n.dispatch(Object(C.gb)(i.windowPositions));case 143:i.pluginsLoaded&&($=i.pluginsLoaded.map(function(e){return n.findNodeById(e)}).filter(function(e){return e}),n.dispatch(Object(C.ne)($))),n.compile(),ee=vv(n.subSequences);try{for(ee.s();!(te=ee.n()).done;){ne=te.value,re=vv(ne.pads);try{for(re.s();!(ae=re.n()).done;)ae.value.sendSliderLevels()}catch(ie){re.e(ie)}finally{re.f()}}}catch(ie){ee.e(ie)}finally{ee.f()}n.dispatch(Object(C.rb)(!0)),Object(g.a)(n),o();case 150:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}());case 46:case"end":return r.stop()}},r,null,[[5,38]])}));return function(e,t){return r.apply(this,arguments)}}())}},{key:"newNumberOfPatterns",value:function(e){for(var t=this.numberOfPatterns();t<e;t++)this.newPattern(!0)}},{key:"combineWithSequencerEngine",value:function(e){for(var t in e.subSequences){var n=e.subSequences[t];if(void 0!==this.getSubSequence(n.id)){var r=-1;for(var a in this.subSequences){var i=this.subSequences[a].id;i>r&&(r=i)}n.id=r+1,this.addSubSequence(n)}}}},{key:"loadParameterLocks",value:function(e){if("parameterLocks"in e){var t=e.parameterLocks;for(var n in this.parameterLocks=[],t){var r=new Mp;r.fromJson(t[n],this),this.parameterLocks.push(r)}for(;this.parameterLocks.length<2;)this.parameterLocks.push(new Mp)}}},{key:"loadSlices",value:function(e,t){var n=[];return"samplersParameters"in e&&(Array.isArray(e.samplersParameters[t])?n=e.samplersParameters[t]:n.push({startTime:e.samplersParameters[t].startTime,endTime:e.samplersParameters[t].endTime})),n}},{key:"newRecordingToSaveLater",value:function(e){this.recordingsToSave.push(e)}},{key:"getParameterFromJson",value:function(e){var t=e.context,n=new L.a,r=void 0,a=[];if(void 0!==t.track){var i=0;void 0!==t.chainNumber&&(i=t.effectsChainNumber),a=(r=this.tracks[t.track]).effectsChains[i].effects,n=n.forTrack(r)}else if(void 0!==t.group){var o=this.groups.groups[t.group];a=o.effects,n=n.forGroup(o)}else if(void 0!==t.sends){var s=this.sends.sends[t.sends];a=s.effects,n=n.forSend(s)}var c=void 0;if(t.isInstrument)c=r.instrument.parameters;else if(void 0!==t.effect&&-1!=t.effect){c=a[t.effect].parameters}else void 0!==r&&(c=r.trackData.parameters);if(void 0!==c){var u=e.name,l=c.filter(function(e){return e.name===u});if(l.length>=1)return l[0]}}},{key:"getEffectsPreset",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u,l,f,h;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},i={},t.effectsChains&&(t.trackEffectsChains=t.effectsChains),!t.trackEffectsChains){e.next=26;break}o=[],e.t0=a.a.keys(t.trackEffectsChains);case 6:if((e.t1=e.t0()).done){e.next=25;break}s=e.t1.value,c=new _.a(n.gainNode,n.trackNode,(new L.a).forTrack(n),this),u=t.trackEffectsChains[s],c.initDefault(),e.t2=a.a.keys(u);case 12:if((e.t3=e.t2()).done){e.next=22;break}return l=e.t3.value,f=u[l],e.next=17,Object(F.a)(f,this.tracks,this,s);case 17:h=e.sent,i=Object(p.a)({},i,h.bulk),c.addEffect(h.effect),e.next=12;break;case 22:o.push(c),e.next=6;break;case 25:r.effectsChains=o;case 26:return t.midiEffects&&(r.midiEffects=new oa.a(n),i=Object(p.a)({},i,r.midiEffects.fromJson(t.midiEffects))),this.store.dispatch(Object(C.Vb)(i)),e.abrupt("return",r);case 29:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadEffectsPreset",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:this.tracks[this.store.getState().cursor.track],n&&this.loadLFOsAndEnvelopes(t),e.next=4,this.getEffectsPreset(t,r);case 4:(i=e.sent).effectsChains&&(r.effectsChains=i.effectsChains),i.midiEffects&&(r.midiEffects=i.midiEffects),t.liveEffects&&(r.liveEffects=new $f.a(r),r.liveEffects.fromJson(t.liveEffects));case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"auditionPreset",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u,l,f,d,m,v,b=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(b.length>2&&void 0!==b[2])||b[2],i=b.length>3&&void 0!==b[3]&&b[3],o=!(b.length>4&&void 0!==b[4])||b[4],s=t.title,o){e.next=8;break}e.t0=t.data,e.next=11;break;case 8:return e.next=10,yv.getPresetData(t);case 10:e.t0=e.sent;case 11:return c=e.t0,(u=this.tracks[n]).tracks&&c.trackParameters.type!==A.c?u=(u=this.state.tracks.selectedRackSubTrack[u.id]||u.tracks[0]).track:u.tracks&&Object(h.a)(u.tracks).forEach(function(e){return u.deleteInstrument(e)}),l={},r&&(l=this.loadLFOsAndEnvelopes(c,u)),u.preset=new Qe.a(t.title,t.contentHash,t.user,t.blockNumber),u.preset.track=u,u.preset.data=c,u.preset.tags=t.tags,u.presetName=s,u.preset.name=s,u.getAllParameters().forEach(function(e){return e.unmap()}),u.liveEffects.clearEffects(),f=u.volumeParameter.get(),e.t1=p.a,e.t2={},e.t3=l,e.next=30,u.fromJson(c.trackParameters,void 0,!1,!1,!0,!0);case 30:return e.t4=e.sent,l=(0,e.t1)(e.t2,e.t3,e.t4),u.setVolume(f),d=u.getAllParameters(),m=d.filter(function(e){return e.automations&&e.automations.length>0}),this.store.dispatch(Object(C.d)(m)),i&&u.effectsChains.forEach(function(e){return e.clear()}),u.midiEffects.clear(),u.midiEffects.effects.forEach(function(e){return e.dispose()}),u.midiEffects.effects=[],u.preset.hasEdits=!1,u.presetName=s,e.t5=p.a,e.t6={},e.t7=l,e.next=47,this.loadPresetEffects(u,c,!i);case 47:for(e.t8=e.sent,l=(0,e.t5)(e.t6,e.t7,e.t8),u.loadLostParameters(),u.setIsEnabled(u.isEnabled),v=2;v<u.sendNodeVolumeParameters.length;v++)this.sends.sends[v].pad!==u.pad&&u.sendNodeVolumeParameters[v].set(-90);this.store.dispatch(Object(C.Vb)(l)),this.update(),u.updateSteps(),u.preset.loadMods=r,u.preset.loadEffects=i,this.addPresetToBrowsedPresets(u,u.preset),this.loadedProject=!0;case 59:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"addPresetToBrowsedPresets",value:function(e,t){var n=this.state.tracks.trackBrowsedPresets[e.id]||[];if(!n.some(function(e){return e.contentHash===t.contentHash})){var r=[t].concat(Object(h.a)(n.filter(function(e){return e.ipfsHash!==t.ipfsHash})));this.store.dispatch(Object(C.Qg)(e.id,r))}}},{key:"loadPreset",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u,l,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.contentHash,i=t.title,void 0===r&&"string"===typeof t&&(r=t),e.next=5,yv.getPresetData(t);case 5:return o=e.sent,e.next=8,yv.getPresetInstrumentType(r);case 8:if(e.sent!==z.a){e.next=12;break}return this.loadEffectsPreset(o,n),e.abrupt("return");case 12:if(void 0!==o.tracks){e.next=17;break}return e.next=15,this.loadTrackPreset(o,r,n,void 0,i,void 0,t);case 15:return this.tracks[this.tracks.length-1].presetName=i,e.abrupt("return");case 17:for(c in s={},o.tracks)s[c]=this.tracks.length,this.loadTrackPreset(o.tracks[c],void 0,n);if(o.keyMappings)for(u in o.keyMappings)l=o.keyMappings[u],f=s[l.trackNumber],this.keyboardEngine.map(l.key,f,l.sliceNumber);case 20:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadLFOsAndEnvelopes",value:function(e,t){var n={};if("lfos"in e)for(var r in e.lfos){var a=e.lfos[r],i=t.lfosTrack||this.currentSubSequence.lfosTrack;n=Object(p.a)({},n,i.lfos[parseInt(r)].lfo.fromJson(a))}if("envelopes"in e)for(var o in e.envelopes){var s=e.envelopes[o],c=t.envelopesTrack||this.currentSubSequence.envelopesTrack;n=Object(p.a)({},n,c.envelopes[parseInt(o)].envelope.fromJson(s))}return n}},{key:"loadPresetAsSubSequence",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.contentHash,i=t.name,void 0===r&&"string"===typeof t&&(r=t),void 0!==n){e.next=7;break}return e.next=6,yv.getPresetData(t);case 6:n=e.sent;case 7:return e.next=9,this.loadTrackPreset(n,r,!1,!1,i,1,t);case 9:o=e.sent,this.newSubSequence(void 0,o),this.loadLFOsAndEnvelopes(n),o.trackNumber=0,o.updateSteps();case 14:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadTrackPreset",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o,s,c,u,l,f,h,p,d=this,m=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(m.length>3&&void 0!==m[3])||m[3],o=m.length>4?m[4]:void 0,s=m.length>5&&void 0!==m[5]?m[5]:this.numberOfPatterns(),c=m.length>6?m[6]:void 0,u=void 0,t.trackParameters.type!==A.d){e.next=13;break}return u=new Er(this.tracks.length,this,this.mixSession,s,function(){return d.update()},this.currentSubSequence),e.next=9,M(u,t.trackParameters,this.currentSubSequence);case 9:u.setMidiEngine(this.midi),this.setupRecordableTrack(u),e.next=21;break;case 13:if(t.trackParameters.type!==A.b&&t.trackParameters.type!==A.c){e.next=18;break}l=t.trackParameters.instrumentType,u=pr(this,t.trackParameters.type,l,s),e.next=21;break;case 18:return u=new Ke(this.tracks.length,this,this.mixSession,s,function(){return d.update()},this.sends),e.next=21,M(u,t.trackParameters,this.currentSubSequence);case 21:return u.setSends(this.sends),e.next=24,u.fromJson(t.trackParameters,void 0,void 0,void 0,!0);case 24:if(f=e.sent,this.dispatch(Object(C.Vb)(f)),u.trackData.loadFromJson(t.trackData,void 0,!1,!1,this),this.loadPresetEffects(u,t),u.gated=t.trackParameters.gated,r&&this.loadLFOsAndEnvelopes(t,u),i){if(this.setupNewTrack(u,!0,!0),this.groups.addTrack(u),"sendVolumes"in t)for(h=u.getSendNodes(),p=0;p<t.sendVolumes.length;p++)h[p]&&(h[p].volume.value=t.sendVolumes[p]);this.currentSubSequence.addTrack(u),u.switchToPattern(this.currentPattern),u.updateSteps(),this.update()}return u.presetId=n,u.presetName=o,c&&(u.preset=new Qe.a(o,n,c.user,c.blockNumber),u.preset.load(),u.preset.track=u),this.currentSubSequence.addTrackToPadIfPossible(u),setTimeout(function(){u.loadLostParameters()},750),e.abrupt("return",u);case 37:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"loadPresetEffects",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u,l,f,h,d,m,v,b=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=b.length>2&&void 0!==b[2]&&b[2],i={},r){e.next=41;break}if(!n.trackEffects){e.next=17;break}o=[],s=0;case 6:if(!(s<n.trackEffects.length)){e.next=14;break}return e.next=9,Object(F.a)(n.trackEffects[s],this.tracks,this);case 9:c=e.sent,o.push(c.effect);case 11:s++,e.next=6;break;case 14:t.effectsChains[0].effects=o,e.next=41;break;case 17:if(!n.trackEffectsChains){e.next=41;break}u=[],e.t0=a.a.keys(n.trackEffectsChains);case 20:if((e.t1=e.t0()).done){e.next=39;break}l=e.t1.value,f=new _.a(t.gainNode,t.trackNode,(new L.a).forTrack(t),this),h=n.trackEffectsChains[l],e.t2=a.a.keys(h);case 25:if((e.t3=e.t2()).done){e.next=35;break}return d=e.t3.value,m=h[d],e.next=30,Object(F.a)(m,this.tracks,this,l);case 30:v=e.sent,i=Object(p.a)({},i,v.bulk),f.addEffect(v.effect),e.next=25;break;case 35:f.updateEffects(),u.push(f),e.next=20;break;case 39:t.effectsChains.forEach(function(e){return e.dispose()}),t.effectsChains=u;case 41:return n.midiEffects&&(i=Object(p.a)({},i,t.midiEffects.fromJson(n.midiEffects))),n.liveEffects&&t.liveEffects.fromJson(n.liveEffects),e.abrupt("return",i);case 44:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveProjectAsPreset",value:function(){var e=this,t=[];for(var n in this.tracks){var r=this.getTrackPreset(n);t.push(r)}var a=void 0;t.length>0&&(a=t[0].lfos);var i={lfos:a,tracks:t,keyMappings:this.keyboardEngine.keyMappings,midiMappings:this.keyboardEngine.midiMappings},o=window.prompt("Type name of preset");yv.newPreset(i,o).catch(function(e){console.log(e)}).then(function(t){e.presetId=t})}},{key:"saveZObjectPreset",value:function(e,t){var n=e.getInstrumentType(),r=e.getPresetJson();yv.newPreset(r,t,void 0,n,0)}},{key:"saveTrackPreset",value:function(e,t,n,r,o){var s=this;return new Promise(function(){var o=Object(i.a)(a.a.mark(function o(c,u){var l,f,h,p;return a.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(l=s.tracks[e],0!=r){o.next=4;break}return o.next=4,l.makePublicIfNeeded();case 4:f=n?s.getEffectPreset(e):s.getTrackPreset(e),h=n?z.a:l.getInstrumentType(),l.tracks&&(h=A.c),p=void 0,void 0===l.sample||n||(p=l.sample.getId()),yv.newPreset(f,t,p,h,r).catch(function(e){console.log(e)}).then(function(){var e=Object(i.a)(a.a.mark(function e(n){var r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l.presetId=n,console.log("preset id=",n),s.dispatch(Object(C.se)({contentHash:n,title:t,name:t,tags:[]})),!l.resampledFrom||!l.resampledFrom.contentHash){e.next=6;break}return e.next=6,In.a.xanadu.presetResampled(l.resampledFrom.contentHash,n);case 6:h===z.b&&void 0!==(r=l.midiEffects.effects.filter(function(e){return"Midi Interface"===e.name})[0])&&(i=r.midiOutput.name,yv.tagPreset(n,[i])),c(n);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return o.stop()}},o)}));return function(e,t){return o.apply(this,arguments)}}())}},{key:"updateTrackPreset",value:function(e){var t=this.getTrackPreset(e),n=this.tracks[e];yv.updatePresetIpfsHash(n.presetId,t)}},{key:"getEffectPreset",value:function(e){var t=this.tracks[e],n=t.effectsChains.map(function(e){return e.getJson()});return{lfo:this.lfos.map(function(e){return e.getJson()}),envelopes:this.envelopes.map(function(e){return e.getJson()}),trackEffectsChains:n,midiEffects:t.midiEffects.getJson(),liveEffects:t.liveEffects.getJson()}}},{key:"getTrackPreset",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.tracks[e],r=n.getSendNodes().map(function(e){return e.volume.value}),a=n.effectsChains.map(function(e){return e.getJson(t)}),i=n.lfosTrack||this.lfosTrack,o=n.envelopeTrack||this.envelopesTrack;return{lfos:i.lfos.map(function(e){return e.getJson(t)}),envelopes:o.envelopes.map(function(e){return e.getJson()}),trackData:n.trackData.getJson(),trackParameters:n.getJson(!0,t),sendVolumes:r,sendVolumees:r,trackEffectsChains:a,midiEffects:n.midiEffects.getJson(t),liveEffects:n.liveEffects.getJson(t)}}},{key:"loadOldMixFromJson",value:function(e){if(void 0!==e){var t={},n={};for(var r in e.deterministicMixesByType)1===parseInt(r)?n[r]=e.deterministicMixesByType[r]:t[r]=e.deterministicMixesByType[r];this.mix.loadFromJson(Object(p.a)({},e,{deterministicMixesByType:t})),this.currentSubSequence.mix.loadFromJson(Object(p.a)({},e,{deterministicMixesByType:n}))}}},{key:"getSamples",value:function(){var e=[];for(var t in this.subSequences){var n=this.subSequences[t];for(var r in n.tracks){var a=n.tracks[r];if(a.sample&&e.push(a.sample.getId()),a.frozenColumns){var i,o=vv(a.frozenColumns);try{for(o.s();!(i=o.n()).done;){var s,c=vv(i.value.frozenSamples);try{for(c.s();!(s=c.n()).done;){var u=s.value;e.push(u.getId())}}catch(l){c.e(l)}finally{c.f()}}}catch(l){o.e(l)}finally{o.f()}}}}return e}},{key:"addSampleToSync",value:function(e){this.samplesToSync.push(e)}},{key:"replaceWithEncryptedSample",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r in this.subSequences)for(o in(i=this.subSequences[r]).tracks){for(u in s=i.tracks[o],c={},s.samplers)u===t?c[n]=s.samplers[u]:c[u]=s.samplers[u];s.samplers=c,s.soundIds=Object.keys(s.samplers)}case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadSampleFromSequence",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gr.a.getJson(n);case 2:for(s in r=e.sent,i=r.subSequences,o={},i)for(l in c=i[s],u=function(e){e=parseInt(e);var n=c.tracksData[e];if(t in n.samplers){(o=Object(p.a)({},c)).trackParameters=n,o.sendVolumes=c.sendVolumes[e],o.trackPatterns=c.tracksPatterns[e],o.trackEffectsChains=c.tracksEffectsChains[e],o.trackMidiEffects=c.tracksMidiEffects[e],o.trackLiveEffects=c.tracksLiveEffects[e],o.trackData=c.tracksParameters[e],o.mix=c.mix,o.tracks=c.tracks[e];var r=c.groups.find(function(t){return t.tracks.indexOf(e)>-1});r.tracks=[0],o.groups=[r]}l=e},c.tracksData)u(l);this.loadPresetAsSubSequence({},o);case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setLoadingProgress",value:function(e,t){console.log("setting loading progress=",e,t),this.store.dispatch(Object(C.xf)(e,t))}},{key:"loadPulledEffects",value:function(e){if(e){var t,n=[],r=vv(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if("object"===typeof a){var i=a.id,o=a.type,s=a.instrumentId,c=a.x,u=a.y,l=a.width,f=a.height,h=x(s||i,o,this);h&&n.push(Object(p.a)({},a,h,{x:c,y:u,width:l,height:f}))}else{var d=P(a,this);d&&n.push(d)}}}catch(m){r.e(m)}finally{r.f()}this.dispatch(Object(C.we)(n))}}},{key:"trackIDExists",value:function(e,t){return this.subSequences.flatMap(function(e){return e.tracks}).some(function(n){return n.id===e&&n!==t})}},{key:"loadInletConnections",value:function(e){var t=this,n=function(n){var r=t.subSequences.find(function(e){return e.id===n});if(!r){var a,i=vv(t.subSequences);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(o.findNodeByName("subpatch").find(function(e){return e.effect.id===n})){r=o;break}}}catch(s){i.e(s)}finally{i.f()}}t.switchToSubSequence(r?r.id:n),t.loadInletConnectionsForId(e[n])};for(var r in e)n(r)}},{key:"loadInletConnectionsForId",value:function(e,t){(new Date).getTime();for(var n in e){var r,a=vv(e[n]);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=i.sourceType,s=i.sourceId,c=i.destType,u=i.destId,l=i.id,f=this.findNodeById(u),h=this.findNodeById(s);if(f&&h){if(h.isSubPatch&&h.instances.length>0)continue;f.connectInlet(c,h,o,l,t)}}}catch(p){a.e(p)}finally{a.f()}}(new Date).getTime()}},{key:"findNodeById",value:function(e,t){return this.idToObject[e]?this.idToObject[e]:void 0}},{key:"_findNodeById",value:function(e,t){var n,r=vv(this.currentSubSequence.pads);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.id===e)return a}}catch(S){r.e(S)}finally{r.f()}var i=this.tracks.find(function(t){return t.id===e});if(i)return i;var o=t?this.subSequences.reduce(function(e,t){return[].concat(Object(h.a)(e),Object(h.a)(Object(y.a)(t)))},[]).find(function(t){return t.id===e||t.effect&&t.effect.id===e}):this.subSequences.reduce(function(e,t){return[].concat(Object(h.a)(e),Object(h.a)(Object(y.a)(t)))},[]).find(function(t){return t.id===e});if(o)return o;for(var s=0,c=[].concat(Object(h.a)(this.subSequences),Object(h.a)(this.tracks));s<c.length;s++){var u=c[s];if(u.getAllEffects){var l=u.getAllEffects().find(function(t){return t.id===e});if(l)return l}if(u.effects){var f,p=vv(u.effects);try{for(p.s();!(f=p.n()).done;){var d=f.value;if(d.id===e)return d;if(d.effects){var m,v=vv(d.effects);try{for(v.s();!(m=v.n()).done;){var b=m.value;if(e===b.id)return b}}catch(S){v.e(S)}finally{v.f()}}}}catch(S){p.e(S)}finally{p.f()}}var g,k=vv(u.midiEffects.effects);try{for(k.s();!(g=k.n()).done;){var O=g.value;if(O.id===e)return O;if(O.effects){var j,w=vv(O.effects);try{for(w.s();!(j=w.n()).done;){var E=j.value;if(e===E.id)return E}}catch(S){w.e(S)}finally{w.f()}}}}catch(S){k.e(S)}finally{k.f()}}}},{key:"checkPads",value:function(){this.subSequences.forEach(function(e){return e.checkPads()})}},{key:"checkSubPatchInstances",value:function(e){var t,n=vv(this.subSequences);try{for(n.s();!(t=n.n()).done;){var r,a=t.value,i=a.findNodeByName("subpatch",!0),o=a.findNodeByName("instancedSubpatch",!0),s=vv(i);try{for(s.s();!(r=s.n()).done;){var c=r.value,u=(c=c.effect).instanceIds;if(u){e&&(u=u.map(function(t){return e[t]||t}));var l,f=vv(u);try{var h=function(){var e=l.value,t=o.map(function(e){return e.effect}).find(function(t){return t.id===e});if(t&&!t.implements){c.instances.push(t);(new Date).getTime();c.copyIntoInstance(t);(new Date).getTime();t.implements=c}};for(f.s();!(l=f.n()).done;)h()}catch(p){f.e(p)}finally{f.f()}c.instanceIds=void 0}}}catch(p){s.e(p)}finally{s.f()}}}catch(p){n.e(p)}finally{n.f()}}},{key:"checkInstanceConnections",value:function(){var e,t=vv(this.subSequences);try{for(t.s();!(e=t.n()).done;){var n,r=e.value,a=r.findNodeByName("subpatch",!0),i=(r.findNodeByName("instancedSubpatch",!0),vv(a));try{for(i.s();!(n=i.n()).done;){var o,s=n.value,c=vv((s=s.effect).instances);try{for(c.s();!(o=c.n()).done;){var u=o.value;s.copyConnectionsIntoInstance(u)}}catch(l){c.e(l)}finally{c.f()}}}catch(l){i.e(l)}finally{i.f()}}}catch(l){t.e(l)}finally{t.f()}}},{key:"getAllZObjects",value:function(){var e,t=[],n=vv(this.subSequences);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=[].concat(Object(h.a)(t),Object(h.a)(Object(y.a)(r)))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"generateProjectMetadata",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.a)(this,t);case 2:n=e.sent,console.log("generated",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"saveProjectMetadata",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)(1e3);case 2:return e.next=4,Object(v.a)(this,t);case 4:n=e.sent,Object(v.c)(n);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),n}(fv);function Ov(e){var t=e.toString().indexOf("t");return t>0?new br.a(parseInt(e.slice(0,t)),!0):new br.a(parseInt(e),!1)}function jv(e){return!isNaN(parseFloat(e))&&isFinite(e)}var wv=function(e,t){var n={};for(var r in e){var a={};for(var i in e[r]){var o,s=[],c=vv(e[r][i]);try{for(c.s();!(o=c.n()).done;){var u=o.value,l=t.findNodeById(u.destId);if(t.findNodeById(u.sourceId)&&l){var f={id:u.id,destId:u.destId,sourceId:u.sourceId,sourceType:u.sourceType,destType:u.destType};s.push(f)}}}catch(h){c.e(h)}finally{c.f()}s.length>0&&(a[i]=s)}Object.keys(a).length>0&&(n[r]=a)}return n},Ev=function(e,t){var n=t.getAllZObjects().map(function(e){return e.id}),r=[];for(var a in e){var i=n.indexOf(a);i<-1||(e[a]?0===e[a].x&&0===e[a].y||(r[2*i]=e[a].x,r[2*i+1]=e[a].y):(r[2*i]=0,r[2*i+1]=0))}return r},Sv=kv,Pv=n(346),xv=n(420),Tv=n(662),Cv=new br.a(32,!1),Nv=function(){function e(t){Object(o.a)(this,e),this.store=t,this.step=0,this.track=0,this.group=0,this.show=!1}return Object(s.a)(e,[{key:"step",get:function(){return this.store.getState().cursor.step},set:function(e){this.store.dispatch(Object(C.Hb)(e)),this.updateRedux()}},{key:"track",get:function(){return this.store.getState().cursor.track},set:function(e){this.store.dispatch(Object(C.Ib)(e))}},{key:"show",get:function(){return this.store.getState().cursor.show},set:function(e){this.store.dispatch(Object(C.Gb)(e))}},{key:"getJson",value:function(){return{step:this.step,track:this.track}}},{key:"getStep",value:function(e){return void 0===e?this.step:e.transformStepAtResolution2(this.step,Cv)}},{key:"setStep",value:function(e,t){this.step=Cv.transformStepAtResolution2(e,t)}},{key:"resolution",get:function(){return this.store.getState().sequencer.resolution}},{key:"updateRedux",value:function(){this.store.dispatch(Object(C.sf)(this.track)),this.store.dispatch(Object(C.rf)(this.getStep(this.resolution))),this.store.dispatch(Object(C.Zd)(this.getStep(this.resolution)))}}]),e}(),Rv=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(o.a)(this,e),this.module=null,this.orientation=r,this.size=n,this.y=t}return Object(s.a)(e,[{key:"getJson",value:function(){return{module:this.module&&this.module.id,orientation:this.orientation,size:this.size,y:this.y,x:this.x}}},{key:"fromJson",value:function(e,t){this.x=e.x,this.y=e.y,this.orientation=e.orientation,this.size=e.size,this.module=e.module&&t.subSequences.find(function(t){return t.id===e.module})}}]),e}();n(600);function Mv(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Av(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Av(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Av(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Dv=n(774);function Iv(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return _v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function _v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Lv=n(387),Bv=n(320);function zv(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Vv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vv(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Vv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Hv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Uv=function(e,t,n,r){var a=n?n.get():100,i=Math.max(.001,(10-e)/10);return t.min+(t.max-t.min)*i*r*(a/100)};function Jv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Gv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Wv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Kv(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Xv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xv(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function Xv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Yv=n(398);function Zv(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return $v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function $v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function eb(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var tb=n(384);function nb(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return rb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rb(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function rb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ab(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function ib(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function ob(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var sb=function(e){Object(u.a)(n,e);var t=ob(n);function n(e){var r;Object(o.a)(this,n),(r=t.call(this)).sequencerEngine=e,r.matrix=new Array(16).fill([]),r.steps=[];for(var a=0;a<16;a++)r.matrix[a]=new Array(10).fill(0);return r.initScripting(),r.initDisabledParameters(),r.initAutomation(),r}return Object(s.a)(n,[{key:"stop",value:function(){this.wasRolling=!1,this.currentAlgorithms={}}}]),n}(Object(Ve.a)(function(e){return function(e){Object(u.a)(n,e);var t=Qv(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"processGraphics",value:function(e,t){var n,r=Math.floor(e/2)%16,a=Kv(t);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=i.type,s=i.arg,c=r,u=s&&s[0]&&Object(dn.a)(s[0],10),l=s&&s[1],f=s&&s[2];switch(o){case"DRAW":this.newStep(c,u,l,f);break;case"ERASE":var h=this.matrix[c].filter(function(e){return e});if(void 0!==u){var p=this.matrix[c][u];p&&(h=[p])}e&&this.deleteSteps(h)}}}catch(d){a.e(d)}finally{a.f()}this.updateRedux()}}]),n}(e)},zs.a,function(e){return function(e){Object(u.a)(n,e);var t=eb(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).currentAlgorithms={},e.algorithmTypes={0:[Yv.a],1:[Yv.c]},e}return Object(s.a)(n,[{key:"onNewStep",value:function(e,t){var n=this;e%32===0&&this.scheduleAutomations(e,t),this.updateAutomationRedux(e);var r={},a=new Set;for(var i in this.currentAlgorithms){var o=this.currentAlgorithms[i];a.has(o)||(o.duration--,o.elapsed++,a.add(o)),o.duration>0&&(r[i]=o)}var s=this.matrix[e/2%16];if(s){var c,u=Zv(s);try{var l=function(){var t=c.value;if(!t)return"continue";var a={types:n.getAlgorithmTypes(t),y:t.y,x:t.x,orientation:t.orientation,elapsed:0,stepNumber:e,module:t.module,duration:2*t.size};a.types.forEach(function(e){return r[e]=a})};for(u.s();!(c=u.n()).done;)l()}catch(f){u.e(f)}finally{u.f()}this.currentAlgorithms=r}else this.currentAlgorithms=r;this.checkOrientations(this.currentAlgorithms)}},{key:"checkOrientations",value:function(e){this._getOutputForModule={}}},{key:"getAlgorithmTypes",value:function(e){return this.algorithmTypes[e.orientation]||[]}},{key:"isEmpty",get:function(){return 0===this.steps.length}},{key:"shouldPlayModule",value:function(e){if(this.isEmpty||this.isFreeform(e))return!0;var t=this.currentAlgorithms[Yv.a]||this.currentAlgorithms[Yv.c];return t&&this.isModuleRouted(e,t.orientation)}},{key:"isRolling",value:function(){var e=this.currentAlgorithms[Yv.d];return this.wasRolling=void 0!==e,{isRolling:void 0!==e,isNewRoll:e&&0===e.elapsed,modules:e&&this.getModulesRoutedIn(e.orientation)}}},{key:"getStepForModule",value:function(e,t){if(this.isEmpty||this.isFreeform(t))return e;var n=this.currentAlgorithms[Yv.c];return n&&this.isModuleRouted(t,n.orientation)?e-n.stepNumber:e}},{key:"getSpeedForModule",value:function(e){if(this.isEmpty||this.isFreeform(e))return 1;var t=this.currentAlgorithms[Yv.b];if(t&&this.isModuleRouted(e,t.orientation)){var n=t.y;return n<4?2:4===n?1:.5}return 1}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Wv(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getSelection",value:function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return this.steps.filter(function(e){var i=e.x,o=e.y;return t<=i&&i<=r&&n<=o&&o<=a})}},{key:"setStepSize",value:function(e,t,n){this.matrix[e][t]&&(this.matrix[e][t].size=n,this.updateRedux())}},{key:"moveStepTo",value:function(e,t,n,r){if(this.matrix[e]){var a=this.matrix[e][t];a&&(n=Object(dn.a)(n,this.matrix.length-a.size+1),r=Object(dn.a)(r,this.matrix[0].length-a.size+1),this.matrix[e][t]=0,this.matrix[n][r]&&this.deleteSteps([this.matrix[n][r]]),this.matrix[n][r]=a,a.x=n,a.y=r,this.updateRedux())}}},{key:"noIntersect",value:function(e,t){return!0}},{key:"newStep",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.matrix=Object(h.a)(this.matrix),this.matrix[e][t]&&this.deleteSteps([this.matrix[e][t]]);var a=new Rv;return this.matrix[e][t]=a,a.x=e,a.y=t,a.size=n,a.orientation=r,this.steps.push(a),a}},{key:"toggle",value:function(e,t){this.matrix=Object(h.a)(this.matrix),this.matrix[e][t]?this.matrix[e][t].orientation=0===this.matrix[e][t].orientation?1:0:this.noIntersect(e,t)&&(this.matrix[e][t]=new Rv,this.matrix[e][t].x=e,this.matrix[e][t].y=t,this.steps.push(this.matrix[e][t])),this.updateRedux(e)}},{key:"deleteSteps",value:function(e){for(var t=0;t<this.matrix.length;t++)for(var n=0;n<this.matrix[t].length;n++)e.includes(this.matrix[t][n])&&(this.matrix[t][n]=0);this.steps=this.steps.filter(function(t){return!e.includes(t)}),this.updateRedux()}},{key:"updateRedux",value:function(e){this.computeShapes(),void 0!==e&&(this.matrix[e]=Object(h.a)(this.matrix[e])),this.sequencerEngine.dispatch(Object(C.zc)(Object(h.a)(this.matrix)))}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Fv(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getParamsJson",value:function(){return{parameters:this._parameters.map(function(e){return{id:e.id,context:e.context&&e.context.getJson(),name:e.name,coordinates:e.getCoordinates()}}),depthParameters:this.depthParameters.map(function(e){return e.getJson()})}}},{key:"fromParamsJson",value:function(e,t){return delete e.depth,this.parametersJson=e.parameters,this.lostParameters=this.loadParameters(e.parameters,!0).lostParameters,this.loadDepthJson(e,t),{}}},{key:"loadParameters",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={},i=this.sequencerEngine,o=[],s=Iv(e);try{var c=function(){var e=t.value,s="object"===typeof e?e.id:e,c=void 0;"BPM"===e.name&&(c=i.bpmParameter);var u=i.higherOrderSequencer;if(!c&&u&&(c=u.macros.map(function(e){return e.macroParameter}).find(function(e){return s===e.id})),!c){var l,f=Iv(i.subSequences);try{for(f.s();!(l=f.n()).done;){var p,d=Iv(l.value.tracks);try{for(d.s();!(p=d.n()).done;){var m=p.value.getAllParameters().find(function(e){return s===e.id});if(m){c=m;break}}}catch(M){d.e(M)}finally{d.f()}}}catch(M){f.e(M)}finally{f.f()}}if(!c){var v,b=Iv(i.subSequences);try{for(b.s();!(v=b.n()).done;){var g,y=Iv(v.value.lfos);try{for(y.s();!(g=y.n()).done;){var k=g.value,O=(k=k.lfo).parameters.find(function(e){return s===e.id});if(O){c=O;break}}}catch(M){y.e(M)}finally{y.f()}}}catch(M){b.e(M)}finally{b.f()}}if(!c){var j,w=Iv(i.subSequences);try{for(w.s();!(j=w.n()).done;){var E=j.value,S=[].concat(Object(h.a)(E.midiEffects.effects),[E.playhead]);if(c=[].concat(Object(h.a)(S.flatMap(function(e){return e.getParameters()})),Object(h.a)(E.pads.filter(function(e){return e.fxMacro}).map(function(e){return e.fxMacro.macroParameter})),Object(h.a)(E.pads.filter(function(e){return e.effectRack}).map(function(e){return e.effectRack.getParameters()}))).find(function(e){return s===e.id}))break}}catch(M){w.e(M)}finally{w.f()}}if(c||(c=i.sends.sends.flatMap(function(e){return e.effects}).flatMap(function(e){return e.getParameters()}).find(function(e){return s===e.id})),!c){var P,x=Iv(i.subSequences);try{for(x.s();!(P=x.n()).done;){var T,C=Iv(P.value.envelopes);try{for(C.s();!(T=C.n()).done;){var N=T.value.parameters.find(function(e){return s===e.id});if(N){c=N;break}}}catch(M){C.e(M)}finally{C.f()}}}catch(M){x.e(M)}finally{x.f()}}if(!c&&!r&&"object"===typeof e&&(c=Object(Dv.a)(e,n.track,i))){a[s]=c;var R=e.coordinates;R.x,R.y}c?n.setParameter(c):o.push(e)};for(s.s();!(t=s.n()).done;)c()}catch(u){s.e(u)}finally{s.f()}return this.sortParameters(),{lostParameters:o,newMappings:a}}},{key:"sortParameters",value:function(){var e=this;if(this.parametersJson){var t=this.parametersJson.map(function(t,n){var r=t.id;return e._parameters.find(function(e){return e&&e.id===r})}).filter(function(e){return e});this._parameters=t}}},{key:"loadDepthJson",value:function(e,t){if(e.depthParameters){var n,r=0,a=Iv(e.depthParameters);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=this.newDepthParameter();o.fromJson(i,this.sequencerEngine,t),this.depthParameters[r++]=o}}catch(s){a.e(s)}finally{a.f()}}}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Gv(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getJson",value:function(){return Object(p.a)({},this.getParamsJson(),{macros:this.macros.map(function(e){return e.getJson()}),algorithmTypes:this.algorithmTypes,scriptEffect:this.scriptEffect.getJson(),inputModules:this.inputModules.map(function(e){return e.id}),freeformModules:this.freeformModules.map(function(e){return e.id}),routings:this.getRoutingJson(),matrix:this.matrix.map(function(e){return e.map(function(e){return e&&e.getJson()})})})}},{key:"fromJson",value:function(e){var t=this;console.log("h=0 fromjson",e);var n=e.macros,r=e.routings,a=e.matrix,i=e.algorithmTypes,o=e.scriptEffect,s=e.inputModules,c=(e.outputModules,e.freeformModules);this.algorithmTypes=i,n&&this.loadMacrosJson(n),e.parameters&&this.fromParamsJson(e),o&&this.scriptEffect.fromJson(o),s&&(this.inputModules=s.map(function(e){return t.getModule(e)})),c&&(this.freeformModules=c.map(function(e){return t.getModule(e)})),r&&this.fromRoutingJson(r);for(var u=0;u<a.length;u++)for(var l=a[u],f=0;f<l.length;f++)l[f]&&(this.matrix[u][f]=new Rv,this.matrix[u][f].fromJson(l[f],this.sequencerEngine),this.steps.push(this.matrix[u][f]));this.updateRedux()}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=ib(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).routings={0:{},1:{}},e.freeformModules=[],e._getOutputForModule={},e._getModulesRouted={},e._getModulesRoutedIn={},e._isModuleRouted={},e._getModule={},e._outputModules=void 0,e}return Object(s.a)(n,[{key:"outputModules",get:function(){if(this._outputModules)return this._outputModules;var e=this.routings[0],t=this.routings[1];return this._outputModules=Array.from(new Set([].concat(Object(h.a)(Object.values(e).flatMap(function(e){return e})),Object(h.a)(Object.values(t).flatMap(function(e){return e}))))),this._outputModules}},{key:"getOutputForModule",value:function(e){var t=e?e.id:"none";if(this._getOutputForModule[t])return this._getOutputForModule[t];if(this.isEmpty||this.isFreeform(e))return this._getOutputForModule[t]=[e],[e];var n=Object.values(this.currentAlgorithms)[0].orientation;return this._getOutputForModule[t]=this.routings[n][e.id]||[],this._getOutputForModule[t]}},{key:"getModulesRoutedIn",value:function(e){var t=this;return this._getModulesRoutedIn[e]?this._getModulesRoutedIn[e]:(this._getModulesRoutedIn[e]=Object.keys(this.routings[e]).map(function(e){return t.getModule(e)}),this._getModulesRoutedIn[e])}},{key:"getModulesRouted",value:function(e){return this._getModulesRouted[e]?this._getModulesRouted[e]:(this._getModulesRouted[e]=Object.values(this.routings[e]).flatMap(function(e){return e}),this._getModulesRouted[e])}},{key:"isModuleRouted",value:function(e,t){var n=e?e.id+"."+t:t;if(this._isModuleRouted[n])return this._isModuleRouted[n];if(!e)return this._isModuleRouted[n]=!0,!0;var r=Object.keys(this.routings[t]).includes(e.id);return this._isModuleRouted[n]=r,r}},{key:"modules",get:function(){return this.sequencerEngine.subSequences}},{key:"getModule",value:function(e){return this._getModule[e]?this._getModule[e]:(this._getModule[e]=this.modules.find(function(t){return t.id===e}),this._getModule[e])}},{key:"connectModules",value:function(e,t,n){var r=this.routings[e];if(t){var a=r[t.id]||[];a.push(n),r[t.id]=a,this.updateRoutableRedux()}}},{key:"disconnectModules",value:function(e,t,n){var r=this.routings[e],a=r[t.id]||[];a=a.filter(function(e){return e!==n}),r[t.id]=a,this.updateRoutableRedux()}},{key:"isFreeform",value:function(e){return this.freeformModules.includes(e)}},{key:"connectToFreeform",value:function(e){this.freeformModules.push(e),this.updateRoutableRedux()}},{key:"disconnectFromFreeform",value:function(e){this.freeformModules=this.freeformModules.filter(function(t){return t!==e}),this.updateRoutableRedux()}},{key:"clearRoutingCache",value:function(){this._getOutputForModule={},this._getModulesRouted={},this._isModuleRouted={},this._outputModules=void 0,this._getModulesRoutedIn={}}},{key:"updateRoutableRedux",value:function(){this.clearRoutingCache(),this.dispatch(Object(C.Dd)(Object(p.a)({},this.routings)))}},{key:"getRoutingJson",value:function(){var e={};for(var t in this.routings){var n={};for(var r in this.routings[t])n[r]=this.routings[t][r].map(function(e){return e.id});e[t]=n}return e}},{key:"fromRoutingJson",value:function(e){var t=this,n=function(n){n=parseInt(n);var a=function(r){var a=t.getModule(r);e[n][r].forEach(function(e){return t.connectModules(n,a,t.getModule(e))})};for(var i in e[n])a(i);r=n};for(var r in e)n(r)}}]),n}(e)},aa,function(e){return function(e){Object(u.a)(n,e);var t=Jv(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).automationPaths=[],e}return Object(s.a)(n,[{key:"computeShapes",value:function(){for(var e=this,t=Object(h.a)(this.steps).sort(function(e,t){return e.x===t.x?t.y-e.y:e.x-t.x}),n=Object(h.a)(t),r=[],a=function(){for(var t=n.shift(),a=[t],i=e.findAdjoiningSteps(t);i;)n=n.filter(function(e){return e!==i}),a.push(i),i=e.findAdjoiningSteps(i);r.push(a)};n.length>0;)a();for(var i=[],o=0,s=r;o<s.length;o++){for(var c=s[o],u=[{x:c[0].x,y:c[0].y}],l=0;l<c.length;l++){var f=c[l],p=f.x+f.size,d=f.y+f.size,m=c[l+1];m?p===m.x&&d===m.y?f.orientation===m.orientation||0===f.orientation&&1===m.orientation?u=[].concat(Object(h.a)(u),[{x:p,y:d}]):1===f.orientation&&0===m.orientation&&(u=[].concat(Object(h.a)(u),[{x:p,y:f.y},{x:p,y:d}])):u=p===m.x&&d===m.y+m.size?[].concat(Object(h.a)(u),[{x:p,y:d},{x:m.x,y:m.y}]):[].concat(Object(h.a)(u),[{x:p,y:d},{x:p,y:10},{x:m.x,y:10},{x:m.x,y:m.y}]):u=[].concat(Object(h.a)(u),[{x:p,y:d}])}i.push(u)}this.automationPaths=i}},{key:"findAdjoiningSteps",value:function(e){var t=e.x,n=e.y,r=e.size,a=t+r,i=n+r;if(this.matrix[a])for(var o=a;o<16;o++){if(this.matrix[o][i])return this.matrix[o][i];for(var s=i;s<10;s++)if(this.matrix[o][s])return this.matrix[o][s];for(var c=i;c>0;c--)if(this.matrix[o][c])return this.matrix[o][c]}}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=Hv(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).currentAutomations=[],e.depthParameters=[],e._automations={},e._parameters=[],e.initialParameterValues=[],e.initialParameterDepths=[],e}return Object(s.a)(n,[{key:"initAutomation",value:function(){this.automationDepthParameter=new $.a("automationDepth",this,function(){return[]},{defaultValue:1,min:0,max:0}),this.registerParameter()}},{key:"newDepthParameter",value:function(e){var t=new $.a("depth",this,function(e,t){return t},{units:"%",min:0,max:100,defaultValue:100});return this.context&&t.setContext(this.context),t.setStore(this.sequencerEngine.store),this.registerParameter(t),t}},{key:"setParameter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._parameters.length;this._parameters[t]=e,this.initialParameterValues[t]=e.get(!0),e.higherOrdered=this,this.depthParameters[t]||(this.depthParameters[t]=this.newDepthParameter(e))}},{key:"unmapParameter",value:function(e){this._parameters[e].higherOrdered=!1;var t=this._parameters[e];this._parameters.splice(e,1),t.context.macro&&(this.macros=this.macros.filter(function(e){return e!==t.context.macro}),t.context.macro.dispose(),t.updateRedux())}},{key:"getDepth",value:function(e){return 1}},{key:"setEffectParameterValues",value:function(e){this.dispatch(Object(C.Vb)(e))}},{key:"scheduleAutomations",value:function(e,t){var n=this,r=this.automationPaths.length;this.currentAutomations=[],0!==r&&this._parameters.filter(function(e,t){return!n.parametersDisabled.includes(t)}).forEach(function(a,i){return n.automateWithPath(e,t,a,n.automationPaths[i%r])})}},{key:"automateWithPath",value:function(e,t,n,r){var a=this;if(this._automations[n.id]){var i=this._automations[n.id];i.clearCache(),i.automations=[]}var o=this._parameters.indexOf(n);if(!this.depthParameters[o]||0!==this.depthParameters[o].get()){var s=this._automations[n.id]||new Bv.a(n,!1,this.sequencerEngine);this._automations[n.id]=s;var c,u=void 0,l=zv(r);try{var f=function(){var e=c.value,t=e.x,r=e.y,i=u===2*t?2*t+.1:2*t;0===i&&(i=.1),s.automations.push(new Lv.a(i,function(){return Uv(r,n,a.depthParameters[o],a.automationDepthParameter.get())})),u=i};for(l.s();!(c=l.n()).done;)f()}catch(h){l.e(h)}finally{l.f()}s.start(t,!0,1e-4),s.schedule(e,t,t,0),this.currentAutomations.push(s)}}},{key:"updateAutomationRedux",value:function(e){if(e%2===0){e%=32;var t,n={},r=zv(this.currentAutomations);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=a.parameter;i.onNewStep(e),n[i.id]=a.getValueAtStep(e)}}catch(o){r.e(o)}finally{r.f()}Object.keys(n).length>0&&this.setEffectParameterValues(n)}}}]),n}(e)},Ls.a,function(e){return function(e){Object(u.a)(n,e);var t=ab(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputModules=[],e}return Object(s.a)(n,[{key:"initScripting",value:function(){this.scriptEffect=new tb.a(this),this.scriptEffect._subSequence=this,this.trackData=new q.a}},{key:"input",value:function(e){this.scriptEffect.onNewStep();var t,n=nb(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=r.stepData.track,i=this.scriptEffect.copyTrigger(r,!0);i.stepData.track=a,this.scriptEffect.input(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"output",value:function(e,t){var n=this.scriptEffect.output(e,t,t);if(0!==n.length){var r=n.filter(function(e){return e.graphics}).map(function(e){return e.graphics});this.processGraphics(t,r)}}},{key:"toggleInput",value:function(e){var t=this.inputModules;t.includes(e)?this.inputModules=t.filter(function(t){return t!==e}):this.inputModules=[].concat(Object(h.a)(t),[e]),this.updateScriptingRedux()}},{key:"toggleOutput",value:function(e){var t=this.outputModules;t.includes(e)?this.outputModules=t.filter(function(t){return t!==e}):this.outputModules=[].concat(Object(h.a)(t),[e]),this.updateScriptingRedux()}},{key:"updateScriptingRedux",value:function(){this.sequencerEngine.dispatch(Object(C.td)(this.inputModules,this.outputModules))}}]),n}(e)},function(e){return function(e){Object(u.a)(n,e);var t=qv(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).macros=[],e}return Object(s.a)(n,[{key:"createMacro",value:function(e){var t,n=[],r=1e7,a=void 0,i=Mv(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,s=(o.get(!0)-o.min)/(o.max-o.min);s<r&&(r=s,a=o),n[o.id]=s}}catch(p){i.e(p)}finally{i.f()}var c,u=Math.max(1e-5,r),l=new Tf.a("macro +"+e.length,this.sequencerEngine,this.context,!1,u),f=Mv(e);try{for(f.s();!(c=f.n()).done;){var h=c.value;h===a?l.addParameter(h):function(){var e=(h.get(!0)+h.min*(u-1))/u,t=h.name.toLowerCase();["level","gain","volume"].some(function(e){return t.includes(e)})&&(e=h.max),l.addParameter(h,h.min,e)}()}}catch(p){f.e(p)}finally{f.f()}return this.macros.push(l),this.setParameter(l.macroParameter),l}},{key:"loadMacrosJson",value:function(e){var t,n=[],r=Mv(this.modules);try{for(r.s();!(t=r.n()).done;){var a=t.value;n=[].concat(Object(h.a)(n),Object(h.a)(a.getAllParameters()));var i,o=Mv(a.lfos);try{for(o.s();!(i=o.n()).done;){var s=i.value;n=[].concat(Object(h.a)(n),Object(h.a)(s.lfo.parameters))}}catch(y){o.e(y)}finally{o.f()}var c,u=Mv(a.envelopes);try{for(u.s();!(c=u.n()).done;){var l=c.value;n=[].concat(Object(h.a)(n),Object(h.a)(l.parameters))}}catch(y){u.e(y)}finally{u.f()}var f,p=Mv(a.tracks);try{for(p.s();!(f=p.n()).done;){var d=f.value;n=[].concat(Object(h.a)(n),Object(h.a)(d.getAllParameters()))}}catch(y){p.e(y)}finally{p.f()}}}catch(y){r.e(y)}finally{r.f()}var m,v=Mv(e);try{for(v.s();!(m=v.n()).done;){var b=m.value,g=new Tf.a(b.name,this.sequencerEngine,this.context,!1);g.fromJson(b,n),this.macros.push(g)}}catch(y){v.e(y)}finally{v.f()}}}]),n}(e)})(function(){return function e(){Object(o.a)(this,e)}}()));function cb(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ub(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ub(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ub(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lb(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function fb(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return hb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hb(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function hb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pb(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var db=new br.a(32,!1),mb=function(e){Object(u.a)(n,e);var t=pb(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];arguments.length>5&&arguments[5];return Object(o.a)(this,n),r=t.call(this,e,i,s,a,u),u||(r.searcher=new xv.a(new Tv.a(e),Object(c.a)(r)),r.searcher.cache.loadIndex()),r.cursor=new Nv(e),r.stereoOnly=a,r}return Object(s.a)(n,[{key:"setScripting",value:function(e){this.scripting=e}},{key:"clearSequence",value:function(){this.tracks.map(function(e){return e.pattern.clear()}),this.updateTracks()}},{key:"getSelectedStep",value:function(){return this.cursor.getStep(this.resolution)}},{key:"getSelectedStepData",value:function(){return this.getSelectedTrack().getStepAtResolution(this.cursor.step,db)}},{key:"getSelectedMidiTrack",value:function(){return this.tracks[this.state.tracks.selectedMidiTrack]}},{key:"getSelectedTrack",value:function(){return void 0===this.cursor.track?0:this.tracks?this.tracks[this.cursor.track]:void 0}},{key:"selectMidiTrack",value:function(e){this.store.dispatch(Object(C.cf)(e))}},{key:"selectEffect",value:function(e){if(!e||e.name){this.selectedEffect=e,this.dispatch(Object(C.Se)(e?e.id:void 0));var t=this.state.selector.quickAddSearchText;t&&""!==t||this.dispatch(Object(C.uf)(e))}}},{key:"selectTrack",value:function(e){this.cursor.track=e;var t=this.state.selector.quickAddSearchText;t&&""!==t||this.dispatch(Object(C.uf)(this.tracks[e])),this.state.mix.selectedTrack!==this.cursor.track&&(this.store.dispatch(Object(C.sf)(e)),this.store.dispatch(Object(C.b)())),this.store.dispatch(Object(C.cf)(e)),this.tracks[e]&&this.tracks[e].updateSteps(),this.tracks[e]&&(this.cursor.step=this.cursor.step%this.tracks[e].pattern.length()),this.store.dispatch(Object(C.rf)(this.cursor.getStep(this.resolution))),this.store.dispatch(Object(C.Ye)(void 0));var n,r=fb(this.currentSubSequence.pads);try{for(r.s();!(n=r.n()).done;){n.value.sendMessage("selected track",e)}}catch(a){r.e(a)}finally{r.f()}}},{key:"select",value:function(e,t,n){void 0!==this.tracks[e]&&(n&&n.subSequence!==this.currentSubSequence&&this.switchToSubSequence(n.subSequence.id),this.tracks[e].stepSelected(t),this.cursor.setStep(t,this.resolution),this.cursor.track=e,this.store.dispatch(Object(C.sf)(e)),this.store.dispatch(Object(C.rf)(t)))}},{key:"selectGroupStep",value:function(e,t){this.cursor.setStep(t,this.resolution),this.cursor.group=e,this.store.dispatch(Object(C.rf)(t))}},{key:"isSelectedTrackPad",value:function(){var e=this.getSelectedTrack();return e&&void 0!==e.pad}},{key:"left",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;if(0!=this.tracks.length){var n=this.cursor.getStep(this.resolution);if(--n<0){t||this.up(e);var r=this.getTrackLength();return this.cursor.setStep(r-1,this.resolution),void(e&&(this.store.dispatch(Object(C.sf)(this.cursor.track)),this.store.dispatch(Object(C.rf)(r-1))))}this.cursor.setStep(n,this.resolution),this.tracks[this.cursor.track].stepSelected(this.cursor.step),e&&this.cursor.updateRedux()}}},{key:"getTrackLength",value:function(){return this.getSelectedTrack().getStepsAtResolution(this.resolution).length}},{key:"right",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;if(0!=this.tracks.length){var n=this.tracks[this.cursor.track].getStepsAtResolution(this.resolution).length,r=this.cursor.getStep(this.resolution);if(++r>=n)return this.cursor.step=0,t||this.down(e),void(e&&this.cursor.updateRedux());this.cursor.setStep(r,this.resolution),this.tracks[this.cursor.track].stepSelected(this.cursor.step),this.store.getState().mix.selectedTrack!==this.cursor.track&&e&&this.store.dispatch(Object(C.sf)(this.cursor.track)),e&&this.store.dispatch(Object(C.rf)(r))}}},{key:"setSelectedTrack",value:function(e){this.store.dispatch(Object(C.sf)(e))}},{key:"up",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(0!=this.tracks.length){if(0==this.cursor.track)return this.cursor.track=this.tracks.length-1,void(this.store.getState().mix.selectedTrack!==this.cursor.track&&this.selectTrack(this.cursor.track));this.cursor.track--,this.store.getState().mix.selectedTrack!==this.cursor.track&&this.selectTrack(this.cursor.track),this.tracks[this.cursor.track].stepSelected(this.cursor.step)}}},{key:"down",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(0!=this.tracks.length){if(this.cursor.track==this.tracks.length-1)return this.cursor.track=0,void this.selectTrack(this.cursor.track);this.cursor.track++,this.store.getState().mix.selectedTrack!==this.cursor.track&&this.selectTrack(this.cursor.track),this.tracks[this.cursor.track].stepSelected(this.cursor.step)}}},{key:"getSample",value:function(e){var t=this;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r){var i,o,s,c,u;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,In.a.getGuildsWithAccess();case 2:return i=n.sent,n.next=5,Object(Pv.a)(e,i);case 5:return o=n.sent,0,s=o[0],c=new R.a(s),n.next=11,c.load();case 11:(u=new ke.a(c,t)).sounds=o,u.initBuffers(),r({sample:c,samplesStream:u});case 15:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())}},{key:"searchForSounds",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u,l,f,h,p,d,m,v,b,g=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=g.length>2&&void 0!==g[2]?g[2]:this.getSelectedTrack(),i=!(g.length>3&&void 0!==g[3])||g[3],o=!(g.length>4&&void 0!==g[4])||g[4],s=g.length>5?g[5]:void 0,c=!(g.length>6&&void 0!==g[6])||g[6],r||!n){e.next=7;break}return e.abrupt("return");case 7:return(new Date).getTime(),e.next=10,In.a.getGuildsWithAccess();case 10:return u=e.sent,e.next=13,Object(Pv.a)(t,u,s);case 13:if(l=e.sent,f=(new Date).getTime(),!(l.length>0)){e.next=48;break}if(h=l[0],!n){e.next=34;break}if(p=i?new R.a(h):r.sample,(d=c?new ke.a(p,this):r.samplesStream).tags=t,d.sounds=l.slice(1),d.filterFavorites=s,i){e.next=28;break}c&&r.newSampleStream(d),r.updateSteps(),e.next=32;break;case 28:return e.next=30,p.load();case 30:d.initBuffers(),r.auditionSound(p,!1,d);case 32:e.next=48;break;case 34:return m=new R.a(h),e.next=37,m.load();case 37:return e.next=39,this.addSound(m,void 0,void 0,void 0,void 0,void 0,o);case 39:return v=(new Date).getTime(),v-f,(b=this.tracks[this.tracks.length-1]).samplesStream.tags=t,b.samplesStream.sounds=l.slice(1),this.scrollToSelectedTrack(),b.updateSteps(),setTimeout(function(){b.samplesStream.initBuffers()},250),e.abrupt("return",b);case 48:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),n}(function(e){return function(e){Object(u.a)(n,e);var t=lb(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).higherOrderSequencer=new sb(Object(c.a)(e)),e}return Object(s.a)(n,[{key:"applyHigherOrderSequencing",value:function(e){var t=this.higherOrderSequencer.wasRolling,n=this.higherOrderSequencer.isRolling(),r=n.isRolling,a=n.isNewRoll,i=n.modules;if(r!==t||a){var o=this.higherOrderSequencer.getStepForModule(e);this.setSequenceRolling(r,void 0,!0,o,a);var s,c=cb(this.subSequences);try{for(c.s();!(s=c.n()).done;){var u=s.value;u.higherRolling=r?i.includes(u):void 0}}catch(l){c.e(l)}finally{c.f()}}}}]),n}(e)}(Sv));t.default=mb},function(e,t,n){},function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(5),a=n.n(r),i=n(9),o=n(14),s=n(500),c=n(550),u=n(94),l=n(52),f=n(30);n(31),n(40);function h(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(new s.a).contractAddress;var d=function(){var e=Object(o.a)(a.a.mark(function e(t,n,r,o,s){var p,d,v,b,g,y,k,O,j,w,E,S,P,x,T,C,N,R,M,A,q=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p=!(q.length>5&&void 0!==q[5])||q[5],d=q.length>6?q[6]:void 0,v=q.length>7?q[7]:void 0,b=q.length>8?q[8]:void 0,t=t.toLowerCase(),g=[],!d){e.next=10;break}e.t0=[d],e.next=17;break;case 10:return e.t1=[0],e.t2=i.a,e.next=14,f.a.guilds.getGuildsForUser();case 14:e.t3=e.sent.map(function(e){return e.guildId}),e.t4=(0,e.t2)(e.t3),e.t0=e.t1.concat.call(e.t1,e.t4);case 17:return y=e.t0,e.next=20,m(n,r,o,t,s,y,v,b);case 20:if(g=e.sent,o||r||s||d){e.next=29;break}return k=[],e.next=25,f.a.getPrivateSequences();case 25:(O=e.sent)&&(0===d||n)||(O=[]),k=Object(i.a)(O),g=[].concat(Object(i.a)(g),""!==t?Object(i.a)(k.filter(function(e){return e.title&&e.title.toLowerCase().includes(t.toLowerCase())})):Object(i.a)(k));case 29:if(j=u.a.getItem("sequences"),w=new Set(g.map(function(e){return e.newSequence})),!(p&&j&&0===d&&""===t&&n)||r||o){e.next=57;break}return j=JSON.parse(j),e.next=35,l.a.getAccount();case 35:E=e.sent,S=h(j),e.prev=37,S.s();case 39:if((P=S.n()).done){e.next=49;break}if(x=P.value,!w.has(x.hash)){e.next=43;break}return e.abrupt("continue",47);case 43:x.user=E,x.isLocal=!0,x.newSequence=x.hash,x.title&&""!==x.title&&g.push(x);case 47:e.next=39;break;case 49:e.next=54;break;case 51:e.prev=51,e.t5=e.catch(37),S.e(e.t5);case 54:return e.prev=54,S.f(),e.finish(54);case 57:return g.sort(function(e,t){return t.blockNumber-e.blockNumber}),T=g.map(function(e){return e.newSequence}),e.next=61,Object(c.b)(T);case 61:C=e.sent,N=h(g);try{for(N.s();!(R=N.n()).done;)M=R.value,A=M.newSequence,C[A]&&(M.metadata=C[A])}catch(a){N.e(a)}finally{N.f()}return e.abrupt("return",g);case 65:case"end":return e.stop()}},e,null,[[37,51,54,57]])}));return function(t,n,r,a,i){return e.apply(this,arguments)}}(),m=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[0],c=arguments.length>6?arguments[6]:void 0,u=arguments.length>7?arguments[7]:void 0;return new Promise(function(){var f=Object(o.a)(a.a.mark(function o(f,h){var p;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!e){a.next=4;break}return a.next=3,l.a.getAccount();case 3:c=a.sent;case 4:if(!n){a.next=9;break}return a.next=7,l.a.getAccount();case 7:n=(n=a.sent).toLowerCase();case 9:p={searchTerm:r,starred:t,favorited:n,searchTag:i,guildIds:s,user:c,old:u},c&&(p.user=c.toLowerCase()),e&&(p.filterMine=!0),fetch("/projects/",{method:"POST",body:JSON.stringify(p),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){f(e)});case 13:case"end":return a.stop()}},o)}));return function(e,t){return f.apply(this,arguments)}}())}},function(e,t){!function(e){var t=e.isNFT?"recorderWorker.js":"../recorderWorker.js",n=function(e,n){var r=n||{},a=r.bufferLen||256,i=r.numChannels||2;this.context=e.context,this.node=(this.context.createScriptProcessor||this.context.createJavaScriptNode).call(this.context,a,i,i);var o=new Worker(r.workerPath||t);o.postMessage({command:"init",config:{sampleRate:this.context.sampleRate,numChannels:i}});var s,c,u=!1,l=!0,f=null,h=0;this.node.onaudioprocess=function(e){if(u){var t=0;if(null!=c){if(l){var n=c-h;if(h=this.context.currentTime,(t=Math.floor(n*this.context.sampleRate)-120)<0||t>a)return}c=null}if(null!==f)this.context.currentTime-f>=0&&(f=null,u=!1);for(var r=[],s=0;s<i;s++){var p=e.inputBuffer.getChannelData(s);t>0&&(p=p.subarray(t)),r.push(p)}o.postMessage({command:"record",buffer:r})}},this.terminate=function(){o.terminate()},this.configure=function(e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])},this.record=function(e){void 0!==e?(c=e,l=!0):(c=this.context.currentTime,l=!1),u=!0,f=void 0},this.stop=function(e){f=void 0!==e?e:(new Date).getTime()},this.clear=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(new Date).getTime();c=e,o.postMessage({command:"clear"})},this.getBuffer=function(e){s=e||r.callback,o.postMessage({command:"getBuffer"})},this.exportWAV=function(e,t){if(s=e||r.callback,t=t||r.type||"audio/wav",!s)throw new Error("Callback not set");o.postMessage({command:"exportWAV",type:t})},o.onmessage=function(e){var t=e.data;s(t)},e.connect(this.node);var p=this.context.createGain();p.gain.value=0,this.node.connect(p),p.connect(this.context.destination)};n.forceDownload=function(t,n){var r=(e.URL||e.webkitURL).createObjectURL(t),a=e.document.createElement("a");a.href=r,a.download=n||"output.wav";var i=document.createEvent("Event");i.initEvent("click",!0,!0),a.dispatchEvent(i)},e.Recorder=n}(window)},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(55),o=n(12);function s(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=new(n(29).a);t.a=Object(o.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track;if(void 0===t.frozenTracks)return[];var n,r=[],o=s(t.frozenTracks);try{for(o.s();!(n=o.n()).done;){var c=n.value.trackData;if(c){var l=c.type,f=c.samplers,h="white";l===i.f?h=Object.keys(f)[0]:l===i.b&&(h=c.presetName||"instrument");var p=u.getColorForHash(h);r.push(a.a.createElement("div",{style:{backgroundColor:p},className:"multi-freeze-part"}))}}}catch(d){o.e(d)}finally{o.f()}return a.a.createElement("div",{className:"multi-freeze-thumbnails"},r)})},function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"c",function(){return d}),n.d(t,"e",function(){return v}),n.d(t,"d",function(){return k}),n.d(t,"g",function(){return O}),n.d(t,"b",function(){return j});var r=n(9),a=n(43),i=n(387),o=n(219),s=n(599),c=n(6);n(401);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){var t=e.rowSelections;return v(t)?{selectedEvents:e.selectedEvents}:{rowSelections:t}}function h(e,t){return t===a.g.id?e.mix:e.getSubSequence(t).mix}function p(e,t){var n=function(e){return e.state.arrangement.cursorStep}(e);if(void 0!==n){if(t.rowSelections)for(var r in t.rowSelections){if(g(e,r))return void y(n,e,t.rowSelections[r],r);var i=h(e,r),c=void 0;m(e,r)===a.l&&1===Object.keys(t.rowSelections).length&&(c=a.l);var u=b(e),l=void 0;u&&u.isTrack&&(l=u.tracks[0]),i.dispatch(Object(o.m)(n,t.rowSelections[r],c,l))}if(t.selectedEvents)for(var f in t.selectedEvents)if(f===a.a){var p=b(e);if(p.isTrack){var d=p.tracks[0];Object(s.a)(void 0,Object(o.l)(d,t.selectedEvents[f],n))}}}}function d(e){var t=f(e.state.arrangement);if(void 0!==t.rowSelections)for(var n in t.rowSelections){var r=h(e,n),i=void 0;m(e,n)===a.l&&1===Object.keys(t.rowSelections).length&&(i=a.l),r.dispatch(Object(o.e)(t.rowSelections[n],i))}if(void 0!==t.selectedEvents)for(var c in t.selectedEvents)if(c===a.a){var u=b(e);if(u.isTrack){var l=u.tracks[0];Object(s.a)(void 0,Object(o.d)(l,t.selectedEvents[c]))}}}function m(e,t){return e.state.arrangement.automationTypeToShow[t]}function v(e){for(var t in e)if(e[t].end>e[t].start)return!1;return!0}function b(e){var t=e.state.arrangement.selectedRows[0];if(void 0!==t)return e.getSubSequence(t)}var g=function(e,t){var n,r=u(e.subSequences);try{for(r.s();!(n=r.n()).done;){var a=n.value.tracks.find(function(e){return e.id===t});if(a)return a}}catch(i){r.e(i)}finally{r.f()}},y=function(e,t,n,a){var o=n.start,s=n.end,u=O(t,t.getSelectedTrack().id);if(u){var l=k(t,{start:o,end:s},a).map(function(e){return e.getCopy(!1)}),f=e-o;l.forEach(function(e){return e.step+=f});var h=new i.a(e,u.mixAutomation.getValueAtStep(o)),p=new i.a(e+(s-o),u.mixAutomation.getValueAtStep(s));l.push(h),l.push(p),u.mixAutomation.automations=[].concat(Object(r.a)(u.mixAutomation.automations.filter(function(t){return t.step<e||t.step>e+(s-o)})),Object(r.a)(l)),u.mixAutomation.automations.sort(function(e,t){return e.step-t.step}),u.mixAutomation.updateRedux(),t.dispatch(Object(c.X)(a,[]))}},k=function(e,t,n){var r=t.start,a=t.end,i=O(e,n);return i?i.mixAutomation.automations.filter(function(e){return e.step>=r&&e.step<=a}):[]},O=function(e,t){return e.state.automation.trackParameter[t]},j=function(e,t){for(var n in t)g(e,n)||h(e,n).dispatch(Object(o.c)(t[n]))}},function(e,t,n){"use strict";var r=n(8),a=n(11),i=n(0),o=n.n(i),s=n(2),c=n(4),u=n(7),l=n(10),f=n(1),h=n(6),p=(n(34),n(12)),d=n(843),m=n(29);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}new m.a;var b=function(e){Object(u.a)(n,e);var t=v(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(c.a)(n,[{key:"mappings",get:function(){return void 0===this.props.keyboardEngine?{}:this.props.keyboardEngine.getMappings()}},{key:"onClickKey",value:function(){var e=void 0===this.props.trackNumber?this.props.selectedTrack:this.props.trackNumber;this.isSample(e)&&(this.props.keyboardEngine.hasKeyMapping(this.key)?this.props.keyboardEngine.deleteKeyMapping(this.key):this.props.keyboardEngine.map(this.key,e,this.props.selectedSlice))}},{key:"render",value:function(){var e=this,t=this.props.mini?"key mini":"key";return this.props.triggering&&(t+=" flashit"),this.props.keyMapping&&this.props.selectedTrack===this.props.keyMapping.trackNumber&&(t+=" selected-track"),this.props.pressed&&(t+=" pressed"),o.a.createElement("div",{onClick:function(){return e.onClickKey()},style:this.getStyle(),className:t},this.props.value)}}]),n}(d.a),g=Object(p.b)(function(e,t){var n=e.keyboard.keyMappings[t.keyboardKey],r=void 0===n?void 0:e.tracks.triggers[n.trackNumber],a=void 0!==r&&r[n.sliceNumber],i=void 0;if(n){var o=t.sequencerEngine.tracks[n.trackNumber];o&&(i=o.getIdentifier())}return{id:i,triggering:a,keyMapping:n,selectedTrack:e.mix.selectedTrack}},function(e,t){return{setContextualHelp:function(t){return e(Object(h.ub)(t))}}})(b),y=new m.a,k=[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L"],["Z","X","C","V","B","N","M"]];t.a=function(e){var t=Object(i.useState)({}),n=Object(a.a)(t,2),s=n[0],c=n[1];Object(i.useEffect)(function(){return window.addEventListener("keydown",l),window.addEventListener("keyup",u),function(){window.removeEventListener("keydown",l),window.removeEventListener("keyup",u)}},[c,s]);var u=Object(i.useCallback)(function(e){if(e.key&&e.key.toUpperCase){var t=Object(r.a)({},s);delete t[e.key.toUpperCase()],c(t)}},[s,c]),l=Object(i.useCallback)(function(e){if(e.key&&e.key.toUpperCase){var t=Object(r.a)({},s);t[e.key.toUpperCase()]=!0,c(t)}},[c,s]),f=function(e){return e.toLowerCase()},h=e.mini?"keyboard mini":"keyboard",p={};return e.track&&(p.borderColor=y.getColorForTrack(e.track)),o.a.createElement("div",{style:p,className:h},o.a.createElement("div",{className:"keyboard-row"},k[0].map(function(t){return o.a.createElement(g,{key:t,pressed:s[t],helper:e.helper,mini:e.mini,selectedSlice:e.selectedSlice,keyboardKey:f(t),selectedTrack:e.selectedTrack,sequencerEngine:e.sequencerEngine,trackNumber:e.trackNumber,keyboardEngine:e.keyboardEngine,value:t})})),o.a.createElement("div",{className:"keyboard-row keyboard-row-2"},k[1].map(function(t){return o.a.createElement(g,{helper:e.helper,key:t,mini:e.mini,selectedSlice:e.selectedSlice,pressed:s[t],selectedTrack:e.selectedTrack,keyboardKey:f(t),sequencerEngine:e.sequencerEngine,trackNumber:e.trackNumber,keyboardEngine:e.keyboardEngine,value:t})})),o.a.createElement("div",{className:"keyboard-row keyboard-row-3"},k[2].map(function(t){return o.a.createElement(g,{key:t,helper:e.helper,mini:e.mini,selectedSlice:e.selectedSlice,pressed:s[t],selectedTrack:e.selectedTrack,keyboardKey:f(t),sequencerEngine:e.sequencerEngine,trackNumber:e.trackNumber,keyboardEngine:e.keyboardEngine,value:t})})))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(16),o=n(7),s=n(10),c=n(1),u=n(56),l=n(15),f=n.n(l),h=n(21);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}u.a.Effect},,function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(9),a=n(11),i=n(0),o=n(47),s=n(272),c=function(e,t,n,c){var u=Object(i.useState)([]),l=Object(a.a)(u,2),f=l[0],h=l[1],p=Object(i.useCallback)(function(){},[e]);return Object(i.useEffect)(function(){t&&Object(s.b)(e).then(h)},[e,t]),{createNewPack:p,addToPack:Object(i.useCallback)(function(e){var t=e.packHash,a=e.title;n&&n.packs.push(a),o.a.getJson(t).then(function(a){var i=a.samples||[],o=a.presets||[];n&&(i=[].concat(Object(r.a)(i),[n.getId()])),c&&(o=[].concat(Object(r.a)(o),[c.contentHash])),Object(s.c)(e.title,a.description,i,o,t)})},[n,c]),packsIncludedIn:f}}},,,,function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(5),a=n.n(r),i=n(9),o=n(14),s=n(0),c=(n(341),n(296)),u=n(6),l=function(e){var t=e.zobject,n=e.setDropdownPos;return{mintToHic:Object(s.useCallback)(function(){var e=Object(o.a)(a.a.mark(function e(r){var o,s,l,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.stopPropagation(),n(void 0),(o=t.sequencerEngine).dispatch(Object(u.Ic)(!0)),e.next=6,o.save("export","PUBLIC",!1,void 0,t);case 6:s=e.sent,l=Object(c.d)(o),f={projectId:s,ipfsHashes:[s].concat(Object(i.a)(l))},fetch("/exportZip/",{method:"POST",body:JSON.stringify(f),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){o.dispatch(Object(u.Ic)(!1)),o.dispatch(Object(u.xc)(e))}).catch(function(e){console.log(e)});case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[t,n])}}},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(5),a=n.n(r),i=n(9),o=n(14),s=n(0),c=n(296),u=(n(341),n(6)),l=function(e){var t=e.zobject,n=e.setDropdownPos;return{mintToZora:Object(s.useCallback)(function(){var e=Object(o.a)(a.a.mark(function e(r){var o,s,l,f,h,p,d;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.stopPropagation(),n(void 0),(o=t.sequencerEngine).dispatch(Object(u.Ic)(!0)),console.log("minting to zora object=",t),e.next=7,Object(c.a)(o);case 7:return e.next=9,o.save("export","PUBLIC",!1,void 0,t,!0);case 9:return s=e.sent,l=s.ipfsHash,f=s.json,e.next=14,Object(c.d)(o);case 14:h=e.sent,p=Object(c.c)(o),d={projectId:l,width:t.width||600,height:t.height||600,ipfsHashes:[l].concat(Object(i.a)(h),Object(i.a)(p))},fetch("/exportZip/",{method:"POST",body:JSON.stringify(d),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){o.dispatch(Object(u.Ic)(!1)),e.projectJson=f,e.contentURI="https://zequencer.io/ipfs/"+l,o.dispatch(Object(u.di)(e))}).catch(function(e){console.log(e)});case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[t,n])}}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=n(385),h=n(512),p=n(629),d=(n(1384),n(849)),m=n(249),v=n(29),b=(n(1108),n(22),n(738),n(606),n(38)),g=(n(1032),n(63),n(39),n(376)),y=n(548),k=(n(458),n(1385),n(129),n(513));function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var j=new v.a,w=function(e){Object(o.a)(n,e);var t=O(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={showMods:!1,showGenetix:!1,selectedOscillator:0},a.onClickMods=a.onClickMods.bind(Object(i.a)(a)),a.onClickGenetix=a.onClickGenetix.bind(Object(i.a)(a)),a}return Object(a.a)(n,[{key:"onChooseOscillator",value:function(e){this.setState({selectedOscillator:e})}},{key:"onClickGenetix",value:function(){this.setState({showGenetix:!this.state.showGenetix})}},{key:"onClickMods",value:function(){this.setState({showMods:!this.state.showMods})}},{key:"render",value:function(){var e=this,t=this.props.instrument,n=j.getColorForTrack(this.props.track);j.getBrightness(n)>180&&(n=j.brighten(n,.6));var r=t.oscillatorNodes[this.state.selectedOscillator];return l.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"instrument multi-synth rack-synth"},l.a.createElement(b.a,{condition:!this.state.showMods&&!this.state.showGenetix},l.a.createElement("div",{className:"inner"},l.a.createElement("div",{className:"instrument-section"},l.a.createElement(m.a,{track:this.props.track,scrollContainer:this.props.scrollContainer,setSelectedOscillator:function(n){return e.setState({selectedOscillator:Math.max(0,t.oscillatorNodes.indexOf(n))})},send:this.props.send,sequencerEngine:this.props.sequencerEngine,effect:this.props.instrument}),l.a.createElement("div",{className:"fm-parameters"},l.a.createElement("div",{className:"osc-name"},r.name),l.a.createElement(p.a,{parameter:r.harmonicityParameter,oscillator:r,name:"Harmonicity",className:"harmonicity"}),l.a.createElement(p.a,{parameter:r.modulationIndexParameter,oscillator:r,name:"Modulation",className:"modulation"}))),l.a.createElement("div",null,l.a.createElement("div",{className:"sections"},l.a.createElement("div",{className:"instrument-section"},l.a.createElement(f.a,{sequencerEngine:this.props.sequencerEngine,instrument:t}),l.a.createElement(h.a,{automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,instrument:t})),l.a.createElement("div",{className:"instrument-section envelopes"},l.a.createElement("div",{className:"instrument-subsection envelopes"},l.a.createElement(g.a,{automation:this.props.automation,envelopeOptions:k.a,sequencerEngine:this.props.sequencerEngine,instrument:t})),l.a.createElement("div",{className:"aux-parameters"},l.a.createElement(d.a,{instrument:t,selectedOscillator:this.state.selectedOscillator,sequencerEngine:this.props.sequencerEngine}),l.a.createElement("div",{onClick:this.onClickMods,className:"mods-button common-button small-button"},this.state.showMods?"BACK":"MODS"))))))),l.a.createElement(b.a,{condition:this.state.showMods},l.a.createElement("div",{className:"clear-fix"}),l.a.createElement(y.a,{instrument:t}),l.a.createElement("div",{onClick:this.onClickMods,className:"mods-button common-button small-button"},this.state.showMods?"BACK":"MODS")))}}]),n}(u.Component);t.a=w},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"b",function(){return p}),n.d(t,"d",function(){return d}),n.d(t,"c",function(){return m}),n.d(t,"e",function(){return k});var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(30),c=(n(1037),n(40)),u=n(31),l=new(n(269).a),f={},h=function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(u.n,"discogsId",t,"sampleHash");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(u.cb,"tag",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(u.gb,"videoId",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.Y+t+n,!f[r]){e.next=3;break}return e.abrupt("return",f[r]);case 3:return e.t0=new c.a(l.contractAddress).from(u.Y).select("ipfsHash").where("user",t).fromBlock(n).toBlock(n),e.next=6,v();case 6:return e.t1=e.sent,a=e.t0.whereIn.call(e.t0,"guildId",e.t1),e.next=10,a.executeQuery(!0);case 10:return o=e.sent,f[r]=Array.from(new Set(o.map(function(e){return e.ipfsHash}))),e.abrupt("return",f[r]);case 13:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(o.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r.a,e.next=3,s.a.guilds.getGuildsWithAccess();case 3:e.t1=e.sent,(t=(0,e.t0)(e.t1)).reverse(),e.t2=i.a.keys(t);case 7:if((e.t3=e.t2()).done){e.next=15;break}if(!((n=e.t3.value)>=1)){e.next=11;break}return e.abrupt("break",15);case 11:return e.next=13,s.a.guilds.getGuildKey(t[n]);case 13:e.next=7;break;case 15:return t=[t[0]],e.abrupt("return",[].concat(Object(r.a)(t),[0]));case 17:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),b=function(e,t,n){return f[e+t+n]},g=function(e,t,n,r){f[e+t+n]=r},y=function(){var e=Object(o.a)(i.a.mark(function e(t,n,r){var a,o,s,u,f=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=f.length>3&&void 0!==f[3]?f[3]:"ipfsHash",!b(t,n,r)){e.next=3;break}return e.abrupt("return",b(t,n,r));case 3:return e.next=5,v();case 5:return o=e.sent,e.next=8,new c.a(l.contractAddress).from(t).select(a).whereIn("guildId",o).where(n,r).executeQuery();case 8:return s=e.sent,u=Array.from(new Set(s.map(function(e){return e[a]}))),g(t,n,r,u),e.abrupt("return",u);case 12:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),k=function(){var e=Object(o.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new c.a(l.contractAddress).from(u.Y).select("title").select("ipfsHash").whereIn("ipfsHash",t).executeQuery();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(71),o=n(6),s=n(1406),c=n(12);n(1519);t.a=Object(c.b)(function(e,t){var n=t.currentSubSequence.id,r=t.track,a=t.group,i=!1;return i="AUDIO_FX"===t.effectType?void 0!==r?t.effect===(e.mix.selectedTrackEffects[n]&&e.mix.selectedTrackEffects[n][r.id]):t.effect===(e.mix.selectedGroupEffects[n]&&e.mix.selectedGroupEffects[n][a.id]):t.effect===(e.mix.selectedTrackMidiEffects[n]&&e.mix.selectedTrackMidiEffects[n][r.id]),{effectDragging:e.sequencer.effectDragging,isSelected:i,pulledEffects:e.effects.pulledEffects}},function(e,t){return{dragEffect:function(t){return e(Object(o.h)(t))},clearOtherType:function(){return e(Object(o.df)(t.currentSubSequence.id,t.track.id,t.group,t.effectType===i.a?i.c:i.a,void 0))},setSelectedEffect:function(n){return e(Object(o.df)(t.currentSubSequence.id,t.track.id,t.group,t.effectType,n))}}})(function(e){var t=Object(r.useCallback)(function(t){e.dragEffect({effectNumber:e.effectNumber})},[e.effectNumber]),n=Object(r.useCallback)(function(t){if(t.stopPropagation(),void 0!==e.effectDragging){var n=e.effectDragging.effectNumber;e.moveEffectTo(n,e.effectNumber),e.dragEffect(void 0)}},[e.effectNumber,e.effectDragging]),i=Object(r.useCallback)(function(t){e.clearOtherType(),e.setSelectedEffect(e.isSelected?void 0:e.effect)},[e.isSelected,e.effect]),o="send-effect";e.isSelected&&(o+=" selected");var c=e.effect.getParameters();return c.length>10&&(c=c.slice(0,10)),e.pulledEffects&&e.pulledEffects.includes(e.effect)&&(o+=" pulled"),a.a.createElement("div",{onClick:i,onDragOver:function(e){e.preventDefault()},onDrop:n,onDragStart:t,draggable:!0,className:o},a.a.createElement("div",{className:"effect-name"},e.effect.name),c.map(function(e){return a.a.createElement(s.a,{parameter:e})}))})},,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",function(){return v}),n.d(t,"a",function(){return b});var r=n(5),a=n.n(r),i=n(14),o=n(70),s=n(47),c=n(40),u=n(716),l=n(31),f=n(65),h=n(44);function p(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=(new u.a).contractAddress,v=function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:return n=e.sent,console.log("thumb = ",n),e.next=6,new o.a(h.v,"newWallpaper",[Object(f.c)(t),Object(f.c)(n)]).execute();case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,u,f,h;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new c.a(m).from(l.K).select("wallpaperHash").select("thumbnailHash"),t&&n.where("wallpaperHash",t),e.next=4,n.executeQuery();case 4:r=e.sent,i={},o=p(r);try{for(o.s();!(s=o.n()).done;)u=s.value,i[u.thumbnailHash]=u.wallpaperHash}catch(a){o.e(a)}finally{o.f()}for(h in f=[],i)f.push({wallpaper:i[h],thumbnail:h});return e.abrupt("return",f);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),g=function(e){return new Promise(function(t){var n=new Image,r=document.createElement("canvas"),a=r.getContext("2d");n.onload=function(){r.width=300,r.height=300,a.drawImage(n,0,0,300,300);var e=function(e){for(var t=atob(e.split(",")[1]),n=(e.split(",")[0].split(":")[1].split(";")[0],new ArrayBuffer(t.length)),r=new Uint8Array(n),a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return n}(r.toDataURL());s.a.addArrayBuffer(e).then(t)},n.src=s.a.getHashUrl(e)})}},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(833),s=n(253),c=n(59),u=n(1030),l=n(29);window.samplerColor="#545e6e";var f=new l.a,h=Object(a.memo)(function(e){var t=e.sequencerEngine,n=e.selectedSampler,o=e.track,s=e.instrument,l=e.deleteSample,h=(e.sample,Object(a.useState)("")),d=Object(r.a)(h,2),m=d[0],v=d[1],b=Object(a.useCallback)(function(){o.auditionNext()},[o]),g=Object(a.useCallback)(function(){o.auditionPrevious()},[o]);Object(a.useEffect)(function(){if(n&&n.baseBuffer&&o.sample){var e=f.getColorForHash(n.sample.getId()),r=i.a.createElement(u.a,{instrument:s,sequencerEngine:t,store:t.store,color:e,div:document.getElementsByClassName("sampled-instrument")[0],track:o,height:75,backgroundColor:window.samplerColor,fullWidth:!1,hideButtons:!0,selectedSlice:0,slices:n.slices,isReversed:n.isReversed(),sampler:n,decentralized:!0,soundId:n.sample.getId(),onKeyDown:function(){return[]},onSelectSlice:function(){return[]},buffer:n.baseBuffer.get()});v(r)}else v("")},[n,v,o,s,o.sample]);var y=o.sample&&o.sample.tags||[];return i.a.createElement("div",{className:"waveform-and-toolbar"},i.a.createElement("div",{className:"waveform-toolbar"},i.a.createElement("div",{className:"sample-name"},n&&n.sample&&n.sample.name?p(n.sample.name):""),i.a.createElement("div",{className:"sample-chooser-buttons"},i.a.createElement("div",{onClick:g,className:"previous-button"}),i.a.createElement("div",{onClick:b,className:"next-button"})),y.map(function(e){return i.a.createElement(c.a,{color:"light"},p(e))}),i.a.createElement("div",{onClick:function(){return l(n)},className:"delete-button"},"x")),m)});function p(e){return e.length>=16?e.substring(0,16):e}var d=n(114),m=n(9),v=n(5),b=n.n(v),g=n(14),y=n(164),k=n.n(y),O=function(){var e=Object(g.a)(b.a.mark(function e(t,n){var r,a,i;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.slice(0,t.length-1),a=t[t.length-1],n.selectedTags=r,e.next=5,n.getTopTags();case 5:return i=e.sent,n.selectedTags=[],i=i.map(function(e){return e.value}).filter(function(e){return e.toLowerCase().includes(a.toLowerCase())}),e.abrupt("return",j(i,r));case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),j=function(e,t){if(1===e.length)return{tags:[].concat(Object(m.a)(t),[e[0]]),suggestions:[]};var n=e;if(""===t)return{suggestions:n};var r=w(e);return r?{suggestions:n,tags:[].concat(Object(m.a)(t),[r])}:{suggestions:n,tags:[]}},w=function(e){var t=void 0;for(var n in e)if(void 0===t)t=e[n];else if(void 0===(t=E(e[n],t)))return;return t},E=function(e,t){for(var n="",r=0;r<Math.min(e.length,t.length)&&e[r]===t[r];r++)n+=e[r];return""===n?void 0:n},S=function(e){var t=e.instrument,n=e.hide,o=e.setSelectedSampler,s=t.sequencerEngine,c=Object(a.useRef)(null),u=Object(a.useState)(""),l=Object(r.a)(u,2),f=l[0],h=l[1],p=Object(a.useState)(!1),d=Object(r.a)(p,2),v=d[0],y=d[1],j=Object(a.useState)(""),w=Object(r.a)(j,2),E=w[0],S=w[1],P=Object(a.useState)([]),x=Object(r.a)(P,2),T=x[0],C=x[1],N=Object(a.useCallback)(Object(g.a)(b.a.mark(function e(){var r,a,i,c,u,l;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.split("+").filter(function(e){return""!==e}),S(!0),e.next=4,s.getSample(r);case 4:if(a=e.sent,i=a.sample,c=a.samplesStream,!i){e.next=17;break}return e.next=10,t.newSample(0,i,c);case 10:u=e.sent,l=u.sampler,u.samplers,o(l),n(),e.next=19;break;case 17:S(!1),y(!0);case 19:case"end":return e.stop()}},e)})),[n,o,f,S,y]);Object(a.useEffect)(function(){c.current.focus()},[]);var R=Object(a.useCallback)(function(e){var t=f.split("+");t=[].concat(Object(m.a)(t.slice(0,t.length-1)),[e]),h(t.join("+")+"+"),M([].concat(Object(m.a)(t),[""])),c.current.focus()},[h,f,M,C,c]),M=Object(a.useCallback)(function(){var e=Object(g.a)(b.a.mark(function e(n){var r,a,i,o;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(n,t.sequencerEngine.searcher);case 2:r=e.sent,a=r.suggestions,i=r.tags,o=[].concat(Object(m.a)(i),Object(m.a)(a)),C(o);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[C]),A=Object(a.useCallback)(function(){var e=Object(g.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h(t.target.value),n=t.target.value.split("+"),v&&y(!1),M(n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[h,C,M,v,y]);return E?i.a.createElement("div",{className:"sample-search-container"},i.a.createElement(k.a,{sizeUnit:"px",size:10,color:"#42f4f1",loading:!0})):i.a.createElement("div",{className:"sample-search-container"},i.a.createElement("div",{className:"search-box-container"},i.a.createElement("input",{value:f,ref:c,placeholder:"Type sample tags to search",onChange:A,type:"text",className:"sample-search"}),i.a.createElement("div",{onClick:N,className:"search-button"},"Search")),v?i.a.createElement("div",{className:"no-results"},"No Results"):"",i.a.createElement("div",{className:"suggestions"},T.map(function(e){return i.a.createElement("div",{onClick:function(){return R(e)},className:"suggestion"},e)})))},P=n(39),x=n.n(P),T=n(224);function C(e){var t=Object(a.useState)(void 0),n=Object(r.a)(t,2),o=n[0],s=n[1],c=Object(a.useCallback)(function(t){e.instrument.mixMode=t.value,s(t.value)},[e.instrument]);return Object(a.useEffect)(function(){s(e.instrument.mixMode)},[]),i.a.createElement("div",{className:"interpolation-dropdown-container"},i.a.createElement(x.a,{className:"interpolation-dropdown",controlClassName:"interpolation-control-dropdown",arrowClassName:"interpolation-arrow-dropdown",options:R,onChange:c,value:N(o),placeholder:"Mode"}))}function N(e){return R.find(function(t){return t.value===e})}var R=[{value:T.b,label:"Mix"},{value:T.a,label:"Alternate"},{value:T.c,label:"Round Robin"}],M=new l.a,A=["a","b","c","d","e","f","g","h","i","j","k","l"],q=function(e){var t=e.instrument,n=e.sampler,o=e.setSelectedSampler,s=e.toggleShowPiano,c=e.showPianoRoll,u=Object(a.useState)(!1),l=Object(r.a)(u,2),f=l[0],h=l[1],p=Object.keys(t.samplers).find(function(e){return t.samplers[e].indexOf(n)>-1}),m=t.samplers[p]||[],v="";return f&&(v=i.a.createElement(S,{setSelectedSampler:o,hide:function(){return h(!1)},instrument:t})),i.a.createElement("div",{className:"advanced-controls"},i.a.createElement("div",{className:"samples-container"},m.map(function(e,t){return i.a.createElement("div",{className:n===e?"selected sampled-sound":"sampled-sound",onClick:function(){return o(e)},style:{backgroundColor:M.getColorForHash(e.sample.getId())}},A[t])}),i.a.createElement("div",{onClick:function(){return h(!0)},className:"add-sample-button"},"+"),i.a.createElement("img",{onClick:s,className:c?"piano-icon on":"piano-icon",src:"/piano-icon.png"})),v,i.a.createElement("div",{className:"drop-here"},"Drop samples here"),i.a.createElement("div",{className:"sampler-dropdowns"},i.a.createElement("div",null,i.a.createElement(d.a,{name:"Mono",parameter:t.monophonicParameter}),i.a.createElement(d.a,{name:"Loop",parameter:t.loopParameter})),i.a.createElement(C,{instrument:t})))},D=n(887),I=n(38),_=n(12),F=n(167),L=Object(_.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.instrument,n=e.sampler,r=e.color;return i.a.createElement("div",{className:"sampler-params"},i.a.createElement("div",{className:"pitch-params"},i.a.createElement(F.a,{units:"%",name:"Start",parameter:t.loopStartParameter,color:r}),i.a.createElement(F.a,{units:"%",name:"Len.",parameter:t.loopLengthParameter,color:r}),i.a.createElement(F.a,{units:"cts",name:"Detune",parameter:t.detuneParameter,color:r,min:-1e3,max:1e3,root:1}),n?i.a.createElement(F.a,{name:"Trspe",min:-24,max:24,color:r,parameter:n.transposeParameter,root:1}):"",i.a.createElement(F.a,{units:"ms",name:"Glide",color:r,parameter:t.glideParameter}),i.a.createElement(F.a,{name:"R.Mix",color:r,parameter:t.crossFadeParameter})),i.a.createElement(D.a,{color:r,sequencerEngine:t.sequencerEngine,width:290,parameters:[t.loopStartParameter,t.loopLengthParameter,t.detuneParameter,n&&n.transposeParameter,t.glideParameter,t.crossFadeParameter]}))}),B=(n(90),n(63)),z=(n(1029),n(61)),V=n(6),H=new l.a;var U=Object(_.b)(function(e,t){return{isOn:t.sampler.on||t.instrument.mixMode===T.b||t.isSelectedSampler}},function(e,t){return{setSampleDragging:function(t){return e(Object(V.He)(t))}}})(function(e){var t=e.sample;if(void 0===t)return i.a.createElement("div",null);var n={backgroundColor:H.getColorForHash(t.getId())},r=t.getThumbnail(),o=function(e){e.stopPropagation()},s=Object(a.useCallback)(function(n){e.setSampleDragging(t)},[t]),c="key-info";return e.isOn&&(c+=" on"),r?i.a.createElement("img",{draggable:!0,onDragStart:s,onDragOver:o,onClick:e.onClickSampler,className:c,src:r}):i.a.createElement("div",{draggable:!0,onDragStart:s,onDragOver:o,onClick:e.onClickSampler,style:n,className:c},e.i+1)});new l.a;var J=Object(_.b)(function(e,t){return{isPlaying:e.keyboard.lastNotePlayed===t.transpose,mixMode:t.instrument.mixMode}},function(e,t){return{setSampleDragging:function(t){return e(Object(V.He)(t))}}})(function(e){var t=Object(a.useState)([]),n=Object(r.a)(t,2),o=n[0],s=n[1],c="key";e.note.isBlackNote()?c+=" black":c+=" white";var u=e.note.getTranspose(),l=(o.map(function(e){return e.sample}),Object(a.useCallback)(function(t){t.stopPropagation(),e.sampleDragging&&(e.instrument.newSample(u,e.sampleDragging).then(function(e){s(e.samplers)}),e.setSampleDragging(void 0))},[e.sampleDragging,s])),f=Object(a.useCallback)(function(t){if(void 0===t){var n=o.find(function(e){return e.on});e.onClickSampler(n)}else t!==e.selectedSampler&&(e.onClickSampler(t),e.instrument.selectSampler(u,t))},[u,o,e.onClickSampler,e.selectedSampler,e.mixMode]);Object(a.useEffect)(function(){if(u in e.instrument.samplers){var t=e.instrument.samplers[u];s(t)}},[e.instrument.samplers[u]],e.selectedSampler);var h=Object(a.useCallback)(function(){console.log("transpose =",u);var t=e.instrument.track,n=new z.a;n.copyFrom(t.trackData),n.transpose=u,n.slice=0,n.duration=null,t.midiEffects.liveInputTrigger(n)},[u]),p=Object(a.useCallback)(function(){e.instrument.track.midiEffects.liveInputRelease(u,0)},[u]),d="key-container";return o.indexOf(e.selectedSampler)>-1&&void 0!==e.selectedSampler&&(d+=" selected"),e.isPlaying&&(d+=" last-played"),i.a.createElement("div",{className:d},i.a.createElement("div",{onMouseDown:h,onMouseUp:p,onClick:function(){return f()},onDrop:l,className:c}),o.map(function(t,n){return i.a.createElement(U,{i:n,key:"sample-thumb-"+n,isSelectedSampler:t===e.selectedSampler,sampler:t,instrument:e.instrument,onClickSampler:function(){return f(t)},sample:t.sample})}))});new l.a;function G(e){var t=B.a.NOTES.map(function(t){return(t=t.getCopy()).octave=e.octave,t});return i.a.createElement("div",{className:"octave"},i.a.createElement("div",{className:"octave-label"},t[0].toString()),t.map(function(t){return i.a.createElement(J,{key:t.toString(),selectedSampler:e.selectedSampler,onClickSampler:e.onClickSampler,sampleDragging:e.sampleDragging,octave:e.octave,transpose:t.getTranspose(),note:t,instrument:e.instrument})}))}var W=Object(a.memo)(function(e){var t=e.selectedSampler,n=e.onClickSampler,r=e.sampleDragging,a=e.instrument;return i.a.createElement("div",{className:"horizontal-piano-container"},i.a.createElement("div",{className:"horizontal-piano"},i.a.createElement(G,{selectedSampler:t,onClickSampler:n,octave:1,instrument:a,sampleDragging:r}),i.a.createElement(G,{selectedSampler:t,onClickSampler:n,octave:2,instrument:a,sampleDragging:r}),i.a.createElement(G,{selectedSampler:t,onClickSampler:n,octave:3,instrument:a,sampleDragging:r}),i.a.createElement(G,{selectedSampler:t,onClickSampler:n,octave:4,instrument:a,sampleDragging:r}),i.a.createElement(G,{selectedSampler:t,onClickSampler:n,octave:5,instrument:a,sampleDragging:r}),i.a.createElement(G,{selectedSampler:t,onClickSampler:n,octave:6,instrument:a,sampleDragging:r}),i.a.createElement(G,{selectedSampler:t,onClickSampler:n,octave:7,instrument:a,sampleDragging:r})))}),K=(n(252),n(735)),X=n(834),Q=Object(a.memo)(function(e){var t=e.isExponential,n=e.name,o=e.min,s=e.max,c=e.round,u=e.parameter,l=e.value,f=e.sequencerEngine,h=Object(a.useState)(!1),p=Object(r.a)(h,2),d=p[0],m=p[1],v=Object(a.useCallback)(function(){f&&m(!0)},[m]),b="";d&&(b=i.a.createElement(X.a,{sequencerEngine:f,parameter:u})),o=t?Math.cbrt(o):o,s=t?Math.cbrt(s):s;var g,y=t?Math.cbrt(l):l;return i.a.createElement("div",{className:"parameter-knob-container"},i.a.createElement(K.Knob,{size:40,angleOffset:220,angleRange:280,value:y,min:o,max:s,onChange:function(e){return n=e,document.activeElement.blur(),t&&(n=Math.pow(n,3)),c&&(n=Math.round(n)),void u.set(n);var n}},i.a.createElement(K.Arc,{arcWidth:3,color:"white",background:"#6c757a"}),i.a.createElement(K.Pointer,{width:3,height:11,radius:8,type:"rect",color:"white"})),i.a.createElement("div",{onClick:v,className:"knob-label"},n," : ",(g=l,Math.floor(10*g)/10)),b)}),Y=(Object(_.b)(function(e,t){return void 0===t.parameter?{value:0}:{value:e.effects.effectParameters[t.parameter.id]}},null)(Q),n(301));Y.a,Y.b,n(392);n(210);var Z=new l.a;t.a=Object(_.b)(function(e,t){var n=t.track.selectedSampler;return{sampleDragging:e.selector.sampleDragging,sampleSlices:n?e.tracks.sampleSlices[n.id]:void 0,presetDragging:e.presets.presetDragging,sampleTagDragging:e.selector.sampleTagDragging,sample:t.track.sample,presetName:t.track.presetName}},function(e,t){return{setSampleDragging:function(t){return e(Object(V.He)(t))},setPresetDragging:function(t){return e(Object(V.re)(t))},setSampleTagDragging:function(t){return e(Object(V.Le)(t))}}})(function(e){var t=Object(a.useState)(void 0),n=Object(r.a)(t,2),c=(n[0],n[1]),u=e.track.instrument;Object(a.useCallback)(function(e){u.connectToTrack(e),c(e)}),Object(a.useEffect)(function(){c(u.connectedTrack)},[u.connectedTrack]),Object(a.useEffect)(function(){return function(){return e.track.selectedSampler=e.instrument.defaultSampler}},[e.track,e.instrument]);var l=Object(a.useState)(e.track.selectedSampler),f=Object(r.a)(l,2),p=f[0],d=f[1],m=Object(a.useState)(Object.keys(u.samplers).length>1),v=Object(r.a)(m,2),b=v[0],g=v[1];Object(a.useEffect)(function(){u.defaultSampler&&(d(u.defaultSampler),e.track.sample=u.defaultSampler.sample)},[u.defaultSampler]);var y=Object(a.useCallback)(function(){var t=u.allSamplers[0];t?(d(t),e.track.sample=t.sample):(d(void 0),j("")),e.track.selectedSampler=t},[d,e.instrument,e.setWaveform]),k=Object(a.useState)(""),O=Object(r.a)(k,2),j=(O[0],O[1]),w=Object(a.useCallback)(function(t){e.instrument.deleteSampler(p),j(""),y()},[p,d,e.instrument,j]),E=Object(a.useCallback)(function(t){void 0!==t&&(e.track.sample=t.sample,e.track.selectedSampler=t,p===t||d(t))},[p,d,e.track]),S=(Object(a.useCallback)(function(){u.playSampler(p)},[p]),Object(a.useCallback)(function(t){console.log("ON DROP sampler"),t.stopPropagation();var n=function(t,n){e.instrument.newSample(void 0,t,n).then(function(t){var n=t.sampler;e.track.sample=n.sample,e.track.selectedSampler=n,d(n)})};e.sampleDragging?(n(e.sampleDragging),e.setSampleDragging(void 0)):e.presetDragging?(e.track.auditionPreset(e.presetDragging),e.setPresetDragging(void 0)):e.sampleTagDragging&&Object(o.a)(e.sampleTagDragging,e.track,e.setSampleTagDragging,n)},[e.track,d,e.sampleDragging,e.sampleTagDragging,e.presetDragging,e.setPresetDragging])),P=Z.getColorForTrack(e.track);return i.a.createElement("div",{onDrop:S,onDragOver:function(e){return e.preventDefault()},className:"instrument sampled-instrument"},i.a.createElement("div",null,i.a.createElement(h,{sequencerEngine:e.sequencerEngine,track:e.track,sample:e.track.sample,instrument:u,selectedSampler:p,deleteSample:w,presetName:e.presetName}),i.a.createElement("div",{className:"parameters-container"},i.a.createElement("div",{className:"pane"},i.a.createElement(s.a,{name:"Amp",backgroundColor:"#545d6e",fullText:!0,width:270,sequencerEngine:e.sequencerEngine,fillColor:Z.brighten(P,.7),lineColor:P,hasRelease:!0,hasLevel:!1,envelope:u}),i.a.createElement(L,{color:Z.brighten(P,.7),sampler:p,instrument:u})),i.a.createElement(q,{showPianoRoll:b,toggleShowPiano:function(){return g(!b)},setSelectedSampler:E,sampler:p,instrument:u}))),i.a.createElement(I.a,{condition:b},i.a.createElement(W,{onClickSampler:E,selectedSampler:p,track:e.track,sampleDragging:e.sampleDragging,instrument:u})))})},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(9),s=n(28),c=n(2),u=n(4),l=n(20),f=n(7),h=n(10),p=n(1),d=n(0),m=n.n(d),v=n(90),b=n.n(v),g=n(42),y=n(12),k=Object(d.memo)(function(e){var t=e.showColors,n=e.color,r=e.pts;return m.a.createElement(g.FastLayer,null,r.map(function(e,r){return m.a.createElement(g.Rect,{key:r,x:e.x,y:e.y,width:e.width,height:e.height,fill:t?"rgb("+e.rgb[0]+","+e.rgb[1]+","+e.rgb[2]+")":n})}))}),O=Object(y.b)(function(e,t){return{}},function(e){return{}})(k),j=n(191),w=(n(59),n(29)),E=n(181),S=n(15),P=n.n(S);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(p.a)(e);if(t){var a=Object(p.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(h.a)(this,n)}}window.markerY=0;var T=new w.a,C=function(e){Object(f.a)(n,e);var t=x(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={buffer:e.buffer,ticks:[],offset:0,endOffset:0},r.width=r.props.width,r.height=e.height||E.b,r.state.startX=r.convertSecondsToSpace(e.start,e.scale),r.state.endX=r.convertSecondsToSpace(e.end,e.scale),r.calculateTicks(void 0,void 0,void 0,!0),r}return Object(u.a)(n,[{key:"calculateTicks",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.start,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.end,arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.props.scale,arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"shouldComponentUpdate",value:function(e,t){if(this.width=e.width,this.height=e.height,this.state.buffer!=e.buffer||this.props.scale!==e.scale||this.props.zoomedStartTime!==e.zoomedStartTime||this.props.width||e.width||this.props.start!==e.start||this.props.end!==e.end){this.state.buffer=e.buffer;var n=e.start,r=e.end;this.state.startX=this.convertSecondsToSpace(n,e.scale),this.state.endX=this.convertSecondsToSpace(r,e.scale),this.calculateTicks(n,r,e.scale)}if(this.props.transpose!==e.transpose||this.props.bpm!==e.bpm){var a=e.start,i=e.end;this.calculateTicks(a,i,e.scale)}return!0}},{key:"convertSpaceToSeconds",value:function(e){return this.state.buffer.duration*e/this.width}},{key:"convertSecondsToSpace",value:function(e){return e/this.state.buffer.duration*this.width}},{key:"render",value:function(){var e=this,t=this.props.small?14:20,n=this.props.small?14:20,r=[0,0,n,t,0,t],a=[0,this.height,-n,this.height,0,this.height-t];this.props.isSelectedSlice&&(a[1]-=2,a[3]-=2,a[5]-=2);var i=this.props.color||T.getColor(this.props.sliceNumber),o=this.state.startX,s=this.state.endX;this.props.sliceNumber,this.props.track.getKeyMapping(this.props.sliceNumber);return m.a.createElement(g.Group,null,this.props.isSelectedSlice?m.a.createElement(g.Rect,{x:o,y:0,width:s-o,opacity:.1,height:this.height,fill:i}):m.a.createElement(g.Rect,null),m.a.createElement(g.Line,{points:[this.state.startX,0,this.state.startX,this.height],strokeWidth:this.props.small?1:2,stroke:this.props.color,opacity:.8,alpha:.8,fill:this.props.color}),m.a.createElement(g.Line,{onMouseDown:function(t){return e.props.onStartSliceStartedDragging(t.evt.pageX-e.state.startX,t.evt.metaKey||t.evt.ctrlKey)},onMouseUp:this.props.onStartSliceStroppedDragging,onKeyDown:function(t){return e.props.onKeyDown(t)},x:this.state.startX,y:0,style:{cursor:"pointer"},opacity:.9,points:r,closed:!0,strokeWidth:1,stroke:this.props.color,fill:this.props.color}),m.a.createElement(g.Line,{points:[this.state.endX,0,this.state.endX,this.height],strokeWidth:this.props.small?1:2,stroke:this.props.color,fill:this.props.color}),m.a.createElement(g.Line,{onMouseDown:function(t){return e.props.onEndSliceStartedDragging(t.evt.pageX-e.state.endX,t.evt.metaKey||t.evt.ctrlKey)},onMouseUp:this.props.onEndSliceStoppedDragging,x:this.state.endX,y:0,style:{cursor:"pointer"},opacity:.9,points:a,closed:!0,strokeWidth:1,stroke:this.props.color,fill:this.props.color}),this.props.isSelectedSlice?m.a.createElement(g.Rect,{x:o,y:this.height-3,width:s-o,height:3,fill:i}):m.a.createElement(g.Rect,null),this.props.isSelectedSlice?this.state.ticks.map(function(t){return m.a.createElement(g.Line,{x:t,y:0,style:{cursor:"pointer"},points:[t.x,e.height,t.x,e.height-t.height],closed:!0,opacity:20===t.height?"0.55":"0.4",strokeWidth:1,stroke:e.props.color,fill:e.props.color})}):m.a.createElement(g.Rect,null))}}]),n}(d.Component),N=Object(y.b)(function(e,t){var n=e.effects.effectParameters[t.transposeParameter.id],r=e.tracks.sampleSlices[t.sampler.id][t.sliceNumber];return void 0===r?{}:{bpm:e.user.bpm,transpose:n,start:r.startTime-t.zoomedStartTime,end:r.endTime-t.zoomedStartTime}},null)(C),R=n(30),M=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){e.selectedSlice,e.sampler;return m.a.createElement("div",null)}),A=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.buffer,n=e.zoomedStartTime,r=e.convertSecondsToSpace,a=e.height,i=(e.fullDuration,t.duration),o=[],s=15;i<10?s=2:i<30?s=5:i>120&&(s=30);for(var c=0;c<n+i;c+=s)if(!(c-n<0)){var u=r(c-n),l=c,f=Math.floor(l/60),h=l%60;h<10&&(h="0"+h),o.push(m.a.createElement(g.Group,null,m.a.createElement(g.Line,{points:[u,0,u,a],strokeWidth:1,stroke:"#2a635b"}),m.a.createElement(g.Text,{x:u+5,y:a-15,fill:"white",fontSize:10,text:f+":"+h})))}return o}),q=n(11),D=n(62),I=n(593),_=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.sampler,r=Object(d.useState)(!1),a=Object(q.a)(r,2),i=a[0],o=a[1],s=Object(d.useState)(n.tempo||"0"),c=Object(q.a)(s,2),u=c[0],l=c[1];Object(d.useEffect)(function(){l(n.tempo||"0")},[l,n]);var f=Object(d.useCallback)(function(e){"Enter"===e.key&&(o(!1),n.tempo=parseFloat(u))},[u,o,n]);return Object(d.useEffect)(function(){""===u||Object(D.a)(u)||l("")},[u,l]),m.a.createElement("div",{className:"sample-tempo"},m.a.createElement(I.a,{track:t}),m.a.createElement("span",{onClick:function(){return o(!0)},className:"label"},"BPM"),i?m.a.createElement("input",{onKeyDown:f,className:"tempo-input",onChange:function(e){return l(e.target.value)},value:u}):m.a.createElement("span",{onClick:function(){return o(!0)},className:"tempo"},null===u?"":u))}),F=n(298),L=n(38);function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(p.a)(e);if(t){var a=Object(p.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(h.a)(this,n)}}var z=function(e){Object(f.a)(n,e);var t=B(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"convertSecondsToSpace",value:function(e){return e/this.props.buffer.duration*this.props.width}},{key:"render",value:function(){var e=this;return this.props.showingOnsets?this.props.sampler.onsets.map(function(t,n){return m.a.createElement(g.Rect,{key:"onset-"+n,x:e.convertSecondsToSpace(t/1e3-e.props.zoomedStartTime),y:0,width:e.isSelectedOnset(n)?e.getOnsetWidth(n):1,height:e.props.height,opacity:e.isSelectedOnset(n)?.4:1,fill:e.isSelectedOnset(n)?"red":"#0062ff"})}):[]}},{key:"getOnsetWidth",value:function(e){var t=this.props.sampler.onsets;return e===t.length-1?this.convertSecondsToSpace(this.props.sampler.getDuration()-t[e]/1e3):this.convertSecondsToSpace((t[e+1]-t[e])/1e3)}},{key:"isSelectedOnset",value:function(e){return this.props.selectedOnsets.indexOf(e)>-1}}]),n}(d.Component),V=Object(y.b)(function(e,t){return{selectedOnsets:e.waveform.selectedOnsets[t.sampleId]||[]}},null)(z),H=n(842),U=n(75),J=n(6);n(34);function G(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(p.a)(e);if(t){var a=Object(p.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(h.a)(this,n)}}var W=new w.a;window.waveWidth=1,window.waveOpacity=.8;var K=new F.a(E.d,E.b),X=function(e){Object(f.a)(n,e);var t=G(n);function n(e){var r,a;Object(c.a)(this,n),(a=t.call(this,e)).state=(r={x:0,slicing:!1,dragging:!1,showColors:!0,end:null,buffer:e.buffer,isPlaying:!1,pts:[],slices:e.slices,fetchedSlices:void 0},Object(s.a)(r,"dragging",!1),Object(s.a)(r,"selection",null),Object(s.a)(r,"zoomedBuffer",void 0),Object(s.a)(r,"zommedIn",!1),Object(s.a)(r,"zoomedStartTime",0),Object(s.a)(r,"zoomedScale",1),Object(s.a)(r,"directionMode",E.c),Object(s.a)(r,"selectedRecording",a.props.track.selectedRecording),Object(s.a)(r,"xBounds",0),r),a.ref=m.a.createRef(),a.scale=1,a.width=e.width||Object(E.e)(a.props.div),a.height=e.height||E.b,K.width===a.width&&K.height===e.height||(K=new F.a(a.width,a.height)),a.markersDragging=!1;new U.a(a.props.soundId);return a.state.start=a.convertSecondsToSpace(e.start)/2,a.state.startX=a.convertSecondsToSpace(e.start),a.state.end=a.convertSecondsToSpace(e.end)/2,a.state.endX=a.convertSecondsToSpace(e.end),a.props.isReversed?K.getReversedWaveform(a.props.soundId,a.props.buffer).then(function(e){a.setState({pts:e})}):K.getWaveform(a.props.soundId,a.props.buffer).then(function(e){a.setState({pts:e})}),a.convertSpaceToSeconds.bind(Object(l.a)(a)),a.computeWaveformPoints.bind(Object(l.a)(a)),a.onWheel=a.onWheel.bind(Object(l.a)(a)),a.onKeyDown=a.onKeyDown.bind(Object(l.a)(a)),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.hideButtons||(this.ref.current.addEventListener("mousewheel",this.onWheel,{passive:!1}),window.addEventListener("keydown",this.onKeyDown)),void 0!==this.props.xBounds&&(this.state.xBounds=this.props.xBounds),this.props.setWaveformShowing(!0)}},{key:"onKeyDown",value:function(e){"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&("ArrowLeft"===e.key&&(e.preventDefault(),this.onArrowLeft(e.metaKey||e.ctrlKey)),"ArrowRight"===e.key&&(e.preventDefault(),this.onArrowRight(e.metaKey||e.ctrlKey)),"Tab"===e.key&&(e.preventDefault(),this.onArrowUp()))}},{key:"onArrowDown",value:function(){var e=this.props.selectedSlice||0;this.props.onSelectSlice(0===e?this.props.sampler.slices.length-1:e-1)}},{key:"onArrowUp",value:function(){var e=this.props.selectedSlice||0;this.props.onSelectSlice((e+1)%this.props.sampler.slices.length)}},{key:"onArrowRight",value:function(e){var t=this.props.sampler.slices;if(void 0!==this.props.selectedSlice){var n=t[this.props.selectedSlice];if(this.state.directionMode===E.c)if(e){var r=this.props.sampler.onsets.find(function(e){return e/1e3>n.startTime});r&&this.props.sampler.slice(this.props.selectedSlice,r/1e3,r/1e3+(n.endTime-n.startTime))}else this.props.sampler.slice(this.props.selectedSlice,Math.min(n.endTime,n.startTime+this.fineGrain),n.endTime);else this.props.sampler.slice(this.props.selectedSlice,n.startTime,Math.min(this.props.sampler.getDuration(),n.endTime+this.fineGrain))}}},{key:"onArrowLeft",value:function(e){var t=this.props.sampler.slices;if(void 0!==this.props.selectedSlice){var n=t[this.props.selectedSlice];if(this.state.directionMode===E.c)if(e){var r=Object(o.a)(this.props.sampler.onsets);r.reverse();var a=r.find(function(e){return e/1e3<n.startTime})||0;this.props.sampler.slice(this.props.selectedSlice,a/1e3,a/1e3+(n.endTime-n.startTime))}else this.props.sampler.slice(this.props.selectedSlice,Math.max(0,n.startTime-this.fineGrain),n.endTime);else this.props.sampler.slice(this.props.selectedSlice,n.startTime,Math.max(n.startTime,n.endTime-this.fineGrain))}}},{key:"fineGrain",get:function(){return.001*this.props.sampler.getDuration()}},{key:"componentWillUnmount",value:function(){this.props.hideButtons||(this.ref.current.removeEventListener("mousewheel",this.onWheel),window.removeEventListener("keydown",this.onKeyDown)),this.props.setWaveformShowing(!1)}},{key:"shouldComponentUpdate",value:function(e){var t=this;return K.width!==(e.width||Object(E.e)(e.div))&&(K=new F.a(e.width||Object(E.e)(e.div),this.height),this.width=e.width||Object(E.e)(e.div),K.getWaveform(e.soundId,e.buffer).then(function(e){t.setState({pts:e})})),K.height!==e.height&&(this.height=e.height,(K=new F.a(Object(E.e)(e.div),e.height)).getWaveform(e.soundId,e.buffer).then(function(e){t.setState({pts:e})})),this.props.isReversed==e.isReversed&&e.soundId===this.props.soundId&&e.track.selectedRecording===this.state.selectedRecording||(this.state.selectedRecording=e.track.selectedRecording,e.isReversed?K.getReversedWaveform(e.soundId,e.buffer).then(function(e){t.setState({pts:e})}):K.getWaveform(e.soundId,e.buffer).then(function(e){t.setState({pts:e})})),!0}},{key:"computeWaveformPoints",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r,i){var o,s,c,u,l,f,h,p,d,m,v,b,g;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.index++,o=this.index,s=this.width,!((n+1)*s>this.width)){e.next=6;break}return i([]),e.abrupt("return");case 6:if(c=Math.floor(t.length/this.width),u=(u=t.getChannelData(0)).subarray(s*n*c,s*(n+1)*c),l=window.api.create_buffer(u.length),Math.min((n+1)*s,this.width),window.Module.HEAPF32.set(u,l>>2),f=1,window.api.getColoredWaveform(l,s,this.height,u.length,c,s*n,f),h=window.api.get_result_pointer(),p=new Uint16Array(window.Module.HEAP16.buffer,h,7*s/f),d=[],!(o<this.index)){e.next=19;break}return e.abrupt("return");case 19:for(m=0;m<7*s/f;m+=7)v=[p[m+4],p[m+5],p[m+6]],d.push({x:p[m],y:p[m+1],width:p[m+2],height:p[m+3],rgb:v});if(b=this,!(o<this.index)){e.next=23;break}return e.abrupt("return");case 23:g=r.concat(d),b.setState({pts:g}),window.api.destroy_buffer(l);case 26:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"duration",get:function(){return this.props.buffer.duration}},{key:"convertSpaceToSeconds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.props.div&&!t&&(e-=this.props.div.current.getBoundingClientRect().left),(this.state.zoomedIn?this.state.zoomedBuffer:this.props.buffer).duration*e/this.width}},{key:"convertSecondsToSpace",value:function(e){return e/(this.state.zoomedIn?this.state.zoomedBuffer:this.props.buffer).duration*this.width}},{key:"newSlice",value:function(e){this.state.slicing&&(this.props.sampler.newSlice(this.convertSpaceToSeconds(e.evt.layerX)),this.state.slices=this.props.sampler.slices,this.state.slicing=!1,this.setState(this.state),this.props.onSelectSlice(this.state.slices.length-1))}},{key:"getSlices",value:function(){var e=this,t=this.props.sampler.slices.map(function(t,n){var r=t.getCopy();return r.startTime-=e.state.zoomedStartTime,r.startTime<0&&r.startTime>=-.1&&(r.startTime=0),r.endTime-=e.state.zoomedStartTime,r.i=n,r});t=t.filter(function(e){return e.startTime>=0});var n=-1;for(var r in t)if(t[r].i===this.props.selectedSlice){n=r;break}return-1===n?t:(n=t.splice(n,1)).concat(t)}},{key:"onClickShowOnsets",value:function(){this.props.setShowOnsets(!this.props.showingOnsets)}},{key:"onClickAddSlice",value:function(e){if(e.target.blur(),this.props.showingOnsets&&this.selectedOnsets.length>0){for(var t in this.selectedOnsets){var n=this.onsets[this.selectedOnsets[t]],r=this.onsets[this.selectedOnsets[t]+1];this.props.sampler.newSlice(n/1e3,r/1e3),this.state.slices=this.props.sampler.slices,this.props.onSelectSlice(this.state.slices.length-1)}return this.props.setSelectedOnsets([]),void this.props.setShowOnsets(!1)}if(null!==this.state.selection){var a=this.convertSpaceToSeconds(this.state.selection.start,!0),i=this.convertSpaceToSeconds(this.state.selection.end,!0);if(i-a<.001)return;this.props.sampler.newSlice(this.state.zoomedStartTime+a,i+this.state.zoomedStartTime),this.setState({selection:null,slices:this.props.sampler.slices}),this.props.onSelectSlice(this.props.sampler.slices.length-1)}}},{key:"onClickDeleteSlice",value:function(){this.props.sampler.deleteSlice(this.props.selectedSlice),this.setState(this.state)}},{key:"onClickAutoSlice",value:function(){this.props.sampler.autoSlice(4),this.setState(this.state)}},{key:"onClickLoadSlices",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.decentralized){e.next=9;break}return t=new U.a(this.props.soundId),this.props.sampler.slices=[],this.setState(this.state),e.next=6,t.fetchSlices();case 6:e.sent.forEach(function(e){return n.props.sampler.newSlice(e.startTime,e.endTime)}),this.setState(this.state);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickSaveSlices",value:function(){if(this.props.decentralized){var e=this.props.sampler.slices.map(function(e){return Math.floor(1e3*e.startTime)}),t=this.props.sampler.slices.map(function(e){return Math.floor(1e3*e.endTime)});this.props.soundId;R.a.newSlices(this.props.soundId,e,t)}}},{key:"onsets",get:function(){return this.props.sampler.onsets}},{key:"selectedOnsets",get:function(){return this.props.track.sequencerEngine.store.getState().waveform.selectedOnsets[this.props.sample.getId()]||[]}},{key:"onMouseDown",value:function(e){e.evt.stopPropagation();var t=e.evt.layerX;if(!this.markersDragging){if(this.props.showingOnsets){for(var n=1e3*(this.state.zoomedStartTime+this.convertSpaceToSeconds(t)),r=-1,a=0;a<this.onsets.length;a++){this.onsets[a]<n&&(a===this.onsets.length-1?r=a:this.onsets[a+1]>n&&(r=a))}if(-1!==r){var i=this.selectedOnsets.indexOf(r);if(i>-1){var s=Object(o.a)(this.selectedOnsets);s.splice(i,1),this.props.setSelectedOnsets(s)}else this.props.setSelectedOnsets([].concat(Object(o.a)(this.selectedOnsets),[r]))}}this.state.dragging?this.setState({dragging:!1}):this.setState({selection:{start:t,end:t},dragging:!0})}}},{key:"onMouseMove",value:function(e){var t=e.evt.layerX;if(this.markersDragging){this.state.endSliceDragging;var n=Math.max(0,this.convertSpaceToSeconds(t-this.state.offset,!0));return this.state.selection&&(this.state.selection=null),void this.changeTheSlice(n+this.state.zoomedStartTime)}this.state.mouseX=e.evt.layerX,this.div&&this.div.current&&(this.state.mouseX-=this.div.current.getBoundingClientRect().left),this.state.dragging&&this.setState({selection:{start:this.state.selection.start,end:e.evt.layerX}})}},{key:"changeTheSlice",value:function(e){var t=this.props.sampler.slices;if(void 0!==this.state.startSliceDragging){var n=t[this.state.startSliceDragging];if(e+.001>=n.endTime)return;if(this.ctrl){var r=e-n.startTime;this.props.sampler.slice(this.state.startSliceDragging,e,n.endTime+r)}else this.props.sampler.slice(this.state.startSliceDragging,e,n.endTime)}else if(void 0!==this.state.endSliceDragging){var a=t[this.state.endSliceDragging];if(a.startTime+.001>=e)return;if(this.ctrl){var i=e-a.endTime;this.props.sampler.slice(this.state.endSliceDragging,a.startTime+i,e)}else this.props.sampler.slice(this.state.endSliceDragging,a.startTime,e)}}},{key:"endDrag",value:function(e){if(this.markersDragging)return this.state.startSliceDragging=void 0,this.state.endSliceDragging=void 0,void(this.markersDragging=!1);this.state.dragging=!1}},{key:"scrollWaveform",value:function(e){e/=700*this.scale/this.duration;var t=this.state.zoomedStartTime||0;t+=e;var n=this.buffer.duration+this.state.zoomedStartTime;if(n+=e,!(t<0||n>this.duration)){var r=P.a.Master.context.sampleRate;this.state.zoomedStartTime=t;var a=Object(j.a)(this.props.buffer,t*r,n*r,P.a.Master.context);this.state.zoomedBuffer=a,this.setState(this.state),this.computeWaveformPoints(a,0,[],function(e){})}}},{key:"cropSelection",value:function(){var e=this.state.zoomedStartTime+this.convertSpaceToSeconds(this.state.selection.start),t=this.state.zoomedStartTime+this.convertSpaceToSeconds(this.state.selection.end);this.props.crop(e,t)}},{key:"zoomIn",value:function(e,t){if((t*=2)<=2)this.zoomOut();else{var n=this.state.zoomedStartTime||0,r=this.duration/t,a=n+this.convertSpaceToSeconds(e,!0)-r*e/this.width,i=a+r;if(a<0&&(a=0),!(i-a<.001)){var o=this.props.buffer;this.state.zoomedStartTime=a,this.state.zoomedScale=t,this.state.zoomedIn=!0;var s=P.a.Master.context.sampleRate,c=Object(j.a)(o,a*s,i*s,P.a.Master.context);this.state.zoomedBuffer=c,this.computeWaveformPoints(c,0,[],function(e){})}}}},{key:"zoomOut",value:function(){this.state.zoomedIn=!1,this.state.zoomedStartTime=0,this.state.zoomedBuffer=void 0,this.state.selection=null,this.computeWaveformPoints(this.props.buffer,0,[],function(e){})}},{key:"markerDraggingStarted",value:function(){this.markersDragging=!0,this.setState({selection:null,dragging:!1})}},{key:"markerDraggingEnded",value:function(){this.markersDragging=!1,this.setState({selection:null,dragging:!1})}},{key:"onClickSyncTempo",value:function(){var e=this.props.sampler;e.tempoSynced?e.unsyncTempo():e.syncTempo(P.a.Transport.bpm.value),document.activeElement.blur(),this.setState(this.state)}},{key:"onMouseOver",value:function(){this.mousedOver=!0}},{key:"onWheel",value:function(e){if(e.stopPropagation(),e.ctrlKey){e.preventDefault();var t=this.scale-.01*e.deltaY;t<=1&&(t=1),this.zoomIn(this.state.mouseX,t),this.scale=t}else{var n=e.deltaX;Math.abs(n)>0&&(e.preventDefault(),this.scrollWaveform(n))}}},{key:"buffer",get:function(){return this.state.zoomedBuffer||this.props.buffer}},{key:"onStartSliceStartedDragging",value:function(e,t,n){this.ctrl=n,this.props.div&&this.props.div.current&&(e-=this.props.div.current.getBoundingClientRect().left),this.markersDragging=!0,this.props.onSelectSlice(t),this.state.offset=e,this.state.startSliceDragging=t,this.setState({directionMode:E.c})}},{key:"onStartSliceStoppedDragging",value:function(e){this.markersDragging=!1,this.state.startSliceDragging=void 0}},{key:"onEndSliceStartedDragging",value:function(e,t,n){this.ctrl=n,this.props.div&&this.props.div.current&&(e-=this.props.div.current.getBoundingClientRect().left),this.markersDragging=!0,this.props.onSelectSlice(t),this.state.endSliceDragging=t,this.state.offset=e,this.setState({directionMode:E.a})}},{key:"onEndSliceStoppedDragging",value:function(e){this.markersDragging=!1,this.state.endSliceDragging=void 0}},{key:"onChangeOnsetThreshold",value:function(e){this.props.setOnsetThreshold(e),this.props.sampler.analyze(),this.setState(this.state)}},{key:"onMouseLeave",value:function(e){this.endDrag(e),this.mousedOver=!1}},{key:"onGatedChange",value:function(e){document.activeElement.blur(),this.props.track.gated="gated"===e.target.value,this.props.sampler.release(),this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.state.pts,n=this.props.track,r=W.getColorForTrack(n),a=null==this.state.selection?{start:0,end:0}:this.state.selection,i=this.state.zoomedIn?this.state.zoomedBuffer:this.props.buffer,o=this.getSlices()[this.props.selectedSlice],s=(void 0===o||this.convertSecondsToSpace(o.startTime),void 0===o||this.convertSecondsToSpace(o.endTime),void 0===o?"black":W.getColor(this.props.selectedSlice)),c=Math.round(100*this.props.sampler.tempo)/100,u=this.props.sampler,l={};this.props.track&&(l.borderColor=W.getColorForTrack(this.props.track));var f=m.a.createElement("div",{style:l,ref:this.ref,className:"sound-waveform details-view",onMouseOver:function(t){return e.onMouseOver(t)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},m.a.createElement(g.Stage,{onMouseOver:function(t){return e.onMouseOver()},onMouseDown:function(t){return e.onMouseDown(t)},onMouseUp:function(t){return e.endDrag(t)},onMouseMove:function(t){return e.onMouseMove(t)},onMouseLeave:function(t){return e.onMouseLeave(t)},width:this.width+2,height:this.height},m.a.createElement(y.a,{store:this.props.track.sequencerEngine.store},m.a.createElement(g.Layer,null,m.a.createElement(g.Rect,{onClick:function(t){return e.newSlice(t)},x:0,y:0,width:this.width,height:this.height,fill:this.props.backgroundColor?this.props.backgroundColor:this.props.small?"black":"#222222cf"}),this.props.small?[]:m.a.createElement(A,{convertSecondsToSpace:function(t){return e.convertSecondsToSpace(t)},fullDuration:this.duration,height:this.height,zoomedStartTime:this.state.zoomedStartTime,buffer:i,width:this.width}),m.a.createElement(V,{height:this.height,width:this.width,buffer:i,showingOnsets:this.props.showingOnsets,zoomedStartTime:this.state.zoomedStartTime,sampleId:this.props.sample.getId(),sampler:this.props.sampler,onUpdate:function(){return e.setState(e.state)}}),this.markersDragging?[]:m.a.createElement(g.Rect,{x:a.start,y:0,width:a.end-a.start,height:this.height,fill:"orange"})),m.a.createElement(O,{color:r,pts:t,showColors:this.state.showColors}),m.a.createElement(g.Layer,null,this.getSlices().map(function(t,n){return m.a.createElement(N,{key:"marker-"+n,mode:e.state.directionMode,small:e.props.small,height:e.height,width:e.width,transposeParameter:e.props.track.trackData.transposeParameter,scale:e.state.zoomedScale,onStartSliceStartedDragging:function(n,r){return e.onStartSliceStartedDragging(n,t.i,r)},onStartSliceStoppedDragging:function(){return e.onStartSliceStoppedDragging(t.i)},onEndSliceStartedDragging:function(n,r){return e.onEndSliceStartedDragging(n,t.i,r)},onEndSliceStoppedDragging:function(){return e.onEndSliceStoppedDragging(t.i)},onKeyDown:e.props.onKeyDown,isSelectedSlice:e.props.selectedSlice===t.i,buffer:i,onSelectSlice:function(){return e.props.onSelectSlice(t.i)},track:e.props.track,sliceNumber:t.i,sampler:e.props.sampler,zoomedStartTime:e.state.zoomedStartTime,color:e.props.color||W.getColor(t.i)})})),m.a.createElement(g.Layer,null,m.a.createElement(H.a,{width:this.width,sampler:u,sequencerEngine:this.props.track.sequencerEngine,soundId:this.props.soundId,height:this.height,convertSecondsToSpace:function(t){return e.convertSecondsToSpace(t-e.state.zoomedStartTime)}})))));if(this.props.hideButtons)return f;var h="add-slice-button details-button",p=!0;return(null===this.state.selection||this.state.selection.end-this.state.selection.start<=1)&&(this.props.showingOnsets&&0!==this.selectedOnsets.length||(h+=" disabled",p=!1)),m.a.createElement("div",{className:"waveform-container"},f,m.a.createElement("div",{className:"waveform-buttons"},m.a.createElement("div",{className:h,onClick:function(t){return e.onClickAddSlice(t)}},m.a.createElement("div",{className:"inner"},"Slice")),m.a.createElement("div",{className:this.props.sampler.slices.length>1?"details-button delete-slice":"details-button delete-slice disabled",onClick:function(t){return e.onClickDeleteSlice(t)}},m.a.createElement("div",{className:"inner"},m.a.createElement("div",null,"Delete Slice"),m.a.createElement("div",{style:{backgroundColor:s},className:"dot"}))),m.a.createElement(L.a,{condition:0!==c},m.a.createElement("div",{onClick:function(){return e.onClickShowOnsets()},className:"details-button onsets-btn"},m.a.createElement("div",{className:"inner"},this.props.showingOnsets?"Hide Onsets":"Show Onsets")),m.a.createElement("div",{onClick:function(){return e.onClickAutoSlice()},className:this.props.sampler.slices.length>1?"disabled details-button auto-slice-btn":"details-button auto-slice-btn"},m.a.createElement("div",{className:"inner"},"Auto-Slice"))),m.a.createElement(L.a,{condition:this.state.zoomedStartTime>0},m.a.createElement("div",{onClick:function(){return e.zoomOut()},className:"details-button zoom-out-btn"},m.a.createElement("div",{className:"inner"},"Zoom Out"))),m.a.createElement(_,{sampler:u,track:this.props.track}),m.a.createElement("div",{className:"radio gate-btn"},m.a.createElement("label",null,m.a.createElement("input",{className:"filter-radio",type:"radio",value:"gated",checked:n.gated,onChange:function(t){return e.onGatedChange(t)}}),m.a.createElement("div",null,"Gated")),m.a.createElement("label",null,m.a.createElement("input",{className:"filter-radio",type:"radio",value:"ungated",checked:!n.gated,onChange:function(t){return e.onGatedChange(t)}}),m.a.createElement("div",null,"Ungated"))),m.a.createElement("div",{className:"radio reverse"},m.a.createElement("label",null,m.a.createElement("input",{type:"checkbox",value:"reversed",checked:this.props.track.isReversed(),onChange:function(t){return e.props.onChangeReversed(t.target.value)}}),m.a.createElement("div",null,"Reversed"))),m.a.createElement(L.a,{condition:p},m.a.createElement("div",{onClick:function(){return e.cropSelection()},className:"details-button crop-btn"},m.a.createElement("div",{className:"inner crop-button"},"Crop In-Place"))),m.a.createElement(L.a,{condition:!p},m.a.createElement("div",{onClick:function(){return e.props.cropSlices()},className:"details-button crop-btn"},m.a.createElement("div",{className:"inner crop-button"},"Crop Slices"))),m.a.createElement(L.a,{condition:this.props.showingOnsets},m.a.createElement("div",{className:"onset-threshold-container"},m.a.createElement("div",null,"Onset Threshold: ",this.props.onsetThreshold," db"),m.a.createElement(b.a,{value:this.props.onsetThreshold,change:function(t){return e.onChangeOnsetThreshold(t.target.value)},step:.01,max:6,min:-10,orientation:"horizontal",reversed:!1})))),m.a.createElement(M,{slice:this.props.selectedSlice,sampler:u}))}}]),n}(d.Component);t.a=Object(y.b)(function(e,t){return{onsetThreshold:e.waveform.onsetThreshold,showingOnsets:e.waveform.showingOnsets,slicesLenggth:t.sampler.slices.length}},function(e,t){return{setContextualHelp:function(t){return e(Object(J.ub)(t))},setOnsetThreshold:function(t){return e(Object(J.Cd)(t))},setSelectedOnsets:function(n){return e(Object(J.ef)(t.sample.getId(),n))},setShowOnsets:function(t){return e(Object(J.Tf)(t))},setWaveformShowing:function(t){return e(Object(J.Jh)(t))}}})(X)},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(12),s=n(391),c=n(191),u=n(15),l=n.n(u),f=n(42),h=Object(a.memo)(function(e){var t=e.coloredWaveformPoints;return i.a.createElement(f.FastLayer,null,t.map(function(e,t){return i.a.createElement(f.Rect,{key:"point-"+t,x:e.x,y:e.y,width:e.width,height:e.height,fill:"rgb("+e.rgb[0]+","+e.rgb[1]+","+e.rgb[2]+")"})}))}),p=Object(a.memo)(function(e){e.waveformPoints;var t=e.rmsPoints,n=e.color;return i.a.createElement(f.FastLayer,null,i.a.createElement(f.Line,{bezier:!0,points:t,stroke:n,strokeWidth:2}))}),d=function(e,t,n){return t?e/t.duration*n:0},m=Object(a.memo)(function(e){var t=e.sampler,n=e.height,r=e.instrument,a=e.buffer,o=e.color,s=e.width,c=(e.step,e.zoomedStartTime),u=e.setDraggingStart,l=e.setDraggingEnd;if(void 0===a)return i.a.createElement(f.Layer,null);var h=t.getLoopPoints(r.getLoopPoints(0,t)),p=h.loopStart,m=h.loopEnd;return p=d(p-c,a,s),m=d(m-c,a,s),i.a.createElement(f.Layer,null,i.a.createElement(f.Rect,{x:p,y:0,width:m-p,height:n,fill:o,opacity:.15}),i.a.createElement(f.Line,{points:[p,0,p,n],stroke:"red",strokeWidth:2}),i.a.createElement(f.Line,{onMouseDown:u,points:[p,0,p,n],stroke:"black",opacity:0,strokeWidth:20}),i.a.createElement(f.Line,{points:[m,0,m,n],stroke:"red",strokeWidth:2}),i.a.createElement(f.Line,{onMouseDown:l,points:[m,0,m,n],stroke:"black",opacity:0,strokeWidth:20}))}),v=Object(o.b)(function(e,t){var n=void 0===e.sequencer.sequencerEngine?void 0:e.sequencer.sequencerEngine.getSequenceId();return{step:void 0!==n&&e.sequencer.isPlaying[n]?e.sequencer.sequencerEngine.trackStep:0,loopStart:t.instrument.loopStart,loopLength:t.instrument.loopLength}},null)(m),b=n(842),g=n(298),y=n(29),k=n(181),O=new y.a,j=new g.a(445,75);t.a=Object(o.b)(null,function(e,t){return{}})(function(e){var t=e.backgroundColor||"black",n=e.buffer,u=e.soundId,m=e.instrument,y=e.sampler,w=Object(a.useState)(!1),E=Object(r.a)(w,2),S=E[0],P=E[1],x=Object(a.useState)(!1),T=Object(r.a)(x,2),C=T[0],N=T[1],R=Object(a.useState)(e.width||k.d),M=Object(r.a)(R,2),A=M[0],q=M[1],D=Object(a.useState)(e.height),I=Object(r.a)(D,2),_=I[0],F=I[1],L=Object(a.useState)([]),B=Object(r.a)(L,2),z=B[0],V=B[1],H=Object(a.useState)([]),U=Object(r.a)(H,2),J=U[0],G=U[1],W=Object(a.useState)([]),K=Object(r.a)(W,2),X=K[0],Q=K[1];O.getBrightness(e.color)<110&&(t=O.brighten(t,2));var Y=Object(a.useState)(!1),Z=Object(r.a)(Y,2),$=Z[0],ee=Z[1],te=Object(a.useRef)(0),ne=Object(a.useRef)(null),re=function(e,t,n,i,o,u){var f=Object(a.useState)({}),h=Object(r.a)(f,2),p=h[0],d=h[1],m=Object(a.useRef)(void 0),v=Object(a.useRef)(void 0),b=Object(a.useRef)(1);Object(a.useEffect)(function(){k()},[e,u]),Object(a.useEffect)(function(){return window.addEventListener("mousewheel",g,{passive:!1}),function(){return window.removeEventListener("mousewheel",g)}},[d,p,u,t,e]);var g=Object(a.useCallback)(function(e){if(!t)return!0;if(e.ctrlKey){e.preventDefault(),e.stopPropagation();var n=e.deltaY>0?.02:.01,r=b.current-e.deltaY*n;if(r<=1)return void k();b.current=r,y(r)}else{var a=e.deltaX;Math.abs(a)>0&&(e.preventDefault(),O(a))}return!1},[t,u,e,p,d]),y=Object(a.useCallback)(function(t){var r=n.current;if((t*=2)<=2)k();else{var a=v.current||0,o=e.duration/t,s=a+w(r)-o*r/i,u=s+o;if(s<0&&(s=0),!(u-s<.001)){var f=l.a.Master.context.sampleRate;v.current=s;var h=Object(c.a)(e,s*f,u*f,l.a.Master.context);j(h,s)}}},[u,e,p,d]),k=Object(a.useCallback)(function(){o.index+=100,v.current=void 0,m.current=void 0,b.current=1,d({})},[d]),O=Object(a.useCallback)(function(t){var n=(m.current||e).duration;t/=700*b.current/e.duration;var r=v.current||0;r+=t;var a=n+(v.current||0);if(a+=t,!(r<0||a>e.duration)){var i=l.a.Master.context.sampleRate;v.current=r;var o=Object(c.a)(e,r*i,a*i,l.a.Master.context);j(o,r)}},[u,e,p,d]),j=Object(a.useCallback)(function(t,n){if(m.current=t,e.duration<3)o.getBasicWaveform(0,t,!1).then(function(e){e&&1!==b.current&&(e.sort(function(e,t){return e.x-t.x}),d({rmsPoints:Object(s.a)(e,"rmsY"),waveformPoints:Object(s.a)(e,"y")}))});else{var r=Math.ceil(8/Math.pow(b.current,2));o.getWaveform(0,t,!1,r).then(function(e){e&&1!==b.current&&d({coloredWaveformPoints:e})})}},[u,e,d]),w=Object(a.useCallback)(function(t){return(m.current||e).duration*t/i},[e,u,i]);return Object(a.useCallback)(function(t){return t/(m.current||e).duration*i},[e,u,i]),{zoomedBuffer:m.current,zoomedRmsPoints:p.rmsPoints,zoomedColoredPoints:p.coloredWaveformPoints,zoomedWaveformPoints:p.waveformPoints,zoomedStartTime:v.current}}(n,$,te,A,j,y),ae=re.zoomedBuffer,ie=re.zoomedRmsPoints,oe=re.zoomedColoredPoints,se=re.zoomedWaveformPoints,ce=re.zoomedStartTime;Object(a.useEffect)(function(){if(n){var t=e.width||Object(k.e)(e.div),r=e.height||k.b;return y.showingPrettyWaveform=!0,q(t),F(r),r===j.height&&t===j.width||(j=new g.a(t,r)),n.duration<3?j.getBasicWaveform(u,n).then(function(e){e.sort(function(e,t){return e.x-t.x}),Q(Object(s.a)(e,"rmsY")),V(Object(s.a)(e,"y")),G([])}):j.getWaveform(u,n).then(function(e){Q([]),V([]),G(e)}),function(){y.showingPrettyWaveform=!1}}},[q,F,Q,V,n,u,y,G]);var ue=Object(a.useCallback)(function(){P(!1),N(!1)},[P,N]),le=Object(a.useCallback)(function(){ee(!1),ue()},[ee]),fe=Object(a.useCallback)(function(e){var t=ne.current.getBoundingClientRect(),r=e.clientX-t.left;te.current=r;var a=100*r/A;ae&&(a=100*(ce+ae.duration*a/100)/n.duration),S&&m.loopStartParameter.set(Math.max(0,a),!1),C&&m.loopLengthParameter.set(Math.max(0,a-m.loopStart),!1)},[m,S,C,A,ne,ae,ce]),he=O.saturate(O.getColorForHash(u),3);return i.a.createElement("div",{onMouseOver:function(e){return ee(!0)},onMouseUp:ue,onMouseLeave:le,onMouseMove:fe,ref:ne,className:"sound-waveform"},i.a.createElement(f.Stage,{width:A,height:_},i.a.createElement(o.a,{store:e.store},i.a.createElement(f.Layer,{onMouseUp:ue},i.a.createElement(f.Rect,{width:A,height:_,x:0,y:0,fill:t})),J.length>0?i.a.createElement(h,{coloredWaveformPoints:oe||J}):i.a.createElement(p,{color:he,rmsPoints:ie||X,waveformPoints:se||z}),i.a.createElement(v,{setDraggingStart:P,setDraggingEnd:N,instrument:m,zoomedStartTime:ce||0,color:he,buffer:ae||n,sampler:y,width:A,height:_}),i.a.createElement(f.FastLayer,null,i.a.createElement(b.a,{instrument:m,soundId:u,height:_,convertSecondsToSpace:function(e){return d(e-(ce||0),ae||n,A)}})))))})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(29),s=n(2),c=n(4),u=n(7),l=n(10),f=n(1),h=n(843),p=n(12);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}new o.a;var m=function(e){Object(u.a)(n,e);var t=d(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(c.a)(n,[{key:"onClickKey",value:function(){this.props.notClickable||(console.log("on click value = ",this.props.value),this.props.keyboardEngine.isMidiMapped(this.props.value)&&(console.log("it is mapped so unmapping!"),this.props.keyboardEngine.deleteMidiMapping(this.props.value)))}},{key:"render",value:function(){var e=this,t="pad";return this.props.triggering&&(t+=" flashit"),this.props.mini&&(t+=" mini"),i.a.createElement("div",{onClick:function(){return e.onClickKey()},style:this.getStyle(),className:t},this.props.value)}}]),n}(h.a),v=Object(p.b)(function(e,t){var n=e.keyboard.padMappings[t.value],r=void 0===n?void 0:e.tracks.triggers[n.trackNumber];return{triggering:void 0!==r&&r[n.sliceNumber],keyMapping:n}},null)(m),b=n(63),g=function(e){for(var t=[],n=b.a.fromString("C2").addTranspose(16*e).toString(),r=0;r<4;r++){for(var a=[],i=0;i<4;i++){a.push(n);b.a.fromString(n).getTranspose();n=b.a.fromString(n).addTranspose(1).toString()}t.push(a)}return t.reverse()},y=function(e){var t=e.octave,n=e.setOctave,r=e.sequencerEngine,a=e.keyboardEngine,o=e.isSelected,s=g(t),c="octave-pads";return o&&(c+=" selected"),i.a.createElement("div",{onClick:function(){return n(t)},className:c},s.map(function(e){return i.a.createElement("div",{className:"pads-row"},e.map(function(e){return i.a.createElement(v,{notClickable:!0,mini:!0,value:e,keyboardEngine:a,sequencerEngine:r,trackNumber:void 0})}))}))},k=Object(p.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.keyboardEngine,r=e.octave,o=e.setOctave,s=Object(a.useRef)(void 0);Object(a.useEffect)(function(){s.current&&s.current.scroll(0,60*(4-r))},[r]);return i.a.createElement("div",{ref:s,className:"midi-pads-overview"},[4,3,2,1,0].map(function(e){return i.a.createElement(y,{setOctave:o,isSelected:r===e,octave:e,sequencerEngine:t,keyboardEngine:n})}))});n(2435),new o.a,t.a=Object(p.b)(function(e){return{lastMidiKeyMapped:e.keyboard.lastMidiKeyMapped}},null)(function(e){var t=Object(a.useState)(0),n=Object(r.a)(t,2),o=n[0],s=n[1];Object(a.useEffect)(function(){if(e.lastMidiKeyMapped){var t=(b.a.fromString(e.lastMidiKeyMapped,!1).getTranspose()+12)/16;s(Math.floor(t))}},[e.lastMidiKeyMapped,s]);var c="pads ";e.mini&&(c+=" mini");var u=g(o);return i.a.createElement("div",{className:"midi-pads-container"},i.a.createElement("div",{className:c},i.a.createElement("div",{className:"pads-row"},u[0].map(function(t){return i.a.createElement(v,{mini:e.mini,value:t,keyboardEngine:e.sequencerEngine.keyboardEngine,sequencerEngine:e.sequencerEngine,trackNumber:e.trackNumber})})),i.a.createElement("div",{className:"pads-row"},u[1].map(function(t){return i.a.createElement(v,{mini:e.mini,value:t,sequencerEngine:e.sequencerEngine,keyboardEngine:e.sequencerEngine.keyboardEngine,trackNumber:e.trackNumber})})),i.a.createElement("div",{className:"pads-row"},u[2].map(function(t){return i.a.createElement(v,{mini:e.mini,value:t,sequencerEngine:e.sequencerEngine,keyboardEngine:e.sequencerEngine.keyboardEngine,trackNumber:e.trackNumber})})),i.a.createElement("div",{className:"pads-row"},u[3].map(function(t){return i.a.createElement(v,{mini:e.mini,value:t,sequencerEngine:e.sequencerEngine,keyboardEngine:e.sequencerEngine.keyboardEngine,trackNumber:e.trackNumber})}))),i.a.createElement(k,{octave:o,setOctave:s,sequencerEngine:e.sequencerEngine,keyboardEngine:e.sequencerEngine.keyboardEngine}))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=(n(22),n(12)),f=n(46);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"enableOscillator",value:function(){this.props.sequencerEngine.operationManager.dispatch(Object(f.v)(this.props.oscillator.enabledParameter,!0)),this.setState(this.state)}},{key:"disableOscillator",value:function(){this.props.sequencerEngine.operationManager.dispatch(Object(f.v)(this.props.oscillator.enabledParameter,!1)),this.setState(this.state)}},{key:"onClick",value:function(){this.props.oscillator.enabled?this.props.selectedOscillator===this.props.number?this.disableOscillator():this.props.onChooseOscillator(this.props.number):(this.enableOscillator(),this.props.onChooseOscillator(this.props.number))}},{key:"render",value:function(){var e=this,t=this.props.number===this.props.selectedOscillator?"oscillator-option selected":"oscillator-option";return this.props.enabled||(t+=" disabled"),u.a.createElement("div",{onClick:function(){return e.onClick()},className:t},this.props.number+1)}}]),n}(c.Component),d=Object(l.b)(function(e,t){var n=t.oscillator.enabledParameter;return{enabled:e.effects.effectParameters[n.id]}},null)(p),m=n(733);n(39);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}c.Component},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=["pad","Synth","piano","string","guitar","organ","harm","clap","tom","rim","flute","snare","bass","perc","bazz","hi-hat","kick","lead","key","rhodes","poly","koto","pluck"];function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=new(n(29).a);t.a=function(e){var t,n=e.preset,r=n.title.toLowerCase(),s=n.tags,u=void 0,l=o(i);try{var f=function(){var e=t.value;r.includes(e)?u=e:s.some(function(t){return t.includes(e)})&&(u=e)};for(l.s();!(t=l.n()).done;)f()}catch(p){l.e(p)}finally{l.f()}!u&&s.length>0&&(u=s[0]);var h=u?c.getColorForHash(u):"gray";return a.a.createElement("div",{style:{borderBottomColor:h},className:"preset-type"})}},,function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(9);function a(e){return(e=Object(r.a)(e)).sort(),e[Math.floor(e.length/2)]}},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(8),s=n(9),c=n(2),u=n(4),l=n(1343),f=n(192),h=n(369),p=n(47),d=n(31),m=n(63),v=new l.a,b=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,[{key:"convertToNotes",value:function(e){return e=e.filter(function(e){return void 0!==e}).filter(function(e){return void 0!==e.pitch}).map(function(e){return{note:m.a.fromTranspose(e.pitch-60).note,startTime:e.startTime,endTime:e.endTime}})}},{key:"getChordsFromSequence",value:function(e,t){var n=this;e.sort(function(e,t){return e.startTime-t.startTime}),e=this.convertToNotes(e);for(var r=[],a=0;a<e.length;a++){var i=e[a],c=Object(s.a)(t),u=[];if(i.note===c[0]){for(var l=a;l<e.length&&0!=c.length;l++){var f=c[0];if(f===e[l].note){c=c.slice(1),u.push(e[l]);for(var h=l,p=l+1;p<e.length&&f==e[p].note;p++)u.push(e[p]),h=p;l=h}else u.push(null)}0==c.length&&r.push(u)}}var d=(r=r.map(function(e){return n.pruneTrailingNulls(e)})).filter(function(e){return e.filter(function(e){return null===e}).length<=.5*e.length}).filter(function(e){return e.length>0}).map(function(e){return{startTime:e[0].startTime,endTime:e[e.length-1].endTime}}).map(function(t){return Object(o.a)({},t,{density:n.calculateDensityForSlice(t,e)})}),m=[],v=function(e){var t=d[e];d.filter(function(e){return t.startTime>e.startTime&&t.endTime<=e.endTime}).length>0||m.push(t)};for(var b in d)v(b);return m}},{key:"calculateDensityForSlice",value:function(e,t){var n=t.filter(function(t){return t.startTime>=e.startTime&&t.startTime<=e.endTime||t.endTime>=e.startTime&&t.endTime<=e.endTime}),r=e.endTime-e.startTime;return n.length/r}},{key:"pruneTrailingNulls",value:function(e){var t=[];for(var n in e){if(e.slice(n).every(function(e){return null===e}))break;t.push(e[n])}return t}},{key:"getNoteSequence",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new f.a).from(d.B).select("noteSequenceHash").where("sampleHash",t).executeQuery();case 2:if(0!=(n=e.sent).length){e.next=5;break}return e.abrupt("return",void 0);case 5:return r=n[0].noteSequenceHash,e.next=8,p.a.getJson(r);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"searchRankedNotes",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l,f,h,p,d,m,v,b,g,y,k,O,j,w,E;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.searchNotes(t);case 2:n=e.sent,r=[],e.t0=a.a.keys(n);case 5:if((e.t1=e.t0()).done){e.next=20;break}for(u in i=e.t1.value,o=n[i],s=o.remainingNotes,c=100,t)l=t[u],f=s.slice(u),-1==(h=f.indexOf(l))?c-=1/t.length*200:h>0&&(c-=5*h);if(p=s.length,d=o.startTime/1e3,m=o.endTime/1e3,v=p/(m-d),!(c<80)){e.next=17;break}return e.abrupt("continue",5);case 17:r.push({score:c,density:v,result:o}),e.next=5;break;case 20:r.sort(function(e,t){return e.density-t.density}),b={},e.t2=a.a.keys(r);case 23:if((e.t3=e.t2()).done){e.next=36;break}if(g=e.t3.value,!(r[g].score<=80)){e.next=27;break}return e.abrupt("continue",23);case 27:y=r[g].result,k=y.sampleHash,O=y.remainingNotes,j=y.startTime,w=y.endTime,E={startTime:j,endTime:w,remainingNotes:O},k in b?b[k].push(E):b[k]=[E],e.next=23;break;case 36:return e.abrupt("return",b);case 37:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getStartTimesForSample",value:function(){var e=Object(i.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){new f.a(v.contractAddress).from(d.C).select("startTime").where("sampleHash",t).executeQuery().then(function(t){return e(t)})}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"searchNotes",value:function(e){return new Promise(function(t,n){if(0!=e.length){var r=e.map(function(e){return h.b[e]}),a=new f.a(v.contractAddress).from(d.C).select("sampleHash").select("noteA").select("noteB").select("remainingNotes").select("startTime").select("endTime").where("noteA",r[0]);e.length>1&&(a=a.where("noteB",r[1])),a.executeQuery().then(function(e){return t(e)})}else t()})}}]),e}();t.a=b},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(40),u=n(183),l=n(65),f=n(31),h=n(70),p=n(44),d=new(n(269).a),m=function(){function e(t){Object(o.a)(this,e),this.web3=t,this.contract=new t.eth.Contract(d.abi,d.contractAddress)}return Object(s.a)(e,[{key:"address",get:function(){return this.contract.options.address}},{key:"getGuildIdForSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new c.a(this.address).from(f.Y).select("guildId").where("ipfsHash",t).executeQuery();case 2:if(n=e.sent,null!==(r=n.map(function(e){return e.guildId})[0])&&void 0!==r){e.next=6;break}return e.abrupt("return",0);case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getMetadataForSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new c.a(this.address).from(n).where("ipfsHash",t);case 2:return i=e.sent,r.forEach(function(e){return i.select(e)}),e.next=6,i.executeQuery();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getTagsForSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadataForSound(t,f.cb,["tag"]);case 2:return n=e.sent,e.abrupt("return",Array.from(new Set(n.map(function(e){return e.tag}))));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTitleForSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadataForSound(t,f.Y,["title"]);case 2:if(0!==(n=e.sent).length){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.abrupt("return",n[0].title);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getStylesForSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadataForSound(t,f.bb,["style"]);case 2:return n=e.sent,e.abrupt("return",Array.from(new Set(n.map(function(e){return e.style}))));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getCountryForSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadataForSound(t,f.X,["country"]);case 2:if(0!==(n=e.sent).length){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.abrupt("return",n[0].country);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getYearForSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadataForSound(t,f.fb,["year"]);case 2:if(0!==(n=e.sent).length){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.abrupt("return",n[0].year);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getYoutubeIdForSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadataForSound(t,f.gb,["videoId"]);case 2:if(0!==(n=e.sent).length){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.abrupt("return",n[0].videoId);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getDiscogsData",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadataForSound(t,f.n,["covertArtHash, discogsId"]);case 2:return n=e.sent,e.abrupt("return",n[0]||{coverArtHash:void 0,discogsId:void 0});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"saveSample",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,l,f,h,p,d,m;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getId(),r=new u.a(t.audioBuffer.numberOfChannels,function(){return[]}),e.next=4,r.uploadBufferToIpfs(t.audioBuffer);case 4:return i=e.sent,e.next=7,this.getTagsForSound(n);case 7:return o=e.sent,e.next=10,this.getTitleForSound(n);case 10:return s=e.sent,e.next=13,this.getStylesForSound(n);case 13:return c=e.sent,e.next=16,this.getCountryForSound(n);case 16:return l=e.sent,e.next=19,this.getYearForSound(n);case 19:return f=e.sent,e.next=22,this.getDiscogsData(n);case 22:return h=e.sent,p=h.coverArtHash,d=h.discogsId,e.next=27,this.getYoutubeIdForSound(n);case 27:return m=e.sent,this.newSampleWithMetadata(i,{title:s,youtubeId:m,tags:o,styles:c,country:l,year:f,guildId:0,discogsId:d,coverArtHash:p}),e.abrupt("return",i);case 30:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"newSampleWithMetadata",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(i.a)(a.a.mark(function e(i,o){var s,c,u,f,d,m,v,b,g,y,k,O,j,w;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(s=n.title,c=n.youtubeId,u=n.tags,f=n.styles,d=n.country,m=n.year,v=n.guildId,b=n.discogsId,g=n.coverArtHash,y=r.web3,k=y.utils.padLeft("0x0",64),void 0===u&&(u=[]),u.length>4&&(u=u.slice(0,4)),f.length>4&&(f=f.slice(0,4)),O=u.length;O<4;O++)u.push(null);for(j=f.length;j<4;j++)f.push(null);u=u.map(function(e){return e?y.utils.fromAscii(e):k}),f=f.map(function(e){return e?y.utils.fromAscii(e):k}),d=d?y.utils.fromAscii(d):k,c=c?y.utils.fromAscii(c):k,g=g?Object(l.c)(g):k,t=Object(l.c)(t),w=[t,s,c,u,f,d,void 0===m?0:m,void 0===b?0:b,g,v],new h.a(p.j,"newSampleWithMetadata",w).execute().then(function(){return i()});case 16:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}();t.a=m},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){for(var t=Object.getOwnPropertyNames(e),n=0;n<t.length;n++)delete e[t[n]];return e}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(8),a=n(17),i=n(83),o=function(e,t){return Object(r.a)({},e,{transpose:0,type:t})},s=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var s=a.A.apply(void 0,[e].concat(n)),c=[],u=0;u<s.length;u++){var l=s[u],f=l.type,h=f.type;f.value;if("."===h)c.push([o(l,Object(i.b)(0)),o(l,Object(i.b)(1))]);else{var p=[o(l,Object(i.c)()),o(l,Object(i.c)()),o(l,Object(i.b)(0)),o(l,Object(i.b)(1))];p.cycleLength=2,c.push(p),u++}}return c}}},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(16),u=n(7),l=n(10),f=n(1),h=n(56),p=n(147),d=(n(32),n(15)),m=n.n(d);n(21);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var b=function(e){Object(u.a)(n,e);var t=v(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Granulator",function(){return new m.a.Gain(1)},e,!0)).outputNode=new m.a.Gain(1),r.loadedValue=1,r.initializeWorklets(),r.updateInitialValues(),r}return Object(s.a)(n,[{key:"connect",value:function(e){this.outputNode.connect(e)}},{key:"disconnect",value:function(e){this.outputNode.disconnect(e)}},{key:"initializeWorklets",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!p.isMobile&&!this.sequencerEngine.isOffline){e.next=4;break}this.effectNode.connect(this.outputNode),e.next=9;break;case 4:return e.next=6,this.sequencerEngine.initAudioWorklets();case 6:this.granulator=new AudioWorkletNode(m.a.Master.context._context,"granulator-node"),this.effectNode.connect(this.granulator),this.granulator.connect(this.outputNode);case 9:this.updateInitialValues();case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"documented",get:function(){return"Reduces the volume of loud sounds or amplifies quiet sounds."}},{key:"getJson",value:function(e){return Object(c.a)(Object(f.a)(n.prototype),"getJson",this).call(this)}},{key:"fromJson",value:function(e,t){return Object(c.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(h.a.Effect);t.a=b},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(16),u=n(7),l=n(10),f=n(1),h=n(56),p=(n(32),n(15)),d=n.n(p);n(41);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var v=function(e){Object(u.a)(n,e);var t=m(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,"Granular",function(){return new d.a.Gain(1)},e)).effectNode.gain.value=1,r.outputNode=new d.a.Gain(1),r.initWorklet(),r.updateInitialValues(),r}return Object(s.a)(n,[{key:"initWorklet",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.a.Master.context._context,e.next=3,t.audioWorklet.addModule("/granular-processor.js");case 3:this.granularNode=new AudioWorkletNode(t,"granular-processor"),this.effectNode.connect(this.granularNode),this.granularNode.connect(this.outputNode);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"documented",get:function(){return"Reduces the volume of loud sounds or amplifies quiet sounds."}},{key:"connect",value:function(e){this.connectedNode=e,this.outputNode.connect(e)}},{key:"disconnect",value:function(e){void 0!=this.connectedNode&&(this.outputNode.disconnect(e),this.connectedNode=void 0)}},{key:"getJson",value:function(e){return Object(c.a)(Object(f.a)(n.prototype),"getJson",this).call(this)}},{key:"fromJson",value:function(e,t){Object(c.a)(Object(f.a)(n.prototype),"fromJson",this).call(this,e,t)}},{key:"getEffectCopy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sequencerEngine,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new n(e);return r.fromJson(this.getJson(),t),r}}]),n}(h.a.Effect);t.a=v},function(e,t,n){"use strict";n.d(t,"a",function(){return b});var r=n(5),a=n.n(r),i=n(14),o=n(207),s=n(63),c=n(92),u=n(183),l=n(75),f=n(6),h=n(191),p=n(15),d=n.n(p);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,s,u,l,h,p,d,v,b;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getSelectedTrack(),r=n.presetName||n.getName(),t.store.dispatch(Object(f.bd)("Freezing instrument")),e.next=5,Object(c.a)(250);case 5:return e.next=7,Object(o.d)(t,n);case 7:return i=e.sent,e.next=10,g(t,i,r);case 10:s=e.sent,(u=t.addSampledInstrumentTrack()).resampledFrom=n.preset,l=0,h=[],p=m(s);try{for(p.s();!(d=p.n()).done;)v=d.value,t.recordingsToSave.push(v),h.push(u.instrument.newSample(3*l-12,v)),l++}catch(a){p.e(a)}finally{p.f()}return e.next=19,Promise.all(h);case 19:b=n.instrument?n.instrument.ampEnvelope.release:2e3,u.instrument.releaseParameter.set(b),t.store.dispatch(Object(f.bd)(void 0)),n.preset;case 23:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var o,c,f,p,m;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for([],o=0,c=new u.a(2,function(e,t,n){return[]}),t.state.freeze.loops,64,f=[],24,p=function(e){var u=o,p=u+64*d.a.Master.context.sampleRate*new d.a.Time("32n").toMilliseconds()/1e3,m=Object(h.a)(n,u,p,d.a.Master.context);o=p,f.push(new Promise(function(){var n=Object(i.a)(a.a.mark(function n(i){var o,u;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c.uploadBufferToIpfs(m);case 2:o=n.sent,(u=new l.a(o)).audioBuffer=m,u.tempo=t.tempo,u.name=r+": "+s.a.fromTranspose(-12+e).toString(),u.tags=["Resampled",r],i(u);case 9:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()))},m=0;m<24;m++)p(m);return e.next=11,Promise.all(f);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";function r(e){return new Promise(function(t){var n=new Blob([new Uint8Array(e)]),r=new FileReader;r.onload=function(e){t(e.target.result)},r.readAsText(n)})}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(38);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this;if(0===this.props.guildOptions.length&&!this.props.showPublic)return u.a.createElement("div",{className:"guild-options-container"},"You are not a part of any guilds yet. To create one, go ",u.a.createElement("a",{href:"/guilds"},"here"),".");return u.a.createElement("div",{className:"guild-options-container"},"Only members of selected guild will have access",u.a.createElement("div",{className:"guild-options"},u.a.createElement(l.a,{condition:this.props.showPublic},u.a.createElement(p,{guild:{guildId:0,name:"Public"},onClick:function(){return e.props.onSelectGuild(void 0)},isSelected:void 0===this.props.selectedGuild})),this.props.guildOptions.map(function(t){return u.a.createElement(p,{guild:t,onClick:function(){return e.props.onSelectGuild(t)},isSelected:e.isSelected(t)})})))}},{key:"isSelected",value:function(e){return void 0===this.props.selectedGuild?0===e.id:this.props.selectedGuild.guildId===e.guildId}}]),n}(c.Component),p=function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e="guild-option";return this.props.isSelected&&(e+=" selected"),u.a.createElement("div",{onClick:this.props.onClick,className:e},this.props.guild.name)}}]),n}(c.Component);t.a=h},function(e,t,n){"use strict";var r=n(8),a=n(0),i=n.n(a),o=n(12);t.a=Object(o.b)(function(e,t){return Object(r.a)({freezeDragging:e.freeze.freezeDragging},t.track.frozenColumns.map(function(e){return e.frozenSamplers.length}))},function(e){return{}})(function(e){var t=e.track,n=e.freezeDragging,r=Object(a.useCallback)(function(){t.dragFreezeIntoColumn(n)},[n]);return t.frozenColumns.every(function(e){return 0===e.frozenSamplers.length})?(console.log("skipping frozen drag area"),i.a.createElement("div",null)):i.a.createElement("div",{onDrop:r,className:"frozen-drag-area"},i.a.createElement("div",{className:"text-drag"},"Drag Frozen Track Here"))})},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),a=function(e){var t=e.subSequence,n=e.setSelectedPadEdge;e.selectedElements;Object(r.useEffect)(function(){return window.addEventListener("keydown",a),function(){return window.removeEventListener("keydown",a)}},[t]);var a=Object(r.useCallback)(function(e){if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&"Backspace"===e.key){var r=t.sequencerEngine,a=r.state.pads.selectedEdge,i=r.state.windows.selectedElements;for(var o in i){var s=t.sequencerEngine.findNodeById(o);s&&s.subSequence===t&&(s.isDeletable&&!s.isDeletable()||(s.delete?s.delete():t.deleteNode(s)))}if(a){if(a.inlet){a.inlet;var c=a.outlet,u=t.sequencerEngine.findNodeById(c.destId),l=t.sequencerEngine.findNodeById(c.sourceId);u&&l&&u.disconnectInlet(c.destType,l,c.sourceType)}else{var f=t.pads.find(function(e){return e.effectRack.effects.includes(a.effect)||e.effectRack.outputNode===a.effect});f||(f=t.tracks.find(function(e){return e.effectRack&&(e.effectRack.effects.includes(a.effect)||e.effectRack.outputNode===a.effect)})),f.effectRack.deleteEdge(a)}n(void 0)}}},[t])}},function(e,t,n){"use strict";var r=n(8),a=n(99),i=n(0),o=n.n(i),s=n(86),c=n(29),u=n(167),l=n(382),f=n(203),h=n(540),p=n(636),d=n(260),m=n(6),v=n(12),b=new c.a;t.a=Object(v.b)(function(e,t){return{coords:e.windows.windowPositions[t.pad.effectRack.id],isCollapsed:e.effects.effectCollapsed[t.pad.effectRack.id],isSelected:e.windows.selectedElements[t.pad.effectRack.id],isMacroMapping:e.effects.isMacroMapping,hidden:e.spatial.hiddenObjects[t.pad.id]}},function(e,t){return{setParameterToMap:function(t){return e(Object(m.Td)(t))},setIsCollapsed:function(n){return e(Object(m.Tb)(t.pad.effectRack.id,n))}}})(function(e){var t=e.pad,n=e.setIsCollapsed,c=e.isCollapsed,m=e.coords,v=e.isSelected,g=Object(a.a)(e,["pad","setIsCollapsed","isCollapsed","coords","isSelected"]),y=Object(i.useRef)(void 0),k=Object(i.useRef)(void 0),O=t.fxMacro.macroParameter;Object(i.useEffect)(function(){n(t.effectRack.isCollapsed)},[]),Object(i.useEffect)(function(){t.effectRack.isCollapsed=c},[c]);var j=Object(f.a)({ref:y}),w=j.onContextMenu,E=j.dropdownPos,S=j.setDropdownPos,P=Object(i.useRef)({x:0,y:0}),x=Object(d.a)(Object(r.a)({ref:y,element:t.effectRack,windowPosition:m,sequencerEngine:t.sequencerEngine},g)),T=x.style,C=(x.isDragging,x.onMouseDown),N=x.onMouseUp;x.setCoords;Object(i.useEffect)(function(){m&&(P.current={x:m.x+100,y:m.y+50})},[m]);var R=Object(i.useCallback)(function(e){e.stopPropagation(),g.isMacroMapping&&(O.isMapped||g.setParameterToMap(O));var r=(new Date).getTime();e.stopPropagation(),r-k.current<=450&&(t.effectRack.isCollapsed=!c,n(!c)),k.current=r},[g.isMacroMapping,n,c]),M="pad-effect-control";c||(M+=" expanded"),v&&(M+=" selected");var A=Object(r.a)({},T,{backgroundColor:b.getColorForHash(t.effectRack.id)});return m&&(A.left=m.x,A.top=m.y),g.isMacroMapping&&(M+=" plane-mapping"),g.hidden?"":[o.a.createElement("div",{onClick:R,key:1,onContextMenu:function(e){w(e),x.onContextMenu(e)},onMouseDown:C,onMouseUp:N,ref:y,style:A,className:M},o.a.createElement("div",{className:"control-inner"},o.a.createElement(u.a,{color:"white",name:"",parameter:t.fxMacro.macroParameter}),o.a.createElement(l.a,{allowSendsOnly:!0,effectOptions:s.a,initializeEffect:s.b,addToBack:!1,dropdownPosRef:P,setDropdownPos:S,dropdownPos:E,node:t}),o.a.createElement(h.a,{containerRef:g.containerRef,pad:t,fx:t.effectRack}),!c&&o.a.createElement(p.a,{outputNumber:0,isControl:!0,containerRef:g.containerRef,pad:t,fx:t.effectRack}),o.a.createElement("div",{className:"control-name"},"FX")))]})},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return v}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return g});var r=n(5),a=n.n(r),i=n(14),o=n(47),s=n(31),c=n(40),u=n(761),l=n(65),f=n(70),h=n(44);function p(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=new u.a,v=function(){var t=Object(i.a)(a.a.mark(function t(n,r,i,s,c){var u,p,d,m,v,b,g,y;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=c.creatorShare,p=c.ownerShare,d=c.minterShare,console.log("JSON = ",n),t.next=4,o.a.addJson(n);case 4:return m=t.sent,v="https://zequencer.io/ipfs/"+m,b=JSON.stringify({description:i,mimeType:"text/json",image:"https://zequencer.io/ipfs/"+s,name:r}),t.next=9,o.a.addBuffer(e.from(b));case 9:g=t.sent,y=[r,v,g,Object(l.c)(m),[u,p,d]],console.log(y),new f.a(h.q,"createPlugin",y).execute();case 14:case"end":return t.stop()}},t)}));return function(e,n,r,a,i){return t.apply(this,arguments)}}(),b=function(){var t=Object(i.a)(a.a.mark(function t(n,r,i,s,c){var u,p,d,m;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.addJson(n);case 2:return u=t.sent,p="https://zequencer.io/ipfs/"+u,d=JSON.stringify({description:i,mimeType:"text/json",image:"https://zequencer.io/ipfs/"+s,name:r}),t.next=7,o.a.addBuffer(e.from(d));case 7:m=t.sent,new f.a(h.q,"updatePlugin",[c,p,m,Object(l.c)(u)]).execute();case 10:case"end":return t.stop()}},t)}));return function(e,n,r,a,i){return t.apply(this,arguments)}}(),g=function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,u,l,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new c.a(m.contractAddress).from(s.M),e.next=3,t.executeQuery();case 3:return n=e.sent,r=n.map(function(e){return e.tokenId||0}),i=new c.a(m.contractAddress).from(s.E).whereIn("tokenId",r),e.next=8,i.executeQuery();case 8:o=e.sent,u=p(o);try{for(f=function(){var e=l.value,t=e.tokenId,r=n.find(function(e){return e.tokenId===t});null===r.tokenId&&(r.tokenId=0),r.versions||(r.versions=[]),r.versions.push(e)},u.s();!(l=u.n()).done;)f()}catch(a){u.e(a)}finally{u.f()}return e.abrupt("return",n);case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}).call(this,n(27).Buffer)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(58),l=n(59),f=n(0),h=n.n(f),p=n(15),d=n.n(p),m=n(42);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var b=function(e){Object(o.a)(n,e);var t=v(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={updateRate:100,x:0,y:0},a}return Object(a.a)(n,[{key:"componentDidMount",value:function(){this.run()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"run",value:function(){var e=this;this.timer=setInterval(function(){e.setState(e.state)},this.state.updateRate)}},{key:"startDragging",value:function(e){this.setState({dragging:e}),this.props.setSelectedPoint(e)}},{key:"stopDragging",value:function(e){this.setState({dragging:void 0})}},{key:"onMouseMove",value:function(e){var t=this.ref.getPointerPosition(),n=t.x,r=t.y;if(this.setState({x:n,y:r}),void 0!==this.state.dragging){var a=this.getTimeForXPosition(n,this.state.dragging);"ATTACK"===this.state.dragging?(this.props.envelope.attack=a,this.props.envelope.level=this.getLevelForYPosition(r)):"DECAY"===this.state.dragging?(this.props.envelope.decay=a,this.props.envelope.sustain=this.getSustainForYPosition(r)):"SUSTAIN"===this.state.dragging?this.props.envelope.sustain=this.getSustainForYPosition(r):"RELEASE"===this.state.dragging&&(this.props.envelope.release=a),this.props.onEnvelopeUpdated()}}},{key:"getGuideLines",value:function(){for(var e=[],t=0,n=0;n<=20;n++)e.push(h.a.createElement(m.Line,{points:[t,0,t,400],stroke:"#1f1f1f",strokeWidth:1})),t+=32.5;e.push(h.a.createElement(m.Line,{points:[0,100,650,100],stroke:"#1f1f1f",strokeWidth:1})),e.push(h.a.createElement(m.Line,{points:[0,300,650,300],stroke:"#1f1f1f",strokeWidth:1})),t=32.5;for(var r=this.props.zoom,a=0;a<20;a+=2)e.push(h.a.createElement(m.Text,{text:r+" ms",fill:"white",fontSize:6,fontFamily:"Arial",x:t+2,y:390})),t+=65,r+=2*this.props.zoom;return e}},{key:"getAttackCurve",value:function(){var e=this.getXPositionForTime(this.props.envelope.attack),t=this.getYForLevel();if("linear"===this.attackCurve)return h.a.createElement(m.Line,{points:[0,200,e,t],strokeWidth:2,stroke:"#6200EE"});if("exponential"===this.attackCurve)return this.getExponentialCurve(0,200,e,t,!0);var n=d.a.Envelope.Type[this.attackCurve];return this.getExplicitCurve(n.In,0,200,e,t,!1)}},{key:"getExplicitCurve",value:function(e,t,n,r,a,i){for(var o=(r-t)/e.length,s=[],c=0;c<e.length;c++){var u=i?this.getYForSustain(e[c]*this.props.envelope.sustain):this.getYForLevel(e[c]*this.level);s.push(t),s.push(u),t+=o}return h.a.createElement(m.Line,{points:s,strokeWidth:2,stroke:"#6200EE"})}},{key:"getDecayCurve",value:function(){if("linear"===this.decayCurve)return h.a.createElement(m.Line,{points:[this.attackX,this.getYForLevel(),this.decayX,this.sustainY],strokeWidth:2,stroke:"#6200EE"});if("exponential"===this.decayCurve)return this.getExponentialCurve(this.attackX,this.getYForLevel(),this.decayX,this.sustainY);var e=d.a.Envelope.Type[this.decayCurve];return this.getExplicitCurve(e.Out,this.attackX,this.getYForLevel(),this.decayX,this.sustainY)}},{key:"getSustainCurve",value:function(){return h.a.createElement(m.Line,{points:[this.decayX,this.sustainY,this.sustainX,this.sustainY],strokeWidth:2,stroke:"#6200EE"})}},{key:"getReleaseCurve",value:function(){if("linear"===this.releaseCurve)return h.a.createElement(m.Line,{points:[this.sustainX,this.sustainY,this.releaseX,200],strokeWidth:2,stroke:"#6200EE"});if("exponential"===this.releaseCurve)return this.getExponentialCurve(this.sustainX,this.sustainY,this.releaseX,200);var e=d.a.Envelope.Type[this.releaseCurve];return this.getExplicitCurve(e.Out,this.sustainX,this.sustainY,this.releaseX,200,!0)}},{key:"getExponentialCurve",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=(2*e+n)/3;a&&(i=(4*n+e)/5);var o=((t+r)/2+r)/2;return a&&(o=(t+r)/2),h.a.createElement(m.Line,{points:[e,t,i,o,n,r],tension:.3,strokeWidth:2,stroke:"#6200EE"})}},{key:"getAttackPoint",value:function(){var e=this,t="ATTACK"===this.props.selectedPoint?"yellow":"black";return h.a.createElement(m.Circle,{onMouseDown:function(t){return e.startDragging("ATTACK")},onMouseUp:function(t){return e.stopDragging("ATTACK")},x:this.attackX,y:this.getYForLevel(),radius:5,stroke:"yellow",fill:t})}},{key:"getDecayPoint",value:function(){var e=this,t="DECAY"===this.props.selectedPoint?"yellow":"black";return h.a.createElement(m.Circle,{onMouseDown:function(t){return e.startDragging("DECAY")},onMouseUp:function(t){return e.stopDragging("DECAY")},x:this.decayX,y:this.sustainY,radius:5,stroke:"yellow",fill:t})}},{key:"getSustainPoint",value:function(){var e=this,t="SUSTAIN"===this.props.selectedPoint?"yellow":"black";return h.a.createElement(m.Circle,{onMouseDown:function(t){return e.startDragging("SUSTAIN")},onMouseUp:function(t){return e.stopDragging("SUSTAIN")},x:this.sustainX,y:this.sustainY,radius:5,stroke:"yellow",fill:t})}},{key:"getReleasePoint",value:function(){var e=this,t="RELEASE"===this.props.selectedPoint?"yellow":"black";return h.a.createElement(m.Circle,{onMouseDown:function(t){return e.startDragging("RELEASE")},onMouseUp:function(t){return e.stopDragging("RELEASE")},x:this.releaseX,y:200,radius:5,stroke:"yellow",fill:t})}},{key:"getADSRPoints",value:function(){return[this.getAttackPoint(),this.getDecayPoint(),this.getSustainPoint(),this.getReleasePoint()]}},{key:"render",value:function(){var e=this;return h.a.createElement("div",null,h.a.createElement(m.Stage,{ref:function(t){return e.ref=t},width:650,height:400,onMouseLeave:function(){return e.stopDragging()},onMouseUp:function(t){return e.stopDragging()}},h.a.createElement(m.Layer,null,h.a.createElement(m.Rect,{onMouseMove:function(t){return e.onMouseMove(t)},onMouseUp:function(t){return e.stopDragging()},x:0,y:0,height:400,width:650,fill:"black"}),this.getGuideLines(),h.a.createElement(m.Line,{points:[0,200,650,200],strokeWidth:2,stroke:"red"}),this.getAttackCurve(),this.getDecayCurve(),this.getSustainCurve(),this.getReleaseCurve(),this.getADSRPoints(),h.a.createElement(m.Text,{text:this.state.x+","+this.state.y,fill:"white",fontSize:6,fontFamily:"Arial",x:30,y:300}))))}},{key:"level",get:function(){return this.props.showLevel?this.props.envelope.level:1}},{key:"getYForSustain",value:function(e){return 200-400*(e*=this.level)/2}},{key:"sustainY",get:function(){return 200-400*(this.props.envelope.sustain*this.level)/2}},{key:"getYForLevel",value:function(){return 200-400*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.level)/2}},{key:"attackX",get:function(){return this.getXPositionForTime(this.props.envelope.attack)}},{key:"decayX",get:function(){return this.getXPositionForTime(this.props.envelope.decay)+this.attackX}},{key:"sustainX",get:function(){return this.attackX+this.decayX+100}},{key:"releaseX",get:function(){return this.sustainX+this.getXPositionForTime(this.props.envelope.release)}},{key:"getLevelForYPosition",value:function(e){if(!this.props.showLevel)return 1;var t=2*(400-e)/400-1;return t>1?1:t<-1?0:t}},{key:"getSustainForYPosition",value:function(e){var t=2*(400-e)/400-1;return this.props.showLevel||(t=Math.abs(t)),(t/=this.level)>1?1:t<0?0:t}},{key:"getTimeForXPosition",value:function(e,t){return"DECAY"===t?e-=this.attackX:"SUSTAIN"===t?e-=this.decayX:"RELEASE"===t&&(e-=this.sustainX),Math.max(0,e/32.5*this.props.zoom)}},{key:"getXPositionForTime",value:function(e){return 32.5*e/this.props.zoom}},{key:"isSynthEnvelope",get:function(){return"PITCH"!==this.props.envelopeType}},{key:"attackCurve",get:function(){return this.props.envelope.attackCurve}},{key:"decayCurve",get:function(){return this.props.envelope.decayCurve}},{key:"sustainCurve",get:function(){return this.props.envelope.sustainCurve}},{key:"releaseCurve",get:function(){return this.props.envelope.releaseCurve}}]),n}(f.Component),g=n(8),y=n(39),k=n.n(y);function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var j=function(e){Object(o.a)(n,e);var t=O(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"getOption",value:function(e){return this.getOptions().filter(function(t){return t.value===e})[0]}},{key:"getOptions",value:function(){var e=this,t=w;return"DECAY"===this.props.selectedPoint&&(t=w.filter(function(e){return"linear"===e.value||"exponential"===e.value})),t.map(function(t){return Object(g.a)({},t,{label:t.label+" "+e.props.selectedPoint.toLowerCase()})})}},{key:"onSelectOption",value:function(e){var t=e.value;"ATTACK"===this.props.selectedPoint?this.props.envelope.attackCurve=t:"DECAY"===this.props.selectedPoint?this.props.envelope.decayCurve=t:"RELEASE"===this.props.selectedPoint&&(this.props.envelope.releaseCurve=t),this.props.onUpdateEnvelopeCurve(e.value)}},{key:"envelope",get:function(){return"PITCH"===this.props.envelopeType?this.props.envelope.envelope.envelope:this.props.envelope.envelope}},{key:"curve",get:function(){var e=this.envelope;return"ATTACK"===this.props.selectedPoint?e.attackCurve:"DECAY"===this.props.selectedPoint?e.decayCurve:"RELEASE"===this.props.selectedPoint?e.releaseCurve:""}},{key:"render",value:function(){var e=this;return h.a.createElement("div",{className:"envelope-curve-dropdown-container"},h.a.createElement(k.a,{className:"envelope-curve-dropdown",controlClassName:"envelope-curve-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getOptions(),onChange:function(t){return e.onSelectOption(t)},value:this.getOption(this.curve),placeholder:"Curve"}))}}]),n}(f.Component),w=[{value:"linear",label:"Linear"},{value:"exponential",label:"Exponential"},{value:"sine",label:"Sine"},{value:"cosine",label:"Cosine"},{value:"bounce",label:"Bounce"},{value:"ripple",label:"Ripple"},{value:"step",label:"Step"}],E=j,S=n(90),P=n.n(S);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var T=200,C=function(e){Object(o.a)(n,e);var t=x(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={zoom:T,selectedPoint:"ATTACK"},a.onClickDone=a.onClickDone.bind(Object(i.a)(a)),a.onClickCancel=a.onClickCancel.bind(Object(i.a)(a)),a}return Object(a.a)(n,[{key:"updateZoom",value:function(e){this.setState({zoom:e.target.value})}},{key:"onClickDone",value:function(){this.props.hide()}},{key:"onClickCancel",value:function(){this.props.hide()}},{key:"onEnvelopeUpdated",value:function(){this.setState(this.state)}},{key:"setSelectedPoint",value:function(e){this.setState({selectedPoint:e})}},{key:"onUpdateEnvelopeCurve",value:function(e){this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.props.envelope,n=this.props.name||this.props.envelopeType+" Envelope";return h.a.createElement(u.a,{dialogClassName:"envelope-modal",show:this.props.show,onHide:this.onClickCancel},h.a.createElement(u.a.Header,{closeButton:!0},h.a.createElement(u.a.Title,null,n)),h.a.createElement(u.a.Body,null,h.a.createElement(b,{onEnvelopeUpdated:function(){return e.onEnvelopeUpdated()},envelopeType:this.props.envelopeType,setSelectedPoint:function(t){return e.setSelectedPoint(t)},selectedPoint:this.state.selectedPoint,showLevel:this.props.showLevel,zoom:this.state.zoom,envelope:this.props.envelope}),h.a.createElement("div",{className:"envelope-parameters-container"},h.a.createElement("div",null,h.a.createElement("div",null,"Zoom: ",this.state.zoom," ms"),h.a.createElement(P.a,{value:this.state.zoom,change:function(t){return e.updateZoom(t)},step:1,max:1e3,min:1,orientation:"horizontal",reversed:!1})),h.a.createElement("div",{className:"envelope-parameters"},h.a.createElement("div",null,h.a.createElement("span",{className:"envelope-parameter"},"Level:",h.a.createElement("span",{className:"envelope-value"},Math.round(100*t.level)/100)),h.a.createElement("span",{className:"envelope-parameter"},"Attack:",h.a.createElement("span",{className:"envelope-value"},Math.round(100*t.attack)/100)),h.a.createElement("span",{className:"envelope-parameter"},"Decay:",h.a.createElement("span",{className:"envelope-value"},Math.round(100*t.decay)/100)),h.a.createElement("span",{className:"envelope-parameter"},"Sustain:",h.a.createElement("span",{className:"envelope-value"},Math.round(100*t.sustain)/100)),h.a.createElement("span",{className:"envelope-parameter"},"Release:",h.a.createElement("span",{className:"envelope-value"},Math.round(100*t.release)/100))),h.a.createElement("div",null,h.a.createElement(E,{onUpdateEnvelopeCurve:function(t){return e.onUpdateEnvelopeCurve(t)},selectedPoint:this.state.selectedPoint,envelopeType:this.props.envelopeType,envelope:this.props.envelope}))))),h.a.createElement(u.a.Footer,null,h.a.createElement(l.b,{variant:"secondary",onClick:this.onClickDone},"Done"),h.a.createElement(l.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(f.Component);t.a=C},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12),f=n(11),h=n(6),p=n(39),d=n.n(p);function m(e){var t=e.sequencerEngine.resampleConfig,n=Object(c.useState)(t.samplesPerNote),r=Object(f.a)(n,2),a=(r[0],r[1]),i={label:t.samplesPerNote,value:t.samplesPerNote},o=Object(c.useCallback)(function(e){t.samplesPerNote=e,a(e)},[a]);return u.a.createElement("div",{className:"samples-per-note"},u.a.createElement("div",{className:"dropdown-label"},"Samples Per Note:"),u.a.createElement(d.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=[],n=1;n<=e;n++)t.push({label:n,value:n});return t}(),onChange:function(e){return o(e.value)},value:i,placeholder:"Samples per note"}))}function v(e){var t=Object(c.useState)(e.sequencerEngine.autoResampleMode),n=Object(f.a)(t,2),r=n[0],a=n[1],i=Object(c.useCallback)(function(){var t=e.sequencerEngine;if(r)return t.autoResampleMode=!1,t.store.dispatch(Object(h.Be)(!1)),void a(!1);t.autoResampleMode=!0,t.masterResampler.prepare(),t.store.dispatch(Object(h.Be)(!0)),a(!0)},[r,a]),o=r?"sample-synth-button sampling":"sample-synth-button";return u.a.createElement("div",{className:"resample-config"},u.a.createElement("div",{onClick:i,className:o},r?"Sample...":"Sample"),u.a.createElement(m,{sequencerEngine:e.sequencerEngine}))}var b=n(90),g=n.n(b);n(2441);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var k=function(e){Object(i.a)(n,e);var t=y(n);function n(e){var a;Object(r.a)(this,n);var i=void 0===(a=t.call(this,e)).props.track.midiChannel?"all":a.props.track.midiChannel;return a.state={midiChannel:i},a}return Object(a.a)(n,[{key:"onSelectMidiChannel",value:function(e){this.state.midiChannel=e.value,this.props.track.midiChannel=e.value,this.setState(this.state)}},{key:"updateLatency",value:function(e){this.props.track.latency=e,this.setState(this.state)}},{key:"onClick",value:function(){this.props.planeMapping&&this.props.planeMapping.randomlyMapParameters(this.props.track,void 0,this.props.track.ccParameters)}},{key:"render",value:function(){var e=this,t=this.props.track.sequencerEngine.midi;return u.a.createElement("div",{onClick:function(){return e.onClick()},className:this.props.planeMapping?"instrument plane-mapping external-instrument":"instrument external-instrument"},u.a.createElement("div",{className:"external-instrument-header"},"External Instrument"),u.a.createElement("div",{className:"inner-instrument"},u.a.createElement("div",{className:"midi-channel-container"},u.a.createElement("div",{className:"midi-channel"},"Channel: "),u.a.createElement(d.a,{className:"midi-input-dropdown",controlClassName:"midi-input-control-dropdown",options:j,onChange:function(t){return e.onSelectMidiChannel(t)},value:w(this.state.midiChannel),placeholder:"Midi Channel"})),u.a.createElement("div",{className:"midi-outputs-container"},t.getTrackedOutputs().map(function(t){return u.a.createElement(O,{track:e.props.track,output:t})})),u.a.createElement("div",null,u.a.createElement("div",null,"Latency: ",this.props.track.latency," ms"),u.a.createElement(g.a,{value:this.props.track.latency,change:function(t){return e.updateLatency(t.target.value)},step:1,max:100,min:1,orientation:"horizontal",reversed:!1})),u.a.createElement(v,{sequencerEngine:this.props.track.sequencerEngine})))}}]),n}(c.Component),O=function(e){Object(i.a)(n,e);var t=y(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"isEnabled",value:function(){return this.props.track.getMidiOutputs().has(this.props.output)}},{key:"onClickMidiOutput",value:function(){this.isEnabled()?this.props.track.deleteMidiOutput(this.props.output):this.props.track.addMidiOutput(this.props.output),this.setState(this.state)}},{key:"render",value:function(){var e=this;this.isEnabled();return u.a.createElement("div",{className:this.isEnabled()?"midi-option enabled":"midi-option",onClick:function(){return e.onClickMidiOutput()}},this.props.output.name)}}]),n}(c.Component),j=[{value:"all",label:"All"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"6"},{value:7,label:"7"},{value:8,label:"8"},{value:9,label:"9"},{value:10,label:"10"},{value:11,label:"11"},{value:12,label:"12"}];function w(e){for(var t=0;t<j.length;t++)if(j[t].value==e)return j[t];return null}t.a=Object(l.b)(function(e){return{planeMapping:e.effects.planeMapping}},null)(k)},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(7),u=n(10),l=n(1),f=n(0),h=n.n(f),p=(n(167),n(557)),d=n(11),m=n(12),v=n(6),b=Object(m.b)(function(e,t){return{}},function(e){return{setFreezeDragging:function(t){return e(Object(v.pc)(t))},setSampleDragging:function(t){return e(Object(v.He)(t))}}})(function(e){var t=e.sample,n=e.setFreezeDragging,r=e.setSampleDragging,a=Object(f.useRef)(void 0),i=Object(f.useState)(t.name),o=Object(d.a)(i,2),s=o[0],c=o[1],u=Object(f.useState)(!1),l=Object(d.a)(u,2),p=l[0],m=l[1],v=Object(f.useCallback)(function(){if(!p){var e=(new Date).getTime();a.current&&e-a.current<=200&&m(!0),a.current=e}},[p,m]),b=Object(f.useCallback)(function(e){"Enter"===e.key&&(t.name=s,m(!1))},[m,t,s]);return h.a.createElement("div",{draggable:!0,onDragStart:function(){console.log("drag start setting sample dragging=",t),r(t),n(t.ipfsHash)},onDragOver:function(e){return e.preventDefault()},onClick:v,className:"freeze-name"},p?h.a.createElement("input",{type:"text",value:s,onKeyDown:b,onChange:function(e){return c(e.target.value)},className:"freeze-name-edit"}):s)}),g=Object(m.b)(function(e,t){var n=t.track.sequencerEngine.getSequenceId(),r=(e.sequencer.currentStep[n],e.sequencer.currentGlobalStep[n]||0),a=e.tracks.frozenTracksPlaying[t.track.subSequence.id]||{},i=e.tracks.isResampling===t.track.trackNumber,o=t.column.playing===t.number,s=e.tracks.trackToFreeze&&e.tracks.trackToFreeze.trackNumber===t.track.trackNumber,c=(e.tracks.tracksFrozen[t.track.subSequence.id]||{})[t.track.id];return{oldPlaying:a[t.track.id],isSelected:e.freeze.selectedFreeze===t.sample.ipfsHash,isPlaying:o,currentGlobalStep:(o||s||i)&&r,isPreparingToFreeze:s,isResampling:i,frozenPatternPlaying:t.column.playing,isTrackFrozen:c}},function(e,t){return{setSelectedFreeze:function(t){return e(Object(v.Ye)(t))},setFreezeDragging:function(t){return e(Object(v.pc)(t))},setPlaying:function(n){return e(Object(v.qc)(t.track.subSequence.id,t.track.id,n))}}})(function(e){e.oldPlaying;var t=e.sample,n=(e.setSampleDragging,e.setFreezeDragging,e.isTrackFrozen),r=e.color,a=e.isSelected,i=e.track,o=e.isPlaying,s=e.setSelectedFreeze,c=e.currentGlobalStep,u=e.column,l=e.number,d=Object(f.useCallback)(function(){n?u.playing=o?void 0:l:u.saveAndPlayFrozen(l)},[o,n,l]),m="";if(o){for(var v=c%i.pattern.length()/i.pattern.length(),g=[],y=0;y<16;y++)v>1*y/16&&g.push(y);var k={backgroundColor:r};m=h.a.createElement("div",{className:"frozen-progress"},g.map(function(e,t){return h.a.createElement("div",{key:t,style:k,className:"progress-part"})}))}var O="frozen-container";return a&&(O+=" selected"),h.a.createElement("div",{onClick:function(){return s(t.ipfsHash)},style:{backgroundColor:r},className:O},h.a.createElement(p.a,{play:function(e){return d()},isPlaying:o}),m,h.a.createElement(b,{sample:t}))});n(38),n(2438);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var k=function(e){Object(c.a)(n,e);var t=y(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getProgress",value:function(e){var t=this.props.currentGlobalStep%this.props.track.length/this.props.track.length,n=[];if(this.props.isPreparingToFreeze||this.props.isResampling)for(var r=0;r<16;r++)t>1*r/16&&n.push(r);var a={backgroundColor:this.props.color};return h.a.createElement("div",{className:"frozen-progress"},n.map(function(e){return h.a.createElement("div",{style:a,className:"progress-part"})}))}},{key:"expandSample",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"play",value:function(e,t){this.props.isTrackFrozen?(this.props.column.playing===t?this.props.setPlaying(!this.props.isPlaying):this.props.setPlaying(!0),this.props.column.playing=t):this.props.column.saveAndPlayFrozen(t)}},{key:"onDrop",value:function(e){e.stopPropagation(),this.props.freezeDragging&&this.props.track.dragFreezeIntoColumn(this.props.freezeDragging,this.props.column)}},{key:"render",value:function(){var e=this,t=this.props.column.frozenSamples;return h.a.createElement("div",{onDrop:function(t){return e.onDrop(t)},className:"frozen-containers"},t.map(function(t,n){return h.a.createElement(g,{key:t.id,column:e.props.column,frozenPatternPlaying:e.props.frozenPatternPlaying,number:n,color:e.props.color,track:e.props.track,sample:t})}),0===this.props.number&&(this.props.isPreparingToFreeze||this.props.isResampling)?h.a.createElement("div",{className:"frozen-container"},h.a.createElement("div",{className:"freezing-label"},"Freezing"),this.getProgress()):"")}}]),n}(f.Component);t.a=Object(m.b)(function(e,t){var n=t.track.sequencerEngine.getSequenceId(),r=(e.sequencer.currentStep[n],e.sequencer.currentGlobalStep[n]||0),a=(e.tracks.frozenTracksPlaying[t.track.subSequence.id],e.tracks.isResampling===t.track.trackNumber),i=e.tracks.trackToFreeze&&e.tracks.trackToFreeze.trackNumber===t.track.trackNumber,o=(e.tracks.tracksFrozen[t.track.subSequence.id]||{})[t.track.id];return{currentGlobalStep:(i||a)&&r,isPreparingToFreeze:i,isResampling:a,frozenSamplePlaying:t.column.playing,showPlayButton:!0,isTrackFrozen:o,selectedFreeze:e.freeze.selectedFreeze,freezeDragging:e.freeze.freezeDragging,frozenSamples:e.freeze.freezeColumnSamples[t.track.id]&&e.freeze.freezeColumnSamples[t.track.id][t.column.number]}},function(e,t){return{setPlaying:function(n){return e(Object(v.qc)(t.track.subSequence.id,t.track.id,n))}}})(k)},function(e,t,n){"use strict";var r=n(8),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(242),l=n.n(u),f=n(94),h=n(52),p=n(6),d=n(386),m=n(30),v=function(){function e(t){Object(s.a)(this,e),this.store=t,this.masterKey=void 0,this.masterPublicKey=void 0,this.promptingPassword=!1}return Object(c.a)(e,[{key:"needsPassword",value:function(){return void 0===this.masterPublicKey}},{key:"password",set:function(e){void 0!==e&&(this.masterKey=l.a.generateRSAKey(e,1024),this.masterPublicKey=l.a.publicKeyString(this.masterKey),h.a.getAccount().then(function(t){window.isNFT||f.a.setItem("user_password."+t,e)}))}},{key:"isCorrectPassword",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.encryption.getPublicKey();case 2:if(void 0!==(n=e.sent)){e.next=5;break}return e.abrupt("return",!0);case 5:return r=l.a.generateRSAKey(t,1024),a=l.a.publicKeyString(r),o=n===a,e.abrupt("return",o);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"syncPassword",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.masterPublicKey){e.next=4;break}return e.next=3,this.getPassword();case 3:this.password=e.sent;case 4:t=this.getPublicKeyAsBytes32(),m.a.encryption.newPublicKey(t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getPublicKeyAsBytes32",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.masterPublicKey,t=m.a.web3.utils.toHex(e);return Object(d.a)(t)}},{key:"sleep",value:function(e){return new Promise(function(e,t){e()},e)}},{key:"getPassword",value:function(){var e=this;return this.passwordPromise?this.passwordPromise:(this.passwordPromise=new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){var a,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e.masterPublicKey){t.next=3;break}return n(void 0),t.abrupt("return");case 3:return t.next=5,h.a.getAccount();case 5:if(a=t.sent,window.isNFT||null===f.a.getItem("user_password."+a)){t.next=12;break}if(o=f.a.getItem("user_password."+a),!e.isCorrectPassword(o)){t.next=12;break}return e.password=o,n(o),t.abrupt("return");case 12:e.store.dispatch(Object(p.Vd)(function(t){void 0!==t?(e.password=t,n(t)):e.passwordPromise=void 0})),e.store.dispatch(Object(p.Vf)(!0));case 14:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),this.passwordPromise)}},{key:"getPublicKeyIfNeeded",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=6;break}if(void 0!==this.masterPublicKey){e.next=5;break}return e.next=4,this.getPassword();case 4:this.password=e.sent;case 5:t=this.masterPublicKey;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPrivateKeyIfNeeded",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=6;break}if(void 0!==this.masterKey){e.next=5;break}return e.next=4,this.getPassword();case 4:this.password=e.sent;case 5:t=this.masterKey;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),b=n(297),g=n(259),y=n.n(g),k=n(47),O=function(){function e(t,n){Object(s.a)(this,e),this.ethereum=t,this.web3=this.ethereum.web3,this.passwordManager=new v(n),this.store=n}return Object(c.a)(e,[{key:"store",set:function(e){this.passwordManager.store=e}},{key:"needsPassword",value:function(){return this.passwordManager.needsPassword()}},{key:"password",set:function(e){this.passwordManager.password=e}},{key:"syncPassword",value:function(){var e=Object(o.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.passwordManager.syncPassword();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"isCorrectPassword",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.passwordManager.isCorrectPassword(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPassword",value:function(){var e=Object(o.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.passwordManager.getPassword();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"masterPublicKey",get:function(){return this.passwordManager.masterPublicKey},set:function(e){this.passwordManager.masterPublicKey=e}},{key:"masterKey",get:function(){return this.passwordManager.masterKey}},{key:"parseGuildKey",value:function(e){var t=e.privateKey,n=l.a.RSAKey.parse(JSON.stringify(t));return Object(r.a)({},e,{privateKey:n})}},{key:"generateGuildKey",value:function(e){var t=l.a.generateRSAKey(e,1024),n=l.a.publicKeyString(t),r=this.ethereum.web3.utils.toHex(n);return{publicKey:Object(d.a)(r),rawPublicKey:n,privateKey:t,passphrase:e}}},{key:"encryptAndSave",value:function(e,t,n){var r=this;!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise(function(){var a=Object(o.a)(i.a.mark(function a(s,c){var u,l,f;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.passwordManager.getPublicKeyIfNeeded(r.masterPublicKey);case 2:if(a.sent,(u=new b.a).encryptKey(r.masterPublicKey),!n){a.next=10;break}return a.next=8,r.ethereum.encryption.getEncryptedSequenceIfAny(n);case 8:void 0!==(l=a.sent)&&l[0].contentKey&&(u=new b.a(y.a.utils.hex.toBytes(u)));case 10:return a.next=12,u.encryptContent(JSON.stringify(t));case 12:f=a.sent,k.a.addJson(f).then(function(){var t=Object(o.a)(i.a.mark(function t(a){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=r.ethereum.encryption,t.t1=n,t.t2=a,t.next=5,u.encryptContent(e);case 5:t.t3=t.sent,t.t4=u.convertForEthereum(),t.t5=r.passwordManager.getPublicKeyAsBytes32(),t.t0.newEncryptedSequence.call(t.t0,t.t1,t.t2,t.t3,t.t4,t.t5),s(a);case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 14:case"end":return a.stop()}},a)}));return function(e,t){return a.apply(this,arguments)}}())}},{key:"encryptRawContent",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o,s=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:this.masterPublicKey,a=s.length>3&&void 0!==s[3]&&s[3],o=s.length>4?s[4]:void 0,e.next=5,this.passwordManager.getPublicKeyIfNeeded(r);case 5:return r=e.sent,void 0===o&&(o=new b.a),o.encryptKey(r),e.t0=this.passwordManager.getPublicKeyAsBytes32(r),e.t1=o.convertForEthereum(),e.t2=o,e.next=13,o.encryptContent(t,a);case 13:return e.t3=e.sent,e.next=16,o.encryptContent(n);case 16:return e.t4=e.sent,e.t5=o.encryptedContentKey,e.abrupt("return",{publicKey:e.t0,encryptedContentKey:e.t1,contentKey:e.t2,encryptedContent:e.t3,encryptedName:e.t4,eCk:e.t5});case 19:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"encryptAndUploadJSON",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.masterPublicKey;return new Promise(function(){var r=Object(o.a)(i.a.mark(function r(a,o){var s;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.encryptRawContent(JSON.stringify(e),"",n);case 2:s=r.sent,k.a.addJson(s.encryptedContent).then(function(e){return a({publicKey:s.publicKey,encryptedContentKey:s.encryptedContentKey,encryptedContentIpfsHash:e,contentKey:s.contentKey})});case 4:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}},{key:"decryptName",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n,r){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t){e.next=2;break}return e.abrupt("return","");case 2:return e.next=4,this.passwordManager.getPrivateKeyIfNeeded(r);case 4:return r=e.sent,y.a.utils.hex.toBytes(t),e.next=8,this.decryptContentKey(n,r);case 8:if(void 0!==(a=e.sent)){e.next=11;break}return e.abrupt("return","");case 11:return e.next=13,a.decryptContent(t);case 13:return t=e.sent,e.abrupt("return",t);case 15:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"decryptContentKey",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.passwordManager.getPrivateKeyIfNeeded(n);case 2:if(n=e.sent,r=this.web3.utils.toAscii("0x"+t),"failure"!==(a=l.a.decrypt(r,n)).status){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.abrupt("return",new b.a(a.plaintext));case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchAndDecrypt",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o,s,c,u,l=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=l.length>2&&void 0!==l[2]&&l[2],a=l.length>3?l[3]:void 0,new Date,void 0!==n.length&&(n=n[0]),o=n.contentKey,!r){e.next=11;break}return e.next=8,k.a.getSound(t);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,k.a.getJson(t,void 0,a,!0);case 13:e.t0=e.sent;case 14:return s=e.t0,e.next=17,this.passwordManager.getPrivateKeyIfNeeded();case 17:return c=new b.a(o),e.next=20,c.decryptContent(s,r);case 20:return u=e.sent,e.abrupt("return",u);case 22:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"stripHexPrefix",value:function(e){return 0===e.indexOf("0x")?e.slice(2):e}},{key:"strip",value:function(e,t){return e.slice(0,e.length-t)}},{key:"getPublicKeyFromBytes32",value:function(e){var t="0x";for(var n in e)t+=this.stripHexPrefix(e[n]);return t=this.strip(t,38),this.ethereum.web3.utils.toAscii(t)}},{key:"shareSequence",value:function(e,t){var n=this;return new Promise(function(){var r=Object(o.a)(i.a.mark(function r(a,o){var s,c;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.ethereum.encryption.getPublicKey(t);case 2:if(void 0!==(s=r.sent)){r.next=6;break}return o("User has no public key"),r.abrupt("return");case 6:c=l.a.encrypt(e.contentKey,s).cipher,c=n.web3.utils.toHex(c),n.ethereum.encryption.shareEncryptedContent(t,e.id,Object(d.a)(c),n.passwordManager.getPublicKeyAsBytes32()),a();case 10:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}}]),e}();t.a=O},function(e,t,n){"use strict";var r=n(8),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(362),l=n(290),f=n(765),h=(n(289),n(70)),p=n(44),d=n(47),m=n(65);function v(e,t){var n=new Set,r=Array.from(e);for(var a in r)t.has(r[a])&&n.add(r[a]);return n}var b=n(40),g=n(31),y=n(36),k=(window.web3,new u.a),O=y.a.utils.padLeft("0x0",64),j=function(){function e(t,n,r){Object(s.a)(this,e),this.web3=t,this.contract=new t.eth.Contract(k.abi,k.contractAddress),this.crypto=n,this.guilds=r,this.queryDecryptor=new f.a(this.crypto)}return Object(c.a)(e,[{key:"getPresetData",value:function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=4;break}return e.next=3,d.a.getJson(t);case 3:return e.abrupt("return",e.sent);case 4:if(0!==t.guildId&&null!==t.guildId&&void 0!==t.guildId){e.next=8;break}return e.next=7,d.a.getJson(t.contentHash);case 7:return e.abrupt("return",e.sent);case 8:return e.t0=JSON,e.next=11,this.crypto.fetchAndDecrypt(t.contentHash,t);case 11:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPresetTitle",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new b.a(this.contract.options.address).from(g.F).select("encryptedName").where("contentHash",t),e.next=3,n.executeQuery();case 3:if(0!==(r=e.sent).length){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.abrupt("return",this.web3.utils.toAscii("0x"+r[0].encryptedName));case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"newPreset",value:function(e,t,n,r,a){var s=this;k.getContract(y.a);return Object(l.a)(),new Promise(function(){var c=Object(o.a)(i.a.mark(function o(c,u){var l,f,v,b,g;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(l=void 0,f=new Array(9).fill(O),v=new Array(6).fill(O),0===a){i.next=18;break}return i.next=6,s.guilds.getGuildKey(a);case 6:return b=i.sent,i.next=9,s.crypto.encryptRawContent(JSON.stringify(e),t,b.rawPublicKey);case 9:return g=i.sent,i.next=12,d.a.addJson(g.encryptedContent);case 12:l=i.sent,t=s.web3.utils.padLeft("0x"+g.encryptedName,64),f=g.encryptedContentKey,v=b.publicKey,i.next=22;break;case 18:return t=s.web3.utils.fromAscii(t),i.next=21,d.a.addJson(e);case 21:l=i.sent;case 22:n=void 0===n?O:Object(m.c)(n),r=void 0===r?O:y.a.utils.fromAscii(r),console.log("newPreset guildId =",a),new h.a(p.i,"newPreset",[Object(m.c)(l),t,n,r,a,f,v]).execute(),c(l);case 27:case"end":return i.stop()}},o)}));return function(e,t){return c.apply(this,arguments)}}())}},{key:"tagPreset",value:function(e,t,n){null!==n&&void 0!==n||(n=0);k.getContract(y.a);return new Promise(function(){var r=Object(o.a)(i.a.mark(function r(a,o){var s;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:for(s=t.map(function(e){return y.a.utils.padRight(y.a.utils.fromAscii(e),64)});s.length<4;)s.push(O);s.length>4&&(s=s.slice(0,4)),new h.a(p.i,"tagPreset",[Object(m.c)(e),s,n]).execute().then(function(){return a()});case 4:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}},{key:"getTotalPresets",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new b.a(this.contract.options.address).from(g.F).select("user").select("title").select("contentHash"),e.next=3,t.executeQuery();case 3:return n=e.sent,e.abrupt("return",n.length);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getPresets",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPaginatedPresets(0,t,1e3,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getPaginatedPresets",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var a,o,s,c,u,l,f,h=this,p=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.length>2&&void 0!==p[2]?p[2]:10,o=p.length>3&&void 0!==p[3]?p[3]:0,s=new b.a(this.contract.options.address).from(g.F).select("user").select("encryptedName").select("contentHash").select("encryptedContentKey").select("publicKey").select("guildId").where("guildId",o),e.next=5,s.executeQuery();case 5:if(c=e.sent,this.isFilterEmpty(n)){e.next=10;break}return e.next=9,this.filterPresets(c,n);case 9:c=e.sent;case 10:if(0===o){e.next=28;break}return e.next=13,this.guilds.getGuildKey(o);case 13:u=e.sent,l=[],e.t0=i.a.keys(c);case 16:if((e.t1=e.t0()).done){e.next=25;break}return f=e.t1.value,e.t2=l,e.next=21,this.queryDecryptor.decryptQueryResult(c[f],u.privateKey);case 21:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=16;break;case 25:c=l,e.next=29;break;case 28:c=c.map(function(e){return Object(r.a)({},e,{title:h.web3.utils.toAscii("0x"+e.encryptedName)})});case 29:if(!(c.length<=t+a)){e.next=31;break}return e.abrupt("return",c.slice(t));case 31:return e.abrupt("return",c.slice(t,t+a));case 32:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"isFilterEmpty",value:function(e){for(var t in e.instrumentTypes)if(e.instrumentTypes[t])return!1;for(var n in e.tags)if(e.tags[n])return!1;return!0}},{key:"getPresetSampleHash",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new b.a(this.contract.options.address).from(g.O).select("sampleHash").where("contentHash",t),e.next=3,n.executeQuery();case 3:if(0!==(r=e.sent).length){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.abrupt("return",r[0].sampleHash);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPresetInstrumentType",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new b.a(this.contract.options.address).from(g.N).select("instrumentType").where("contentHash",t),e.next=3,n.executeQuery();case 3:if(0!==(r=e.sent).length){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.abrupt("return",r[0].instrumentType);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAllTags",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o,s,c=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:0,!this.isFilterEmpty(t)){e.next=5;break}return e.next=4,this.getFilteredTags(void 0,void 0,n);case 4:return e.abrupt("return",e.sent);case 5:return e.next=7,this.getPresets(t,n);case 7:r=e.sent,a=[],e.t0=i.a.keys(r);case 10:if((e.t1=e.t0()).done){e.next=18;break}return o=e.t1.value,e.next=14,this.getTags(r[o].contentHash);case 14:(s=e.sent)&&(a=a.concat(s)),e.next=10;break;case 18:return e.abrupt("return",Array.from(new Set(a)));case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getFilteredTags",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o,s=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:0,a=new b.a(this.contract.address).from(g.P).where("guildId",r).select("tag"),void 0!==n&&a.where(t,n),e.next=5,a.executeQuery();case 5:return o=(o=e.sent).map(function(e){return e.tag}).filter(function(e){return""!==e}),e.abrupt("return",Array.from(new Set(o)));case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTags",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new b.a(this.contract.address).from(g.P).select("tag").where("contentHash",t),e.next=3,n.executeQuery();case 3:return(r=(r=e.sent).map(function(e){return e.tag}).filter(function(e){return""!==e})).sort(),e.abrupt("return",Array.from(new Set(r)));case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"filterPresets",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o,s,c,u,l,f,h,p,d,m,y,k,O;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new Set,a=new Set,!n.instrumentTypes){e.next=15;break}e.t0=i.a.keys(n.instrumentTypes);case 4:if((e.t1=e.t0()).done){e.next=15;break}if(o=e.t1.value,n.instrumentTypes[o]){e.next=8;break}return e.abrupt("continue",4);case 8:return s=new b.a(this.contract.address).from(g.N).select("contentHash").where("instrumentType",o),e.next=11,s.executeQuery();case 11:for(u in c=e.sent)for(f in l=c[u].contentHash,t)t[f].contentHash===l&&r.add(t[f].contentHash);e.next=4;break;case 15:if(!n.tags){e.next=28;break}e.t2=i.a.keys(n.tags);case 17:if((e.t3=e.t2()).done){e.next=28;break}if(h=e.t3.value,n.tags[h]){e.next=21;break}return e.abrupt("continue",17);case 21:return p=new b.a(this.contract.address).from(g.P).select("contentHash").where("tag",h),e.next=24,p.executeQuery();case 24:for(m in d=e.sent)for(k in y=d[m].contentHash,t)t[k].contentHash===y&&a.add(t[k].contentHash);e.next=17;break;case 28:if(0!==r.size){e.next=32;break}return e.abrupt("return",this.convertToPresets(Array.from(a),t));case 32:if(0!==a.size){e.next=34;break}return e.abrupt("return",this.convertToPresets(Array.from(r),t));case 34:return O=Array.from(v(r,a)),e.abrupt("return",this.convertToPresets(O,t));case 36:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"convertToPresets",value:function(e,t){var n=[];for(var r in e)for(var a in t)t[a].contentHash===e[r]&&n.push(t[a]);return n}},{key:"getAllUserAddresses",value:function(){var e=Object(o.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}]),e}();t.a=j},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(46),s=n(69),c=n(29),u=n(12),l=n(6),f=n(354),h=new c.a;t.a=Object(u.b)(function(e,t){var n=e.sequencer.sequencerEngine;return n?{sequencerEngine:n}:{}},function(e){return{setSampleDragging:function(t){return e(Object(l.He)(t))},setPresetDragging:function(t){return e(Object(l.re)(t))}}})(function(e){var t=e.isCurrent,n=e.sample,c=e.preset,u=e.onDelete,l=e.setSampleDragging,p=e.setPresetDragging,d=e.sequencerEngine,m=e.setIsCurrent,v=e.isSelected,b=e.isEditing,g=void 0===b||b,y=void 0,k=Object(a.useRef)(!1);y=n?n.name:c.title;var O=Object(a.useState)(void 0),j=Object(r.a)(O,2),w=j[0],E=j[1];Object(a.useEffect)(function(){return t?(w&&w.playSound(),window.addEventListener("keydown",S)):(window.removeEventListener("keydown",S),w&&w.stopSound()),function(){return window.removeEventListener("keydown",S)}},[t,w,n]);var S=Object(a.useCallback)(function(e){t&&("Enter"===e.key&&w&&n?d.addSound(n):"Backspace"===e.key&&w&&w.stopSound())},[w,n,t]);Object(a.useEffect)(function(){if(n){var e=void 0;return n.audioBuffer?((e=new f.a).setBuffer(n.audioBuffer),E(e)):n.load().then(function(){(e=new f.a).setBuffer(n.audioBuffer),E(e)}),function(){return e?e.dispose():0}}},[]);var P=Object(a.useCallback)(function(){w&&(w.playSound(),k.current=!0,m())},[w]),x=Object(a.useCallback)(function(e){if(c&&!e){var t=d.getSelectedTrack();t&&function(e){return e.instrument&&e.instrument.getInstrumentType()===s.f}(t)?d.operationManager.dispatch(Object(o.d)(c,t,!0,!1)):d.loadPreset(c,!0)}w&&(w.stopSound(),k.current=!1)},[w,c]),T={},C=n&&n.getThumbnail(),N="pack-content";C?T.backgroundImage="url("+C+")":n?T.backgroundColor=h.getColorForHash(n.getId()):(N+=" preset",T.backgroundColor=h.getColorForHash(y));var R=n?n.tags.slice(0,1):[];return t&&(N+=" current"),v&&(N+=" selected"),y?i.a.createElement("div",{draggable:!g,onDragOver:function(e){return e.preventDefault()},onDragStart:function(){c?p(c):l(n)},onMouseDown:P,onMouseUp:function(){return x(!1)},onMouseLeave:function(){return x(!0)},className:N},i.a.createElement("div",{className:"content-thumb",style:T}),i.a.createElement("div",{className:"content-name"},y.trim()),i.a.createElement("div",{className:"content-tags"},R.map(function(e){return i.a.createElement("div",{className:"content-tag"},e)})),i.a.createElement("div",{onClick:function(e){return e.stopPropagation()},onMouseDown:function(e){e.stopPropagation(),u(n||c)},className:"delete-btn"},"x")):""})},function(e,t,n){"use strict";var r=n(9),a=n(0),i=n.n(a),o=n(83),s=n(12),c=(n(522),n(29));function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}new c.a;var f=Object(a.memo)(function(e){var t=e.effect,n=e.cycle,r=e.total,s=e.parts,c=Object(a.useRef)(void 0);Object(a.useEffect)(function(){return s.current[n.id]||(s.current[n.id]=[]),s.current[n.id].push(c),function(){s.current[n.id]&&(s.current[n.id]=s.current[n.id].filter(function(e){return e!==c}))}},[n,s]);var l={width:r+"%"},h=0,p=Object(a.useCallback)(function(e){return"object"===typeof e?Math.max(1,Math.floor(t.var(e.name)())):Math.floor(e)},[t]),d="tidal-part";if(Array.isArray(n)){var m,v=u(n);try{for(v.s();!(m=v.n()).done;){var b=m.value;b&&(h+="*"===b.operator||"^"===b.operator?p(b.operand):1)}}catch(O){v.e(O)}finally{v.f()}}else if(n.cycle&&Array.isArray(n.cycle)){var g,y=u(n.cycle);try{for(y.s();!(g=y.n()).done;){var k=g.value;k&&(h+="^"===k.operator||"*"===k.operator?p(k.operand):1)}}catch(O){y.e(O)}finally{y.f()}}else null===n.transpose&&(d+=" rest"),null!==n.transpose&&(l.filter="hue-rotate("+window.hrotate*n.transpose+"deg)");return i.a.createElement("div",{ref:c,style:l,className:d},Array.isArray(n.cycle||n)?(n.cycle||n).filter(function(e){return e}).map(function(e,n){return"*"===e.operator||"^"===e.operator?new Array(p(e.operand)).fill(0).map(function(r,a){return i.a.createElement(f,{effect:t,key:n+"-"+a,parts:s,cycle:e,total:100/h})}):i.a.createElement(f,{parts:s,effect:t,key:n,cycle:e,total:100/h})}):i.a.createElement("span",null,Object(o.f)(n,!0)))}),h=f;new c.a;window.hrotate=4;t.a=Object(s.b)(function(e,t){return{cycle:t.effect.cycle,currentCycles:t.effect.currentCycles}},function(e){return{}})(function(e){var t=e.effect,n=e.cycle,o=e.currentCycles,s=Object(a.useRef)({}),c=Object(a.useRef)([]);return Object(a.useEffect)(function(){if(o){var e=s.current;for(var t in c.current.forEach(function(e){e.current&&e.current.style&&(e.current.style.borderBottom="none")}),c.current=[],o)e[t]&&(e[t].forEach(function(e){e.current&&e.current.style&&(e.current.style.borderBottom="1px solid white")}),c.current=[].concat(Object(r.a)(c.current),Object(r.a)(e[t])))}},[o]),i.a.createElement("div",{className:"tidal-visualizer"},i.a.createElement(h,{parts:s,effect:t,cycle:n,total:100}))})},,,,,,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12),f=n(164),h=n.n(f);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){return 0===this.props.numPending?u.a.createElement("div",null):u.a.createElement("div",{className:"pending-transactions"},"Syncing ",this.props.numPending," items",u.a.createElement(h.a,{sizeUnit:"px",size:8,color:"#6200ff",loading:!0}))}}]),n}(c.Component);t.a=Object(l.b)(function(e,t){return{numPending:e.transactions.pendingTransactions.length}},null)(d)},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(1031),f=n(12),h=n(34),p=n(904);n(2436);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var m=function(e){Object(i.a)(n,e);var t=d(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"getContextualHelp",value:function(){var e=this.props.contextualHelp;if(!e)return void 0!==this.props.sequencerEngine?this.props.padMappings&&Object.keys(this.props.padMappings).length>0?u.a.createElement(l.a,{mini:!0,sequencerEngine:this.props.sequencerEngine,keyboardEngine:this.props.sequencerEngine.keyboardEngine}):u.a.createElement(p.a,Object.assign({},this.props,{helper:!0,mini:!0,sequencerEngine:this.props.sequencerEngine,keyboardEngine:this.props.sequencerEngine.keyboardEngine})):"";var t=e.element,n=e.arg,r=h.z[t];if("function"===typeof r&&(r=r(n)),void 0!==r)return Array.isArray(r)||(r=[r]),r.map(function(e,t){return u.a.createElement("div",{key:t,className:0===t?"doc-line":"rest doc-line"},e)});if(t.documentation){var a=t.prettyName||t.name;return Array.isArray(t.documentation)?u.a.createElement("div",null,t.documentation.map(function(e,t){return u.a.createElement("div",{key:t,className:0===t?"doc-line":"rest doc-line"},0===t?a+": "+e:e)})):a+": "+t.documentation}}},{key:"render",value:function(){var e=void 0===this.props.contextualHelp?"contextual-help empty":"contextual-help text";return u.a.createElement("div",{className:e},this.getContextualHelp())}}]),n}(c.Component);t.a=Object(f.b)(function(e){return{contextualHelp:e.sequencer.contextualHelp,padMappings:e.keyboard.padMappings}},null)(m)},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(20),u=n(7),l=n(10),f=n(1),h=n(58),p=n(6),d=n(59),m=n(38),v=n(52),b=n(0),g=n.n(b),y=n(12),k=(n(459),n(30)),O=n(841),j=n.n(O);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var E=function(e){Object(u.a)(n,e);var t=w(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={username:"",password:"",loginFailed:!1},r.onClickDone=r.onClickDone.bind(Object(c.a)(r)),r.onClickCancel=r.onClickCancel.bind(Object(c.a)(r)),r}return Object(s.a)(n,[{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"onClickDone",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.signingUp){e.next=4;break}v.a.signUp(this.state.userName,this.state.password),e.next=12;break;case 4:return e.next=6,v.a.login(this.state.userName,this.state.password);case 6:if(e.sent){e.next=10;break}return this.setState({loginFailed:!0}),e.abrupt("return");case 10:this.props.transactionUponLogin&&(this.props.transactionUponLogin.execute(),this.props.clearTransactions()),k.a.guilds.acceptAnyNewRequests();case 12:this.setState({loginFailed:!1}),this.props.hide();case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickCancel",value:function(){this.props.setSigningUp(!1),this.props.hide()}},{key:"render",value:function(){var e=this;return g.a.createElement(h.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},g.a.createElement(h.a.Header,{closeButton:!0},g.a.createElement(h.a.Title,null,this.props.signingUp?"Sign Up":"Log In")),g.a.createElement(h.a.Body,null,g.a.createElement(m.a,{condition:this.state.loginFailed},"The username/password you entered was incorrect. Please try again."),g.a.createElement(m.a,{condition:this.props.transactionUponLogin},"Need to login again to save your transaction with us."),g.a.createElement(d.h,null,g.a.createElement(d.g,{onChange:function(t){return e.setState({userName:t.target.value})},value:this.state.userName,placeholder:"Enter your username",className:"email-address-input"})),g.a.createElement(j.a,{id:"password",name:"password",placeholder:"Enter password",value:this.state.password,onChange:this.handlePasswordChange.bind(this)}),!this.props.signingUp&&g.a.createElement("div",{className:"sign-up-text"},"No account yet? Chill, you can sign up ",g.a.createElement("span",{onClick:function(){return e.props.setSigningUp(!0)},className:"sign-up-here pushable"},"here"),".")),g.a.createElement(h.a.Footer,null,g.a.createElement(d.b,{variant:"secondary",onClick:this.onClickDone},"Done"),g.a.createElement(d.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(b.Component);t.a=Object(y.b)(function(e){return{transactionUponLogin:e.transactions.transactionUponLogin,signingUp:e.sequencer.signingUp}},function(e){return{setSigningUp:function(t){return e(Object(p.sg)(t))},hide:function(t){return e(Object(p.Qf)(!1))},clearTransactions:function(){return e(Object(p.rh)(void 0))}}})(E)},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n(147),o=(n(365),n(591)),s=n(94),c=n(457),u=n.n(c),l=n(345),f=n(5),h=n.n(f),p=n(14),d=n(52),m=n(30);n(900);function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=function(){var e=Object(p.a)(h.a.mark(function e(){var t,n,r,a,i,o,c;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.isNFT){e.next=2;break}return e.abrupt("return",[]);case 2:return t=(t=s.a.getItem("sequences"))?JSON.parse(t).filter(function(e){return e.title&&""!==e.title}):[],n=new Set(t.map(function(e){return e.newSequence})),e.next=7,y(n);case 7:r=e.sent,a=[],i=v(t);try{for(i.s();!(o=i.n()).done;)c=o.value,r.has(c.hash)||a.push(c)}catch(u){i.e(u)}finally{i.f()}s.a.setItem("sequences",JSON.stringify(a));case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(p.a)(h.a.mark(function e(t){var n,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.getAccount();case 2:return n=e.sent,e.next=5,m.a.tokenizedSequences.getSequences(n,void 0,void 0);case 5:return r=e.sent,e.abrupt("return",new Set(r.map(function(e){return e.newSequence})));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),k=n(15),O=n.n(k),j=n(1506),w=n(1477),E=n(662),S=n(420),P=n(661);n.d(t,"a",function(){return x});window.AudioContext||window.webkitAudioContext;var x=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],c=Object(a.useState)(new E.a(e.store)),f=Object(r.a)(c,2),h=f[0],p=(f[1],Object(a.useState)(void 0)),v=Object(r.a)(p,2),b=v[0],y=v[1],k=Object(a.useState)(void 0),x=Object(r.a)(k,2),T=x[0],C=x[1];return Object(a.useEffect)(function(){if(t){var r=document.getElementsByTagName("html")[0];if(s&&r.setAttribute("class","bad-scroll"),!e.skipSampleRate)i.isMobile?o.a.setSampleRate(l.d):o.a.setSampleRate(l.a),window.context&&console.log("after setting sample rate it was =",window.context.sampleRate),window.isNFT||(d.a.setStore(e.store),d.a.setEthereum(m.a),d.a.checkLogin().then(function(){m.a.guilds.initGuilds(),m.a.guilds.acceptAnyNewRequests(),d.a.appear()}));u()(O.a.Master.context,".editor"),g(),m.a.cache=h,m.a.cache.loadIndex(),m.a.store=e.store,m.a.crypto.store=e.store,Promise.resolve().then(n.bind(null,898)).then(function(t){var n=new t.default(e.store);n.latencyHint=void 0,n.setScripting(new P.a(n)),n.connectToKeyboardEngine(new w.a(n)),n.ethereumCache=h,y(new S.a(h,n)),e.setSequencerEngine&&e.setSequencerEngine(n),C(n),window.addEventListener("beforeunload",function(e){return e.returnValue="Please dont leave",e});var r=void 0!==T?e.sequencerEngine.getSequenceId():e.match&&void 0!=e.match.params.sequenceId?e.match.params.sequenceId:null,a=e.location&&e.location.search;if(a)for(var i=a.split("="),o=0;o<i.length;o+=2)if(i[o].includes("token")){var s=i[o+1];if(void 0!==s){n.tokenID=parseInt(s);break}}window.projectId?n.loadSequence(window.projectId):null==r?n.loadNewSequence():window.isNFT?n.loadSequence(r):d.a.checkLogin().then(function(){return n.loadSequence(r)}),Object(j.a)(n)})}},[t]),[h,T,b]}},function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"b",function(){return f});var r=n(151),a=n(314),i=n(186),o=n(605),s=n(6);function c(e,t,n){var c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.getSelectedTrack(),f=arguments.length>4?arguments[4]:void 0;if(void 0!==c){var p=u(t),d=p.effectName,m=p.parameters;if(d in r.b){var v=r.b[d](e),b=n||h(e);if(!f&&b&&"Effect Rack"===b.name){b.addEffect(v);var g=Object(a.a)(200,200,b),y=g.x,k=g.y;v.x=y,v.y=k}else c.effects.push(v),e.selectEffect(v);return v.enable(!0),c.updateEffects(),c.showEffects(!0),l(v,m),v}if(d in i.b){var O=i.b[d](c),j=n||h(e);if(j&&"Midi Effect Rack"===j.name){var w=Object(a.a)(200,200,j),E=w.x,S=w.y;j.addEffect(O),O.x=E,O.y=S}else c.midiEffects.addEffect(O),e.selectEffect(O);return O.enabled=!0,c.showEffects(!0),l(O,m),O}if(d in o.b){var P=o.b[d](c);return c.liveEffects.addEffect(P),P.enabled=!0,c.showEffects(!0),e.store.dispatch(Object(s.Se)(P.id)),l(P,m),P}}}function u(e){return e.includes("[")?{effectName:e.slice(0,e.indexOf("[")),parameters:function(e){for(var t=[],n="",r="",a=!0,i=!1,o=0;o<e.length;o++){var s=e.charAt(o);if("="!=s){if(a)n+=s;else if(i){if(" "==s){t.push({parameter:n,value:r}),i=!1,a=!0,n="",r="";continue}r+=s}}else a=!1,i=!0}""!==n&&t.push({parameter:n,value:r});return t}(e=e.includes("]")?e.slice(e.indexOf("[")+1,e.indexOf("]")):e.slice(e.indexOf("[")+1))}:{effectName:e,parameters:[]}}function l(e,t){var n=function(n){var r=t[n],a=r.parameter,i=r.value,o=a.split(" ").join(""),s=e.parameters.find(function(e){return e.name.toLowerCase()===a.toLowerCase()||e.name.toLowerCase()===o.toLowerCase()});if(void 0===s)return"continue";if(i.includes("%")){i=parseFloat(i.slice(0,i.indexOf("%")));var c=s.max-s.min;s.set(c*(i/100))}else i=parseFloat(i),s.set(i)};for(var r in t)n(r)}function f(e,t,n){var a=t in r.b?r.b[t](e):i.b[t](e.getSelectedTrack()),o=(n=n.toLowerCase()).split(" ").join("");return a.parameters.map(function(e){return e.name}).filter(function(e){return e.toLowerCase().includes(n)||e.toLowerCase().includes(o)})}var h=function(e){if(void 0!==e.state.effects.selectedEffect)return e.selectedEffect}},function(e,t,n){},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(11),a=n(0),i=n(1094),o=function(e){var t=Object(a.useState)(void 0),n=Object(r.a)(t,2),o=n[0],s=n[1];return Object(a.useEffect)(function(){e.sequencerEngine&&s(new i.a(e.sequencerEngine))},[e.sequencerEngine]),Object(a.useEffect)(function(){if(o)return window.addEventListener("keydown",o.onKeyDown),window.addEventListener("keyup",o.onKeyUp),function(){window.removeEventListener("keydown",o.onKeyDown),window.removeEventListener("keyup",o.onKeyUp)}},[o]),[o]}},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});var r="SPOTLIGHT",a="MIXES",i="LINKS"},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(11),o=n(202),s=n(368),c=n(506),u=n(1048),l=n(6),f=n(58),h=n(12),p=n(59),d=Object(h.b)(function(e,t){return{mintingProgress:e.nft.mintingProgress,newZoraTokenId:e.nft.newZoraTokenId}},function(e){return{setPluginToSave:function(t){return e(Object(l.me)(t))}}})(function(e){var t=e.zobject,n=e.setPluginToSave;console.log("zobject.plugin=",t.plugin,t);var o=Object(r.useState)(t.plugin?t.plugin.name:""),l=Object(i.a)(o,2),h=l[0],d=l[1],m=Object(r.useState)(""),v=Object(i.a)(m,2),b=v[0],g=v[1],y=Object(r.useState)(""),k=Object(i.a)(y,2),O=k[0],j=k[1],w=Object(r.useCallback)(function(){var e=t.getPresetJson();t.plugin?Object(u.c)(e,h,b,O,t.plugin.tokenId):Object(u.a)(e,h,b,O,{creatorShare:4,ownerShare:4,minterShare:92})},[t,h,b,O]);return a.a.createElement(f.a,{dialogClassName:"zora-modal preset-modal",show:!0,onHide:function(){n(void 0)}},a.a.createElement(f.a.Body,null,a.a.createElement("div",{className:"zora-configuration"},a.a.createElement(c.a,{set:d,get:h,name:"name"}),a.a.createElement(c.a,{set:g,get:b,name:"description",isTextArea:!0}),a.a.createElement(s.a,{placeholder:"Drop the thumbnail image for your work, here",imageHash:O,setImageHash:j}))),a.a.createElement(f.a.Footer,null,a.a.createElement(p.b,{variant:"primary",onClick:w},t.plugin?"Update Plugin":"Mint Plugin")))}),m=n(635),v=n(173),b=(n(2575),Object(h.b)(function(e,t){return{}},function(e){return{setShowFreezeModal:function(t){return e(Object(l.Mf)(t))}}})(function(e){var t=e.sequencerEngine,n=e.setShowFreezeModal,o=Object(r.useState)("pad"),s=Object(i.a)(o,2),c=s[0],u=s[1],l=Object(r.useCallback)(function(){"pad"===c?t.state.spatial.showPadSequencer.zObject.executeAction("Freeze Pads"):Object(v.e)(t.getSelectedTrack()),n(!1)},[c,t]);return a.a.createElement(f.a,{dialogClassName:"freeze-modal",show:!0,onHide:function(){return n(!1)}},a.a.createElement(f.a.Header,{closeButton:!0},a.a.createElement(f.a.Title,null,"Freeze",a.a.createElement("img",{src:"/freeze-icon.svg"}))),a.a.createElement(f.a.Body,null,a.a.createElement("div",{className:"freeze-options"},a.a.createElement("div",{onClick:function(e){return u("pad")},className:"pad"===c?"selected freeze-option":"freeze-option"},"Pad ",a.a.createElement("img",{src:"/zpad-light.svg"})),a.a.createElement("div",{onClick:function(e){return u("track")},className:"track"===c?"selected freeze-option":"freeze-option"},"Track"),a.a.createElement("div",{className:"freeze-description"},"pad"===c?"Bounce audio from all tracks into a single frozen stem.":"Bounce audio from the selected track into a frozen stem."))),a.a.createElement(f.a.Footer,null,a.a.createElement(p.b,{onClick:l,className:"pushable",variant:"secondary"},"Start Freezing")))})),g=Object(h.b)(function(e,t){return{}},function(e){return{setHicDialog:function(t){return e(Object(l.xc)(t))}}})(function(e){var t=e.setHicDialog,n=e.hicDialog,i="https://zequencer.io/ipfs/"+n.page,o=Object(r.useCallback)(function(){window.open("https://zequencer.io/ipfs/"+n.zip)},[n]);return a.a.createElement(f.a,{dialogClassName:"hic-modal preset-modal",show:!0,onHide:function(){return t(void 0)}},a.a.createElement(f.a.Header,{closeButton:!0},a.a.createElement(f.a.Title,null,"Hicetnunc Assets")),a.a.createElement(f.a.Body,null,"Check this url to see if your NFT is showing correctly",a.a.createElement("div",{className:"ipfs-url"},a.a.createElement("a",{href:i,target:"_blank"},i))),a.a.createElement(f.a.Footer,null,a.a.createElement(p.b,{variant:"secondary",onClick:o},"Download Zip")))}),y=n(21),k=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.thumbnails,n=e.selected,r=e.setThumbnail;return a.a.createElement("div",{className:"alternate-thumbnails"},t.map(function(e){return a.a.createElement("img",{onClick:function(){return r(e)},src:"/ipfs/"+e,className:n===e?"pushable alternate-thumbnail selected":"pushable alternate-thumbnail"})}))}),O=n(167),j=Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.royalties;return a.a.createElement("div",{className:"royalties zora-field focused"},a.a.createElement("div",{className:"field-name"},"your royalties %"),t&&a.a.createElement(O.a,{units:"%",width:200,parameter:t}))}),w=(n(1550),Object(h.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.name,n=e.description,r=e.royalties,i=e.thumbnail,o=e.setName,u=e.setDescription,l=e.setThumbnail,f=e.alternateThumbnails;return a.a.createElement("div",{className:"zora-configuration"},a.a.createElement(c.a,{set:o,get:t,name:"name"}),a.a.createElement(c.a,{set:u,get:n,name:"description",isTextArea:!0}),a.a.createElement(k,{selected:i,setThumbnail:l,thumbnails:f}),a.a.createElement(s.a,{placeholder:"Drop the thumbnail image for your work, here",imageHash:i,setImageHash:l}),a.a.createElement(j,{royalties:r}))})),E=n(1417),S=n(896),P=(n(1077),Object(h.b)(function(e,t){return{mintingProgress:e.nft.mintingProgress,newZoraTokenId:e.nft.newZoraTokenId}},function(e){return{setNewZoraTokenId:function(t){return e(Object(l.wd)(t))},setZoraDialog:function(t){return e(Object(l.di)(t))},setMintingProgress:function(t){return e(Object(l.kd)(t))}}})(function(e){var t=e.setZoraDialog,n=e.data,s=e.sequencerEngine,c=e.setMintingProgress,u=e.mintingProgress,l=e.newZoraTokenId,h=e.setNewZoraTokenId,d=Object(r.useState)(void 0),m=Object(i.a)(d,2),v=m[0],b=m[1],g=Object(r.useState)(void 0),k=Object(i.a)(g,2),O=k[0],j=k[1],P=Object(r.useState)(""),x=Object(i.a)(P,2),T=x[0],C=x[1],N=Object(r.useState)(n&&n.screenshots[0]),R=Object(i.a)(N,2),M=R[0],A=R[1],q=Object(r.useState)(n&&n.screenshots),D=Object(i.a)(q,2),I=D[0],_=(D[1],Object(r.useState)("")),F=Object(i.a)(_,2),L=F[0],B=F[1],z=Object(r.useState)(!1),V=Object(i.a)(z,2),H=(V[0],V[1]);Object(r.useEffect)(function(){var e=new y.a("royalties",{},function(e){return 0},{defaultValue:10,min:0,max:100});e.setStore(s.store),j(e)},[]);var U="https://zequencer.io/ipfs/"+n.page+"/";console.log("url = ",U);var J=Object(r.useCallback)(function(){c("Verifying your NFT"),Object(S.b)(n,L,T,M,O.get(),s).then(function(e){return c(void 0)}).catch(function(e){"timed out"===e?Object(S.b)(n,L,T,M,O.get(),s).then(function(e){return c(void 0)}).catch(function(e){H(!0),c(void 0)}):c(void 0)})},[n,O,M,L,T]);return Object(r.useEffect)(function(){Object(S.a)(n).then(b)},[n,b]),!u&&l?a.a.createElement(f.a,{dialogClassName:"zora-modal preset-modal mint-completed",show:!0,onHide:function(){return t(void 0)}},a.a.createElement(f.a.Body,null,a.a.createElement("div",{className:"completed-minting-message"},"Congratulations, you've minted a new NFT on Zora."),a.a.createElement("div",{className:"mint-links"},"Go to your ",a.a.createElement("a",{href:"/collect"},"collection page")," to see your all your minted works."),a.a.createElement("div",{className:"mint-links"},"You can also check it out on Zora, ",a.a.createElement("a",{href:"https://zora.co/collections/zora/".concat(l)},"here"),"."))):a.a.createElement(f.a,{dialogClassName:"zora-modal preset-modal",show:!0,onHide:function(){c(void 0),t(void 0),h(void 0)}},a.a.createElement(f.a.Body,null,u&&a.a.createElement(o.a,{intervalPiece:1,text:u,width:900,intervalTime:100}),v&&a.a.createElement(E.a,{metadata:v,contentURI:U}),a.a.createElement(w,{name:L,description:T,royalties:O,thumbnail:M,alternateThumbnails:I,setName:B,setDescription:C,setThumbnail:A})),a.a.createElement(f.a.Footer,null,a.a.createElement(p.b,{variant:"primary",onClick:J},"Mint on Zora")))})),x=n(1472),T=n(1471),C=(n(2707),Object(h.b)(function(e,t){return{}},function(e){return{setShowProjectsModal:function(t){return e(Object(l.ag)(t))}}})(function(e){var t=Object(r.useCallback)(function(){e.setShowProjectsModal(!1)},[]);return a.a.createElement(f.a,{dialogClassName:"projects-modal",show:!0,onHide:t},a.a.createElement(f.a.Header,{closeButton:!0},a.a.createElement(f.a.Title,null,"Projects")),a.a.createElement(f.a.Body,null,a.a.createElement(T.a,{sequencerEngine:e.sequencerEngine})))})),N=n(1104),R=n(1064),M=n(5),A=n.n(M),q=n(14),D=n(2),I=n(4),_=n(20),F=n(7),L=n(10),B=n(1),z=n(318),V=n(97),H=(n(52),n(1044),n(1378),n(164),n(1379),n(196),n(62),n(1380),n(38)),U=(n(210),n(34),n(141)),J=(n(459),n(30));function G(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(B.a)(e);if(t){var a=Object(B.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(L.a)(this,n)}}var W=function(e){Object(F.a)(n,e);var t=G(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e)).state={nameValue:"",isEffects:!1,guildOptions:[],saveOption:U.c,selectedGuild:void 0,guildIds:[]},r.input=void 0,r.onClickDone=r.onClickDone.bind(Object(_.a)(r)),r.onClickCancel=r.onClickCancel.bind(Object(_.a)(r)),console.log("PRESET CONS"),r}return Object(I.a)(n,[{key:"getPresetGuilds",value:function(){var e=Object(q.a)(A.a.mark(function e(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getGuilds(),this.input&&this.input.focus(),this.getPresetGuilds()}},{key:"getGuilds",value:function(){var e=Object(q.a)(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.a.guilds.getGuildsForUser();case 2:t=e.sent,void 0!==this.props.selectedGuild&&this.setState({saveOption:U.a}),this.setState({selectedGuild:this.props.selectedGuild,guildOptions:t.filter(function(e){return e.name.split(",").length<2})});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onSelectGuild",value:function(e){this.setState({selectedGuild:e})}},{key:"selectedZObject",get:function(){var e=this.props.sequencerEngine.state.zobject.selectedZObject,t=this.props.sequencerEngine.state.zobject.viewableSubPatches,n=e||t&&t[0]&&t[0].zObject;return n.getObjectType()!==V.e&&n.getObjectType()!==V.a&&(n=void 0),n}},{key:"isZObject",value:function(){return void 0!==this.selectedZObject}},{key:"onClickDone",value:function(){var e=this.selectedZObject;e?e.getObjectType()===V.a?Object(z.b)(e.getJson(!0),this.state.nameValue):this.props.sequencerEngine.saveZObjectPreset(e,this.state.nameValue):this.props.sequencerEngine.saveTrackPreset(this.props.track.trackNumber,this.state.nameValue,this.state.isEffects,void 0===this.state.selectedGuild?0:this.state.selectedGuild.guildId),this.props.onHide()}},{key:"onClickCancel",value:function(){this.props.onHide()}},{key:"onInputType",value:function(e){this.setState({nameValue:e})}},{key:"handleCheckboxChange",value:function(e){this.setState({isEffects:"track"!==e.target.name})}},{key:"login",value:function(){this.props.setShowLogin(!0)}},{key:"render",value:function(){var e=this;if(!this.props.userToken)return a.a.createElement(f.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},a.a.createElement(f.a.Header,{closeButton:!0},a.a.createElement(f.a.Title,null,"Save Preset")),a.a.createElement(f.a.Body,null,a.a.createElement("span",{onClick:function(){return e.login()},className:"login-btn"},"Login")," to save preset"));var t=this.selectedZObject;return a.a.createElement(f.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},a.a.createElement(f.a.Header,{closeButton:!0},a.a.createElement(f.a.Title,null,t?"Save Object Preset ("+t.name+")":"Save Preset")),a.a.createElement(f.a.Body,null,a.a.createElement("input",{value:this.state.nameValue,onChange:function(t){return e.onInputType(t.target.value)},ref:function(t){e.input=t},placeholder:"Type name of preset",className:"tag-input"}),!t&&a.a.createElement("form",null,a.a.createElement("input",{name:"track",type:"checkbox",checked:!this.state.isEffects,onChange:function(t){return e.handleCheckboxChange(t)}}),a.a.createElement("label",null,"Track"),a.a.createElement("input",{name:"effects",type:"checkbox",checked:this.state.isEffects,onChange:function(t){return e.handleCheckboxChange(t)}}),a.a.createElement("label",null,"Effects"))),a.a.createElement(f.a.Footer,null,a.a.createElement(p.b,{variant:"secondary",onClick:this.onClickDone},"Save"),a.a.createElement(p.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(r.Component),K=Object(h.b)(function(e){var t=e.presets.trackPresetSaving;return{userToken:e.sequencer.userToken,selectedGuild:e.guilds.selectedGuild,track:t,show:t}},function(e){return{setContextualHelp:function(t){return e(Object(l.ub)(t))},setShowLogin:function(t){return e(Object(l.Qf)(t))},onHide:function(){return e(Object(l.fh)(void 0))}}})(W),X=n(1473),Q=Object(h.b)(function(e,t){return{isManaging:e.guilds.isManaging}},function(e){return{setIsManagingGuilds:function(t){return e(Object(l.Fc)(t))}}})(function(e){var t=e.isManaging,n=e.setIsManagingGuilds;return t?(console.log("MANAGING"),a.a.createElement(f.a,{dialogClassName:"preset-modal guilds-modal",show:!0,onHide:function(){return n(!1)}},a.a.createElement(f.a.Header,{closeButton:!0},a.a.createElement(f.a.Title,null,"Groups")),a.a.createElement(f.a.Body,null,a.a.createElement(X.a,null)),a.a.createElement(f.a.Footer,null,a.a.createElement(p.b,{variant:"secondary",onClick:function(){return n(!1)}},"Done")))):[]});t.a=Object(h.b)(function(e,t){return{trackPresetSaving:e.presets.trackPresetSaving,showLogin:e.sequencer.showLogin,transcribing:e.sequencer.isTranscribing,loadingText:e.sequencer.loadingText,loadingSequence:e.sequencer.loadingSequence,uploadingFile:e.sequencer.uploadingFile,showSettings:e.sequencer.showSettings,hicDialog:e.nft.hicDialog,zoraDialog:e.nft.zoraDialog,isPreparingNFT:e.nft.isPreparingNFT,showProjectsModal:e.spatial.showProjectsModal,trackToConvert:e.tracks.trackToConvert,pluginToSave:e.plugins.pluginToSave,showFreezeModal:e.freeze.showFreezeModal}},function(e){return{}})(function(e){var t=Object.keys(e.loadingSequence).some(function(t){return e.loadingSequence[t]});return console.log("LOADING SEQUENCE= ",t),a.a.createElement("div",null,a.a.createElement(H.a,{condition:e.showLogin},a.a.createElement(R.a,{show:e.showLogin})),e.hicDialog&&a.a.createElement(g,{hicDialog:e.hicDialog}),e.zoraDialog&&a.a.createElement(P,{data:e.zoraDialog,sequencerEngine:e.sequencerEngine}),t?a.a.createElement(N.a,{sequencerEngine:e.sequencerEngine}):"",e.isPreparingNFT?a.a.createElement(o.a,{text:"Preparing your NFT",sequencerEngine:e.sequencerEngine}):"",e.loadingText?a.a.createElement(o.a,{text:e.loadingText,sequencerEngine:e.sequencerEngine}):"",e.transcribing?a.a.createElement(o.a,{text:"Transcribing",sequencerEngine:e.sequencerEngine}):"",a.a.createElement(Q,null),e.uploadingFile?a.a.createElement(o.a,{text:"Uploading File",sequencerEngine:e.sequencerEngine}):"",e.showSettings?a.a.createElement(x.a,{sequencerEngine:e.sequencerEngine}):"",e.trackPresetSaving?a.a.createElement(K,{sequencerEngine:e.sequencerEngine}):"",e.showProjectsModal?a.a.createElement(C,{sequencerEngine:e.sequencerEngine}):"",e.trackToConvert?a.a.createElement(m.a,{show:!0,track:e.trackToConvert,sequencerEngine:e.sequencerEngine}):"",e.showFreezeModal&&a.a.createElement(b,{sequencerEngine:e.sequencerEngine}),e.pluginToSave&&a.a.createElement(d,{zobject:e.pluginToSave}))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=n(42),h=n(12);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var d=function(e){Object(o.a)(n,e);var t=p(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){return l.a.createElement(f.Rect,{x:this.props.start,y:0,width:this.props.end-this.props.start,height:this.props.height,fill:"yellow"})}}]),n}(u.Component),m=Object(h.b)(function(e,t){return void 0===e.selector.waveformSelection?{}:e.selector.waveformSelection.id!==t.sampleId?{}:{start:e.selector.waveformSelection.start,end:e.selector.waveformSelection.end}},null)(d);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var b=function(e){Object(o.a)(n,e);var t=v(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={isPlaying:!1,x:0},a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.isPlaying!==this.state.isPlaying&&(this.state.isPlaying=e.isPlaying,e.isPlaying?this.startTicker():clearInterval(this.timer)),!0}},{key:"startTicker",value:function(){var e=this;this.timer=setInterval(function(){var t=new Date,n=(1e3*e.props.startOffsetTime+(t-e.props.startTime))%(1e3*e.props.duration);e.setState({x:e.props.width*n/(1e3*e.props.duration)/2})},50)}},{key:"render",value:function(){return this.props.isPlaying?l.a.createElement(f.Line,{x:this.state.x,y:0,points:[this.state.x,0,this.state.x,this.props.height],strokeWidth:1,stroke:"red",fill:"red"}):l.a.createElement(f.Line,null)}}]),n}(u.Component),g=(n(38),n(6)),y=n(29),k=n(391),O=n(34),j=(n(191),n(298));function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}window.waveformFillColor="#130e2e9c";var E=new y.a,S=new j.a(325,50),P=function(e){Object(o.a)(n,e);var t=w(n);function n(e){var a;Object(r.a)(this,n),(a=t.call(this,e)).state={audioUnit:e.audioUnit,buffer:e.audioUnit.buffer,x:0,isPlaying:!1,pts:[],coloredPoints:[]},a.dragging=!1,a.width=e.width||325,a.height=e.height||50,a.width===S.width&&a.height===S.height||(S=new j.a(a.width,a.height)),a.state.pts=[];Object(i.a)(a);return a.computeWaveformInChunks(),a.convertSpaceToSeconds.bind(Object(i.a)(a)),a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){if(this.props.buffer!==e.buffer||this.props.id!==e.id){this.state.buffer=e.buffer;return this.computeWaveformInChunks(),!0}return this.dragging||this.state.isPlaying||this.state.pts!==t.pts||this.state.coloredPoints!==t.coloredPoints||this.props.slices!==e.slices}},{key:"computeWaveformInChunks",value:function(e){var t=this;if(void 0===this.state.buffer)return[];this.state.buffer.duration<3?S.getBasicWaveform(this.props.sample.getId(),this.state.buffer,!1).then(function(e){e=Object(k.a)(e,"rmsY"),t.setState({pts:e,coloredPoints:[]})}):S.getWaveform(this.props.sample.getId(),this.state.buffer,!1).then(function(e){t.setState({pts:[],coloredPoints:e})})}},{key:"stopSound",value:function(){this.state.audioUnit.stopSound(),this.setState({isPlaying:!1})}},{key:"playSound",value:function(e,t){var n=e.state.audioUnit;if(e.state.isPlaying)e.stopSound();else{e.setState(e.state),e.state.isPlaying=!0;var r=e.convertSpaceToSeconds(t);n.playSound(r);var a=new Date;this.setState({startOffsetTime:r,startTime:a})}}},{key:"convertSpaceToSeconds",value:function(e){return this.state.audioUnit.buffer.duration*e/this.width}},{key:"convertSecondsToSpace",value:function(e){return e/this.state.audioUnit.buffer.duration*this.width}},{key:"startDrag",value:function(e,t){if(document.activeElement.blur(),t=t.evt,e.draggin)e.dragging=!1;else{if(e.playSound(e,t.offsetX),void 0!==e.props.sample){var n={start:t.offsetX,end:t.offsetX,id:e.props.id||e.props.sample.getId()};e.props.setWaveformSelection(n)}e.dragging=!0}if(void 0!==this.props.slices){var r=this.getSliceFromCoordinate(t.offsetX);this.props.onSelectSlice(r)}}},{key:"getSliceFromCoordinate",value:function(e){var t=this.convertSpaceToSeconds(e),n=this.props.slices.filter(function(e){return e.startTime<=t&&e.endTime>=t});return 0==n.length?void 0:n[0]}},{key:"moveDrag",value:function(e,t){if(e.dragging){if(e.props.setWaveformSelectionEnd(t.evt.layerX),void 0===this.props.sequencerEngine)return;var n=this.props.sequencerEngine.store.getState(),r=this.convertSpaceToSeconds(n.selector.waveformSelection.start),a=this.convertSpaceToSeconds(t.evt.layerX);void 0!==this.props.onChooseSlice&&r<a&&this.props.onChooseSlice({startTime:r,endTime:a})}}},{key:"endDrag",value:function(e){this.dragging=!1,this.stopSound()}},{key:"isCurrentChord",value:function(e){var t=this.props.selectedChordSample;return void 0!==this.props.sample&&void 0!==t&&(this.props.sample.ipfsHash===t.sampleHash&&e.startTime===t.startTime&&e.endTime===t.endTime)}},{key:"render",value:function(){var e=this,t=this.state.pts;void 0===this.props.slices||this.props.slices;if(void 0===this.props.audioUnit)return l.a.createElement("div",null,"Fetching sample...");var n=E.getColorForHash(this.props.sample.getId());return l.a.createElement("div",null,l.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(O.Bb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"sound-waveform details-view"},l.a.createElement(f.Stage,{onMouseDown:function(t){return e.startDrag(e,t)},onMouseUp:function(t){return e.endDrag(e,t)},onMouseMove:function(t){return e.moveDrag(e,t)},width:isNaN(this.width)?1:this.width,height:this.height},l.a.createElement(h.a,{store:this.props.store||this.props.sequencerEngine.store},l.a.createElement(f.Layer,null,l.a.createElement(f.Rect,{x:0,y:0,width:isNaN(this.width)?1:this.width,height:this.height,fill:window.waveformFillColor}),l.a.createElement(m,{height:this.height,sampleId:this.props.id||(void 0!==this.props.sample?this.props.sample.getId():0)})),l.a.createElement(f.Layer,null,this.state.coloredPoints.length>0?this.state.coloredPoints.map(function(e,t){return l.a.createElement(f.Rect,{key:"point-"+t,x:e.x,y:e.y,width:e.width,height:e.height,fill:"rgb("+e.rgb[0]+","+e.rgb[1]+","+e.rgb[2]+")"})}):l.a.createElement(f.Line,{bezier:!0,points:t,stroke:n,strokeWidth:2})),l.a.createElement(f.Layer,null,l.a.createElement(b,{startTime:this.state.startTime,isPlaying:this.state.isPlaying,duration:this.state.audioUnit.buffer&&this.state.audioUnit.buffer.duration,startOffsetTime:this.state.startOffsetTime,width:isNaN(this.width)?1:this.width,height:this.height}))))))}}]),n}(u.Component);t.a=Object(h.b)(function(e,t){return{selectedChordSample:e.selector.selectedChordSample}},function(e){return{dragSample:function(t){return e(Object(g.j)(t))},setWaveformSelection:function(t){return e(Object(g.Hh)(t))},setWaveformSelectionEnd:function(t){return e(Object(g.Ih)(t))},setContextualHelp:function(t){return e(Object(g.ub)(t))}}})(P)},,function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(5),a=n.n(r),i=n(14),o=n(11),s=n(0),c=(n(92),n(455)),u=n(401),l=n(1371),f=function(e){var t=e.ref,n=e.sequencerEngine,r=e.resolution,f=e.events,d=(e.xScale,e.getEvents),m=e.widthExtension,v=void 0===m?700:m,b=e.eventsLength,g=Object(s.useState)({start:void 0,end:void 0,preWidth:0}),y=Object(o.a)(g,2),k=y[0],O=y[1],j=Object(s.useRef)(void 0),w=Object(s.useRef)(void 0);Object(s.useEffect)(function(){if(t)return t.current.addEventListener("scroll",E),function(){return t.current?t.current.removeEventListener("scroll",E):void 0}},[O,t,r,k,f]),Object(s.useEffect)(function(){f&&E()},[f]);var E=Object(s.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(i){var o,s,m,b,g,y,E,S,P,x,T,C;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.current){e.next=2;break}return e.abrupt("return");case 2:if(o=n.state.arrangement.xScale,s=t.current.scrollLeft,w.current!==o||j.current!==s){e.next=6;break}return e.abrupt("return");case 6:w.current=o,j.current=s,m=t.current.clientWidth,b=Object(u.a)(Math.max(0,s-v/2),r,void 0,o),g=Object(u.a)(m+1.5*v,r,void 0,o),y=b+g,E=f||d()||[],S=Object(l.a)(E,b,y),P=Math.max(0,E.indexOf(h(S))-1),x=E.indexOf(p(S))+4,T=E[P]?E[P].step:0,C=Object(c.a)(T,r,o),P===k.start&&x===k.end&&k.preWidth===C||O({start:P,end:x,preWidth:C});case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[O,t,r,k,f]);return Object(s.useEffect)(function(){E()},[t,b]),{visibleView:k}},h=function(e){return e[0]},p=function(e){return e[e.length-1]}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=n(38),h=n(12),p=n(106),d=n(6),m=n(34),v=n(164),b=n.n(v),g=(n(59),n(47)),y=n(196),k=n.n(y);function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var j=new(n(29).a),w=function(e){Object(o.a)(n,e);var t=O(n);function n(e){var a;Object(r.a)(this,n),(a=t.call(this,e)).state={thumbnail:"",name:e.name,videoId:e.sample.videoId},a.apiKey="AIzaSyCf2k8RM7tFFlVGo4CVPvCsOhx86vWwTT0",a.getYoutubeTitle.bind(Object(i.a)(a)),a.getYoutubeThumbnail.bind(Object(i.a)(a));var o=a.props.sample.videoId;return void 0!==o&&""!==o&&a.getYoutubeThumbnail(o),a.props.coverArt&&a.getDiscogsThumbnail(a.props.coverArt),a.props.sample.coverArtHash&&a.getDiscogsThumbnail(a.props.sample.coverArtHash),a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){var n=!1;return e.showingWaveform!==this.props.showingWaveform&&(n=!0),e.id!==this.props.id&&(n=!0),e.selectedSampleTag!==this.props.selectedSampleTag&&(n=!0),e.sample.soundId===this.props.sample.soundId&&e.sample.ipfsHash===this.props.sample.ipfsHash||(n=!0),e.name!=this.state.name&&(this.state.name=e.name,n=!0),e.isCompactMode!==this.props.isCompactMode&&(n=!0),e.videoId!==this.props.videoId&&(this.getYoutubeThumbnail(e.videoId),n=!0),e.sample.videoId!==this.state.videoId&&(this.state.videoId=e.sample.videoId,this.getYoutubeThumbnail(this.state.videoId),n=!0),e.coverArt!==this.props.coverArt&&(this.getDiscogsThumbnail(e.coverArt),n=!0),e.sample.coverArtHash!==this.props.sample.coverArtHash&&(this.getDiscogsThumbnail(e.sample.coverArtHash),n=!0),void 0!==e.sample&&void 0!==e.name&&(this.state.name=e.name),t.thumbnail!==this.state.thumbnail&&(n=!0),e.isLoading!==this.props.isLoading&&(n=!0),n}},{key:"getYoutubeTitle",value:function(e){var t=this;if(void 0!==e&&null!==e&&""!==e){var n=e.split("="),r=this;if(n.length>1){var a=n[n.length-1];if(""===a)return this.state.name=this.props.name,void this.setState(this.state);k.a.get("https://www.googleapis.com/youtube/v3/videos?id="+a+"&key="+this.apiKey+"&fields=items(snippet(title))&part=snippet").then(function(e){return r.setState({name:void 0!==e.data.items[0]?t.truncateName(e.data.items[0].snippet.title):"Video deleted"})})}}else this.setState(this.state)}},{key:"getDiscogsThumbnail",value:function(e){this.state.thumbnail=g.a.getHashUrl(e),this.setState(this.state)}},{key:"getYoutubeThumbnail",value:function(e){if(""===e||void 0===e)return this.state.thumbnail="",void this.setState(this.state);var t="https://img.youtube.com/vi/"+e+"/1.jpg",n=this.state;n.thumbnail=t,this.setState(n)}},{key:"onClickTag",value:function(e){e===this.props.selectedSampleTag?this.props.setSelectedSampleTag(this.props.sample.getId(),void 0):this.props.setSelectedSampleTag(this.props.sample.getId(),e)}},{key:"onImgError",value:function(){this.setState({thumbnail:""})}},{key:"getTags",value:function(){return void 0!==this.props.selectedSampleTag?[this.props.selectedSampleTag]:this.props.isCompactMode&&this.props.sample.tags.length>0?[this.props.sample.tags[0]]:this.props.sample.tags}},{key:"truncateName",value:function(e){if(void 0===e||null===e)return null;var t=this.props.isCompactMode?14:E;return(e.length>t?e.substring(0,t)+"...":e).trim()}},{key:"onDragOver",value:function(e){e.stopPropagation()}},{key:"onDragStart",value:function(e){this.props.setSampleDragging(this.props.sample)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(e),this.props.setContextualHelp(t)}},{key:"render",value:function(){var e=this,t=this.props.isBig?"big ":"";this.props.showingWaveform&&this.props.track&&(t+=" showing-waveform "),this.props.isCompactMode&&(t+=" compact ");var n={};if(""===this.state.thumbnail)if(this.props.track)n={backgroundColor:j.getColorForTrack(this.props.track)};else{var r=void 0!==this.props.sample.getId()?this.props.sample.getId():void 0!==this.props.name?this.props.name:"other instrument";n={backgroundColor:j.saturate(j.getColorForHash(r),3)}}var a=this.props.contextualHelp||m.Tb;return l.a.createElement("div",{className:"youtube-info"},l.a.createElement("div",null,this.props.showDelete?l.a.createElement("div",{className:"delete-button delete-track-button",onClick:this.props.onClickDelete},"x"):"",""===this.state.thumbnail?l.a.createElement("div",{draggable:!0,onDragStart:function(t){return e.onDragStart(t)},onDragOver:function(t){return e.onDragOver(t)},onMouseOver:function(t){return e.setContextualHelp(t,a)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:t+"sound-thumbnail",style:n,onClick:this.props.onClickThumbnail},l.a.createElement(b.a,{className:"track-loading-spinner",sizeUnit:"px",size:10,color:"white",loading:this.props.isLoading})):l.a.createElement("img",{draggable:!0,onDragStart:function(t){return e.onDragStart(t)},onDragOver:function(t){return e.onDragOver(t)},onMouseOver:function(t){return e.setContextualHelp(t,a)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onError:function(){return e.onImgError()},className:this.props.isMuted?t+"muted youtube-thumbnail":t+"youtube-thumbnail",onClick:this.props.onClickThumbnail,src:this.state.thumbnail})),l.a.createElement(f.a,{condition:!this.props.hideName},l.a.createElement("div",{className:"youtube-name"},l.a.createElement("span",{onClick:this.props.onClickName},this.truncateName(this.state.name)))),this.props.children)}}]),n}(u.Component);var E=36;t.a=Object(h.b)(function(e,t){var n=e.tracks.selectedSampleTags[t.sample.getId()],r=t.track;return r&&r.tracks&&r.tracks[0]&&(r=r.tracks[0].track),{id:void 0===r?0:void 0!==r.sample&&void 0!==r.sample.getId()?r.sample.getId():r.presetName||r.getName(),selectedSampleTag:n,isCompactMode:e.sequencer.isCompactMode&&!t.isBig,showingWaveform:e.sequencer.showPianoRoll&&(e.arrangement.bottomMode===p.e||e.arrangement.bottomMode===p.b),isLoading:void 0!==t.track&&!!e.tracks.trackIsLoading[t.track.subSequence.id]&&!0===e.tracks.trackIsLoading[t.track.subSequence.id][t.track.trackNumber]}},function(e,t){return{setSelectedSampleTag:function(t,n){return e(Object(d.pf)(t,n))},setContextualHelp:function(t){return e(Object(d.ub)(t))},setSampleDragging:function(t){return e(Object(d.He)(t))}}})(w)},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(71),s=n(6),c=n(205),u=n(261),l=n(39),f=n.n(l),h=n(86),p=n(1011),d=n(12);t.a=Object(d.b)(function(e,t){var n=t.track;n&&n.tracks&&n.tracks[0]&&(n=n.tracks[0].track);var r=n&&n.subSequence.id;return{numEffects:n&&n.effects&&n.effects.length,numMidiEffects:n&&n.midiEffects&&n.midiEffects.effects.length,selectedEffect:void 0!==n&&e.mix.selectedTrackEffects[r]&&e.mix.selectedTrackEffects[r][n.id],selectedMidiEffect:void 0!==n&&e.mix.selectedTrackMidiEffects[r]&&e.mix.selectedTrackMidiEffects[r][n.id]}},function(e,t){var n=t.track;n&&n.tracks&&n.tracks[0]&&(n=n.tracks[0].track);var r=n&&n.subSequence.id;return{setShowTrackInstrument:function(t){return e(Object(s.kg)(t))},clearSelectedEffect:function(t){return e(Object(s.df)(r,n&&n.id,void 0,t,void 0))}}})(function(e){var t=e.track,n=(e.effects,e.showEffect),s=e.selectedEffect,l=e.selectedMidiEffect,d=e.clearSelectedEffect,m=e.needsLabel,v=e.hasMidi,b=e.setShowTrackInstrument,g=Object(a.useState)(void 0),y=Object(r.a)(g,2),k=y[0],O=y[1];Object(a.useEffect)(function(){return function(){t&&(d(o.a),d(o.c))}},[t]);var j=Object(a.useCallback)(function(e){var n=Object(h.b)(e.value,t.sequencerEngine);return n.enable(!0),n.wetParameter&&n.wetParameter.set(1),t.slotTracks?t.addRackEffect(n):t.effectsChain.addEffect(n),O(e.value),!1},[O,t]),w=Object(a.useCallback)(function(e){var n=Object(h.c)(e.value,t);t.midiEffects.addEffect(n),O(e.value)},[O,t]);Object(a.useEffect)(function(){k&&O(void 0)},[k,O]);var E=Object(a.useCallback)(function(e,n){t.effects[e]&&t.effects[n]&&t.moveEffectTo&&(t.moveEffectTo(e,n),O({from:e,to:n}))},[t,O]),S=Object(a.useCallback)(function(e,n){t.midiEffects.effects[e]&&t.midiEffects.effects[n]&&(t.moveMidiEffectTo(e,n),O({from:e,to:n}))},[t,O]),P=Object(a.useCallback)(function(e){d(e),O(e)},[]);Object(a.useEffect)(function(){(l||s)&&b(!1)},[l,s]);var x="";return n&&(x=s?i.a.createElement(u.a,{sequencerEngine:t.sequencerEngine,onDeleteEffect:function(){return P(o.a)},noSelect:!0,track:t,compact:!0,isDraggable:!1,effect:s,send:void 0}):l?i.a.createElement(c.a,{isDraggable:!1,sequencerEngine:t.sequencerEngine,onDeleteEffect:function(){return P(o.c)},effect:l,noSelect:!0,track:t,compact:!0}):""),t.effects?i.a.createElement("div",{className:"track-effects"},m&&i.a.createElement("div",{className:"label"},"Effects"),x,i.a.createElement("div",{className:"effects-container"},i.a.createElement(f.a,{className:"send-effects-dropdown",value:k,options:h.a,onChange:j,placeholder:"Audio FX"}),t.effects.map(function(e,n){return i.a.createElement(p.a,{key:e.id,track:t,currentSubSequence:t.subSequence,effectType:"AUDIO_FX",moveEffectTo:E,effectNumber:n,effect:e})})),v&&m&&i.a.createElement("div",{className:"label"},"Midi Effects"),v&&i.a.createElement("div",{className:"midi-effects-container effects-container"},i.a.createElement(f.a,{className:"send-effects-dropdown",value:k,options:h.e,onChange:w,placeholder:"MIDI FX"}),t.midiEffects&&t.midiEffects.effects&&t.midiEffects.effects.map(function(e,n){return i.a.createElement(p.a,{key:e.id,track:t,currentSubSequence:t.subSequence,effectType:"MIDI_FX",moveEffectTo:S,effectNumber:n,effect:e})}))):""})},function(e,t,n){},,function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(7),u=n(10),l=n(1),f=n(0),h=n.n(f),p=n(94),d=n(39),m=n.n(d),v=n(12);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var g=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={options:[]},r.getOptions(),r}return Object(s.a)(n,[{key:"getOptions",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==navigator.mediaDevices){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,navigator.mediaDevices.enumerateDevices();case 4:t=e.sent,n=t.filter(function(e){return"audioinput"===e.kind}).map(function(e){return{label:e.label,value:e.deviceId}}),void 0!==this.props.deviceId||(r=this.props.defaultInput||"default",(i=t.filter(function(e){return e.label.includes(r)})).length>0&&void 0===this.props.audioInputSource&&this.onChangeInput(i[0].deviceId)),this.setState({options:n});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getOption",value:function(e){return void 0===e&&(e="default"),this.state.options.filter(function(t){return t.value===e})[0]}},{key:"onChangeInput",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:{deviceId:t,echoCancellation:!1}});case 2:n=e.sent,p.a.setItem("deviceId",t),console.log("choosing stream=",n,t),this.props.onChooseAudio(n,t);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.defaultClassName||"audio-input-chooser";return h.a.createElement("div",{className:t},h.a.createElement("div",{className:"dropdown-title"},"Input Device:"),h.a.createElement(m.a,{className:"audio-input-chooser-dropdown",controlClassName:"audio-input-chooser-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.state.options,onChange:function(t){return e.onChangeInput(t.value)},value:this.getOption(this.props.deviceId),placeholder:"Audio Input"}))}}]),n}(f.Component);t.a=Object(v.b)(function(e){return{audioInputSource:e.sequencer.audioInputSource}},function(e){return{}})(g)},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(7),u=n(10),l=n(1),f=(n(194),n(0)),h=n.n(f),p=(n(1542),n(1546),n(38)),d=n(22),m=n(20),v=n(58),b=n(59),g=n(12),y=n(6),k=n(210);n(459);function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var j=function(e){Object(c.a)(n,e);var t=O(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={},r.onClickDone=r.onClickDone.bind(Object(m.a)(r)),r.onClickCancel=r.onClickCancel.bind(Object(m.a)(r)),r}return Object(s.a)(n,[{key:"onClickDone",value:function(){this.props.setShowModsModal(!1)}},{key:"onClickCancel",value:function(){this.props.setShowModsModal(!1)}},{key:"render",value:function(){return h.a.createElement(v.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},h.a.createElement(v.a.Header,{closeButton:!0},h.a.createElement(v.a.Title,null,"Track Mods")),h.a.createElement(v.a.Body,null,h.a.createElement(k.a,{parameters:this.props.parameters})),h.a.createElement(v.a.Footer,null,h.a.createElement(b.b,{variant:"secondary",onClick:this.onClickDone},"Done"),h.a.createElement(b.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(f.Component),w=Object(g.b)(function(e){return{show:e.sequencer.showModsModal}},function(e){return{setShowModsModal:function(t){return e(Object(y.Rf)(t))}}})(j),E=n(164),S=n.n(E),P=n(29),x=n(46),T=(n(79),n(39),n(55)),C=(n(56),n(1074),n(34)),N=n(1029),R=n(15),M=n.n(R),A=n(191),q=(n(196),n(222)),D=(n(354),n(254)),I=n(47);function _(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var B=function(e){Object(c.a)(n,e);var t=L(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={cropping:void 0},r.state.name=e.name,r.state.videoId=e.videoId,r.state.soundId=e.soundId,r.state.waveforms=1,r.state.start=0,r.sampler=e.sampler,r}return Object(s.a)(n,[{key:"crop",value:function(e,t){var n=this,r=M.a.Master.context.sampleRate,a=Object(A.a)(this.props.sampler.baseBuffer.get(),e*r,t*r,M.a.Master.context),i=this.props.sampler.sample.ipfsHash;Object(D.a)([a.getChannelData(0),a.getChannelData(1)],r).then(function(e){return I.a.addBytesArray(e)}).then(function(e){var t=n.props.track.soundIds.indexOf(i);n.props.track.soundIds[t]=e,delete n.props.track.samplers[i],n.props.track.samplers[e]=n.props.sampler,n.props.sampler.sample.ipfsHash=e}),this.props.sampler.replaceBuffer(a),this.state.cropping?this.setState({cropping:this.state.cropping+1}):this.setState({cropping:1})}},{key:"cropSlices",value:function(){var e,t=this,n=_(this.props.sampler.slices.map(function(e){return e.buffer._buffer}).map(function(e){var n=t.props.sampler.sample.getCopy();return n.ipfsHash=q.a,n.needsSave=!0,n.audioBuffer=e,n}));try{for(n.s();!(e=n.n()).done;){var r=e.value;this.props.track.sequencerEngine.addSound(r)}}catch(a){n.e(a)}finally{n.f()}}},{key:"render",value:function(){var e=this,t=this.props.sampler.baseBuffer.get(),n=this.props.track.isFrozen?this.props.sampler.sample:this.props.track.sample;return h.a.createElement(N.a,{sample:n,cropSlices:function(){return e.cropSlices()},id:this.props.id,track:this.props.track,crop:function(t,n){return e.crop(t,n)},fullWidth:!0,selectedSlice:this.props.selectedSlice,slices:this.props.sampler.slices,height:this.props.height||this.props.bottomHeight-140,small:this.props.small,isReversed:this.props.sampler.isReversed(),sampler:this.props.sampler,div:this.props.div,decentralized:this.props.decentralized,backgroundColor:this.props.backgroundColor,soundId:this.state.cropping?this.state.cropping:n.getId(),onKeyDown:this.props.onKeyDown,onSelectSlice:this.props.onSelectSlice,width:this.props.width,onChangeReversed:this.props.onChangeReversed,xBounds:0,buffer:t},this.props.children)}}]),n}(f.Component),z=(n(62),n(30)),V=n(75);function H(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}f.Component;var U=n(90),J=n.n(U),G=(n(904),n(1063));n(1031),n(2437);function W(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var K=new P.a,X=function(e){Object(c.a)(n,e);var t=W(n);function n(e){var r;Object(o.a)(this,n);var a=void 0===(r=t.call(this,e)).props.showParameters||r.props.showParameters;return r.state={extracting:!1,selectedSlice:0,selectedMidiSlice:0,samplerNumber:r.props.samplerNumber||0,showParameters:a,refined:r.parametersHasDecimals(),focused:!1},r.props.track.getTrackType()===T.f&&(r.linkMidi(),document.addEventListener("keydown",function(e){return r.onKeyDown(e)})),r}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(e){void 0!==this.props.selectedSlice&&this.props.selectedSlice!==e.selectedSlice&&this.setState({selectedSlice:this.props.selectedSlice})}},{key:"parametersHasDecimals",value:function(){if(this.props.track&&!this.props.track.trackData)return this.props.track.trackData.duration%1!==0||this.props.track.trackData.transpose%1!==0}},{key:"onGatedChange",value:function(e){document.activeElement.blur(),this.props.track.gated="gated"===e.target.value,this.setState(this.state)}},{key:"onChangeDuration",value:function(e){if(this.props.sequencerEngine.isRecording){var t=this.props.sequencerEngine.getCurrentStep();this.props.track.getStep(t).duration=parseFloat(e),this.props.track.trackData.duration=parseFloat(e)}else this.props.track.trackData.duration=parseFloat(e)}},{key:"onChangeTranspose",value:function(e){if(this.props.sequencerEngine.isRecording){var t=this.props.sequencerEngine.getCurrentStep();this.props.track.getStep(t).transpose=parseFloat(e),this.props.track.trackData.transpose=parseFloat(e)}else this.props.track.trackData.transpose=parseFloat(e)}},{key:"onChangeChop",value:function(e){if(this.props.sequencerEngine.isRecording){var t=this.props.sequencerEngine.getCurrentStep();this.props.track.getStep(t).duration=parseFloat(e),this.props.track.trackData.chop=parseInt(e)}else this.props.track.trackData.chop=parseInt(e)}},{key:"onChangeVelocity",value:function(e){var t=this.props.track.trackData;if(t.velocity=parseFloat(e),this.props.sequencerEngine.isRecording){var n=this.props.sequencerEngine.getCurrentStep();t=this.props.track.getStep(n)}t.velocity=parseFloat(e)}},{key:"onChangeAttack",value:function(e){var t=this.props.track.trackData;if(t.attack=parseFloat(e),this.props.sequencerEngine.isRecording){var n=this.props.sequencerEngine.getCurrentStep();t=this.props.track.getStep(n)}t.attack=parseFloat(e)}},{key:"onChangeRelease",value:function(e){var t=this.props.track.trackData;if(t.release=parseFloat(e),this.props.sequencerEngine.isRecording){var n=this.props.sequencerEngine.getCurrentStep();t=this.props.track.getStep(n)}t.release=parseFloat(e)}},{key:"onChangePitchAttack",value:function(e){var t=this.props.track.trackData;if(t.pitchAttack=parseFloat(e),this.props.sequencerEngine.isRecording){var n=this.props.sequencerEngine.getCurrentStep();t=this.props.track.getStep(n)}t.pitchAttack=parseFloat(e)}},{key:"onChangePitchDecay",value:function(e){var t=this.props.track.trackData;if(t.pitchDecay=parseFloat(e),this.props.sequencerEngine.isRecording){var n=this.props.sequencerEngine.getCurrentStep();t=this.props.track.getStep(n)}t.pitchDecay=parseFloat(e)}},{key:"onChangePitchSustain",value:function(e){var t=this.props.track.trackData;if(t.pitchSustain=parseFloat(e),this.props.sequencerEngine.isRecording){var n=this.props.sequencerEngine.getCurrentStep();t=this.props.track.getStep(n)}t.pitchSustain=parseFloat(e)}},{key:"onChangePitchRelease",value:function(e){var t=this.props.track.trackData;if(t.pitchRelease=parseFloat(e),this.props.sequencerEngine.isRecording){var n=this.props.sequencerEngine.getCurrentStep();t=this.props.track.getStep(n)}t.pitchRelease=parseFloat(e)}},{key:"onChangeOffset",value:function(e){this.props.track.getSampler().offset=e}},{key:"onSelectSlice",value:function(e){var t=this,n=this.props.sequencerEngine.state.keyboard.selectedPianoRollSteps;if(n&&n.every(function(e){return e.track===t.props.track})){var r=this.props.sequencerEngine.operationManager;n.forEach(function(n){return r.dispatch(Object(x.w)(t.props.track,n,n.sliceParameter,e))})}this.setState({selectedMidiSlice:e,selectedSlice:e}),this.props.setSelectedTrackSlice(e)}},{key:"linkMidi",value:function(){var e=this;this.props.midiEngine.addNoteOnListener(function(t,n){null==e.state.selectedMidiSlice||e.props.track.isEnabled||(e.props.keyboardEngine.midiMap(t,n,e.props.trackNumber,e.state.selectedMidiSlice),e.props.sequencerEngine.keyboardHelper.onNoteDown(n,!0,t),e.state.selectedMidiSlice=null,e.setState(e.state))})}},{key:"onKeyDown",value:function(e){var t=e.key;if("Tab"===t){return!0}null!=this.state.selectedMidiSlice&&t.match(/^[a-z]+$/)&&(this.state.focused||(this.props.keyboardEngine.hasKeyMapping(t)||this.props.keyboardEngine.map(t,this.props.trackNumber,this.state.selectedMidiSlice),this.state.selectedMidiSlice=null,this.setState(this.state)))}},{key:"onChangeRefined",value:function(e){document.activeElement.blur(),this.state.refined=!this.state.refined,this.setState(this.state)}},{key:"onChangeReversed",value:function(e){document.activeElement.blur(),this.props.track.trackData.reverse=!this.props.track.trackData.reverse,this.props.track.reverse(!this.isReversed()),this.setState(this.state)}},{key:"isReversed",value:function(){return this.props.track.isReversed()}},{key:"onFocus",value:function(){this.setState({focused:!0})}},{key:"onBlur",value:function(){this.setState({focused:!1})}},{key:"onChangeName",value:function(e){this.props.track.name=e.target.value,this.setState(this.state)}},{key:"savePreset",value:function(){this.props.sequencerEngine.saveTrackPreset(this.props.trackNumber)}},{key:"updatePreset",value:function(){this.props.sequencerEngine.updateTrackPreset(this.props.trackNumber)}},{key:"extractStems",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({extracting:!0}),e.next=3,this.props.track.extractStems();case 3:this.props.setViewMode(this.props.parentView);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"extractGroove",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.props.track.extractGroove(),this.props.setViewMode(this.props.parentView);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(void 0!=this.props.track&&this.props.loaded){var t=this.props.track,n="",r=void 0,a={},i=this.props.track.trackData;if(this.props.track.getSampler(this.state.samplerNumber)){void 0===this.state.selectedSlice||this.props.track.getSampler(this.state.samplerNumber).slices[this.state.selectedSlice],this.props.track.getSampler(this.state.samplerNumber).tempo;r=t.getSampler(this.state.samplerNumber);var o=this.props.track.soundIds[this.state.samplerNumber];void 0!==t.selectedRecording&&(r=t.getSelectedRecordingSampler(),o=t.getSelectedRecordingSoundId()),t.isAudioTrack&&(o=r.sample.getId()),void 0===o&&(o="unknown"),a["background-image"]="linear-gradient("+K.brighten(K.getColorForHash(o),.12)+", "+K.brighten(K.getColorForHash(o),.1)+")",a.borderColor=K.brighten(K.getColorForHash(o),.65),n=h.a.createElement(B,{bottomHeight:this.props.bottomHeight,width:this.props.width,onSoundIdChange:function(e){return[]},onClickThumbnail:function(e){return[]},onChangeReversed:function(t){return e.onChangeReversed(t)},small:this.props.small,onGetName:function(){return[]},name:this.props.track.name,track:this.props.track,sampler:r,div:this.props.div,height:this.props.height,onSelectSlice:function(t){return e.onSelectSlice(t)},onKeyDown:function(t){return e.props.onKeyDown(t)},backgroundColor:this.props.backgroundColor,selectedSlice:this.state.selectedSlice,videoId:this.props.track.videoId,soundId:o,id:this.props.id})}var s=this.state.refined?.01:1,c=this.state.refined?.01:1,u=this.state.refined?2:64,l=(this.props.track.getName(this.props.samplerNumber),{});return this.props.width&&(l.width=this.props.width+5),h.a.createElement("div",{style:l,className:"bottom-details"},h.a.createElement(w,{parameters:this.props.track.trackData.parameters}),n,h.a.createElement(p.a,{condition:!this.state.extracting},this.props.hideKeyboard?"":h.a.createElement(G.a,{trackNumber:this.props.trackNumber,track:this.props.track,mini:!0,sequencerEngine:this.props.sequencerEngine,keyboardEngine:this.props.sequencerEngine.keyboardEngine})),h.a.createElement(p.a,{condition:this.state.extracting},h.a.createElement("div",{className:"extracting-stems"},"Extracting stems... ")),h.a.createElement(S.a,{sizeUnit:"px",size:10,color:"#123abc",loading:this.state.extracting}),this.state.showParameters?h.a.createElement("div",{style:a,onMouseOver:function(){return e.props.setContextualHelp(C.Mb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"sound-parameters sound-parameters-full panel"},h.a.createElement("form",null),h.a.createElement("form",null,h.a.createElement("div",{className:"refined-checkbox-preferences"},h.a.createElement("label",null,h.a.createElement("input",{type:"checkbox",value:"reversed",checked:this.props.track.isReversed(),onChange:function(t){return e.onChangeReversed(t.target.value)}}),"Reversed"))),h.a.createElement("div",{className:"amp-envelopes"},h.a.createElement(d.a,{effectNumber:0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,min:c,max:u,step:s,isParameter:!0,parameter:i.durationParameter,name:"DURATION"}),h.a.createElement(d.a,{effectNumber:0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,min:1,max:32,isParameter:!0,parameter:i.chopParameter,name:"CHOP"}),h.a.createElement(d.a,{min:-23,max:23,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,isParameter:!0,parameter:i.transposeParameter,refined:this.state.refined,name:"TRANSPOSE"}),h.a.createElement(d.a,{min:0,max:1,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,refined:this.state.refined,isParameter:!0,step:.1,parameter:i.velocityParameter,name:"VELOCITY"}),h.a.createElement(d.a,{min:0,max:2e3,step:1,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,refined:this.state.refined,isParameter:!0,parameter:i.attackParameter,unit:"ms",name:"AMP ATTACK"}),h.a.createElement(d.a,{min:0,max:8e3,refined:this.state.refined,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,isParameter:!0,parameter:i.releaseParameter,unit:"ms",name:"AMP RELEASE"})),h.a.createElement("div",{className:"pitch-envelopes"},h.a.createElement(d.a,{min:0,max:100,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,refined:this.state.refined,isParameter:!0,step:.1,unit:"%",parameter:i.startParameter,name:"START"}),h.a.createElement(d.a,{min:0,max:2e3,step:1,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,refined:this.state.refined,parameter:i.pitchAttackParameter,unit:"ms",name:"PITCH ATTACK"}),h.a.createElement(d.a,{min:.01,max:8e3,refined:this.state.refined,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,isParameter:!0,parameter:i.pitchDecayParameter,unit:"ms",name:"PITCH DECAY"}),h.a.createElement(d.a,{min:-10,max:10,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,refined:this.state.refined,step:.01,parameter:i.pitchSustainParameter,name:"PITCH SUSTAIN"}),h.a.createElement(d.a,{min:.01,max:8e3,refined:this.state.refined,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,isParameter:!0,parameter:i.pitchReleaseParameter,unit:"ms",name:"PITCH RELEASE"})),h.a.createElement("form",null,h.a.createElement("div",{className:"refined-checkbox-preferences"},h.a.createElement("label",null,h.a.createElement("input",{type:"checkbox",value:"refined",checked:this.state.refined,onChange:function(t){return e.onChangeRefined(t.target.value)}}),"Refine"))),h.a.createElement("div",{onClick:function(){return e.props.setShowModsModal(!0)},className:"mods-button common-button pink-button small-button"},"MODS")):"")}return h.a.createElement("div",null)}}]),n}(f.Component),Q=function(e){Object(c.a)(n,e);var t=W(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={value:r.props.defaultValue},r}return Object(s.a)(n,[{key:"onChange",value:function(e){this.state.value=e,this.props.change(e),this.setState(this.state)}},{key:"render",value:function(){var e=this,t=!0===this.props.refinedMode?.01:void 0!=this.props.step?this.props.step:this.props.max>1?1:.1;return h.a.createElement("div",{className:"sound-parameter"},h.a.createElement("div",{className:"sound-parameter-name"},this.props.name,": ",this.state.value," ",void 0!==this.props.unit?this.props.unit:""),h.a.createElement(J.a,{value:this.state.value,change:function(t){return e.onChange(t.target.value)},step:t,max:this.props.max,min:this.props.min,orientation:"horizontal",reversed:!1}))}}]),n}(f.Component),Y=Object(g.b)(function(e,t){var n=t.track;return{id:void 0===n?0:void 0!==n.sample&&void 0!==n.sample.getId()?n.sample.getId():n.presetName||n.getName(),selectedSlice:e.tracks.selectedTrackSlice[n.id],showingOnsets:e.waveform.showingOnsets,bottomHeight:e.arrangement.bottomHeight,loaded:n.isFrozen||n&&n.getSampler(0)&&n.getSampler(0).isLoaded(),sampler:n&&n.getSampler(0),isFrozen:n.isFrozen}},function(e,t){return{setViewMode:function(t){return e(Object(y.Dh)(t))},setShowModsModal:function(t){return e(Object(y.Rf)(t))},setContextualHelp:function(t){return e(Object(y.ub)(t))},setSelectedTrackSlice:function(n){return e(Object(y.tf)(t.track.id,n))}}})(X);t.a={DetailsView:Y,Parameter:Q}},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(643),u=n(30),l=(new Date(2018,7,3),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.a,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(o.a)(this,e),this.ethereum=t,this.linkedPromiseList=void 0,this.results=[],this.includePrivate=n}return Object(s.a)(e,[{key:"executeQuery",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=7e6,!navigator.onLine){e.next=5;break}return e.next=4,this.getCurrentBlock();case 4:n=e.sent;case 5:return e.next=7,this.start(t,n-3e6,n);case 7:return this.linkedPromiseList=e.sent,e.abrupt("return",this);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getNext",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.linkedPromiseList&&!this.canceled){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.next=4,this.linkedPromiseList.getCurrent();case 4:if(t=e.sent,t=Array.from(new Set(t)),this.results=this.results.concat(t),this.results=this.sort(this.results),void 0!==this.linkedPromiseList){e.next=10;break}return e.abrupt("return",void 0);case 10:return e.next=12,this.linkedPromiseList.getNext();case 12:return this.linkedPromiseList=e.sent,e.abrupt("return",this.linkedPromiseList);case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var o,s=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<=3e6)){e.next=2;break}return e.abrupt("return",new Promise(function(e,t){return e(void 0)}));case 2:return console.log("Get Sequences start fromBlock=%s toBlock=%s",n,r),o=this.ethereum.tokenizedSequences,e.abrupt("return",new c.a(Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getSequences(t,n,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),new c.a(Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.ethereum.getNewSequences(t,n,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),this.start(t,n-3e6,r-3e6))));case 5:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"sort",value:function(e){return e.sort(function(e,t){return t.blockNumber-e.blockNumber}),e}},{key:"getCurrentBlock",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ethereum.web3.eth.getBlockNumber();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}());t.a=l},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=n(729);t.a=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.contentHash,n=e.type,r=e.hideIfUnfavorited,i=void 0!==r&&r,s=Object(o.a)({contentHash:t,type:n}),c=s.toggleFavorite,u=s.isFavorited;return i&&!u||!t?[]:a.a.createElement("div",{onClick:function(e){e.stopPropagation(),c(e)},className:u?"favorite-button heart favorited":"favorite-button heart"})})},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(20),u=n(7),l=n(10),f=n(1),h=n(58),p=n(59),d=n(52),m=n(0),v=n.n(m),b=n(841),g=n.n(b),y=n(38),k=n(12),O=n(6),j=(n(210),n(459),n(30));function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var E=function(e){Object(u.a)(n,e);var t=w(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={password:"",incorrectPassword:!1,needsToSetPassword:!1,userName:void 0},r.onClickDone=r.onClickDone.bind(Object(c.a)(r)),r.onClickCancel=r.onClickCancel.bind(Object(c.a)(r)),r}return Object(s.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.show&&e.show!==this.props.show&&(this.getNeedsToSetPassword(),this.getUserName()),!0}},{key:"getUserName",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,d.a.getUserName();case 3:e.t1=e.sent,e.t2={userName:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getNeedsToSetPassword",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.encryption.getPublicKey();case 2:t=e.sent,console.log("ethereum.getPublicKey() returned = "),console.log(t),void 0===t&&this.setState({needsToSetPassword:!0});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){return e.show!==this.props.show&&(console.log("password input = "),console.log(this.input.passwordInput),this.input.passwordInput.focus()),!0}},{key:"onClickDone",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.crypto.isCorrectPassword(this.state.password);case 2:if(e.sent){e.next=7;break}return this.setState({incorrectPassword:!0}),e.abrupt("return");case 7:this.setState({incorrectPassword:!1});case 8:this.props.setShowPasswordModal(!1),console.log("passwordModalCallback("+this.state.password+")"),this.props.passwordModalCallback(this.state.password);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickCancel",value:function(){this.props.passwordModalCallback(void 0),this.props.setShowPasswordModal(!1)}},{key:"handleChange",value:function(e){this.setState({password:e.target.value})}},{key:"onKeyDown",value:function(e){"Enter"===e.key&&this.onClickDone()}},{key:"render",value:function(){var e=this;return v.a.createElement(h.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:function(){return e.props.setShowPasswordModal(!1)}},v.a.createElement(h.a.Body,null,v.a.createElement(y.a,{condition:this.state.incorrectPassword},v.a.createElement("div",{className:"incorrect-password"},"Incorrect password")),v.a.createElement(y.a,{condition:void 0!==this.state.userName},"Password required to access",v.a.createElement("div",{className:"password-user-name"},this.state.userName)),v.a.createElement(y.a,{condition:this.state.needsToSetPassword},"Create a password to be used to encrypt your projects. Remember the password you choose."),v.a.createElement("div",{className:"password-container"},v.a.createElement(g.a,{id:"password",name:"password",placeholder:"Enter password",onKeyDown:function(t){return e.onKeyDown(t)},ref:function(t){return e.input=t},value:this.state.password,onChange:this.handleChange.bind(this)}))),v.a.createElement(h.a.Footer,null,v.a.createElement(p.b,{variant:"secondary",onClick:this.onClickDone},"Done"),v.a.createElement(p.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(m.Component);t.a=Object(k.b)(function(e){return{show:e.sequencer.showPasswordModal,passwordModalCallback:e.sequencer.passwordModalCallback}},function(e){return{setShowPasswordModal:function(t){return e(Object(O.Vf)(t))}}})(E)},function(e,t,n){},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12),f=n(34),h=n(76);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(i.a)(n,e);var t=p(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={clockDragging:!1,clockStartDragY:void 0,clockDragY:void 0},a}return Object(a.a)(n,[{key:"onClockMouseLeave",value:function(e){void 0!=this.seekTimer&&(clearInterval(this.seekTimer),this.seekTimer=void 0)}},{key:"onClockMouseDown",value:function(e){var t=this;void 0!==this.props.sequencerEngine&&(this.state.clockStartDragY=e.clientY,this.seekTimer=setInterval(function(){if(void 0!==t.state.clockDragY){var e=t.state.clockStartDragY-t.state.clockDragY,n=t.props.sequencerEngine.trackStep+5*e;n<0&&(n=0),t.props.sequencerEngine.seekToTrackStep(n)}},50))}},{key:"onClockMouseUp",value:function(e){clearInterval(this.seekTimer),this.seekTimer=void 0}},{key:"onClockMouseMove",value:function(e){this.state.clockDragY=e.clientY}},{key:"onClickMetronome",value:function(){void 0!==this.props.sequencerEngine&&(this.props.sequencerEngine.metronomeOn=!this.props.sequencerEngine.metronomeOn)}},{key:"render",value:function(){var e=this,t=Math.ceil(this.props.currentGlobalStep/32);t=isNaN(t)?1:t;var n=1+Math.floor(this.props.currentGlobalStep/8)%4,r=1+Math.floor(this.props.currentGlobalStep/2)%4,a="clock ";this.props.clockTick&&(a+="percentage-"+this.props.clockTick);var i="metronome";return this.props.metronomeOn&&(this.props.currentGlobalStep/4%4>=2&&(i+=" off-beat"),i+=" on"),u.a.createElement("div",{className:a,onMouseLeave:function(t){return e.onClockMouseLeave(t)},onMouseDown:function(t){return e.onClockMouseDown(t)},onMouseUp:function(t){return e.onClockMouseUp(t)},onMouseMove:function(t){return e.onClockMouseMove(t)}},u.a.createElement("div",{className:"track-time"},t),u.a.createElement("div",{className:"divider"},"."),u.a.createElement("div",{className:"time"},n),u.a.createElement("div",{className:"divider"},"."),u.a.createElement("div",{className:"time"},r),u.a.createElement(h.a,{element:f.R,onClick:function(){return e.onClickMetronome()},className:i},u.a.createElement("div",{className:"dot first"}),u.a.createElement("div",{className:"dot second"})))}}]),n}(c.Component);t.a=Object(l.b)(function(e,t){if(void 0===t.sequencerEngine)return{currentStep:0,currentGlobalStep:0,clockTick:0,metronomeOn:!1};var n=t.sequencerEngine.getSequenceId();return{currentStep:e.sequencer.currentStep[n]||0,currentGlobalStep:e.sequencer.currentGlobalStep[n]||0,clockTick:e.clock.clockTick,metronomeOn:t.sequencerEngine.metronomeOn}},null)(d)},function(e,t,n){},function(e,t,n){"use strict";var r=n(0),a=n.n(r);t.a=function(e){var t=e.resolution,n=e.stepNumber,r=e.length,i=(e.track,e.stepData),o=e.trackColor,s=e.width,c=void 0===s?448:s,u=e.height,l=void 0===u?25:u,f=e.pattern;if(void 0===i){var h=f.getAllOnStepAtResolutionAtAnyPosition(n,t);if(0===h.length)return a.a.createElement("div",null);i=h[0]}var p=l/2,d={left:c*n/r,width:i.duration*c/r,top:p-i.transpose/2};i.on&&(d.backgroundColor=o);var m=i.on?"on":"off";return a.a.createElement("div",{className:m,style:d})}},function(e,t,n){"use strict";var r=n(9),a=n(11),i=n(0),o=n.n(i),s=n(22),c=n(1109),u=n(829),l=(n(665),n(71)),f=n(374),h=n(205),p=n(261),d=n(12);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=Object(d.b)(function(e,t){return{effectStarred:e.effects.effectStarred}},function(e){return{}})(function(e){e.showPads;var t=e.effectStarred,n=e.subSequence,d=Object(i.useRef)(void 0),v=(Object(i.useRef)({}),n.midiEffects.shadowEffects),b=Object(i.useState)([]),g=Object(a.a)(b,2),y=g[0],k=g[1];Object(i.useEffect)(function(){var e,a=Object(r.a)(n.getAllEffects()),i=function(e){var t,n=[],a=m(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;n.push(i),i.effects&&(n=[].concat(Object(r.a)(n),Object(r.a)(i.effects)))}}catch(o){a.e(o)}finally{a.f()}return n},o=m(n.tracks);try{for(o.s();!(e=o.n()).done;){var s=e.value;a=[].concat(Object(r.a)(a),Object(r.a)(i(s.effects)),Object(r.a)(i(s.midiEffects.effects)))}}catch(c){o.e(c)}finally{o.f()}a=[].concat(Object(r.a)(a),Object(r.a)(n.sequencers)),k(a.filter(function(e){return t[e.id]}))},[k,t]);var O=function(e){return e.type===u.a?o.a.createElement(c.a,{scrollContainer:d,sequencer:e}):e.getEffectType()===l.a?o.a.createElement(p.a,{showDelete:!1,isDraggable:!1,featured:!0,sequencerEngine:n.sequencerEngine,WIDTH:180,HEIGHT:95,track:e.track,compact:!0,instrument:!0,onDeleteEffect:function(){return[]},effect:e,send:void 0}):o.a.createElement(h.a,{showDelete:!1,isDraggable:!1,featured:!0,sequencerEngine:n.sequencerEngine,WIDTH:180,HEIGHT:95,track:e.track,compact:!0,instrument:!0,onDeleteEffect:function(){return[]},effect:e,send:void 0})};n.midiEffects.effects.find(function(e){return"User Script"===e.name});return o.a.createElement("div",{ref:d,className:"module-inner"},o.a.createElement("div",{className:"module-row"},o.a.createElement(f.a,{showDelete:!1,isDraggable:!1,featured:!0,sequencerEngine:n.sequencerEngine,track:n,compact:!0,instrument:!0,onDeleteEffect:function(){return[]},effect:n.playhead,send:void 0}),O(v[0])),o.a.createElement("div",{className:"module-row"},O(v[1]),o.a.createElement("div",{className:"module-col"},o.a.createElement("div",null,o.a.createElement("div",{className:"effect midi enabled transpose-container"},o.a.createElement("div",{className:"effect-inner"},o.a.createElement(s.a,{parameter:n.midiEffects.transposeParameter,name:"Transpose",min:-32,step:1,max:32,sequencerEngine:n.sequencerEngine}))),O(v[2])))),o.a.createElement("div",{className:"starred-effects"},y.map(function(e){return O(e)})))})},function(e,t,n){"use strict";var r=n(8),a=n(11),i=n(0),o=n.n(i),s=(n(208),n(12)),c=n(6);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=Object(s.b)(function(e,t){return{}},function(e){return{setSelectedPulledElements:function(t){return e(Object(c.mf)(t))}}})(function(e){var t=e.isSubPatch,n=e.setSelectedPulledElements,s=e.getSelection,c=e.editorRef,l=e.scale,f=e.onMouseMove,h=e.sequencerEngine,p=e.dropdownPos,d=e.setSelectedZObject,m=e.getXY,v=Object(i.useState)(void 0),b=Object(a.a)(v,2),g=b[0],y=b[1],k=Object(i.useCallback)(function(e){if(f(e),g){var t=m(e,!0),n=t.x,a=t.y;h.state.spatial.editorPadding,y(Object(r.a)({},g,{x2:n,y2:a}))}},[g,y,l,h,m]),O=Object(i.useCallback)(function(e){if(3!==e.which&&("edges-drawer"===e.target.className.baseVal||e.target.className.includes&&(e.target.className.includes("pulled-background")||e.target.className.includes("grids-inner")))&&!h.state.spatial.showPadSequencer){var t=m(e,!0),n=t.x,r=t.y;h.state.spatial.editorPadding,y({x1:n,y1:r,x2:n,y2:r})}},[y,h,m]),j=Object(i.useCallback)(function(e){if(!p&&!h.state.spatial.showPadSequencer){var r=h.state.spatial.editorPadding;if(g&&g.x2-g.x1>1){var a,i=window._scale||1,o=t?g:{x1:(g.x1-Math.max(0,r.x))/i,y1:(g.y1-Math.max(0,r.y))/i,x2:(g.x2-Math.max(0,r.x))/i,y2:(g.y2-Math.max(0,r.y))/i},c=s(o),l={},f=h.state.zobjectBackground&&h.state.zobjectBackground.id,m=u(c);try{for(m.s();!(a=m.n()).done;){var v=a.value.id;v!==f&&(l[v]=!0)}}catch(b){m.e(b)}finally{m.f()}return n(l),d(void 0),void y(void 0)}g&&(n({}),y(void 0),d(void 0))}},[g,y,p,h,m]);return Object(i.useEffect)(function(){if(c.current)return c.current.addEventListener("mousedown",O),c.current.addEventListener("mouseup",j),c.current.addEventListener("mousemove",k),function(){c.current&&(c.current.removeEventListener("mousedown",O),c.current.removeEventListener("mouseup",j),c.current.removeEventListener("mousemove",k))}},[g,y,p,h,m]),o.a.createElement("div",{className:"pulled-background"},g&&g.x2-g.x1>0&&o.a.createElement("div",{style:{left:g.x1,top:g.y1,width:g.x2-g.x1,height:g.y2-g.y1},className:"selection"}))})},function(e,t,n){"use strict";n.d(t,"a",function(){return a});n(0);var r=n(839),a=function(e){var t=e.elements;return{getSelection:function(e){var n=e.x1,a=e.y1,i=e.x2,o=e.y2;return Object.keys(t.current).map(function(e){return{element:t.current[e],id:e}}).filter(function(e){var t=e.element;return e.id,Object(r.a)(t.current,n,a,i,o)})}}}},function(e,t,n){"use strict";var r=n(9),a=n(11),i=n(0),o=n.n(i),s=n(6),c=n(272),u=n(1054),l=n(12);t.a=Object(l.b)(function(e,t){return{position:e.packs.windowPosition,sampleDragging:e.selector.sampleDragging,presetDragging:e.presets.presetDragging,creatingNewPack:e.packs.creatingNewPack,selectedPreset:t.track&&t.track.preset&&t.track.preset.contentHash}},function(e){return{setDraggingPackWindow:function(t){return e(Object(s.Mb)(t))},setCreatingNewPack:function(t){return e(Object(s.wb)(t))},setSampleDragging:function(t){return e(Object(s.He)(t))},setPresetDragging:function(t){return e(Object(s.re)(t))},setPackToEdit:function(t){return e(Object(s.Fd)(t))}}})(function(e){var t=e.creatingNewPack,n=e.position,s=e.sequencerEngine,l=e.sampleDragging,f=e.setSampleDragging,h=e.setPresetDragging,p=e.setCreatingNewPack,d=e.setDraggingPackWindow,m=e.setPackToEdit,v=e.presetDragging,b=e.selectedPreset,g=e.setSave,y=e.json,k=void 0===y?{title:"",samples:[],description:"",presets:[]}:y,O=Object(i.useState)(!1),j=Object(a.a)(O,2),w=j[0],E=j[1],S=Object(i.useState)(k.samples||[]),P=Object(a.a)(S,2),x=P[0],T=P[1],C=Object(i.useState)(k.presets||[]),N=Object(a.a)(C,2),R=N[0],M=N[1],A=Object(i.useState)(k.title),q=Object(a.a)(A,2),D=q[0],I=q[1],_=Object(i.useState)(k.description),F=Object(a.a)(_,2),L=F[0],B=F[1],z=Object(i.useState)(k.packHash),V=Object(a.a)(z,2),H=V[0],U=V[1];Object(i.useEffect)(function(){t&&t.name?T([t]):t&&t.title&&M([t])},[t]);var J=Object(i.useRef)(void 0),G=Object(i.useCallback)(function(e){var t=J.current.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top;d({x:n,y:r})},[]);Object(i.useEffect)(function(){g&&g({fn:function(e){R.includes(e)||(M([].concat(Object(r.a)(R),[e])),W())}})},[g,x,R,M,H,U]);var W=Object(i.useCallback)(function(e){Object(c.c)(D,L,x.map(function(e){return e.getId()}),R.map(function(e){return e.contentHash}),H).then(function(e){console.log("setting pack hash=",e)}),p(!1),m(void 0),E(!1)},[D,L,x,R,k,E,H,U]),K=Object(i.useCallback)(function(e){e.stopPropagation(),l?(T([].concat(Object(r.a)(x),[l])),f(void 0),E(!0)):v&&(M([].concat(Object(r.a)(R),[v])),h(void 0),E(!0))},[l,E,T,x,v,M,R]),X=Object(i.useCallback)(function(e){x.includes(e)?(T(x.filter(function(t){return t!==e})),E(!0)):R.includes(e)&&(M(R.filter(function(t){return t!==e})),E(!0))},[x,T,R,M,E]),Q={left:n.x,top:n.y};console.log(s);var Y=[].concat(Object(r.a)(x),Object(r.a)(R));return o.a.createElement("div",{style:Q,onDrop:K,ref:J,onMouseDown:G,onMouseUp:function(){return d(void 0)},className:"pack-window no-select"},o.a.createElement("div",{className:"floppy-top"},o.a.createElement("input",{placeholder:"Type name here",className:"pack-name-input",value:D,onChange:function(e){return I(e.target.value)}})),o.a.createElement("div",{onClick:function(){p(!1),m(void 0)},className:"delete-btn"},"x"),0===Y.length?o.a.createElement("div",{className:"drop-here"},"Drop sounds and presets here."):o.a.createElement("div",{className:"contents"},x.map(function(e){return o.a.createElement(u.a,{key:e.getId(),onDelete:X,sample:e})}),R.map(function(e){return o.a.createElement(u.a,{isSelected:e&&e.contentHash===b,sequencerEngine:s,key:e.contentHash,onDelete:X,preset:e})})),o.a.createElement("textarea",{onMouseDown:function(e){return e.stopPropagation()},spellcheck:"false",className:"pack-description",onChange:function(e){return B(e.target.value)},type:"textarea",value:L}),o.a.createElement("div",{onClick:W,className:w?"save-button":"save-button disabled"},"Save Curated List Changes"))})},function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c});var r=n(9),a=n(6);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(e){var t=e.state.pads.selectedEdge;if(t){var n=t.id,r=e.currentSubSequence.getMessagingEdgeById(n);r&&(r.segmentation?r.segmentation=!1:r.segment(),e.dispatch(Object(a.hb)(n,r.segmentation)))}},c=function(e,t){(function(e){var t,n=[],a=i([].concat(Object(r.a)(e.zMessages),Object(r.a)(e.zObjects)));try{for(a.s();!(t=a.n()).done;){var o=t.value;for(var s in o.inlets)n=[].concat(Object(r.a)(n),Object(r.a)(o.inlets[s].connections));if(o.effect&&o.effect.inlets)for(var c in o.effect.inlets)n=[].concat(Object(r.a)(n),Object(r.a)(o.effect.inlets[c].connections))}}catch(u){a.e(u)}finally{a.f()}return n})(t).forEach(function(t){t.segmentation=!0,e.dispatch(Object(a.hb)(t.id,!0))})}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(20),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=function(e){e.mouseDown(!1),e.setStepToCopy(void 0),e.setIsDraggingDuration(!1),e.setStepDataDragging(void 0),e.setTransposeDragging(void 0),e.setSampleExplorerSelected&&e.setSampleExplorerSelected(void 0)},h=n(1096),p=n(33),d=n(11),m=n(370),v=n(62),b=n(90),g=n.n(b),y=n(12),k=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.name,n=e.value,r=e.onChange,a=e.step,i=e.min,o=e.max,s=Object(u.useState)(!1),c=Object(d.a)(s,2),f=(c[0],c[1],Object(u.useState)(n)),h=Object(d.a)(f,2),p=h[0],m=h[1],b=Object(u.useCallback)(function(e){var t=e.target.value;if("."===t||"-."===t)t=0;else if("-"===t)t=0;else if(""===t)t=0;else{if(!Object(v.a)(t))return;t=parseFloat(t)}m(t),r({target:{value:t}})},[r,m]);return Object(u.useEffect)(function(){m(n)},[n,m]),l.a.createElement("div",{className:"piano-slider"},l.a.createElement("div",{className:"slider-value"},t,": ",l.a.createElement("input",{className:"value-input",value:p,onChange:b})),l.a.createElement(g.a,{value:n,change:r,step:a,max:o,min:i,orientation:"horizontal",reversed:!1}))}),O=n(45),j=n(6),w=new p.a(32,!1),E=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){e.clear;var t=e.track,n=e.selectedSteps,r=Object(u.useRef)(n[0]&&n[0].getCopy(!0)),a=Object(u.useRef)(void 0),i=Object(u.useRef)(0),o=Object(u.useRef)(1),s=Object(u.useState)(1),c=Object(d.a)(s,2),f=c[0],h=c[1];Object(u.useEffect)(function(){r.current&&(i.current=t.getEasyPattern().findStepNumber(r.current,void 0,!0),o.current=r.current.duration)},[]);var p=Object(u.useCallback)(function(e){var n=e.target.value,s=a.current||[r.current];a.current=function(e,t,n,r,a){a=Math.min(Math.max(1,a),32);var i=t[0].getCopy(!0,!1),o=e.getEasyPattern();o.deleteSteps(t);for(var s=r/a,c=[],u=0;u<a;u++){var l=n+2*u*r/a,f=l-Math.floor(l),h=i.getCopy(!0,!1,void 0,void 0,!1,!1);h.id=Object(O.uuid)(),h.duration=s,o.addStep(h,Math.floor(l),w,f),c.push(h)}return e.updateSteps(!0),e.sequencerEngine.dispatch(Object(j.jf)(c)),c}(t,s,i.current,o.current,n),h(n)},[t,h]);return l.a.createElement(k,{step:1,min:1,max:32,name:"Chops",value:f,onChange:p})}),S=new p.a(32,!1),P=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){e.clear;var t=e.track,n=e.selectedSteps,r=Object(u.useRef)(n),a=Object(u.useRef)(void 0),i=Object(u.useRef)(0),o=Object(u.useState)(0),s=Object(d.a)(o,2),c=s[0],f=s[1];Object(u.useEffect)(function(){r.current&&r.current[0]&&(r.current.sort(function(e,t){return e.transpose-t.transpose}),i.current=t.getEasyPattern().findStepNumber(r.current[0]))},[]);var h=Object(u.useCallback)(function(e){var n=e.target.value,o=a.current||r.current;a.current=function(e,t,n,r){var a=t.map(function(e){return e.getCopy(!0,!1)}),i=e.getEasyPattern();i.deleteSteps(t);for(var o=r/t.length,s=[],c=0;c<t.length;c++){var u=n+2*c*o,l=u-Math.floor(u),f=a[c];f.id=Object(O.uuid)(),s.push(i.addStep(f,Math.floor(u),S,l))}return e.updateSteps(!0),e.sequencerEngine.dispatch(Object(j.jf)(s)),s}(t,o,i.current,n),f(n)},[t,f]);return l.a.createElement("div",null,l.a.createElement("div",{className:"chops-value"},"Strum: ",c),l.a.createElement(g.a,{value:c,change:h,step:.01,max:8,min:0,orientation:"horizontal",reversed:!1}))});function x(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=new p.a(32,!1),N=function(e,t,n,r,a){var i=R(n),o=t.map(function(e){return e.getCopy(!0,!1)}),s=e.getEasyPattern();s.deleteSteps(t);var c,u=[],l=0,f=x(n);try{for(f.s();!(c=f.n()).done;){var h=c.value,p=Object(d.a)(h,2),m=(p[0],p[1]-i),v=i+Math.pow(m*r,a),b=v-Math.floor(v);s.addStep(o[l],Math.floor(v),C,b),u.push(o[l]),l++}}catch(g){f.e(g)}finally{f.f()}return e.updateSteps(!0),e.sequencerEngine.dispatch(Object(j.jf)(u)),u},R=function(e){var t,n=1/0,r=x(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=Object(d.a)(a,2),o=i[0],s=i[1];n>s&&(n=s,o)}}catch(c){r.e(c)}finally{r.f()}return n},M=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){e.clear;var t=e.track,n=e.selectedSteps,r=Object(u.useRef)([]),a=Object(u.useRef)(n),i=Object(u.useRef)(void 0),o=(Object(u.useRef)(0),Object(u.useRef)(1),Object(u.useState)(1)),s=Object(d.a)(o,2),c=s[0],f=s[1];Object(u.useEffect)(function(){a.current&&(r.current=t.getEasyPattern().getStepNumbers(a.current,void 0,!0))},[]);var h=Object(u.useCallback)(function(e){var n=e.target.value,o=i.current||a.current;i.current=N(t,o,r.current,n),f(n)},[t,f]);return l.a.createElement(k,{name:"Expand",value:c,min:.1,max:8,step:.01,onChange:h})}),A=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){e.clear;var t=e.track,n=e.selectedSteps,r=Object(u.useRef)([]),a=Object(u.useState)(1.2),i=Object(d.a)(a,2),o=i[0],s=i[1],c=Object(u.useRef)(o),f=Object(u.useRef)(n),h=Object(u.useRef)(void 0);Object(u.useRef)(0),Object(u.useRef)(1);Object(u.useEffect)(function(){c.current=o},[o]);var p=Object(u.useState)(1),m=Object(d.a)(p,2),v=m[0],b=m[1];Object(u.useEffect)(function(){f.current&&(r.current=t.getEasyPattern().getStepNumbers(f.current,void 0,!0))},[]);var g=Object(u.useCallback)(function(e){var n=e.target.value,a=h.current||f.current;h.current=N(t,a,r.current,n,c.current),b(n)},[t,b,o]);return[l.a.createElement(k,{name:"Expand",value:v,min:.1,max:8,step:.01,onChange:g}),l.a.createElement(k,{name:"Exponent",value:o,min:1,max:2,step:.01,onChange:function(e){return s(e.target.value)}})]});function q(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=new p.a(32,!1),_=function(e){var t,n,r=1/0,a=q(e);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=Object(d.a)(i,2),s=o[0],c=o[1];r>c&&(r=c,t=s)}}catch(u){a.e(u)}finally{a.f()}return t},F=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){e.clear;var t=e.track,n=e.selectedSteps,r=Object(u.useRef)([]),a=Object(u.useRef)(n),i=Object(u.useRef)(void 0),o=(Object(u.useRef)(0),Object(u.useState)(0)),s=Object(d.a)(o,2),c=s[0],f=s[1];Object(u.useEffect)(function(){a.current&&(r.current=t.getEasyPattern().getStepNumbers(a.current,void 0,!0))},[]);var h=Object(u.useCallback)(function(e){var n=e.target.value,o=i.current||a.current;i.current=function(e,t,n,r){_(n);var a=t.map(function(e){return e.getCopy(!0,!1)}),i=e.getEasyPattern();i.deleteSteps(t);var o,s=[],c=0,u=q(n);try{for(u.s();!(o=u.n()).done;){var l=o.value,f=Object(d.a)(l,2),h=f[0],p=f[1],m=h.transpose+Math.ceil(c*r),v=p-Math.floor(p);a[c].transpose=m,i.addStep(a[c],Math.floor(p),I,v),s.push(a[c]),c++}}catch(b){u.e(b)}finally{u.f()}return e.updateSteps(!0),e.sequencerEngine.dispatch(Object(j.jf)(s)),s}(t,o,r.current,n),f(n)},[t,f]);return l.a.createElement(k,{name:"Spread",value:c,min:-8,max:8,step:.01,onChange:h})}),L=n(39),B=n.n(L),z=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.modes,n=e.setMode,r=e.mode,a=(e.name,e.clear),i=e.children,o=e.className;return l.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"piano-utility "+o},l.a.createElement("div",{className:"utility-header"},l.a.createElement(B.a,{options:t,onChange:function(e){return n(e.value)},value:t.find(function(e){return e.value===r})}),l.a.createElement("div",{onClick:a,className:"clear-btn"},"x")),i)}),V=n(29),H=n(96),U=new V.a,J=[{value:"CHOPPING",label:"Chop Notes"},{value:"STRUMMING",label:"Strum Notes"},{value:"EXPANDING",label:"Expand Notes"},{value:"EXPONENTIAL_EXPANDING",label:"Exponential Expand Notes"},{value:"SPREADING",label:"Spread Notes"}],G=Object(y.b)(function(e,t){return{steps:e.tracks.trackSteps[t.track.id],selectedSteps:e.keyboard.selectedPianoRollSteps}},function(e){return{mouseDown:function(t){return e(Object(j.n)(t))},setStepToCopy:function(t){return e(Object(j.Cg)(t))},setIsDraggingDuration:function(t){return e(Object(j.Dc)(t))},setStepDataDragging:function(t){return e(Object(j.xg)(t))},setTransposeDragging:function(t){return e(Object(j.th)(t))},setSelectedSteps:function(t){return e(Object(j.jf)(t))}}})(function(e){var t=e.steps,n=(e.xScale,e.mouseDown),r=e.setStepToCopy,a=e.setIsDraggingDuration,i=e.setStepDataDragging,o=e.setTransposeDragging,s=e.setSelectedSteps,c=e.selectedSteps,h=void 0===c?[]:c,p=e.track,v=e.dropdownPos,b=e.clear,g=Object(u.useState)(void 0),y=Object(d.a)(g,2),k=y[0],O=y[1],j=Object(u.useCallback)(function(){console.log("CLEAR CALLED"),f({mouseDown:n,setStepToCopy:r,setIsDraggingDuration:a,setStepDataDragging:i,setTransposeDragging:o}),O(void 0),b()},[b,O]);Object(u.useEffect)(function(){return window.addEventListener("click",j),function(){return window.removeEventListener("click",j)}},[]),Object(u.useEffect)(function(){O(void 0)},[v]);var w=Object(u.useCallback)(function(e){h.forEach(function(e){return e.slide=!e.slide}),s(void 0),j()},[h,p,s,b,O]);if(!v)return[];var S={top:v.y+28,left:v.x},x=(t&&t.length,H.c,h.length),T="";if(k){var C="",N="",R="";"CHOPPING"===k?(N="Chopper",R="chopper",C=l.a.createElement(E,{clear:j,track:p,selectedSteps:h})):"STRUMMING"===k?(N="Strummer",C=l.a.createElement(P,{clear:j,track:p,selectedSteps:h})):"EXPANDING"==k?(N="Expander",C=l.a.createElement(M,{clear:j,track:p,selectedSteps:h})):"EXPONENTIAL_EXPANDING"==k?(N="Exponential Expander",C=l.a.createElement(A,{clear:j,track:p,selectedSteps:h})):"SPREADING"==k&&(N="Spreader",C=l.a.createElement(F,{clear:j,track:p,selectedSteps:h})),T=l.a.createElement(z,{modes:J,setMode:O,mode:k,name:N,className:R,clear:j},C)}else T=[l.a.createElement("div",{className:"menu-header"},l.a.createElement("div",{style:{backgroundColor:U.getColorForTrack(p)},className:"dot"}),l.a.createElement("div",{className:"header-text"},x>0?x:"No"," ",1===x?"step":"steps"," selected")),l.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"menu-items"},l.a.createElement("div",{onClick:w,className:"menu-item"},h.every(function(e){return e.slide})?"Unslide Notes":"Slide Notes",l.a.createElement("img",{src:"/slider-icon.svg",className:"utility-icon"})),l.a.createElement("div",{onClick:function(){return O("CHOPPING")},className:"menu-item"},"Chop Notes",l.a.createElement("img",{src:"/chopper-icon.svg",className:"utility-icon"})),l.a.createElement("div",{onClick:function(){return O("STRUMMING")},className:"menu-item"},"Strum Notes",l.a.createElement("img",{src:"/strummer-icon.svg",className:"utility-icon"})),l.a.createElement("div",{onClick:function(){return O("EXPANDING")},className:"menu-item"},"Expand Notes",l.a.createElement("img",{src:"/expander-icon.svg",className:"utility-icon"})),l.a.createElement("div",{onClick:function(){return O("EXPONENTIAL_EXPANDING")},className:"menu-item"},"Expanding Notes",l.a.createElement("img",{src:"/expander-icon.svg",className:"utility-icon"})),l.a.createElement("div",{onClick:function(){return O("SPREADING")},className:"menu-item"},"Spread Notes",l.a.createElement("img",{src:"/spreader-icon.svg",className:"utility-icon"})),l.a.createElement("div",{onClick:function(){return Object(m.b)(p,h)},className:"menu-item"},"Legato Notes",l.a.createElement("img",{src:"/legato-icon.svg",className:"utility-icon"})))];return l.a.createElement("div",{style:S,className:"piano-context-menu"},T)}),W=n(59),K=Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setAutoScroll,n=e.autoScroll,r=Object(u.useState)(!1),a=Object(d.a)(r,2),i=a[0],o=a[1],s=Object(u.useCallback)(function(){t(!n)},[t,n]);return l.a.createElement("div",{className:"piano-roll-dropdown"},l.a.createElement(W.c,{className:"view-dropdown",show:i?"true":"false",isOpen:i,toggle:function(){return o(!i)}},l.a.createElement(W.f,{size:"sm",caret:!0,color:"primary"},l.a.createElement("img",{className:"piano-roll-actions",src:"/automation-icon-disabled.png"})),l.a.createElement(W.e,null,l.a.createElement(W.d,{onClick:s,key:"",size:"sm"},"Auto-Scroll ",n?l.a.createElement("span",{className:"small_checkmark"},l.a.createElement("div",{className:"small_checkmark_stem"}),l.a.createElement("div",{className:"small_checkmark_kick"})):""))))}),X=n(77),Q=Object(y.b)(function(e,t){var n=t.track.sequencerEngine;if(!t.autoScroll)return{playing:n.playing};e.sequencer.displayResolution;if(void 0!==t.track.pattern.startStep)return{currentStep:n.trackStep-t.track.pattern.startStep};var r=n.trackStepReal||0;return{currentStep:r=Math.ceil(t.track.getPatternStep(r)/(X.a.baseResolution.numSteps()/e.sequencer.displayResolution.numSteps())),playing:n.playing}},function(e){return{}})(function(e){e.track;var t=e.xScale,n=e.steps,r=e.scroll,a=e.currentStep,i=e.autoScroll,o=e.playing,s=e.leftSpace,c=Object(u.useState)(0),f=Object(d.a)(c,2),h=f[0],p=f[1],m=Object(u.useState)(0),v=Object(d.a)(m,2),b=(v[0],v[1]),g=Object(u.useRef)(0),y=Object(u.useState)(void 0),k=Object(d.a)(y,2),O=k[0],j=k[1],w=n?n.length:0;if(i&&o&&void 0!==a){var E=a*t*36-(window.innerWidth-s)/2;r.current.scrollTo(E,0)}var S=Object(u.useCallback)(function(e){e.stopPropagation();var t=e.clientX-s,n=h*(window.innerWidth-s)/100;j(t-n)},[j,h,t]);Object(u.useEffect)(function(){return window.addEventListener("mousemove",x),window.addEventListener("mouseup",P),function(){window.removeEventListener("mousemove",x),window.removeEventListener("mouseup",P)}},[O,h,p,t,w]);var P=Object(u.useCallback)(function(){return j(void 0)},[j]),x=Object(u.useCallback)(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O;if(void 0!==n){var a=(e.clientX-s-n)/(window.innerWidth-s-240)*(w*t*36);r.current.scroll(a,0)}},[O,h,p,t,w]);Object(u.useEffect)(function(){return r.current&&r.current.addEventListener("scroll",T),function(){return r.current?r.current.removeEventListener("scroll",T):[]}},[T,p,b,t,n]),Object(u.useEffect)(function(){T()},[t,T,w,b,p]);var T=Object(u.useCallback)(function(e){if(n){var a=n.length*t*36,i=r.current.scrollLeft/a,o=(window.innerWidth-s-240)/a;p(100*i),g.current=100*o,b(100*o)}},[p,b,t,n]),C={width:g.current+"%",left:h+"%"};return l.a.createElement("div",{onMouseDown:S,style:C,className:"scrolled-area"})}),Y=Object(y.b)(function(e,t){var n=e.sequencer.displayResolution;if(void 0!==t.track.pattern.startStep)return{resolution:n,currentStep:t.sequencerEngine.trackStep-t.track.pattern.startStep};var r=t.sequencerEngine.trackStepReal||0;return{currentStep:r=Math.ceil(t.track.getPatternStep(r)/(X.a.baseResolution.numSteps()/e.sequencer.displayResolution.numSteps())),resolution:n}},function(e){return{}})(function(e){e.xScale;var t=e.currentStep,n=e.stepsLength,r=e.leftSpace,a={left:t/n*(window.innerWidth-r-240)-9};return l.a.createElement("div",{style:a,className:"piano-scroll-play-tick"})}),Z=Object(u.memo)(function(e){var t=e.stepNumber,n=(e.step,e.length),r=e.note,a=e.duration,i=e.minNote,o=e.maxNote,s=e.color,c=(r-i)/(o-i),u={left:t/n*100+"%",width:a/n*100+"%",bottom:Math.min(93,100*c)+"%",backgroundColor:s};return l.a.createElement("div",{style:u,className:"piano-step"})}),$=Object(y.b)(function(e,t){var n=e.tracks.trackSteps[t.track.id],r=e.tracks.trackPianoRollSteps[t.track.id],a=e.tracks.trackPianoRollDurations[t.track.id];return{resolution:e.sequencer.displayResolution,steps:n,durations:a,pianoSteps:r}},function(e){return{}})(function(e){var t=e.steps,n=e.scroll,r=e.track,a=e.durations,i=e.pianoSteps,o=e.color,s=e.xScale,c=e.leftSpace,f=Object(u.useState)(!1),h=Object(d.a)(f,2),p=h[0],m=h[1],v=t?t.length:0,b=Object(u.useCallback)(function(e){var t=(e.clientX-c)/(window.innerWidth-c)*(v*s*36);n.current.scroll(t,0)},[s,v]);return void 0===t?[]:l.a.createElement("div",{className:"piano-roll-top"},l.a.createElement(K,{setAutoScroll:m,autoScroll:p}),l.a.createElement("div",{onMouseDown:b,className:"piano-roll-scroll"},l.a.createElement(Y,{leftSpace:c,stepsLength:v,xScale:s,sequencerEngine:r.sequencerEngine,track:r}),l.a.createElement(Q,{leftSpace:c,autoScroll:p,scroll:n,steps:t,track:r,xScale:s}),Object.keys(i).filter(function(e){return i[e]}).map(function(e){return Object.keys(i[e]).map(function(n,r){return l.a.createElement(Z,{key:r,color:o,minNote:-46,maxNote:46,duration:a[e][n],note:e,length:t.length,stepNumber:n})})})))}),ee=new p.a(32,!1),te=Object(u.memo)(function(e){var t=e.controlParameter,n=void 0===t?"velocity":t,r=e.color,a=(e.duration,e.note),i=e.stepNumber,o=e.xScale,s=e.track,c=e.resolution,f=(e.currentVelocity,e.setSelectedPianoRollSteps),h=e.selectedPianoRollSteps,p=e.controlRef,m=e.mouseDown,v=e.controlMouseDown,b=function(e,t,n,r){var a=ee.transformStepAtResolution2(t,r),i=a-Math.floor(a);return e.getEasyPattern().pattern.getPolyphonicStepsAtResolution(Math.floor(a),ee).filter(function(e){return e.position===i}).map(function(e){return e.step}).find(function(e){return e.transpose===n})}(s,parseFloat(i),parseFloat(a),c),g=Object(u.useState)(void 0),y=Object(d.a)(g,2),k=(y[0],y[1]),O=Object(u.useCallback)(function(e){if(m.current){var t=p.current.getBoundingClientRect(),r=e.clientY-t.top,a=Math.max(1,80-r),i=Math.min(1,a/80),o=b[n+"Parameter"],s=o.min+i*(o.max-o.min);b[n]=s,k(s)}},[s,b,n,k,i]),j=Object(u.useCallback)(function(e){e.stopPropagation(),v.current=!0;var t=s.sequencerEngine.state.keyboard.selectedPianoRollSteps;t&&t.includes(b)||f([b])},[b]);if(!b)return[];var w=b[n],E=b[n+"Parameter"],S=E.min,P=(w-S)/(E.max-S),x=Math.max(1,Math.min(80,80*P)),T={left:i*H.c*o-4},C={left:i*H.c*o,height:x,top:80-x,backgroundColor:r,zIndex:Math.round(1e3/Math.abs(w))},N="step-control-circle",R=h&&h.includes(b);R&&(N+=" selected");var M={backgroundColor:r};return[l.a.createElement("div",{data:w+","+T.zIndex,onMouseOver:O,style:T,className:"step-control-container"},R?l.a.createElement("div",{className:"param-tooltip"},w):""),l.a.createElement("div",{style:C,className:"step-control"},l.a.createElement("div",{onMouseDown:j,style:M,className:N}))]}),ne=Object(y.b)(null,function(e){return{setSelectedPianoRollSteps:function(t){return e(Object(j.jf)(t))}}})(te);function re(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ie=Object(y.b)(function(e,t){var n=e.tracks.trackSteps[t.track.id],r=e.tracks.trackPianoRollSteps[t.track.id];e.tracks.trackPianoRollDurations[t.track.id];return{resolution:e.sequencer.displayResolution,steps:n,pianoSteps:r,selectedPianoRollSteps:e.keyboard.selectedPianoRollSteps,pattern:t.track.getEasyPattern().pattern,selectedTrack:e.mix.selectedTrack}},function(e){return{setSelectedPianoRollSteps:function(t){return e(Object(j.jf)(t))},mouseDown:function(t){return e(Object(j.n)(t))}}})(function(e){var t=e.xScale,n=e.pattern,r=e.controlParameter,a=e.color,i=e.style,o=e.track,s=(e.steps,e.pianoSteps),c=e.resolution,f=e.setSelectedPianoRollSteps,h=e.selectedPianoRollSteps,p=Object(u.useRef)(void 0),m=Object(u.useRef)(!1),v=Object(u.useRef)(!1),b=Object(u.useState)(void 0),g=Object(d.a)(b,2),y=g[0],k=g[1],O=Object(u.useCallback)(function(e){f(void 0),m.current=!1,v.current=!1},[]),j=Object(u.useCallback)(function(e){var t=o.sequencerEngine.state.keyboard.selectedPianoRollSteps;if(v.current&&t){var n,a=0,i=re(t);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s){var c=p.current.getBoundingClientRect(),u=e.clientY-c.top,l=Math.max(1,80-u),f=Math.min(1,l/80),h=s[r+"Parameter"];a=h.min+f*(h.max-h.min),s[r]=a}}}catch(d){i.e(d)}finally{i.f()}k(a)}},[k,r]);return s?l.a.createElement("div",{onMouseDown:function(){m.current=!0},onMouseLeave:function(){m.current=!1,v.current=!1},onMouseMove:j,onMouseUp:O,ref:p,className:"controller",style:i},Object.keys(s).filter(function(e){return s[e]}).map(function(e){return Object.keys(s[e]).map(function(i,s){return l.a.createElement(ne,{key:e+"-"+s,mouseDown:m,controlMouseDown:v,controlParameter:r,currentVelocity:y,selectedPianoRollSteps:h,track:o,controlRef:p,color:a,pattern:n,note:parseFloat(e),resolution:c,xScale:t,stepNumber:parseFloat(i)})})})):l.a.createElement("div",{className:"controller",style:i})}),oe=(n(2375),[{label:"Velocity",value:"velocity"},{label:"Panning",value:"panning"},{label:"Chop",value:"chop"},{label:"Release",value:"release"},{label:"Probability",value:"probability"}]),se=Object(y.b)(function(e,t){return{}},function(e){return{mouseDown:function(t){return e(Object(j.n)(t))}}})(function(e){var t=e.scroll,n=e.xScale,r=e.track,a=(e.resolution,e.color),i=e.mouseDown,o=Object(u.useState)("velocity"),s=Object(d.a)(o,2),c=s[0],f=s[1],h={width:H.c*n*r.getEasyPattern().pattern.length()*2},p=Object(u.useRef)(void 0);Object(u.useEffect)(function(){return p.current.addEventListener("mousewheel",m,{passive:!1}),function(){return p.current&&p.current.removeEventListener("mousewheel",m)}},[t]);var m=Object(u.useCallback)(function(e){e.preventDefault();var n=e.deltaX;return t.current.scrollTo(t.current.scrollLeft+n,0),!1},[t]);Object(u.useEffect)(function(){return t.current&&t.current.addEventListener("scroll",v),function(){return t.current&&t.current.removeEventListener("scroll",v)}},[t.current]);for(var v=Object(u.useCallback)(function(e){p.current&&t.current&&p.current.scrollTo(t.current.scrollLeft,0)},[t]),b=[],g=0;g<2e3;g++)b.push(g);return l.a.createElement("div",{onMouseUp:function(){return i(!1)},className:"piano-roll-control"},l.a.createElement("div",{style:{backgroundColor:a},className:"control-choice"},l.a.createElement(B.a,{options:oe,onChange:function(e){return f(e.value)},value:oe.find(function(e){return e.value===c}),placeholder:"Parameter"})),l.a.createElement("div",{ref:p,className:"controller-container"},l.a.createElement(ie,{controlParameter:c,color:a,track:r,xScale:n,style:h})))}),ce=Object(y.b)(function(e,t){t.sequencerEngine.getSequenceId();var n=e.sequencer.displayResolution;if(void 0!==t.track.pattern.startStep)return{resolution:n,currentStep:t.sequencerEngine.trackStep-t.track.pattern.startStep};var r=t.sequencerEngine.trackStepReal||0;return{currentStep:r=Math.ceil(t.track.getPatternStep(r)/(X.a.baseResolution.numSteps()/e.sequencer.displayResolution.numSteps())),resolution:n}},function(e){return{}})(function(e){var t=e.currentStep,n=(e.resolution,e.xScale),r=e.height,a={left:Math.max(0,H.c*n*t)-8,height:r};return l.a.createElement("div",{style:a,className:"piano-roll-play-tick"})}),ue=(Object(y.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.color,n=(e.track,{backgroundColor:t});return l.a.createElement("div",{style:n,className:"piano-roll-side-control"})}),n(61)),le=n(38),fe=Object(u.memo)(function(e){var t=Object(u.useState)(!1),n=Object(d.a)(t,2),r=n[0],a=n[1],i={height:H.a*e.scale},o={},s="C"===e.note.note?"note-side-info note-c":"note-side-info",c={},f=e.note.isBlackNote()?"black-note note-name":"white-note note-name";(r||e.isTriggering)&&(s+=" triggering",o.backgroundColor=e.color,e.note.isBlackNote()||(c.backgroundColor=e.color));Object(u.useCallback)(function(t){r&&(e.track.midiEffects.liveInputRelease(e.note.getTranspose(),0),a(!1))},[a,e.note,e.track]);var h=Object(u.useCallback)(function(t){t.stopPropagation();var n=e.track,r=new ue.a;r.copyFrom(n.trackData),r.transpose=e.note.getTranspose(),r.slice=0,r.duration=null,n.midiEffects.liveInputTrigger(r),a(!0)},[a,e.note,e.track]),p=Object(u.useCallback)(function(t){t.stopPropagation(),e.track.midiEffects.liveInputRelease(e.note.getTranspose(),0),a(!1)},[a,e.note,e.track]);return l.a.createElement("div",{style:i,draggable:!1,onMouseOver:function(){return e.onMouseOver(e.note)},onMouseDown:h,onMouseUp:p,className:s},l.a.createElement("div",{style:o,className:f}),l.a.createElement("div",{style:c,className:"note-blank-side"},l.a.createElement(le.a,{condition:"C"===e.note.note},e.note.toString())))}),he=Object(y.b)(function(e,t){return{notesDown:e.keyboard.notesDown,pianoRollSlide:e.keyboard.pianoRollSlide}},function(e){return{setPianoRollSlide:function(t){return e(Object(j.ee)(t))}}})(function(e){var t=e.onMouseOver,n=e.color,r=e.onMouseDown,a=e.onMouseUp,i=e.onMouseMove,o=e.notes,s=e.track,c=e.notesDown,f=void 0===c?[]:c,h=(e.pianoRollSlide,e.setSelectedPianoRollSteps,e.setPianoRollSlide,e.scale),p=e.setScale,d=Object(u.useRef)(void 0);Object(u.useEffect)(function(){return d.current.addEventListener("mousewheel",m,{passive:!1}),function(){d.current&&d.current.removeEventListener("mousewheel",m)}},[p,h]);var m=Object(u.useCallback)(function(e){if(e.preventDefault(),e.ctrlKey){var t=h-.01*e.deltaY;t<=.4&&(t=.4),p(t)}},[p,h]);return l.a.createElement("div",{ref:d,className:"notes-side-panel"},l.a.createElement("div",{style:{backgroundColor:n},className:"side-panel-top"}),o.map(function(e,o){return l.a.createElement(fe,{key:e.getTranspose(),scale:h,onMouseOver:t,isTriggering:f.includes(e.getTranspose()),color:n,onMouseDown:function(t){return r(t,e,o)},onMouseUp:function(e){return a(e)},onMouseMove:function(e){return i(e)},note:e,track:s})}))}),pe=n(1470),de=36,me=30,ve=24;var be=Object(y.b)(function(e,t){return{selection:e.keyboard.pianoRollSelection,notes:e.keyboard.notes}},null)(function(e){if(void 0===e.selection||1===e.selection.numNotes&&1===e.selection.numSteps)return l.a.createElement("div",null);var t=e.xScale*de,n=ve*e.scale,r=(e.notes[0].getTranspose()-e.selection.transpose)*n,a=e.selection.stepNumber*t,i=e.selection.numNotes*n,o=e.selection.numSteps*t,s={left:a,top:r+me,height:i,width:o};return l.a.createElement("div",{style:s,className:"piano-roll-selection"})}),ge=n(79),ye=(n(401),Object(y.b)(function(e,t){return{cursor:e.keyboard.cursor}},null)(function(e){if(void 0===e.cursor)return l.a.createElement("div",null);var t={left:Math.max(3,H.c*e.xScale*e.cursor),height:e.height};return l.a.createElement("div",{style:t,className:"piano-roll-cursor flashit"},l.a.createElement("div",{className:"cursor-top"}))})),ke=n(63),Oe=Object(y.b)(function(e,t){return{resolution:e.sequencer.displayResolution}},function(e,t){return{setPianoRollCursor:function(t){return e(Object(j.Zd)(t))}}})(function(e){var t="",n=e.resolution.isTriplet?3:4,r=e.resolution.isTriplet?12:16;e.xScale<.8&&(n*=2),e.stepNumber%n===0&&(t+=" bar");var a={width:36*e.xScale,minWidth:36*e.xScale,height:e.height};return Math.floor(e.stepNumber/n)%2==1&&(t+=" odd"),e.xScale<.8&&e.stepNumber%2===1&&(a.borderStyle="none"),l.a.createElement("div",{style:a,className:t+" time-grid-step"},l.a.createElement("div",{onClick:function(){e.sequencerEngine.cursor.setStep(e.stepNumber,e.resolution),e.setPianoRollCursor(e.stepNumber)},className:"time-grid-top"},l.a.createElement(le.a,{condition:e.stepNumber%n===0},e.stepNumber%n===0?e.stepNumber/r+1:"")))}),je=32;function we(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var Ee=function(e){Object(o.a)(n,e);var t=we(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).mouseDown=!1,a.lastClick=void 0,a}return Object(a.a)(n,[{key:"width",get:function(){return 36*this.props.resolution.resolution/16}},{key:"onMouseDown",value:function(e){var t=this,n=(new Date).getTime();if(n-this.lastDoubleClick<250)this.props.setMinXScale();else{this.lastDoubleClick=n;var r=e.clientX-53,a=r+this.props.wrapperRef.current.scrollLeft;this.zoomStep=a/(36*this.props.xScale),this.zoomOffset=r,this.mouseDown=!0,this.dragStartY=e.pageY,this.dragY=e.pageY,this.interval&&clearInterval(this.interval),this.interval=setInterval(function(){if(t.mouseDown){var e=t.dragY-t.dragStartY;t.props.zoomHorizontally(e,t.zoomStep,t.zoomOffset)}},25)}}},{key:"onMouseUp",value:function(e){this.mouseDown=!1,this.dragStartY=void 0,this.interval&&(clearInterval(this.interval),this.interval=void 0)}},{key:"onMouseMove",value:function(e){this.mouseDown&&(this.dragY=e.pageY)}},{key:"render",value:function(){var e=this;if(void 0===this.props.track.pattern)return l.a.createElement("div",null);var t=this.props.track.getStepsAtResolution(this.props.resolution),n={width:36*this.props.xScale*this.props.track.getEasyPattern().pattern.length(this.props.resolution)};return l.a.createElement("div",{style:n,onMouseLeave:function(t){return e.onMouseUp(t)},onMouseMove:function(t){return e.onMouseMove(t)},onMouseDown:function(t){return e.onMouseDown(t)},onMouseUp:function(t){return e.onMouseUp(t)},draggable:!1,className:"piano-roll-time-row"},t.map(function(t,n){return l.a.createElement(Oe,{key:"piano-time-"+n,track:e.props.track,isLooping:e.props.isLooping,height:e.props.height,sequencerEngine:e.props.sequencerEngine,resolution:e.props.resolution,xScale:e.props.xScale,stepsLength:e.props.stepsLength,stepNumber:n})}))}},{key:"isAlternateColor",value:function(e,t,n){return Math.ceil((e+1)/t)%2!=0}}]),n}(u.Component),Se=Object(y.b)(function(e,t){t.sequencerEngine.getSequenceId();var n=e.tracks.trackSteps[t.track.subSequence.isTrack?t.track.subSequence.id:t.track.trackNumber];return{resolution:e.sequencer.displayResolution,stepsLength:void 0===n?32:n.length}},function(e,t){return{}})(Ee),Pe=n(46);function xe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var Te=new V.a,Ce=(new p.a(16,!1),X.a.baseResolution),Ne=function(e){Object(o.a)(n,e);var t=xe(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={offset:void 0},a.operationManager=a.props.sequencerEngine.operationManager,a}return Object(a.a)(n,[{key:"scrollLeft",get:function(){if(this.props.parentClassName){var e=this.parentElement||document.getElementsByClassName(this.props.parentClassName)[0];return void 0===this.parentElement&&(this.parentElement=e),e.scrollLeft}return 0}},{key:"width",get:function(){return this.props.xScale*H.c*this.props.resolution.numSteps()/16}},{key:"deleteStep",value:function(){this.operationManager.dispatch(Object(Pe.h)(this.props.track,[this.props.stepData])),this.props.track.updateSteps(),this.props.setSelectedPianoRollSteps(void 0)}},{key:"onMouseDown",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.stopPropagation(),e.preventDefault(),this.props.setPianoRollDragOffset(this.getClickOffset(e)),this.props.mouseDown(!0),this.props.setDragStepTranspose(this.note.getTranspose()),t){var n=this.getStepNumber(e);this.props.setStepDragging(n)}this.props.setStepToCopy(this.props.stepData),this.props.setTransposeDragging(this.note.getTranspose());var r=this.props.stepData;void 0===this.props.selectedPianoRollSteps||this.props.selectedPianoRollSteps.some(function(e){return e.id===r.id})||this.props.setSelectedPianoRollSteps(void 0)}},{key:"getState",value:function(){return this.props.sequencerEngine.store.getState()}},{key:"note",get:function(){return this.getState().keyboard.notes[this.props.noteIndex]||ke.a.NOTES[0]}},{key:"onMouseUp",value:function(e){e.stopPropagation(),e.preventDefault();var t=this.props.stepData,n=this.props.sequencerEngine.store.getState();if(n.keyboard.isDraggingDuration);else if(void 0!==n.keyboard.pianoRollSelection&&n.keyboard.pianoRollSelection.numNotes>1&&n.keyboard.pianoRollSelection.numNotes>1){var r=this.props.track.getEasyPattern().getSelectedPianoRollSteps(n.keyboard.pianoRollSelection,this.props.resolution);this.props.setSelectedPianoRollSteps(r),this.props.setSelectedFreeze(void 0),this.props.setPianoRollSelection(void 0)}else void 0===n.keyboard.pianoRollSelection&&(this.isSelectedStep()?void 0===n.keyboard.stepDataDragging||t.id!==n.keyboard.stepDataDragging.id?(this.deleteStep(),this.props.setSelectedPianoRollSteps(void 0),this.props.track.updateSteps()):this.snapToGridIfNecessary():(this.props.setSelectedPianoRollSteps([this.props.stepData]),this.props.setSelectedFreeze(void 0),this.props.setPianoRollSelection(void 0)));f(this.props)}},{key:"dragStepDuration",value:function(e){this.props.setIsDraggingDuration(!0),this.props.setStepAndDataDragging(parseFloat(this.props.stepNumber)+parseFloat(this.props.position),this.getState().keyboard.stepToCopy),this.onMouseDown(e,!1)}},{key:"isSelectedStep",value:function(){return void 0!==this.props.selectedPianoRollSteps&&this.props.selectedPianoRollSteps.indexOf(this.props.stepData)>-1}},{key:"moveSteps",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[this.props.stepData],n=this.getClickOffset(e)/(H.c*this.props.xScale),r=this.props.position;n+=parseFloat(r);var a=this.getState().keyboard.dragOffset||0;a/=H.c*this.props.xScale,a+=parseFloat(r);var i=parseFloat(n)-parseFloat(a),o={stepDifference:Ce.transformStepAtResolution2(i,this.props.resolution),transposeDifference:0};Math.abs(o.stepDifference)<=.001||this.operationManager.dispatch(Object(Pe.m)(this.props.track,t,o,Ce,!0,!0))}},{key:"getStepNumber",value:function(e){return(this.scrollLeft+e.pageX-H.b)/(H.c*this.props.xScale)}},{key:"getClickOffset",value:function(e){return this.scrollLeft+e.pageX-this.getLeft()-62}},{key:"onMouseMove",value:function(e){e.stopPropagation();var t=this.getState(),n=t.keyboard.isMouseDown,r=t.keyboard.pianoRollSelection;if(n&&!t.keyboard.isDraggingDuration&&void 0===r){var a=this.getStepNumber(e);if(t.keyboard.stepDataDragging&&t.keyboard.stepDataDragging!==this.props.stepData)return;this.props.setStepAndDataDragging(a,t.keyboard.stepToCopy),void 0!==t.keyboard.selectedPianoRollSteps&&t.keyboard.selectedPianoRollSteps.length>1?this.moveSteps(e,t.keyboard.selectedPianoRollSteps):this.moveSteps(e)}else if(n&&this.getState().keyboard.isDraggingDuration){var i=this.getClickOffset(e)/this.width;this.updateDuration(i+.1)}}},{key:"updateDuration",value:function(e){var t=this;e=Math.max(.1,e);var n=this.getState().keyboard.stepToCopy.getStepDataForTranspose(this.note.getTranspose(),!0);if(void 0!==n){var r=e/n.duration;this.operationManager.dispatch(Object(Pe.w)(this.props.track,n,n.durationParameter,e));var a=this.getState();if(void 0!==a.keyboard.selectedPianoRollSteps){if(r!==1/0){var i=this.props.track.trackData.duration;a.keyboard.selectedPianoRollSteps.filter(function(e){return e!==n}).forEach(function(e){return t.operationManager.dispatch(Object(Pe.w)(t.props.track,e,e.durationParameter,Math.max(.1,null!==e.duration?e.duration*r:i*r)))})}this.props.track.updateSteps()}this.setState(this.state)}}},{key:"snapToGridIfNecessary",value:function(){if(this.getState().sequencer.quantized&&!this.props.resolution.isTriplet){var e=this.getState().keyboard.selectedPianoRollSteps;this.operationManager.dispatch(Object(Pe.r)(this.props.track,e,this.props.resolution)),this.props.track.updateSteps()}}},{key:"getLeft",value:function(){var e=this.props.position*H.c*this.props.xScale;return this.props.stepNumber*H.c*this.props.xScale+e}},{key:"getStyle",value:function(){var e={left:this.getLeft(),height:this.props.height};return this.props.stepData?e.width=this.width*this.props.stepData.duration:e.width=this.width*this.props.duration,this.isSelectedStep()?(e.borderColor=this.props.color,e.backgroundColor=Te.brighten(this.props.color,.3)):e.backgroundColor=this.props.color,e}},{key:"render",value:function(){var e=this,t=this.props.isAlternateColor?"alternate ":"";return t+=this.isSelectedStep()?" selected ":"",this.props.isGuideStep&&(t+=" guide-step"),l.a.createElement("div",{draggable:!1,onMouseMove:function(t){return e.onMouseMove(t)},onMouseDown:function(t){return e.onMouseDown(t)},onMouseUp:function(t){return e.onMouseUp(t)},style:this.getStyle(),className:t+" grid-step toggled-grid-step on"},this.props.on?l.a.createElement("div",{draggable:!1,onMouseDown:function(t){return e.dragStepDuration(t)},className:"right-edge"}):"")}}]),n}(u.Component),Re=(Object(y.b)(null,function(e,t){return{mouseDown:function(t){return e(Object(j.n)(t))},dragToggle:function(t){return e(Object(j.l)(t))},setStepDragging:function(t){return e(Object(j.yg)(t))},setStepToCopy:function(t){return e(Object(j.Cg)(t))},setTransposeDragging:function(t){return e(Object(j.th)(t))},setDragStepTranspose:function(t){return e(Object(j.k)(t))},setIsDraggingDuration:function(t){return e(Object(j.Dc)(t))},setStepDataDragging:function(t){return e(Object(j.xg)(t))},setStepAndDataDragging:function(t,n){return e(Object(j.wg)(t,n))},setPianoRollSelection:function(t,n,r,a){return e(Object(j.de)(t,n,r,a))},setSelectedPianoRollSteps:function(t){return e(Object(j.jf)(t))},setPianoRollDragOffset:function(t){return e(Object(j.ae)(t))},setSelectedFreeze:function(t){return e(Object(j.Ye)(t))}}})(Ne),n(28)),Me=(n(166),new V.a),Ae=new p.a(32,!1),qe=function(e){var t=e.parentClassName,n=e.xScale,r=e.leftSpace,a=void 0===r?H.b:r,i=Object(u.useRef)(void 0),o=Object(u.useCallback)(function(){if(t){var e=i.current||document.getElementsByClassName(t)[0];return void 0===i.current&&(i.current=e),e.scrollLeft}return 0},[t,a]),s=Object(u.useCallback)(function(e){return o()+e.pageX-c(e)-a},[n,t,a]),c=Object(u.useCallback)(function(e){return l(e)*H.c*n},[n,t,a]),l=Object(u.useCallback)(function(e){return(o()+e.pageX-a)/(H.c*n)},[n,t,a]);return{getStepNumber:l,getScrollLeft:o,getLeft:c,getOffset:s}},De=function(e,t){e.sequencerEngine.operationManager.dispatch(Object(Pe.h)(e,[t]))},Ie=function(e,t,n){var r=e.sequencerEngine.state;if(!r.sequencer.quantized||n.metaKey||n.altKey)e.updateSteps();else{var a=r.keyboard.selectedPianoRollSteps;e.sequencerEngine.operationManager.dispatch(Object(Pe.r)(e,a,t))}},_e=function(e){return void 0!==e.keyboard.pianoRollSelection&&e.keyboard.pianoRollSelection.numNotes>1&&e.keyboard.pianoRollSelection.numNotes>1},Fe=function(e,t){return void 0===e.keyboard.stepDataDragging||t.id!==e.keyboard.stepDataDragging.id},Le=(new V.a,new p.a(16,!1),X.a.baseResolution,Object(u.memo)(function(e){var t=e.isGuideStep,n=(e.leftSpace,e.noteIndex),r=(e.isAlternateColor,e.sequencerEngine),a=(e.selectedPianoRollSteps,e.stepData),i=(e.height,e.duration,e.color,e.xScale,e.resolution,e.position,e.stepNumber,e.parentClassName,e.setPianoRollDragOffset,e.mouseDown,e.setDragStepTranspose,e.setStepDragging,e.setStepToCopy,e.setTransposeDragging,e.setSelectedPianoRollSteps,function(e){var t=e.selectedPianoRollSteps,n=e.stepData,r=e.isAlternateColor,a=e.xScale,i=e.resolution,o=e.position,s=e.stepNumber,c=e.height,u=e.duration,l=e.color,f=e.isGuideStep,h=e.track,p=void 0!==t&&t.indexOf(n)>-1,d=a*H.c*i.numSteps()/16,m=o*H.c*a,v=s*H.c*a+m,b=n?n.duration:u,g=Ae.transformStepAtResolution(s,i);h||(h={length:32});g+2*b>h.length&&(b-=(g+2*b-h.length)/2);var y={left:v,height:c,lineHeight:c+"px",fontSize:Math.min(16,c)+"px",width:d*b,backgroundColor:p?Me.brighten(l,.3):l};p&&(y.borderColor=l);var k=r?"alternate ":"";k+=p?" selected ":"",f&&(k+=" guide-step");var O={};return!f&&n.slide&&(O.borderLeftWidth=y.width-2,O.borderBottomWidth=.8*c),{className:k,style:y,slideStyle:O}}(e)),o=i.style,s=i.className,c=i.slideStyle,h=function(e){var t=e.setSampleExplorerSelected,n=e.sequencerEngine,r=e.stepData,a=e.track,i=e.resolution,o=e.xScale,s=e.parentClassName,c=e.noteIndex,l=(e.selectedPianoRollSteps,e.position),h=e.stepNumber,p=e.setPianoRollDragOffset,d=e.mouseDown,m=e.setDragStepTranspose,v=e.setStepDragging,b=e.setStepToCopy,g=e.setSelectedPianoRollSteps,y=(e.setStepIsDraggingDuration,e.setStepDataDragging),k=e.setTransposeDragging,O=e.setPianoRollSelection,j=e.setSelectedFreeze,w=e.setIsDraggingDuration,E=e.leftSpace,S=e.setStepAndDataDragging,P=a&&a.sequencerEngine.state.keyboard.notes[c]||ke.a.NOTES[0],x=qe({xScale:o,parentClassName:s,leftSpace:E}),T=x.getScrollLeft,C=x.getStepNumber,N=Object(u.useCallback)(function(e){if(2!==e.button&&a){e.stopPropagation(),e.preventDefault();var o=n.store.getState();o.keyboard.isDraggingDuration||(_e(o)?A():void 0===o.keyboard.pianoRollSelection&&(void 0!==o.keyboard.selectedPianoRollSteps&&o.keyboard.selectedPianoRollSteps.indexOf(r)>-1?Fe(o,r)?e.metaKey||e.altKey||(De(a,r),g(void 0)):Ie(a,i,e):q())),f({mouseDown:d,setStepToCopy:b,setIsDraggingDuration:w,setStepDataDragging:y,setTransposeDragging:k,setSampleExplorerSelected:t})}},[r,a]),R=Object(u.useCallback)(function(e){var t=l*H.c*o,n=h*H.c*o+t;return T()+e.pageX-n-62},[l,h,a]),M=Object(u.useCallback)(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(a){if(e.stopPropagation(),e.preventDefault(),p(R(e)),d(!0),m(P.getTranspose()),t){var n=C(e);v(n)}b(r),k(P.getTranspose());var i=a.sequencerEngine.state.keyboard.selectedPianoRollSteps;void 0!==i&&i.some(function(e){return e&&e.id===r.id})||g([r])}},[P,C,r,a]),A=Object(u.useCallback)(function(){if(a){var e=n.state,t=a.getEasyPattern().getSelectedPianoRollSteps(e.keyboard.pianoRollSelection,i,!0);g(t),j(void 0),O(void 0)}},[a]),q=Object(u.useCallback)(function(){r.id,g([r]),j(void 0),O(void 0)},[r,a]),D=Object(u.useCallback)(function(e){a&&(w(!0),S(parseFloat(h)+parseFloat(l),a.sequencerEngine.state.keyboard.stepToCopy),M(e,!1))},[h,l,a,r]);return{getStepNumber:C,onMouseUp:N,onMouseDown:M,dragStepDuration:D}}(e),p=h.onMouseDown,d=h.onMouseUp,m=h.dragStepDuration,v=r.store.getState().keyboard.notes[n]||ke.a.NOTES[0];return l.a.createElement("div",{style:o,onMouseDown:p,onMouseUp:d,className:s+" grid-step toggled-grid-step on"},t?"":l.a.createElement("div",{className:"grid-note"},v.toString()),!t&&a.slide?l.a.createElement("div",{style:c,className:"grid-slide"}):"",l.a.createElement("div",{draggable:!1,onMouseDown:m,className:"right-edge"}))})),Be=Object(y.b)(null,function(e,t){return{mouseDown:function(t){return e(Object(j.n)(t))},dragToggle:function(t){return e(Object(j.l)(t))},setStepDragging:function(t){return e(Object(j.yg)(t))},setStepToCopy:function(t){return e(Object(j.Cg)(t))},setTransposeDragging:function(t){return e(Object(j.th)(t))},setDragStepTranspose:function(t){return e(Object(j.k)(t))},setIsDraggingDuration:function(t){return e(Object(j.Dc)(t))},setStepDataDragging:function(t){return e(Object(j.xg)(t))},setStepAndDataDragging:function(t,n){return e(Object(j.wg)(t,n))},setPianoRollSelection:function(t,n,r,a){return e(Object(j.de)(t,n,r,a))},setSelectedPianoRollSteps:function(t){return e(Object(j.jf)(t))},setPianoRollDragOffset:function(t){return e(Object(j.ae)(t))},setSelectedFreeze:function(t){return e(Object(j.Ye)(t))},setSampleExplorerSelected:function(t){return e(Object(j.Ie)(t))}}})(Le),ze=new p.a(32,!1),Ve=new V.a,He=new ue.a;window.renders=0;var Ue=Object(y.b)(function(e,t){var n=void 0===e.keyboard.notes[t.noteIndex]?0:e.keyboard.notes[t.noteIndex].getTranspose(),r=e.tracks.trackPianoRollSteps[t.track.subSequence.isTrack?t.track.subSequence.id:t.track.id],a=e.tracks.trackPianoRollPositions[t.track.subSequence.isTrack?t.track.subSequence.id:t.track.id],i=e.tracks.trackPianoRollDurations[t.track.subSequence.isTrack?t.track.subSequence.id:t.track.id];return{rowSteps:r?r[n]:void 0,rowDurations:i?i[n]:void 0,rowPositions:a?a[n]:void 0,noteTranspose:n,selectedPianoRollSteps:e.keyboard.selectedPianoRollSteps,resolution:e.sequencer.displayResolution,currentPattern:void 0===r?void 0:t.sequencerEngine.currentPattern,patternSelected:e.arrangement.patternSelected}},null)(function(e){var t=e.sequencerEngine,n=e.track,r=e.color,a=e.height,i=e.xScale,o=e.parentClassName,s=e.resolution,c=e.selectedPianoRollSteps,f=e.noteIndex,h=e.leftSpace,p=e.rowSteps,d=void 0===p?{}:p,m=(e.rowDurations,e.rowPositions),v=void 0===m?{}:m;r=Ve.saturate(r,window.saturation||4);var b=t.state;window.renders++;var g=(t.store.getState().keyboard.notes[f]||ke.a.NOTES[0]).getTranspose(),y=b.tracks.allPositions[g]||{},k=b.tracks.allDurations[g]||{},O=b.tracks.allSteps[g]||{},j=Object(u.useCallback)(function(e,r){e=ze.transformStepAtResolution2(parseFloat(e)+parseFloat(r),s);var a=t.store.getState().keyboard.notes[f]||ke.a.NOTES[0],i=n.getEasyPattern(),o=Math.floor(e),c=e-o,u=i.getStepWithTranspose(o,ze,a.getTranspose(),c);return void 0===u?He:u},[f,n,s]),w=b.tracks.trackSteps[n.subSequence.isTrack?n.subSequence.id:n.id],E=w?w.length:0;return l.a.createElement("div",{className:"toggled-piano-roll-steps-container"},Object.keys(O).filter(function(e){return e<E}).map(function(e,r){return l.a.createElement(Be,{key:r,height:a,leftSpace:h,xScale:i,position:y[e],track:n,sequencerEngine:t,resolution:s,parentClassName:o,color:(c=O[e],Ve.getColorForTrack(t.tracks[c])),on:!0,isGuideStep:!0,selectedPianoRollSteps:void 0,duration:k[e],stepNumber:e,noteIndex:f});var c}),Object.keys(d).map(function(e,u){var p,d=v[e],m=j(e,d);return l.a.createElement(Be,(p={key:u,height:a,track:n,xScale:i,position:v[e],sequencerEngine:t,resolution:s,leftSpace:h,parentClassName:o,color:r},Object(Re.a)(p,"track",n),Object(Re.a)(p,"on",!0),Object(Re.a)(p,"selectedPianoRollSteps",c&&c.indexOf(m)>-1?c:void 0),Object(Re.a)(p,"stepData",m),Object(Re.a)(p,"isGuideStep",!1),Object(Re.a)(p,"duration",m.duration),Object(Re.a)(p,"stepNumber",e),Object(Re.a)(p,"noteIndex",f),p))}))}),Je=new p.a(16,!1),Ge=X.a.baseResolution,We=(new p.a(16,!1),X.a.baseResolution,Object(u.memo)(function(e){e.scale;var t=e.xScale,n=e.resolution,r=e.color,a=e.stepsLength,i=e.track,o=e.height,s=e.parentClassName,c=e.noteIndex,h=e.sequencerEngine,d=(e.setSampleExplorerSelected,parseInt(n.numSteps()),function(e){var t=e.setSampleExplorerSelected,n=e.noteIndex,r=e.setArrangementMouseX,a=e.sequencerEngine,i=e.track,o=e.resolution,s=e.setSelectedPianoRollSteps,c=e.setSelectedFreeze,l=e.setPianoRollSelection,h=e.xScale,d=(e.setPianoRollCursor,e.parentClassName),v=e.mouseDown,b=e.setStepToCopy,g=e.setIsDraggingDuration,y=e.setStepDataDragging,k=e.setTransposeDragging,O=e.leftSpace,j=e.setStepDragging,w=e.setDragStepTranspose,E=e.lastDuration,S=qe({xScale:h,parentClassName:d,leftSpace:O}),P=S.getScrollLeft,x=S.getStepNumber,T=S.getOffset,C=a.operationManager,N=Object(u.useCallback)(function(){return a.state.keyboard.notes[n]||ke.a.NOTES[0]},[n]),R=Object(u.useCallback)(function(e){if(e.preventDefault(),v(!0),w(N().getTranspose()),b(A(e)),k(N().getTranspose()),j(x(e)),A(e),a.state,!e.ctrlKey){var t=x(e);l(t,N().getTranspose(),1,1)}},[h,n,i,O]),M=Object(u.useCallback)(function(e){if(2!==e.button){e.preventDefault();var n=a.state;if(n.keyboard.isMouseDown){var u=A(e),d=Math.floor(x(e));if(h<.8&&(d=2*Math.floor(d/2)),n.keyboard.isDraggingDuration);else if(void 0!==n.keyboard.pianoRollSelection&&n.keyboard.pianoRollSelection.numNotes>1&&n.keyboard.pianoRollSelection.numNotes>1){var O=i.getEasyPattern().getSelectedPianoRollSteps(n.keyboard.pianoRollSelection,o,!0);s(O),c(void 0),l(void 0)}else if(void 0===u||void 0!==n.keyboard.stepDataDragging&&u.id===n.keyboard.stepDataDragging.id||!u.on){if(e.metaKey||e.ctrlKey)r(void 0),l(void 0);else if((u!==n.keyboard.stepToCopy||void 0===u||!u.on)&&void 0===n.keyboard.stepDataDragging){var j=new ue.a,w=a.state.keyboard.pianoRollSlide;j.on=!0,j.transpose=N().getTranspose();var S=Math.floor(x(e));if(h<.8&&(j.duration=2,S%2===1&&S--),o.isTriplet)j.duration=16/o.resolution*2/3;else if(void 0!==E.current){var P=i.pattern.length(o),T=new p.a(16,!1),R=o.transformStepAtResolution2(E.current,T),M=Object(m.a)(i,d,o);S+R>P&&(j.duration=T.transformStepAtResolution2(P-d,o)),j.duration=S+R>M?T.transformStepAtResolution2(M-d,o):E.current}C.dispatch(Object(Pe.c)(i,j,S,o,void 0,w)),s(void 0),l(void 0),i.updateSteps()}}else{if(e.metaKey||e.ctrlKey)return;q(e),i.updateSteps()}f({mouseDown:v,setStepToCopy:b,setIsDraggingDuration:g,setStepDataDragging:y,setTransposeDragging:k,setSampleExplorerSelected:t})}}},[i,h,o,n,O]),A=Object(u.useCallback)(function(e){var t=i.getEasyPattern(),n=x(e);if(n>0)return new ue.a;var r=t.getStepWithTranspose(n,o,N().getTranspose());return void 0===r?new ue.a:r},[i,n,h,O]),q=Object(u.useCallback)(function(e){C.dispatch(q(i,A(e),x(e),o)),s(void 0),i.updateSteps()},[i,o,O]),D=Object(u.useCallback)(function(e){var t=e.pageX,n=(P(),a.state),r=n.keyboard.isMouseDown,i=(N().getTranspose(),n.keyboard.pianoRollSelection),o=n.keyboard.selectedPianoRollSteps,s=n.keyboard.isDraggingDuration;r&&!s&&void 0===i?void 0!==o&&o.length>1?I(t)&&y(n.keyboard.stepToCopy):n.keyboard.stepToCopy?I(t,[n.keyboard.stepToCopy])&&y(n.keyboard.stepToCopy):y(n.keyboard.stepToCopy):r&&!s?F(e):r&&s&&L(e)},[n,o,h,i,O]),I=Object(u.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.state.keyboard.selectedPianoRollSteps,n=(i.getEasyPattern(),_(e));if(n.stepDifference,Math.abs(n.stepDifference)<=.0625&&0===n.transposeDifference)return!1;C.dispatch(Object(Pe.m)(i,t,n,Ge,!0,!0));var r=x({pageX:e});return j(r),k(N().getTranspose()),!0},[i,n,h,O]),_=Object(u.useCallback)(function(e){var t=a.store.getState(),n=x({pageX:e})-t.keyboard.stepDragging,r=void 0===t.keyboard.transposeDragging?i.trackData.transpose:t.keyboard.transposeDragging,s=N().getTranspose()-r;return{stepDifference:Ge.transformStepAtResolution2(n,o),transposeDifference:s}},[i,n,o,h,O]),F=Object(u.useCallback)(function(e){var t=a.store.getState(),n=N().getTranspose(),r=t.keyboard.pianoRollSelection;if(void 0!==r){var i=x(e);l(r.stepNumber,r.transpose,i-r.stepNumber,1+r.transpose-n)}},[n,h,i,O]),L=Object(u.useCallback)(function(e){var t=a.state,n=T(e)/(H.c*h)+x(e)-t.keyboard.stepDragging,r=Math.max(.1,Je.transformStepAtResolution2(n,o)),s=(i.trackData.transpose,N().getTranspose(),t.keyboard.stepToCopy);if(void 0!==s){var c=r/(null===s.duration?i.trackData.duration:s.duration);if(E.current=r,C.dispatch(Object(Pe.w)(i,s,s.durationParameter,r)),o.isTriplet&&i.getEasyPattern().pattern.syncBuckets(o.isTriplet),void 0!==t.keyboard.selectedPianoRollSteps&&c!==1/0){var u=i.trackData.duration;t.keyboard.selectedPianoRollSteps.filter(function(e){return e!==s}).forEach(function(e){return C.dispatch(Object(Pe.w)(i,e,e.durationParameter,Math.max(.1,null!==e.duration?e.duration*c:u*c)))})}i.updateSteps()}},[i,h,o,n,O]);return{onMouseDown:R,onMouseUp:M,onMouseOver:D}}(e)),v=d.onMouseDown,b=d.onMouseUp,g=d.onMouseOver;return l.a.createElement("div",{onMouseDown:v,onMouseUp:b,onMouseMove:g,className:"grid-steps-container"},l.a.createElement(Ue,{color:r,stepsLength:a,leftSpace:e.leftSpace,parentClassName:s,noteIndex:c,xScale:t,sequencerEngine:h,height:o,track:i}))}));function Ke(e,t){if(void 0!==e)return t<=e.transpose&&t>e.transpose-e.numNotes?e:void 0}var Xe=Object(y.b)(function(e,t){var n=e.tracks.trackSteps[t.track.subSequence.isTrack?t.track.subSequence.id:t.track.id],r=e.keyboard.notes[t.noteIndex],a=void 0===r?0:r.getTranspose();return{stepsLength:void 0===n?16:n.length,selection:Ke(e.keyboard.pianoRollSelection,a)}},function(e,t){return{mouseDown:function(t){return e(Object(j.n)(t))},dragToggle:function(t){return e(Object(j.l)(t))},setStepDragging:function(t){return e(Object(j.yg)(t))},setStepToCopy:function(t){return e(Object(j.Cg)(t))},setTransposeDragging:function(t){return e(Object(j.th)(t))},setDragStepTranspose:function(t){return e(Object(j.k)(t))},setIsDraggingDuration:function(t){return e(Object(j.Dc)(t))},setStepDataDragging:function(t){return e(Object(j.xg)(t))},setPianoRollSelection:function(t,n,r,a){return e(Object(j.de)(t,n,r,a))},setSelectedPianoRollSteps:function(t){return e(Object(j.jf)(t))},setSelectedFreeze:function(t){return e(Object(j.Ye)(t))},setPianoRollCursor:function(t){return e(Object(j.Zd)(t))},setArrangementMouseX:function(t){return e(Object(j.J)(t))},setSampleExplorerSelected:function(t){return e(Object(j.Ie)(t))}}})(We);function Qe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var Ye=function(e){Object(o.a)(n,e);var t=Qe(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={triggering:!1},a}return Object(a.a)(n,[{key:"onMouseLeave",value:function(e){this.state.triggering&&(this.triggerRelease(e),this.setState({triggering:!1}))}},{key:"transpose",get:function(){return this.props.note.getTranspose()}},{key:"triggerAttack",value:function(e){e.stopPropagation();var t=this.props.track,n=new ue.a;n.copyFrom(t.trackData),n.transpose=this.transpose,n.slice=this.sliceNumber,n.duration=null,t.midiEffects.liveInputTrigger(n),this.setState({triggering:!0})}},{key:"triggerRelease",value:function(e){e.stopPropagation(),this.props.track.midiEffects.liveInputRelease(this.transpose,0),this.setState({triggering:!1})}},{key:"render",value:function(){var e=H.a*this.props.scale;if(void 0===this.props.track.getEasyPattern().pattern)return l.a.createElement("div",null);var t={height:e,width:H.c*this.props.xScale*this.props.track.getEasyPattern().pattern.length(this.props.resolution)},n="piano-roll-row";n+=this.props.note.isBlackNote()?" black":"";this.props.note.note,this.props.note.isBlackNote();return this.state.triggering&&" triggering",l.a.createElement("div",{draggable:!1,style:t,className:n},l.a.createElement(Xe,{lastDuration:this.props.lastDuration,leftSpace:this.props.leftSpace,resolution:this.props.resolution,height:e,color:this.props.color,parentClassName:this.props.parentClassName,sequencerEngine:this.props.sequencerEngine,track:this.props.track,xScale:this.props.xScale,noteIndex:this.props.noteIndex}))}}]),n}(u.Component),Ze=Object(y.b)(null,null)(Ye);function $e(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var et=X.a.baseResolution,tt=function(e){Object(o.a)(n,e);var t=$e(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"getOptions",value:function(){for(var e=2*this.value,t=(this.props.resolution.resolution,[]);e>1;)t.push({label:e,value:e}),e-=4;return t}},{key:"getOptionFromValue",value:function(e){for(var t=this.getOptions(),n=0;n<t.length;n++)if(t[n].value==e)return t[n];return null}},{key:"value",get:function(){return this.props.track.pattern.length(this.props.resolution)}},{key:"onChangeLength",value:function(e,t){e=et.transformStepAtResolution2(e,this.props.resolution),this.props.track.pattern.changeLength(e),this.props.track.updateSteps(),this.setState(this.state)}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"track-length-container"},l.a.createElement("div",{className:"length-label"},"LENGTH"),l.a.createElement(B.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getOptions(),onChange:function(t,n){return e.onChangeLength(t.value,n)},value:this.getOptionFromValue(this.value),placeholder:"Length"}))}}]),n}(u.Component),nt=n(55),rt=n(34),at=n(164),it=n.n(at);function ot(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var st=function(e){Object(o.a)(n,e);var t=ot(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={transcribing:!1},a}return Object(a.a)(n,[{key:"transcribeButton",value:function(){var e=this;this.setState({transcribing:!0,loadingText:"Transcribing to MIDI..."}),setTimeout(function(){e.props.sequencerEngine.transcribeIntoMidi(e.props.track).then(function(){e.setState({transcribing:!1}),e.props.setTrackFocused(e.props.sequencerEngine.tracks.length-1)})},100)}},{key:"hasTracksToResample",value:function(){return void 0!==this.props.tracksToResample&&this.props.tracksToResample.length>0}},{key:"isTranscribing",value:function(){return void 0!==this.state.transcribing&&this.state.transcribing}},{key:"isLoading",value:function(){return this.isTranscribing()}},{key:"getLoadingText",value:function(){return this.isTranscribing()?"Transcribing to MIDI... ":this.hasTracksToResample()?"Waiting to resample... ":this.props.isResampling?"Resampling... ":void 0}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(e),this.props.setContextualHelp(t)}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"piano-roll-toolbar"},l.a.createElement(le.a,{condition:this.props.track.getTrackType()===nt.f},l.a.createElement("div",{onMouseOver:function(t){return e.setContextualHelp(t,rt.Ub)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},draggable:!1,onClick:function(){return e.transcribeButton()},className:"transcribe-button"},"TRANSCRIBE")),l.a.createElement(le.a,{condition:this.isLoading()},this.getLoadingText()),l.a.createElement(it.a,{sizeUnit:"px",size:10,color:"#123abc",loading:this.isLoading()}),l.a.createElement(tt,{onChange:this.props.onChangeLength,resolution:this.props.resolution,track:this.props.track}))}}]),n}(u.Component),ct=Object(y.b)(function(e,t){return{tracksToResample:e.tracks.tracksToResample,isResampling:e.tracks.isResampling,resampleDuration:e.tracks.resampleDuration,resolution:e.sequencer.displayResolution}},function(e,t){return{setTracksToResample:function(t){return e(Object(j.qh)(t))},setTrackFocused:function(t){return e(Object(j.Ug)(t))},setResampleDuration:function(t){return e(Object(j.Ae)(t))},setContextualHelp:function(t){return e(Object(j.ub)(t))}}})(st);function ut(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var lt=function(e){Object(o.a)(n,e);var t=ut(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"getStart",value:function(){return void 0!==this.props.paginationStart?this.props.paginationStart:this.props.start}},{key:"getEnd",value:function(){return void 0!==this.props.paginationEnd?this.props.paginationEnd:this.props.end}},{key:"onClickPreviousPage",value:function(){this.props.setPianoRollPagination(this.getStart()-je,this.getEnd()-je)}},{key:"onClickNextPage",value:function(){this.props.setPianoRollPagination(this.getStart()+je,this.getEnd()+je)}},{key:"onClickUnlock",value:function(){this.props.setPianoRollPagination(void 0,void 0)}},{key:"render",value:function(){var e,t,n=this;return l.a.createElement("div",{className:"pagination-buttons"},l.a.createElement("div",{className:"page-info"},(t=this.getStart(),1+Math.floor(t/32))," / ",(e=this.props.stepsLength)<je?1:Math.floor(e/32)),void 0!==this.props.paginationStart?l.a.createElement("div",{className:"unlock-button",onClick:function(){return n.onClickUnlock()}},"UNLOCK"):"",function(e){return e-je>=0}(this.getStart())?l.a.createElement("div",{onClick:function(){return n.onClickPreviousPage()},className:"previous-page-button"},"PREVIOUS"):"",function(e,t){return e+je<=t}(this.getEnd(),this.props.stepsLength)?l.a.createElement("div",{onClick:function(){return n.onClickNextPage()},className:"next-page-button"},"NEXT"):"")}}]),n}(u.Component);Object(y.b)(function(e,t){var n=e.tracks.trackSteps[t.track.trackNumber],r=t.sequencerEngine.getSequenceId(),a=Math.floor((e.sequencer.currentStep[r]||0)/(X.a.baseResolution.numSteps()/e.sequencer.resolution.numSteps()));a=void 0===n?0:a%n.length;var i=void 0===n?0:function(e,t){var n=0,r=t;return e%je==0?(n=e,r=e+je):(n=32*Math.floor(e/32),r=32*(Math.floor(e/32)+1)),r>=t&&(r=t),{start:n,end:r}}(a,n.length);return{stepsLength:void 0==n?16:n.length,paginationStart:void 0===e.keyboard.pianoRollPagination?void 0:e.keyboard.pianoRollPagination.start,paginationEnd:void 0===e.keyboard.pianoRollPagination?void 0:e.keyboard.pianoRollPagination.end,start:i.start,end:i.end}},function(e,t){return{setPianoRollPagination:function(t,n){return e(Object(j.ce)(t,n))}}})(lt),n(326),n(2424);function ft(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var ht=.35,pt=new V.a,dt=(new p.a(32,!1),0),mt=function(e){Object(o.a)(n,e);var t=ft(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).lastDuration=l.a.createRef(void 0),a.contextContainerRef=l.a.createRef(void 0),a.state={loading:!1,notes:[],leftSpace:56,xScale:Math.max(ht,a.getMinXScale())},a.ref=l.a.createRef(),a.scale=.4,a.note=a.getInitialNote(),a.updateNotes(),a.lastKeyDownEvent=void 0,a.operationManager=a.props.sequencerEngine.operationManager,a.onWheel=a.onWheel.bind(Object(i.a)(a)),a}return Object(a.a)(n,[{key:"getInitialNote",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=0,n=0;if(void 0===e.track.pattern)return ke.a.NOTES[0];for(var r in e.pattern.stepBucketsMatrix){var a=e.pattern.stepBucketsMatrix[r]||e.pattern.stepBuckets[r];for(var i in a.steps){t+=a.steps[i].transpose,n++}}if(0===n)return ke.a.NOTES[0];var o=Math.floor(t/n);return ke.a.fromTranspose(o)}},{key:"shouldComponentUpdate",value:function(e){return(e.stepsLength<this.props.stepsLength||this.props.leftSidebarWidth!==e.leftSidebarWidth)&&(this.state.xScale=Math.max(ht,this.getMinXScale(e))),void 0!==e.mouseX&&e.mouseX!==this.props.mouseX&&this.updateCursorFromArrangement(e),(e.bottomHeight!==this.props.bottomHeight||e.track!==this.props.track||!e.isPlayingMix&&e.pattern!==this.props.pattern&&void 0!==e.track)&&(this.noteIndex=void 0,this.note=this.getInitialNote(e),this.updateNotes(e)),!0}},{key:"updateNotes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=[],n=void 0===this.noteIndex?Math.round(this.getNumNotes(e)/2):Math.round(this.noteIndex/this.scale),r=this.state.zoomedNote,a=Math.floor(this.state.zoomedNoteRatio*this.getNumNotes(e));this.note||(this.note=this.getInitialNote(e));var i=void 0===r?this.note.addTranspose(n):r.addTranspose(a);(i.getTranspose()>=92||i.getTranspose()-this.getNumNotes(e)<-36)&&(i=ke.a.fromTranspose(-36+this.getNumNotes(e)));for(var o=0;o<this.getNumNotes(e);o++)t.push(i.addTranspose(-1*o));this.props.setPianoRollNotes(t)}},{key:"componentDidMount",value:function(){var e=this;this.ref.current.addEventListener("mousewheel",this.onWheel,{passive:!1}),this.props.mouseX,this.props.setPianoRollCursor(void 0),setTimeout(function(){if(e.ref&&e.ref.current){var t=e.ref.current.getBoundingClientRect();e.setState({leftSpace:t.left})}},150)}},{key:"componentDidUpdate",value:function(e,t){if(this.state.xScale!==t.xScale&&void 0!==this.state.zoomStep){var n=36*this.state.zoomStep*this.state.xScale;this.ref.current.scroll(n-this.state.zoomOffset,0)}}},{key:"updateCursorFromArrangement",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props}},{key:"componentWillUnmount",value:function(){this.ref.current.removeEventListener("mousewheel",this.onWheel),this.props.setSelectedPianoRollSteps(void 0),this.props.setPianoRollCursor(void 0),this.props.track.getEasyPattern().pattern&&this.props.track.getEasyPattern().update()}},{key:"getNumNotes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=(e.hideSidebar?21:17)*(e.hideSidebar?e.bottomHeight:window.innerHeight)/560;return Math.max(Math.ceil(t/this.scale),1)}},{key:"onMouseDown",value:function(e,t,n){this.mouseDown=!0,this.dragStartY=e.pageY,void 0===this.dragStartX&&(this.dragStartX=e.pageX),this.setState({zoomedNote:t,zoomedNoteRatio:n/this.getNumNotes()})}},{key:"onMouseUp",value:function(e){this.mouseDown=!1,this.dragStartX=void 0}},{key:"scrollVertically",value:function(e){var t=this.props.notes[0].getTranspose();if(!(this.props.notes[this.props.notes.length-1].getTranspose()+e<-36)&&!(t+e>92)){var n=this.props.notes.map(function(t){return t.addTranspose(e)});this.note=this.props.notes[0],this.props.setPianoRollNotes(n)}}},{key:"onWrapperMouseMove",value:function(e){var t=this.ref.current.getBoundingClientRect();this.mouseXPosition=e.clientX-t.left,this.mouseYPosition=e.clientY-this.ref.current.offsetTop;var n=Math.round((this.mouseYPosition-40)/(H.a*this.scale));this.note=this.props.notes[n%this.props.notes.length],this.noteIndex=Math.floor(n/2)}},{key:"onMouseMove",value:function(e){if(this.mouseDown){this.dragY=e.pageY;var t=this.dragY-this.dragStartY,n=Math.floor(t/this.scale/60);Math.abs(n)>=1&&this.scrollVertically(n);var r=e.pageX-this.dragStartX;if(Math.abs(r)<=2)return;this.scale+=r/50,this.scale<=.4&&(this.scale=.4),this.scale>=2&&(this.scale=2),this.updateNotes()}}},{key:"onMouseLeave",value:function(e){this.props.mouseDown(!1),this.mouseDown=!1,clearInterval(this.octaveTimer);var t=this.props.sequencerEngine.store.getState();if(void 0!==t.keyboard.pianoRollSelection){var n=this.props.track.getEasyPattern().getSelectedPianoRollSteps(t.keyboard.pianoRollSelection,this.props.resolution);this.props.setSelectedPianoRollSteps(n),this.props.setPianoRollSelection(void 0)}}},{key:"onWheel",value:function(e){var t=this;if(this.mouseOverPianoRoll){if(e.ctrlKey){e.preventDefault(),e.stopPropagation(),void 0===this.scrollCursor&&(this.scrollCursor=(this.ref.current.scrollLeft+this.mouseXPosition)/(36*this.state.xScale));var n=++dt;setTimeout(function(){n===dt&&(t.scrollCursor=void 0)},250);var r=this.state.xScale-.03*e.deltaY,a=Math.max(ht,this.getMinXScale());r<=a&&(r=a),this.setState({xScale:r});var i=36*this.scrollCursor*r-this.mouseXPosition;this.ref.current.scrollTo(i,0)}else{if(Math.abs(e.wheelDeltaY)<=3||Math.abs(e.wheelDeltaX)>=12)return!1;var o=e.wheelDeltaY/this.scale/20;0!==(o=o<0?Math.ceil(o):Math.floor(o))&&(e.preventDefault(),e.stopPropagation()),this.scrollVertically(o)}return!1}}},{key:"getMinXScale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;if(e.hideSidebar){var t=(window.innerWidth-70-e.leftSidebarWidth-240)/(36*e.stepsLength);return Math.max(ht,t)}var n=(window.innerWidth-58-e.leftSidebarWidth)/(36*e.stepsLength);return Math.max(ht,n)}},{key:"setMinXScale",value:function(){this.setState({xScale:this.getMinXScale()}),this.props.setPianoRollCursor(void 0)}},{key:"maxScale",get:function(){return 6}},{key:"zoomHorizontally",value:function(e,t,n){var r=this.state.xScale+e/50;r<this.getMinXScale()||r>this.maxScale||this.setState({xScale:r,zoomStep:t,zoomOffset:n})}},{key:"onMouseOverNote",value:function(e,t){this.mouseDown||(this.note=e,this.noteIndex=t)}},{key:"onChangeLength",value:function(){this.setState({xScale:this.minXScale})}},{key:"onMouseOverPianoRoll",value:function(e){this.mouseOverPianoRoll=e}},{key:"onContextMenu",value:function(e){f(this.props);var t=this.contextContainerRef.current.getBoundingClientRect();e.preventDefault();var n=e.clientX-t.left+4,r=e.clientY-t.top,a=this.props.hideSidebar?window.innerWidth-this.props.leftSidebarWidth-240:window.innerWidth;n-this.ref.current.scrollLeft>=a-320&&(n=this.ref.current.scrollLeft+a-320),this.props.hideSidebar?r=-20:r>window.innerHeight-400&&(r=window.innerHeight-400),this.setState({dropdownPos:{x:n,y:r}})}},{key:"render",value:function(){var e=this;if(void 0===this.props.track.pattern)return l.a.createElement("div",null);H.a,this.props.scale;var t=this.props.hideSidebar?this.props.bottomHeight:window.innerHeight-40,n={height:t-71-90};this.props.hideSidebar&&(n.height+=50);var r=pt.getColorForTrack(this.props.track);r=pt.saturate(r,6);var a=this.props.showAutomation?"whole-wrapper showing-automation":"whole-wrapper";return l.a.createElement("div",{draggable:!1,className:"piano-roll-container"},l.a.createElement(le.a,{condition:!this.props.hideToolbar},l.a.createElement(ct,{sequencerEngine:this.props.sequencerEngine,track:this.props.track})),l.a.createElement("div",{className:"clear-fix"}),l.a.createElement("div",{className:"piano-horizontal"},l.a.createElement("div",{className:"piano-column"},l.a.createElement($,{leftSpace:this.state.leftSpace,color:r,xScale:this.state.xScale,scroll:this.ref,track:this.props.track}),l.a.createElement("div",{style:n,onMouseMove:function(t){return e.onWrapperMouseMove(t)},onMouseOver:function(t){return e.onMouseOverPianoRoll(!0)},onMouseLeave:function(t){return e.onMouseOverPianoRoll(!1)},className:a},l.a.createElement(he,{setScale:function(t){e.scale=t,e.updateNotes()},scale:this.scale,onMouseOver:function(t,n){return e.onMouseOverNote(t,n)},color:r,setSelectedPianoRollSteps:this.props.setSelectedPianoRollSteps,onMouseDown:function(t,n,r){return e.onMouseDown(t,n,r)},onMouseUp:function(t){return e.onMouseUp(t)},onMouseMove:function(t){return e.onMouseMove(t)},notes:this.props.notes,track:this.props.track}),l.a.createElement("div",{draggable:!1,onMouseUp:function(){return e.onMouseUp()},onMouseLeave:function(){return e.onMouseLeave()},ref:this.ref,className:"piano-roll-wrapper"},l.a.createElement(Se,{setMinXScale:function(){return e.setMinXScale()},height:t,color:pt.saturate(r,.4),isLooping:this.props.isLooping,wrapperRef:this.ref,zoomHorizontally:function(t,n,r){return e.zoomHorizontally(t,n,r)},xScale:this.state.xScale,resolution:this.props.resolution,track:this.props.track,sequencerEngine:this.props.sequencerEngine}),l.a.createElement(ce,{sequencerEngine:this.props.sequencerEngine,track:this.props.track,height:t-20,xScale:this.state.xScale,scale:this.scale}),l.a.createElement(ye,{height:t-20,xScale:this.state.xScale,scale:this.scale}),l.a.createElement(be,{xScale:this.state.xScale,scale:this.scale}),l.a.createElement("div",{ref:this.contextContainerRef,onContextMenu:function(t){return e.onContextMenu(t)},className:this.state.dropdownPos?"masking piano-roll-rows-container":"piano-roll-rows-container"},l.a.createElement(G,{xScale:this.state.xScale,track:this.props.track,clear:function(){return e.setState({dropdownPos:void 0})},dropdownPos:this.state.dropdownPos}),this.props.notes.map(function(t,n){return l.a.createElement(Ze,{xScale:e.state.xScale,leftSpace:e.state.leftSpace,lastDuration:e.lastDuration,key:"note-"+n,noteIndex:n,color:r,scale:e.scale,parentClassName:"piano-roll-wrapper",onMouseOver:function(t){return e.onMouseOverNote(t,n)},resolution:e.props.resolution,onMouseDown:function(r){return e.onMouseDown(r,t,n)},onMouseUp:function(t){return e.onMouseUp(t)},onMouseMove:function(t){return e.onMouseMove(t)},pattern:e.props.pattern,sequencerEngine:e.props.sequencerEngine,track:e.props.track,note:t})})),!this.props.hideSidebar&&this.props.showAutomation&&this.ref.current?l.a.createElement(pe.a,{height:n.height-40,wrapperRef:this.ref,color:r,sequencerEngine:this.props.sequencerEngine,xScale:this.state.xScale,track:this.props.track}):"")),l.a.createElement(se,{resolution:this.props.resolution,color:r,sequencerEngine:this.props.sequencerEngine,xScale:this.state.xScale,scroll:this.ref,track:this.props.track})),!this.props.hideSidebar&&l.a.createElement(h.a,{isPianoRoll:!0,sequencerEngine:this.props.sequencerEngine})))}}]),n}(u.Component);t.a=Object(y.b)(function(e,t){var n=void 0===t.track?void 0:e.tracks.trackSteps[t.track.subSequence.isTrack?t.track.subSequence.id:t.track.id],r=t.track;return r&&r.tracks&&r.tracks[0]&&(r=r.tracks[0].track),{id:void 0===r?0:void 0!==r.sample&&void 0!==r.sample.getId()?r.sample.getId():r.presetName||r.getName(),samplers:r&&r.instrument&&r.instrument.samplers,stepsLength:void 0===n?16:n.length,resolution:e.sequencer.displayResolution,tracksToResample:e.tracks.tracksToResample,notes:e.keyboard.notes,mouseX:e.arrangement.mouseX,bottomHeight:e.sequencer.viewMode===ge.a||t.installation?e.arrangement.bottomHeight:550,pattern:t.track?t.pattern||t.track.pattern:void 0,isPlayingMix:e.mix.isPlayingMix,showAutomation:e.automation.show,leftSidebarWidth:e.spatial.leftSidebarWidth}},function(e,t){return{mouseDown:function(t){return e(Object(j.n)(t))},setTrackFocused:function(t){return e(Object(j.Ug)(t))},setSelectedPianoRollSteps:function(t){return e(Object(j.jf)(t))},setPianoRollSelection:function(t,n,r,a){return e(Object(j.de)(t,n,r,a))},setStepsToCopy:function(t){return e(Object(j.Fg)(t))},setEasyPatternToCopy:function(t){return e(Object(j.Pb)(t))},setTracksToResample:function(t){return e(Object(j.qh)(t))},setPianoRollNotes:function(t){return e(Object(j.be)(t))},setPianoRollCursor:function(t){return e(Object(j.Zd)(t))},setSelectorMode:function(t){return e(Object(j.vf)(t))},setSidebarViewMode:function(t){return e(Object(j.qg)(t))},setArrangementPatternDragging:function(t){return e(Object(j.K)(t))},setStepToCopy:function(t){return e(Object(j.Cg)(t))},setStepDataDragging:function(t){return e(Object(j.xg)(t))},setTransposeDragging:function(t){return e(Object(j.th)(t))},setIsDraggingDuration:function(t){return e(Object(j.Dc)(t))}}})(mt)},function(e,t,n){"use strict";var r=n(8),a=n(99),i=n(0),o=n.n(i),s=n(6),c=n(12),u=Object(c.b)(function(e,t){return{}},function(e){return{setMovingPadEdge:function(t){return e(Object(s.ud)(t))}}})(function(e){var t=e.pathPoints,n=e.setMovingPadEdge,a=e.edge,s=t.slice(0,2);s[1]+=10;var c=t.slice(t.length-2,t.length);c[1]-=10;var u=Object(i.useCallback)(function(e,i){e.stopPropagation();var o="START"===i?t.slice(t.length-2):t.slice(0,2),s={x1:o[0],y1:o[1],x2:e.clientX,y2:e.clientY};"START"===i?(console.log("set moving pad edge called 1"),n(Object(r.a)({edge:a},s,{destType:a.destType,destId:a.destId}))):(console.log("set moving pad edge called 2"),n(Object(r.a)({edge:a},s,{sourceType:a.sourceType,sourceId:a.sourceId})))},[a]);return o.a.createElement("g",null,o.a.createElement("circle",{onMouseDown:function(e){return u(e,"START")},className:"edge-helper",cx:s[0],cy:s[1],r:5,fill:"white"}),o.a.createElement("circle",{onMouseDown:function(e){return u(e,"END")},className:"edge-helper",cx:c[0],cy:c[1],r:5,fill:"white"}))}),l=n(11),f=n(111),h=n(347),p=n(220),d=(n(2571),Object(c.b)(function(e,t){var n=t.outlet.sourceWindowId,r=t.outlet.destWindowId,a=t.outlet.sourceId,i=t.outlet.destId,o=e.pads,s=o.movingEdge,c=(o.drawingEdge,o.selectedEdge),u=t.edge;return{isSourceCollapsed:e.effects.effectCollapsed[n],isDestCollapsed:e.effects.effectCollapsed[r],isSelected:c&&c.outlet===t.outlet&&c.inlet===t.inlet,isMoving:s&&s.edge.id===u.id,fromPosition:e.windows.windowPositions[n]||e.windows.windowPositions[a],toPosition:e.windows.windowPositions[r]||e.windows.windowPositions[i],segmentation:e.spatial.cableSegmentations[t.edge.id],edgesPadding:e.spatial.edgesPadding,presentationMode:e.spatial.presentationMode,movingEdge:s}},function(e){return{setSelectedPadEdge:function(t){return e(Object(s.ff)(t))},setSelectedSteps:function(t){return e(Object(s.jf)(t))}}})(function(e){var t=e.isMoving,n=(e.drawingEdge,e.edgesPadding),r=e.containerRef,a=(e.selection,e.inlet),s=e.outlet,c=e.isSelected,d=e.setSelectedPadEdge,m=e.setSelectedSteps,v=e.fromPosition,b=e.toPosition,g=e.isSourceCollapsed,y=e.isDestCollapsed,k=e.edge,O=e.segmentation,j=e.edgesRef,w=e.presentationMode,E=Object(i.useState)([]),S=Object(l.a)(E,2),P=S[0],x=S[1],T=Object(i.useState)(!1),C=Object(l.a)(T,2),N=C[0],R=C[1],M=Object(i.useRef)(void 0),A=Object(i.useRef)(void 0),q=Object(i.useState)(!1),D=Object(l.a)(q,2),I=D[0],_=D[1];Object(i.useEffect)(function(){var e=s.sourceEl;I?Object(f.d)(e,F):(Object(f.e)(e,F),R(void 0))},[s,I,R]);var F=Object(i.useCallback)(function(e){var t=s.sourceType;try{t+="."+JSON.stringify(e)}catch(n){}R(t)},[F,R]);Object(i.useEffect)(function(){L()},[x,a,s,v,b,g,y,n]);var L=Object(i.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r.current)if(M.current||(M.current=document.getElementById(s.destEl)),A.current||(A.current=document.getElementById(s.sourceEl)),!M.current||!A.current||M.current&&!M.current.isConnected||A.current&&!A.current.isConnected)x([]);else{var t=A.current.getBoundingClientRect(),n=M.current.getBoundingClientRect(),a=j.current.getBoundingClientRect(),i=a.top,o=a.left,c=[t.left-o,t.top-i,n.left-o,n.top-i];1!==window._scale&&(c=c.map(function(e){return e/(window._scale||1)})),0!==c.length||e?x(c):setTimeout(function(){L(!0)},100)}},[x,a,s,v,b,g,y]);if(Object(i.useEffect)(function(){setTimeout(function(){L()},80)},[x,w,a,s]),0===P.length)return[];var B=Object(l.a)(P,4),z=B[0],V=B[1],H=B[2],U=B[3],J="pad-effect-edge message-edge ";c&&(J+=" selected");var G=(z+H)/2,W=(V+U)/2,K=M.current&&"inlet-field"===M.current.parentElement.className,X=O?function(e,t,n,r){return r>t?[e,t,e,.75*t+.25*r,e,.75*t+.25*r+1,e,.5*t+.5*r,e,.5*t+.5*r+1,n,.5*t+.5*r,n,.5*t+.5*r+1,n,.25*t+.75*r+0,n,.25*t+.75*r+1,n,r-2,n,r]:[e,t,e,t+15,e,t+16,e,t+30,e,t+31,.5*e+.5*n,t+30,.5*e+.5*n,t+31,.5*e+.5*n,.5*t+.5*r+30,.5*e+.5*n,.5*t+.5*r+31,.5*e+.5*n,r-30,.5*e+.5*n,r-31,n,r-30,n,r-31,n,r-16,n,r-15,n,r-2,n,r]}(z+5,V,H+5,U+4):Object(h.a)(z+5,V,H+5,U+4,K);if(t)return[];var Q="message-edge-group";return c&&(Q+=" selected"),o.a.createElement("g",{className:Q},o.a.createElement(p.a,{markerEnd:"",onMouseOver:function(){return _(!0)},onMouseLeave:function(){return _(!1)},segmentation:O,onMouseDown:function(e){e.stopPropagation(),d({id:k.id,inlet:a,outlet:s}),m([])},className:J,points:X}),c&&o.a.createElement(u,{edge:k,pathPoints:X}),N&&o.a.createElement("g",null,o.a.createElement("rect",{fill:"black",x:G,y:W,height:20,width:2+N.length+"ch"}),o.a.createElement("text",{fill:"white",x:G+5,y:W+12,fontSize:"8pt"},N)))})),m=Object(c.b)(function(e,t){var n=e.pads.selectedEdge;return{presentationMode:e.spatial.presentationMode,selectedEdge:n,inletConnections:e.windows.inletConnections[t.subSequence.id]}},function(e){return{}})(function(e){var t=e.selectedEdge,n=e.presentationMode,r=e.edgesRef,a=e.subSequence,s=e.inletConnections,c=e.containerRef,u=e.selection,l=Object(i.useRef)(!1);Object(i.useEffect)(function(){return window.addEventListener("mousedown",f),window.addEventListener("mouseup",h),function(){window.removeEventListener("mousedown",f),window.removeEventListener("mouseup",h)}},[]);var f=function(){return l.current=!0},h=function(){return l.current=!1};if(!s||n)return[];var p=Object.keys(s).map(function(e){return s[e].filter(function(n){return!t||t.outlet!==n||t.inlet!==e}).flatMap(function(t){return o.a.createElement(d,{edge:t,edgesRef:r,key:t.id,isMouseDown:l,subSequence:a,selection:u,containerRef:c,inlet:e,outlet:t})})});if(t){var m=t.outlet,v=t.inlet;p.push(o.a.createElement(d,{edge:m,edgesRef:r,key:t.id,isMouseDown:l,subSequence:a,selection:u,containerRef:c,inlet:v,outlet:m}))}return p}),v=n(743),b=(Object.values,Object.keys,function(e){e.subSequence,e.setWindowPositions;Object(i.useEffect)(function(){return window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}},[]);var t=Object(i.useCallback)(function(e){"y"!==e.key||e.metaKey},[])}),g=n(1046),y=Object(i.memo)(function(e){var t,n,s,c,l=e.setMovingPadEdge,f=e.movingEdge,d=e.edgesRef,y=e.effects,k=e.midiEffects,O=e.subSequence,j=e.drawingEdge,w=e.scale,E=e.setWindowPositions,S=e.setDrawingPadEdge,P=e.setSelectedPadEdge,x=Object(a.a)(e,["setMovingPadEdge","movingEdge","edgesRef","effects","midiEffects","subSequence","drawingEdge","scale","setWindowPositions","setDrawingPadEdge","setSelectedPadEdge"]);b({subSequence:O,setWindowPositions:E}),j&&(t=j.x1/(window._scale||1),s=j.y1/(window._scale||1),n=j.x2/(window._scale||1),c=j.y2/(window._scale||1)),Object(g.a)({subSequence:O,setSelectedPadEdge:P}),Object(i.useEffect)(function(){return window.addEventListener("mousemove",T),window.addEventListener("mouseup",C),function(){window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",C)}},[O]);var T=Object(i.useCallback)(function(e){var t=O.sequencerEngine.state,n=t.pads,a=n.movingEdge,i=n.drawingEdges;if(a){x.containerRef.current.getBoundingClientRect();var o=e.clientX,s=e.clientY;l(Object(r.a)({},a,{x2:o,y2:s}))}if(i[O.id]){x.containerRef.current.getBoundingClientRect();var c=e.clientX,u=e.clientY;t.spatial.editorPadding;S(O.id,Object(r.a)({},i[O.id],{x2:c,y2:u}))}},[O]),C=Object(i.useCallback)(function(e){S(O.id,void 0),l(void 0)},[O]),N={transform:"scale("+1/w+")"};if(x.scrollable&&x.containerRef.current&&(N.width=x.containerRef.current.scrollWidth+"px",N.height=x.containerRef.current.scrollHeight+"px"),d.current){var R=d.current.getBoundingClientRect();t-=R.left,n-=R.left,s-=R.top,c-=R.top,f&&((f=Object(r.a)({},f)).x2-=R.left,f.y2-=R.top)}return o.a.createElement("svg",{ref:d,onMouseDown:function(e){return P(void 0)},style:N,className:"edges-drawer"},o.a.createElement("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"8",refX:"4",refY:"2",orient:"auto"},o.a.createElement("polygon",{points:"0 0, 5 2, 0 4"})),j&&o.a.createElement(p.a,{className:"pad-effect-edge drawing-edge",points:Object(h.a)(t,s,n,c)}),f&&o.a.createElement(p.a,{className:"pad-effect-edge drawing-edge",points:Object(h.a)(f.x1,f.y1,f.x2,f.y2)}),f&&o.a.createElement(u,{edge:f,pathPoints:Object(h.a)(f.x1,f.y1,f.x2,f.y2)}),o.a.createElement(m,{selection:x.selection,containerRef:x.containerRef,edgesRef:d,subSequence:O}),O.tracks&&O.tracks.filter(function(e){return e.effectRack&&e.zObject&&"track"===e.zObject.name}).map(function(e){return o.a.createElement(v.a,Object.assign({key:e.id,effects:k[e.id],scale:w,edgesRef:d,isMidi:!0,fromId:e.sequencer?e.sequencer.id:e.id,outputPrefix:"effect-output-",pad:e},x))}),O.zObjects.filter(function(e){return"pad"===e.name}).filter(function(e){return e.effect.pad}).map(function(e){return e.effect.pad}).map(function(e){return o.a.createElement(v.a,Object.assign({key:e.id,edgesRef:d,effects:y[e.id],scale:w,pad:e},x))}))});t.a=Object(c.b)(function(e,t){return{drawingEdge:e.pads.drawingEdges[t.subSequence.id],movingEdge:e.pads.movingEdge,effects:e.pads.padEffects,midiEffects:e.pads.trackMidiEffects}},function(e){return{setSelectedPadEdge:function(t){return e(Object(s.ff)(t))},setDrawingPadEdge:function(t,n){return e(Object(s.Nb)(t,n))},setMovingPadEdge:function(t){return e(Object(s.ud)(t))},setWindowPositions:function(t){return e(Object(s.gb)(t))}}})(y)},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(9),s=n(2),c=n(4),u=n(20),l=n(7),f=n(10),h=n(1),p=n(79),d=n(454),m=n(97),v=n(1091),b=n(219),g=n(43),y=n(903),k=n(6),O=function(e,t){var n={};n[t.id]=t,e.dispatch(Object(k.Re)(n)),e.state.arrangement.patternSelected&&e.dispatch(Object(k.M)(t)),e.dispatch(Object(k.F)(t.step))},j=function(e){var t=e.arrangement.selectedEvents;if(t&&0!==Object.keys(t).length)return t[Object.keys(t)[0]]},w=function(e,t){return t===g.g.id?e.mix:e.getSubSequence(t).mix},E=function(e,t){if(void 0===e.state.keyboard.selectedPianoRollSteps){var n=t.track,r=n.patterns.indexOf(t);n.deletePattern(r),e.switchToPattern(0),n.updateSteps(),e.dispatch(Object(k.P)([]))}},S=n(178),P=n(92),x=n(370),T=n(651),C=n(55),N=n(106),R=n(1468),M=n(326),A=(n(33),n(46)),q=n(62),D=n(124),I=n(295);function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}function F(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var z=function(e){Object(l.a)(n,e);var t=B(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).sequencerEngine=e,a.disableTab=r,a.installation=r,a.store=e.store,a.onKeyDown=a.onKeyDown.bind(Object(u.a)(a)),a.onKeyUp=a.onKeyUp.bind(Object(u.a)(a)),a.keysDown={},a.effectToCopy=void 0,a.sequencerEngine.keyListener=Object(u.a)(a),a.checkMetaKey(),a.lastViewMode=void 0,a.halftime=void 0,a.bindings={},a}return Object(c.a)(n,[{key:"addBinding",value:function(e){this.bindings[e]=!0}},{key:"removeBinding",value:function(e){delete this.bindings[e]}},{key:"checkMetaKey",value:function(){var e=this;setInterval(function(){void 0!==e.lastMetaPressedTime&&((new Date).getTime()-e.lastMetaPressedTime>=5e3&&e.dispatch(Object(k.nb)(!1)))},1e3)}},{key:"onKeyUp",value:function(e){var t=this;this.keysDown[e.key&&e.key.toLowerCase()]=!1,Object(d.a)(e)||("Meta"===e.key||"Control"===e.key?(this.lastMetaPressedTime=void 0,this.dispatch(Object(k.nb)(!1))):"/"===e.key?this.dispatch(Object(k.cg)(!this.state.spatial.showSearchWindow)):"~"===e.key||"`"===e.key?(void 0!==this.halftime&&(this.sequencerEngine.subSequences.forEach(function(e,n){return e.playhead.speedFactorParameter.set(t.halftime[n],!1)}),this.halftime=void 0),"`"===e.key&&(this.sequencerEngine.sequenceRolling=!1)):Object(q.a)(e.key)||this.sequencerEngine.keyboardHelper.onKeyUp(e))}},{key:"onKeyDown",value:function(e){var t=this;if((!this.keysDown[e.key&&e.key.toLowerCase()]||e.ctrlKey||e.metaKey)&&(!Object(d.a)(e)||"d"===e.key&&e.metaKey)&&(this.keysDown[e.key&&e.key.toLowerCase()]=!0,!this.state.sequencer.loadingText&&(!this.bindings[e.key]||e.ctrlKey||e.metaKey||this.sequencerEngine.isAnyTrackEnabled()))){if(32==e.keyCode&&e.target==window.document.body){if(e.preventDefault(),(this.viewMode===p.a||this.state.arrangement.looping)&&(this.sequencerEngine.playing||this.dispatch(Object(k.Hc)(!0))),window.synthz)return;return this.sequencerEngine.schedulePlay(),!1}var n=e.target===window.document.body;if(this.viMode&&!e.metaKey&&!e.ctrlKey&&!e.ctrlKey){if("Escape"===e.key)return void this.dispatch(Object(k.Ch)(!1));if(this.scripting.viCommand(e.key),Object(q.a)(e.key))return}if("Space"!==e.key){if(!this.viMode&&e.key>="a"&&e.key<="z"&&!e.metaKey&&!e.ctrlKey&&!e.ctrlKey)return this.sequencerEngine.keyboardHelper.onAlphabetKeyDown(e,this.cursor.track),!0;if(this.installation||"x"===e.key&&(e.metaKey||e.ctrlKey)&&this.state.commands.commandInput&&(this.state.commands.commandInput.focus(),this.dispatch(Object(k.pb)("M-x"))),"m"===e.key&&(e.ctrlKey||e.metaKey))return e.preventDefault(),this.sequencerEngine.metronomeOn=!this.sequencerEngine.metronomeOn,!1;if("~"===e.key&&(this.halftime=this.sequencerEngine.subSequences.map(function(e){return e.playhead.speedFactorParameter.get()}),this.sequencerEngine.subSequences.forEach(function(e,n){return e.playhead.speedFactorParameter.set(t.halftime[n]/2,!1)})),"n"===e.key&&(e.ctrlKey||e.ctrlKey))return e.preventDefault(),this.selectedTrack.auditionNext(!0,!0),!1;if("R"===e.key){var r,a=F(this.sequencerEngine.subSequences);try{for(a.s();!(r=a.n()).done;){r.value.tracks.forEach(function(e){return e.setIsEnabled(!1)})}}catch(h){a.e(h)}finally{a.f()}}if("p"===e.key&&(e.ctrlKey||e.ctrlKey))return e.preventDefault(),this.selectedTrack.auditionPrevious(!0,!0),!1;if("i"===e.key&&(e.ctrlKey||e.metaKey)){e.preventDefault();var i=this.selectedTrack;!i||this.selectedEffect&&this.selectedEffect.name.includes("Effect Rack")||this.dispatch(Object(k.jh)(i))}if("Escape"===e.key&&this.dispatch(Object(k.rc)(void 0)),"g"===e.key&&e.metaKey)return e.preventDefault(),this.planarSelected||this.groupSteps(),!0;if("\\"===e.key&&e.metaKey&&this.dispatch(Object(k.rg)(!this.state.spatial.sidebarsShowing)),"z"===e.key&&(e.metaKey||e.ctrlKey))return e.preventDefault(),e.shiftKey?this.sequencerEngine.operationManager.redo():this.sequencerEngine.operationManager.undo(),!0;if("k"===e.key&&(e.metaKey||e.ctrlKey))return this.midiMapMode===D.b?this.dispatch(Object(k.id)(D.c)):this.dispatch(Object(k.id)(D.b)),!0;if("y"===e.key&&(e.metaKey||e.ctrlKey))return e.preventDefault(),Object(v.b)(this.sequencerEngine),!0;if("j"===e.key&&(e.metaKey||e.ctrlKey))return this.midiMapMode===D.a?this.dispatch(Object(k.id)(D.c)):this.dispatch(Object(k.id)(D.a)),!0;if("d"===e.key&&(e.ctrlKey||e.metaKey)){if(void 0!==this.selectedEffect&&("Effect Rack"===this.selectedEffect.name||"Midi Effect Rack"===this.selectedEffect.name))return;return e.preventDefault(),e.stopPropagation(),this.selectedZObject&&this.selectedZObject.getObjectType()===m.c?this.sequencerEngine.duplicateTrack(this.sequencerEngine.cursor.track):this.selectedZObject&&this.selectedZObject.getObjectType()===m.e&&this.selectedZObject.duplicate(),!1}if("a"===e.key&&(e.metaKey||e.ctrlKey)){if(e.preventDefault(),this.planarSelected)return;return this.state.automation.show&&this.state.sequencer.showPianoRoll&&this.state.arrangement.bottomMode===N.d?this.selectAllTrackAutomationPoints():this.viewMode===p.a?this.state.arrangement.patternSelected?this.selectAllTrackSteps():this.selectAllTrackAutomationPoints():this.selectAllTrackSteps(),this.dispatch(Object(k.Ye)(void 0)),!1}if("E"===e.key)return e.preventDefault(),this.dispatch(Object(k.xh)(!this.state.zobject.uxLocked)),!1;if("P"===e.key)return e.preventDefault(),this.state.spatial.showPadSequencer||this.dispatch(Object(k.pe)(!this.state.spatial.presentationMode)),!1;if("w"===e.key&&(e.ctrlKey||e.ctrlKey))return e.preventDefault(),this.viewMode===p.e&&(this.dispatch(Object(k.Wf)(!this.showPianoRoll)),this.dispatch(Object(k.D)(N.e))),!1;if("s"===e.key&&(e.ctrlKey||e.metaKey)){var o=this.selectedTrack.getSamplers()[0];o&&o.autoSlice(4)}else{if("p"===e.key&&(e.metaKey||e.ctrlKey))return e.preventDefault(),this.dispatch(Object(k.uf)(void 0)),this.dispatch(Object(k.Wf)(!this.showPianoRoll)),this.dispatch(Object(k.D)(N.d)),!1;if("s"===e.key&&(e.metaKey||e.ctrlKey)){if(e.preventDefault(),this.viewMode===p.e){var s=this.selectedTrack,c=this.state.cirklon.cirklonMode[s.id];this.dispatch(Object(k.jb)(s.id,"SLOPE"===c?void 0:"SLOPE"))}return!1}if("g"===e.key&&(e.metaKey||e.ctrlKey)){if(e.preventDefault(),this.viewMode===p.e){var u=this.selectedTrack,l=this.state.cirklon.cirklonMode[u.id];this.dispatch(Object(k.jb)(u.id,"GANG"===l?void 0:"GANG"))}return!1}}if(!Object(q.a)(e.key)||this.viewMode===p.e&&this.selectedEffect&&"Plane Parameters"===this.selectedEffect.name)if("="===e.key)this.sequencerEngine.switchToNextPattern();else if("+"===e.key);else if("-"===e.key)this.sequencerEngine.switchToPreviousPattern();else if("]"===e.key)this.dispatch(Object(k.dg)(!0));else if("c"===e.key&&(e.metaKey||e.ctrlKey))this.copy();else if("v"===e.key&&(e.metaKey||e.ctrlKey))this.paste();else if("b"===e.key&&(e.metaKey||e.ctrlKey))this.duplicateSteps();else{if("l"===e.key&&(e.metaKey||e.ctrlKey))return e.preventDefault(),this.legato(),!1;if("r"===e.key&&e.ctrlKey)return e.preventDefault(),this.rollSteps(),!1;if("t"===e.key&&e.ctrlKey)return e.preventDefault(),this.tripletSteps(),!1;if("Backspace"!=e.key||this.hasHigherOrderSteps())if("`"==e.key)this.sequencerEngine.isSequenceRolling||(this.sequencerEngine.sequenceRolling=!0);else{if("\\"==e.key||"h"==e.key&&e.ctrlKey)return!1;if("."==e.key)this.record();else if("Meta"===e.key||"Control"===e.key)this.onMetaKeyDown();else if("Tab"!==e.key||this.disableTab)if("'"===e.key)this.onClickRollingMode();else if("Shift"===e.key&&n)this.onShiftKeyDown();else if("ArrowRight"==e.key&&n&&!this.hasHigherOrderSteps()){if(this.planarSelected)return;this.keyboardContext&&"ztracker"===this.keyboardContext.name?this.onArrowDown(e,!0):this.onArrowRight(e,!0)}else if("ArrowLeft"==e.key&&n&&!this.hasHigherOrderSteps()){if(this.planarSelected)return;this.keyboardContext&&"ztracker"===this.keyboardContext.name?this.onArrowUp(e,!0):this.onArrowLeft(e,!0)}else{if("ArrowUp"==e.key&&n&&!this.hasHigherOrderSteps()){if(this.planarSelected)return;return this.keyboardContext&&"ztracker"===this.keyboardContext.name?this.onArrowLeft(e,!0):this.onArrowUp(e)}if("ArrowDown"==e.key&&n&&!this.hasHigherOrderSteps()){if(this.planarSelected)return;this.keyboardContext&&"ztracker"===this.keyboardContext.name?this.onArrowRight(e,!0):this.onArrowDown(e)}else if("Enter"==e.key&&n&&!this.hasHigherOrderSteps()){if(this.planarSelected)return;this.onEnterKeyDown()}}else{if(e.preventDefault(),this.isShowingSoundsPane())return void this.hideSidebar();if(this.state.instruments.showingFormants)return;if(this.waveformShowing)return}}else{if(void 0!==this.selectedFreeze)return void this.deleteSelectedFreeze();if(this.pointsSelected.length>0&&(this.showPianoRoll&&this.state.automation.show||this.viewMode===p.a))this.deleteSelectedPoints();else if(this.viewMode===p.a){var f=this.getSelectedSteps();f&&f.length>0?this.deleteSelectedSteps():function(e){var t=e.state,n=t.arrangement.rowSelections;if(Object(y.e)(n)){var r=t.arrangement.selectedEvents,a=t.arrangement.selectedRows;if(void 0!==a&&0!==a.length){var i=a[0];for(var o in r){var s=parseInt(o),c=r[o];if(s!==g.a){var u=w(e,i);void 0!==c.parentEvent?u.dispatch(Object(b.a)(c.parentEvent,c)):u.dispatch(Object(b.b)(c,!0))}else E(e,c)}e.dispatch(Object(k.Re)(void 0))}}else Object(y.b)(e,n)}(this.sequencerEngine)}else this.deleteSelectedSteps()}}else if(n)return void this.onNumberKeyDown(e)}}}},{key:"waveformShowing",get:function(){return this.state.sequencer.waveformShowing}},{key:"onNumberKeyDown",value:function(e){var t=parseInt(e.key);if(this.viewMode!==p.a||this.isPlayingMix)if(this.sequencerEngine.rolling&&!e.metaKey){if(t>=2&&t<=9){var n=R.a[t];null!==n&&(this.sequencerEngine.resolution=n)}}else if(e.ctrlKey){e.preventDefault();var r=t-1;this.sequencerEngine.tracks[r]&&(this.sequencerEngine.selectTrack(r),this.sequencerEngine.tracks[r].toggleEnabled())}else{var a=t;this.sequencerEngine.switchToPattern(a-1)}}},{key:"onMetaKeyDown",value:function(){this.dispatch(Object(k.nb)(!0)),this.lastMetaPressedTime=(new Date).getTime()}},{key:"hide",value:function(){var e=this;if(this.state.tracks.tracksToHide.length>0)this.dispatch(Object(k.ph)([]));else{if(!this.sequencerEngine.tracks.some(function(e){return e.isEffectsShowing()})){var t=this.sequencerEngine.tracks.filter(function(t){return t!==e.selectedTrack}),n=[].concat(Object(o.a)(this.state.tracks.tracksToHide.filter(function(t){return t!==e.selectedTrack})),Object(o.a)(t));this.dispatch(Object(k.ph)(Array.from(new Set(n))))}this.hideSidebar(),this.dispatch(Object(k.m)(!1)),this.dispatch(Object(k.Wf)(!1))}}},{key:"hideSidebar",value:function(){this.dispatch(Object(k.vf)(!1)),this.dispatch(Object(k.Of)(!1)),this.dispatch(Object(k.Zf)(!1)),this.dispatch(Object(k.eg)(!1)),this.dispatch(Object(k.qg)(M.g))}},{key:"selectAllTrackAutomationPoints",value:function(){var e=this.sequencerEngine.tracks[this.cursor.track];if(void 0!==e){var t=this.state.automation.trackParameter[e.id];if(void 0!==t)if((this.state.automation.pointsSelected[e.id]||[]).length>0){var n,r=F(this.sequencerEngine.tracks);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.dispatch(Object(k.X)(a.id,[]))}}catch(i){r.e(i)}finally{r.f()}}else this.viewMode===p.a?this.dispatch(Object(k.X)(e.id,Object(o.a)(t.mixAutomation.automations))):this.dispatch(Object(k.X)(e.id,Object(o.a)(t.automations)))}}},{key:"selectAllTrackSteps",value:function(){var e=this.sequencerEngine.tracks[this.cursor.track];if(!(void 0===e||this.viewMode===p.e&&e.isEffectsShowing())||this.state.sequencer.showPianoRoll&&this.state.arrangement.bottomMode===N.d){this.dispatch(Object(k.Ie)(!1));e.currentPattern;if(void 0===this.getSelectedSteps()){var t=e.getEasyPattern().getAllSteps();this.dispatch(Object(k.jf)(t))}else this.dispatch(Object(k.jf)(void 0))}}},{key:"copy",value:function(){this.copiedNodesForRack.length>0||(this.selectedEffect?(this.effectToCopy=this.selectedEffect,this.dispatch(Object(k.Fg)(void 0))):this.copySteps())}},{key:"paste",value:function(){if(!(this.copiedNodesForRack.length>0))if(void 0===this.state.keyboard.stepsToCopy&&void 0!==this.effectToCopy&&void 0!==this.selectedTrack&&this.selectedTrack.isEffectsShowing()){var e=this.effectToCopy.isMidiEffect()?this.effectToCopy.getCopy(this.selectedTrack):this.effectToCopy.getEffectCopy(this.sequencerEngine);this.effectToCopy.isMidiEffect()?this.selectedTrack.midiEffects.addEffect(e):this.selectedTrack.effectsChain.addEffect(e),this.sequencerEngine.update()}else this.pasteSteps()}},{key:"copySteps",value:function(){var e=this.getSelectedSteps();if(void 0!==e){this.dispatch(Object(k.Fg)(e));var t=this.selectedTrack;this.dispatch(Object(k.Pb)(t.getEasyPattern()))}}},{key:"pasteSteps",value:function(){if(void 0!==this.state.keyboard.stepsToCopy){var e=this.cursor.getStep(this.resolution),t=this.sequencerEngine.tracks[this.cursor.track];if(t){var n=t.getEasyPattern().pasteSteps(this.state.keyboard.stepsToCopy,{stepNumber:e},this.state.keyboard.easyPatternToCopy,this.state.sequencer.displayResolution);t.updateSteps(),this.dispatch(Object(k.jf)(n)),this.dispatch(Object(k.zg)(e))}}}},{key:"record",value:function(){var e=!this.isRecording;this.dispatch(Object(k.Jc)(e)),this.sequencerEngine.recording(e)}},{key:"getSelectedSteps",value:function(){var e=this.sequencerEngine.store.getState().keyboard.selectedPianoRollSteps;if(!e||0!==e.length)return e}},{key:"deleteSelectedPoints",value:function(){var e=this.state.automation.trackParameter[this.selectedTrack.id];void 0!==e&&this.selectedTrack&&(this.sequencerEngine.operationManager.dispatch(Object(A.p)(this.viewMode===p.a?e.mixAutomation:e.automation,this.pointsSelected)),this.dispatch(Object(k.X)(this.selectedTrack.id,[])))}},{key:"deleteSelectedSteps",value:function(){this.sequencerEngine.store.getState();var e=this.getSelectedSteps();void 0!==e&&(this.sequencerEngine.operationManager.dispatch(Object(A.h)(this.selectedTrack,e)),this.store.dispatch(Object(k.jf)(void 0)))}},{key:"onShiftKeyDown",value:function(){}},{key:"currentScene",get:function(){return this.state.sequencer.currentScene}},{key:"scenes",get:function(){return this.state.sequencer.scenes}},{key:"showingSoundList",get:function(){return this.state.selector.showingSoundList||this.state.packs.packSelected}},{key:"currentSoundInList",get:function(){return this.state.selector.currentSoundInList},set:function(e){this.dispatch(Object(k.Cb)(e))}},{key:"currentTagInList",get:function(){return this.state.selector.currentTagInList},set:function(e){this.dispatch(Object(k.Eb)(e))}},{key:"onClickRollingMode",value:function(){this.sequencerEngine.resolution=this.state.sequencer.displayResolution,this.dispatch(Object(k.gh)(!this.trackRolling)),this.dispatch(Object(k.Ch)(!1)),this.sequencerEngine.rollingManager.clear()}},{key:"onEnterKeyDown",value:function(){this.showingSoundList&&void 0!==this.currentSoundInList||this.cursor.track>=0&&this.cursor.track<this.sequencerEngine.tracks.length&&this.sequencerEngine.getSelectedStep()>=0&&this.onClickStep(this.cursor.track,this.sequencerEngine.getSelectedStep())}},{key:"onClickStep",value:function(e,t){void 0===this.getSelectedSteps()&&(this.sequencerEngine.tracks[e].pattern.clearCache(),this.sequencerEngine.operationManager.dispatch(Object(A.t)(this.sequencerEngine.tracks[e],t,this.resolution)),this.sequencerEngine.select(e,t),this.cursor.track=e)}},{key:"dispatch",value:function(e){this.store.dispatch(e)}},{key:"state",get:function(){return this.store.getState()}},{key:"selectedEffect",get:function(){if(this.state.zobject.selectedZObject&&this.state.zobject.selectedZObject.getObjectType()===m.a&&void 0!==this.state.effects.selectedEffect&&(!this.state.sequencer.showPianoRoll||this.state.arrangement.bottomMode!==N.d))return this.sequencerEngine.selectedEffect}},{key:"planarSelected",get:function(){return this.state.zobject.selectedZObject&&"Plane Parameters"===this.state.zobject.selectedZObject.name}},{key:"midiMapMode",get:function(){return this.state.midi.midiMapMode}},{key:"viewMode",get:function(){return this.state.sequencer.viewMode}},{key:"alternateViewMode",get:function(){return this.state.sequencer.alternateViewMode}},{key:"showGroups",get:function(){return this.state.sequencer.showGroups}},{key:"pointsSelected",get:function(){var e=this.selectedTrack;return e&&this.state.automation.pointsSelected[e.id]||[]}},{key:"isCompactMode",get:function(){return this.state.sequencer.isCompactMode}},{key:"cursor",get:function(){return this.sequencerEngine.cursor}},{key:"cursorStepData",get:function(){if(this.selectedTrack)return this.selectedTrack.pattern.stepBuckets[this.cursor.step].steps[0]}},{key:"resolution",get:function(){return this.state.sequencer.displayResolution}},{key:"sampleAuditioning",get:function(){return this.state.audition.sampleAuditioning}},{key:"trackRolling",get:function(){return this.state.sequencer.trackRolling}},{key:"isRecording",get:function(){return this.state.sequencer.isRecording}},{key:"selectedTrack",get:function(){return this.sequencerEngine.tracks[this.cursor.track]}},{key:"scripting",get:function(){return this.sequencerEngine.scripting}},{key:"viMode",get:function(){return this.viewMode===p.e&&this.state.commands.viMode}},{key:"trackFocused",get:function(){return this.state.sequencer.trackFocused}},{key:"isPlayingMix",get:function(){return this.state.mix.isPlayingMix}},{key:"onSelectTrack",value:function(e){this.sequencerEngine.cursor.track=e}},{key:"isShowingSoundsPane",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return!!this.state.spatial.showSearchWindow||!this.state.selector.sidebarCollapsed&&(this.state.sequencer.showSelectorMode||this.state.sequencer.sidebarViewMode!==M.g)}},{key:"isShowingPianoRoll",get:function(){return this.showPianoRoll&&this.state.arrangement.bottomMode===N.d}},{key:"showPianoRoll",get:function(){return this.state.sequencer.showPianoRoll}},{key:"showSamples2D",get:function(){return this.state.selector.showSamples2D}},{key:"selectedFreeze",get:function(){return this.state.freeze.selectedFreeze}},{key:"deleteSelectedFreeze",value:function(){var e,t=this.selectedTrack,n=this.selectedFreeze,r=F(t.frozenColumns);try{for(r.s();!(e=r.n()).done;){var a=e.value,i=-1;for(var o in a.frozenSamples)a.frozenSamples[o].ipfsHash===n&&(i=parseInt(o));if(!(i<0)){a.frozenSettings.splice(i,1),a.frozenSamples.splice(i,1),a.frozenSamplers[i].gainNode.disconnect(),a.frozenSamplers.splice(i,1),a.updateRedux();break}}}catch(s){r.e(s)}finally{r.f()}t.frozenColumns.every(function(e){return 0===e.frozenSamplers.length})&&t.isFrozen&&t.unfreeze(),this.dispatch(Object(k.Ye)(void 0))}},{key:"copiedNodesForRack",get:function(){return this.state.effects.copiedNodesForRack}},{key:"trackerParameterToEdit",get:function(){return this.state.mix.trackerParameterToEdit}},{key:"newSlice",value:function(){var e=this.selectedTrack;if(e.getTrackType()===C.f){var t=e.getSamplers()[0];t.newSlice(),this.dispatch(Object(k.tf)(e.id,t.slices.length-1))}}},{key:"moveSteps",value:function(e,t,n){var r={stepDifference:t,transposeDifference:n},a=e[0].track;this.sequencerEngine.operationManager.dispatch(Object(A.m)(a,e,r,0===t?void 0:this.resolution,!1,!1))}},{key:"duplicateSteps",value:function(){var e=this.selectedTrack,t=this.getSelectedSteps(),n=this.resolution;Object(T.a)(e,t,n)}},{key:"duplicateAllSteps",value:function(){var e=this;this.sequencerEngine.tracks.forEach(function(t){Object(T.a)(t,void 0,e.resolution)})}},{key:"legato",value:function(){var e=this.selectedTrack;if(e){var t=this.getTrackSelectedSteps();t&&0!==t.length||(t=e.getEasyPattern().getAllSteps()),Object(x.b)(e,t)}}},{key:"getTrackSelectedSteps",value:function(){if(this.selectedTrack){var e=this.getSelectedSteps();return e&&0!==e.length||(e=[this.cursorStepData]),e}}},{key:"rollSteps",value:function(){var e=this.getTrackSelectedSteps();if(e){var t=this.selectedTrack;Object(x.c)(t,e)}}},{key:"tripletSteps",value:function(){var e=this.selectedTrack,t=this.getSelectedSteps();e&&t&&0!==t.length&&Object(x.d)(e,t)}},{key:"focusSearch",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.viewMode!==p.a&&this.viewMode!==p.b){e.next=4;break}return this.dispatch(Object(k.Ff)(!0)),e.next=4,Object(P.a)(200);case 4:if((t=this.state.selector.searchInput)&&t.current&&t.current.focus){e.next=7;break}return e.abrupt("return");case 7:t.current.focus();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"isEffectsShowing",value:function(){return!this.isShowingPianoRoll&&(this.selectedTrack&&this.selectedTrack.isEffectsShowing())}},{key:"groupSteps",value:function(){var e=this.selectedTrack;if(e){var t=this.getSelectedSteps();if(this.stepsGroupMode&&t&&t.every(function(e){return!e.group}));else if(this.stepsGroupMode||!t||0===t.length||t.every(function(e){return e.group}))return this.toggleStepsGroupMode(),void this.dispatch(Object(k.jf)(void 0));Object(S.e)(t,e)}}},{key:"stepsGroupMode",get:function(){return this.state.groups.stepsGroupMode}},{key:"toggleStepsGroupMode",value:function(){this.dispatch(Object(k.Dg)(!this.stepsGroupMode)),this.sequencerEngine.updateSteps()}},{key:"sampleExplorerSelected",get:function(){return this.state.selector.sampleExplorerSelected}},{key:"hasHigherOrderSteps",value:function(){var e=this.state.higherOrder.selectedSteps;return e&&e.length>0}},{key:"selectedZObject",get:function(){return this.state.zobject.selectedZObject}},{key:"keyboardContext",get:function(){return this.state.keyboard.keyboardContext}}]),n}(function(e){Object(l.a)(n,e);var t=_(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"onArrowDown",value:function(e){if(e.preventDefault(),this.sampleExplorerSelected)this.state.zobject.selectedZObject?this.selectedTrack.auditionNext():this.sequencerEngine.auditionTrack.auditionNext();else if(this.isShowingSoundsPane(!1)){var t=e.ctrlKey||e.metaKey?10:1;this.showingSoundList?void 0===this.currentSoundInList?this.currentSoundInList=0:this.currentSoundInList+=t:void 0===this.currentTagInList?this.currentTagInList=0:this.currentTagInList+=t}else if(this.viewMode===p.b&&this.currentScene){var n=this.scenes.indexOf(this.currentScene),r=this.scenes[(n+1)%this.scenes.length];this.sequencerEngine.scenes.switchToScene(r)}else if(!this.showSamples2D||!this.isShowingSoundsPane()){if(this.sampleAuditioning)window.dispatchEvent(new Event(I.a));else{var a=this.getSelectedSteps();a&&a.length>0?this.moveSteps(a,0,e.ctrlKey||e.metaKey?-12:-1):(this.sequencerEngine.tracks.length,this.sequencerEngine.down(),this.onSelectTrack(this.cursor.track))}return!0}}},{key:"onArrowRight",value:function(e,t){if(this.isShowingSoundsPane(!1)){var n=e.ctrlKey||e.metaKey?10:1;this.showingSoundList||(void 0===this.currentTagInList?this.currentTagInList=0:this.currentTagInList+=n)}else if(!this.waveformShowing&&(e.preventDefault(),!this.showSamples2D||!this.isShowingSoundsPane())){if(this.viewMode===p.a)return function(e){var t=j(e.state);if(t){var n=t.subSequence.mix;if(n){var r=n.getNextEvent(t);return r?O(e,r):void 0}}}(this.sequencerEngine);if(this.cursor.track in this.sequencerEngine.tracks){var r=this.getSelectedSteps();r&&r.length>0?this.moveSteps(r,e.ctrlKey||e.metaKey?4:1,0):this.sequencerEngine.right(void 0,t)}}}},{key:"onArrowLeft",value:function(e,t){if(this.isShowingSoundsPane(!1)){var n=e.ctrlKey||e.metaKey?10:1;this.showingSoundList||(void 0===this.currentTagInList?this.currentTagInList=0:this.currentTagInList=Math.max(0,this.currentTagInList-n))}else if(!this.waveformShowing&&(e.preventDefault(),!this.showSamples2D||!this.isShowingSoundsPane())){if(this.viewMode===p.a)return function(e){var t=j(e.state);if(t){var n=t.subSequence.mix;if(n){var r=n.getPreviousEvent(t);return r?O(e,r):void 0}}}(this.sequencerEngine);var r=this.getSelectedSteps();r&&r.length>0?this.moveSteps(r,e.ctrlKey||e.metaKey?-4:-1,0):this.sequencerEngine.left(void 0,t)}}},{key:"onArrowUp",value:function(e){if(e.preventDefault(),this.sampleExplorerSelected)this.state.zobject.selectedZObject?this.selectedTrack.auditionPrevious():this.sequencerEngine.auditionTrack.auditionPrevious();else if(this.isShowingSoundsPane(!1)){var t=e.ctrlKey||e.metaKey?10:1;this.showingSoundList?void 0===this.currentSoundInList?this.currentSoundInList=0:this.currentSoundInList=Math.max(0,this.currentSoundInList-t):void 0===this.currentTagInList?this.currentTagInList=0:this.currentTagInList=Math.max(0,this.currentTagInList-t)}else if(this.viewMode===p.b&&this.currentScene){var n=this.scenes.indexOf(this.currentScene)-1,r=this.scenes[n<0?this.scenes.length-1:n];this.sequencerEngine.scenes.switchToScene(r)}else if(!this.showSamples2D||!this.isShowingSoundsPane()){if(this.sampleAuditioning)window.dispatchEvent(new Event(I.b));else{var a=this.getSelectedSteps();a&&a.length>0?this.moveSteps(a,0,e.ctrlKey||e.metaKey?12:1):(this.sequencerEngine.up(),this.onSelectTrack(this.cursor.track))}return!0}}}]),n}(function(){return function e(){Object(s.a)(this,e)}}()));t.a=z},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(9);function a(e){var t=Math.max(30,Math.max.apply(Math,Object(r.a)(e.mixes.map(function(e){return e.length/32+16}))));return Math.floor(2*t)}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(737),o=n(339),s=n(6),c=(n(55),n(182)),u=n(12);t.a=Object(u.b)(function(e,t){var n=t.sequencerEngine.getSelectedTrack(),r=n&&n.preset;return{track:n,hasPreset:r&&r.contentHash,defaultSample:n&&n.sample,searchText:e.selector.quickAddSearchText,preset:r,selectedTrack:e.mix.selectedTrack,numTracks:t.sequencerEngine.tracks&&t.sequencerEngine.tracks.length,isFrozen:n&&n.isFrozen,selectedSteps:e.keyboard.selectedPianoRollSteps,explorerMaximized:e.selector.explorerMaximized}},function(e){return{setMaximizeExplorer:function(t){return e(Object(s.gd)(t))},setSearchText:function(t){return e(Object(s.ye)(t))}}})(function(e){var t=e.explorerMaximized,n=e.setSearchText,s=e.setMaximizeExplorer,u=e.sequencerEngine,l=(e.numTracks,e.searchText),f=e.preset,h=e.selectedSteps,p=e.hasPreset,d=e.isPianoRoll,m=e.track,v="",b=Object(c.a)(function(){s(!t),n("")});if(Object(r.useEffect)(function(){s(!1)},[]),Object(r.useEffect)(function(){u.tracks&&0===u.tracks.length&&s(!1)},[u.tracks]),void 0===m||void 0===m.instrument&&void 0===m.tracks||m.isFrozen||!f||m.instrument&&!p&&m.sample){if(!m||m.isFrozen)return[];v=a.a.createElement(i.a,{isPianoRoll:d,track:m})}else{var g=m.instrument?m.instrument.getInstrumentType():m.getTrackType();v=a.a.createElement(o.a,{isPianoRoll:d,initialSize:18,track:m,content:m.preset,searchText:l,type:g})}var y="quick-presets";return!d&&h&&h.filter(function(e){return e&&e.group}).length>0&&(y+=" hide"),a.a.createElement("div",{onClick:b,className:y},v)})},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(626),a=n(0),i=n.n(a);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.sequencerEngine;return i.a.createElement(r.a,{scrollContainer:t,hideLock:!0,isRack:n,store:a.store,sequencerEngine:a,onParameterChanged:function(e){return[]},onEffectsChange:function(){return e.updateEffects()},panning:0,onChangePanning:function(e){return console.log("panning changed = "+e)},sends:a.sends,tracks:[],track:e,send:void 0,group:void 0})}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(12),f=n(79),h=n(34),p=n(76),d=n(6);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var v=["A","B","C","D","E","F","G","H","I","J","K","L","M","N"],b=function(e){Object(i.a)(n,e);var t=m(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"chooseSubSequence",value:function(e){this.props.viewMode!==f.f&&this.props.viewMode!==f.c||this.props.setViewMode(f.e),this.props.sequencerEngine.switchToSubSequence(e)}},{key:"newSubSequence",value:function(){this.props.viewMode!==f.f&&this.props.viewMode!==f.c||this.props.setViewMode(f.e),this.props.sequencerEngine.newSubSequence()}},{key:"deleteSubSequence",value:function(){window.confirm("Are you sure you want to delete this SUB SEQUENCE?")&&this.props.sequencerEngine.deleteSubSequence()}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"sub-sequences-container"},this.props.subSequences.filter(function(t){return!e.props.sequencerEngine.getSubSequence(t).isTrack}).map(function(t,n){return u.a.createElement(p.a,{element:h.q,key:v[n],onClick:function(){return e.chooseSubSequence(t)},className:t===e.props.currentSubSequence?"sub-sequence selected":"sub-sequence"},v[n])}),u.a.createElement(p.a,{element:h.V,onClick:function(){return e.newSubSequence()},className:"new-sub-sequence"},"+"),u.a.createElement(p.a,{element:h.s,onClick:function(){return e.deleteSubSequence()},className:"delete-sub-sequence"},"-"))}}]),n}(c.Component);t.a=Object(l.b)(function(e,t){var n=t.sequencerEngine.engineId;return{subSequences:e.sequencer.subSequences[n]||[],currentSubSequence:e.sequencer.currentSubSequence[n],viewMode:e.sequencer.viewMode}},function(e){return{setViewMode:function(t){return e(Object(d.Dh)(t))}}})(b)},function(e,t,n){},function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return c});var r=n(0),a=n.n(r),i=new(n(29).a),o=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return a.a.createElement(s,{event:e,subSequence:t,duration:n,width:r,useTranspose:i})},s=Object(r.memo)(function(e){var t=e.event,n=e.subSequence,r=e.duration,i=e.width,o=e.useTranspose,s=void 0!==o&&o;return void 0===t.patternNumber?"":a.a.createElement("div",{className:"pattern-visualization"},n.tracks.slice(0,13).map(function(e,n){return a.a.createElement(c,{useTranspose:s,key:n,track:e,patternNumber:t.patternNumber,stepWidth:i,duration:r,step:t.step})}))}),c=Object(r.memo)(function(e){var t=e.isSelected,n=e.track,r=e.patternNumber,o=e.duration,s=e.step,c=void 0===s?0:s,u=e.stepWidth,l=e.useTranspose,f=n.patterns[r%n.patterns.length],h=c%f.length(),p=[];for(var d in f.stepBucketsMatrix){d=parseInt(d);for(var m=f.stepBucketsMatrix[d].getAllOnSteps()[0],v=0,b=d-h;b<o;b+=f.length())if(!(b<0)){var g={left:u*b,top:3*n.trackNumber,width:2*u*m.duration,backgroundColor:i.getColorForTrack(n),height:2};v>0&&(g.opacity=.3),l&&(g.top=20+.5*m.transpose),p.push(a.a.createElement("div",{key:b,style:g,className:"track-step"})),v++}}return a.a.createElement("div",{className:t?"selected track-steps":"track-steps"},p)})},function(e,t,n){"use strict";var r=n(8),a=n(11),i=n(0),o=n.n(i),s=n(33),c=n(12),u=new s.a(4,!1),l=new s.a(8,!1),f=new s.a(16,!1),h=new s.a(32,!1),p=function(e){var t=e.color,n=e.resolution,s=e.sequencerEngine,c=e.isSequenceRolling,u=e.engine,l=Object(i.useRef)(void 0),f=Object(i.useState)(!1),h=Object(a.a)(f,2),p=h[0],d=h[1];Object(i.useEffect)(function(){d(c)},[c,d]);var m=Object(i.useCallback)(function(){var e=Object(r.a)({},s.idToSequencerEngine,{"-1":s.samplerTrack}),t=u||e[Object.keys(e)[0]];if(void 0!==t){for(var a in t.resolution=n,t.trackRolling=!0,e)e[a]&&(e[a].sequenceRolling=!0);u&&(u.sequenceRolling=!0),d(!0)}},[d,u]),v=Object(i.useCallback)(function(){var e=Object(r.a)({},s.idToSequencerEngine,{"-1":s.samplerTrack}),t=u||e[Object.keys(e)[0]];if(void 0!==t){for(var a in t.resolution=n,e)e[a]&&(e[a].sequenceRolling=!1);t.trackRolling=!1,u&&(u.sequenceRolling=!1),d(!1)}},[d]),b="explore-roll-button";return p&&(b+=" flash-it rolling"),o.a.createElement("div",{ref:l,style:{backgroundColor:t},onMouseDown:m,onMouseUp:v,onTouchStart:m,onTouchEnd:v,onTouchLeave:v,className:b},"1/",n.resolution)};t.a=Object(c.b)(function(e,t){return{resolution:e.sequencer.resolution,isRolling:e.sequencer.trackRolling&&t.sequencerEngine&&t.sequencerEngine.isSequenceRolling}},null)(function(e){var t=e.color,n=e.resolution,r=e.sequencerEngine,a=e.isRolling,i=e.engine;return o.a.createElement("div",{className:"roll-buttons"},o.a.createElement(p,{color:t,isSequenceRolling:a&&4===n.resolution,engine:i,sequencerEngine:r,resolution:u}),o.a.createElement(p,{color:t,isSequenceRolling:a&&8===n.resolution,engine:i,sequencerEngine:r,resolution:l}),o.a.createElement(p,{color:t,isSequenceRolling:a&&16===n.resolution,engine:i,sequencerEngine:r,resolution:f}),o.a.createElement(p,{color:t,isSequenceRolling:a&&32===n.resolution,engine:i,sequencerEngine:r,resolution:h}))})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(6),s=n(1481),c=n(12);t.a=Object(c.b)(function(e,t){var n=Math.floor(t.group.sequencerEngine.lastTrackStep||0),r=t.group.sequencerEngine.cursor;return{currentStep:Math.floor(n/2),pattern:t.group.tracks[0]&&t.group.tracks[0].pattern,cursorStep:r.step/2,playing:t.group.sequencerEngine.playing,numTracks:t.group.tracks&&t.group.tracks.length}},function(e){return{setParameterToEdit:function(t){return e(Object(o.oh)(t))}}})(function(e){var t=e.group,n=e.currentStep,o=e.setParameterToEdit,c=e.cursorStep,u=e.playing,l=Object(a.useRef)(l),f=Object(a.useState)(void 0),h=Object(r.a)(f,2),p=h[0],d=h[1],m=Object(a.useState)(!1),v=Object(r.a)(m,2),b=v[0],g=v[1],y=Object(a.useRef)(!1);Object(a.useCallback)(function(){d(void 0)},[n,d,g]);Object(a.useEffect)(function(){d(void 0),y.current=!1,g(!1)},[u,d,g]);var k=Object(a.useCallback)(function(e){e.stopPropagation(),e.preventDefault();var r=Math.min(t.sequencerEngine.length,Math.max(0,(p||n)+e.deltaY/8));d(r),g(!0)},[d,p,n,g]);Object(a.useEffect)(function(){return l.current.addEventListener("mousewheel",k),function(){l.current&&l.current.removeEventListener("mousewheel",k)}},[d,p,n,g]);var O=Object(a.useCallback)(function(){d(void 0),o(void 0),g(!1),y.current=!1},[d,o]);Object(a.useEffect)(function(){y.current||(t.sequencerEngine.getSelectedTrack(),d(c))},[c,d]);var j=t.sequencerEngine.getSelectedTrack();return Object(a.useEffect)(function(){},[p,c,d,b,j]),i.a.createElement("div",{onMouseLeave:O,ref:l,className:"group-tracker"},t.tracks.map(function(e){return i.a.createElement(s.a,{pattern:e.pattern,editing:y,step:Math.floor(p),setIsScrolling:g,cursorStep:c,currentStep:n,key:e.id,track:e})}))})},function(e,t,n){"use strict";var r=n(9),a=n(99),i=n(0),o=n.n(i),s=(n(505),n(1482)),c=(n(743),n(1047)),u=n(1110),l=n(12);t.a=Object(l.b)(function(e,t){return{effects:e.pads.padEffects[t.pad.id],isCollapsed:e.effects.effectCollapsed[t.pad.effectRack.id]}},function(e){return{}})(function(e){var t=e.pad,n=e.effects,l=e.isCollapsed,f=Object(a.a)(e,["pad","effects","isCollapsed"]),h=Object(i.useCallback)(function(e){console.log("on delete fx =",e),t.effectRack.deleteEffect(e),t.updateEffectRedux()},[]);return t.effectRack&&n&&0!==n.length?l?[o.a.createElement(c.a,Object.assign({key:0,pad:t},f))]:[o.a.createElement(c.a,Object.assign({key:0,pad:t},f)),o.a.createElement(s.a,Object.assign({key:5,pad:t},f)),,].concat(Object(r.a)(t.effectRack.effects.map(function(e){return o.a.createElement(u.a,Object.assign({onDelete:h,key:e.id,rack:t.effectRack,fx:e,showDelete:!0,sequencerEngine:t.sequencerEngine,pad:t},f))}))):[]})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12);n(164),n(2708);t.a=Object(i.b)(function(e,t){var n=t.sequencerEngine,r=t.id;return{sampleDownloadProgress:e.sequencer.sampleDownloadProgress,loadingProgress:e.sequencer.sequenceLoadingProgress[r||n.sequenceId]||0}},null)(function(e){var t=e.loadingProgress,n=e.sampleDownloadProgress,r=e.width,i=void 0===r?390:r;n&&(t+=75*n.downloaded/n.total,n.downloaded===n.total&&(t-=75));var o={width:i*t/100};return a.a.createElement("div",{className:"progress-bar"},a.a.createElement("div",{className:"inner-progress-bar"},a.a.createElement("div",{className:"progress",style:o}),a.a.createElement("div",{className:"loading-text"},n&&n.downloaded<n.total?"Loading stem ".concat(n.downloaded+1," of ").concat(n.total):"Loading Player ...")))})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=(n(1551),n(55)),o=n(845),s=n(699),c=n(1466),u=n(339),l=n(97),f=n(12),h=n(737);n(2709);t.a=Object(f.b)(function(e,t){return{namme:t.object.name,preset:t.object.preset&&t.object.preset.contentHash}},function(e){return{}})(function(e){var t=e.object,n=e.sequencerEngine;if(t.getObjectType()===l.c){if(t.getTrackType()===i.a)return"";if(t.sample)return a.a.createElement(h.a,{isPianoRoll:!0,track:t});var r=t,f=r.instrument?r.instrument.getInstrumentType():r.getTrackType();return a.a.createElement(u.a,{isPianoRoll:!1,initialSize:18,track:t,content:t.preset,searchText:"",type:f})}if(t.getObjectType()===l.b)return a.a.createElement(c.a,{pad:t});if(t.getObjectType()===l.e)return a.a.createElement(u.a,{initialSize:18,zobject:t,content:t.preset,searchText:"",type:t.getInstrumentType()});if(t.getObjectType()===l.a){var p=Object(s.a)(t);if(p)return a.a.createElement(o.a,{sequencerEngine:n,trackNumber:p.trackNumber,hide:function(){return 0},effect:t})}return a.a.createElement("div",null)})},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return i});var r=1,a=2,i=3},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(20),u=n(7),l=n(10),f=n(1),h=n(58),p=n(11),d=n(0),m=n.n(d),v=n(90),b=n.n(v),g=n(365),y=n(202),k=n(59),O=n(12),j=(n(2433),Object(O.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.onClickCancel,r=Object(d.useState)(""),o=Object(p.a)(r,2),s=o[0],c=o[1],u=Object(d.useState)(8),l=Object(p.a)(u,2),f=l[0],v=l[1],O=Object(d.useState)(.1),j=Object(p.a)(O,2),w=j[0],E=j[1],S=Object(d.useState)(!1),P=Object(p.a)(S,2),x=P[0],T=P[1],C=Object(d.useState)(!1),N=Object(p.a)(C,2),R=(N[0],N[1]),M=Object(d.useCallback)(Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),e.next=3,Object(g.d)(t,s,f,w*Math.pow(10,18));case 3:R(!0),T(!1);case 5:case"end":return e.stop()}},e)})),[w,s,f,T,R]);return m.a.createElement(h.a,{dialogClassName:"mint-modal preset-modal render-modal",show:!0,onHide:n},m.a.createElement(h.a.Header,{closeButton:!0},m.a.createElement(h.a.Title,null,"Mint NFT")),m.a.createElement(h.a.Body,null,x?m.a.createElement(y.a,{text:"Minting your nft"}):m.a.createElement("div",null,m.a.createElement("input",{placeholder:"Title your work",value:s,type:"text",onChange:function(e){return c(e.target.value)}}),m.a.createElement("div",{className:"editions"},m.a.createElement("div",{className:"value"},"Editions: ",f),m.a.createElement(b.a,{value:f,change:function(e){return v(e.target.value)},step:1,max:1e3,min:1,orientation:"horizontal",reversed:!1})),m.a.createElement("div",{className:"price"},m.a.createElement("div",{className:"value"},"Price: ",w," eth"),m.a.createElement(b.a,{value:w,change:function(e){return E(e.target.value)},step:.001,max:1,min:.001,orientation:"horizontal",reversed:!1})))),m.a.createElement(h.a.Footer,null,m.a.createElement(k.b,{variant:"secondary",onClick:M},"Mint!"),m.a.createElement(k.b,{variant:"primary",onClick:n},"Cancel")))})),w=n(6),E=n(9),S=n(30);function P(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var T=function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.encryption.getPotentialUsers();case 2:t=e.sent,[],n=[],r=P(t),e.prev=6,r.s();case 8:if((i=r.n()).done){e.next=16;break}return o=i.value,e.next=12,S.a.users.getUserName(o);case 12:(s=e.sent)&&""!==s&&n.push({id:o,userName:s});case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return console.log("USERS =",n),e.abrupt("return",n);case 26:case"end":return e.stop()}},e,null,[[6,18,21,24]])}));return function(){return e.apply(this,arguments)}}(),C=Object(O.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.onSharedWithChanged,n=(e.guildId,Object(d.useState)("")),r=Object(p.a)(n,2),a=r[0],i=r[1],o=Object(d.useState)([]),s=Object(p.a)(o,2),c=s[0],u=s[1],l=Object(d.useState)([]),f=Object(p.a)(l,2),h=f[0],v=f[1],b=Object(d.useState)([]),g=Object(p.a)(b,2),y=g[0],k=g[1];Object(d.useEffect)(function(){},[u]),Object(d.useEffect)(function(){t(c)},[c]),Object(d.useEffect)(function(){T().then(function(e){return v(e)})},[v]);var O=Object(d.useCallback)(function(e){u([].concat(Object(E.a)(c),[e])),i(""),k([])},[c,u,k]),j=Object(d.useCallback)(function(e){"Enter"===e.key&&O(a)},[u,a,c]);Object(d.useEffect)(function(){if(""===a.trim())k([]);else{var e=h.filter(function(e){return e.userName.toLowerCase().includes(a.toLowerCase())});k(e)}},[a,k]);var w=Object(d.useCallback)(function(e){u(c.filter(function(t){return t!==e}))},[u,c]);return m.a.createElement("div",{className:"share-with-people"},m.a.createElement("div",{className:"people-input-container"},c.map(function(e){return m.a.createElement("div",{className:"shared-user"},e,m.a.createElement("div",{onClick:function(){return w(e)},className:"delete-user"},"x"))}),m.a.createElement("input",{placeholder:"Type collaborators to share this with",className:"people-input",value:a,type:"text",onKeyDown:j,onChange:function(e){return i(e.target.value)}})),m.a.createElement("div",{className:"auto-completion-users"},y.map(function(e){return m.a.createElement("div",{onClick:function(){return O(e.userName)},className:"auto-completed-user"},e.userName)})))}),N=n(92);function R(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A=function(e){return new Promise(function(){var t=Object(i.a)(a.a.mark(function t(n){var r,i,o,s,c,u,l,f,h,p,d;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=S.a.users,i=S.a.guilds,o=void 0,s=Object(E.a)(e),t.t0=e,t.next=6,r.getUserName();case 6:t.t1=t.sent,t.t0.push.call(t.t0,t.t1),c=R(e),t.prev=9,c.s();case 11:if((u=c.n()).done){t.next=23;break}return l=u.value,t.next=15,r.getUserId(l);case 15:return f=t.sent,t.next=18,i.getGuildsForUser(f);case 18:h=t.sent,h=new Set(h.map(function(e){return e.guildId})),o=void 0===o?h:q(o,h);case 21:t.next=11;break;case 23:t.next=28;break;case 25:t.prev=25,t.t2=t.catch(9),c.e(t.t2);case 28:return t.prev=28,c.f(),t.finish(28);case 31:if(o=Array.from(o),p=void 0,0!==o.length){t.next=40;break}return t.delegateYield(a.a.mark(function t(){var o,c,u,l,f,h,d;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.join(","),t.next=3,i.newGuild(o);case 3:c=t.sent;case 4:return t.next=7,i.getGuildsForUser();case 7:if(u=t.sent,console.log("GUILDS found =",u),!(p=u.find(function(e){return e.name===o}))){t.next=13;break}return p=p.guildId,t.abrupt("break",17);case 13:return t.next=15,Object(N.a)(2e3);case 15:t.next=4;break;case 17:i.saveGuildKey(p,c),n(p),l=R(s),t.prev=20,l.s();case 22:if((f=l.n()).done){t.next=31;break}return h=f.value,t.next=26,r.getUserId(h);case 26:return d=t.sent,t.next=29,i.requestToAddMember(p,d);case 29:t.next=22;break;case 31:t.next=36;break;case 33:t.prev=33,t.t0=t.catch(20),l.e(t.t0);case 36:return t.prev=36,l.f(),t.finish(36);case 39:return t.abrupt("return",{v:void 0});case 40:case"end":return t.stop()}},t,null,[[20,33,36,39]])})(),"t3",35);case 35:if("object"!==typeof(d=t.t3)){t.next=38;break}return t.abrupt("return",d.v);case 38:t.next=41;break;case 40:p=o[0];case 41:n(p);case 42:case"end":return t.stop()}},t,null,[[9,25,28,31]])}));return function(e){return t.apply(this,arguments)}}())},q=function(e,t){var n,r=[],a=R(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;t.has(i)&&r.push(i)}}catch(u){a.e(u)}finally{a.f()}var o,s=R(t);try{for(s.s();!(o=s.n()).done;){var c=o.value;e.has(c)&&r.push(c)}}catch(u){s.e(u)}finally{s.f()}return new Set(r)},D=n(1377),I=n(207);function _(e){var t=e.sequencerEngine,n=(e.selectedGuild,t.getAllRecordingsToSave().length);return 0===n?m.a.createElement("div",null):m.a.createElement("div",{className:"save-recordings"},"You have ",n," new sounds to",m.a.createElement("span",{onClick:function(){return t.saveAnyNewRecordings(0)},className:"save-recordings-button"},"save"),".")}n(1378),n(52);var F=n(38),L=n(141);function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var z=function(e){Object(u.a)(n,e);var t=B(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={sequenceHash:void 0,creatingLink:!1},r}return Object(s.a)(n,[{key:"getLink",value:function(){return window.explore?"https://zequencer.io/explore/"+this.state.sequenceHash:"https://zequencer.io/create/"+this.state.sequenceHash}},{key:"copyLink",value:function(){var e=this,t=this.linkInput;t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),this.setState({copied:!0}),setTimeout(function(){return e.setState({copied:!1})},1e3)}},{key:"createLink",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({creatingLink:!0}),e.next=3,this.props.sequencerEngine.save(void 0,L.c,!1);case 3:t=e.sent,this.setState({sequenceHash:t,creatingLink:!1});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"exportToWAV",value:function(){Object(I.a)(this.props.sequencerEngine)}},{key:"render",value:function(){var e=this;return m.a.createElement("div",{className:"link-creator"},m.a.createElement(F.a,{condition:void 0===this.state.sequenceHash},m.a.createElement("div",{onClick:function(){return e.createLink()},className:"link-button"},"Create Public Link")),m.a.createElement(F.a,{condition:void 0!==this.state.sequenceHash},m.a.createElement("div",null,"Link: ",m.a.createElement("input",{type:"text",value:this.getLink(),id:"linkInput",ref:function(t){e.linkInput=t}})),m.a.createElement("div",{onClick:function(){return e.copyLink()},className:"small-button pink-button"},"Copy Link"),m.a.createElement("div",{className:"clear-fix"}),m.a.createElement(F.a,{condition:this.state.copied},m.a.createElement("div",{className:"copied-info"},"Copied to clipboard!"))),m.a.createElement("div",{onClick:function(){return e.props.onClickExport()},className:"link-button export-to-wav-btn"},"Export to WAV"))}}]),n}(d.Component),V=n(1044),H=(n(164),n(1379),n(196),n(62)),U=(n(1380),n(210),n(34)),J=(n(459),n(349));function G(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var W=function(e){Object(u.a)(n,e);var t=G(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={nameValue:"",numTokens:1,saveOption:L.b,metamaskInstalled:!0,showBuying:!1,sequenceHash:void 0,copied:!1,selectedGuild:void 0,guildOptions:[],renderLength:64,mintNFT:!1,renderOption:J.b,shareWith:[],formingGuild:!1},r.input=void 0,r.onClickDone=r.onClickDone.bind(Object(c.a)(r)),r.onClickCancel=r.onClickCancel.bind(Object(c.a)(r)),r.onClickExport=r.onClickExport.bind(Object(c.a)(r)),S.a.tokenizedSequences.callback=function(){return r.onBalanceUpdated()},r}return Object(s.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.show&&e.show!==this.props.show&&this.getGuilds(),e.show||e.show===this.props.show||(this.state.sequenceHash=void 0,this.state.copied=!1),!0}},{key:"getGuilds",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.guilds.getGuildsForUser();case 2:t=e.sent,void 0!==this.props.selectedGuild&&this.setState({saveOption:L.a}),this.setState({selectedGuild:this.props.selectedGuild||t[0],guildOptions:t.filter(function(e){return e.name.split(",").length<2})});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.show!=e.show){this.input&&this.input.focus();var n=this.props.sequencerEngine.sequenceId;0===n&&-1===n&&void 0===n||S.a.guildSequences.getGuildSequence(n).then(function(e){e?(console.log("GUILD SEQUENCE =",e),t.setState({sequenceGuildId:e.guildId})):t.setState({sequenceGuildId:void 0})})}return!0}},{key:"onClickDone",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({showExportMode:!1}),!this.state.showBuying){e.next=6;break}S.a.tokenizedSequences.buyTokens(parseInt(this.state.numTokens)),this.setState({onPurchased:!0,showBuying:!1}),e.next=18;break;case 6:if(t=this.state.shareWith,n=void 0,!(this.state.saveOption===L.b&&t.length>0)){e.next=17;break}return this.setState({formingGuild:!0}),e.next=12,A(t);case 12:n=e.sent,this.setState({formingGuild:!1}),this.props.onSave(this.state.nameValue,L.a,{guildId:n}),e.next=18;break;case 17:this.props.onSave(this.state.nameValue,this.state.saveOption,this.state.selectedGuild);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickCancel",value:function(){if(this.state.showBuying)this.setState({showBuying:!1});else{this.setState({showExportMode:!1,mintNFT:!1}),this.props.onHide();var e=this.props.sequencerEngine.state.freeze.offlineEngine;console.log("OFFLINE ENGINE =",e),e&&(console.log("SUSPENDING"),e.stop(),e.context._context.suspend(e.context._context.currentTime+.5).then(function(){console.log("DISPOSING"),e.dispose()}))}}},{key:"onInputType",value:function(e){this.setState({nameValue:e})}},{key:"handleCheckboxChange",value:function(e){this.setState({saveOption:e.target.name})}},{key:"onTokenType",value:function(e){""===e&&this.setState({numTokens:0}),Object(H.a)(e)&&this.setState({numTokens:e})}},{key:"onSelectGuild",value:function(e){this.setState({selectedGuild:e})}},{key:"showExportMode",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({showExportMode:e})}},{key:"onClickExport",value:function(){var e=this;this.setState({bouncing:!0}),setTimeout(Object(i.a)(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(I.a)(e.props.sequencerEngine,e.state.renderLength,e.state.renderOption);case 2:e.setState({bouncing:!1}),e.onClickCancel(),e.onClickCancel();case 5:case"end":return t.stop()}},t)})),80)}},{key:"onChangeRenderLength",value:function(e){try{var t=parseInt(e);this.setState({renderLength:t})}catch(n){}}},{key:"login",value:function(){this.props.setShowLogin(!0)}},{key:"render",value:function(){var e=this;return this.state.mintNFT?m.a.createElement(j,{onClickCancel:function(){return e.onClickCancel()},sequencerEngine:this.props.sequencerEngine}):this.state.showExportMode?m.a.createElement(h.a,{dialogClassName:"preset-modal render-modal",show:this.props.show,onHide:this.onClickCancel},m.a.createElement(h.a.Header,{closeButton:!0},m.a.createElement(h.a.Title,null,"Export Project")),m.a.createElement(h.a.Body,null,m.a.createElement("div",{className:"render-options"},m.a.createElement("div",{className:"render-label"},"Rendered Track"),m.a.createElement("div",{onClick:function(){return e.setState({renderOption:J.b})},className:this.state.renderOption===J.b?"selected render-option":"render-option"},"Master"),m.a.createElement("div",{onClick:function(){return e.setState({renderOption:J.a})},className:this.state.renderOption===J.a?"selected render-option":"render-option"},"Groups")),m.a.createElement("div",{className:"render-length"},m.a.createElement("div",{className:"render-label"},"Render Length"),m.a.createElement("input",{onChange:function(t){return e.onChangeRenderLength(t.target.value)},className:"render-length-input",value:this.state.renderLength})),this.state.bouncing?m.a.createElement(D.a,{renderLength:this.state.renderLength}):""),m.a.createElement(h.a.Footer,null,this.state.bouncing?"":m.a.createElement(k.b,{variant:"secondary",onClick:this.onClickExport},"Export"),this.state.bouncing?"":m.a.createElement(k.b,{variant:"primary",onClick:this.onClickCancel},"Cancel"))):this.props.userToken?m.a.createElement(h.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},m.a.createElement(h.a.Header,{closeButton:!0},m.a.createElement(h.a.Title,null,"Save Project")),m.a.createElement(h.a.Body,null,m.a.createElement("input",{value:this.state.nameValue,onChange:function(t){return e.onInputType(t.target.value)},ref:function(t){e.input=t},placeholder:"Type name of project",className:"tag-input"}),m.a.createElement("form",null,m.a.createElement("input",{name:L.c,type:"checkbox",checked:this.state.saveOption===L.c,onChange:function(t){return e.handleCheckboxChange(t)}}),m.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(U.nb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Public"),m.a.createElement("input",{name:L.b,value:L.b,type:"checkbox",checked:this.state.saveOption===L.b,onChange:function(t){return e.handleCheckboxChange(t)}}),m.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(U.lb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Private"),m.a.createElement("input",{name:L.a,value:L.a,type:"checkbox",checked:this.state.saveOption===L.a,onChange:function(t){return e.handleCheckboxChange(t)}}),m.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(U.lb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Guild")),m.a.createElement(_,{selectedGuild:this.state.selectedGuild,sequencerEngine:this.props.sequencerEngine}),m.a.createElement(F.a,{condition:this.state.saveOption===L.b},m.a.createElement(C,{guildId:this.state.sequenceGuildId,onSharedWithChanged:function(t){return e.setState({shareWith:t})}}),this.state.formingGuild?m.a.createElement(y.a,{text:"Creating encrypted group"}):""),m.a.createElement(F.a,{condition:this.state.saveOption===L.a},m.a.createElement(V.a,{onSelectGuild:function(t){return e.onSelectGuild(t)},selectedGuild:this.state.selectedGuild,guildOptions:this.state.guildOptions})),m.a.createElement(z,{onClickMint:function(){return e.setState({mintNFT:!0})},onClickExport:function(){return e.showExportMode(!0)},sequencerEngine:this.props.sequencerEngine})),this.state.formingGuild?"":m.a.createElement(h.a.Footer,null,m.a.createElement(k.b,{variant:"secondary",onClick:this.onClickDone},"Save"),m.a.createElement(k.b,{variant:"primary",onClick:this.onClickCancel},"Cancel"))):m.a.createElement(h.a,{dialogClassName:"preset-modal save-modal",show:this.props.show,onHide:this.onClickCancel},m.a.createElement(h.a.Header,{closeButton:!0},m.a.createElement(h.a.Title,null,"Save Sequence")),m.a.createElement(h.a.Body,null,m.a.createElement("div",{className:"no-metamask"},m.a.createElement("span",{onClick:function(){return e.login()},className:"login-btn"},"Login")," to save your song to your account."),m.a.createElement(z,{onClickMint:function(){return e.setState({mintNFT:!0})},onClickExport:function(){return e.showExportMode(!0)},sequencerEngine:this.props.sequencerEngine})),m.a.createElement(h.a.Footer,null,m.a.createElement(k.b,{variant:"secondary",onClick:this.onClickCancel},"Done")))}}]),n}(d.Component);t.a=Object(O.b)(function(e){return{selectedGuild:e.guilds.selectedGuild,userToken:e.sequencer.userToken}},function(e){return{setShowLogin:function(t){return e(Object(w.Qf)(t))},setContextualHelp:function(t){return e(Object(w.ub)(t))}}})(W)},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(837),o=n(63),s=(n(629),n(38)),c=n(114),u=n(22),l=n(12),f=(Object(l.b)(function(e,t){return{harmonicity:t.oscillator.harmonicityParameter.get()}},function(e){return{}})(function(e){var t=e.harmonicity,n=Math.floor(t),r=t-n;return a.a.createElement("div",{className:"harmonicity fm-parameter"},a.a.createElement("div",null,"Harmonicity"),a.a.createElement("div",{className:"values"},a.a.createElement("div",{className:"whole-value"},n),a.a.createElement("div",{className:"dot-value"},"."),a.a.createElement("div",{className:"decimal-value"},r)))}),Object(l.b)(function(e,t){return{}},function(e){return{}})(function(e){return a.a.createElement("div",null,a.a.createElement(u.a,{name:"Feedback",sequencerEngine:e.sequencerEngine,lfoEnabled:!0,parameter:e.oscillator.feedbackParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:2,step:.01}))}),Object(l.b)(function(e,t){return{modulation:t.oscillator.modulationIndexParameter.get()}},function(e){return{}})(function(e){return a.a.createElement("div",{className:"harmonicity fm-parameter"},a.a.createElement("div",null,"Modulation"),a.a.createElement("div",{className:"value"},e.modulation))}),n(850),n(536));Object(l.b)(function(e,t){var n=t.instrument.getOscillator(t.selectedOscillator);return{keyboard:n.keyboard,customOscillatorType:n.customOscillatorType,oscillatorType:n.oscillatorType,partials:n.partials,bandpass:n.bandpassParameter.get()}},function(e){return{}})(function(e){var t=e.selectedOscillator,n=e.instrument,r=(e.color,n.getOscillator(t));return a.a.createElement("div",{className:"instrument-subsection fm-operator-control"},a.a.createElement("div",{className:"top-of-section"},a.a.createElement("div",{className:"instrument-subsection-name"},r.name),a.a.createElement("div",{className:"osc-type-container"},a.a.createElement(f.a,{instrument:n,oscillator:r,sequencerEngine:n.sequencerEngine}))),r.customOscillatorType?a.a.createElement(u.a,{name:"Harmonics",sequencerEngine:n.sequencerEngine,isParameter:!0,parameter:r.harmonicsParameter,step:.001,min:-1,max:1}):"","custom"===r.oscillatorType?a.a.createElement(i.a,{partials:r.partials,oscillator:r}):"",r.customOscillatorType||"custom"===r.oscillatorType?"":a.a.createElement("div",{className:"partials"},a.a.createElement(u.a,{name:"Partials",sequencerEngine:n.sequencerEngine,isParameter:!0,parameter:r.partialCountParameter,step:1,min:0,max:64})),a.a.createElement(u.a,{sequencerEngine:n.sequencerEngine,name:"Volume",parameter:r.oscillatorLevelParameter,onParameterChanged:function(){return[]},displayFunction:function(e){return Math.round(100*e)},unit:"%",isParameter:!0,lfoEnabled:!0,min:0,max:1,step:.01}),a.a.createElement(s.a,{condition:"PWM"===r.oscillatorTypeParameter.get()},a.a.createElement(u.a,{sequencerEngine:n.sequencerEngine,name:"PWM",parameter:r.pwmParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:0,max:20,step:.01})),a.a.createElement("div",{className:"frequency-parameters"},a.a.createElement(u.a,{sequencerEngine:n.sequencerEngine,name:"Frequency",parameter:r.keyboard?r.oscillatorFrequencyParameter:n.carrier.oscillatorFrequencyParameter,onParameterChanged:function(){return n.releaseAll()},displayFunction:function(e){return o.a.fromTranspose(e).toString()},isParameter:!0,min:-32,max:32,step:1}),a.a.createElement(u.a,{name:"Detune",sequencerEngine:n.sequencerEngine,lfoEnabled:!0,parameter:r.detuneParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1})),r.bandpassParameter.get()?a.a.createElement("div",{className:"bandpass-parameters"},a.a.createElement(u.a,{name:"Band Freq",sequencerEngine:n.sequencerEngine,lfoEnabled:!0,parameter:r.bandpassFrequencyParameter,onParameterChanged:function(){return[]},isParameter:!0,min:10,max:5e3,step:1}),a.a.createElement(u.a,{name:"Band Q",sequencerEngine:n.sequencerEngine,lfoEnabled:!0,parameter:r.bandpassQParameter,onParameterChanged:function(){return[]},isParameter:!0,min:.1,max:10,step:.01})):"",a.a.createElement(s.a,{condition:"C"!==r.name},a.a.createElement("div",{className:"keyboard-control"},a.a.createElement(c.a,{flipped:!0,name:"FM",parameter:r.keyboardParameter}),a.a.createElement(c.a,{name:"Osc. Enabled",parameter:r.enabledParameter}),a.a.createElement(c.a,{name:"Bandpass",parameter:r.bandpassParameter}))),a.a.createElement(s.a,{condition:"C"===r.name},a.a.createElement("div",{className:"keyboard-control"},"Keyboard"),a.a.createElement(c.a,{name:"Bandpass",parameter:r.bandpassParameter})))})},function(e,t,n){"use strict";var r=n(28),a=n(8),i=n(11),o=n(0),s=n.n(o),c=n(503),u=n(507),l=n(878),f=n(29),h=n(204),p=n(12),d=n(6),m=new f.a,v=Object(p.b)(function(e,t){var n=e.mix.selectedTrack===t.track.trackNumber,r=t.track,a=r;return r&&r.tracks&&r.tracks[0]&&(a=r.tracks[0].track),{trackId:r.id,id:a.presetName?a.presetName:void 0!==a.sample&&void 0!==a.sample.getId()?a.sample.getId():a.getName(),isSelectedTrack:n,resolution:e.sequencer.displayResolution,muted:e.tracks.trackMutes[t.track.id],trackLength:r.length}},function(e){return{setStepNumberDraggingFrom:function(t){return e(Object(d.Ag)(t))},setSelectedPianoRollSteps:function(t){return e(Object(d.jf)(t))},setStepsSelection:function(t){return e(Object(d.Eg)(t))},mouseDown:function(t){return e(Object(d.n)(t))}}})(function(e){var t=e.track,n=e.id,r=e.isSelectedTrack,a=e.resolution,i=e.mouseDown,c=e.setSelectedPianoRollSteps,f=e.setStepsSelection,p=e.onTrackRendered,d=e.setStepNumberDraggingFrom,v=e.isHiding,b=e.setIsHiding,g=e.sequencerScale,y=e.muted,k=e.trackLength,O=Object(o.useRef)(void 0),j=m.getColorForTrack(t),w=m.brighten(void 0===n?"#353535c7":j,.64),E=t.sequencerEngine;Object(o.useEffect)(function(){setTimeout(function(){p(t,O)},100)},[k]);var S=Object(o.useCallback)(function(){i(!1);var e=E.store.getState().steps.stepsSelection;if(void 0!==e&&e.toStep-e.fromStep>0){var n=t.getEasyPattern().getSelectedSteps(e,a);0===n.length?c(void 0):c(n)}f(void 0),d(void 0)},[t,a]),P=Object(o.useCallback)(function(e){t.sequencerEngine.selectTrack(t.trackNumber)},[t]),x=Object(o.useCallback)(function(){b(v===t?void 0:t)},[v,b]),T=v===t;if(v&&v!==t)return[];var C="track";return v&&(C+=" hiding"),C+=r?" selected":" not-selected",y&&(C+=" muted"),s.a.createElement("div",{ref:O,style:{},onMouseDown:P,onMouseUp:S,className:C},s.a.createElement("div",{className:"track-inner"},s.a.createElement(h.a,{hasBorder:!0,isSelectedTrack:r,onMouseDown:function(e){e.stopPropagation(),P()},track:t,sample:t.sample,onClickThumbnail:x}),T?s.a.createElement(u.a,{color:w,track:t}):s.a.createElement(l.a,{sequencerScale:g,key:1,isSelectedTrack:r,sequencerEngine:t.sequencerEngine,store:t.sequencerEngine.store,trackNumber:t.trackNumber,id:n,trackColor:w,sample:t.sample,track:t,isMini:!0,trackData:t})),s.a.createElement("div",{style:{color:j},className:"delete-track-trash",onClick:function(){return t.sequencerEngine.deleteTrack(t.trackNumber)}},"x"))}),b=n(260),g=n(213);function y(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=Object(p.b)(function(e,t){return{coords:e.windows.windowPositions[t.sequencer.id],isSelected:e.windows.selectedElements[t.sequencer.id],tracks:t.sequencer.tracks,numTracks:t.sequencer.tracks.length,isStarred:e.effects.effectStarred[t.sequencer.id]}},function(e,t){return{setStarred:function(n){return e(Object(d.Yb)(t.sequencer.id,n))},setTrackDragging:function(t){return e(Object(d.Sg)(t))},setSampleDragging:function(t){return e(Object(d.He)(t))},setSampleTagDragging:function(t){return e(Object(d.Le)(t))}}})(function(e){var t=e.sequencer,n=e.scale,u=(e.pad,e.scrollContainer),l=e.elements,f=e.sizeRef,h=e.size,p=e.setSize,d=e.isCurrent,m=e.setTrackDragging,k=e.numTracks,O=e.setOrdering,j=e.isStarred,w=e.setStarred,E=e.coords,S=e.ordering,P=e.setSampleDragging,x=e.setSampleTagDragging,T=e.isSelected,C=Object(o.useRef)(void 0),N=Object(o.useState)({}),R=Object(i.a)(N,2),M=R[0],A=R[1],q=Object(o.useState)(!1),D=Object(i.a)(q,2),I=D[0],_=D[1],F=Object(o.useRef)(void 0),L=Object(o.useRef)(void 0),B=Object(o.useCallback)(function(e,t){var n=Object(a.a)({},M);n[e.id]=t,A(n)},[M,A]),z=l?Object(b.a)({scale:n,ref:C,sizeRef:f,sequencerEngine:t.sequencerEngine,windowPosition:E,containerRef:u,size:h,setSize:p,elements:l,element:t,setOrdering:O,ordering:S}):{},V=z.setWindowScale,H=z.style,U=z.adjust,J=z.windowScale,G=z.onContextMenu,W=z.onMouseDown,K=z.onMouseUp,X=(z.setCoords,z.startResizing);Object(o.useEffect)(function(){E&&(t.x=E.x,t.y=E.y)},[E]),Object(o.useEffect)(function(){l&&setTimeout(function(){if(F.current)if(F.current.clientHeight<F.current.scrollHeight){var e={x:L.current,y:F.current.scrollHeight+30};V(e)}else U(t.x,t.y)},50)},[k,V]),Object(o.useEffect)(function(){J&&(L.current=J.x)},[J]);var Q=Object(o.useCallback)(function(e){e.stopPropagation(),t.sequencerEngine.switchToSubSequence(t.subSequence.id);var n=t.sequencerEngine.state,r=n.tracks.trackDragging,a=n.selector,i=a.sampleDragging,o=a.sampleTagDragging,s=t.subSequence,c=t.sequencerEngine;if((r||i||o)&&s.pads.length,r){var u,l=y(t.subSequence.sequencers);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(f!==t&&f.tracks.includes(r)){f.removeTrack(r);break}}}catch(p){l.e(p)}finally{l.f()}t.addTrack(r)}else if(i)c.addSound(i).then(function(e){return t.addTrack(e)});else if(o){var h=c.state.selector.sampleTagDragging;Array.isArray(h)||(h=[h]),c.searchForSounds(h,void 0,void 0,void 0,!0).then(function(e){return t.addTrack(e)})}m(void 0),P(void 0),x(void 0)},[]),Y=Object(a.a)({},H);J&&0!==J.x&&(I?(Y.minWidth=J.x,Y.minHeight=J.y):(Y.width=J.x,Y.height=J.y)),E&&(Y.left=E.x,Y.top=E.y);var Z=I||!J?1:J.x/420;1!=Z&&(t.scale=Z);var $="pulled-sequencer";return d&&($+=" current"),T&&($+=" selected"),s.a.createElement("div",{style:Y,onDrop:Q,onContextMenu:G,onMouseDown:W,onMouseUp:K,ref:C,className:$},s.a.createElement("div",{className:"pulled-header"},s.a.createElement("div",{className:"header-name"},"Sequencer"),s.a.createElement("div",{onClick:function(){return w(!j)},className:j?"starred star":"star"},s.a.createElement("span",null,"\u2606")),s.a.createElement("div",{onClick:function(){return t.dispose()},className:"delete-button"},"x")),s.a.createElement("div",{style:l&&Z&&!I?{width:Y.width/Z,maxHeight:Y.height/Z,transform:"scale("+.95*Z+")"}:{},ref:F,className:"inner-sequencer"},0===t.tracks.length&&s.a.createElement("div",{className:"drop-here"},"Drop Tracks Here"),t.tracks.map(function(e){var t;return s.a.createElement(v,(t={onTrackRendered:B,sequencerScale:Z,key:e.id,setIsHiding:_,isHiding:I},Object(r.a)(t,"key",e.id),Object(r.a)(t,"scrollContainer",u),Object(r.a)(t,"track",e),t))})),s.a.createElement("div",{onMouseDown:function(e){return X(g.b,e)},className:"top-left-edge"}),s.a.createElement("div",{onMouseDown:function(e){return X(g.a,e)},className:"top-right-edge"}),s.a.createElement("div",{onMouseDown:function(e){return X(g.d,e)},className:"bottom-left-edge"}),s.a.createElement("div",{onMouseDown:function(e){return X(g.c,e)},className:"bottom-right-edge"}),t.tracks.map(function(e,r){return s.a.createElement(c.a,{sequencerScale:Z,isMidi:!0,trackPositions:M,number:r,containerRef:u,sequencerEngine:t.sequencerEngine,scale:n,node:e})}))})},function(e,t,n){"use strict";var r=n(8),a=n(0),i=n.n(a),o=n(540),s=n(371),c=n(372),u=n(636),l=n(11),f=n(508),h=n(836),p=n(539),d=n(253),m=n(29),v=n(385),b=n(155),g=n(543),y=n(633),k=n(12),O=new m.a,j=Object(k.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.onDeleteEffect,n=e.sequencerEngine,r=e.instrumentPart,o=Object(a.useState)(void 0),s=Object(l.a)(o,2),c=s[0],u=s[1],m=Object(a.useState)(void 0),k=Object(l.a)(m,2),j=k[0],w=k[1],E=r.effect,S=r.instrument,P=r.track,x=r.type,T=r.subType,C="",N=i.a.createElement("div",{className:"pulled-header"},S&&x===b.d&&i.a.createElement("div",{className:"lfo-name"},"LFO ",S.number),S&&"MODULE_ENVELOPE"===x&&i.a.createElement("div",{className:"lfo-name"},"Envelope ",S.number),P&&i.a.createElement("div",{style:{backgroundColor:O.getColorForTrack(P)},className:"effect-from"},P.envelopesTrack?P.name:P.trackNumber+1+". "+P.getName()),i.a.createElement("div",{onClick:t,className:"delete-button"},"-")),R=O.getColorForTrack(P);if(x===b.e)C=i.a.createElement(v.a,{isDraggable:!1,setOscillatorDetails:u,oscillatorDetails:c,showWaveform:j,setShowWaveform:w,color:R,sequencerEngine:n,instrument:S});else if("SYNTH_ENVELOPE"===x){var M;"Amp"===T?M=S.ampEnvelope:"A"===T?M=S.oscillatorNodes[1].ampEnvelope:"B1"===T?M=S.oscillatorNodes[2].ampEnvelope:"B2"===T&&(M=S.oscillatorNodes[3].ampEnvelope),console.log("subtype = ",T),C=i.a.createElement(d.a,{instrument:S,width:200,fillColor:R,lineColor:R,sequencerEngine:n,envelope:M,name:T,hasRelease:!0,hasLevel:!1})}else"MODULE_ENVELOPE"===x?C=i.a.createElement(d.a,{name:"Env "+T,envelope:S,width:200,hasRelease:!0,hasLevel:!1,sequencerEngine:n}):x===b.f?C=i.a.createElement(y.a,{effect:E}):x===b.c?C=i.a.createElement(g.a,{isDraggable:!1,effect:E}):x===b.b?C=i.a.createElement(p.a,{isDraggable:!1,effect:E}):x===b.a?C=i.a.createElement(h.a,{isDraggable:!1,color:R,sequencerEngine:n,instrument:S}):x===b.d&&(C=i.a.createElement(f.a,{isDraggable:!1,hideName:!0,lfo:S,sequencerEngine:n}));return i.a.createElement("div",{className:"pulled-instrument"},N,C)}),w=n(260),E=n(71),S=n(261),P=n(205),x=n(374);n(1549),t.a=Object(k.b)(function(e,t){return{coords:e.windows.windowPositions[t.fx.id],isCollapsed:e.effects.effectCollapsed[t.fx.id],numberOfOutputs:t.fx.numberOfOutputs,isSelected:e.windows.selectedElements[t.fx.id]}},function(e){return{}})(function(e){var t=e.fx,n=e.scale,l=e.containerRef,f=e.sequencerEngine,h=e.setSize,p=e.elements,d=e.size,m=e.sizeRef,v=e.setOrdering,b=e.ordering,g=e.rack,y=e.coords,k=e.isSelected,O=e.onDelete,T=e.showDelete,C=e.isCollapsed,N=e.pad,R=e.isStatic,M=Object(a.useRef)(void 0),A=Object(w.a)({scale:n,ref:M,sequencerEngine:f,sizeRef:m,windowPosition:y,containerRef:l,size:d,setSize:h,elements:p,element:t,expand:C,setOrdering:v,ordering:b}),q=A.style,D=A.onContextMenu,I=A.isDragging,_=A.onMouseDown,F=A.onMouseUp,L=(A.setCoords,"pulled-effect");I&&(L+=" dragging"),k&&(L+=" selected");var B=Object(r.a)({},q);y&&(B.left=y.x,B.top=y.y);var z=t.numberOfOutputs||1,V=new Array(z).fill(0).map(function(e,t){return t});return[i.a.createElement("div",{key:1,style:B,onContextMenu:D,onMouseDown:R?function(){return[]}:_,onMouseUp:R?function(){return[]}:F,ref:M,className:L},t.instrument?i.a.createElement(j,{onDeleteEffect:O,showStar:!0,sequencerEngine:f,instrumentPart:t}):t.getEffectType()===E.a?i.a.createElement(S.a,{showDelete:T,isDraggable:!1,sequencerEngine:f,showStar:!0,featured:!0,track:t.track,compact:!0,instrument:!0,onDeleteEffect:O,effect:t,send:void 0}):t.getEffectType()===E.b?i.a.createElement(x.a,{featured:!0,isDraggable:!1,sequencerEngine:f,showStar:!0,onDeleteEffect:O,effect:t,track:t.track,onEffectsChange:function(){return[]}}):i.a.createElement(P.a,{showDelete:T,isDraggable:!1,featured:!0,sequencerEngine:f,track:t.track,showStar:!0,compact:!0,instrument:!0,onDeleteEffect:O,effect:t,send:void 0}),N&&i.a.createElement(o.a,{containerRef:l,fx:t,pad:N}),N&&V.map(function(e){return i.a.createElement(u.a,{nodeRef:M,rack:g,coords:y,outputNumber:e,containerRef:l,fx:t,pad:N})}),i.a.createElement(s.a,{effect:t}),i.a.createElement(c.a,{subSequence:t.track&&t.track.subSequence,containerRef:l,scale:n,effect:t}))]})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a);var o=n(30),s=(n(658),n(47)),c=n(39),u=n.n(c),l=n(34),f=n(76),h=n(12),p=n(419),d=n(6),m=[{value:p.a,label:"Day"},{value:p.d,label:"Tag"}],v=0;t.a=Object(h.b)(function(e,t){return{}},function(e){return{setContextualHelp:function(t,n){return e(Object(d.ub)(t,n))}}})(function(e){var t=e.setContextualHelp,n=e.onChange,c=e.displayOption,h=e.setDisplayOption,d=e.quickAddSearchText,b=e.groupBy,g=e.setGroupBy,y=e.hideFilter,k=e.setFilterFavorites,O=e.filterFavorites,j=e.sourceToSearch,w=e.children,E=Object(a.useRef)(void 0),S=Object(a.useState)(d),P=Object(r.a)(S,2),x=P[0],T=P[1],C=Object(a.useState)(void 0),N=Object(r.a)(C,2),R=N[0],M=N[1];Object(a.useEffect)(function(){return window.addEventListener("keydown",A),function(){return window.removeEventListener("keydown",A)}},[]);var A=Object(a.useCallback)(function(e){"/"===e.key&&(e.ctrlKey||e.metaKey)||"ArrowDown"!==e.key&&"ArrowUp"!==e.key||(e.preventDefault(),E.current.blur())},[]);Object(a.useEffect)(function(){E.current.focus()},[]),Object(a.useEffect)(function(){if(j){var e=j.videoId,t=j.releaseId;t?o.a.getCoverArtForDiscogs(t).then(function(e){var t=e.coverArtHash;return M(s.a.getHashUrl(t))}):M(function(e){return""===e||void 0===e?"":"https://img.youtube.com/vi/"+e+"/1.jpg"}(e))}else M(void 0)},[j,M]);var q=Object(a.useCallback)(function(e){var t=++v,r=e.target.value;T(r),setTimeout(function(){t===v&&n(r)},600)},[T,n]);return Object(a.useEffect)(function(){d&&T(d)},[d,T]),i.a.createElement(f.a,{element:l.Db,className:"entire-search-container"},w,i.a.createElement("div",{className:"search-rest"},i.a.createElement("div",{className:"search-container"},i.a.createElement("input",{ref:E,placeholder:"Type to search",autoComplete:"off",type:"text",value:x,onKeyDown:A,onChange:q,id:"sample-search-input"}),R?i.a.createElement("img",{src:R,className:"source-to-search"}):"",i.a.createElement("div",{onClick:function(){return q({target:{value:""}})},className:"search-clear-button"},"x"),void 0!==h?i.a.createElement("img",{onMouseOver:function(e){e.stopPropagation(),t(l.zb)},onMouseLeave:function(){return t(void 0)},onClick:function(){return h(p.b)},className:c===p.b?"selected":"",src:"/grid-icon.png"}):"",void 0!==h?i.a.createElement("img",{onMouseOver:function(e){e.stopPropagation(),t(l.Ab)},onMouseLeave:function(){return t(void 0)},onClick:function(){return h(p.c)},className:c===p.c?"selected":""!==x||O?"":"disabled",src:"/list-icon.png"}):""),y?"":i.a.createElement("div",{className:"filter-options"},i.a.createElement("div",{className:O?"favorited heart":"heart",onClick:function(){return k(!O)}}),i.a.createElement(u.a,{onChange:function(e){return g(e.value)},value:m.find(function(e){return e.value===b}),options:m}))))})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"mixHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"sequenceHash",type:"bytes32"}],name:"MixUsedSequence",type:"event"},{inputs:[{internalType:"bytes32",name:"mixHash",type:"bytes32"},{internalType:"bytes32",name:"previousHash",type:"bytes32"},{internalType:"string",name:"title",type:"string"},{internalType:"bytes32[]",name:"sequencesUsed",type:"bytes32[]"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"newMix",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"mixHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousHash",type:"bytes32"},{indexed:!1,internalType:"string",name:"title",type:"string"},{indexed:!1,internalType:"uint32",name:"guildId",type:"uint32"}],name:"NewMix",type:"event"}],this.contractAddress="0xCAD33f311E1223095FC94E89453888Df04f7BbBF"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{inputs:[{internalType:"bytes32[]",name:"newContents",type:"bytes32[]"},{internalType:"bytes32[]",name:"previousContents",type:"bytes32[]"},{internalType:"bytes32[]",name:"titles",type:"bytes32[]"},{internalType:"uint32[]",name:"guildIds",type:"uint32[]"}],name:"bulkEdit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"contentHash",type:"bytes32"}],name:"deleteList",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"newContent",type:"bytes32"},{internalType:"bytes32",name:"previousContent",type:"bytes32"},{internalType:"bytes32",name:"title",type:"bytes32"},{internalType:"uint32",name:"guildId",type:"uint32"}],name:"editList",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"contentHash",type:"bytes32"}],name:"favoriteList",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"contentHash",type:"bytes32"}],name:"highlightList",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"guildsAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!0,internalType:"address",name:"user",type:"address"}],name:"ListDeleted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"newContent",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousContent",type:"bytes32"},{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"bytes32",name:"title",type:"bytes32"},{indexed:!1,internalType:"uint32",name:"guildId",type:"uint32"}],name:"ListEdited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!1,internalType:"address",name:"user",type:"address"}],name:"ListFavorited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!1,internalType:"address",name:"user",type:"address"}],name:"ListHighlighted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!1,internalType:"address",name:"user",type:"address"}],name:"ListUnfavorited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"contentHash",type:"bytes32"},{indexed:!1,internalType:"address",name:"user",type:"address"}],name:"ListUnhighlighted",type:"event"},{inputs:[{internalType:"bytes32",name:"contentHash",type:"bytes32"}],name:"unfavoritedList",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"contentHash",type:"bytes32"}],name:"unhighlightList",outputs:[],stateMutability:"nonpayable",type:"function"}],this.contractAddress="0xCD76d04Ab1CeCb1F72dDc7b8dd798dD162db7684"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},,,,,,function(e,t,n){"use strict";var r=n(2);t.a=function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"sampleIpfs",type:"bytes32"},{name:"notes",type:"bytes32[32]"},{name:"startTime",type:"uint32"},{name:"endTime",type:"uint32"},{name:"noteSequenceIpfs",type:"bytes32"}],name:"newNoteSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"sampleIpfs",type:"bytes32"},{name:"notes",type:"bytes32[256]"},{name:"startTimes",type:"uint32[8]"},{name:"endTimes",type:"uint32[8]"},{name:"noteSequenceIpfs",type:"bytes32"}],name:"newNoteSequenceLarge",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"sampleHash",type:"bytes32"},{indexed:!0,name:"noteSequenceIpfs",type:"bytes32"}],name:"NewNoteSequence",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"sampleHash",type:"bytes32"},{indexed:!0,name:"noteA",type:"bytes32"},{indexed:!0,name:"noteB",type:"bytes32"},{indexed:!1,name:"startTime",type:"uint32"},{indexed:!1,name:"endTime",type:"uint32"},{indexed:!1,name:"remainingNotes",type:"bytes32"}],name:"NewNotesAggregation",type:"event"}],this.contractAddress="0x3edab21966363a5c9d69ba0ed78abc5b9c6007c5"}},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r=1,a=2},,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(69),a=(n(55),new Set(["clap","tom","toms","clave","perc","snare","kick","hi-hat","rim","side-stick","breaks","sub","ride","piano","violin"])),i=function(e){var t=e.sample,n=e.presetName||e.getName();if(t&&t.tags&&((n=t.tags.find(function(e){return a.has(e)}))||(n=t.tags[0])),e&&e.getInstrumentType()==r.f&&(n="Synth"),e&&e.getInstrumentType()===r.g){var i=e.instrument.getSamples();i[0]&&i[0].tags&&(n=i[0].tags.find(function(e){return a.has(e)}))}return n}},,,,,,,,function(e,t){var n,r,a=0,i=[];function o(){for(var e=0;e<r;e++)i[e]=[]}function s(e,t){for(var n=new Float32Array(t),r=0,a=0;a<e.length;a++)n.set(e[a],r),r+=e[a].length;return n}function c(e,t,n){for(var r=0;r<n.length;r++)e.setUint8(t+r,n.charCodeAt(r))}this.onmessage=function(e){switch(e.data.command){case"init":t=e.data.config,n=t.sampleRate,r=t.numChannels,o();break;case"record":!function(e){for(var t=0;t<r;t++)i[t].push(e[t]);a+=e[0].length}(e.data.buffer);break;case"exportWAV":!function(e){for(var t=[],o=0;o<r;o++)t.push(s(i[o],a));if(2===r)var u=function(e,t){var n=e.length+t.length,r=new Float32Array(n),a=0,i=0;for(;a<n;)r[a++]=e[i],r[a++]=t[i],i++;return r}(t[0],t[1]);else var u=t[0];var l=function(e){var t=new ArrayBuffer(44+2*e.length),a=new DataView(t);return c(a,0,"RIFF"),a.setUint32(4,36+2*e.length,!0),c(a,8,"WAVE"),c(a,12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,r,!0),a.setUint32(24,n,!0),a.setUint32(28,4*n,!0),a.setUint16(32,2*r,!0),a.setUint16(34,16,!0),c(a,36,"data"),a.setUint32(40,2*e.length,!0),function(e,t,n){for(var r=0;r<n.length;r++,t+=2){var a=Math.max(-1,Math.min(1,n[r]));e.setInt16(t,a<0?32768*a:32767*a,!0)}}(a,44,e),a}(u),f=new Blob([l],{type:e});this.postMessage(f)}(e.data.type);break;case"getBuffer":!function(){for(var e=[],t=0;t<r;t++)e.push(s(i[t],a));this.postMessage(e)}();break;case"clear":a=0,i=[],o()}var t}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return new Promise(function(t){var n={searchTerm:e,guildId:0};fetch("/tagSearch/",{method:"POST",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){t(e)})})}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(9),a=function(e,t,n){if(0===e.length)return e;for(var a=0,o=e.length-1,s=[],c=-1;a<=o;){0;var u=e[c=Math.floor((a+o)/2)];if(i(u))break;if(u.step<t)a=c+1;else{if(!(u.step>t))break;o=c-1}}for(var l=0,f=c;f<e.length;f++){0;var h=e[f];if(i(h,t,n))s.push(h);else if(++l>2)break}l=0;for(var p=c-1;p>=0;p--){0;var d=e[p];if(i(d,t,n))s=[d].concat(Object(r.a)(s));else if(++l>2)break}return s},i=function(e,t,n){return e.step>=t&&e.step<=n||e.step<=t&&e.step+e.duration>=n}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(6),o=n(12),s=n(38);t.a=Object(o.b)(function(e,t){var n=0;return t.track&&(n=t.track.chainNumber),{chainNumber:n}},function(e,t){return{setEffectsChainToShow:function(t,n,r){return e(Object(i.Zb)(t,n,r))}}})(function(e){if(void 0===e.track)return a.a.createElement("div",null);var t=e.track.effectsChains;return a.a.createElement("div",{className:"effects-chain-chooser"},t.map(function(t,n){return a.a.createElement("div",{onClick:function(){return function(t){e.setEffectsChainToShow(e.track.subSequence.id,e.track.trackNumber,t)}(n)},className:e.chainNumber===n?"effects-chain-btn selected":"effects-chain-btn"},n+1)}),a.a.createElement("div",{className:"new-effects-chain-btn",onClick:function(){e.track.newEffectsChain()}},"+"),a.a.createElement(s.a,{condition:e.track&&e.track.effectsChains.length>1},a.a.createElement("div",{className:"new-effects-chain-btn",onClick:function(){e.track.deleteEffectsChain()}},"-")))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(39),f=n.n(l);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}c.Component;var p=function(e){Object(i.a)(n,e);var t=h(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={option:void 0},a}return Object(a.a)(n,[{key:"options",get:function(){return this.props.parameters.map(function(e){return{value:e,label:e.name}})}},{key:"onChooseParameter",value:function(e){this.setState({option:e})}},{key:"render",value:function(){var e=this;return u.a.createElement(f.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.options,onChange:function(t){return e.onChooseParameter(t)},value:this.state.option,placeholder:"Parameter"})}}]),n}(c.Component)},function(e,t,n){"use strict"},function(e,t,n){},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(1079),s=n(12);t.a=Object(s.b)(function(e,t){var n=t.pad.sequencerEngine.tracks[e.mix.selectedTrack];return{selectedTrack:e.mix.selectedTrack,loaded:n&&n.getSampler(0),tracks:t.pad.tracks}},function(e){return{}})(function(e){var t=e.div,n=e._track,s=e.pad,c=e.selectedTrack,u=n||s.slotTracks.find(function(e){return e.trackNumber===c}),l=Object(a.useState)(s.width||300),f=Object(r.a)(l,2),h=f[0],p=f[1],d=Object(a.useState)(void 0),m=Object(r.a)(d,2),v=m[0],b=m[1];Object(a.useEffect)(function(){return window.addEventListener("mousemove",y),window.addEventListener("mouseup",g),function(){window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",g)}},[v,p,g]);var g=Object(a.useCallback)(function(e){b(!1)},[b]),y=Object(a.useCallback)(function(e){if(v){var n=t.current.getBoundingClientRect(),r=e.clientX-n.left;r<180||(s.width=r,p(r))}},[v,p]);return u?i.a.createElement("div",{className:"pad-waveform"},i.a.createElement(o.a.DetailsView,{width:h,div:t,small:!0,showParameters:!1,hideKeyboard:!0,alreadyLoaded:!0,onGoBack:function(){return[]},keyboardEngine:s.sequencerEngine.keyboardEngine,midiEngine:s.sequencerEngine.midi,trackNumber:s.sequencerEngine.cursor.track,resolution:s.sequencerEngine.resolution,height:120,sequencerEngine:s.sequencerEngine,bpm:s.sequencerEngine.bpm,track:u}),i.a.createElement("div",{onMouseDown:function(e){e.stopPropagation(),b(!0)},className:"waveform-resizer"})):[]})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=n(15),s=n.n(o);n(164);t.a=Object(i.b)(function(e,t){t.sequencerEngine,t.id,t.renderLength;return{currentTime:e.freeze.offlineEngine&&e.freeze.offlineEngine.context&&Math.floor(e.freeze.offlineEngine.context._context.currentTime),currentExportInfo:e.freeze.currentExportInfo}},null)(function(e){var t=e.currentTime,n=void 0===t?0:t,r=e.renderLength,i=e.width,o=void 0===i?380:i,c=e.currentExportInfo,u=n/(r*(new s.a.Time("1n").toMilliseconds()/1e3)),l={width:o*u},f=c;return a.a.createElement("div",{className:"progress-bar"},a.a.createElement("div",{className:"inner-progress-bar"},a.a.createElement("div",{className:"progress",style:l}),a.a.createElement("div",{className:"loading-text"},f?"Exporting "+f.name+" "+(f.index+1)+"/"+f.total+" ":"Exporting Project ","(",Math.round(100*u),"%)...")))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}c.Component},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(38);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}c.Component},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}c.Component},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(39),f=n.n(l),h=n(226),p=(n(1099),n(12)),d=n(6),m=n(34);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var b=function(e){Object(i.a)(n,e);var t=v(n);function n(e){return Object(r.a)(this,n),t.call(this,e)}return Object(a.a)(n,[{key:"getOptions",value:function(){var e=this.props.midiEngine,t=[{label:"All",value:{type:h.a}},{label:"Computer Keyboard",value:{type:h.b}}],n=e.getInputs().map(function(e){return{label:e.name,value:{type:h.c,input:e}}});return t.concat(n)}},{key:"getSelectedOption",value:function(){var e=this.props.midiInputs;return this.getOptions().filter(function(t){return t.value.type===e.type&&(e.type!==h.c||e.accepts(!1,t.value.input.name))})[0]}},{key:"onSelect",value:function(e){e.value.type===h.c?this.props.midiInputs.addMidiInput(e.value.input):this.props.midiInputs.setType(e.value.type)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{onMouseOver:function(t){return e.setContextualHelp(t,m.Kb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"midi-input-dropdown-container"},u.a.createElement(f.a,{className:"midi-input-dropdown",controlClassName:"midi-input-control-dropdown",arrowClassName:"audio-input-arrow-dropdown",options:this.getOptions(),onChange:function(t){return e.onSelect(t)},value:this.getSelectedOption(),placeholder:"Input"}))}}]),n}(c.Component);Object(p.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(d.ub)(t))}}})(b)},function(e,t,n){},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){if(e.context.effect)return e.context.effect.name+" - "+e.prettyName;if(e.context.midiEffect)return e.context.midiEffect.name+" - "+e.prettyName;if(e.context.macro)return e.context.macro.name;if(e.context.subDevice&&e.context.instrument){var t=e.context.instrument,n=t.getSubDeviceIndex(e.context.subDevice),r=t.getSubDevices();if(r[n])return r[n].label+" - "+e.prettyName}return e.prettyName}},function(e,t,n){"use strict";var r=n(8),a=n(2),i=n(4),o=n(7),s=n(10),c=n(1),u=n(0),l=n.n(u),f=n(12);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var p=function(e){Object(o.a)(n,e);var t=h(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={oscToVoices:{}},r}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.instrument;this.timeout=setInterval(function(){var n=Object(r.a)({},e.state.oscToVoices);for(var a in t.oscillators){var i=t.oscillators[a].voices.filter(function(e){return"started"===e.oscillator.state}).length;n[a]=i}e.setState({oscToVoices:n})},20)}},{key:"componentWillUnount",value:function(){clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this,t=this.props.instrument.oscillatorNodes;return l.a.createElement("div",{className:"oscs-info"},t.map(function(t,n){return l.a.createElement("div",{className:"osc"},t.name," - ",e.state.oscToVoices[n])}))}}]),n}(u.Component);Object(f.b)(function(e,t){return{}},function(e){return{}})(p)},function(e,t,n){},,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){"use strict";n(5),n(14),n(11),n(0),n(92)},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=new(n(29).a);t.a=Object(i.b)(function(e,t){return{value:e.effects.effectParameters[t.parameter.id]}},function(e){return{}})(function(e){var t=e.parameter,n=t.max-t.min,r=(t.get(!0)-t.min)/n,i={backgroundColor:o.getColorForHash(t.name),height:20*r};return a.a.createElement("div",{style:i,className:"parameter-visual"})})},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0),a=n(55),i=n(106),o=function(e){var t=e.isSelectedTrack,n=e.track,o=e.sequencerEngine,s=e.setArrangementBottomMode,c=e.setShowPianoRoll,u=e.mode;return{toggleWaveform:Object(r.useCallback)(function(){var e=o.state,r=n.getTrackType()===a.f||n.getTrackType()===a.e;if(e.sequencer.showPianoRoll){if(e.arrangement.bottomMode===i.d)return void s(u||(r?i.e:i.b));t&&s(u||i.d)}else s(u||(r?i.e:i.d));t&&c(!o.state.sequencer.showPianoRoll)},[t,n])}}},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(5),a=n.n(r),i=n(14),o=n(11),s=n(0),c=n(92),u=function(e){var t=e.scrollContainer,n=e.trackRef,r=e.isSelected,u=(e.track,e.tracksToHide),l=e.offset,f=void 0===l?200:l,h=e.useClientBounds,p=void 0!==h&&h,d=Object(s.useState)(void 0),m=Object(o.a)(d,2),v=m[0],b=m[1],g=Object(s.useRef)(0),y=function(e,t){return p?e.offsetTop-t.offsetTop:e.offsetTop};Object(s.useEffect)(function(){if(n.current&&t.current&&r&&!k()){var e=y(n.current,t.current);t.current.scrollTo(0,e-f)}},[r,u]),Object(s.useEffect)(function(){t.current},[v,b]);var k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;if(!n.current||!t.current)return!0;var r=t.current.scrollTop,a=r+t.current.offsetHeight,i=y(n.current,t.current);return!(n.current.offsetHeight+i<r+40+e||i+e>a)};Object(s.useCallback)(Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(k(-40)){e.next=9;break}return t=++g.current,e.next=4,Object(c.a)(2e3);case 4:if(g.current===t){e.next=6;break}return e.abrupt("return");case 6:k()||v||b({trackHeight:n.current.offsetHeight}),e.next=10;break;case 9:v&&b(void 0);case 10:case"end":return e.stop()}},e)})),[v,b]);return{hideInfo:v}}},function(e,t,n){},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(732),a=n(46),i=n(0),o=n.n(i);function s(e){var t=e.track,n=e.sequencerEngine;return o.a.createElement(r.a,{track:t,rackTrack:{trackNumber:0},width:54,min:-60,onVolumeChange:function(e){return n.operationManager.dispatch(Object(a.y)(t,e))}})}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=n(173),s=n(244),c=n(139);t.a=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setDropdownPos,n=e.dropdownPos,i=e.track,u=Object(r.useCallback)(function(){i.sequencerEngine.duplicateTrack(i.trackNumber),t(void 0)},[i,t]),l=Object(r.useCallback)(function(){for(var e=0;e<i.patterns.length;e++)if(e!==i.currentPattern){var n=i.pattern.getCopy();i.patterns[e]=n,i.pattern.syncBuckets()}t(void 0)},[i,t]),f=Object(r.useCallback)(function(){Object(o.j)(i),t(void 0)},[i,t]);return a.a.createElement(s.a,{dropdownPos:n,setDropdownPos:t},a.a.createElement(c.a,{onMouseDown:u},"Duplicate ",a.a.createElement("div",{className:"key-shortcut"},"\u2318D")),a.a.createElement(c.a,{onMouseDown:f},"Save Preset"),a.a.createElement(c.a,{onMouseDown:l},"Copy Steps to All Patterns"))})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=n(29);n(2563);function s(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=new o.a,l=Object(r.memo)(function(e){e.note;var t=e.isPlayed,n=e.tracks,r=e.size,i=[],o=a.a.createElement("line",{x1:0,y1:0,x2:r,y2:0,className:t?"played mark":"mark"});if(n)for(var s=1*r/n.length,c=0;c<n.length;c++){var l=n[c];i.push(a.a.createElement("circle",{cx:c*s,cy:-20,r:3,stroke:u.getColorForTrack(l)}))}return a.a.createElement("g",null,o," ",i)}),f=function(e,t){return(e%t+t)%t};t.a=Object(i.b)(function(e,t){return{trackStep:t.sequencerEngine.trackStep}},function(e){return{}})(function(e){var t,n=e.sequencerEngine,r=e.trackStep,i=void 0===r?0:r,o=e.size,c=void 0===o?100:o,u=new Set,h={},p=s(n.subSequences);try{for(p.s();!(t=p.n()).done;){var d,m=s(t.value.tracks);try{for(m.s();!(d=m.n()).done;){var v=d.value,b=v.notesTriggered||{};for(var g in b)g=f(g,12),u.add(g),h[g]||(h[g]=[]),h[g].push(v)}}catch(k){m.e(k)}finally{m.f()}}}catch(k){p.e(k)}finally{p.f()}var y=(i%=32)/32*(2*c*Math.PI);return a.a.createElement("div",{className:"pitch-clock"},a.a.createElement("svg",null,a.a.createElement("circle",{strokeDasharray:[y,999],cx:c,cy:c,r:c,stroke:"white"}),a.a.createElement("g",{className:"marks"},[0,1,2,3,4,5,6,7,8,9,10,11].map(function(e){return a.a.createElement(l,{size:c,tracks:h[e],key:e,note:e,isPlayed:u.has(e)})}))))})},function(e,t,n){},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12);t.a=Object(i.b)(function(e,t){return{tooltip:e.zobject.tooltip[t.subSequence.id]}},function(e){return{}})(function(e){var t=e.tooltip;e.subSequence;return t?a.a.createElement("div",{style:{left:t.position.x,top:t.position.y},className:"zobject-tooltip"},a.a.createElement("div",{className:"dot"}),t.text):""})},function(e,t,n){"use strict";var r=n(9),a=n(0),i=n.n(a),o=n(97),s=n(995),c=n(996),u=n(6),l=n(173),f=n(426),h=n(244),p=n(139),d=n(12);n(2570);t.a=Object(d.b)(function(e,t){var n=e.zobject.contextMenu[t.subSequence.id];return{isLocked:n&&e.spatial.lockedObjects[n.zobject.id],contextMenu:n}},function(e,t){return{clear:function(t){return e(Object(u.Th)(t))},setViewableSubPatches:function(t){return e(Object(u.Eh)(t))},setSelectedPulledElements:function(t){return e(Object(u.mf)(t))},setSelectedZObject:function(t){return e(Object(u.uf)(t))},setFullScreenZObject:function(t){return e(Object(u.rc)(t))},setZObjectInputText:function(t){return e(Object(u.Vh)(t))},setLocked:function(t,n){return e(Object(u.vh)(t,n))},setPluginToSave:function(t){return e(Object(u.me)(t))},setZObjectBackground:function(t){return e(Object(u.Sh)(t))},setZObjectsStack:function(t){return e(Object(u.ci)(t))}}})(function(e){e.setZObjectsStack,e.setZObjectBackground;var t=e.setPluginToSave,n=(e.setUXLockObject,e.setZObjectInputText,e.setFullScreenZObject),d=(e.setSelectedPulledElements,e.setSelectedZObject),m=e.contextMenu,v=e.setLocked,b=e.isLocked,g=e.setViewableSubPatches,y=e.clear;if(!m)return"";var k=m.zobject,O=m.position;Object(a.useEffect)(function(){m&&d(m.zobject)},[m]);var j=Object(s.a)({zobject:k,setDropdownPos:y}).mintToHic,w=Object(c.a)({zobject:k,setDropdownPos:y}).mintToZora,E=Object(a.useCallback)(function(){k.duplicate(),y()},[]),S=Object(a.useCallback)(function(){v(!b)},[b]),P=Object(a.useCallback)(function(){var e=k;k.pluginViewerFor&&(e=k.pluginViewerFor);var t=e.sequencerEngine.state.zobject.viewableSubPatches;if(e.subSequence&&e.subSequence.zObject){e.effect.width=e.subSequence.width,e.effect.height=e.subSequence.height;var n=k.sequencerEngine.state.windows.windowPositions[k.subSequence.id];k.sequencerEngine.dispatch(Object(u.Kh)(e.effect.id,n))}g([].concat(Object(r.a)(t),[e.effect]))},[k]),x=Object(a.useCallback)(function(){var e=!0===k.attributes["Include in Presentation"];k.setAttribute("Include in Presentation",!e)},[k]),T=Object(a.useCallback)(function(){n(k),d(void 0),y()},[k]),C=Object(a.useCallback)(function(){k.delete()},[k]),N=Object(a.useCallback)(function(){t(k)},[k]),R=Object(a.useCallback)(function(){t(k.pluginViewerFor||k.plugin)},[k]),M=Object(a.useCallback)(function(){d(k),Object(l.j)(k)},[k]);return i.a.createElement(h.a,{className:"zobject-context-menu",dropdownPos:O,setDropdownPos:y},i.a.createElement(p.a,{onMouseDown:T},"Fullscreen",i.a.createElement("div",{className:"key-shortcut"},i.a.createElement("img",{src:"/expand-icon.svg"}))),i.a.createElement(p.a,{onMouseDown:x},k.attributes["Include in Presentation"]?"Remove from Presentation":"Include in Presentation"," ",i.a.createElement("div",{className:"key-shortcut"},i.a.createElement("img",{src:"/presentation-mode.svg"}))),("subpatch"===k.name||k.pluginViewerFor)&&i.a.createElement(p.a,{onMouseDown:P},"Open Subpatch Editor"),i.a.createElement(p.a,{onMouseDown:E},"Duplicate ",i.a.createElement("div",{className:"key-shortcut"},"\u2318D")),i.a.createElement(p.a,{onMouseDown:S},b?"Unlock":"Lock"),i.a.createElement("div",{className:"divider"}),i.a.createElement(p.a,{onMouseDown:M},"Save as Preset"),k.getObjectType()===o.e&&(k.plugin||k.pluginViewerFor?i.a.createElement(p.a,{onMouseDown:R},"Update Plugin"):i.a.createElement(p.a,{onMouseDown:N},"Create Plugin")),k.getObjectType()===o.e&&i.a.createElement(f.a,{name:"Mint On..."},i.a.createElement(p.a,{onMouseDown:w},"Zora"),i.a.createElement(p.a,{onMouseDown:j},"Hicetnunc/Objkt")),i.a.createElement(p.a,{onMouseDown:C},"Delete"),i.a.createElement("div",{className:"divider"}),k.actions&&Object.keys(k.actions).map(function(e){return i.a.createElement(p.a,{onMouseDown:function(){k.executeAction(e),y()}},e)}))})},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(9),a=n(8),i=n(0),o=n(93),s=n(206),c=n(208),u=n(6),l=function(e){var t=e.scrollRef,n=e.sequencerEngine,l=e.context,f=Object(c.a)({containerRef:t}).getXY,h=Object(i.useRef)(),p=Object(i.useCallback)(function(e){var t=f(e),r=t.x,a=t.y,i=n.state.spatial.editorPadding;return{x:r-=Math.max(0,i.x),y:a-=Math.max(0,i.y)}},[n]);Object(i.useEffect)(function(){return window.addEventListener("keydown",m),window.addEventListener("keyup",d),function(){window.removeEventListener("keydown",m),window.removeEventListener("keyup",d)}},[n,l,m,d]);var d=Object(i.useCallback)(function(e){if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName)e.key,n.state.zobject.fullScreenZObject},[n,l]),m=Object(i.useCallback)(function(e){if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName){n.state.zobject.fullScreenZObject;var t=e.key;if("Tab"!==t||e.shiftKey)if("e"===t&&(e.ctrlKey||e.metaKey)){if(v()!==l)return;n.dispatch(Object(u.If)(n.state.spatial.showEditorBottom===s.a?void 0:s.a))}else{if(n.state.spatial.showPadSequencer)return;if("N"===t){if(v()!==l)return;var i=p(h.current),c=i.x,f=i.y;v().createZObject(c,f)}else if("C"===t){if(v()!==l)return;var d=p(h.current),m=d.x,b=d.y;v().createZObject(m,b,"comment")}else if("O"===t){if(v()!==l)return;var g=p(h.current),y=g.x,k=g.y;v().createZMessage(y,k,o.a)}else if("M"===t){if(v()!==l)return;var O=p(h.current),j=O.x,w=O.y;v().createZMessage(j,w)}else if("H"===t){var E=n.state.windows.selectedElements,S=n.state.spatial.presentationMode,P=n.state.windows,x=P.windowPositions,T=P.presentationWindowPositions,C={};for(var N in E){var R=S&&T[N]||x[N];C[N]=Object(a.a)({},R)}var M=Math.min.apply(Math,Object(r.a)(Object.values(C).map(function(e){return e.y})));for(var A in E)C[A].y=M;S?n.dispatch(Object(u.fb)(C)):n.dispatch(Object(u.gb)(C))}else if("V"===t){var q=n.state.windows.selectedElements,D=n.state.spatial.presentationMode,I=n.state.windows,_=I.windowPositions,F=I.presentationWindowPositions,L={};for(var B in q){var z=D&&F[B]||_[B];L[B]=Object(a.a)({},z)}var V=Math.min.apply(Math,Object(r.a)(Object.values(L).map(function(e){return e.x})));for(var H in q)L[H].x=V;D?n.dispatch(Object(u.fb)(L)):n.dispatch(Object(u.gb)(L))}else if("F"===t){if(v()!==l)return;var U=p(h.current),J=U.x,G=U.y;v().createZMessage(J,G,o.c).max=1}else if("I"===t){if(v()!==l)return;var W=p(h.current),K=W.x,X=W.y;v().createZMessage(K,X,o.c).round=!0}else"Escape"===e.key&&(e.preventDefault(),n.dispatch(Object(u.Eh)([])),n.dispatch(Object(u.Fh)([])))}else{if(v()!==l)return;if(n.state.instruments.showFormantEffect)return;if(n.dispatch(Object(u.ye)("")),n.state.spatial.showTrackInstrument||n.state.sequencer.showLFOs||n.state.sequencer.showEnvelopes)return n.dispatch(Object(u.Pf)(!1)),n.dispatch(Object(u.Jf)(!1)),void n.dispatch(Object(u.kg)(!1));n.getSelectedTrack()&&n.selectTrack(n.getSelectedTrack().trackNumber),n.dispatch(Object(u.kg)(!n.state.spatial.showTrackInstrument))}}},[n,l]),v=Object(i.useCallback)(function(){var e=n.state.zobject.viewableSubPatches;return e[e.length-1]||n.currentSubSequence},[n]);return{onMouseMove:function(e){h.current?(h.current.clientX=e.clientX,h.current.clientY=e.clientY):h.current={clientX:e.clientX,clientY:e.clientY}}}}},function(e,t,n){"use strict";n(1077);var r=n(0),a=n.n(r),i=n(12);t.a=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){e.metadata;var t=e.contentURI;return console.log("content URI=",t),a.a.createElement("iframe",{sandbox:"allow-scripts allow-same-origin",height:"519",width:"100%","aria-describedby":"undefineddescription",alt:"testing",src:t,className:"zora-mediaObject css-hnzuw7 zora-mediaObject--mediaLoaded zora-mediaObject--isFullPage",style:{border:0}})})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(94),s=(n(15),n(39)),c=n.n(s),u=n(12),l=n(345),f=[l.c,l.b,l.d,l.e,l.a].map(function(e){return{label:e,value:e}}),h=function(e){return{label:e,value:e}};t.a=Object(u.b)(function(e,t){return{sampleRate:t.sequencerEngine.context.sampleRate}},function(e){return{}})(function(e){var t=Object(a.useState)(e.sampleRate),n=Object(r.a)(t,2),s=n[0],u=n[1],l=Object(a.useState)(!1),p=Object(r.a)(l,2),d=p[0],m=p[1],v=Object(a.useCallback)(function(t){t=t.value,o.a.setItem("sampleRate",t),u(t),e.sequencerEngine.save("Test","PUBLIC",!1),m(!0)},[u,d]);return i.a.createElement("div",{className:"sample-rate-chooser"},i.a.createElement("div",{className:"dropdown-title"},"SampleRate:"),i.a.createElement(c.a,{className:"audio-input-chooser-dropdown",controlClassName:"audio-input-chooser-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:f,onChange:v,value:h(s),placeholder:"Audio Input"}),d?i.a.createElement("div",{className:"needs-reload"},"Reload page to use new sample rate"):"")})},function(e,t,n){"use strict";var r=n(11),a=n(5),i=n.n(a),o=n(14),s=n(0),c=n.n(s),u=(n(39),n(52)),l=n(38),f=n(12),h=n(168),p=n(176),d=n(30),m=n(92),v=function(){var e=Object(o.a)(i.a.mark(function e(t,n,r){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("getClockASks for userId=",n),fetch("/getClockAsks/"+n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(){var e=Object(o.a)(i.a.mark(function e(a){var o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.json();case 2:if(0===(o=e.sent)||"0"===o){e.next=7;break}t(o),e.next=12;break;case 7:if(!r.current){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,Object(m.a)(1e3);case 11:v(t,n,r);case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}();h.a,h.c;t.a=Object(f.b)(function(e){return{clockType:e.sequencer.clockType,availableUsers:e.sequencer.clockType===h.a?[]:e.clock.availableUsers,connectedUserName:e.clock.connectedUserName,connectionStatus:e.clock.connectionStatus}},function(e){return{}})(function(e){var t=Object(s.useState)(void 0),n=Object(r.a)(t,2),a=n[0],f=n[1],m=Object(s.useState)(void 0),b=Object(r.a)(m,2),g=b[0],y=b[1],k=Object(s.useRef)(!1);Object(s.useEffect)(function(){a&&d.a.users.getUserName(a).then(y)},[a,y]),Object(s.useEffect)(function(){return u.a.getAccount().then(function(e){return v(f,e,k)}),function(){return k.current=!0}},[]),Object(s.useEffect)(function(){e.sequencerEngine.clockSync.startListening()},[]);var O=Object(s.useCallback)(function(){var t=Object(o.a)(i.a.mark(function t(n){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.connectionStatus!==p.c){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,d.a.users.getUserId(n);case 4:r=t.sent,e.sequencerEngine.clockSync.askToConnect(r);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),[e.connectionStatus]),j=Object(s.useCallback)(function(){a&&(e.sequencerEngine.clockSync.setClockType(h.c),e.sequencerEngine.clockSync.syncToUser(a))},[a]),w=Object(s.useCallback)(function(t){return t===e.connectedUserName?"available-user selected":"available-user"},[e.connectedUserName,a]);return e.connectionStatus===p.c?c.a.createElement("div",{className:"clock-type-container"},c.a.createElement("div",{className:"sub-header"},"Clock Syncing"),"Connected with ",c.a.createElement("span",{className:"clock-user"},e.connectedUserName)):e.connectionStatus===p.d?c.a.createElement("div",{className:"clock-type-container"},c.a.createElement("div",{className:"sub-header"},"Clock Syncing"),"Waiting to connect..."):g?c.a.createElement("div",{className:"clock-type-container"},c.a.createElement("div",{className:"sub-header"},"Clock Syncing"),c.a.createElement("div",{className:"ask-text"},c.a.createElement("span",{className:"clock-user"},g)," wants to sync clocks with you."),c.a.createElement("div",{className:"ask-buttons"},c.a.createElement("div",{onClick:j,className:"ok-btn"},"Connect"),c.a.createElement("div",{className:"cancel-btn"},"Cancel"))):c.a.createElement("div",{className:"clock-type-container"},c.a.createElement("div",{className:"sub-header"},"Clock Syncing"),c.a.createElement("div",{className:"available-users"},"People available to connect:",e.availableUsers.map(function(t){return c.a.createElement("div",{onClick:function(){return O(t)},className:w(t)},t,c.a.createElement(l.a,{condition:e.connectionStatus===p.c},c.a.createElement("div",{className:"user-status"},"CONNECTED")))})))})},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(5),a=n.n(r),i=n(14),o=n(11),s=n(0),c=n(52),u=n(440),l=function(e){var t=e.track,n=e.guildId,r=void 0===n?0:n,l=Object(s.useState)(!1),d=Object(o.a)(l,2),m=d[0],v=d[1],b=Object(s.useState)(!1),g=Object(o.a)(b,2),y=g[0],k=g[1],O=Object(s.useState)(!1),j=Object(o.a)(O,2),w=j[0],E=j[1];function S(){return(S=Object(i.a)(a.a.mark(function e(n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stopPropagation(),c.a.isLoggedIn()){e.next=3;break}return e.abrupt("return");case 3:m?(u.a.unfavoriteSequence(t.id,r),v(!1)):(u.a.favoriteSequence(t.id,r),v(!0));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function P(){return(P=Object(i.a)(a.a.mark(function e(n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.stopPropagation(),e.next=3,c.a.getAccount();case 3:if(i=e.sent,p(i,t.user)){e.next=6;break}return e.abrupt("return");case 6:y?(u.a.unstarSequence(t.id,r),k(!1)):(u.a.starSequence(t.id,r),k(!0),E(!0));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(s.useEffect)(function(){!function(e,t){h.apply(this,arguments)}(t.id,v),function(e,t,n){f.apply(this,arguments)}(t,E,k)},[t.blockNumber,k,E,t]),{showStar:w,isStarred:y,isFavorited:m,onStarClicked:function(e){return P.apply(this,arguments)},onFavoriteClicked:function(e){return S.apply(this,arguments)}}};function f(){return(f=Object(i.a)(a.a.mark(function e(t,n,r){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.getAccount();case 2:return i=e.sent,e.next=5,u.a.isSequenceStarred(t.id);case 5:((o=e.sent)||p(i,t.user))&&n(!0),r(o);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(){return(h=Object(i.a)(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.getAccount();case 2:if(void 0!==(r=e.sent)){e.next=5;break}return e.abrupt("return");case 5:return e.t0=n,e.next=8,u.a.isSequenceFavorited(t,r);case 8:e.t1=e.sent,(0,e.t0)(e.t1);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var p=function(e,t){return void 0!==e&&void 0!==t&&e.toLowerCase()===t.toLowerCase()}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c),l=n(59);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement("div",{className:"passphrase-label"},"Name of new guild:"),u.a.createElement(l.h,{className:"guild-name-input-group"},u.a.createElement(l.g,{autoComplete:"off",onChange:function(t){return e.props.onNameChange(t.target.value)},value:this.props.name,placeholder:"Type name for guild",id:"guild-name-input"})),u.a.createElement("div",{className:"passphrase-label"},"Encrypted with passphrase:"),u.a.createElement(l.h,{className:"guild-name-input-group"},u.a.createElement(l.g,{autoComplete:"off",onChange:function(t){return e.props.onPassphraseChange(t.target.value)},value:this.props.passphrase,placeholder:"Type passphrase for guild",id:"passphrase-input"})))}}]),n}(c.Component);t.a=h},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(11),s=n(0),c=n.n(s),u=(n(92),n(30)),l=n(29),f=n(47),h=n(12),p=n(511),d=n(272);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=new l.a;t.a=Object(h.b)(function(e,t){return{loadedPack:t.pad.packHash}},function(e){return{}})(function(e){var t=e.pad,n=(e.sequencerEngine,e.loadedPack),r=Object(s.useState)([]),l=Object(o.a)(r,2),h=l[0],v=l[1];Object(s.useEffect)(function(){Object(d.a)().then(function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.xanadu.getPacksWithType(t.map(function(e){return e.packHash}),p.a);case 2:n=e.sent,console.log("packs with type=",n),r=[],i=m(t),e.prev=6,i.s();case 8:if((o=i.n()).done){e.next=15;break}if(s=o.value,n.includes(s.packHash)){e.next=12;break}return e.abrupt("continue",13);case 12:r.push(s);case 13:e.next=8;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),i.e(e.t0);case 20:return e.prev=20,i.f(),e.finish(20);case 23:v(r);case 24:case"end":return e.stop()}},e,null,[[6,17,20,23]])}));return function(t){return e.apply(this,arguments)}}())},[]);var g=Object(s.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(n){var r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.packHash,e.next=3,f.a.getJson(r);case 3:i=e.sent,t.subSequence.loadPackAsPads(i.pad,i.fx,t,r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[t]);return c.a.createElement("div",{className:"pad-packs"},c.a.createElement("div",{className:"packs-header"},c.a.createElement("img",{src:"/zpad-icon.svg"})," Packs"),c.a.createElement("div",{className:"pack-list"},h.map(function(e){return c.a.createElement("div",{onClick:function(){return g(e)},className:n===e.packHash?"selected pad-pack":"pad-pack"},c.a.createElement("div",{style:{backgroundColor:b.getColorForHash(e.title)},className:"pack-thumb"}),e.title)})))})},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(5),a=n.n(r),i=n(14),o=(n(254),n(2710)),s=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,s,u,l,f,h,p,d,m,v,b,g;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d=function(e){console.info("meta data: ",e),f=e},p=function(e,t,n){console.error("decode error callback",e,t)},h=function(e,t){l.push(e)},u=function(e){var n,r,a=i===s?-1:Math.min(i+e,s);return-1!==a?(n=t.subarray(i,a),r=a-i,i=a):r=0,{buffer:n,readDataLength:r,error:!1}},!0,n=!0,!1,n=!1,0!=(r=o.create_libflac_decoder(!1))){e.next=10;break}return e.abrupt("return");case 10:if(i=0,s=t.buffer.byteLength,l=[],m=1,v=n?o.init_decoder_ogg_stream(r,u,h,p,d):o.init_decoder_stream(r,u,h,p,d),1==(m&=0==v)){e.next=18;break}return e.abrupt("return");case 18:if("file",0,b=1,b&=o.FLAC__stream_decoder_process_until_end_of_stream(r),o.FLAC__stream_decoder_get_state(r),1==b){e.next=24;break}return e.abrupt("return");case 24:return m&=o.FLAC__stream_decoder_finish(r),o.FLAC__stream_decoder_delete(r),g=c(l,f.sampleRate,f.channels,f.bitsPerSample),e.abrupt("return",g.arrayBuffer());case 28:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();function c(e,t,n,r){var a=function(e,t,n,r){var a=r/8,i=e.length*e.BYTES_PER_ELEMENT,o=new ArrayBuffer(44+i),s=new DataView(o);return l(s,0,"RIFF"),s.setUint32(4,36+i,!0),l(s,8,"WAVE"),l(s,12,"fmt "),s.setUint32(16,16,!0),s.setUint16(20,1,!0),s.setUint16(22,n,!0),s.setUint32(24,t,!0),s.setUint32(28,t*n*a,!0),s.setUint16(32,n*a,!0),s.setUint16(34,r,!0),l(s,36,"data"),s.setUint32(40,i,!0),function(e,t,n){for(var r=0;r<n.length;++r,++t)e.setUint8(t,n[r])}(s,44,e),s}(function(e,t,n){var r=n/8,a=24===n||8===n?1:0;a&&(r+=a);for(var i=0,o=0;o<t;++o)i+=u(e,o,r,a);for(var s,c=new Uint8Array(i),l=0,f=0,h=0,p=0,d=0,m=!1,v=0,b=e.length;v<b;++v)for(s=e[v],l=s[0].length,h=0,!1,m=!1;h<l;){for(p=0;p<t;++p)for(d=0;d<r;++d)a?a&&d===r-a?0!==s[p][h+d]&&255!==s[p][h+d]&&console.error("[ERROR] mis-aligned padding: ignoring non-padding value (padding should be 0 or 255) at "+(h+d)+" -> ",s[p][h+d]):8===n?(m=0===s[p][h+d+1],c[f++]=m?128|s[p][h+d]:127&s[p][h+d]):c[f++]=s[p][h+d]:c[f++]=s[p][h+d];h+=r}return c}(e,n,r),t,n,r);return new Blob([a],{type:"audio/wav"})}function u(e,t,n,r){for(var a,i=0,o=r>0?r/n:0,s=e.length-1;s>=0;--s)a=e[s][t].byteLength,i+=r>0?a-o*a:a;return i}function l(e,t,n){for(var r=0;r<n.length;r++)e.setUint8(t+r,n.charCodeAt(r))}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(33),a={2:new r.a(4,!1),3:new r.a(4,!0),4:new r.a(8,!1),5:new r.a(8,!0),6:new r.a(16,!1),7:new r.a(16,!0),8:new r.a(32,!1),9:new r.a(32,!0)}},function(e,t,n){"use strict";var r=n(8),a=n(11),i=n(99),o=n(0),s=n.n(o),c=n(112),u=n(9),l=n(35);function f(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e,t){return{drawForces:function(t){for(var n=e.groups.flatMap(function(e){return e.variables.filter(function(e){return e.name.includes("force")})}),r=n.length/4,a=[],i=function(e){var r=n.filter(function(t){return t.name.includes(new String(e))}),i=r.find(function(e){return e.name.includes("force.x")}).get(),o=l.a-r.find(function(e){return e.name.includes("force.y")}).get(),s=r.find(function(e){return e.name.includes("force.dx")}).get(),c=-1*r.find(function(e){return e.name.includes("force.dy")}).get(),u=i+(s*=.25),f=o+(c*=.25);t.beginPath(),t.strokeStyle="white",t.lineWidth=2,function(e,t,n,r,a){var i=r-t,o=a-n,s=Math.atan2(o,i);e.moveTo(t,n),e.lineTo(r,a),e.lineTo(r-10*Math.cos(s-Math.PI/6),a-10*Math.sin(s-Math.PI/6)),e.moveTo(r,a),e.lineTo(r-10*Math.cos(s+Math.PI/6),a-10*Math.sin(s+Math.PI/6))}(t,i,o,u,f),t.stroke();var h=new Path2D;h.arc(i,o,5,0,2*Math.PI),t.fillStyle="white",t.fill(h);var p=new Path2D;p.arc(u,f,14,0,2*Math.PI),t.fillStyle="transparent",t.fill(p),a.push({start:h,end:p})},o=1;o<=r;o++)i(o);return a},getForceParameters:function(t){var n=e.groups.flatMap(function(e){return e.variables.filter(function(e){return e.name.includes("force")})}).filter(function(e){return e.name.includes(new String(t))}),r=n.find(function(e){return e.name.includes("force.x")}),a=n.find(function(e){return e.name.includes("force.y")}),i=n.find(function(e){return e.name.includes("force.dx")}),o=n.find(function(e){return e.name.includes("force.dy")});return[r,a,i,o]}}},d=n(12);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=Object(d.b)(function(e,t){var n,r="",a=m(t.effect.groups);try{for(a.s();!(n=a.n()).done;){var i,o=m(n.value.variables);try{for(o.s();!(i=o.n()).done;){var s=i.value;r+=s.name+","+s.get()}}catch(c){o.e(c)}finally{o.f()}}}catch(c){a.e(c)}finally{a.f()}return{forces:r}},null)(function(e){var t=e.onClick,n=e.onMouseMove,r=e.onMouseUp,a=e.onMouseDown,i=e.forcePaths,c=(e.effect,e.forces),u=e.drawForces,f=Object(o.useRef)(void 0),h=Object(o.useRef)(void 0);Object(o.useEffect)(function(){h.current=f.current.getContext("2d"),h.current.scale(window.devicePixelRatio,window.devicePixelRatio)},[]),Object(o.useEffect)(function(){h.current&&window.requestAnimationFrame(p)},[c]);var p=Object(o.useCallback)(function(){h.current.clearRect(0,0,l.c,l.a),i.current=u(h.current)},[]),d={height:l.a,width:l.c};return s.a.createElement("canvas",{style:d,onClick:t,onMouseMove:n,onMouseUp:r,onMouseDown:a,ref:f,width:window.devicePixelRatio*l.c,height:window.devicePixelRatio*l.a,className:"force-drawer"})});function g(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var k,O=Object(d.b)(function(e,t){return{parameterMinMax:e.effects.parameterMinMax}},function(e){return{}})(function(e){var t=Object(o.useRef)(void 0),n=Object(o.useRef)(void 0);Object(o.useEffect)(function(){n.current=t.current.getContext("2d"),n.current.scale(window.devicePixelRatio,window.devicePixelRatio)},[]),Object(o.useEffect)(function(){window.requestAnimationFrame(r)},[e.isRegionMode,e.parameterMinMax,e.selected]);var r=Object(o.useCallback)(function(){if(n.current){var t=n.current;if(t.clearRect(0,0,l.c,l.a),e.isRegionMode){var r,a=g(e.selected.flatMap(function(e){return e.isPlaneMacro?e.parameters:e}));try{for(a.s();!(r=a.n()).done;){var i=r.value,o=i.min,s=i.max,c=i.originalMin,u=i.originalMax,f=i.depthParameter;t.strokeStyle="#00a4ff",t.fillStyle="#23757b4f",t.setLineDash([3]),t.lineWidth=1;var h=l.c*(o-c)/(u-c),p=f?l.a*(f.min-f.originalMin)/(f.originalMax-f.originalMin):0,d=f?l.a*(f.max-f.min)/(f.originalMax-f.originalMin):l.a,m=l.c*(s-o)/(u-c);t.fillRect(h,p,m,d),t.strokeRect(h,p,m,d)}}catch(v){a.e(v)}finally{a.f()}}}},[e.isRegionMode,e.parameterMinMax,e.parameters,e.selected]);return s.a.createElement("canvas",{style:{width:l.c,height:l.a},width:window.devicePixelRatio*l.c,height:window.devicePixelRatio*l.a,className:"canvas-regions",ref:t})}),j=(Float32Array.BYTES_PER_ARRAY,n(29));new j.a;var w=function(e,t,n){e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);var r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,t),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)||console.log("An error occurred compiling the shaders:"+e.getShaderInfoLog(r));var a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,n),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)||console.log("An error occurred compiling the shaders:"+e.getShaderInfoLog(a));var i=e.createProgram();return e.attachShader(i,r),e.attachShader(i,a),e.linkProgram(i),i},E=Object(d.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=Object(o.useRef)(void 0),n=Object(o.useRef)(void 0),r=Object(o.useRef)(void 0),a=Object(o.useRef)(void 0),i=Object(o.useRef)(void 0),c=Object(o.useRef)(void 0);Object(o.useEffect)(function(){n.current=t.current.getContext("webgl",{preserveDrawingBuffer:!0});var e=n.current;r.current=function(e){var t=(10*l.c/600).toFixed(1);return console.log("pointSize = ",t),w(e,["precision mediump float;","attribute vec4 aPosition;","attribute float vertColor;","varying float fragColor;","void main() {","gl_PointSize = ".concat(t,";"),"gl_Position = aPosition;","fragColor = vertColor;","}"].join("\n"),["precision mediump float;","varying float fragColor;","void main() {","gl_FragColor = vec4(1,1,1,0.1*fragColor);","}"].join("\n"))}(e),a.current=function(e){return w(e,"\nprecision mediump float;\nattribute vec4 a_position;\nvoid main() {\n   gl_Position = a_position;\n}\n","\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n   gl_FragColor = u_color;\n}\n")}(e),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(0,0,0,0)},[]),Object(o.useEffect)(function(){u()},[e.coords]);var u=Object(o.useCallback)(function(){var a=n.current;if(a&&r.current&&(a.clear(a.COLOR_BUFFER_BIT),e.effect.D)){a.useProgram(r.current);var o=function(e,t,n,r,a,i,o){if(i.current)e.bindBuffer(e.ARRAY_BUFFER,i.current),e.bufferData(e.ARRAY_BUFFER,k,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,o.current),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW);else{i.current=e.createBuffer(),k=new Float32Array(new Array(r.length).fill(0).flatMap(function(e,t){var n=t%66;return[n/64*2-1,2*(1-(t-n)/66/64)-1]})),e.bindBuffer(e.ARRAY_BUFFER,i.current),e.bufferData(e.ARRAY_BUFFER,k,e.STATIC_DRAW);var s=e.getAttribLocation(t,"aPosition");e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),o.current=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,o.current),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW);var c=e.getAttribLocation(t,"vertColor");e.enableVertexAttribArray(c),e.vertexAttribPointer(c,1,e.FLOAT,!1,0,0)}return r.length}(a,r.current,t.current,e.effect.D,e.effect,i,c);a.drawArrays(a.POINTS,0,o)}},[]);return s.a.createElement("canvas",{style:{width:l.c,height:l.a},width:l.c,height:l.a,className:"canvas-shader",ref:t})});function S(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=new j.a;window.blur=6,window.macroOpacity=.7,window.r=50,window.g=55,window.b=65;var T=function(e){var t=e.ctxt,n=e.gradientColor,r=e.macroPaths,a=e.paths,c=(e.forcePaths,e.splineTension),f=e.blur,h=(e.setMacroToShow,e.macroToShow),p=e.parameters,d=e.selection,m=(e.startDragging,e.coords),v=e.effect,b=(e.setEffectParameterValues,Object(i.a)(e,["ctxt","gradientColor","macroPaths","paths","forcePaths","splineTension","blur","setMacroToShow","macroToShow","parameters","selection","startDragging","coords","effect","setEffectParameterValues"])),g=Object(o.useRef)(void 0),y=Object(o.useRef)(l.c),k=Object(o.useRef)(l.a);Object(o.useEffect)(function(){t.current=g.current.getContext("2d"),t.current.scale(window.devicePixelRatio,window.devicePixelRatio)},[]),Object(o.useEffect)(function(){l.c!==y.current&&(t.current.scale(window.devicePixelRatio,window.devicePixelRatio),y.current=l.c,k.current=l.a)},[l.c,l.a]),Object(o.useEffect)(function(){t.current&&window.requestAnimationFrame(O)},[c,n,b.selectedColor,m,p,h,b.filteredParameters,b.isRegionMode]);var O=Object(o.useCallback)(function(){var e=t.current;if(e.clearRect(0,0,l.c,l.a),d&&(e.fillStyle="#b00909",e.fillRect(d.x1,d.y1,Math.abs(d.x2-d.x1),Math.abs(d.y2-d.y1))),!b.filteredParameters){var i,o=S(v.groups);try{for(o.s();!(i=o.n()).done;){var s=i.value,c=s._parameters.filter(function(e){return!e.planeMacro}),f=Array.from(new Set(s._parameters.filter(function(e){return e.planeMacro}).map(function(e){return e.planeMacro}))),g=c.map(function(e){return e.getCoordinates()}),y="M "+(g=[].concat(Object(u.a)(g),Object(u.a)(f.map(function(e){return e.coordinates})))).map(function(e){return e.x+" "+e.y}).join(", "),k=new Path2D(y);e.setLineDash([1]),e.strokeStyle=x.transparent(x.saturate(x.getColorForHash(s.id),2),.6),e.stroke(k)}}catch(V){o.e(V)}finally{o.f()}}e.setLineDash([]);var O,j=S([].concat(Object(u.a)(v.macros.filter(function(e){return!b.selected.includes(e)})),Object(u.a)(b.selected.filter(function(e){return v.macros.includes(e)}))));try{for(j.s();!(O=j.n()).done;){var w=O.value,E=w.getEasyBlob(),P=E.x,T=E.y,C=E.diameter,N=E.d,R=new Path2D(N),M=w.color;if(n){var A=e.createRadialGradient(P,T,C,P+15,T+40,5);A.addColorStop(0,n),A.addColorStop(1,x.transparent(x.saturate(M,2),b.isFiltered?.1:window.macroOpacity)),e.fillStyle=A}else e.fillStyle=x.transparent(x.saturate(M,2),b.isFiltered?.1:window.macroOpacity);e.fill(R),(h===w||b.selected.includes(w))&&(e.setLineDash([3]),e.lineWidth=1,e.strokeStyle="white",e.stroke(R)),r.current[w.id]=R}}catch(V){j.e(V)}finally{j.f()}var q,D=S(p);try{for(D.s();!(q=D.n()).done;){var I=q.value,_=I.id;if(m[_]){var F=m[_],L=F.x,B=F.y,z=new Path2D;z.arc(L,B,7,0,2*Math.PI),b.selected.includes(I)?(e.lineWidth=2,e.strokeStyle=x.getColorForHash(I.name),e.stroke(z),e.fillStyle="black"):e.fillStyle=x.getColorForHash(I.name),e.fill(z),a.current[_]=z}}}catch(V){D.e(V)}finally{D.f()}},[b.selected,n,m,p,h,b.filteredParameters,b.isRegionMode]),j={width:l.c,height:l.a};return f>0&&(j.filter="blur(".concat(f,"px)")),s.a.createElement("canvas",{style:j,className:"canvas-drawer",width:window.devicePixelRatio*l.c,height:window.devicePixelRatio*l.a,ref:g})},C=Object(d.b)(function(e,t){return{gradientColor:e.plane.gradientColors[t.effect.id],splineTension:t.effect.splineTension}},function(e){return{}})(function(e){var t=e.isRegionMode,n=e.selectedColor,r=e.setMacroToShow,c=e.startDragging,h=e.coords,d=e.filteredParameters,m=e.parameters,v=e.macroToShow,g=e.setParameterMinMax,y=e.setEffectParameterValues,k=e.containerRef,j=e.effect,w=e.selected,S=e.selection,P=e.parameterSelected,x=e.sequencerEngine,C=e.macros,N=e.splineTension,R=Object(i.a)(e,["isRegionMode","selectedColor","setMacroToShow","startDragging","coords","filteredParameters","parameters","macroToShow","setParameterMinMax","setEffectParameterValues","containerRef","effect","selected","selection","parameterSelected","sequencerEngine","macros","splineTension"]),M=Object(o.useRef)(void 0),A=Object(o.useRef)([]),q=Object(o.useRef)({}),D=Object(o.useRef)({}),I=p(j),_=I.drawForces,F=I.getForceParameters,L=function(e){var t=e.forcePaths,n=e.effect,r=e.containerRef,i=e.ctxt,s=e.selected,c=e.startDragging,h=e.parameters,p=e.paths,d=e.macroPaths,m=e.setMacroToShow,v=e.setEffectParameterValues,b=e.getForceParameters,g=Object(o.useRef)(void 0),y=Object(o.useState)(void 0),k=Object(a.a)(y,2),O=k[0],j=k[1],w=Object(o.useState)(void 0),E=Object(a.a)(w,2),S=E[0],P=E[1],x=Object(o.useCallback)(function(e){var a,o=r.current.getBoundingClientRect(),l=2*(e.clientX-o.left),m=2*(e.clientY-o.top),v=1,b=f(t.current);try{for(b.s();!(a=b.n()).done;){var g=a.value,y=g.start,k=g.end;if(i.current.isPointInPath(y,l,m))return e.stopPropagation(),void j(v);if(i.current.isPointInPath(k,l,m))return e.stopPropagation(),void P(v);v++}}catch(T){b.e(T)}finally{b.f()}for(var O=[].concat(Object(u.a)(s.filter(function(e){return n.macros.includes(e)})),Object(u.a)(n.macros.filter(function(e){return!s.includes(e)}))),w=0,E=[].concat(Object(u.a)(h),Object(u.a)(O));w<E.length;w++){var S=E[w],x=p.current[S.id]||d.current[S.id];if(x&&i.current.isPointInPath(x,l,m)){c(e,S);break}}},[c,h,j,P]),T=Object(o.useCallback)(function(e){var t,a=r.current.getBoundingClientRect(),o=2*(e.clientX-a.left),c=2*(e.clientY-a.top),l=f([].concat(Object(u.a)(s.filter(function(e){return n.macros.includes(e)})),Object(u.a)(n.macros.filter(function(e){return!s.includes(e)}))));try{for(l.s();!(t=l.n()).done;){var h=t.value,p=d.current[h.id];if(p&&i.current.isPointInPath(p,o,c)){var v=(new Date).getTime();return v-g.current<=250&&m(h),void(g.current=v)}}}catch(b){l.e(b)}finally{l.f()}},[m]),C=Object(o.useCallback)(function(){j(void 0),P(void 0)},[j,P]);return{onMouseMove:Object(o.useCallback)(function(e){if(void 0!==O||void 0!==S){var t=r.current.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,o={};if(void 0!==O){var s=b(O),c=Object(a.a)(s,4),u=c[0],f=c[1],h=c[2],p=c[3],d=u.get()+.25*h.get(),m=f.get()+.25*p.get(),g=n,y=l.a-i,k=d-g,j=m-y;o[u.id]=u.set(g,!1,!0).value,o[f.id]=f.set(y,!1,!0).value,o[h.id]=h.set(4*k,!1,!0).value,o[p.id]=p.set(4*j,!1,!0).value}else{var w=b(S),E=Object(a.a)(w,4),P=E[0],x=E[1],T=E[2],C=E[3],N=[P.get(),l.a-x.get()],R=4*(n-N[0]),M=-4*(i-N[1]);o[T.id]=T.set(R,!1,!0).value,o[C.id]=C.set(M,!1,!0).value}v(o)}},[O,S]),onMouseUp:C,onMouseDown:x,onClick:T}}({forcePaths:A,effect:j,containerRef:k,ctxt:M,selected:w,startDragging:c,parameters:m,paths:q,macroPaths:D,setMacroToShow:r,setEffectParameterValues:y,getForceParameters:F}),B=L.onClick,z=L.onMouseMove,V=L.onMouseUp,H=L.onMouseDown;return[s.a.createElement(O,{selected:w,isRegionMode:t}),s.a.createElement(T,Object.assign({drawForces:_,getForceParameters:F,forcePaths:A,splineTension:N,ctxt:M,paths:q,macroPaths:D,blur:R.blur,selectedColor:n,setMacroToShow:r,startDragging:c,coords:h,filteredParameters:d,parameters:m,gradientColor:R.gradientColor,macroToShow:v,isFiltered:void 0!==d,setParameterMinMax:g,effect:j,parameterSelected:P,setEffectParameterValues:y,containerRef:k,selected:w,selection:S,sequencerEngine:x,macros:C},R)),s.a.createElement(E,{coords:h,effect:j}),s.a.createElement(b,{drawForces:_,forcePaths:A,onClick:B,onMouseMove:z,onMouseUp:V,onMouseDown:H,effect:j})]}),N=n(49),R=function(e){var t=[],n=Object(a.a)(e[0],2),r=n[0],i=n[1];t.push([M(r,l.c),M(i,l.a,-1)]);for(var o=1;o<e.length;o++){for(var s=[],c=0;c<e[o].length;c++){var u=c%2===0?l.c:l.a,f=c%2===0?1:-1;s.push(M(e[o][c],u,f))}t.push(s)}return t},M=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.c;return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)*(e/t*2-1)},A=(Object(d.b)(function(e,t){return{}},function(e){return{}})(function(e){e.blur,e.setMacroToShow;var t=e.macroToShow,n=e.parameters,r=(e.selection,e.startDragging,e.coords),c=e.effect,u=(e.setEffectParameterValues,Object(i.a)(e,["blur","setMacroToShow","macroToShow","parameters","selection","startDragging","coords","effect","setEffectParameterValues"])),l=Object(o.useRef)(void 0),f=Object(o.useRef)(void 0),h=Object(o.useRef)(void 0),p=Object(o.useRef)(void 0),d=Object(o.useRef)(void 0),m=Object(o.useRef)(void 0),v=Object(o.useRef)(void 0),b=Object(o.useRef)(void 0),g=Object(o.useRef)(!1);Object(o.useEffect)(function(){f.current=new N.H,p.current=new N.z(-1,1,1,-1,1,1e3),h.current=new N.S,h.current.setSize(300,200),h.current.setPixelRatio(window.devicePixelRatio),y(),l.current.appendChild(h.current.domElement)},[]),Object(o.useEffect)(function(){f.current&&y()},[u.selectedColor,r,n,t,u.filteredParameters,u.isRegionMode]);var y=Object(o.useCallback)(function(){d.current=new N.J;var e=c.macros[0],t=e.getGeometry(),n=t.x,r=t.y,i=(t.diameter,R(e.getBlob(n,r,16,!0))),o=Object(a.a)(i[0],2),s=o[0],u=o[1];d.current.moveTo(s,u);for(var l=1;l<i.length;l++){var y=Object(a.a)(i[l],6),k=y[0],O=y[1],j=y[2],w=y[3],E=y[4],S=y[5];d.current.bezierCurveTo(k,O,j,w,E,S)}if(b.current){var P=d.current.makeGeometry();b.current.attributes=P.attributes}else b.current=new N.K(d.current);v.current=v.current||new N.v({color:65280}),m.current?m.current.geometry=b.current:m.current=m.current||new N.u(b.current,v.current),g.current||(f.current.add(m.current),g.current=!0),p.current.position.z=window.zpos||1,h.current.render(f.current,p.current)},[u.selectedColor,r,n,t,u.filteredParameters,u.isRegionMode]);return s.a.createElement("div",{ref:l,className:"threejs-canvas-holder"})}),n(42)),q=n(526),D=new j.a,I=Object(o.memo)(function(e){var t=e.debug,n=e.setMacroToShow,r=e.isShowing,a=e.startDragging,i=e.isSelected,c=e.macro,u=(e.coordinates,c.getGeometry()),l=u.x,f=u.y,h=(u.diameter,Object(o.useRef)((new Date).getTime())),p=Object(o.useCallback)(function(){var e=(new Date).getTime();e-h.current<=300&&n(c),h.current=e},[n]),d=c.getBlob(l,f,t),m=D.getColorForHash(c.id),v="macro";return i&&(v+=" selected"),r&&(v+=" showing"),s.a.createElement(A.Group,null,s.a.createElement(A.Path,{perfectDrawEnabled:!1,hitStrokeWidth:0,shadowForStrokeEnabled:!1,dash:i&&[3,2],onClick:p,onMouseDown:function(e){return a(e.evt,c)},fill:D.transparent(D.saturate(m,2),i?.2:.5),strokeWidth:1,data:d,className:v,stroke:r||i?"white":"transparent"}))});Object(d.b)(function(e,t){var n={};return t.effect._parameters.filter(function(e){return e.planeMacro===t.macro}).map(function(t){return n[t.id]=e.effects.effectParameters[t.id]}),t.effect._parameters.filter(function(e){return e.planeMacro===t.macro}).map(function(e){return n[e.id+"depth"]=e.depth}),n},null)(I);function _(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L=Object(o.memo)(function(e){var t=e.drawnPath;e.currentPosition;if(!t||t.length<2)return[];var n="M "+(t=B(t)).map(function(e){return e.x+" "+e.y}).join(" ");return s.a.createElement("path",{d:n,className:"drawn-path"})}),B=function(e){var t,n=[],r=0,a=void 0,i=_(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;a&&a.x===o.x&&a.y===o.y?r++:(r%3!==0&&r!==e.length-1||(n.push(o),a=o),r++)}}catch(s){i.e(s)}finally{i.f()}return n},z=Object(d.b)(null,null)(L);function V(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var U=n(632),J=n(247),G=n(450),W=n(373),K=n(107),X=n(22),Q=n(39),Y=n.n(Q),Z=function(e){var t=e.step,n=e.hasState,r=(e.group,e.onClick),a=e.isCurrent,i=e.isSelected,o="sequencer-step";return n&&(o+=" on"),a&&(o+=" current"),i&&(o+=" selected"),s.a.createElement("div",{onClick:function(e){return r(e,t,!n)},className:o},t+1)},$=(Object(d.b)(function(e,t){return{trackStep:t.sequencerEngine.trackStep}},function(e){return{}})(function(e){var t=e.group,n=e.trackStep,i=Object(o.useState)(t.stepToState),c=Object(a.a)(i,2),u=c[0],l=c[1],f=Object(o.useState)(void 0),h=Object(a.a)(f,2),p=h[0],d=h[1],m=Object(o.useState)(t.sequencerEnabled),v=Object(a.a)(m,2),b=v[0],g=v[1];Object(o.useEffect)(function(){l(t.stepToState)},[t.stepToState,l]),Object(o.useEffect)(function(){return function(){return t.unselectStep()}},[t]);var y=Object(o.useCallback)(function(){t.sequencerEnabled=!b,g(!b)},[t,g,b]),k=Object(o.useCallback)(function(e,n,a){if(e.metaKey)return t.selectStep(n),void d(n);a?t.recordStateAtStep(n):t.deleteStateAtStep(n),l(Object(r.a)({},t.stepToState)),d(void 0)},[l,t,d]),O=new Array(16).fill(0),j=Math.floor(n/2)%16;return s.a.createElement("div",{className:"group-sequencer"},s.a.createElement("div",{className:"sequencer-toolbar"},s.a.createElement("div",{className:"sequencer-label"},"Sequencer"),s.a.createElement("div",{onClick:y,className:b?"s-stop":"s-play"})),s.a.createElement("div",{className:b?"sequencer-steps":"sequencer-steps disabled"},O.map(function(e,n){return s.a.createElement(Z,{isSelected:p===n,isCurrent:b&&n===j,onClick:k,step:n,hasState:u[n],group:t})})))}),[{label:"None",value:c.e},{label:"Fluid",value:c.d},{label:"Script",value:c.g},{label:"Bounce 1",value:c.a},{label:"Bounce 2",value:c.b},{label:"Life",value:c.c},{label:"Rotate",value:c.f},{label:"Spiral",value:c.h},{label:"Swap",value:c.i}]),ee=Object(d.b)(function(e,t){var n=t.selected,r=n&&n[0]&&n[0].hasGroup||t.effect.groups[0];return{algo:r&&r.algorithm}},function(e){return{}})(function(e){var t=e.isDraggable,n=e.selected,r=e.effect,a=e.setExpanded,i=e.expanded,u=Object(o.useRef)(void 0);if(Object(J.a)(u),(!n[0]||!n[0].hasGroup)&&!i)return s.a.createElement("div",null);var l=n[0]&&n[0].hasGroup?n[0].hasGroup:r.groups[0];return l?s.a.createElement("div",{ref:u,className:"plane-group-config"},s.a.createElement("div",{className:"plane-algo"},s.a.createElement(Y.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:$,onChange:function(e){return l.algorithmParameter.set(e.value)},value:$.find(function(e){return e.value===l.algorithm}),placeholder:"Algorithm"}),s.a.createElement(X.a,{name:"Speed",parameter:l.speedParameter,isParameter:!0,sequencerEngine:r.track.sequencerEngine,lfoEnabled:!0,root:3,step:.01,min:.01,max:30})),i||l.algorithm!=c.g?"":s.a.createElement(W.a,{isDraggable:t,scriptType:G.a,setExpanded:a,doc:K.a,sequencerEngine:l.track.sequencerEngine,effect:l})):""}),te=n(633),ne=Object(d.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setSelected,n=e.isRegionMode,r=e.effect,a=e.isDraggable,i=e.setExpanded,c=e.expanded,u=e.setIsRegionMode,l=e.unmap,f=e.selected,h=e.mergeGroups,p=e.group,d=e.grouped,m=e.setDrawMode,v=e.drawMode,b=e.children,g=Object(o.useCallback)(function(e){r.scriptExpanded=e,i(e)},[r,i]),y=Object(o.useCallback)(function(){r.createMacro(f)},[r,f]),k=Object(o.useCallback)(function(){var e=f[0].parameters;r.freeMacro(f[0]),t(e)},[r,f,t]),O=new Set;f.forEach(function(e){return O.add(e.hasGroup)});var j=O.size>=2,w=f.length>0,E=f[0]&&f[0].isPlaneMacro;return s.a.createElement("div",{className:"plane-toolbar"},s.a.createElement("div",{className:"plane-toolbar-inner"},s.a.createElement("div",{className:"inner-part-1"},s.a.createElement("div",{className:"plane-group-buttons"},s.a.createElement("div",{onClick:function(){return l()},className:f.length>0?"plane-btn":"plane-btn disabled"},"unmap"),j?s.a.createElement("div",{onClick:h,className:"plane-btn"},"merge"):"",s.a.createElement("div",{onClick:function(){return p(!d)},className:f.length>0?"plane-btn":"plane-btn disabled"},d?"ungroup":"group"),s.a.createElement("div",{className:n?"plane-btn selected":f.length>0?"plane-btn":"plane-btn disabled",onClick:function(){return u(!n)}},"bounds"),s.a.createElement("div",{onClick:E?k:y,className:w?"plane-btn":"plane-btn disabled"},E?"free macro":"macro"),s.a.createElement("img",{onClick:function(){return m(!v)},src:"/pencil.svg",className:v?"pencil-icon enabled":"pencil-icon"}),s.a.createElement("img",{onClick:function(){return r.resetValues()},src:"/reset.svg",className:"reset-icon"})),s.a.createElement(te.a,{isDraggable:!0,effect:r}),s.a.createElement(U.a,{group:r}),s.a.createElement(ee,{isDraggable:a,setExpanded:g,expanded:c,selected:f,effect:r})),b),"")}),re=function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return Math.sqrt(Math.pow(r-t,2)+Math.pow(a-n,2))},ae=(n(38),n(62)),ie=n(46),oe=n(6);function se(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ce(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object(d.b)(function(e,t){return{parameterMinMax:e.effects.parameterMinMax}},function(e){return{}})(function(e){e.effect;var t=e.selected,n=e.width,r=e.height;return t.flatMap(function(e){return e.isPlaneMacro?e.parameters:e}).map(function(e){var t=e.min,a=e.max,i=e.originalMin,o=e.originalMax,c=e.depthParameter;return s.a.createElement(A.Rect,{strokeShadowEnabled:!1,perfectDrawing:!1,stroke:"#00a4ff",fill:"#23757b4f",dash:[3],x:n*(t-i)/(o-i),y:c?r*(c.min-c.originalMin)/(c.originalMax-c.originalMin):0,height:c?r*(c.max-c.min)/(c.originalMax-c.originalMin):r,width:n*(a-t)/(o-i)})})}),Object(d.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.parameter,n=e.history,r=n.slice(Math.max(0,n.length-10)).map(function(e){return e[t.id]}),a=r[0];if(!a)return[];var i="M "+a.x+","+a.y+" C"+r.slice(1).map(function(e){return e.x+","+e.y}).join(",");return s.a.createElement("path",{className:"history-path",d:i,stroke:"white",strokeWidth:2})});var ue=new j.a;Object(d.b)(function(e,t){var n={macros:e.plane.macros[t.group.effect.id]};return t.group._parameters.map(function(e){return n[e.id]=e.get(!0)}),t.group._parameters.map(function(e){return n[e.id+"depth"]=e.depth}),n},function(e){return{}})(function(e){var t=e.group,n=t._parameters.filter(function(e){return!e.planeMacro}),r=Array.from(new Set(t._parameters.filter(function(e){return e.planeMacro}).map(function(e){return e.planeMacro}))),a=n.map(function(e){return e.getCoordinates()}),i="M "+(a=[].concat(Object(u.a)(a),Object(u.a)(r.map(function(e){return e.coordinates})))).map(function(e){return e.x+" "+e.y}).join(", ");return s.a.createElement(A.Path,{dash:[1],stroke:ue.getColorForHash(t.id),strokeWidth:1,data:i,className:"group-path"})});function le(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fe(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var he=0,pe=function(e,t,n,r,a,i){var o=e+(e-a)*i,s=t+(t-a)*i,c=Math.max(n,o),u=Math.min(r,s);return c<u?{min:c,max:u}:{min:e,max:t}},de=function(e){if(!e)return{};var t={};return t[e.id]=e.value,t};n(1555),n(274);function me(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ve(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function be(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ge(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ye=0,ke=function(e){var t=e.ref,n=e.effect,i=e.setEffectParameterValues,s=e.filteredParameters,c=e.isRegionMode,f=e.isDensitiesMode,h=e.setDensities,p=e.setSelectedDensity,d=e.macroToShow,m=e.setSelected,v=e.selected,b=Object(o.useRef)(0),g=Object(o.useState)(!1),y=Object(a.a)(g,2),k=y[0],O=y[1],j=n.track.sequencerEngine,w=Object(o.useState)(void 0),E=Object(a.a)(w,2),S=E[0],P=E[1],x=Object(o.useState)(void 0),T=Object(a.a)(x,2),C=T[0],N=T[1],R=Object(o.useCallback)(function(e){var n=t.current.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}},[t]),M=Object(o.useCallback)(function(e){e.stopPropagation();var t=R(e),r=t.x,a=t.y;k?n.setPencil(r,a):P({x1:r,y1:a,x2:r,y2:a})},[P,m,k]),A=Object(o.useCallback)(function(e){if(k)n.setPencil(null,null);else{if(S){if(S.x1!==S.x2&&S.y1!==S.y2){if(f){var t=re(S);if(!isNaN(S.x1)&&!isNaN(S.y1)){var r=n.newRegion(S.x1,S.y1,t);h(n.regions),p(r)}}if(c){var a,i=S.x1,o=S.x2,b=S.y1,g=S.y2,y=be(v);try{for(y.s();!(a=y.n()).done;){var O=a.value,w=O.originalMin+(O.originalMax-O.originalMin)*(i/l.c),E=O.originalMin+(O.originalMax-O.originalMin)*(o/l.c);O.min=w,O.max=E,(O.get(!0)<w||O.get(!0)>E)&&O.set(w+.1*(E-w));var x=O.depthParameter;if(x){var T=x.originalMin+(x.originalMax-x.originalMin)*(b/l.a),R=x.originalMin+(x.originalMax-x.originalMin)*(g/l.a);x.min=T,x.max=R,(x.get(!0)<T||x.get(!0)>R)&&(O.depth=T+.1*(R-T))}}}catch(A){y.e(A)}finally{y.f()}return m(Object(u.a)(v)),P(void 0),void(C&&N(void 0))}var M=function(e,t,n,r){var a,i=[],o=e.x1,s=e.x2,c=e.y1,u=e.y2,f=(Math.min(o,s),Math.min(c,u),me(n||t._parameters));try{for(f.s();!(a=f.n()).done;){var h=a.value;if(!h.planeMacro||h.planeMacro===r){var p=h.getCoordinates(l.c,l.a,l.b),d=p.x,m=p.y;d>=o&&d<=s&&m>=c&&m<=u&&i.push(h)}}}catch(A){f.e(A)}finally{f.f()}return i}(S,n,s,d);j.state.keyboard.isCommandDown?m([].concat(Object(u.a)(v),Object(u.a)(M))):m(M)}else C||m([]);P(void 0)}C&&N(void 0)}},[k,d,h,p,c,f,P,S,v,m,N,C,s,v]),q=Object(o.useCallback)(function(e,t){if(e.preventDefault(),!k){var r=(new Date).getTime();if(v.includes(t)){if(r-b.current<=380)if(1===v.length)if(t.planeMacro)m([t]);else{var a=n.getGroupForParameter(t);m(a?Object(u.a)(a._parameters):[t])}else m([t])}else{n.getGroupForParameter(t);t.planeMacro,m([t])}b.current=r,N(R(e))}},[N,v,m,k]);Object(o.useEffect)(function(){return window.isNFT&&window.addEventListener("mousemove",D),function(){window.isNFT&&window.removeEventListener("mousemove",D)}},[S,P,C,v,N,k]);var D=Object(o.useCallback)(function(e){var t=R(e),a=t.x,o=t.y;if(!window.isNFT||j.playing)if(window.isNFT&&k&&!n.pencilXParameter.get(!0)&&n.setPencil(a,o),k&&n.pencilXParameter.get(!0)&&n.pencilYParameter.get(!0)){if(ye++,window.isNFT){var s=ye;setTimeout(function(){s===ye&&n.setPencil(null,null)},1e3)}parseFloat;var c=n.pencilXParameter.get(!0),u=n.pencilYParameter.get(!0);re({x1:a,y1:o,x2:c,y2:u})>12&&n.setPencil(a,o)}else if(C){var l=a-C.x,f=o-C.y,h=Math.abs;if(h(l)<=2&&h(f)<=2)return;var p,d={},m=((new Date).getTime(),be(v));try{for(m.s();!(p=m.n()).done;){var b=p.value;if(!b.locked2D)if(b.isPlaneMacro)b.moveCoordinates(l,f);else{var g=b.moveCoordinates(l,f),y=g.id,O=g.value;d[y]=O}}}catch(w){m.e(w)}finally{m.f()}(new Date).getTime();i(d),N({x:a,y:o}),n.sendMacroMessages()}else P(Object(r.a)({},S,{x2:a,y2:o}))},[S,P,C,v,N,k]);return{startDragging:q,onMouseDown:M,onMouseUp:A,onMouseMove:D,selection:S,selected:v,setSelected:m,setDrawMode:O,drawMode:k}},Oe=(n(2549),new j.a);Object(o.memo)(function(e){var t=e.bpm,n=e.parameter,r=e.isSelected,a=e.startDragging,i=e.x,o=e.y,c=Oe.getColorForHash(n.name),u=c;r&&(c="black");var l=t/85,f={};return window.isNFT&&(f.filter="blur("+l+"px)"),r?s.a.createElement(A.Circle,{perfectDrawEnabled:!1,shadowForStrokeEnabled:!1,hitStrokeWidth:0,style:f,onMouseDown:function(e){return a(e.evt,n)},opacity:n.locked2D?.3:1,className:r?"star selected":"selected",x:Math.round(i),y:Math.round(o),radius:7,fill:c,stroke:u}):s.a.createElement(A.Circle,{shadowForStrokeEnabled:!1,hitStrokeWidth:0,perfectDrawEnabled:!1,style:f,opacity:n.locked2D?.3:1,onMouseDown:function(e){return a(e.evt,n)},className:r?"star selected":"selected",x:Math.round(i),y:Math.round(o),radius:7,fill:c})}),t.a=Object(d.b)(function(e,t){var n={};return t.effect._parameters.map(function(t){return n[t.id]=e.effects.effectParameters[t.id]}),t.effect._parameters.map(function(e){return n[e.id+"depth"]=e.depth}),Object(r.a)({},n,{macros:e.plane.macros[t.effect.id],parameterSelected:e.effects.accumulatorParameterSelected,bpm:t.effect.track.sequencerEngine.bpm,blur:t.effect.blurParameter.get(),selected:e.plane.selectedParameters[t.effect.id],filteredParameters:e.plane.filteredParameters[t.effect.id],macroToShow:e.plane.macroToShow[t.effect.id],isRegionMode:e.plane.regionMode[t.effect.id]})},function(e,t){return{setIsRegionMode:function(n){return e(Object(oe.ie)(t.effect.id,n))},setMacroToShow:function(n){return e(Object(oe.he)(t.effect.id,n))},setSelected:function(n){return e(Object(oe.kf)(t.effect.id,n))},setFilteredParameters:function(n){return e(Object(oe.mc)(t.effect.id,n))},setEffectParameterValues:function(t){return e(Object(oe.Vb)(t))},setParameterMinMax:function(t){return e(Object(oe.Qd)(t))}}})(function(e){var t=e.setParameterMinMax,n=e.effect,f=e.parameterSelected,h=e.setEffectParameterValues,p=e.sequencerEngine,d=e.macros,m=void 0===d?[]:d,v=e.filteredParameters,b=e.setFilteredParameters,g=e.selected,y=void 0===g?[]:g,k=e.setSelected,O=e.macroToShow,j=e.setMacroToShow,w=e.isRegionMode,E=e.setIsRegionMode,S=e.hideUI,P=Object(i.a)(e,["setParameterMinMax","effect","parameterSelected","setEffectParameterValues","sequencerEngine","macros","filteredParameters","setFilteredParameters","selected","setSelected","macroToShow","setMacroToShow","isRegionMode","setIsRegionMode","hideUI"]),x=Object(o.useState)(void 0),T=Object(a.a)(x,2),N=T[0],R=(T[1],Object(o.useRef)(void 0)),M=Object(o.useState)(!0),A=Object(a.a)(M,2),D=A[0],I=A[1],_=function(e){var t=Object(o.useState)(!1),n=Object(a.a)(t,2),r=n[0],i=n[1],s=Object(o.useState)(e.regions),c=Object(a.a)(s,2),u=c[0],l=c[1],f=Object(o.useState)(void 0),h=Object(a.a)(f,2),p=h[0],d=h[1],m=Object(o.useCallback)(function(e,t){r&&(e.stopPropagation(),d(t))},[d,r]);return Object(o.useEffect)(function(){d(void 0)},[d,r]),{setIsDensitiesMode:i,isDensitiesMode:r,densities:u,setDensities:l,selectedDensity:p,onClickDensity:m,setSelectedDensity:d}}(n),F=_.isDensitiesMode,L=(_.setIsDensitiesMode,_.onClickDensity,_.setSelectedDensity),B=_.selectedDensity,H=(_.densities,_.setDensities),U=ke({ref:R,setSelectedDensity:L,selected:y,setSelected:k,setDensities:H,effect:n,setEffectParameterValues:h,filteredParameters:v,isRegionMode:w,isDensitiesMode:F,macroToShow:O}),J=U.setDrawMode,X=U.drawMode,Q=U.selection,Y=U.startDragging,Z=U.onMouseDown,$=U.onMouseMove,ee=U.onMouseUp;Object(o.useEffect)(function(){y&&!v&&(0==y.length?j(void 0):O&&y[0].isPlaneMacro&&y[0]!==O&&j(y[0]))},[y,j,v,O]),Object(o.useEffect)(function(){if(v){var e=v.find(function(e){return e.planeMacro});e&&j(e.planeMacro)}},[v,j]);var te=function(e){var t=e.setIsRegionMode,n=e.parameterSelected,r=e.effect,a=e.selected,i=e.setSelected,s=Object(o.useCallback)(function(e){a.forEach(function(t){return t.locked2D=e}),i([])},[a]),c=Object(o.useCallback)(function(){var e=new Set;a.forEach(function(t){return e.add(t.hasGroup)});var t,n=void 0,o=V(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s&&(void 0===n?n=s:n._parameters.length<s._parameters.length&&(n=s))}}catch(c){o.e(c)}finally{o.f()}r.mergeIntoGroup(n,a),i(Object(u.a)(n._parameters))},[a,i]);return Object(o.useEffect)(function(){n&&r._parameters.includes(n)&&(a.includes(n)||i([n]))},[n,i,a]),Object(o.useEffect)(function(){0===a.length&&t(!1)},[a,t]),{mergeGroups:c,lock:s,locked:a.some(function(e){return e.locked2D}),grouped:a.some(function(e){return e.hasGroup})}}({effect:n,selected:y,setSelected:k,parameterSelected:f,setIsRegionMode:E}),re=te.mergeGroups,ce=(te.lock,te.locked,te.grouped),ue=function(e){return{onDropPreset:Object(o.useCallback)(function(t){t.stopPropagation();var n=e.track.sequencerEngine.state.presets.presetDragging;n&&e.dropPreset(n)},[e])}}(n).onDropPreset,fe=function(e){var t=e.selectedDensity,n=e.setDensities,r=e.effect,a=e.isRegionMode,i=e.filteredParameters,s=e.setSelected,c=e.selected,f=e.setFilteredParameters,h=e.sequencerEngine,p=e.setEffectParameterValues,d=e.setParameterMinMax;Object(o.useEffect)(function(){return window.addEventListener("keydown",m),function(){return window.removeEventListener("keydown",m)}},[s,a,c,i,r,t,n]);var m=Object(o.useCallback)(function(e){"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&r.id===r.track.sequencerEngine.state.effects.selectedEffect&&r===r.track.sequencerEngine.state.zobject.selectedZObject&&(Object(ae.a)(""+e.key)?b(parseInt(e.key)):"a"===e.key&&(e.metaKey||e.ctrlKey)?(y(),h.dispatch(Object(oe.uf)(r))):"Backspace"===e.key?(t?g():k(),h.dispatch(Object(oe.uf)(r))):"s"===e.key&&(e.metaKey||e.ctrlKey)?(e.preventDefault(),r.takeSnapshot(!0),h.dispatch(Object(oe.uf)(r))):"g"===e.key&&(e.metaKey||e.ctrlKey)?(O(),h.dispatch(Object(oe.uf)(r))):"ArrowLeft"===e.key?(e.preventDefault(),v("LEFT"),h.dispatch(Object(oe.uf)(r))):"ArrowRight"===e.key?(e.preventDefault(),v("RIGHT"),h.dispatch(Object(oe.uf)(r))):"ArrowUp"===e.key?(e.preventDefault(),v("UP"),h.dispatch(Object(oe.uf)(r))):"ArrowDown"===e.key&&(e.preventDefault(),v("DOWNW"),h.dispatch(Object(oe.uf)(r))))},[s,a,c,i,r,t]),v=Object(o.useCallback)(function(e){if(!(r.groups.some(function(e){return e.variations&&e.variations.length>0})||r.variations&&r.variations.length>0)){var t="LEFT"===e?-1:"RIGHT"===e?1:0,n="UP"===e?-1:"DOWNW"===e?1:0;if(a){t*=4,n*=4;var i,o={},s={},u=se(c);try{for(u.s();!(i=u.n()).done;){var f=i.value,h=(f.max-f.min)/l.c;if(f.min=Math.max(Math.min(f.min+h*t,f.originalMax),f.originalMin),f.max=Math.max(Math.min(f.max+h*t,f.originalMax),f.originalMin),o[f.id]={min:f.min,max:f.max},f.depthParameter){var m=f.depthParameter;h=(m.max-m.min)/l.c,m.min=Math.max(Math.min(m.min+h*t,m.originalMax),m.originalMin),m.max=Math.max(Math.min(m.max+h*t,m.originalMax),m.originalMin),o[m.id]={min:m.min,max:m.max}}s[f.id]=f.get(!0)}}catch(w){u.e(w)}finally{u.f()}d(o),p(o)}else{var v,b={},g=se(c);try{for(g.s();!(v=g.n()).done;){var y=v.value;if(!y.subMacros){var k=y.moveCoordinates(2*t,2*n),O=k.id,j=k.value;b[O]=j}}}catch(w){g.e(w)}finally{g.f()}p(b)}}},[a,c]),b=Object(o.useCallback)(function(e){t&&(t.viscosity=e,n(Object(u.a)(r.regions)))},[t,n]),g=Object(o.useCallback)(function(e){t&&(r.deleteDensity(t),n(Object(u.a)(r.regions)))},[t,n]),y=Object(o.useCallback)(function(){c&&c.length>0?s([]):s(i?Object(u.a)(i):Object(u.a)(r._parameters))},[s,c,i,r,f]),k=Object(o.useCallback)(function(){h.operationManager.dispatch(Object(ie.u)(r,c)),i&&f(i.filter(function(e){return!c.includes(e)})),s([])},[c,s,f,i,r]),O=Object(o.useCallback)(function(e){if(void 0===e&&(e=!c.some(function(e){return e.hasGroup})),e)r.groupParameters(c);else{var t=c.find(function(e){return e.hasGroup}).hasGroup;c.every(function(e){return e.group===e})?r.ungroup(t):r.ungroupParameters(c)}s(Object(u.a)(c))},[c,r,s]);return{unmap:k,group:O}}({selectedDensity:B,setDensities:H,effect:n,setSelected:k,selected:y,filteredParameters:v,setFilteredParameters:b,sequencerEngine:p,expanded:D,setEffectParameterValues:h,setParameterMinMax:t,isRegionMode:w}),me=fe.unmap,ve=fe.group;!function(e){var t=e.ref,n=e.effect,a=e.setEffectParameterValues,i=e.selected,s=e.isRegionMode,l=e.setSelected,f=e.selectedDensity,h=e.setDensities;Object(o.useEffect)(function(){return t.current.addEventListener("wheel",p,{passive:!1}),function(){t.current&&t.current.removeEventListener("wheel",p,{passive:!1})}},[i,s,l,n,h]);var p=Object(o.useCallback)(function(e){var t=e.wheelDelta;if(!(Math.abs(e.deltaX)>=.5)&&e.deltaY-Math.floor(e.deltaY)!==0&&Math.abs(t)>=50){if(console.log("preventing usewheel"),e.preventDefault(),e.stopPropagation(),he++%2!==0)return!1;if(s){var o=i.flatMap(function(e){return e.isPlaneMacro?e.parameters:e});return void d(o,t<0?-.1:.1)}f&&(t<0?n.expandDensitySize(f,.9):n.expandDensitySize(f,1.1),h(n.regions));var u={},l={};i.forEach(function(e){if(e.isPlaneMacro){var t,n=le(e.parameters);try{for(n.s();!(t=n.n()).done;){var r=t.value;l[r.id]=r,u[r.id]=r.getCoordinates()}}catch(a){n.e(a)}finally{n.f()}}else l[e.id]=e,u[e.id]=e.getCoordinates()});var p={};if(p=t<0?Object(c.j)(u,-.1):Object(c.j)(u,.1),0===Object.keys(p).length)return!1;var m=i[0]&&i[0].isRecording,v=Object.keys(p).map(function(e){return l[e].setCoordinates(p[e].x,p[e].y,void 0,void 0,m)}).reduce(function(e,t){return Object(r.a)({},de(t),e)},{});return a(v),!1}},[i,s,l,n,h]),d=Object(o.useCallback)(function(e,t){var r,i={},o=le(e);try{var s=function(){var e=r.value,a=e.min,o=e.max,s=e.originalMin,c=e.originalMax,u=pe(a,o,s,c,e.get(!0),t);if(e.min=u.min,e.max=u.max,n.currentSnapshot){var l=n.currentSnapshot.find(function(t){return t.parameter.id===e.id});l&&(l.min=u.min,l.max=u.max)}if(i[e.id]=e.get(!0),e.depthParameter){var f=e.depthParameter,h=f.min,p=f.max,d=f.originalMin,m=f.originalMax;u=pe(h,p,d,m,f.get(!0),t),f.min=u.min,f.max=u.max}};for(o.s();!(r=o.n()).done;)s()}catch(c){o.e(c)}finally{o.f()}a(i),l(Object(u.a)(e))},[l,i])}({ref:R,effect:n,setDensities:H,selectedDensity:B,setEffectParameterValues:h,selected:y,setSelected:k,isRegionMode:w});Q&&Math.abs(Q.y2-Q.y1),Q&&Math.abs(Q.x2-Q.x1);var be=v||n._parameters.filter(function(e){return O&&O===e.planeMacro||!e.planeMacro}),ge={};Object(q.a)(be).forEach(function(e,t){return ge[be[t].id]=e});var ye="plane-inner";return D&&(ye+=" expanded"),s.a.createElement("div",{onDrop:ue,className:ye},s.a.createElement("div",{className:"vertical-pane"},s.a.createElement("div",{className:"plane-container"},s.a.createElement("div",{draggable:!0,ref:R,onDragStart:function(e){return e.preventDefault()},onDragOver:function(e){return e.preventDefault()},onMouseDown:Z,onMouseUp:ee,onMouseMove:$,className:"plane-view"},s.a.createElement("div",{className:"y-axis"},"Modulation"),s.a.createElement("div",{className:"x-axis"},"Parameter Value"),s.a.createElement("svg",{className:"drawn-svg",height:l.a,width:l.c},!window.isNFT&&s.a.createElement(z,{drawnPath:n.currentPath,effect:n})),s.a.createElement(C,Object.assign({blur:P.blur,selectedColor:N,setMacroToShow:j,startDragging:Y,coords:ge,filteredParameters:v,parameters:be,macroToShow:O,setParameterMinMax:t,effect:n,parameterSelected:f,setEffectParameterValues:h,containerRef:R,selected:y,selection:Q,sequencerEngine:p,isRegionMode:w,macros:m},P)))),s.a.createElement(ne,{setSelected:k,isDraggable:P.isDraggable,drawMode:X,setDrawMode:J,isRegionMode:w,effect:n,setExpanded:I,expanded:D,setIsRegionMode:E,unmap:me,selected:y,mergeGroups:re,group:ve,grouped:ce},P.children)),!S&&D&&n.groups[0]&&n.groups[0].algorithm===c.g?s.a.createElement(W.a,{isDraggable:P.isDraggable,scriptType:G.a,expanded:!0,setExpanded:function(){n.scriptExpanded=void 0,I(void 0)},doc:K.a,sequencerEngine:p,effect:n.groups[0]}):"")})},function(e,t,n){"use strict";var r=n(28),a=n(8),i=n(11),o=n(0),s=n.n(o),c=(n(15),n(96)),u=3;function l(e,t){return t*c.c*e/2}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return void 0===e||null===e?0:(e.toFrequency&&(e=e.toFrequency()),e=(e-n)/(r-n),0===n&&(e=Math.sqrt(e)),Math.max(5,t-e*t-u))}function h(e,t){return 2*e/(c.c*t)}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=(t-(e+=u))/t;return 0===n&&(a=Math.pow(a,2)),Math.max(n,n+a*(r-n))}var d=function(e,t,n,r){if(0===e.automations.length){var a=n.toFrequency?n.toFrequency():n.get();return n.getNumberFromOption&&(a=n.getNumberFromOption(a)),{step:t,value:a}}var i=e.getClosestBefore(t);if(void 0===i)return{step:t,value:e.automations[0].value};var o=e.getNextEvent(i);if(void 0===o)return{step:t,value:e.automations[e.automations.length-1].value};o.step,i.step;var s=t-i.step,c=n.min,u=n.max,l=f(o.value,r,c,u),h=f(i.value,r,c,u);return{step:t,value:p(h+s*((l-h)/(o.step-i.step)),r,c,u)}},m=n(42),v=n(6),b=n(12),g=(s.a.createContext(),n(46)),y="#4f4d54",k=30;function O(e){var t=e.value,n=e.x,r=e.y,a=(e.height,e.selectedParameter);t=a.toFrequency?a.quantize(t).toNotation():a.getOptionFromNumber?a.getOptionFromNumber(t):Math.round(1e3*t)/1e3;var i=r<k?-5:-20,o=r<k?10:-5,c=r<k?r+20:r-20,u=[n,r+o,n-5,c,n+5,c];return[s.a.createElement("rect",{x:n-20,y:c+i,width:50,height:20,fill:y}),s.a.createElement("polygon",{points:u,fill:y}),s.a.createElement("text",{fill:"white",x:n-15,y:c+o,className:"automation-tooltip"},t.toString())]}var j=Object(o.memo)(function(e){var t=e.height,n=(e.width,e.xScale),r=e.isSelected,a=e.setAutomationPointHovered,i=e.setPointsSelected,c=e.isHovered,u=e.selectedParameter,h=e.point,p=e.sequencerEngine,d=e.track,m=e.operationManager,v=e.setGuidePoint,b=e.isDragging,y=e.setPointDragging,k=e.automation,j=Object(o.useCallback)(function(e){a(h),v(void 0)},[,v]),w=Object(o.useCallback)(function(e){a(void 0)},[]),E=Object(o.useCallback)(function(){var e=p.state.automation.pointDragging[d.id];p.state.automation.pointHasMoved[d.id]||(m.dispatch(Object(g.q)(k,e)),a(void 0))},[u,k]);if(void 0===u)return[];var S=l(h.step,n),P=f(h.value,t,u.min,u.max),x=r||c||b?"orange":"black",T=r||c||b?"orange":"red",C=c?5:3;return[s.a.createElement("ellipse",{onMouseDown:function(e){e.stopPropagation(),y(h),r||i([])},onMouseUp:E,onMouseOver:j,onMouseLeave:w,cx:S,cy:P,className:r?"selected automation-point":"automation-point",rx:C,ry:C,fill:x,strokeWidth:2,stroke:T}),b||c?s.a.createElement(O,{height:t,x:S,y:P,selectedParameter:u,value:h.value}):[]]}),w=Object(b.b)(null,function(e,t){return{setGuidePoint:function(n){return e(Object(v.T)(t.track.id,n))},setPointDragging:function(n){return e(Object(v.U)(t.track.id,n))},setPointsSelected:function(n){return e(Object(v.X)(t.track.id,n))},setAutomationPointHovered:function(n){return e(Object(v.W)(t.track.id,n))}}})(j),E=n(338),S=Object(E.a)([function(e){return e.width},function(e){return e.height},function(e){return e.selectedParameter},function(e){return e.xScale},function(e){return e.events}],function(e,t,n,r,a){return P(e,t,n,r,a)}),P=function(e,t,n,r,a){if(void 0===n)return[];var i=[];if(0===a.length||void 0===a[0]){var o=n.toFrequency?n.toFrequency():n.get();n.getNumberFromOption&&(o=n.getNumberFromOption(o)),i=[0,f(o,t,n.min,n.max)]}else i=[0,f(a[0].value,t,n.min,n.max)];for(var s in a){var c=l(a[s].step,r);void 0===a[s].value?n.get(!0):a[s].value;i.push(c),i.push(f(a[s].value,t,n.min,n.max))}i[i.length-2];var u=i[i.length-1];return i.push(e),i.push(u),i},x=n(29),T=new x.a;window.otherColor="#637475";var C=Object(o.memo)(function(e){e.automation;var t=e.track,n=(e.sequencerEngine,e.pointHovered,e.pointsSelected,e.pointDragging,e.xScale),r=e.color,a=e.isMix,i=e.height,o=e.selectedParameter,c=(e.setGuidePoint,e.width),u=t.getAllParameters().filter(function(e){return e.automations.length>0}).filter(function(e){return e!==o});return(u=u.slice(0,4)).map(function(e){return S({width:c,height:i,selectedParameter:e,xScale:n,events:a?e.mixAutomation.automations:e.automations})}).map(function(e,t){return s.a.createElement("polyline",{key:"line-"+t,strokeWidth:1,points:e.join(","),stroke:T.brighten(r,.6)})})}),N=Object(b.b)(null,null)(C);window.selectionColor="#47413c";var R=Object(b.b)(function(e,t){return{selection:e.automation.selection[t.track.id]}},null)(function(e){if(void 0===e.selection)return[];var t=e.selection,n=t.x,r=t.y,a=t.height,i=t.width;return s.a.createElement("rect",{className:"automation-selection",x:n,y:r,height:a,width:i,fill:window.selectionColor})}),M=n(9);window.guideColor="#272a2e";var A=Object(o.memo)(function(e){var t=e.height,n=(e.xScale,e.width),r=e.selectedParameter;e.track;if(void 0===r)return[];for(var a=r.min,i=r.max,o=[],c=(i-a)/10,u=0;u<10;u++){var l=f(a+c*u,t,a,i);o.push(l)}var h=f(r.config.defaultValue,t,a,i);return[].concat(Object(M.a)(o.map(function(e){return s.a.createElement("line",{x1:0,y1:e,x2:n,y2:e,stroke:window.guideColor,strokeWidth:1})})),[s.a.createElement("line",{x1:0,y1:h,x2:n,y2:h,stroke:"#3e434a",strokeWidth:1})])}),q=n(5),D=n.n(q),I=n(14),_=n(45),F=(Object(o.memo)(function(e){e.height,e.xScale,e.isDragging,e.selectedParameter,e.sequencerEngine,e.pointHasMoved,e.operationManager,e.automation,e.automations;return s.a.createElement(m.Layer,{pixelRatio:1})}),n(1073));new x.a;window.otherColor="#637475";var L=Object(o.memo)(function(e){var t=e.isMix,n=e.automation,r=e.track,a=e.sequencerEngine,i=e.automations,c=e.pointHovered,u=e.pointsSelected,l=void 0===u?[]:u,f=e.pointDragging,d=e.xScale,m=(e.color,e.height),v=e.selectedParameter,b=e.setGuidePoint,g=e.wrapperRef,y=e.width,k=i||[];k.forEach(function(e,t){return e.duration=k[t+1]?k[t+1].step-e.step:1});var O=Object(F.a)({ref:g,events:k,xScale:d,resolution:a.state.sequencer.resolution,sequencerEngine:a,eventsLength:k.length}).visibleView;O.start&&(k=k.slice(O.start,O.end));var j=S({width:y,height:m,selectedParameter:v,xScale:d,events:k});Object(o.useCallback)(function(e){var n=t?e.clientX-140:e.clientX-56;n+=g.current.scrollLeft;var r=e.clientY,a=h(n,d),i=p(r,m,v.min,v.max);b({step:a,value:i})},[b,v,m,d]);return[s.a.createElement("polyline",{strokeWidth:2,points:j.join(","),stroke:"red"})].concat(Object(M.a)(k.map(function(e){return s.a.createElement(w,{key:"automation-"+e.id,sequencerEngine:a,operationManager:a.operationManager,track:r,isHovered:c===e,isDragging:f&&f.id===e.id,automation:n,width:y,isSelected:l.some(function(t){return e.id===t.id}),point:e,height:m,xScale:d,selectedParameter:v})})))}),B=Object(b.b)(function(e,t){var n=t.selectedParameter,r=n&&n.sequencerEngine.sequenceId,a=t.isMix?e.automation.parameterMixAutomations[r]:e.automation.parameterAutomations[r],i=t.track;return{automations:n&&a?a[n.id]:void 0,pointHovered:e.automation.pointHovered[i.id],pointDragging:e.automation.pointDragging[i.id],pointsSelected:e.automation.pointsSelected[i.id]}},function(e,t){return{setGuidePoint:function(n){return e(Object(v.T)(t.track.id,n))}}})(L),z=function(e){var t;return t={guidePoint:void 0,selectedPoint:void 0,pointHasMoved:void 0,pointDragging:void 0},Object(r.a)(t,"guidePoint",void 0),Object(r.a)(t,"automations",e?e.automations:[]),t},V=function(e,t){switch(t.type){case"setGuidePoint":return Object(a.a)({},e,{guidePoint:t.payload});case"setSelectedPoint":return Object(a.a)({},e,{selectedPoint:t.payload});case"setPointHasMoved":return Object(a.a)({},e,{pointHasMoved:t.payload});case"setPointDragging":return Object(a.a)({},e,{pointDragging:t.payload});case"setAutomations":return Object(a.a)({},e,{automations:t.payload});case"setGuidePoint":return Object(a.a)({},e,{guidePoint:t.payload});default:return e}},H=Object(o.memo)(function(e){var t=e.setPointDragging,n=e.setPointHasMoved,r=e.setPointsSelected,a=e.track,i=e.guidePoint,c=e.selectedParameter,u=e.xScale,p=e.dispatch,d=e.pointDragging,v=e.height,b=e.width,y=e.isMix,k=e.wrapperRef,O=e.clearGuidePoint,j=Object(o.useCallback)(function(){var e=Object(I.a)(D.a.mark(function e(i){var o,s,l,f,d,m;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.stopPropagation(),o=a.sequencerEngine.operationManager,s=y?i.clientX-140+k.current.scrollLeft:i.clientX-56+k.current.scrollLeft,l=h(s,u),f=y?c.mixAutomation.getValueAtStep(l):c.automation.getValueAtStep(l),e.next=7,o.dispatch(Object(g.a)(y?c.mixAutomation:c.automation,l,f,Object(_.uuid)()));case 7:d=e.sent,m=d&&d.point,p({type:"setSelectedPoint",payload:m}),O(),n(!0),r([]),t(m);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[b,O,c,u,p]);if(void 0===i||void 0===c||void 0!==d)return s.a.createElement(m.Layer,null,s.a.createElement(m.Rect,{x:0,y:0,width:0,height:0}));var w=l(i.step,u),E=f(i.value,v,c.min,c.max);return s.a.createElement("ellipse",{onMouseDown:j,cx:w,cy:E,rx:4,ry:4,fill:"#5802d9",stroke:"#5802d9",strokeWidth:2})}),U=Object(b.b)(function(e,t){return{guidePoint:e.automation.guidePoint[t.track.id]}},function(e,t){return{clearGuidePoint:function(){return e(Object(v.T)(t.track.id,void 0))},setPointDragging:function(n){return e(Object(v.U)(t.track.id,n))},setPointsSelected:function(n){return e(Object(v.X)(t.track.id,n))},setPointHasMoved:function(n){return e(Object(v.V)(t.track.id,n))}}})(H);n(2423);t.a=Object(b.b)(function(e,t){var n=e.automation.trackParameter[t.track.id];return{numEffects:t.track.effects&&t.track.effects.length,height:t.height||e.arrangement.bottomHeight-250,selectedDevice:e.automation.trackDevice[t.track.id],selectedParameter:n,automation:n&&(t.isMix?n.mixAutomation:n.automation)}},function(e,t){return{setPointDragging:function(){return e(Object(v.U)(t.track.id,void 0))},setGuidePoint:function(n){return e(Object(v.T)(t.track.id,n))},setPointHasMoved:function(n){return e(Object(v.V)(t.track.id,n))},setSelection:function(n){return e(Object(v.Y)(t.track.id,n))},setSelectedPoints:function(n){return e(Object(v.X)(t.track.id,n))}}})(function(e){var t,n=e.track.sequencerEngine,c=n.operationManager,u=e.wrapperRef,f=Object(o.useRef)(void 0),m=Object(o.useRef)(void 0),v=e.setGuidePoint,b=e.setPointHasMoved,y=e.selectedParameter,k=e.height,O=e.automation,j=e.track,w=e.xScale,E=Object(o.useReducer)(V,e.automation,z),S=Object(i.a)(E,2),P=S[0],x=S[1],T=Object(o.useState)(e.left||56),C=Object(i.a)(T,2),M=C[0],q=(C[1],P.selectedPoint,e.width||j.pattern&&l(j.pattern.length(),w)||0),D=Object(o.useCallback)(function(t){var n=f.current.getBoundingClientRect(),r=t.clientX-M+u.current.scrollLeft,a=t.clientY-n.top;e.setSelection({x:r,y:a,height:0,width:0})},[F,M]),I=Object(o.useCallback)(function(t){if(void 0!==y){var r=n.state.automation,i=r.pointDragging,o=r.selection,s=r.pointsSelected,l=r.pointHovered;i=i[j.id],o=o[j.id],s=s[j.id]||[],l=l[j.id];var m=f.current.getBoundingClientRect().top,E=t.clientX-M+u.current.scrollLeft,S=t.clientY-m;if(i){var P=h(E,e.xScale),x=p(S,k,y.min,y.max);if(s.length>0){var T=P-i.step,C=x-i.value;c.dispatch(Object(g.j)(e.automation,s,T,C))}else c.dispatch(Object(g.k)(e.automation,i,P,x));b(!0)}else if(o){var N=E-o.x,R=S-o.y;e.setSelection(Object(a.a)({},o,{width:N,height:R}))}else if(void 0===l){var A=h((e.isMix?t.clientX-e.left:t.clientX-56)+u.current.scrollLeft,w),q=O.getValueAtStep(A),D=O.getDistanceToClosest({step:A,value:q}),I=D.distance;if(D.point,I<.1)v(void 0);else{var _=d(O,A,y,k);v(_)}}}},[O,w,j,y,k,b,v,M,q]);Object(o.useEffect)(function(){return function(){return e.setSelectedPoints([])}},[y]);var _=Object(o.useCallback)(function(){var t=n.state.automation,r=t.pointDragging,a=t.pointHasMoved,i=t.selection,o=t.pointsSelected;if(r=r[j.id],a=a[j.id],i=i[j.id],o=o[j.id]||[],r&&a)F();else{if(i&&y&&!e.isMix){var s=i,c=s.x,u=s.y,l=s.width,f=s.height,d=y.min,m=y.max,v=h(c,w),b=p(u,e.height,d,m),g=h(c+l,w),k=p(u+f,e.height,d,m),E=O.getSelectedPoints(Math.min(v,g),Math.min(b,k),Math.max(g,v),Math.max(b,k));e.setSelectedPoints(E),e.setSelection(void 0)}F()}},[F,y,O,w,e.height,j,e.isMix]),F=Object(o.useCallback)(function(){e.setGuidePoint(void 0),e.setPointDragging(void 0),e.setSelection(void 0),b(!1)},[]);return void 0===y&&e.isMix?[]:s.a.createElement("div",{style:{width:q},onMouseUp:_,ref:m,onMouseLeave:F,id:"automation-svg-container",className:"parameter-automation"},s.a.createElement("svg",{ref:f,pixelRatio:1,width:q,height:k,onMouseMove:I,onMouseDown:D},e.isMix?"":s.a.createElement(R,{track:j}),s.a.createElement(A,{width:q,selectedParameter:y,height:k,xScale:w}),e.isMix?"":s.a.createElement(N,{track:j,color:e.color,sequencerEngine:n,selectedParameter:y,xScale:w,isMix:e.isMix,width:q,height:k}),s.a.createElement(B,{wrapperRef:u,isMix:e.isMix,track:j,color:e.color,sequencerEngine:n,automation:O,selectedParameter:y,xScale:w,width:q,height:k}),s.a.createElement(U,(t={width:q,isMix:e.isMix,wrapperRef:u,selectedParameter:y,track:e.track,dispatch:x,xScale:w},Object(r.a)(t,"width",q),Object(r.a)(t,"height",k),t))))})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(6),s=n(52),c=n(12),u=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){e.favorited;var t=e.setViewMode,n=e.viewMode,r=(e.setFavorited,e.starred,e.setStarred,e.setFilterMine),a=e.filterMine,o=e.setOld,s=e.old;return i.a.createElement("div",{className:"search-options"},i.a.createElement("div",{onClick:function(){return r(!0)},className:a?"selected search-option":"search-option"},"My Projects"),i.a.createElement("div",{onClick:function(){return r(!1)},className:a?"search-option":"selected search-option"},"All Projects"),i.a.createElement("div",{onClick:function(){return o(!s)},className:s?"selected search-option":"search-option"},"Old"),i.a.createElement("div",{className:"view-modes"},i.a.createElement("div",{onClick:function(){return t("LIST")},className:"LIST"===n?"selected view-mode":"view-mode"},i.a.createElement("img",{src:"/list-icon.svg"})),i.a.createElement("div",{onClick:function(){return t("GRID")},className:"GRID"===n?"selected view-mode":"view-mode"},i.a.createElement("img",{src:"/grid-icon.svg"}))))}),l=n(9),f=n(46),h=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.color,r=e.patternNumber,a=t.patterns[r];if(!a)return[];var o=new Array(Math.min(16,a.size/2)).fill(0);return i.a.createElement("div",{className:"track-steps"},o.map(function(e,t){return i.a.createElement("div",{style:a[2*t]?{backgroundColor:n}:{},className:"track-step"})}))}),p=function(e){var t=e.pattern,n=e.isCurrent,r=e.setPatternNumber,a="mini-pattern-btn";return n&&(a+=" current"),i.a.createElement("div",{className:a,onClick:function(){return r(t)}},t+1)},d=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.patternNumber,n=e.setPatternNumber,r=e.patterns,a=new Array(r).fill(0);return i.a.createElement("div",{className:"pattern-numbers"},a.map(function(e,r){return i.a.createElement(p,{pattern:r,isCurrent:t===r,setPatternNumber:n})}))}),m=["A","B","C","D","E","F","G","H"],v=function(e){var t=e.subSequence,n=e.isCurrent,r=e.setSubSequence,a="mini-subsequence-btn";return n&&(a+=" current"),i.a.createElement("div",{className:a,onClick:function(){return r(t)}},m[t])},b=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.subSequence,n=e.setSubSequence,r=e.subSequences,a=new Array(r).fill(0);return i.a.createElement("div",{className:"subsequence-buttons"},a.map(function(e,r){return i.a.createElement(v,{subSequence:r,isCurrent:t===r,setSubSequence:n})}))}),g=n(29),y=(new g.a,Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.color,r=e.onClick,a=e.isSelected,o={backgroundColor:n};if(t.sample){var s=t.sample.getThumbnail();s&&""!==s&&(console.log("url = ",s),o.backgroundImage="url("+s+")")}return i.a.createElement("div",{onClick:r,style:o,className:a?"mini-thumbnail selected":"mini-thumbnail"})})),k=n(5),O=n.n(k),j=n(14),w=n(47),E=n(30),S=function(){var e=Object(j.a)(O.a.mark(function e(t){var n,r,a;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.guildSequences.getGuildSequence(t);case 2:if(void 0!==(n=e.sent)||!s.a.isLoggedIn()){e.next=8;break}return e.next=6,E.a.encryption.getSequencesSharedWithUser(t);case 6:n=(n=e.sent)[0];case 8:if(void 0===n){e.next=15;break}return e.next=11,E.a.crypto.fetchAndDecrypt(t,n);case 11:return r=e.sent,e.abrupt("return",JSON.parse(r));case 15:return e.next=17,E.a.encryption.getEncryptedSequenceIfAny(t);case 17:if(void 0===(a=e.sent)){e.next=24;break}return e.t0=JSON,e.next=22,E.a.crypto.fetchAndDecrypt(t,a);case 22:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 24:return e.abrupt("return",w.a.getJson(t));case 25:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),P=(n(423),n(69)),x=n(55),T=n(75);function C(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=function(){var e=Object(j.a)(O.a.mark(function e(t){var n,r,a,i,o,s;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t);case 2:n=e.sent,r=[],a=C(n.subSequences),e.prev=5,a.s();case 7:if((i=a.n()).done){e.next=15;break}return o=i.value,e.next=11,M(o);case 11:s=e.sent,r.push(s);case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:return e.abrupt("return",r);case 24:case"end":return e.stop()}},e,null,[[5,17,20,23]])}));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(j.a)(O.a.mark(function e(t){var n,r,a,i,o,s,c,u,l,f,h,p;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=0,a=C(t.tracksData),e.prev=3,a.s();case 5:if((i=a.n()).done){e.next=30;break}if(o=i.value,s=o.type,c=o.instrumentType,u=o.presetName,l=o.samplers,f=Object.keys(l),h={type:s,instrumentType:c,name:u||P.d[c]},s===x.e&&(h.name="Multi Freeze"),!(f.length>0)){e.next=17;break}return p=new T.a(f[0]),e.next=15,p.fetchMetadata();case 15:h.name=p.name,h.sample=p;case 17:h.patterns=t.tracks[r],h.patternParameters=t.tracksPatterns[r],h.trackEffects=t.tracksEffectsChains[r][0],h.trackMidiEffects=t.tracksMidiEffects[r],h.trackLiveEffects=t.tracksLiveEffects[r],h.parameters=t.tracksParameters[r],h.trackData=t.tracksData[r],h.envelopes=t.envelopes,h.lfos=t.lfos,n.push(h),r++;case 28:e.next=5;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(3),a.e(e.t0);case 35:return e.prev=35,a.f(),e.finish(35);case 38:return e.abrupt("return",n);case 39:case"end":return e.stop()}},e,null,[[3,32,35,38]])}));return function(t){return e.apply(this,arguments)}}(),A=new g.a,q=["A","B","C","D","E","F","G","H"],D=function(e){e.loadModule;var t=e.sub,n=(e.moduleName,e.patternNumber),r=e.onClickTrack,o=e.selectedTracks,s=e.sequencerEngine;Object(a.useCallback)(function(){s.operationManager.dispatch(Object(f.i)(o.length>0?o:t,n))},[o,n,t]);return i.a.createElement("div",{className:"sub"},t.map(function(e){return i.a.createElement(I,{onClick:function(){return r(e)},isSelected:o.includes(e),patternNumber:n,track:e})}))},I=function(e){var t=e.track,n=e.patternNumber,r=e.onClick,a=e.isSelected,o=t.sample?t.sample.getId():t.name,s=o?A.getColorForHash(o):"red";return i.a.createElement("div",{className:"mini-track"},i.a.createElement(y,{isSelected:a,onClick:r,color:s,track:t}),i.a.createElement("div",{className:"track-name"},_(t.name)),i.a.createElement(h,{color:s,track:t,patternNumber:n}))},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e&&e.length>t?e.slice(0,t)+"...":e},F=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.project,o=Object(a.useState)(0),s=Object(r.a)(o,2),c=s[0],u=s[1],f=Object(a.useState)(0),h=Object(r.a)(f,2),p=h[0],m=h[1],v=Object(a.useState)(void 0),g=Object(r.a)(v,2),y=g[0],k=g[1],O=Object(a.useState)([]),j=Object(r.a)(O,2),w=j[0],E=j[1],S=Object(a.useCallback)(function(e){void 0===e?t.loadSequence(n.newSequence):t.loadSequence(n.newSequence,parseInt(e))},[n]);Object(a.useEffect)(function(){R(n.newSequence).then(k)},[k]);var P=Object(a.useCallback)(function(e){w.includes(e)?E(w.filter(function(t){return t!==e})):E([].concat(Object(l.a)(w),[e]))},[w,E]);return y&&0!==y.length?i.a.createElement("div",{className:"expanded-project"},i.a.createElement("div",{className:"expanded-toolbar"},y[0]&&y[0][0]&&i.a.createElement(d,{patterns:y[0][0].patterns.length,patternNumber:c,setPatternNumber:u}),i.a.createElement(b,{subSequences:y.length,subSequence:p,setSubSequence:m}),i.a.createElement("div",{onClick:function(){return S()},className:"load-project-btn"},"Load Entire Project")),i.a.createElement(D,{loadModule:function(){return S(p)},sequencerEngine:t,onClickTrack:P,selectedTracks:w,patternNumber:c,moduleName:q[p],sub:y[p]})):[]}),L=n(202),B=n(334),z=n(696);n(2706);function V(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var U=new g.a,J=E.a.presets,G=function(){var e=Object(j.a)(O.a.mark(function e(t){var n,r,a,i;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={},r=V(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=11;break}return i=a.value,e.next=8,J.getPresetTitle(i);case 8:n[i]=e.sent;case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}},e,null,[[2,13,16,19]])}));return function(t){return e.apply(this,arguments)}}(),W=Object(c.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.projectHash,n=e.metadata,o=n&&n.thumbnail?w.a.getHashUrl(n.thumbnail):void 0,s=Object(a.useState)({}),c=Object(r.a)(s,2),u=c[0],l=c[1],f=Object(a.useState)([]),h=Object(r.a)(f,2),p=h[0],d=h[1];return Object(a.useEffect)(function(){n&&n.presets&&G(n.presets).then(l)},[n,l]),Object(a.useEffect)(function(){n&&n.samples&&0!==n.samples.length&&Object(z.a)(n.samples,t).then(function(e){return d(e.filter(function(e){return e.name}))})},[n,d,t]),n?i.a.createElement("div",{className:"project-metadata"},o&&i.a.createElement("img",{src:o,className:"project-thumbnail"}),Object.keys(u).length>0&&i.a.createElement("div",{className:"presets"},Object.keys(u).map(function(e){return i.a.createElement("div",{className:"preset-name"},i.a.createElement("div",{className:"dot",style:{backgroundColor:U.getColorForHash(e)}}),u[e])})),p.length>0&&i.a.createElement("div",{className:"samples"},p.map(function(e){return i.a.createElement("div",{className:"sample-name"},Object(B.a)(e.tags[0]||e.name))}))):""}),K=n(1464),X=(n(1535),n(655)),Q=n(654),Y=new g.a,Z=Object(c.b)(function(e,t){return{}},function(e){return{setShowProjectsModal:function(t){return e(Object(o.ag)(t))}}})(function e(t){var n=t.project,o=t.sequencerEngine,s=t.expanded,c=t.odd,u=t.setExpandedProject,l=t.setShowProjectsModal,f=t.viewMode,h=Object(a.useState)(void 0),p=Object(r.a)(h,2),d=p[0],m=p[1],v=Object(a.useState)(void 0),b=Object(r.a)(v,2),g=b[0],y=b[1],k=Object(a.useState)(""),w=Object(r.a)(k,2),S=w[0],P=w[1],x=Object(a.useState)([]),T=Object(r.a)(x,2),C=T[0],N=T[1],R=Object(a.useState)(void 0),M=Object(r.a)(R,2),A=M[0],q=M[1],D=Object(a.useState)(void 0),I=Object(r.a)(D,2),_=(I[0],I[1],Object(a.useState)("")),F=Object(r.a)(_,2),L=F[0],B=F[1];n.id=n.newSequence;var z=Object(K.a)({track:n}),V=z.isFavorited,H=z.isStarred;Object(a.useEffect)(function(){n.guildId?E.a.guildSequences._decryptQueryResult(n).then(function(e){return B(e.title)}):B(n.title)},[n,B]),Object(a.useEffect)(function(){g?function(e){return new Promise(function(){var t=Object(j.a)(O.a.mark(function t(n,r){var a;return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("getting edits for project=",e),a={project:e},fetch("/projectEdits/",{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){n(e)});case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}(n.newSequence).then(function(e){console.log("edits for project = ",n.title,e),N(e)}):N([])},[g,n]),Object(a.useEffect)(function(){E.a.users.getUserName(n.user).then(function(e){return P(e||n.user)}),Object(Q.a)(n.blockNumber).then(function(e){return m(e)}),n.guildId?E.a.guilds.getGuildName(n.guildId).then(q):q(void 0)},[n,P,m]);var U=Object(a.useCallback)(function(){s?(l(!1),o.loadSequence(n.newSequence)):u(n)},[u,n,s]),J={color:S?Y.getColorForHash(S):""},G=(S&&Y.getColorForHash(S),{});A&&(G.color=Y.getColorForHash(A));var Z="project-option";s&&(Z+=" expanded"),n.metadata&&(Z+=" has-metadata");var $=i.a.createElement("div",{className:Z},i.a.createElement("div",{className:"project-name"},L),i.a.createElement("div",{style:J,className:"project-author"},S),n.edits>0?i.a.createElement("div",{onClick:function(){return y(!g)},className:g?"edits-btn showing":"edits-btn"},n.edits," Edits"):"",V?i.a.createElement("div",{className:"heart favorited"}):"",H?i.a.createElement("div",{className:"star starred"},i.a.createElement("span",null,"\u2606")):"",i.a.createElement("div",{className:"project-bpm"},i.a.createElement("div",{style:{width:60*Math.min(1,n.bpm/200)},className:"bpm-slider"}),i.a.createElement("div",{className:"bpm-text"},"BPM: ",n.bpm)),i.a.createElement("div",{className:"project-date"},d?Object(X.a)(d):""),n.contentKey?i.a.createElement("div",{className:"private-project"},"Private"):"",A?i.a.createElement("div",{style:G,className:"project-guild"},A):"",n.isLocal?i.a.createElement("div",{className:"local-only"},"Not Synced"):"");if(g)return i.a.createElement("div",{className:"expanded-project"},$,i.a.createElement("div",{className:"project-edits"},C.map(function(t){return i.a.createElement(e,{setExpandedProject:u,expanded:s,project:t,sequencerEngine:o})})));var ee=n.metadata?"project-option-wrapper has-metadata":"project-option-wrapper";return c&&(ee+=" odd"),"GRID"===f&&(ee+=" pushable"),i.a.createElement("div",{onClick:U,className:ee},$,i.a.createElement(W,{projectHash:n.newSequence,metadata:n.metadata}))}),$=n(355),ee=n(900),te=Object(c.b)(function(e,t){return{guildId:e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0}},function(e){return{}})(function(e){var t=e.guildId,n=e.viewMode,o=e.sequencerEngine,s=e.searchTerm,c=e.filterMine,u=e.setExpandedProject,l=e.expandedProject,f=e.starred,h=e.favorited,p=e.old,d=Object(a.useState)([]),m=Object(r.a)(d,2),v=m[0],b=m[1],g=Object(a.useState)(!1),y=Object(r.a)(g,2),k=y[0],O=y[1],j=Object(a.useRef)(void 0),w=Object($.a)(j,24,!0,s,l).size;Object(a.useEffect)(function(){l||(O(!0),Object(ee.a)(s,c,f,h,void 0,void 0,t,void 0,p).then(function(e){O(!1),"GRID"===n&&(e=e.filter(function(e){return e.metadata&&e.metadata.thumbnail})),b(e)}))},[n,s,p,b,c,O,l,f,h,t]);var E={height:window.innerHeight-216},S=l?"has-expanded-project sequences-list":"sequences-list";return"GRID"===n&&(S+=" grid-mode"),i.a.createElement("div",{ref:j,style:E,className:S},k?i.a.createElement(L.a,{text:"Loading Projects"}):l?i.a.createElement("div",{className:"project-and-back"},i.a.createElement("div",{onClick:function(){return u(void 0)},className:"selector-back-button"}),i.a.createElement(Z,{setExpandedProject:u,viewMode:n,sequencerEngine:o,project:l,expanded:!0})):v.slice(0,w).map(function(e,t){return i.a.createElement(Z,{viewMode:n,odd:t%2===1,key:t+"-"+e.newSequence,setExpandedProject:u,sequencerEngine:o,project:e})}),l?i.a.createElement(F,{project:l,sequencerEngine:o}):"")}),ne=n(1111);t.a=Object(c.b)(function(e,t){return{expandedProject:e.selector.expandedProject}},function(e){return{setExpandedProject:function(t){return e(Object(o.ec)(t))}}})(function(e){var t=Object(a.useState)(""),n=Object(r.a)(t,2),o=n[0],c=n[1],l=Object(a.useState)(s.a.isLoggedIn()),f=Object(r.a)(l,2),h=f[0],p=f[1],d=Object(a.useState)(!1),m=Object(r.a)(d,2),v=m[0],b=m[1],g=Object(a.useState)("LIST"),y=Object(r.a)(g,2),k=y[0],O=y[1],j=Object(a.useState)(!1),w=Object(r.a)(j,2),E=w[0],S=w[1],P=Object(a.useState)(!1),x=Object(r.a)(P,2),T=x[0],C=x[1],N=e.setExpandedProject,R=e.expandedProject,M=Object(a.useCallback)(function(e){c(e)},[c]);return i.a.createElement("div",{className:"new-selector sequences"},i.a.createElement("div",{className:"search-and-back"},i.a.createElement(ne.a,{onChange:M,hideFilter:!0})),R?"":i.a.createElement(u,{viewMode:k,setViewMode:O,favorited:v,old:E,setOld:S,starred:T,setFavorited:b,setStarred:C,setFilterMine:p,filterMine:h}),i.a.createElement(te,{expandedProject:R,viewMode:k,setExpandedProject:N,sequencerEngine:e.sequencerEngine,old:E,favorited:v,starred:T,searchTerm:o,filterMine:h}))})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(11),o=n(90),s=n.n(o),c=n(6),u=n(12),l=Object(u.b)(function(e,t){return{loops:e.freeze.loops}},function(e){return{setLoopsToFreeze:function(t){return e(Object(c.cd)(t))}}})(function(e){var t=e.loops,n=e.setLoopsToFreeze;return a.a.createElement("div",null,a.a.createElement("div",{className:"parameter-label"},"Loops To Freeze: ",t),a.a.createElement(s.a,{value:Math.log2(t),change:function(e){return n(Math.pow(2,e.target.value))},step:1,max:6,min:0,orientation:"horizontal",reversed:!1}))}),f=Object(u.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.input,n=e.midiEngine,o=e.syncedInput,s=e.setSyncedInput,c=Object(r.useState)(n.isInputTracked(t)),u=Object(i.a)(c,2),l=u[0],f=u[1],h=o===t,p=Object(r.useCallback)(function(){n.isInputSynced(t)?(n.unsyncInput(t),s(void 0)):(n.syncInput(t),s(t))},[s]),d=Object(r.useCallback)(function(e){n.isInputTracked(t)?n.untrackInput(t):n.trackInput(t),f(!l)},[f,l]);return a.a.createElement("div",{className:"midi-input"},a.a.createElement("div",{className:"midi-name"},t.name),a.a.createElement("div",{className:"midi-options"},a.a.createElement("div",{onClick:d,className:l?"midi-option enabled":"midi-option"},"TRACK"),a.a.createElement("div",{onClick:p,className:h?"midi-option enabled":"midi-option"},"SYNC")))}),h=Object(u.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.output,n=e.midiEngine,o=e.syncedOutput,s=e.setSyncedOutput,c=Object(r.useState)(n.isOutputTracked(t)),u=Object(i.a)(c,2),l=u[0],f=u[1],h=o===t,p=Object(r.useCallback)(function(){n.isOutputSynced(t)?(n.unsyncOutput(t),s(void 0)):(n.syncOutput(t),s(t))},[s]),d=Object(r.useCallback)(function(e){n.isOutputTracked(t)?n.untrackOutput(t):n.trackOutput(t),f(!l)},[f,l]);return a.a.createElement("div",{className:"midi-input"},a.a.createElement("div",{className:"midi-name"},t.name),a.a.createElement("div",{className:"midi-options"},a.a.createElement("div",{onClick:d,className:l?"midi-option enabled":"midi-option"},"TRACK"),a.a.createElement("div",{onClick:p,className:h?"midi-option enabled":"midi-option"},"SYNC")))}),p=Object(u.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine.midi,n=Object(r.useState)(t.systemInput),o=Object(i.a)(n,2),s=o[0],c=o[1],u=Object(r.useState)(t.systemOutput),l=Object(i.a)(u,2),p=l[0],d=l[1],m=t.getInputs(),v=t.getOutputs();return a.a.createElement("div",{className:"midi-settings"},a.a.createElement("div",{className:"midi-header"},"Input:"),m.map(function(e){return a.a.createElement(f,{midiEngine:t,syncedInput:s,setSyncedInput:c,input:e})}),a.a.createElement("div",{className:"midi-header"},"Output:"),v.map(function(e){return a.a.createElement(h,{midiEngine:t,syncedOutput:p,setSyncedInput:d,output:e})}))}),d=n(94),m=(n(15),n(39)),v=n.n(m),b="interactive",g=[b,"balanced","playback"].map(function(e){return{label:e,value:e}}),y=function(e){return{label:e,value:e}},k=Object(u.b)(function(e,t){return{latencyHint:t.sequencerEngine.latencyHint}},function(e){return{}})(function(e){var t=Object(r.useState)(e.latencyHint||b),n=Object(i.a)(t,2),o=n[0],s=n[1],c=Object(r.useState)(!1),u=Object(i.a)(c,2),l=u[0],f=u[1],h=Object(r.useCallback)(function(t){t=t.value,d.a.setItem("latencyHint",t),s(t),e.sequencerEngine.save("Test","PUBLIC",!1),f(!0)},[s,l]);return a.a.createElement("div",{className:"sample-rate-chooser"},a.a.createElement("div",{className:"dropdown-title"},"Latency Hint:"),a.a.createElement(v.a,{className:"audio-input-chooser-dropdown",controlClassName:"audio-input-chooser-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:g,onChange:h,value:y(o),placeholder:"Audio Input"}),l?a.a.createElement("div",{className:"needs-reload"},"Reload page to use new latency hint"):"")}),O=n(1078),j=n(1462),w=function(e){return a.a.createElement("div",{onClick:function(){return e.onClick(!e.isMultiChannelOutput)},className:"audio-outputs-option"},e.isMultiChannelOutput?"MULTI CHANNEL OUTPUT ":"SINGLE OUTPUT ","(",e.numberOfChannels," channels)")},E=Object(u.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=Object(r.useState)(void 0),o=Object(i.a)(n,2),s=(o[0],o[1]),c=Object(r.useState)(!t.channelMixer.stereoConnected),u=Object(i.a)(c,2),l=u[0],f=u[1],h=Object(r.useCallback)(function(e,n){t.audioInputManager.newInputSource(e,n),s(n)},[s]),p=Object(r.useCallback)(function(e){t.channelMixer.switchOutputs(e),f(e)},[f]);return a.a.createElement("div",{className:"audio"},a.a.createElement(j.a,{sequencerEngine:t}),a.a.createElement(k,{sequencerEngine:t}),a.a.createElement(O.a,{deviceId:t.audioInputManager.deviceId,defaultClassName:"preferences-audio-chooser",onChooseAudio:h}),a.a.createElement(w,{isMultiChannelOutput:l,numberOfChannels:t.channelMixer.numberOfChannels(),onClick:p}))}),S=n(1463),P=n(335),x=n(47),T=n(1027),C=n(355),N=n(368),R=Object(u.b)(function(e,t){return{theme:e.sequencer.theme,wallpaper:e.sequencer.wallpaper,animateWallpaper:e.sequencer.animateWallpaper,backgroundColor:e.sequencer.backgroundColor,showThemeGrid:e.sequencer.showThemeGrid}},function(e){return{setShowThemeGrid:function(t){return e(Object(c.hg)(t))},setTheme:function(t){return e(Object(c.Kg)(t))},setWallpaper:function(t){return e(Object(c.Gh)(t))},setBackgroundColor:function(t){return e(Object(c.bb)(t))},setAnimateWallpaper:function(t){return e(Object(c.z)(t))}}})(function(e){var t=Object(r.useRef)(void 0),n=Object(r.useState)(e.wallpaper),o=Object(i.a)(n,2),s=o[0],c=o[1],u=Object(r.useState)(void 0),l=Object(i.a)(u,2),f=l[0],h=l[1],p=Object(r.useState)(!1),m=Object(i.a)(p,2),v=m[0],b=m[1],g=Object(r.useState)({hex:e.backgroundColor}),y=Object(i.a)(g,2),k=y[0],O=y[1];Object(r.useEffect)(function(){e.backgroundColor!==k.hex&&e.setBackgroundColor(k.hex)},[k,e.backgroundColor]);var j=Object(C.a)(t,9,!0).size;Object(r.useEffect)(function(){s&&(d.a.setItem("wallpaper",s),f&&!f.map(function(e){return e.wallpaper}).includes(s)&&Object(T.b)(s),e.setWallpaper(s))},[s,f]),Object(r.useEffect)(function(){Object(T.a)().then(h)},[h]);var w=f||[];return a.a.createElement("div",{className:"appearance"},a.a.createElement("div",{className:"wallpaper-toolbar"},"Theme:",a.a.createElement("div",{onClick:function(){d.a.removeItem("wallpaper"),d.a.setItem("theme","dark"),e.setTheme("dark"),e.setWallpaper(void 0)},className:e.wallpaper||"dark"!=e.theme?"wall animate-btn":"wall animate-btn selected"},"Dark Mode"),a.a.createElement("div",{onClick:function(){d.a.removeItem("wallpaper"),d.a.setItem("theme","light"),e.setWallpaper(void 0),e.setTheme("light")},className:e.wallpaper||"light"!==e.theme?"wall animate-btn":"wall animate-btn selected"},"Light Mode"),a.a.createElement("div",{onClick:function(){d.a.removeItem("show-theme-grid"),d.a.setItem("show-theme-grid",!e.showThemeGrid),e.setShowThemeGrid(!e.showThemeGrid)},className:e.showThemeGrid?"wall animate-btn selected":"wall animate-btn"},"Show Grid"),a.a.createElement("div",{style:{backgroundColor:k.hex},onClick:function(){return b(!v)},className:"color-btn"}),v&&a.a.createElement(P.a,{color:k,onChange:O})),a.a.createElement(N.a,{placeholder:"Drag new wallpaper here",imageHash:s,setImageHash:c}),a.a.createElement("div",{ref:t,className:"gallery"},w.slice(0,j).map(function(e){var t=e.wallpaper,n=e.thumbnail;return a.a.createElement("img",{key:t,onClick:function(){return c(t)},src:x.a.getHashUrl(n),className:"wallpaper-choice"})})))}),M=(n(2705),function(e){var t=e.option,n=e.setOption,r=e.selectedOption,i="settings-option";return t===r&&(i+=" selected"),a.a.createElement("div",{onClick:function(){return n(t)},className:i},t)}),A=Object(u.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=Object(r.useState)("Appearance"),n=Object(i.a)(t,2),o=n[0],s=n[1];return a.a.createElement("div",{className:"settings"},a.a.createElement("div",{className:"settings-sidebar"},a.a.createElement(M,{option:"Appearance",selectedOption:o,setOption:s}),e.onlyAppearance?"":a.a.createElement(M,{option:"MIDI",selectedOption:o,setOption:s}),e.onlyAppearance?"":a.a.createElement(M,{option:"Audio",selectedOption:o,setOption:s}),e.onlyAppearance?"":a.a.createElement(M,{option:"Freeze",selectedOption:o,setOption:s}),e.onlyAppearance?"":a.a.createElement(M,{option:"Clock",selectedOption:o,setOption:s})),a.a.createElement("div",{className:"settings-content"},"Appearance"===o?a.a.createElement(R,{sequencerEngine:e.sequencerEngine}):"","MIDI"===o?a.a.createElement(p,{sequencerEngine:e.sequencerEngine}):"","Audio"===o?a.a.createElement(E,{sequencerEngine:e.sequencerEngine}):"","Freeze"===o?a.a.createElement(l,{sequencerEngine:e.sequencerEngine}):"","Clock"===o?a.a.createElement(S.a,{sequencerEngine:e.sequencerEngine}):""))}),q=n(59),D=n(58);t.a=Object(u.b)(function(e,t){return{}},function(e){return{setShowSettings:function(t){return e(Object(c.fg)(t))}}})(function(e){var t=Object(r.useCallback)(function(){e.setShowSettings(!1),e.hide&&e.hide()},[]);return a.a.createElement(D.a,{dialogClassName:"preset-modal",show:!0,onHide:t},a.a.createElement(D.a.Header,{closeButton:!0},a.a.createElement(D.a.Title,null,"Settings")),a.a.createElement(D.a.Body,null,a.a.createElement(A,{onlyAppearance:e.onlyAppearance,sequencerEngine:e.sequencerEngine})),a.a.createElement(D.a.Footer,null,a.a.createElement(q.b,{variant:"secondary",onClick:t},"Done")))})},function(e,t,n){"use strict";var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(11),c=n(0),u=n.n(c),l=n(12),f=(n(1543),n(38)),h=n(6),p=Object(l.b)(function(e){return{toast:e.explore.toast}},function(e){return{setExploreToast:function(t){return e(Object(h.jc)(t))}}})(function(e){var t=e.toast,n=e.setExploreToast;return t?u.a.createElement("div",{className:"toast-box"},u.a.createElement("div",{onClick:function(){return n(void 0)},className:"delete-button"},"x"),t):u.a.createElement("div",null)}),d=n(30),m=function(e){var t=Object(c.useState)([]),n=Object(s.a)(t,2),a=n[0],i=n[1];Object(c.useEffect)(function(){d.a.guilds.getNewMemberRequests().then(function(e){i(e)})},[i]);var o=Object(c.useCallback)(function(e){d.a.guilds.acceptRequestToAddToGuild(e.guildId);var t=Object(r.a)(a),n=a.indexOf(e);t.splice(n,1),i(t)},[i,a]);return 0===a.length?u.a.createElement("div",null):u.a.createElement("div",{className:"guild-requests"},a.map(function(e){return u.a.createElement(v,{accept:function(){return o(e)},request:e})}))},v=function(e){var t=e.request,n=e.accept;return u.a.createElement("div",{className:"guild-request"},"You've been invited to join",u.a.createElement("span",{className:"guild-name"},t.guildName),u.a.createElement("span",{onClick:n,className:"accept-button"},"Accept"))},b=n(164),g=n.n(b),y=n(1465),k=function(e){var t=Object(c.useState)(""),n=Object(s.a)(t,2),r=n[0],a=n[1],l=Object(c.useState)(""),f=Object(s.a)(l,2),h=f[0],p=f[1],m=Object(c.useCallback)(Object(o.a)(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.guilds.newGuild(r,h);case 2:e.done();case 3:case"end":return t.stop()}},t)})),[r,h]);return u.a.createElement("div",{className:"create-new-guild"},u.a.createElement(y.a,{name:r,passphrase:h,onNameChange:a,onPassphraseChange:p}),u.a.createElement("div",{className:"toolbar"},u.a.createElement("div",{onClick:m,className:"done-button"},"Create"),u.a.createElement("div",{onClick:e.cancel,className:"cancel-button"},"Cancel")))};function O(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(e){var t=e.guild,n=Object(c.useState)([]),r=Object(s.a)(n,2),a=r[0],l=r[1];return Object(c.useEffect)(function(){t&&d.a.guilds.getNewMemberRequestsFromGuild(t.guildId).then(function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=O(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=13;break}return o=a.value,e.t0=n,e.next=9,d.a.users.getUserName(o.newMember);case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(2),r.e(e.t2);case 18:return e.prev=18,r.f(),e.finish(18);case 21:l(Array.from(new Set(n)));case 22:case"end":return e.stop()}},e,null,[[2,15,18,21]])}));return function(t){return e.apply(this,arguments)}}())},[t,l]),0===a.length?u.a.createElement("div",null):(console.log("requests = ",a),u.a.createElement("div",{className:"outbound-requests"},u.a.createElement("div",{className:"requests-header"},"Pending Invites"),a.map(function(e){return u.a.createElement("div",null,e)})))},E=function(e){var t=e.user,n=e.inviteUser;return u.a.createElement("div",{onClick:function(){return n(t)},className:"potential-user"},t)},S=n(40),P=n(269),x=n(516),T=n(31);function C(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=Object(l.b)(null,function(e){return{setExploreToast:function(t){return e(Object(h.jc)(t))}}})(function(e){var t=e.guild,n=e.setExploreToast,r=(e.numPending,e.onHide),a=e.onLeftGuild,l=Object(c.useState)(0),h=Object(s.a)(l,2),p=h[0],m=h[1],v=Object(c.useState)(0),b=Object(s.a)(v,2),g=b[0],y=b[1],k=Object(c.useState)(!1),O=Object(s.a)(k,2),j=O[0],N=O[1],R=Object(c.useState)([]),M=Object(s.a)(R,2),A=M[0],q=M[1];Object(c.useEffect)(function(){d.a.encryption.getPotentialUsers().then(function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=C(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=13;break}return o=a.value,e.t0=n,e.next=9,d.a.users.getUserName(o);case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(2),r.e(e.t2);case 18:return e.prev=18,r.f(),e.finish(18);case 21:q(n.filter(function(e){return e&&""!==e}));case 22:case"end":return e.stop()}},e,null,[[2,15,18,21]])}));return function(t){return e.apply(this,arguments)}}())},[q]),Object(c.useEffect)(function(){if(void 0!==t){var e=new S.a((new P.a).contractAddress).from(T.Y).select("ipfsHash").where("guildId",t.guildId);e.executeQuery().then(function(e){return m(new Set(e.map(function(e){return e.ipfsHash})).size)}),(e=new S.a((new x.a).contractAddress).from(T.v).select("contentHash").where("guildId",t.guildId)).executeQuery().then(function(e){return y(new Set(e.map(function(e){return e.contentHash})).size)}),N(!1)}},[t,m,y,N]);var D=Object(c.useCallback)(function(e){console.log("invite user =",e),d.a.users.getUserId(e).then(function(r){d.a.guilds.requestToAddMember(t.guildId,r),n("Invited "+e+" to "+t.name)})},[t]),I=Object(c.useCallback)(function(){d.a.guilds.leaveGuild(t.guildId),a(t),r()},[t,r]);if(void 0===t)return u.a.createElement("div",null);var _=t.members.map(function(e){return e.userName});return u.a.createElement("div",{className:"guild-details"},u.a.createElement(f.a,{condition:j},u.a.createElement("div",{className:"guild-members inviting"},u.a.createElement("div",{className:"invite-header"},"Invite"),u.a.createElement("div",{className:"people-container"},A.filter(function(e){return-1===_.indexOf(e)}).map(function(e){return u.a.createElement(E,{inviteUser:D,user:e})})),u.a.createElement("div",{onClick:function(){return N(!1)},className:"cancel-button"},"Cancel"))),u.a.createElement(f.a,{condition:!j},u.a.createElement("div",{className:"guild-members"},u.a.createElement("div",{className:"members-header"},"Members"),u.a.createElement("div",{className:"people-container"},t.members.map(function(e){return u.a.createElement("div",{className:"member"},e.userName)})),u.a.createElement("div",{onClick:function(){return N(!0)},className:"invite-button"},"Invite"))),u.a.createElement("div",{className:"guild-stats"},u.a.createElement("div",{className:"samples-count"},p," samples"),u.a.createElement("div",{className:"samples-count"},g," sequences"),u.a.createElement(w,{guild:t}),u.a.createElement("div",{onClick:I,className:"leave-guild-btn"},"Leave Group")))}),M=function(e){var t="guild-option";return e.selected&&(t+=" selected"),u.a.createElement("div",{onClick:e.onClick,className:t},e.guild.name)};t.a=Object(l.b)(function(e,t){return{numPending:e.transactions.pendingTransactions.length}},null)(function(e){var t=e.numPending,n=Object(c.useState)(void 0),a=Object(s.a)(n,2),l=a[0],h=a[1],v=Object(c.useState)(!1),b=Object(s.a)(v,2),y=b[0],O=b[1],j=Object(c.useState)(!1),w=Object(s.a)(j,2),E=w[0],S=w[1],P=Object(c.useState)([]),x=Object(s.a)(P,2),T=x[0],C=x[1],N=Object(c.useCallback)(function(){A(),O(!1)},[C,O]);d.a.guilds.newGuildCallback=N;var A=Object(c.useCallback)(function(){d.a.guilds.getGuildsForUser().then(function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.t0=i.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=14;break}if(r=e.t1.value,!((a=t[r]).name.split(",").length>=2)){e.next=7;break}return e.abrupt("continue",2);case 7:return e.next=9,d.a.guilds.getUsersInGuild(a.guildId);case 9:o=e.sent,a.members=o,n.push(a),e.next=2;break;case 14:C(n);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},[C,t]);Object(c.useEffect)(function(){A()},[C]);var q=Object(c.useCallback)(function(e){var t=T.indexOf(e),n=Object(r.a)(T);n.splice(t,1),C(n)},[T,C]);return E?u.a.createElement("div",{className:"explore-guilds"},u.a.createElement(k,{done:function(){S(!1),O(!0)},cancel:function(){return S(!1)}})):u.a.createElement("div",{className:"explore-guilds"},u.a.createElement("div",{className:"top-bar"},u.a.createElement("div",{onClick:function(){return S(!0)},className:"create-guild-button"},"Create New Group"),u.a.createElement(p,null),u.a.createElement(m,null)),u.a.createElement(f.a,{condition:y},"Syncing guild changes",u.a.createElement(g.a,{sizeUnit:"px",size:10,color:"#42f4f1",loading:!0})),u.a.createElement("div",{className:"guilds-content"},u.a.createElement("div",{className:"guilds-chooser"},T.map(function(e){return u.a.createElement(M,{selected:e===l,onClick:function(){return h(e)},guild:e})})),u.a.createElement(R,{onLeftGuild:q,onHide:function(){return h(void 0)},guild:l})))})},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(11),o=n(90),s=n.n(o),c=n(39),u=n.n(c),l=n(281),f=n(12),h=["A","B","C","D","E","F","G","H","I","J","K","L","M","N"],p=[{label:"Stay",value:l.d},{label:"Forward",value:l.b},{label:"Reverse",value:l.c},{label:"Brownian",value:l.a}],d=function(e){var t=e.i,n=e.scene,o=e.subSequence,s=Object(r.useState)(n.durationPercentages[t]),c=Object(i.a)(s,2),l=(c[0],c[1]),f=Object(r.useState)(n.algorithmTypes[t]),d=Object(i.a)(f,2),m=d[0],v=d[1],b=Object(r.useState)(n.patterns[t]),g=Object(i.a)(b,2),y=g[0],k=g[1];Object(r.useEffect)(function(){k(n.patterns[t]),l(n.durationPercentages[t]),v(n.algorithmTypes[t])},[t,n,k,v,l]);var O=Object(r.useCallback)(function(e){n.algorithmTypes[t]=e.value,v(e.value)},[v,t,n]),j=(Object(r.useCallback)(function(e){n.durationPercentages[t]=e},[l,t,n]),Object(r.useCallback)(function(e){n.patterns[t]=e.value,k(e.value)},[k,t,n])),w=(o.tracks[0]?o.tracks[0].patterns:[]).map(function(e,t){return{label:"Pattern "+(t+1),value:t}}),E=h[t];return a.a.createElement("div",{className:"sub-sequence-details"},a.a.createElement("div",{className:"sub-name"},E,":"),a.a.createElement(u.a,{controlClassName:"pattern-dropdown",options:w,onChange:j,value:w.find(function(e){return e.value===y}),placeholder:"Pattern"}),a.a.createElement(u.a,{options:p,onChange:O,value:p.find(function(e){return m===e.value}),placeholder:"Algo Type"}))},m=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.currentScene,n=e.sequencerEngine;return t?a.a.createElement("div",{className:"scene-details"},n.subSequences.map(function(e,n){return a.a.createElement(d,{i:n,subSequence:e,scene:t})})):[]}),v=function(e){var t=e.scene,n=e.scenes,o=e.isCurrent,s=e.setSceneDragging,c=(e.sceneDragging,e.onDropScene),u=Object(r.useRef)(0),l=Object(r.useState)(!1),f=Object(i.a)(l,2),h=f[0],p=f[1],d=Object(r.useState)(t.name),m=Object(i.a)(d,2),v=m[0],b=m[1],g="scene-option";o&&(g+=" current");var y=Object(r.useCallback)(function(){var e=(new Date).getTime();e-u.current<=400&&p(!0),u.current=e,n.switchToScene(t)},[p]),k=Object(r.useCallback)(function(e){b(e.target.value)},[b]),O=Object(r.useCallback)(function(e){"Enter"===e.key&&(p(!1),t.name=v)},[p,v,t]);return a.a.createElement("div",{draggable:!0,onDragStart:function(){return s(t)},onDragOver:function(e){return e.preventDefault()},onDrop:function(){return c(t)},onClick:y,className:g},h?a.a.createElement("input",{onChange:k,onKeyDown:O,type:"text",value:v}):v,a.a.createElement("div",{className:"scene-info"},t.patterns.map(function(e){return e+1}).join(" - ")),a.a.createElement("div",{onClick:function(e){e.stopPropagation(),n.deleteScene(t)},className:o?"delete-btn":"hide delete-btn"},"x"))},b=Object(f.b)(function(e,t){return{scenes:e.sequencer.scenes,currentScene:e.sequencer.currentScene}},function(e){return{}})(function(e){var t=e.currentScene,n=e.scenes,o=e.sequencerEngine,s=Object(r.useState)(void 0),c=Object(i.a)(s,2),u=c[0],l=c[1];console.log("rendering scenes = ",n);var f=Object(r.useCallback)(function(e){var t=n.indexOf(u),r=n.indexOf(e);o.scenes.moveScene(t,r)},[u,n]);return a.a.createElement("div",{className:"scenes-container"},a.a.createElement("div",{className:"scenes-component"},a.a.createElement("div",{className:"scenes-toolbar"},a.a.createElement("div",{className:"scenes-header"},"Scenes"),t?"":a.a.createElement("div",{onClick:function(){return o.scenes.newScene()},className:"new-scene-btn"},"+")),n.map(function(e){return a.a.createElement(v,{key:e.id,onDropScene:f,setSceneDragging:l,sceneDragging:u,isCurrent:t===e,scenes:o.scenes,scene:e})})),a.a.createElement(m,{sequencerEngine:o,currentScene:t}))}),g=n(2),y=n(4),k=n(7),O=n(10),j=n(1);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(j.a)(e);if(t){var a=Object(j.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(O.a)(this,n)}}var E=["A","B","C","D","E","F","G","H","I","J","K","L","M","N"],S=function(e){Object(k.a)(n,e);var t=w(n);function n(e){var r;return Object(g.a)(this,n),(r=t.call(this,e)).state={},r}return Object(y.a)(n,[{key:"onChangeVolume",value:function(e){this.props.subSequence.fade=e,this.props.currentSubSequence!==this.props.subSequence.id&&this.props.sequencerEngine.switchToSubSequence(this.props.subSequence.id)}},{key:"onClickMute",value:function(){this.props.subSequence.mute=!this.props.muted}},{key:"patterns",get:function(){var e=this.props.subSequence.tracks[0];return void 0===e?[]:e.patterns}},{key:"render",value:function(){var e=this,t="sub-sequence-fader";return this.props.currentSubSequence===this.props.subSequence.id&&(t+=" selected"),a.a.createElement("div",{key:"sub-sequence-fader-"+this.props.subSequence.id,className:t},a.a.createElement("div",{className:"mix-patterns"},this.patterns.map(function(t,n){return a.a.createElement(P,{key:"pattern-"+n,subSequence:e.props.subSequence,sequencerEngine:e.props.sequencerEngine,isCurrent:n===e.props.currentPattern,pattern:n})})),a.a.createElement("div",{className:"sub-sequence-fader-and-info"},a.a.createElement("div",{className:"sub-sequence-fader-empty"}),a.a.createElement("div",{className:"volume-slider-container"},a.a.createElement(s.a,{handle:"square",value:this.props.volume,change:function(t){return e.onChangeVolume(t.target.value)},step:.01,max:1,min:0,orientation:"vertical",reversed:!0})),a.a.createElement("div",{onClick:function(){return e.onClickMute()},className:this.props.muted?"sub-sequence-info muted":"sub-sequence-info"},E[this.props.i])))}}]),n}(r.Component),P=function(e){Object(k.a)(n,e);var t=w(n);function n(){return Object(g.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e=this,t="sub-sequence-pattern";return this.props.isCurrent&&(t+=" current"),a.a.createElement("div",{onClick:function(){return e.switchToPattern()},className:t},this.props.pattern+1)}},{key:"switchToPattern",value:function(){this.props.sequencerEngine.switchToPattern(this.props.pattern,!1,this.props.subSequence),this.props.sequencerEngine.switchToSubSequence(this.props.subSequence.id)}}]),n}(r.Component),x=Object(f.b)(function(e,t){var n=e.mix.subSequenceFades[t.subSequence.id],r=t.sequencerEngine.engineId;return{volume:void 0===n?1:n,muted:e.mix.subSequenceMuted[t.subSequence.id],currentPattern:e.sequencer.currentPattern[t.subSequence.id]||0,currentSubSequence:e.sequencer.currentSubSequence[r]}},null)(S),T=(n(1530),n(1412)),C=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine;return a.a.createElement("div",{className:"mix-modules"},a.a.createElement(T.a,{sequencerEngine:t}))});t.a=function(e){return a.a.createElement("div",{className:"global-mix-container"},a.a.createElement("div",{className:"sub-sequences-mix-container"},e.sequencerEngine.subSequences.filter(function(e){return!e.isTrack}).map(function(t,n){return a.a.createElement(x,{key:"sub-mix-"+n,sequencerEngine:e.sequencerEngine,i:n,subSequence:t})}),a.a.createElement(b,{sequencerEngine:e.sequencerEngine}),a.a.createElement(C,{sequencerEngine:e.sequencerEngine})))}},function(e,t,n){"use strict";var r=n(28),a=n(8),i=(n(9),n(11)),o=n(0),s=n.n(o),c=n(1414),u=n(1415),l=n(6),f=n(1103),h=n(1416),p=n(657),d=n(208),m=n(12),v=Object(m.b)(function(e,t){return{fill:t.subpatch.zObject.attributes["primary-color"]}},function(e){return{}})(function(e){var t=e.subpatch,n=e.fill,r=Object(o.useRef)(void 0),c=Object(o.useState)(!1),u=Object(i.a)(c,2),l=u[0],f=u[1],h=Object(d.a)({containerRef:r}).getXY,p=t.zObject,m=Object(o.useState)(p.width>0?{width:p.width,height:p.height}:{width:300,height:200}),v=Object(i.a)(m,2),b=v[0],g=v[1];Object(o.useEffect)(function(){return window.addEventListener("mousemove",k),window.addEventListener("mouseup",y),function(){window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",y)}},[g,l,f]);var y=Object(o.useCallback)(function(){l&&f(!1)},[f,l]),k=Object(o.useCallback)(function(e){if(!l)return!1;var n=h(e),r=n.x,a=n.y;t.zObject.width=r,t.zObject.height=a,g({width:r,height:a})},[g,l]),O=Object(a.a)({},b);return n&&(O.backgroundColor=n),s.a.createElement("div",{ref:r,style:O,className:"sub-patch-size"},s.a.createElement("div",{onMouseDown:function(e){f(!0)},className:"right-bottom-corner"}))}),b=n(93),g=function(e){var t=e.ref,n=e.subSequence,r=e.setSelection,a=function(e){var t=Object(o.useCallback)(function(t,n){var r=e.createSequencer();r.x=t,r.y=n},[e]),n=Object(o.useCallback)(function(t,n,r){e.createZObject(t,n,r)},[e]),r=Object(o.useCallback)(function(t,n){e.createZMessage(t,n)},[e]),a=Object(o.useCallback)(function(t,n){e.createZMessage(t,n,b.c)},[e]),i=Object(o.useCallback)(function(t,n){e.createZObject(t,n,"toggle")},[e]),s=Object(o.useCallback)(function(t,n){e.createZMessage(t,n,b.a)},[e]);return{createPad:Object(o.useCallback)(function(t,n){var r=e.createPad();r.x=t,r.y=n},[e]),createSequencer:t,createButton:s,createToggle:i,createZNumber:a,createZMessage:r,createZObject:n}}(n),i=a.createPad,s=a.createSequencer,c=a.createButton,u=a.createZNumber,f=a.createZMessage,h=a.createToggle,p=a.createZObject,m=Object(d.a)({containerRef:t}).getXY;return{onDrop:Object(o.useCallback)(function(e){var t=m(e),a=t.x,o=t.y,d=n.sequencerEngine,v=d.state.zobject,b=v.objectDragging,g=v.zobjectTypeDragging;if(b)n.moveObjectInto(b,a,o);else if(g){switch(g){case"zobject":p(a,o);break;case"zmessage":f(a,o);break;case"zpad":i(a,o);break;case"zbutton":c(a,o);break;case"ztoggle":h(a,o);break;case"znumber":u(a,o);break;case"sequencer":s(a,o);break;case"zcomment":p(a,o,"comment")}d.dispatch(Object(l.ai)(void 0)),r(void 0)}},[n])}},y=n(182),k=n(1093),O=n(1088),j=n(1089),w=n(337),E=n(1479);function S(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=Object(o.memo)(function(e){e.len;var t=e.subpatch,n=e.setSize,l=e.setSelectedPulledElements,m=e.isInstrumentView,b=e.customMode,P=e.scrollRef,x=e.editLayout,T=e.presentationMode,C=e.isInsideWindow,N=e.setSelectedZObject,R=(e.setViewableSubPatches,t.zObjects),M=t.zMessages,A=Object(o.useRef)(),q=Object(o.useRef)({}),D=Object(p.a)(),I=D.sizeRef,_=D.ordering,F=D.setOrdering,L=P,B=Object(j.a)({elements:q}).getSelection,z=Object(o.useState)(void 0),V=Object(i.a)(z,2),H=V[0],U=V[1],J=Object(d.a)({containerRef:L,scale:1}).getXY,G=Object(o.useCallback)(function(e){if(!C){e.stopPropagation();var n=J(e),r=n.x,a=n.y;t.createZObject(r,a)}},[]),W=Object(y.a)(G,250,function(e){C||e.stopPropagation()}),K=Object(h.a)({scrollRef:L,sequencerEngine:t.sequencerEngine,context:t}).onMouseMove,X=(Object(o.useCallback)(function(e){if("custom"===b&&N(t.zObject),L&&L.current){var n=J(e),r=n.x,a=n.y;U({x1:r,y1:a,x2:r,y2:a})}},[U,b]),Object(o.useCallback)(function(e){if(K(e),H){var t=J(e),n=t.x,r=t.y;U(Object(a.a)({},H,{x2:n,y2:r}))}},[H,U]),Object(o.useCallback)(function(e){if(H&&H.x2-H.x1>1){var t,n={},r=S(B(H));try{for(r.s();!(t=r.n()).done;){n[t.value.id]=!0}}catch(a){r.e(a)}finally{r.f()}l(n)}H&&U(void 0)},[H,U]),g({ref:L,subSequence:t,setSelection:U}).onDrop),Q="content-inner";return(T||x||m)&&(Q+=" presentation-mode"),s.a.createElement("div",{onDrop:X,onClick:W,ref:P,className:Q},"custom"!==b&&s.a.createElement(c.a,{subSequence:t}),"custom"!==b&&s.a.createElement(u.a,{subSequence:t}),"custom"!==b&&s.a.createElement(O.a,{isSubPatch:!0,scale:1,sequencerEngine:t.sequencerEngine,getXY:J,setSelectedZObject:N,onMouseMove:K,getSelection:B,editorRef:P}),x&&!0===b&&s.a.createElement(v,{scrollRef:L,subpatch:t}),R.map(function(e){return s.a.createElement(w.a,{key:e.id,scale:1,elements:q,sequencerEngine:t.sequencerEngine,ordering:_,isInstrumentView:m||x,setOrdering:F,customMode:"custom"===b?b:b&&x,setSize:n,sizeRef:I,containerRef:L,zobject:e})}),M.map(function(e){var a;return s.a.createElement(E.a,(a={key:e.id,scale:1,sequencerEngine:t.sequencerEngine,isInstrumentView:m||x,setOrdering:F,ordering:_,customMode:"custom"===b?"custom":b&&x},Object(r.a)(a,"setOrdering",F),Object(r.a)(a,"setSize",n),Object(r.a)(a,"sizeRef",I),Object(r.a)(a,"elements",q),Object(r.a)(a,"containerRef",L),Object(r.a)(a,"zmessage",e),a))}),(!b||!0===b&&!x)&&t.zObjects.filter(function(e){return"pad"===e.name}).filter(function(e){return e.effect.pad}).map(function(e){return e.effect.pad}).filter(function(e){return e.effectRack}).map(function(e){return s.a.createElement(f.a,{scale:1,ordering:_,setOrdering:F,setSize:n,sizeRef:I,elements:q,containerRef:L,pad:e})}),L&&L.current&&(!b||b&&!x)&&s.a.createElement(k.a,{edgesRef:A,scrollable:!0,width:L.current&&L.current.scrollWidth,height:L.current&&L.current.scrollHeight,selection:H,containerRef:L,scale:1,subSequence:t}))});t.a=Object(m.b)(function(e,t){return{len:t.subpatch.zObjects.length,zobjects:e.zobject.zobjects[t.subpatch.id],zmessages:e.zobject.zmessages[t.subpatch.id],presentationMode:e.spatial.presentationMode}},function(e,t){return{setSize:function(n){return e(Object(l.sd)(t.subpatch.id,n))},setSelectedPulledElements:function(t){return e(Object(l.mf)(t))},setViewableSubPatches:function(t){return e(Object(l.Eh)(t))},setSelectedZObject:function(t){return e(Object(l.uf)(t))}}})(x)},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(52),u=n(36),l=function(){function e(){Object(o.a)(this,e),this.abi=[{constant:!1,inputs:[{internalType:"uint32",name:"guildId",type:"uint32"},{internalType:"bytes32",name:"hash",type:"bytes32"}],name:"newGuildClassification",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"guildsAddress",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint32",name:"guildId",type:"uint32"},{indexed:!0,internalType:"bytes32",name:"hash",type:"bytes32"}],name:"NewGuildClassification",type:"event"}],this.contractAddress="0x3831959eF022C226F3bdfF6481f4666901428f90"}return Object(s.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}(),f=n(31),h=n(40),p=n(47),d=n(446),m=new l,v={},b=function(){function e(){Object(o.a)(this,e),void 0!==u.a&&u.a.eth.net.isListening()&&(this.contract=new u.a.eth.Contract(m.abi,m.contractAddress),this.ethAddress=this.contract.options.address)}return Object(s.a)(e,[{key:"saveClassifications",value:function(e,t){var n=this;return new Promise(function(){var r=Object(i.a)(a.a.mark(function r(i,o){var s;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.addJson(t);case 2:return s=r.sent,r.t0=n.contract.methods.newGuildClassification(e,Object(d.b)(s)),r.next=6,c.a.getAccount();case 6:r.t1=r.sent,r.t2={from:r.t1},r.t3=function(e,t){e?o(e):i(s)},r.t0.send.call(r.t0,r.t2,r.t3);case 10:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}},{key:"getClassificationsHash",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:0,n=new h.a(m.contractAddress).from(f.r).select("contentHash").where("guildId",t),e.next=4,n.executeQuery();case 4:if(0!==(r=e.sent).length){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.abrupt("return",r[0].contentHash);case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getClassifications",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o,s;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return");case 3:return n.next=5,e.getClassificationsHash(t);case 5:if(void 0!==(o=n.sent)){n.next=10;break}r({}),n.next=15;break;case 10:return n.next=12,p.a.getJson(o);case 12:s=n.sent,v[t]=s,r(s);case 15:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}}]),e}();t.a=b},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(425),o=function(){function e(t,n,a,o,s){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;Object(r.a)(this,e),this.sliceNumber=0,this.recordedTriggers=n.map(function(e){return new i.a(e,0,a,o,s,c)}),this.transpose=t,this.tracks=n}return Object(a.a)(e,[{key:"record",value:function(e,t,n){var r=this;this.recordedTriggers.map(function(t,n){return t.record(e,r.tracks[n],r.transpose+r.tracks[n].trackData.transpose)})}}]),e}(),s={a:0,w:1,s:2,e:3,d:4,f:5,t:6,g:7,y:8,h:9,u:10,j:11,k:12,o:13,l:14},c=function(){function e(){Object(r.a)(this,e),this.octave=0}return Object(a.a)(e,[{key:"getTransposeForKey",value:function(e){var t=12*this.octave;return(e=e.toLowerCase())in s?t+s[e]:void 0}},{key:"upOctave",value:function(){this.octave<3&&this.octave++}},{key:"downOctave",value:function(){this.octave>-2&&this.octave--}}]),e}(),u=n(61),l=n(63),f=(n(225),n(6)),h=(n(55),new u.a),p=function(){function e(t,n){Object(r.a)(this,e),this.keyMappings={},this.midiMappings={},this.sequencerEngine=t,this.recordedMidiTriggers={},this.computerKeyboard=new c,this.store=t.store}return Object(a.a)(e,[{key:"midi",get:function(){return this.sequencerEngine.midi}},{key:"hasKeyMapping",value:function(e){return e in this.keyMappings}},{key:"deleteKeyMapping",value:function(e){delete this.keyMappings[e],this.sequencerEngine.store.dispatch(Object(f.Qc)(this.keyMappings))}},{key:"deleteMidiMapping",value:function(e){delete this.padMappings[e];var t=Object.keys(this.midiMappings)[0];this.sequencerEngine.store.dispatch(Object(f.Jd)(this.midiMappings[t]))}},{key:"deleteTrack",value:function(e){this.keyMappings=this.deleteHelper(this.keyMappings,e),this.midiMappings=this.deleteMidiHelper(this.midiMappings,e),this.sequencerEngine.store.dispatch(Object(f.Qc)(this.keyMappings));var t=Object.keys(this.midiMappings)[0];this.sequencerEngine.store.dispatch(Object(f.Jd)(this.midiMappings[t]))}},{key:"deleteMidiHelper",value:function(e,t){var n={};for(var r in e)n[r]=this.deleteHelper(e[r],t);return n}},{key:"deleteHelper",value:function(e,t){var n={};for(var r in e){e[r].trackNumber===t&&delete e[r]}for(var a in e){var i=e[a];t>=i.trackNumber?n[a]=i:t<i.trackNumber&&(i.trackNumber--,n[a]=i)}return n}},{key:"hasMidiMappings",value:function(){return Object.keys(this.midiMappings).length>0}},{key:"onKeyDown",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;e=e.toLowerCase(),this.handleOctaves(e);var o=r?l.a.fromString(e).getTranspose():this.computerKeyboard.getTransposeForKey(e),s=o%12;s<0&&(s=12+s),this.store.dispatch(Object(f.Vc)(o)),this.onNoteDown(e,o,t,n,a,r,i)}},{key:"onNoteDown",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;if(0!==this.sequencerEngine.tracks.length){var s=this.getToggledTracks(a,i);if(s.length>0){if(void 0===t)return;s.filter(function(e){return!e.rolling}).forEach(function(e){var n=h;n.copyFrom(e.trackData),n.slice=0,n.duration=void 0,n.transpose=t+e.trackData.transpose,n.velocity=null===o?e.trackData.velocity:o,e.instrument&&(n.release=null),e.midiEffects.liveInputTrigger(n)})}else if(e in this.keyMappings)this.keyMappings[e].trigger(this.sequencerEngine,n);else if(t in this.keyMappings)this.keyMappings[t].trigger(this.sequencerEngine,n);else if(a in this.midiMappings&&e.toUpperCase()in this.midiMappings[a])this.midiMappings[a][e.toUpperCase()].trigger(this.sequencerEngine,n,o,!0);else{var c=this.sequencerEngine.tracks[this.sequencerEngine.cursor.track];if(!c)return;var u=this.getSelectedSlice(c);void 0===a?this.alreadyMapped(c,u)||(this.map(e,this.sequencerEngine.cursor.track,this.getSelectedSlice(c)),this.onNoteDown(e,t,n,r,a,i,o)):this.alreadyMidiMapped(a,c,u)||(this.midiMap(a,e,this.sequencerEngine.cursor.track,u),this.onNoteDown(e,t,n,r,a,i,o))}}}},{key:"handleOctaves",value:function(e){"z"===e?this.computerKeyboard.downOctave():"x"===e&&this.computerKeyboard.upOctave()}},{key:"getToggledTracks",value:function(e,t){var n=this.sequencerEngine.subSequences.flatMap(function(e){return e.tracks}).filter(function(e){return e.isEnabled});return n=n.filter(function(n){return n.midiInputs.accepts(t,e)})}},{key:"recordHit",value:function(e,t,n,r,a,s){var c=this.getToggledTracks(a,t);if(!(c.length>0)){if(e in this.keyMappings){var u=this.keyMappings[e];return new i.a(u.track,u.sliceNumber,n,this.sequencerEngine,r)}if(a in this.midiMappings&&e in this.midiMappings[a]){u=this.midiMappings[a][e];return new i.a(u.track,u.sliceNumber,n,this.sequencerEngine,r,s)}return null}var f=t?l.a.fromString(e).getTranspose():this.computerKeyboard.getTransposeForKey(e);if(void 0!==f)return new o(f,c,n,this.sequencerEngine,r,s)}},{key:"getRecordedMidiTrigger",value:function(e,t,n){return new i.a(e.track,e.sliceNumber,t,this.sequencerEngine,n)}},{key:"padMappings",get:function(){var e=Object.keys(this.midiMappings);return 0===e.length?{}:this.midiMappings[e[0]]}},{key:"isMidiMapped",value:function(e){return void 0!==this.padMappings[e]}},{key:"alreadyMidiMapped",value:function(e,t,n){if(void 0===this.midiMappings[e])return!1;for(var r in this.midiMappings[e]){var a=this.midiMappings[e][r];if(a.track===t&&a.sliceNumber===n)return!0}return!1}},{key:"getSelectedSlice",value:function(e){return this.sequencerEngine.state.tracks.selectedTrackSlice[e.id]||0}},{key:"alreadyMapped",value:function(e,t){for(var n in this.keyMappings){var r=this.keyMappings[n];if(r.track===e&&r.sliceNumber===t)return!0}return!1}},{key:"map",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.sequencerEngine.keyListener.bindings[e]){var r=this.sequencerEngine.tracks[t];void 0!==r&&(this.keyMappings[e]=new d(e,r,n),this.sequencerEngine.store.dispatch(Object(f.Qc)(this.keyMappings)))}}},{key:"midiMap",value:function(e,t,n,r){var a=this.sequencerEngine.tracks[n];if(void 0!==a){t=t.toUpperCase();var i=new d(t,a,r);e in this.midiMappings||(this.midiMappings[e]={}),this.midiMappings[e][t]=i;var o={};for(var s in this.midiMappings){var c=this.midiMappings[s];for(var u in c)o[u]=c[u]}this.store.dispatch(Object(f.Jd)(o)),this.store.dispatch(Object(f.Uc)(t))}}},{key:"getMappings",value:function(){return this.keyMappings}},{key:"getMidiMappings",value:function(){return this.midiMappings}},{key:"deleteMappingsForTrack",value:function(e){for(var t in this.keyMappings)this.keyMappings[t].trackNumber===e&&delete this.keyMappings[t];for(var n in this.midiMappings){var r=this.midiMappings[n];for(var a in r)r[a].trackNumber==e&&delete r[a]}}}]),e}(),d=function(){function e(t,n,a){Object(r.a)(this,e),this.key=t,this.track=n,this.trackNumber=n.trackNumber,this.sliceNumber=a}return Object(a.a)(e,[{key:"trigger",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=(arguments.length>3&&arguments[3],this.track);if(!r.rolling){var a=h;a.copyFrom(r.trackData),a.slice=this.sliceNumber,a.velocity=n,a.duration=void 0,r.midiEffects.liveInputTrigger(a)}e.selectMidiTrack(this.trackNumber),e.dispatch(Object(f.tf)(r.id,this.sliceNumber))}}]),e}();t.a=p},function(e,t,n){"use strict";n(9);var r=n(5),a=n.n(r),i=n(14),o=n(0),s=n(1360),c=n(79),u=n(6),l=n(625);n(151),n(186),n(318);n.d(t,"a",function(){return h});var f=0,h=function(e){var t=e.setTags,n=e.setEffects,r=e.effects,h=e.tags,p=e.sequencerEngine,d=e.searchText,m=e.setSearchText,v=e.setSelectedEffect,b=e.setSelectedTag,g=e.selectedTag,y=e.selectedEffect,k=e.track,O=e.ref;Object(o.useEffect)(function(){j()},[]),Object(o.useEffect)(function(){d&&void 0!==d||j(!1)},[d,m,t,n,b]);var j=Object(o.useCallback)(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];m(""),t(l.b),n([]),b(void 0),v(void 0);var r=p.getSelectedTrack();r&&r.samplesStream&&e&&console.log("CLEAR BACK SAMPLES STREAM CALLED")},[d,m,t,n,b]),w=Object(o.useCallback)(function(){var e=Object(i.a)(a.a.mark(function e(r){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.target.value,m(i),o=++f,""!==i.trim()){e.next=8;break}return m(""),t(l.b),n([]),e.abrupt("return");case 8:setTimeout(function(){o===f&&Object(s.a)(i).then(function(e){p.searchForSounds([e[0]],!0,k,!1),b(e[0])})},200);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[t,m,n,b,v]);Object(o.useEffect)(function(){return window.addEventListener("keydown",E),function(){return window.removeEventListener("keydown",E)}},[m,h,r,g,y,b,v]);var E=Object(o.useCallback)(function(e){if(e.target===O.current)if("Enter"===e.key)g&&(!function(e,t,n){if("?"!==e){if(Array.isArray(t)){var r=Math.floor(Math.random()*t.length);n.searchForSounds(t[r])}else n.searchForSounds([t]);if(n.state.sequencer.viewMode===c.a){n.subSequences.forEach(function(e){var t=e.id;return n.dispatch(Object(u.Gf)(t,!0))});var a=n.state.selector.searchInput;if(!a||!a.current||!a.current.focus)return;setTimeout(function(){a.current.focus()},100)}}else{var i=n.ethereumCache.getAllForField("TAG",0,5e3),o=i[Math.floor(Math.random()*i.length)];n.searchForSounds([o.value])}}(g,h[g],p),j(),O.current.blur());else if("ArrowDown"===e.key){if(g){var t=Object.keys(h),n=t.indexOf(g)+1;n<t.length?b(t[n]):b(t[0])}}else if("ArrowUp"===e.key){if(g){var r=Object.keys(h),a=r.indexOf(g)-1;b(a>=0?r[a]:r[a.length-1])}}else"Escape"===e.key&&O.current.blur()},[m,h,r,g,y,b,v]);return{onChange:w,clear:j}}},function(e,t,n){"use strict";var r=n(28),a=n(8),i=n(11),o=n(876),s=n(0),c=n.n(s),u=n(6),l=n(203),f=n(244),h=n(139),p=n(125),d=n(182),m=n(12),v=Object(m.b)(function(e,t){return{ioNumber:t.zmessage[t.field]}},function(e){return{}})(function(e){var t=e.zmessage,n=e.field,r=void 0===n?"inletNumber":n,a=e.icon,o=void 0===a?"inlet-icon":a,u=Object(s.useRef)(void 0),m=Object(s.useRef)(void 0),v=Object(l.a)({ref:m}),b=v.onContextMenu,g=v.dropdownPos,y=v.setDropdownPos,k=Object(s.useState)(""),O=Object(i.a)(k,2),j=O[0],w=O[1],E=Object(s.useState)(!1),S=Object(i.a)(E,2),P=S[0],x=S[1],T=Object(d.a)(function(){return x(!0)});Object(s.useEffect)(function(){u.current&&P&&u.current.focus()},[P]);var C=Object(s.useCallback)(function(e){"Enter"===e.key&&(t._text=j,t.subSequence.propagate(Object(p.s)(t,j)),x(!1))},[x,j]),N="io-inner ";t.subSequence.instanceInlets&&t.subSequence.instanceInlets.includes(t)&&(N+=" instance-inlet");var R=Object(s.useCallback)(function(){t.subSequence.toggleInlet(t)},[!1,t]);return c.a.createElement("div",{ref:m,onContextMenu:"inletNumber"===r?b:function(){return[]},className:N,onClick:T},c.a.createElement(f.a,{dropdownPos:g,setDropdownPos:y},c.a.createElement(h.a,{onClick:R},"Convert to Instance Inlet")),P?c.a.createElement("div",{className:"io-number"},c.a.createElement("input",{onKeyDown:C,ref:u,value:j,type:"text",onChange:function(e){return w(e.target.value)}})):c.a.createElement("div",{className:"io-number"},t[r]," ",""!==t._text?". "+t._text:""),c.a.createElement("div",{className:o}))}),b=n(93),g=n(260),y=n(371),k=n(372),O=n(734);n(19),n(899),t.a=Object(m.b)(function(e,t){var n=e.spatial.presentationMode||t.isInstrumentView,r=!1;return n&&t.zmessage.attributes&&!t.zmessage.attributes["Include in Presentation"]&&(r=!0),{presentationMode:n,hidden:r,isSelected:e.windows.selectedElements[t.zmessage.id],isSelectedZObject:e.zobject.selectedZObject===t.zmessage,messageText:t.zmessage._text,uxLocked:e.zobject.uxLocked,isDeleted:t.zmessage.isDeleted,styling:e.zobject.objectStylings[t.zmessage.id],includeInPresentation:!n&&t.zmessage.attributes["Include in Presentation"]}},function(e){return{setSelectedZObject:function(t){return e(Object(u.uf)(t))},setZObjectContextMenu:function(t,n,r){return e(Object(u.Th)(t,n,r))}}})(function(e){var t,n=e.zmessage,u=e.messageText,l=(e.coords,e.sequencerEngine),f=e.scale,h=e.customMode,p=e.sizeRef,m=e.containerRef,j=e.elements,w=e.setOrdering,E=e.isSelected,S=e.isSelectedZObject,P=e.ordering,x=e.size,T=e.presentationMode,C=e.isInstrumentView,N=e.hidden,R=e.includeInPresentation,M=e.setSize,A=e.setSelectedZObject,q=e.uxLocked,D=e.isDeleted,I=e.setZObjectContextMenu,_=Object(s.useRef)(void 0),F=Object(s.useRef)(void 0),L=Object(s.useState)(u),B=Object(i.a)(L,2),z=B[0],V=B[1],H=Object(s.useState)(!1),U=Object(i.a)(H,2),J=U[0],G=U[1],W=Object(s.useCallback)(function(e){e.stopPropagation(),q||G(!0)},[q,G]),K=Object(s.useCallback)(function(e){e.stopPropagation(),q&&n.execute(),A(n)},[q,n,G]),X=Object(d.a)(W,250,K);Object(s.useEffect)(function(){V(u)},[V,u]),Object(s.useEffect)(function(){J&&!q&&F.current&&F.current.focus()},[J,q]),Object(s.useEffect)(function(){q&&G(!1)},[q,G]);var Q=Object(s.useCallback)(function(e){var t=e.target.value;n.text=t,V(t)},[V]),Y=Object(g.a)({scale:f,ref:_,sequencerEngine:l,sizeRef:p,containerRef:m,size:x,setSize:M,elements:j,element:n,setOrdering:w,ordering:P}),Z=Y.style,$=(Y.isDragging,Y.onMouseDown),ee=Y.onMouseUp,te=(Y.setCoords,Object(s.useCallback)(function(e){e.preventDefault(),e.stopPropagation();var t=m.current.getBoundingClientRect(),r=e.clientX-t.left,a=e.clientY-t.top;I(n.subSequence.id,{x:r,y:a},n)},[n])),ne=Object(a.a)({},Z),re=(Object(s.useCallback)(function(){n.execute()},[n]),Object(s.useCallback)(function(e){"Enter"===e.key&&(n.text=z,n.execute(),G(!1))},[G,z])),ae={};z&&z.length>0&&(n.isOutlet||n.isInlet||(ae.width=z.length+2+"ch")),ne=Object(a.a)({},ne,ae);var ie="z-object z-message";E&&(ie+=" selected"),S&&(ie+=" selected-object"),(n.isOutlet||n.isInlet)&&(ie+=" io"),R&&(ie+=" include-in-presentation"),n.type===b.a&&(ie+=" bang"),n.type===b.c&&(ie+=" number"),q&&(ie+=" locked");var oe=n.state.windows,se=T&&oe.presentationWindowPositions[n.id]||oe.windowPositions[n.id];if("custom"===h){var ce=[n.subSequence.zObject.width,n.subSequence.zObject.height],ue=ce[0],le=ce[1],fe=se;if(fe&&(fe.x>ue||fe.y>le))return""}if(D||N)return"";var he=n.attributes,pe={},de={};he&&(ne.backgroundColor=he["background-color"],de.color=he["primary-color"],pe.borderColor=he["primary-color"],pe.backgroundColor=he["secondary-color"],he.width&&(ne.width=he.width+"px",de.width=he.width+"px"),he["align to center"]&&(de["text-align"]="center"));var me=n.sequencerEngine.state.windows.windowPositions;return me[n.id]&&(ne.left=me[n.id].x,ne.top=me[n.id].y),c.a.createElement("div",(t={onClick:function(e){e.stopPropagation()},style:de,onMouseDown:"custom"===h?function(){return 0}:$,onContextMenu:te,onMouseUp:ee,ref:_},Object(r.a)(t,"style",ne),Object(r.a)(t,"className",ie),t),c.a.createElement(o.a,{isInstrumentView:C,zobject:n,windowRef:_}),n.type===b.c?c.a.createElement(O.a,{color:he&&he["primary-color"],isSelectedZObject:S,number:u,znumber:n}):n.type===b.a?c.a.createElement("div",{style:pe,onClick:function(){A(n),q&&n.execute()},className:"bang-button"}):n.isInlet?c.a.createElement(v,{zmessage:n}):n.isOutlet?c.a.createElement(v,{field:"outletNumber",icon:"outlet-icon",zmessage:n}):!J||q?c.a.createElement("div",{style:de,onClick:X,className:"message-content"},z):c.a.createElement("input",{spellcheck:"false",style:ae,onKeyDown:re,ref:F,onBlur:function(){return G(!1)},type:"text",className:"z-object-input",onChange:Q,value:z}),!n.isInlet&&c.a.createElement(y.a,{numInlets:n.numInlets,effect:n}),!n.isOutlet&&c.a.createElement(k.a,{numOutlets:n.numOutlets,subSequence:n.subSequence,containerRef:m,scale:f,effect:n}))})},function(e,t,n){"use strict";var r=n(99),a=n(0),i=n.n(a),o=n(12),s=Object(o.b)(function(e,t){return{trackStep:t.sequencerEngine.trackStep}},function(e){return{}})(function(e){var t=e.trackStep,n=(e.stepWidth,e.length),r=t%n*100/n;return i.a.createElement("div",{style:{width:r+"%"},className:"play-tick"})}),c=n(1100),u=n(6);function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=Object(o.b)(function(e,t){var n,r={selectedTrack:e.mix.selectedTrack},a=l(t.pad.tracks);try{for(a.s();!(n=a.n()).done;){var i=n.value;i&&(r[i.trackNumber]=e.tracks.trackSteps[i.id])}}catch(o){a.e(o)}finally{a.f()}return r},function(e){return{setShowPadSequencer:function(t){return e(Object(u.Uf)(t))}}})(function(e){e.container;var t=e.pad,n=e.selectedTrack,a=e.setShowPadSequencer,o=e.trackToShow,u=Object(r.a)(e,["container","pad","selectedTrack","setShowPadSequencer","trackToShow"]),l=t.patternLength,f=t.tracks.filter(function(e){return e})[0],h=f&&f.currentPattern;l==-1/0&&(l=32);var p=u.width?u.width:o?700:210;return i.a.createElement("div",{onClick:function(){return a(t)},style:{width:p},className:"visualizer"},i.a.createElement(s,{sequencerEngine:t.sequencerEngine,length:l,stepWidth:250/l}),t.tracks.filter(function(e){return e}).map(function(e){return i.a.createElement(c.a,{key:e.id,steps:u[e.trackNumber],isSelected:n===e.trackNumber,stepWidth:p/l,patternNumber:h,duration:l,track:e})}))})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(204),s=n(62),c=n(46),u=n(6),l=n(95),f=n(63),h=n(12),p=n(29),d=n(61),m=new p.a,v=new d.a,b=function(e){var t=e.track,n=e.value,r=e.editing,o=e.data,s=e.isCursor,u=e.isCurrent,l=e.color,h=e.parameterToEdit,p=e.setParameterToEdit,d=o.stepData,m=o.stepNumber;d||(d=v);var b=Object(a.useCallback)(function(e){t.sequencerEngine.operationManager.dispatch(Object(c.t)(t,2*m))},[m,t]),y=Object(a.useCallback)(function(e,n){p(n),r.current=!0,t.sequencerEngine.select(t.trackNumber,m)},[m,t]),k="tracker-step";return u&&(k+=" current"),s&&(k+=" cursor"),i.a.createElement("div",{onClick:d&&!d.on?b:function(){return[]},className:k},i.a.createElement("div",{className:"inner-step"},i.a.createElement("div",{onClick:b,className:m%8===0?"bar step-number":m%4===0?"half-bar step-number":"step-number"},m+1),d&&d.on?i.a.createElement("div",{className:"step-data"},i.a.createElement("div",{style:{color:l},onClick:function(e){return y(e,d.transposeParameter)},className:h===d.transposeParameter?"edit note-name":"note-name"},f.a.fromTranspose(d.transpose).toString()),i.a.createElement(g,{v:n,value:d.duration,parameter:d.durationParameter,parameterToEdit:h,setParameterToEdit:y}),i.a.createElement(g,{v:n,value:d.velocity,parameter:d.velocityParameter,parameterToEdit:h,setParameterToEdit:y})):""))},g=function(e){var t=e.value,n=e.parameter,r=e.setParameterToEdit,a=e.parameterToEdit;return i.a.createElement("div",{onClick:function(e){return r(e,n)},className:n===a?"edit tracker-parameter":"tracker-parameter"},t)};t.a=Object(h.b)(function(e,t){var n=t.track.sequencerEngine.cursor,r=e.mix.trackerParameterToEdit;return{trackSteps:e.tracks.trackSteps[t.track.id],stepBuckets:t.pattern.stepBuckets,parameterToEdit:r,isSelectedTrack:n.track===t.track.trackNumber}},function(e){return{setParameterToEdit:function(t){return e(Object(u.oh)(t))}}})(function(e){var t=e.track,n=e.pattern,c=e.currentStep,u=e.step,h=e.parameterToEdit,p=e.trackSteps,d=e.isSelectedTrack,v=e.cursorStep,g=e.editing,y=e.setParameterToEdit,k=Object(a.useState)(void 0),O=Object(r.a)(k,2),j=O[0],w=O[1],E=Object(a.useState)(h&&h.get()),S=Object(r.a)(E,2),P=S[0],x=S[1];Object(a.useEffect)(function(){h&&x(h.get())},[x,h]),Object(a.useEffect)(function(){w(m.getColorForTrack(t))},[t,w]),Object(a.useEffect)(function(){return window.addEventListener("keydown",T),function(){return window.removeEventListener("keydown",T)}},[h,x,t]);var T=Object(a.useCallback)(function(e){if(h&&h.track===t){e.stopPropagation();var n=h.get()||t.trackData.parameters.find(function(e){return e.name===h.name}).get();if(Object(s.a)(e.key)){var r=parseInt(e.key);h.set(r),x(r)}else if(e.key>="a"&&e.key<="g"){if("Transpose"===h.name){var a=f.a.fromTranspose(h.get());a.note=e.key.toUpperCase(),h.set(a.getTranspose()),x(a.getTranspose())}}else"ArrowUp"===e.key?(h.set(n+1),x(n+1)):"ArrowDown"===e.key&&(h.set(n-1),x(n-1))}},[h,x,t]),C=n.length()/2,N=function(e,t){for(var n=e.length(),r=[],a=-7;a<=7;a++){var i=Object(l.a)(2*(t+a),n),o=e.stepBuckets[i],s=o.getAnyOnStep()||o.steps[0];r.push({stepData:s,stepNumber:i/2})}return r}(n,(isNaN(u)?c:u)%C);return i.a.createElement("div",{className:"tracker"},i.a.createElement(o.a,{hasInner:!0,track:t}),N.map(function(e,n){return i.a.createElement(b,{parameterToEdit:h,setParameterToEdit:y,track:t,on:p&&p[e.stepNumber],value:P,key:n+"."+e.stepNumber,color:j,editing:g,isCursor:d&&e.stepNumber===v,isCurrent:e.stepNumber===c%C,data:e})}))})},function(e,t,n){"use strict";var r=n(8),a=n(99),i=n(0),o=n.n(i),s=n(86),c=new(n(29).a),u=n(382),l=n(203),f=n(540),h=(n(636),n(260)),p=n(12);t.a=Object(p.b)(function(e,t){return t.pad.effectRack?{coords:e.windows.windowPositions[t.pad.effectRack.outputNode.id],isSelected:e.windows.selectedElements[t.pad.effectRack.outputNode.id]}:{}},function(e){return{}})(function(e){var t=e.isMidi,n=e.pad,p=e.isSelected,d=e.coords,m=Object(a.a)(e,["isMidi","pad","isSelected","coords"]),v=Object(i.useRef)(void 0),b=Object(l.a)({ref:v}),g=b.onContextMenu,y=b.dropdownPos,k=b.setDropdownPos,O=Object(i.useRef)({x:0,y:0}),j=Object(h.a)(Object(r.a)({ref:v,element:n.effectRack&&n.effectRack.outputNode,windowPosition:d,sequencerEngine:n.sequencerEngine},m)),w=j.style,E=(j.isDragging,j.onMouseDown),S=j.onMouseUp,P=(j.setCoords,function(e){var t=e.id;return{backgroundColor:c.getColorForHash(t)}}({id:n&&n.effectRack&&n.effectRack.id}));Object(i.useEffect)(function(){d&&(O.current={x:d.x+150,y:d.y+150})},[d]);var x="pad-effect-control speakers";p&&(x+=" selected");var T=Object(r.a)({},w,P);return t&&(delete T.backgroundColor,x+=" midi-speakers"),d&&(T.left=d.x,T.top=d.y),n&&n.effectRack?[o.a.createElement("div",{key:1,onContextMenu:function(e){g(e),j.onContextMenu(e)},onMouseDown:E,onMouseUp:S,ref:v,style:T,className:x},t?o.a.createElement("div",{className:"speaker-name"},"Out"):o.a.createElement("img",{draggable:!1,src:"/speakers.svg"}),t?"":o.a.createElement(u.a,{effectOptions:s.a,initializeEffect:s.b,dropdownPosRef:O,dropdownPos:y,setDropdownPos:k,node:n}),o.a.createElement(f.a,{isSpeaker:!0,id:n.effectRack.id+"-speakers",containerRef:m.containerRef,pad:n,fx:n.effectRack.outputNode}))]:""})},,function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(749),u=n(65),l=n(70),f=n(44),h=n(756),p=n(31),d=n(179),m=n(40),v=n(47),b=new h.a,g=function(){function e(t){Object(o.a)(this,e),this.web3=t,this.root=new c.a,this.contract=b.getContract(t),this.contractAddress=b.contractAddress,this.isLoaded=!1}return Object(s.a)(e,[{key:"syncFolders",value:function(){var e=this;return new Promise(function(){var t=Object(i.a)(a.a.mark(function t(n,r){var i,o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.root.getJson(),t.next=3,v.a.addJson(i);case 3:o=t.sent,new l.a(f.g,"foldersUpdated",[Object(u.c)(o)]).execute().then(function(e){return n()});case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"loadFolders",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new m.a(this.contractAddress).from(p.d).select("foldersHash"),e.next=3,t.executeQuery();case 3:if(0!==(n=e.sent).length){e.next=6;break}return e.abrupt("return");case 6:return r=n[0].foldersHash,e.next=9,v.a.getJson(r);case 9:i=e.sent,this.root.fromJson(i,function(e){return(new d.a).fromJson(e)}),this.isLoaded=!0;case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();t.a=g},function(e,t,n){"use strict";var r=n(2),a=n(4),i=function(){function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"sampleHashes",type:"bytes32[16]"},{name:"titles",type:"bytes32[16]"},{name:"youtubeVideoIds",type:"bytes32[16]"},{name:"coverArtHashes",type:"bytes32[16]"},{name:"discogIds",type:"uint256[16]"},{name:"tagsToAdd",type:"bytes32[4][16]"},{name:"stylesToAdd",type:"bytes32[4][16]"},{name:"countries",type:"bytes32[16]"},{name:"sampleYears",type:"int16[16]"}],name:"newSampleWithMetadata",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"sampleHashes",type:"bytes32[16]"}],name:"test2",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{name:"c",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"sampleHash",type:"bytes32"},{indexed:!0,name:"discogsId",type:"uint256"},{indexed:!0,name:"coverArtHash",type:"bytes32"}],name:"NewDiscogsSample",type:"event"}],this.contractAddress="0x18d2c1f1f70ecbeb6366c65cef684e229ff6d6b9"}return Object(a.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}();t.a=i},function(e,t,n){"use strict";var r=n(9),a=n(8),i=n(5),o=n.n(i),s=n(14),c=n(2),u=n(4),l=n(500),f=n(31),h=n(40),p=n(52),d=n(70),m=n(44),v=(n(30),n(138),n(65)),b=new l.a,g=function(){function e(t){Object(c.a)(this,e),this.web3=t,this.contract=new t.eth.Contract(b.abi,b.contractAddress),this.contractAddress=this.contract.options.address,this.zero=this.web3.utils.padRight("0x00",64)}return Object(u.a)(e,[{key:"saveNewSequence",value:function(e,t,n,r,a){var i=this;return new Promise(function(){var c=Object(s.a)(o.a.mark(function s(c,u){var l,f;return o.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,p.a.getAccount();case 2:for(f in void 0===o.sent&&c(),l=[],r)l.push(Object(v.c)(r[f]));e=void 0===e?i.zero:Object(v.c)(e),t=Object(v.c)(t),l.push(e),new d.a(m.x,"editSequence",[e,t,n,l,a]).execute().then(function(e){return c}).catch(function(e){return u});case 10:case"end":return o.stop()}},s)}));return function(e,t){return c.apply(this,arguments)}}())}},{key:"getSequences",value:function(e,t,n,r){var i=this;return new Promise(function(){var c=Object(s.a)(o.a.mark(function s(c,u){var l,p;return o.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return l=new h.a(i.contractAddress).select("user").select("previousSequence").select("newSequence").select("title").fromBlock(t).toBlock(n).from(f.ob),void 0!==e&&l.where("user",e.toLowerCase()),r&&l.whereIn("newSequence",r),o.next=5,l.executeQuery(!1);case 5:(p=o.sent).sort(function(e,t){return t.blockNumber-e.blockNumber}),c(p.map(function(e){return Object(a.a)({},e,{edits:0})}));case 8:case"end":return o.stop()}},s)}));return function(e,t){return c.apply(this,arguments)}}())}},{key:"getNextSequences",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(r,i){var s,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=new h.a(n.contractAddress).select("user").select("previousSequence").select("newSequence").select("title").where("previousSequence",t).from(f.ob),e.next=3,s.executeQuery();case 3:c=e.sent,r(c.map(function(e){return Object(a.a)({},e,{edits:0})}));case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPreviousSequences",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(i,s){var c,u,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getPreviousSequence("+t+")"),c=new h.a(n.contractAddress).select("user").select("previousSequence").select("newSequence").select("title").where("newSequence",t).from(f.ob),e.next=4,c.executeQuery();case 4:if(0!==(u=(u=e.sent).map(function(e){return Object(a.a)({},e,{edits:0,isPrevious:!0})})).length&&u[0].previousSequence!==t){e.next=10;break}i(u),e.next=21;break;case 10:return l=u[0].previousSequence,e.t0=i,e.t1=[],e.t2=Object(r.a)(u),e.t3=r.a,e.next=17,n.getPreviousSequences(l);case 17:e.t4=e.sent,e.t5=(0,e.t3)(e.t4),e.t6=e.t1.concat.call(e.t1,e.t2,e.t5),(0,e.t0)(e.t6);case 21:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSequence",value:function(){var e=Object(s.a)(o.a.mark(function e(t){var n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(o.a.mark(function e(r,i){var s,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getSequence("+t+")"),s=new h.a(n.contractAddress).select("user").select("previousSequence").select("newSequence").select("title").where("newSequence",t).from(f.ob),e.next=4,s.executeQuery();case 4:c=e.sent,console.log("TOKENIZED SEQ =",c),r(c.map(function(e){return Object(a.a)({},e,{edits:0})}));case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"watchBalance",value:function(){var e=Object(s.a)(o.a.mark(function e(){var t,n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.getAccount();case 2:if(void 0!==(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:console.log("watch balance toUser = "+t),new h.a(this.contract.options.address).from(f.pb).select("amount").where("toUser",t.toLowerCase()).watchQuery(function(e){n.callback&&n.callback()});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();t.a=g},function(e,t,n){"use strict";var r=n(2);t.a=function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"},{name:"startMilliseconds",type:"int32"},{name:"endMilliseconds",type:"int32"}],name:"newSlice",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"},{name:"startMilliseconds",type:"int32[16]"},{name:"endMilliseconds",type:"int32[16]"}],name:"newSlices16",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"},{name:"startMilliseconds",type:"int32[4]"},{name:"endMilliseconds",type:"int32[4]"}],name:"newSlices4",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"},{name:"startMilliseconds",type:"int32[8]"},{name:"endMilliseconds",type:"int32[8]"}],name:"newSlices8",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"},{name:"tag",type:"bytes32"},{name:"startMilliseconds",type:"int32"},{name:"endMilliseconds",type:"int32"}],name:"newTaggedSlice",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"user",type:"address"},{indexed:!0,name:"sampleHash",type:"bytes32"},{indexed:!0,name:"tag",type:"bytes32"},{indexed:!1,name:"startMilliseconds",type:"int32"},{indexed:!1,name:"endMillisconds",type:"int32"}],name:"SliceCreated",type:"event"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"}],this.contractAddress="0xf68a5fccacd945904dbcc675752987c72f7d5bed"}},function(e,t,n){"use strict";var r=n(8),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(755),l=n(70),f=n(44),h=n(65),p=n(52),d=n(442),m=n(40),v=n(31),b=function(){function e(t,n){Object(s.a)(this,e),this.contract=(new u.a).getContract(t),this.web3=t,this.crypto=n,this.NULL_BYTES32=this.web3.utils.padLeft("0x0",64),this.cachedResults={}}return Object(c.a)(e,[{key:"getPublicKey",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(o.a)(i.a.mark(function e(r,a){var o,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=7;break}return e.next=3,p.a.getAccount();case 3:if(void 0!==(t=e.sent)){e.next=7;break}return r(void 0),e.abrupt("return");case 7:return o=new m.a(n.contract.options.address).from(v.G).select("publicKey").where("user",t.toLowerCase()),e.next=10,o.executeQuery();case 10:if(0!==(s=e.sent).length){e.next=14;break}return r(void 0),e.abrupt("return");case 14:c="0x"+n.stripTrailingZeroes(s[0].publicKey),r(n.web3.utils.toAscii(c));case 16:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getEncryptedContent",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n,r){var a,s,c=this,u=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>3&&void 0!==u[3]?u[3]:2,s=u.length>4?u[4]:void 0,e.abrupt("return",new Promise(function(){var e=Object(o.a)(i.a.mark(function e(o,u){var l,f,h,p,d,b;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in c.cachedResults)){e.next=3;break}return o(c.cachedResults[t]),e.abrupt("return");case 3:return e.next=5,new m.a(c.contract.options.address).from(v.p).select("newContent").select("user").select("previousContent").select("contentType").select("encryptedName").select("publicKey").select("encryptedContentKey").select("publicKey").fromBlock(a).toBlock(s);case 5:return l=e.sent,void 0!==r&&l.where("user",r.toLowerCase()),void 0!==t&&l.where("newContent",t),f=(new Date).getTime(),e.next=11,l.executeQuery();case 11:if(h=e.sent,p=(new Date).getTime(),p-f,0!==h.length){e.next=17;break}return o(void 0),e.abrupt("return");case 17:d=[],e.t0=i.a.keys(h);case 19:if((e.t1=e.t0()).done){e.next=28;break}return b=e.t1.value,e.t2=d,e.next=24,c.convertLogResult(h[b],n);case 24:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=19;break;case 28:(new Date).getTime(),p-f,c.cachedResults[t]=d,o(d);case 32:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getEncryptedContentSharedWithMe",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o,s,c,u,l,f;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.cachedResults)){e.next=2;break}return e.abrupt("return",this.cachedResults[t]);case 2:return e.next=4,p.a.getAccount();case 4:return r=e.sent,a=new m.a(this.contract.options.address).from(v.c).select("encryptedContentKey").select("publicKey").select("contentHash").select("creator").where("sharedWith",r.toLowerCase()),void 0!==t&&a.where("contentHash",t),o=(new Date).getTime(),e.next=10,a.executeQuery();case 10:if(s=e.sent,c=(new Date).getTime(),c-o,0!==s.length){e.next=15;break}return e.abrupt("return",void 0);case 15:u=[],e.t0=i.a.keys(s);case 17:if((e.t1=e.t0()).done){e.next=26;break}return l=e.t1.value,e.t2=u,e.next=22,this.convertSharedLogResult(s[l],!1,n);case 22:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=17;break;case 26:return f=(new Date).getTime(),f-o,this.cachedResults[t]=u,e.abrupt("return",u);case 30:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getEncryptedSequenceIfAny",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:2,a=o.length>3?o[3]:void 0,e.next=4,this.getEncryptedContent(t,void 0,n,r,a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSequencesSharedWithUser",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n,r){var a,o,s,c,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.getAccount();case 2:return a=e.sent,o=new m.a(this.contract.options.address).from(v.c).select("encryptedContentKey").select("publicKey").select("contentHash").select("creator").where("sharedWith",a.toLowerCase()),void 0!==t&&o.where("contentHash",t),n&&o.fromBlock(n),r&&o.toBlock(r),e.next=9,o.executeQuery();case 9:s=e.sent,c=[],e.t0=i.a.keys(s);case 12:if((e.t1=e.t0()).done){e.next=21;break}return u=e.t1.value,e.t2=c,e.next=17,this.convertSharedLogResult(s[u]);case 17:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=12;break;case 21:return e.abrupt("return",c);case 22:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"convertSharedLogResult",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,a,o,s,c,u=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(u.length>1&&void 0!==u[1])||u[1],e.next=3,this.crypto.decryptContentKey(t.encryptedContentKey);case 3:if(a=e.sent,o=this.stripTrailingZeroes(t.publicKey),{user:t.creator,contentHash:t.contentHash,publicKey:o,contentKey:a?a.contentKey:void 0},s={},c="",!n){e.next=15;break}return e.next=11,this.getEncryptedSequenceIfAny(t.contentHash);case 11:return s=e.sent,e.next=14,this.crypto.decryptName(s[0].encryptedTitle,this.stripTrailingZeroes(t.encryptedContentKey));case 14:c=e.sent;case 15:return e.abrupt("return",Object(r.a)({},s[0],{title:c,publicKey:o,contentKey:a?a.contentKey:void 0}));case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"convertLogResult",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.stripTrailingZeroes(t.encryptedContentKey),e.next=3,this.crypto.decryptName(t.encryptedName,r,n);case 3:return a=e.sent,o=t.user,e.next=7,this.crypto.decryptContentKey(r,n);case 7:return s=e.sent,c={title:this.stripTrailingZeroes(a),encryptedTitle:t.encryptedName,user:"0x"+this.stripLeadingZeroes(o.slice(2)),previousSequence:t.previousContent,newSequence:t.newContent,contentType:t.contentType,contentKey:s?s.contentKey:void 0,blockNumber:t.blockNumber,publicKey:this.stripTrailingZeroes(t.publicKey)},e.abrupt("return",c);case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"newPublicKey",value:function(e){return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:new l.a(f.d,"setPublicKey",[e]).execute().then(function(){return n()});case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"newEncryptedSequence",value:function(e,t,n,r,a){var s=this;return new Promise(function(){var c=Object(o.a)(i.a.mark(function o(c,u){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e=void 0===e?s.web3.utils.padLeft("0x0",64):Object(h.c)(e),t=Object(h.c)(t),n=s.web3.utils.padLeft("0x"+n,64),new l.a(f.d,"newEncryptedContent",[e,t,n,d.a,r,a]).execute().then(function(){return c()});case 4:case"end":return i.stop()}},o)}));return function(e,t){return c.apply(this,arguments)}}())}},{key:"newEncryptedContent",value:function(e,t,n,r,a){var s=this;return new Promise(function(){var c=Object(o.a)(i.a.mark(function o(c,u){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e=Object(h.c)(e),t=s.web3.utils.padLeft("0x"+t,64),new l.a(f.d,"newEncryptedContent",[s.NULL_BYTES32,e,t,r,n,a]).execute().then(function(){return c()});case 3:case"end":return i.stop()}},o)}));return function(e,t){return c.apply(this,arguments)}}())}},{key:"shareEncryptedContent",value:function(e,t,n,r){return new Promise(function(){var a=Object(o.a)(i.a.mark(function a(o,s){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t=Object(h.c)(t),new l.a(f.d,"shareEncryptedContentWith",[e,t,n,r]).execute().then(function(){return o()});case 2:case"end":return a.stop()}},a)}));return function(e,t){return a.apply(this,arguments)}}())}},{key:"stripTrailingZeroes",value:function(e){for(var t=e.length-1;t>=0;t--)if("0"!==e.slice(t,t+1))return e.slice(0,t+1)}},{key:"stripLeadingZeroes",value:function(e){for(var t=0;t<e.length;t++)if("0"!==e.slice(t,t+1))return e.slice(t)}},{key:"getPotentialUsers",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new m.a(this.contract.options.address).from(v.G).select("user"),e.next=3,t.executeQuery();case 3:return n=e.sent,r=Array.from(new Set(n.map(function(e){return e.user}))),e.abrupt("return",r.filter(function(e){return void 0!==e}));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();t.a=b},function(e,t,n){"use strict";var r=n(2);t.a=function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"}],name:"newIndex",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,name:"sampleHash",type:"bytes32"}],name:"NewIndex",type:"event"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{constant:!0,inputs:[],name:"getIndex",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"}],this.contractAddress="0xb05e78e48dc17fff1b52307e240cab6b241fe288"}},function(e,t,n){"use strict";var r=n(2);t.a=function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"previousSequences",type:"bytes32[4]"},{name:"newSequence",type:"bytes32"},{name:"diff",type:"bytes32"},{name:"title",type:"string"}],name:"editCompoundSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"previousSequence",type:"bytes32"},{name:"newSequence",type:"bytes32"},{name:"diff",type:"bytes32"},{name:"title",type:"string"}],name:"editSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"userEditing",type:"address"},{indexed:!0,name:"previousSequence",type:"bytes32"},{indexed:!0,name:"newSequence",type:"bytes32"},{indexed:!1,name:"diffHash",type:"bytes32"},{indexed:!1,name:"title",type:"string"}],name:"SequenceEdited",type:"event"}],this.contractAddress="0x16687b7db5994ac1aa22594be04af8396f5085dd"}},function(e,t,n){"use strict";var r=n(8),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(754),l=n(759),f=n(30),h=n(45),p=n(763),d=n(52),m=n(40),v=n(70),b=n(44),g=n(31),y=n(65),k=n(442);function O(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=new(n(269).a),E=(new l.a).contractAddress,S={},P=function(){function e(t,n,r){Object(s.a)(this,e),this.web3=t,this.contract=(new u.a).getContract(t),this.users=new p.a(t),this.crypto=n,this.encryption=r,this.guildKeyCache={},this.guildIdCache={},this.guildsWithAccess=void 0}return Object(c.a)(e,[{key:"initGuilds",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGuildsForUser();case 2:return this.guilds=e.sent,e.next=5,d.a.getAccount();case 5:if(void 0!==(t=e.sent)){e.next=8;break}return e.abrupt("return");case 8:if(navigator.onLine){e.next=10;break}return e.abrupt("return");case 10:new m.a(this.contract.options.address).from(g.q).select("guildId").where("user",t.toLowerCase()).watchQuery(function(){n.newGuildCallback&&n.newGuildCallback()});case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"saveGuildKey",value:function(e,t){this.guildKeyCache[e]=t}},{key:"getGuildKey",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.guildKeyCache)){e.next=5;break}return n=this.guildKeyCache[t],e.next=4,n;case 4:return e.abrupt("return",e.sent);case 5:return r=new Promise(function(){var e=Object(o.a)(i.a.mark(function e(n,r){var o,s,c,u,l,f,h,p;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((new Date).getTime(),void 0!==t){e.next=9;break}return e.next=4,a.getGuildsForUser();case 4:if(0!==(o=e.sent).length){e.next=8;break}return n(void 0),e.abrupt("return");case 8:t=o[0].guildId;case 9:return e.next=11,d.a.getAccount();case 11:if(void 0!==(s=e.sent)){e.next=15;break}return n(void 0),e.abrupt("return");case 15:return console.log("gettinng gulkd key ecrypted"),e.next=18,new m.a(a.contractAddress).from(g.e).select("ipfsHash").where("user",s.toLowerCase()).where("guildId",t).executeQuery();case 18:if(c=e.sent,console.log("results gguild=",c),0!==c.length){e.next=24;break}return delete a.guildKeyCache[t],n(void 0),e.abrupt("return");case 24:return u=c[0].ipfsHash,l=(new Date).getTime(),e.next=28,a.encryption.getEncryptedContent(u);case 28:if(void 0!==(f=e.sent)){e.next=33;break}return e.next=32,a.encryption.getEncryptedContentSharedWithMe(u);case 32:f=e.sent;case 33:if(console.log("encrypted content meta=",f),h=(new Date).getTime(),h-l,void 0!==f){e.next=40;break}return delete a.guildKeyCache[t],n(void 0),e.abrupt("return");case 40:return e.prev=40,e.t0=JSON,e.next=44,a.crypto.fetchAndDecrypt(u,f);case 44:e.t1=e.sent,p=e.t0.parse.call(e.t0,e.t1),(new Date).getTime(),h-l,n(a.crypto.parseGuildKey(p)),e.next=55;break;case 51:e.prev=51,e.t2=e.catch(40),console.log("error while decryptoing",e.t2),n(void 0);case 55:case"end":return e.stop()}},e,null,[[40,51]])}));return function(t,n){return e.apply(this,arguments)}}()),this.guildKeyCache[t]=r,e.next=9,r;case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"newGuildWithPeople",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a=this,s=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:Object(h.uuid)(),e.abrupt("return",new Promise(function(){var e=Object(o.a)(i.a.mark(function e(o,s){var c,u,l,f,h,p,d,m,g,k,j,w,E,S,P;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.crypto.generateGuildKey(r);case 2:return c=e.sent,c.privateKey,u=c.publicKey,e.next=7,a.crypto.encryptAndUploadJSON(c);case 7:l=e.sent,f=l.encryptedContentKey,h=l.encryptedContentIpfsHash,p=l.publicKey,d=[],m=[],g=[],k=O(n),e.prev=15,k.s();case 17:if((j=k.n()).done){e.next=31;break}return w=j.value,e.next=21,a.encryption.getPublicKey(w);case 21:return E=e.sent,e.next=24,a.crypto.encryptAndUploadJSON(c,E);case 24:S=e.sent,P=S.contentKey,d.push(Object(y.c)(S.encryptedContentIpfsHash)),m.push(P.convertForEthereum()),g.push(P.getPublicKeyAsBytes32());case 29:e.next=17;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(15),k.e(e.t0);case 36:return e.prev=36,k.f(),e.finish(36);case 39:new v.a(b.l,"createGuildWithPeople",[u,t,Object(y.c)(h),f,p]).execute().then(function(e){o()});case 40:case"end":return e.stop()}},e,null,[[15,33,36,39]])}));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"newGuild",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r=this,a=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:Object(h.uuid)(),e.abrupt("return",new Promise(function(){var e=Object(o.a)(i.a.mark(function e(a,o){var s,c,u,l,f,h;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.crypto.generateGuildKey(n);case 2:return s=e.sent,s.privateKey,c=s.publicKey,e.next=7,r.crypto.encryptAndUploadJSON(s);case 7:u=e.sent,l=u.encryptedContentKey,f=u.encryptedContentIpfsHash,h=u.publicKey,new v.a(b.h,"newGuild",[c,t,Object(y.c)(f),l,h]).execute().then(function(e){a(s)});case 12:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"requestToAddMember",value:function(e,t){var n=this;return new Promise(function(){var r=Object(o.a)(i.a.mark(function r(a,o){var s,c,u,l;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getGuildKey(e);case 2:return s=r.sent,r.next=5,n.encryption.getPublicKey(t);case 5:return c=r.sent,r.next=8,n.crypto.encryptAndUploadJSON(s,c);case 8:u=r.sent,l=u.contentKey,new v.a(b.h,"requestToAddMember",[e,t,Object(y.c)(u.encryptedContentIpfsHash),l.convertForEthereum(),l.getPublicKeyAsBytes32()]).execute().then(function(e){a()});case 11:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}},{key:"leaveGuild",value:function(e){return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:new v.a(b.l,"leaveGuild",[e]).execute().then(function(e){n()});case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"voteForProposal",value:function(e,t,n){var r=this;return new Promise(function(){var a=Object(o.a)(i.a.mark(function a(o,s){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=r.contract.methods.voteOnNewGuildMemberProposal(e,t,n),a.next=3,d.a.getAccount();case 3:a.t1=a.sent,a.t2={from:a.t1},a.t3=function(e,t){e?s(e):o()},a.t0.send.call(a.t0,a.t2,a.t3);case 7:case"end":return a.stop()}},a)}));return function(e,t){return a.apply(this,arguments)}}())}},{key:"getAllGuildMemberProposals",value:function(){var e=this;return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){var a,o,s,c,u,l;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getGuildsForUser();case 2:a=t.sent,o=[],t.t0=i.a.keys(a);case 5:if((t.t1=t.t0()).done){t.next=14;break}return s=t.t1.value,c=a[s].guildId,t.next=10,e.getGuildMemberProposals(c);case 10:for(l in u=t.sent)o.push({guildId:c,proposalIndex:l,potentialMember:u[l]});t.next=5;break;case 14:n(o);case 15:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getGuildMemberProposals",value:function(e){var t=this;return new Promise(function(){var n=Object(o.a)(i.a.mark(function n(r,a){var o,s,c,u,l;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.web3.eth.getAccounts();case 2:return o=n.sent,n.next=5,t.contract.methods.getTotalGuildMemberProposals(e).call({from:o[0]});case 5:s=n.sent,c=[],u=0;case 8:if(!(u<s)){n.next=16;break}return n.next=11,t.contract.methods.getNewGuildMemberProposal(e,u).call({from:o[0]});case 11:l=n.sent,c.push(l);case 13:u++,n.next=8;break;case 16:r(c);case 17:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"contractAddress",get:function(){return this.contract.options.address}},{key:"getNewMemberRequestsFromGuild",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.getAccount();case 2:if(void 0!==e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:return e.next=7,new m.a(this.contractAddress).from(g.s).select("newMember").where("guildId",t).executeQuery(!1);case 7:return n=e.sent,e.next=10,new m.a(this.contractAddress).from(g.t).select("newMember").where("guildId",t).executeQuery(!1);case 10:return r=e.sent,e.next=13,new m.a(this.contractAddress).from(g.u).select("newMember").where("guildId",t).executeQuery(!1);case 13:return a=e.sent,o=n.filter(function(e){return!r.some(function(t){return e.newMember===t.newMember})&&!a.some(function(t){return e.newMember===t.newMember})}),e.abrupt("return",o);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"acceptAnyNewRequests",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d.a.isLoggedIn()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getNewMemberRequests();case 4:e.sent.forEach(function(e){var n=e.guildId;return t.acceptRequestToAddToGuild(n)});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getNewMemberRequests",value:function(){var e=this;return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){var a,o,s,c,u,l,f,h,p,v;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.getAccount();case 2:if(void 0!==(a=t.sent)){t.next=6;break}return n([]),t.abrupt("return");case 6:return t.next=8,new m.a(e.contractAddress).from(g.s).select("guildId").select("requester").where("newMember",a.toLowerCase()).executeQuery(!1);case 8:for(c in o=t.sent,s={},o)s[o[c].guildId]={requester:o[c].requester,blockNumber:o[c].blockNumber};return s=e.reduceMap(s),t.next=14,new m.a(e.contractAddress).from(g.t).select("guildId").where("newMember",a.toLowerCase()).executeQuery(!1);case 14:return u=(u=t.sent).map(function(e){return e.guildId}),t.next=18,new m.a(e.contractAddress).from(g.u).select("guildId").where("newMember",a.toLowerCase()).executeQuery(!1);case 18:l=(l=t.sent).map(function(e){return e.guildId}),f=[],t.t0=i.a.keys(s);case 22:if((t.t1=t.t0()).done){t.next=38;break}if(h=t.t1.value,p=e.countOccurences(u,parseInt(h)),v=e.countOccurences(l,parseInt(h)),!(s[h].count>p+v)){t.next=36;break}return t.t2=f,t.t3=parseInt(h),t.next=31,e.getGuildName(parseInt(h));case 31:t.t4=t.sent,t.t5=s[h].requester,t.t6=s[h].blockNumber,t.t7={guildId:t.t3,guildName:t.t4,requester:t.t5,blockNumber:t.t6},t.t2.push.call(t.t2,t.t7);case 36:t.next=22;break;case 38:n(f);case 39:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"reduceMap",value:function(e){var t={};for(var n in e){for(var r in t)r!==n||t[r].count++;t[n]=e[n],t[n].count=1}return t}},{key:"countOccurences",value:function(e,t){var n=0;for(var r in e)e[r]===t&&n++;return n}},{key:"rejectRequestToAddToGuild",value:function(e){return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:new v.a(b.h,"rejectRequestToAddToGuild",[e]).execute().then(function(e){n()});case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"acceptRequestToAddToGuild",value:function(e){return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:new v.a(b.h,"acceptRequestToAddToGuild",[e]).execute().then(function(e){n()});case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getAllMembersInUsersGuilds",value:function(e){var t=this;return new Promise(function(){var n=Object(o.a)(i.a.mark(function n(a,o){var s,c,u,l,f;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.a.getAccount();case 2:return s=n.sent,n.next=5,t.getGuildsForUser(e);case 5:c=n.sent,u=[],l=i.a.mark(function e(n){var a,o,l;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=c[n],o=a.guildId,e.next=4,t.getUsersInGuild(o);case 4:l=(l=(l=e.sent).filter(function(e){return e.userId!==s})).map(function(e){return Object(r.a)({},e,{guildId:o,guildName:a.name})}),u=u.concat(l);case 8:case"end":return e.stop()}},e)}),n.t0=i.a.keys(c);case 9:if((n.t1=n.t0()).done){n.next=14;break}return f=n.t1.value,n.delegateYield(l(f),"t2",12);case 12:n.next=9;break;case 14:a(u);case 15:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getGuildsUserLeft",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}return e.next=3,d.a.getAccount();case 3:t=e.sent;case 4:return n=new m.a(E).from(g.qb).select("guildId"),e.next=7,n.executeQuery();case 7:return r=e.sent,e.abrupt("return",r.map(function(e){return e.guildId}));case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getGuildsForUser",value:function(e){var t=this;!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(function(){var n=Object(o.a)(i.a.mark(function n(r,a){var o,s,c,u,l,f,h,p,v;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.a.getAccount();case 2:if(o=n.sent,void 0===e&&(e=o),void 0!==e){n.next=7;break}return r([]),n.abrupt("return");case 7:return n.next=9,t.getGuildsUserLeft(o);case 9:return s=n.sent,[],c=new m.a(t.contract.options.address).from(g.e).select("guildId").where("user",e.toLowerCase()),n.next=14,c.executeQuery(!1);case 14:u=n.sent,l={},n.t0=i.a.keys(u);case 17:if((n.t1=n.t0()).done){n.next=26;break}return f=n.t1.value,h=u[f].guildId,n.next=22,t.getGuildName(h);case 22:p=n.sent,l[h]=p,n.next=17;break;case 26:v=Object.keys(l).filter(function(e){return!s.includes(parseFloat(e))}).map(function(e){return{guildId:parseInt(e),name:l[e]}}),r(v);case 28:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"hasAccessTo",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,this.getGuildsWithAccess();case 4:return n=e.sent,e.abrupt("return",n.indexOf(t)>-1);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getGuildsWithAccess",value:function(e){var t=this;return new Promise(function(){var n=Object(o.a)(i.a.mark(function n(r,a){var o,s,c;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===t.guildsWithAccess){n.next=3;break}return r(t.guildsWithAccess),n.abrupt("return");case 3:return n.next=5,d.a.getAccount();case 5:if(o=n.sent,void 0===e&&(e=o),void 0!==e){n.next=11;break}return t.guildsWithAccess=[],r([]),n.abrupt("return");case 11:return[],s=new m.a(t.contract.options.address).from(g.e).select("guildId").where("user",e.toLowerCase()),n.next=15,s.executeQuery(!1);case 15:c=n.sent,t.guildsWithAccess=Array.from(new Set(c.map(function(e){return e.guildId}))),r(t.guildsWithAccess);case 18:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getGuildName",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return","");case 2:if(!(t in S)){e.next=6;break}return e.next=5,S[t];case 5:return e.abrupt("return",e.sent);case 6:return n=new Promise(function(){var e=Object(o.a)(i.a.mark(function e(n,a){var o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=new m.a(r.contract.options.address).from(g.q).select("name").where("guildId",t),e.next=3,o.executeQuery(!1);case 3:if(0!==(s=e.sent).length){e.next=6;break}return e.abrupt("return","");case 6:n(s[0].name);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),S[t]=n,e.next=10,n;case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getUsersInGuild",value:function(e){var t=this;return new Promise(function(){var n=Object(o.a)(i.a.mark(function n(r,a){var o,s,c,u,l;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(navigator.onLine){n.next=3;break}return r([]),n.abrupt("return");case 3:return n.next=5,d.a.getAccount();case 5:return n.sent,o=[],n.prev=7,n.next=10,t.contract.methods.getTotalGuildUsers(e).call();case 10:s=n.sent,c=0;case 12:if(!(c<s)){n.next=23;break}return n.next=15,t.contract.methods.getUserFromGuild(e,c).call();case 15:return u=n.sent,n.next=18,t.users.getUserName(u);case 18:l=n.sent,o.push({userId:u,userName:l});case 20:c++,n.next=12;break;case 23:n.next=27;break;case 25:n.prev=25,n.t0=n.catch(7);case 27:r(o);case 28:case"end":return n.stop()}},n,null,[[7,25]])}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"setGuildName",value:function(e,t){var n=this;return new Promise(function(){var r=Object(o.a)(i.a.mark(function r(a,o){var s;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.web3.eth.getAccounts();case 2:s=r.sent,n.contract.methods.setNameForGuild(e,t).send({from:s[0]},function(e,t){e?o(e):a()});case 4:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}},{key:"getContentGuildId",value:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var r,a,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.guildIdCache)){e.next=2;break}return e.abrupt("return",this.guildIdCache[t]);case 2:if(n!==k.b){e.next=16;break}return r=new m.a(w.contractAddress).from(g.Y).select("guildId").where("ipfsHash",t),e.next=6,r.executeQuery(!1);case 6:if(0!==(a=e.sent).length){e.next=10;break}return this.guildIdCache[t]=0,e.abrupt("return",0);case 10:return o=null===(o=a[0].guildId)||void 0===o?0:o,this.guildIdCache[t]=o,e.abrupt("return",o);case 16:return e.next=18,f.a.guildSequences.getGuildSequence(t);case 18:if(!(s=e.sent)){e.next=21;break}return e.abrupt("return",s.guildId);case 21:return e.abrupt("return",0);case 22:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onUserChanged",value:function(){this.guildsWithAccess=void 0,this.getGuildsWithAccess()}},{key:"getPeople",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new m.a(this.contractAddress).from(g.e).select("user").executeQuery();case 2:t=e.sent,n=[],e.t0=i.a.keys(t);case 5:if((e.t1=e.t0()).done){e.next=14;break}return r=e.t1.value,a=t[r].user,e.next=10,this.users.getUserName(a);case 10:o=e.sent,n.push({id:a,userName:o}),e.next=5;break;case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();t.a=P},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(8),o=n(14),s=n(2),c=n(4),u=n(516),l=n(94),f=n(52),h=n(65),p=n(70),d=n(44),m=n(40),v=n(31),b=n(352),g=n(47),y=new u.a,k=function(){function e(t,n,r,a){Object(s.a)(this,e),this.web3=t,this.encryption=r,this.crypto=a,this.guilds=n,this.contract=y.getContract(t),this.contractAddress=y.contractAddress,this.NULL_BYTES_32=t.utils.padLeft("0x0",64)}return Object(c.a)(e,[{key:"newGuildSequence",value:function(e,t,n,r){var s=this;return new Promise(function(){var c=Object(o.a)(a.a.mark(function o(c,u){var m,v,b,y,k,O,j;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.guilds.getGuildKey(r);case 2:return m=a.sent,v=m.rawPublicKey,a.next=6,s.crypto.encryptRawContent(JSON.stringify(e),t,v);case 6:return b=a.sent,b.contentKey.contentKey,a.next=10,g.a.addJson(b.encryptedContent);case 10:return y=a.sent,a.next=13,f.a.getAccount();case 13:void 0===a.sent&&u("No accounts"),k=s.web3.utils.padLeft("0x"+b.encryptedName,64),O={contentHash:y,previousHash:n,encryptedName:k,encryptedContentKey:b.encryptedContentKey,publicKey:m.publicKey,guildId:r},l.a.setItem("guildSequence."+y,JSON.stringify(O)),j=Object(i.a)({},e),l.a.setItem("projectData",JSON.stringify(j)),l.a.setItem("projectHash",y),new p.a(d.k,"editSequence",[n?Object(h.c)(n):s.NULL_BYTES_32,Object(h.c)(y),k,b.encryptedContentKey,m.publicKey,r]).execute(),c(y);case 23:case"end":return a.stop()}},o)}));return function(e,t){return c.apply(this,arguments)}}())}},{key:"getGuildSequence",value:function(){var e=Object(o.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new m.a(this.contractAddress).select("contentHash").select("previousHash").select("user").select("encryptedName").select("guildId").select("encryptedContentKey").select("publicKey").from(v.v).where("contentHash",t),e.next=3,n.executeQuery();case 3:if(0!==(r=e.sent).length){e.next=13;break}if(i="guildSequence."+t,!(o=l.a.getItem(i))){e.next=12;break}o=JSON.parse(o),r=[o],e.next=13;break;case 12:return e.abrupt("return",void 0);case 13:return s=r[0],c=s.guildId,e.next=17,this.guilds.getGuildKey(c);case 17:return u=e.sent,e.abrupt("return",this._decryptQueryResult(s,u.privateKey));case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getGuildSequences",value:function(){var e=Object(o.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(l.length>1&&void 0!==l[1])||l[1],r=new m.a(this.contractAddress).select("contentHash").select("previousHash").select("user").select("encryptedName").select("encryptedContentKey").select("publicKey").select("guildId").from(v.v).where("guildId",t),n){e.next=7;break}return e.next=5,f.a.getAccount();case 5:void 0!==(i=e.sent)&&r.where("address",i.toLowerCase());case 7:return e.next=9,r.executeQuery();case 9:if(0!==(o=e.sent).length){e.next=12;break}return e.abrupt("return",[]);case 12:return e.next=14,this.guilds.getGuildKey(t);case 14:if(void 0!==(s=e.sent)){e.next=17;break}return e.abrupt("return",[]);case 17:c=[],e.t0=a.a.keys(o);case 19:if((e.t1=e.t0()).done){e.next=28;break}return u=e.t1.value,e.t2=c,e.next=24,this._decryptQueryResult(o[u],s.privateKey);case 24:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=19;break;case 28:return e.abrupt("return",c);case 29:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_decryptQueryResult",value:function(){var e=Object(o.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=7;break}return e.next=3,this.guilds.getGuildKey(t.guildId);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return",void 0);case 6:n=r.privateKey;case 7:return i=Object(b.b)(t.encryptedContentKey),e.next=10,this.crypto.decryptName(t.encryptedName,i,n);case 10:return o=e.sent,s=t.user,e.next=14,this.crypto.decryptContentKey(i,n);case 14:return c=e.sent,u={title:Object(b.b)(o),encryptedTitle:t.encryptedName,user:s,newSequence:t.contentHash,previousSequence:t.previousHash,guildId:t.guildId,contentKey:c?c.contentKey:void 0,blockNumber:t.blockNumber,publicKey:t.publicKey&&Object(b.b)(t.publicKey)},e.abrupt("return",u);case 17:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}();t.a=k},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(758),o=(n(65),n(44),n(70),function(){function e(t){Object(r.a)(this,e),this.web3=t,this.contract=(new i.a).getContract(t)}return Object(a.a)(e,[{key:"newResample",value:function(e,t,n,r,a){}}]),e}());t.a=o},,,function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["1","162/149","81/64","4/3","3/2","18/11","4096/2187","2/1"]},,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return useDropScaleFile});var _Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);function _createForOfIteratorHelper(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"===typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var useDropScaleFile=function useDropScaleFile(_ref){var ref=_ref.ref,effect=_ref.effect,setAnnotation=_ref.setAnnotation,setScale=_ref.setScale;Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(function(){ref.current.addEventListener("dragenter",function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.effectAllowed="none",e.dataTransfer.dropEffect="none"},!1),ref.current.addEventListener("dragover",function(e){return e.stopPropagation(),e.preventDefault(),e.dataTransfer.effectAllowed="none",!1}),ref.current.addEventListener("drop",function(){var _ref2=Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee2(ev){var i;return _Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(console.log("DROPPING"),ev.preventDefault(),ev.stopPropagation(),ev.dataTransfer.effectAllowed="none",ev.dataTransfer.dropEffect="none",ev.dataTransfer.items)for(i=0;i<ev.dataTransfer.items.length;i++)"file"===ev.dataTransfer.items[i].kind&&function(){var file=ev.dataTransfer.items[i].getAsFile(),reader=new FileReader;reader.readAsText(file),reader.onloadend=Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee(){var text,lines,comments,numbers,_iterator,_step,line,number;return _Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:text=reader.result,lines=text.split("\n"),comments=lines.filter(function(e){return e.startsWith("!")}).map(function(e){return e.slice(1).trim()}).join("\n"),console.log("FILE = ",text,comments),numbers=[],_iterator=_createForOfIteratorHelper(lines);try{for(_iterator.s();!(_step=_iterator.n()).done;){line=_step.value;try{number=eval(line),"number"===typeof number&&numbers.push(line)}catch(e){}}}catch(err){_iterator.e(err)}finally{_iterator.f()}console.log("NUMBERS =",numbers),numbers[0]=1,effect.scale=numbers,setScale(numbers),setAnnotation(comments);case 12:case"end":return _context.stop()}},_callee)}))}();return _context2.abrupt("return",!1);case 7:case"end":return _context2.stop()}},_callee2)}));return function(e){return _ref2.apply(this,arguments)}}())},[setAnnotation,setScale,effect,ref])}},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return b});var r=n(9),a=n(5),i=n.n(a),o=n(14),s=(n(47),n(625)),c=n(888),u=n(15),l=n.n(u),f=n(222),h=(n(106),n(1467)),p=n(75),d=n(6);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e){window.addEventListener("dragenter",function(e){e.preventDefault(),e.dataTransfer.effectAllowed="none",e.dataTransfer.dropEffect="none"},!1),window.addEventListener("dragover",function(e){return e.preventDefault(),e.dataTransfer.effectAllowed="none",!1}),window.addEventListener("drop",function(){var t=Object(o.a)(i.a.mark(function t(n){var r,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),n.dataTransfer.effectAllowed="none",n.dataTransfer.dropEffect="none",n.dataTransfer.items)for(r=n.dataTransfer.items.length,e.dispatch(Object(d.Ob)(r)),a=0;a<n.dataTransfer.items.length;a++)"file"===n.dataTransfer.items[a].kind&&(e.dispatch(Object(d.yh)(!0)),g(e,n.dataTransfer.items[a].getAsFile()));else for(a=0;a<n.dataTransfer.files.length;a++);return t.abrupt("return",!1);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}function g(t,n){var a=new FileReader;n.name.includes(".wav")||n.name.includes(".flac")||n.name.includes(".mp3")?(a.readAsArrayBuffer(n),a.onloadend=Object(o.a)(i.a.mark(function o(){var u,v,b,g,y,k,O;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(u=a.result,b=new p.a(f.a),!n.name.includes("flac")){i.next=11;break}return i.next=5,Object(h.a)(new Int8Array(u));case 5:return u=i.sent,i.next=8,l.a.Master.context.decodeAudioData(u);case 8:v=i.sent,i.next=21;break;case 11:if(!n.name.includes("mp3")){i.next=18;break}return i.next=14,Object(c.a)(new Int8Array(u));case 14:v=i.sent,b.mp3Data=new e(u),i.next=21;break;case 18:return i.next=20,l.a.Master.context.decodeAudioData(u);case 20:v=i.sent;case 21:b.tags=[],g=m(s.a);try{for(g.s();!(y=g.n()).done;)k=y.value,n.name.toLowerCase().includes(k.toLowerCase())&&b.tags.push(k)}catch(o){g.e(o)}finally{g.f()}b.tags.length>0&&console.log("tags for %s = ",n.name,b.tags),b.audioBuffer=v,b.needsSave=!0,t.dispatch(Object(d.yh)(!1)),b.name=n.name,t.recordingsToSave.push(b),O=Object(r.a)(t.state.samples.samplesToSave),t.dispatch(Object(d.Oe)([].concat(Object(r.a)(O),[b])));case 32:case"end":return i.stop()}},o)}))):window.alert("Only accepts .wav, .mp3, & .flac files for now")}}).call(this,n(27).Buffer)},,,,function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(7),u=n(10),l=n(1),f=n(188),h=n(44),p=n(40),d=(n(192),n(65)),m=n(70),v=n(138),b=n(31);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}function y(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}n(52);var j=n(30),w=n(47);function E(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var x=n(1080),T=n(518);function C(e){return N.apply(this,arguments)}function N(){return(N=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===v.e?3:14;break;case 3:return console.log("link type was correct"),n=new x.a,e.next=7,n.executeQuery();case 7:return e.next=9,n.getNext();case 9:if(!e.sent){e.next=13;break}console.log("getting next"),e.next=7;break;case 13:return e.abrupt("return",j.a.collapseAllSequences(n.results).map(function(e){return new T.a(void 0,void 0,e.newSequence,void 0,e.title)}));case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}var R=function e(){Object(o.a)(this,e)};function M(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var D={},I=n(749),_=n(75),F=n(341);function L(e,t){return B.apply(this,arguments)}function B(){return(B=Object(i.a)(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===v.e?3:7;break;case 3:return e.next=5,H(n);case 5:return r=e.sent,e.abrupt("return",r.map(function(e){return{linkType:t,fromData:n,toData:e}}));case 7:return e.next=9,j.a.xanadu.getLinks(t,n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function z(e,t,n){return V.apply(this,arguments)}function V(){return(V=Object(i.a)(a.a.mark(function e(t,n,r){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===v.e?3:8;break;case 3:return(i=new _.a(r)).fromData=n,e.next=7,i.fetchMetadata();case 7:return e.abrupt("return",i);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function H(e){return U.apply(this,arguments)}function U(){return(U=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.getJson(t);case 2:return n=e.sent,e.abrupt("return",Object(F.a)(n));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function J(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var G=function(e){Object(c.a)(n,e);var t=J(n);function n(e,r,a,i){var s,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return Object(o.a)(this,n),(s=t.call(this,a,i,c)).linkType=e,s.fromData=r,s.isLoaded=!1,s}return Object(s.a)(n,[{key:"isDynamic",value:function(){return!0}},{key:"load",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:j.a.xanadu,!this.isRoot()){e.next=5;break}return e.next=4,this.loadRoot(t);case 4:return e.abrupt("return");case 5:return e.next=7,L(this.linkType,this.fromData);case 7:n=e.sent,e.t0=a.a.keys(n);case 9:if((e.t1=e.t0()).done){e.next=19;break}return r=e.t1.value,i=n[r],e.t2=this,e.next=15,z(this.linkType,this.fromData,i.toData);case 15:e.t3=e.sent,e.t2.addItem.call(e.t2,e.t3),e.next=9;break;case 19:this.isLoaded=!0;case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadRoot",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t=this,r=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>0&&void 0!==r[0]?r[0]:j.a.xanadu,e.next=3,C(this.linkType);case 3:return e.sent.map(function(e){return new n(t.linkType,e.getId(),e.getName(),t)}).forEach(function(e){return t.addFolder(e)}),this.isLoaded=!0,e.abrupt("return",this);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(I.a);function W(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}function K(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var X=function(e){Object(c.a)(n,e);var t=K(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this)).web3=e,r.contract=(new f.a).getContract(e),r.linkFolder=new G(v.e),r.sequencesCache=void 0,r}return Object(s.a)(n,[{key:"load",value:function(){return this.linkFolder.loadRoot(this)}},{key:"newDataType",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new m.a(h.w,"newDataType",[this.web3.utils.fromAscii(t),n]).execute();case 2:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"newLinkType",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new m.a(h.w,"newLinkType",[this.web3.utils.fromAscii(t),n]).execute();case 2:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"newLinks",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new m.a(h.w,"newLink",[this.web3.utils.fromAscii(t),n,r]).execute();case 2:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getDataTypes",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new p.a((new f.a).contractAddress).from(b.m).select("dataType").select("description"),e.next=3,t.executeQuery();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getLinkTypes",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new p.a((new f.a).contractAddress).from(b.y).select("linkType").select("description"),e.next=3,t.executeQuery();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getLinks",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o,s,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new p.a((new f.a).contractAddress).from(b.x).select("fromData").select("toData").where("linkType",t),n&&i.where("fromData",n),r&&i.where("toData",r),e.next=5,i.executeQuery();case 5:o=e.sent,s=[],c=function(e){var t=o[e].fromData;if(s.some(function(e){return e.fromData===t}))return"continue";s.push(o[e])},e.t0=a.a.keys(o);case 9:if((e.t1=e.t0()).done){e.next=16;break}if(u=e.t1.value,"continue"!==c(u)){e.next=14;break}return e.abrupt("continue",9);case 14:e.next=9;break;case 16:return e.abrupt("return",s);case 17:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(function(e){return function(e){Object(c.a)(n,e);var t=W(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"presetResampled",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.newLinks(v.c,Object(d.c)(t),Object(d.c)(n));case 2:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getResampledPreset",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLinks(v.c,t);case 2:if(0!==(n=e.sent).length){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.abrupt("return",n[0].toData);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),n}(e)}(function(e){return function(e){Object(c.a)(n,e);var t=O(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"syncProjectBPM",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new m.a(h.w,"newAnnotation",[this.web3.utils.fromAscii(v.d),Object(d.c)(t),this.web3.utils.fromAscii(n.toString())]).execute();case 2:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getProjectsWithBPM",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o,s,c,u,l,h,d;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new p.a((new f.a).contractAddress).from(b.j).select("data").select("annotationData").where("annotationType",v.d).whereIn("data",t),r&&i.where("address",r.toLowerCase()),e.next=4,i.executeQuery();case 4:o=e.sent,s={},c=y(o);try{for(c.s();!(u=c.n()).done;)l=u.value,h=l.data,d=parseInt(l.annotationData),void 0===s[h]&&d===n&&(s[h]=d)}catch(a){c.e(a)}finally{c.f()}return e.abrupt("return",Object.keys(s));case 9:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getProjectBPM",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new p.a((new f.a).contractAddress).from(b.j).select("data").select("annotationData").where("data",t).where("annotationType",v.d),n&&r.where("address",n.toLowerCase()),e.next=4,r.executeQuery();case 4:if(0!==(i=e.sent).length){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.abrupt("return",parseInt(i[0].annotationData));case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}]),n}(e)}(function(e){return function(e){Object(c.a)(n,e);var t=q(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"rateSound",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:v.f,e.next=3,new m.a(h.w,"newAnnotation",[this.web3.utils.fromAscii(r),Object(d.c)(t),this.web3.utils.fromAscii(n.toString())]).execute();case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSoundsWithRating",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o,s,c,u,l,h,d;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new p.a((new f.a).contractAddress).from(b.j).select("data").select("annotationData").whereIn("data",t),r&&i.where("address",r.toLowerCase()),e.next=4,i.executeQuery();case 4:o=e.sent,s={},c=M(o);try{for(c.s();!(u=c.n()).done;)l=u.value,h=l.data,d=parseInt(l.annotationData),void 0===s[h]&&d===n&&(s[h]=d)}catch(a){c.e(a)}finally{c.f()}return e.abrupt("return",Object.keys(s));case 9:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getSoundRating",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:v.f,r=c.length>2?c[2]:void 0,i=n+"."+t,r&&(i+=" "+r),!(i in D)){e.next=6;break}return e.abrupt("return",D[i]);case 6:return o=new p.a((new f.a).contractAddress).from(b.j).select("data").select("annotationData").where("data",t),r&&o.where("address",r.toLowerCase()),e.next=10,o.executeQuery();case 10:if(0!==(s=e.sent).length){e.next=14;break}return D[i]=void 0,e.abrupt("return",void 0);case 14:return D[i]=parseInt(s[0].annotationData),e.abrupt("return",D[i]);case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),n}(e)}(function(e){return function(e){Object(c.a)(n,e);var t=g(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"syncPadType",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new m.a(h.w,"newAnnotation",[this.web3.utils.fromAscii(v.a),Object(d.c)(t),this.web3.utils.fromAscii(n)]).execute();case 2:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getPacksWithType",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new p.a((new f.a).contractAddress).from(b.j).select("data").select("annotationData").where("annotationData",n),e.next=3,i.executeQuery();case 3:return o=e.sent,e.abrupt("return",o.map(function(e){return e.data}));case 5:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(e)}(function(e){Object(c.a)(n,e);var t=P(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).annotationContentCache={},e}return Object(s.a)(n,[{key:"newAnnotationType",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new m.a(h.w,"newAnnotationType",[this.web3.utils.fromAscii(t),n]).execute();case 2:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getAnnotations",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=s.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=s[i];return o=new p.a((new f.a).contractAddress).from(b.j).select("data").select("annotationData").select("address").where("annotationType",t).whereIn("data",r),e.next=4,o.executeQuery();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getContentReferences",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new p.a((new f.a).contractAddress).from(b.j).select("data").where("annotationData",t),e.next=3,n.executeQuery();case 3:return r=e.sent,e.abrupt("return",r.map(function(e){return e.data}));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getFlattenedAnnotations",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,o,s,c,u,l,f,h,p,d,m,v=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=v.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=v[i];return e.next=3,this.getAnnotations.apply(this,[t].concat(r));case 3:o=e.sent,s={},c=E(o);try{for(c.s();!(u=c.n()).done;)l=u.value,(f=l.annotationData)in s||(s[f]=[]),s[f].push(l)}catch(a){c.e(a)}finally{c.f()}for(p in h=[],s)d=s[p],m={annotationData:p,address:d[0].address,contentHashes:d.map(function(e){return e.data}),blockNumber:d[0].blockNumber},h.push(m);return e.abrupt("return",h);case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAnnotationContents",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAnnotations(t,n);case 2:r=e.sent,i=this.web3.utils,o=E(r),e.prev=5,o.s();case 7:if((s=o.n()).done){e.next=17;break}return c=s.value,u=void 0,i.fromAscii(c.annotationData),e.next=13,w.a.getJson(Object(d.a)(i.fromAscii(c.annotationData)));case 13:u=e.sent,c.content=u;case 15:e.next=7;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(5),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:return e.abrupt("return",r);case 26:case"end":return e.stop()}},e,this,[[5,19,22,25]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"newAnnotation",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new m.a(h.w,"newAnnotation",[this.web3.utils.fromAscii(t),Object(d.c)(n),this.web3.utils.fromAscii(r)]).execute();case 2:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"newAnnotationContent",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.addJson(r);case 2:return i=e.sent,e.next=5,this.newAnnotationHash(t,n,i);case 5:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"newAnnotationHash",value:function(){var e=Object(i.a)(a.a.mark(function e(t,n,r){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new m.a(h.w,"newAnnotation",[this.web3.utils.fromAscii(t),Object(d.c)(n),Object(d.c)(r)]).execute();case 2:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getAnnotationTypes",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new p.a((new f.a).contractAddress).from(b.k).select("annotationType").select("description"),e.next=3,t.executeQuery();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}]),n}(R))))));t.a=X},,function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=function(){function e(){Object(o.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"}],name:"new2DMapping",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"ipfsHash",type:"bytes32"}],name:"New2DMapping",type:"event"}],this.contractAddress="0x50ff08f58ba3d2cbeaa07326267332e41dc946aa"}return Object(s.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}(),u=n(31),l=n(192),f=n(47),h="X",p=function(){function e(t){if(Object(o.a)(this,e),t.length<=1)this.pivot=t[0];else{var n=this.getPivotAndDimension(t);this.pivot=n.pivot,this.dimension=n.dimension,this.range=n.range;var r=t.indexOf(this.pivot);t.splice(r,1);var a=this.getSubTreePoints(this.pivot,this.dimension,t);this.leftSubTree=new e(a.left),this.rightSubTree=new e(a.right)}}return Object(s.a)(e,[{key:"getSubTreePoints",value:function(e,t,n){var r=[],a=[],i=this.getValueForDimension(e,t);for(var o in n){var s=n[o],c=this.getValueForDimension(s,t);c<i?r.push(s):c>=i&&a.push(s)}return{left:r,right:a}}},{key:"getValueForDimension",value:function(e,t){return t===h?e.point[0]:e.point[1]}},{key:"getPivotAndDimension",value:function(e){var t=this.chooseDimension(e),n=t.dimension,r=(t.max+t.min)/2,a=void 0,i=1e4;for(var o in e){var s=e[o],c=n===h?Math.abs(s.point[0]-r):Math.abs(s.point[1]-r);c<i&&(a=s,i=c)}return{pivot:a,dimension:n,range:{min:t.min,max:t.max}}}},{key:"chooseDimension",value:function(e){var t=1e4,n=1e4,r=-1e4,a=-1e4;for(var i in e){var o=e[i].point[0],s=e[i].point[1];o<t&&(t=o),o>r&&(r=o),s<n&&(n=s),s>a&&(a=s)}return r-t>a-n?{dimension:h,min:t,max:r}:{dimension:"Y",min:n,max:a}}},{key:"getPointsInRange",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(void 0===this.pivot)return[];var i=this.pivot.point[0],o=this.pivot.point[1],s=[];return i>=e&&i<=n&&o>=t&&o<=r&&s.push(this.pivot),this.dimension==h?(i<=n&&e<=this.range.max&&void 0!==this.rightSubTree&&(s=s.concat(this.rightSubTree.getPointsInRange(e,t,n,r,a+1))),i>=e&&n>=this.range.min&&void 0!==this.leftSubTree&&(s=s.concat(this.leftSubTree.getPointsInRange(e,t,n,r,a+1)))):"Y"===this.dimension&&(o<=r&&t<=this.range.max&&void 0!==this.rightSubTree&&(s=s.concat(this.rightSubTree.getPointsInRange(e,t,n,r,a+1))),o>=t&&r>=this.range.min&&void 0!==this.leftSubTree&&(s=s.concat(this.leftSubTree.getPointsInRange(e,t,n,r,a+1)))),s}},{key:"size",value:function(){var e=1;return void 0!==this.leftSubTree&&(e+=this.leftSubTree.size()),void 0!==this.rightSubTree&&(e+=this.rightSubTree.size()),e}},{key:"inRange",value:function(e,t,n,r){return void 0!==this.range&&(this.dimension===h?e>=this.range.min&&e<=this.range.max:t>=this.range.min&&t<=this.range.max)}}]),e}(),d=new c,m=function(){function e(t){Object(o.a)(this,e),this.contract=d.getContract(t),this.loaded=!1}return Object(s.a)(e,[{key:"load",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new l.a(this.contract.contractAddress).from(u.i).select("ipfsHash").executeQuery();case 2:if(0!==(t=e.sent).length){e.next=5;break}return e.abrupt("return");case 5:return n=t[t.length-1].ipfsHash,e.next=8,f.a.getJson(n);case 8:r=e.sent,this.points=r,this.pointsMap=this.getMap(r),console.log("constructing KD tree"),this.kdTree=new p(this.points),console.log("finished constructing KD tree size="),console.log(this.kdTree.size()),this.loaded=!0;case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getPointsInRange",value:function(e,t,n,r){var a=(new Date).getTime(),i=this.kdTree.getPointsInRange(e,t,n,r),o=(new Date).getTime();return console.log("finished getting points in "+(o-a)+" ms"),i}},{key:"getMap",value:function(e){var t={};for(var n in e){var r=e[n];t[r.path]=r}return t}},{key:"findSimilarSounds",value:function(e){var t=void 0;for(var n in this.points)this.points[n].path===e&&(t=this.points[n]);if(void 0===t)return console.log("no point"),[];var r=[];for(var a in this.points){var i=this.distance(t,this.points[a]);r.push({point:this.points[a],distance:i})}return r.sort(function(e,t){return e.distance-t.distance}),r.slice(0,100).map(function(e){return e.point.path})}},{key:"distance",value:function(e,t){var n=e.point[0],r=e.point[1],a=t.point[0],i=t.point[1];return Math.sqrt(Math.pow(a-n,2)+Math.pow(i-r,2))}}]),e}();t.a=m},,function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=n(757),u=n(70),l=n(44),f=n(40),h=n(31),p=n(47),d=n(52);var m=n(65),v=n(1344),b=new c.a,g=function(){function e(t){Object(o.a)(this,e),this.web3=t,this.contract=b.getContract(t),this.contractAddress=b.contractAddress}return Object(s.a)(e,[{key:"sendMessage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.a,o=arguments.length>3?arguments[3]:void 0;return new Promise(function(){var s=Object(i.a)(a.a.mark(function i(s,c){var f,h,v;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(void 0!==e){a.next=4;break}return a.next=3,d.a.getAccount();case 3:e=a.sent;case 4:return f={type:r,referenceHash:n,content:o},a.next=7,p.a.addJson(f,!0);case 7:h=a.sent,v=Object(m.c)(h),n=null!==n?Object(m.c)(n):t.web3.utils.padLeft("0x0",64),new u.a(l.m,"sendPublicMessage",[e,n,v]).execute().then(function(){s(h)});case 11:case"end":return a.stop()}},i)}));return function(e,t){return s.apply(this,arguments)}}())}},{key:"getMessages",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i,o=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:null,n=o.length>1?o[1]:void 0,e.next=4,this.getQuery(t,n);case 4:return r=e.sent,e.next=7,r.executeQuery();case 7:return i=e.sent,e.abrupt("return",i);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"watchForNewMessages",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:null,n=i.length>1?i[1]:void 0,r=i.length>2?i[2]:void 0,e.next=5,this.getQuery(t,n);case 5:e.sent.watchQuery(r);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getQuery",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n,r,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:null,n=i.length>1?i[1]:void 0,r=new f.a(this.contractAddress).from(h.T).select("fromUser").select("referenceHash").select("messageHash").where("referenceHash",t),n&&r.where("toUser",n),e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();t.a=g},function(e,t,n){"use strict";var r=n(5),a=n.n(r),i=n(14),o=n(2),s=n(4),c=function(){function e(){Object(o.a)(this,e),this.abi=[{constant:!1,inputs:[{internalType:"bytes32",name:"sampleHash",type:"bytes32"},{internalType:"bytes32",name:"reasoningHash",type:"bytes32"}],name:"copyStrikeSample",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"newDesignatedAgent",type:"address"}],name:"switchDesignatedAgent",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"sampleHash",type:"bytes32"}],name:"takedownSample",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"reasoningHash",type:"bytes32"}],name:"SampleCopyStrike",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"sampleHash",type:"bytes32"}],name:"SampleTakenDown",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"agent",type:"address"}],name:"NewDesignatedAgent",type:"event"}],this.contractAddress="0xAd4752a6C01C2B25b6248bEB33B1B03f2BE9F9E7"}return Object(s.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}(),u=n(65),l=n(192),f=n(31),h=n(47),p=new c,d=function(){function e(t){Object(o.a)(this,e),this.web3=t,this.contract=p.getContract(t),this.contractAddress=p.contractAddress}return Object(s.a)(e,[{key:"getCopyStrikedSamples",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new l.a(this.contractAddress).from(f.W).select("sampleHash").select("reasoningHash"),e.next=3,t.executeQuery();case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getTakenDownSamples",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new l.a(this.contractAddress).from(f.db).select("sampleHash"),e.next=3,t.executeQuery();case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"copyStrikeSample",value:function(e,t,n){var r=this;return new Promise(function(){var o=Object(i.a)(a.a.mark(function i(o,s){var c,l,f;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.web3.eth.getAccounts();case 2:return c=a.sent,l={reasoning:n,emailAddress:t},a.next=6,h.a.addJson(l,!0);case 6:f=a.sent,f=Object(u.c)(f),e=Object(u.c)(e),r.contract.methods.copyStrikeSample(e,f).send({from:c[0]},function(e,t){e?s():o()});case 10:case"end":return a.stop()}},i)}));return function(e,t){return o.apply(this,arguments)}}())}},{key:"takeDownSample",value:function(e){var t=this;return new Promise(function(){var n=Object(i.a)(a.a.mark(function n(r,i){var o;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.web3.eth.getAccounts();case 2:o=n.sent,e=Object(u.c)(e),t.contract.methods.takedownSample(e).send({from:o[0]},function(e,t){e?i():r()});case 5:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}}]),e}();t.a=d},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12),o=Object(i.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.svgRef,n=e.points,r=n.x1,i=n.x2,o=n.y1,s=n.y2,c=(n.height1,n.width1),u=(n.height2,n.width2);if(t.current){var l=t.current.getBoundingClientRect();r-=l.left,i-=l.left,o-=l.top,s-=l.top}return a.a.createElement("polygon",{points:[r,o,i,s,i+u,s,r+c,o]})}),s=n(11),c=n(6);window.testA=-15,window.testB=-5;n(2445);var u=Object(r.memo)(function(e){e.edgesSize,e.edgesPadding;var t=e.scale,n=void 0===t?1:t,i=(e.editorPadding,e.scrollContainer),u=e.destinationPosition,l=e.parameter,f=(e.scrollHeight,e.sequencerEngine),h=Object(r.useRef)();if(l)l.context.subDevice||l.context.effect||l.context.midiEffect;var p=function(e,t,n,a){var i=Object(r.useState)(void 0),o=Object(s.a)(i,2),u=o[0],l=o[1],f=Object(r.useState)(void 0),h=Object(s.a)(f,2),p=h[0],d=h[1],m=Object(r.useState)(void 0),v=Object(s.a)(m,2),b=v[0],g=v[1],y=Object(r.useState)(void 0),k=Object(s.a)(y,2),O=k[0],j=k[1],w=Object(r.useState)(void 0),E=Object(s.a)(w,2),S=E[0],P=E[1],x=Object(r.useState)(void 0),T=Object(s.a)(x,2),C=T[0],N=T[1],R=Object(r.useCallback)(function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O;if(e){var a=e.context&&e.context.track;a&&a.isEffectsShowing&&!a.isEffectsShowing()&&a.showEffects(!0);var i=e.isMapped;if(i&&i.track&&i.track.isEffectsShowing&&!i.track.isEffectsShowing()&&i.track.showEffects(!0),e.context.lfoTrack&&e.context.lfoTrack.sequencerEngine.dispatch(Object(c.Pf)(!0)),C&&S){var o=C.getBoundingClientRect(),s=C.offsetHeight,u=o.width,f=o.left,h=o.top-s,d=S.getBoundingClientRect(),m=S.offsetHeight,v=d.width,b=d.left,g=d.top-m;t&&t.current.getBoundingClientRect();var y=!1;if(r&&r.className.includes("plane")){y=!0,g-=25;var k=r.getBoundingClientRect(),j=k.top;j>d.top?g+=j-d.top:j+k.height<d.top&&(g-=d.top-(j+k.height)-5)}y||(g+=m),g<=(h+=s)?g+=m:h+=s;var w=p&&p.getBoundingClientRect(),E=1e4;w&&(E=135+w.width);var P=Math.max(135,b);P>E&&(P=E,v=1),f>E&&(f=E,u=1),P+v>E&&(v=E-P);var x={x1:Math.max(135,f),y1:h,x2:P,y2:g,width1:f<135?10:u,width2:b<135?0:v,height1:s,height2:m};l(x)}else l(void 0)}},[e,l,d,S,C,O,n]);Object(r.useEffect)(function(){if(!e)return l(void 0),N(void 0),P(void 0),d(void 0),void(p&&p.removeEventListener("scroll",R));setTimeout(function(){var t=document.getElementById("parameter-"+e.id);q(t,d);var n=document.getElementById("accumulator-map-source");q(n,g);var r=A(n,j);N(t),P(n),R(void 0,r)},50)},[e,l,N,P,d,j,C,S,n]),Object(r.useEffect)(function(){return p&&p.addEventListener("scroll",R),function(){return p?p.removeEventListener("scroll",R):[]}},[l,e,p,S,C]),Object(r.useEffect)(function(){return O&&O.addEventListener("scroll",R),function(){return O?O.removeEventListener("scroll",R):[]}},[l,e,O,S,C]),Object(r.useEffect)(function(){R()},[a,e,l,S,C]),Object(r.useEffect)(function(){return b&&b!==p&&b.addEventListener("scroll",R),function(){return b&&b!==p?b.removeEventListener("scroll",R):[]}},[l,e,b,p,O,S,C,n]);var M=Object(r.useCallback)(function(e,t,n,r){for(var a=0;e&&a<30;){if(void 0===e.className)return;if(e.className.includes(t)&&(!n||!e.className.includes(n)))break;e=e.parentNode,a++}if(e&&e.className.includes(t))return r(e),e},[g,d]),A=Object(r.useCallback)(function(e,t){return M(e,"parameters-list",void 0,t)},[g]),q=Object(r.useCallback)(function(e,t){return M(e,"effects-view","instrument-rack",t)},[g,d]);return u}(l,i,n,u);return Object(r.useEffect)(function(){var e=f.state.spatial,t=e.edgesSize,n=(e.editorPadding,e.edgesPadding);h.current.style.width=t.width+"px",h.current.style.height=t.height+"px",h.current.style.minWidth=t.width+"px",h.current.style.minHeight=t.height+"px",h.current.style.left=n.x,h.current.style.top=n.y},[p]),a.a.createElement("svg",{style:{},ref:h,className:"parameter-link-visualizer"},p&&a.a.createElement(o,{points:p,svgRef:h}))});t.a=Object(i.b)(function(e,t){var n,r=e.effects.accumulatorParameterSelected;if(r&&r.context){var a=r.context.subDevice||r.context.effect||r.context.midiEffect;a&&(n=e.windows.windowPositions[a.id])}return{destinationPosition:n,parameter:r}},function(e){return{}})(u)},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(6),o=n(12),s=function(e){var t=e.rollSteps,n=e.stepNumber,r=(e.resolution,{left:39*(n=n/2%16),width:39*(t/=2)});return a.a.createElement("div",{className:"roll-visualizer",style:r})},c=n(2),u=n(4),l=n(7),f=n(10),h=n(1);function p(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var v=function(e){Object(l.a)(n,e);var t=m(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"getClassName",value:function(e){var t=Math.floor(this.props.currentStep/2)%16,n="";(n=this.props.stepNumber===t?"current-step step":this.props.stepNumber<t?"previous-step step":"step",this.props.toggled&&this.props.stepNumber!==t&&(n+=" toggled"),void 0!==this.props.rollingStepNumber)&&(Math.floor(this.props.rollingStepNumber/2)%16===this.props.stepNumber&&(n+=" rolling-step"));return n}},{key:"isCurrent",value:function(){var e=Math.floor(this.props.currentStep/2)%16;return!(!this.props.toggled||this.props.stepNumber!==e)}},{key:"render",value:function(){var e=this.getClassName(),t={};if(this.isCurrent()){var n,r=0,i=p(this.props.sequencerEngine.tracks);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.isFrozen||(r+=(o.triggerCount||0)+(o.otherTriggerCount||0))}}catch(s){i.e(s)}finally{i.f()}r>0&&(r=Math.pow(r,1.3),t.boxShadow="0px 0px ".concat(r,"px ").concat(r,"px #ff5151"))}return a.a.createElement("div",{style:t,onMouseOver:this.props.onMouseOver,onMouseDown:this.props.onMouseDown,className:e})}}]),n}(r.Component),b=Object(o.b)(function(e,t){return{toggled:e.steps.masterStepToggles[t.stepNumber]}},null)(v);t.a=Object(o.b)(function(e,t){var n=t.sequencerEngine.getSequenceId();return{stepNumber:e.sequencer.currentGlobalStep[n]||0,masterStepToggles:e.steps.masterStepToggles,isSequenceRolling:t.sequencerEngine.isSequenceRolling}},function(e){return{setMasterStepToggles:function(t){return e(Object(i.ed)(t))},mouseDown:function(t){return e(Object(i.n)(t))}}})(function(e){var t=Object(r.useCallback)(function(t){var n=e.masterStepToggles;n[t]=!n[t],e.setMasterStepToggles(n)},[]),n=Object(r.useCallback)(function(n){e.sequencerEngine.state.keyboard.isMouseDown&&t(n)},[]),i=Array(16).fill(0),o=e.stepNumber,c=void 0,u=void 0,l=void 0;if(e.isSequenceRolling){var f=e.sequencerEngine.tracks[0];if(f){var h=f.getFactoredResolution().getNumberOfStepsAtBaseResolution(),p=f.patternRollStepNumber+e.stepNumber%h;c=p%f.pattern.stepBuckets.length,u=h,l=f.patternRollStepNumber}}return a.a.createElement("div",{onMouseUp:function(){return e.mouseDown(!1)},onMouseDown:function(){return e.mouseDown(!0)},className:"steps-visualizer"},e.isSequenceRolling?a.a.createElement(s,{rollSteps:u,stepNumber:l}):"",i.map(function(r,i){return a.a.createElement(b,{key:i,sequencerEngine:e.sequencerEngine,onMouseOver:function(){return n(i)},onMouseDown:function(){return t(i)},stepNumber:i,rollingStepNumber:void 0!==c?o:c,currentStep:void 0!==c?c:o})}))})},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(15),o=n.n(i),s=n(293),c=n(292),u=n(232),l=n(436),f=n(649),h=n(650),p=function(){function e(t,n){Object(r.a)(this,e),this.output=t,this.sequencerEngine=n,this.input=new o.a.Gain(1),this.eq=new s.a(n,!1),this.getLowEQ().frequencyParameter.set(250),this.getMidEQ().frequencyParameter.set(1e3),this.getMidEQ().qParameter.set(.9),this.getHighEQ().frequencyParameter.set(3400),this.convolverReverb=new c.a(n),this.convolverReverb.wet=1,this.delay=new u.a(n),this.delay.wet=0,this.phaser=new l.a(n),this.phaser.rateParameter.set(.2),this.phaser.feedbackParameter.set(.4),this.phaser.wet=0,this.input.connect(this.eq.effectNode),this.eq.connect(this.convolverReverb.effectNode),this.convolverReverb.connect(this.delay.effectNode),this.delay.connect(this.phaser.effectNode),this.phaser.connect(this.output)}return Object(a.a)(e,[{key:"getEQ",value:function(e){switch(e){case h.b:return this.getLowEQ();case h.c:return this.getMidEQ();case h.a:return this.getHighEQ()}}},{key:"toggleEQ",value:function(e){var t=this.getEQ(e);-24===t.gainParameter.get()?t.gainParameter.set(0):t.gainParameter.set(-24)}},{key:"toggleEffect",value:function(e){switch(e){case f.c:this.toggleReverb();break;case f.a:this.toggleDelay();break;case f.b:this.togglePhaser()}}},{key:"toggleDelay",value:function(){1===this.delay.wetParameter.get()?this.delay.wet=0:this.delay.wet=1}},{key:"toggleReverb",value:function(){1===this.convolverReverb.wetParameter.get()?this.convolverReverb.wet=0:this.convolverReverb.wet=1}},{key:"togglePhaser",value:function(){1===this.phaser.wetParameter.get()?this.phaser.wet=0:this.phaser.wet=1}},{key:"color",set:function(e){this.delay.feedbackParameter.set(.75*e),this.phaser.depthParameter.set(e)}},{key:"getLowEQ",value:function(){return this.eq.equalizerPoints[0]}},{key:"getMidEQ",value:function(){return this.eq.equalizerPoints[4]}},{key:"getHighEQ",value:function(){return this.eq.equalizerPoints[7]}}]),e}();t.a=p},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(1092),s=n(6),c=n(247),u=n(206),l=n(626),f=(n(559),n(12));n(2574);t.a=Object(f.b)(function(e,t){return{showSidebar:e.spatial.sidebarsShowing,track:t.sequencerEngine.getSelectedTrack(),show:e.spatial.showEditorBottom,bottomHeight:e.arrangement.bottomHeight,leftSidebarWidth:e.spatial.leftSidebarWidth}},function(e){return{setBottomHeight:function(t){return e(Object(s.C)(t))},setShow:function(t){return e(Object(s.If)(t))}}})(function(e){e.scrollRef;var t=e.editorBottomRef,n=e.leftSidebarWidth,s=e.bottomHeight,f=e.track,h=e.show,p=e.setShow,d=e.showSidebar,m=e.setBottomHeight,v=Object(a.useState)(!1),b=Object(r.a)(v,2),g=b[0],y=b[1];Object(c.a)(t),Object(a.useEffect)(function(){return window.addEventListener("mousemove",O),window.addEventListener("mouseup",k),function(){window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",k)}},[g]);var k=Object(a.useCallback)(function(e){g&&y(!1)},[g,y]),O=Object(a.useCallback)(function(e){if(g){var t=Math.min(window.innerHeight-46,window.innerHeight-e.pageY);m(t)}},[g]),j=f&&f.sequencerEngine,w="editor-bottom";h&&(w+=" show"),d||(w+=" full-width");var E="";h&&f&&(E=h===u.a?i.a.createElement(l.a,{sequencerEngine:j,onEffectsChange:function(){return[]},installation:!0,store:j.store,tracks:j.tracks,onParameterChanged:function(e){return[]},sends:j.sends,track:f,scrollContainer:t}):i.a.createElement(o.a,{hideSidebar:!0,parentClassName:w,scale:.5,installation:!0,sequencerEngine:j,hideToolbar:!0,track:f}));var S={width:window.innerWidth-n-240,maxWidth:window.innerWidth-240-n};return h===u.b?(S.height=s,S.maxHeight=s,w+=" piano-roll-mode"):w+=" effects-mode",S.left=n,i.a.createElement("div",{style:S,ref:t,className:w},i.a.createElement("div",{onMouseDown:function(){return y(!0)},className:"editor-bottom-resizer"}),i.a.createElement("div",{onClick:function(){return p(h?void 0:u.a)},className:"collapse-container"},i.a.createElement("div",{className:h?"arrow-right":"arrow-up"})),E)})},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(11),a=n(0),i=n.n(a),o=n(252);function s(e){var t=Object(a.useState)(void 0),n=Object(r.a)(t,2),s=n[0],c=n[1],u=Object(a.useState)(void 0),l=Object(r.a)(u,2),f=(l[0],l[1]);Object(a.useEffect)(function(){c(e.track.chokes.choke),f(e.track.chokes.transposeMatch)},[e.track]);var h=Object(a.useCallback)(function(t){null===t&&(t=void 0),e.track.chokes.choke=t,c(t)},[e.track]);return i.a.createElement("div",{className:"chokes-and-matches"},i.a.createElement("div",{className:"choke"},i.a.createElement("div",{className:"choke-label"},"Choke:"),i.a.createElement(o.a,{track:s,trackToSkip:e.track,sequencerEngine:e.sequencerEngine,onSelectTrack:h})),i.a.createElement("div",{className:"transpose-match"}))}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(76),o=n(34),s=n(12),c=function(e){var t=e.envelope,n=e.isConnected,r=e.onClick,s="envelope-option";return n&&(s+=" connected"),a.a.createElement(i.a,{onClick:r,element:o.C,arg:t.number,className:s},"ENV ",t.number)};t.a=Object(s.b)(function(e,t){return{envelopes:e.tracks.trackEnvelopes[t.track.id]}},function(e){return{}})(function(e){var t=e.track,n=e.className,i=void 0===n?"":n,o=t.sequencerEngine.envelopes,s=Object(r.useCallback)(function(e){t.isConnectedToEnvelope(e)?t.disconnectFromEnvelope(e):t.connectToEnvelope(e)},[t]);return a.a.createElement("div",{className:i+" envelope-options"},o.map(function(e){return a.a.createElement(c,{key:e.number,envelope:e,onClick:function(){return s(e)},isConnected:t.isConnectedToEnvelope(e)})}))})},function(e,t,n){"use strict";n.d(t,"a",function(){return b});var r=n(5),a=n.n(r),i=n(9),o=n(14),s=n(0),c=n.n(s),u=n(204),l=n(75),f=n(341),h=n(29),p=(n(47),n(62));function d(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=new h.a,b=function(){var e=Object(o.a)(a.a.mark(function e(t){var n,r,o,s,l,h,d,m=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=m.length>1&&void 0!==m[1]?m[1]:8,r={},e.prev=2,e.next=5,window.sequencerEngine.encryptedIpfs.getJson(t.newSequence,t.guildId,5e3);case 5:if("object"===typeof(r=e.sent)){e.next=8;break}return e.abrupt("return","");case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(2),console.log("ERROR = ",e.t0),e.abrupt("return","");case 14:return e.next=16,y(Object(f.a)(r));case 16:for(h in o=e.sent,s=[],l=[],r.subSequences)s=[].concat(Object(i.a)(s),Object(i.a)(r.subSequences[h].tracks.map(function(e){return e.map(function(e){return Object.keys(e).filter(function(e){return Object(p.a)(e)}).map(parseFloat).filter(function(e){return e<32})})}))),l=[].concat(Object(i.a)(l),Object(i.a)(r.subSequences[h].tracksData.map(function(e){return g("SAMPLER"===e.type?e.samplers:e.presetName||e.type)})));return d=o.filter(function(e){return e.getThumbnail()}),e.abrupt("return",{graphic:[c.a.createElement("div",{className:"bpm"},r.bpm)].concat(Object(i.a)(s.map(function(e,t){return c.a.createElement("div",{key:"track-"+t,className:"track-graphic"},e[0].map(function(e,r){return c.a.createElement("div",{key:t+"-"+e+"-step",style:{left:e*n,backgroundColor:l[t]},className:"step-graphic"})}))})),[d.length>0?c.a.createElement("div",{className:"work-sounds"},d.map(function(e){return c.a.createElement(u.a,{sample:e})})):""]),bpm:r.bpm,wallpaper:r.wallpaper});case 22:case"end":return e.stop()}},e,null,[[2,10]])}));return function(t){return e.apply(this,arguments)}}(),g=function(e){if("object"===typeof e&&(e=Object.keys(e)[0]),void 0!==e)return v.saturate(v.getColorForHash(e),3)},y=function(){var e=Object(o.a)(a.a.mark(function e(t){var n,r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=d(t),e.prev=2,r.s();case 4:if((i=r.n()).done){e.next=12;break}return o=i.value,s=new l.a(o),e.next=9,s.load(!1);case 9:n.push(s);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}},e,null,[[2,14,17,20]])}));return function(t){return e.apply(this,arguments)}}()},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){"use strict";var r=n(28),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(7),l=n(10),f=n(1),h=n(0),p=n.n(h),d=n(353),m=n(11),v=n(628),b=n(12),g=n(365),y=(new(n(29).a),function(e){var t=e.token,n="token-option";return e.isSelected&&(n+=" selected"),p.a.createElement("div",{onClick:function(){var e="/nft/"+parseInt(t.projectId)+"/"+t.tokenId;console.log("project url",e),window.location.href=e},className:n},p.a.createElement(v.a,{seedHash:t.seedHash}),p.a.createElement("div",{className:"token-id"},t.tokenId))}),k=Object(b.b)(function(e,t){return{mintedTokens:e.nft.mintedTokens}},function(e){return{}})(function(e){var t=e.mintedTokens,n=e.sequencerEngine,r=Object(h.useState)(!1),a=Object(m.a)(r,2),i=a[0],o=a[1],s=Object(h.useState)(!1),c=Object(m.a)(s,2),u=c[0],l=c[1],f=t[0],d=Object(h.useCallback)(function(){l(!0),Object(g.e)(f.projectId).then(function(e){return l(!1)})},[f,l]);if(!f)return"";var b=f.maxInvocations-t.length,k=n.tokenId;return p.a.createElement("div",{onClick:function(){return o(!i)},className:"mints-toolbar-view no-select"},p.a.createElement(v.a,{seedHash:n.seedHash,className:i?"token-icon showing":"token-icon"}),i&&p.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"minted-menu"},p.a.createElement("div",{className:"project-info"},p.a.createElement("div",{className:"project-title"},t[0].title),p.a.createElement("div",{className:"project-id"},t[0].projectId),p.a.createElement("div",{className:"max-invocations"},"Max: ",t[0].maxInvocations)),p.a.createElement("div",{className:"minted"},t.map(function(e){return p.a.createElement(y,{isSelected:e.tokenId===k,token:e})})),p.a.createElement("div",{className:"unminted"},b," unminted tokens left",b>0&&p.a.createElement("div",{onClick:d,className:u?"mint-button minting":"mint-button"},"Mint"))))}),O=n(124),j=n(653),w=n(727),E=n(1062),S=n(1084),P=n(656),x=(n(194),n(59),n(1098)),T=n(1107),C=n(6),N=n(660),R=(n(30),n(33)),M=(n(289),function e(){Object(s.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"}],name:"newSamplePack",outputs:[{name:"",type:"uint32"}],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"",type:"address"},{indexed:!0,name:"",type:"uint32"}],name:"NewSamplePack",type:"event"},{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"},{name:"tags",type:"bytes32[4]"}],name:"newSamplePackWithTags",outputs:[{name:"",type:"uint32"}],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"",type:"uint32"},{indexed:!0,name:"",type:"bytes32"}],name:"SamplePackTagged",type:"event"},{constant:!1,inputs:[{name:"id",type:"uint32"},{name:"tags",type:"bytes32[4]"}],name:"tagSamplePack",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{constant:!1,inputs:[{name:"id",type:"uint32"},{name:"ipfsHash",type:"bytes32"}],name:"updateSamplePackSamples",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"getNumberOfSamplePacks",outputs:[{name:"",type:"uint32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"id",type:"uint32"}],name:"getSamplePackIpfsHash",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"}],this.contractAddress="0x1f4d647863b75171b40680f269d4c8cbf3ed50b7"}),A=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(s.a)(this,e),this.samples=n,this.tags=r,this.name=t,this.sampleToSlices=a,this.timestamp=void 0,this.isArchived=!1,this.id=void 0}return Object(c.a)(e,[{key:"getJson",value:function(){return{samples:this.samples,sampleToSlices:this.sampleToSlices,name:this.name,tags:this.tags,timestamp:void 0===this.timestamp?Math.floor(Date.now()):this.timestamp,isArchived:this.isArchived,id:this.id}}},{key:"fromJson",value:function(e){return"sampleToSlices"in e&&(this.sampleToSlices=e.sampleToSlices),"name"in e&&(this.name=e.name),"samples"in e&&(this.samples=e.samples),"tags"in e&&(this.tags=e.tags),"timestamp"in e&&(this.timestamp=new Date(e.timestamp)),"isArchived"in e&&(this.isArchived=e.isArchived),"id"in e&&(this.id=e.id),this}}]),e}(),q=n(47),D=n(446),I=n(36),_=new M,F=function(){function e(){Object(s.a)(this,e),void 0!==I.a&&I.a.eth.net.isListening()&&(this.contract=new I.a.eth.Contract(_.abi,_.contractAddress),this.ethAddress=this.contract.options.address)}return Object(c.a)(e,[{key:"updateSamplePack",value:function(e,t){var n=this;return new Promise(function(){var r=Object(o.a)(i.a.mark(function r(a,o){var s,c;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,q.a.addJson(t.getJson());case 2:return s=r.sent,r.next=5,I.a.eth.getAccounts();case 5:c=r.sent,n.contract.methods.updateSamplePackSamples(e,Object(D.b)(s)).send({from:c[0]},function(e,t){e?o(e):a()});case 7:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}},{key:"newSamplePack",value:function(e){var t=this;return new Promise(function(){var n=Object(o.a)(i.a.mark(function n(r,a){var o,s;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,q.a.addJson(e.getJson());case 2:return o=n.sent,n.next=5,I.a.eth.getAccounts();case 5:s=n.sent,t.contract.methods.newSamplePack(Object(D.b)(o)).send({from:s[0]},function(e,t){e?a(e):r()});case 7:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getAllSamplePacks",value:function(){var e=this;return new Promise(function(){var t=Object(o.a)(i.a.mark(function t(n,r){var a,s,c,u,l;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.contract.methods.getNumberOfSamplePacks().call();case 2:for(a=t.sent,s=[],c=function(t){s.push(new Promise(function(){var n=Object(o.a)(i.a.mark(function n(r,a){var o,s,c;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.contract.methods.getSamplePackIpfsHash(t).call();case 2:return o=n.sent,n.next=5,q.a.getJson(Object(D.a)(o));case 5:s=n.sent,(c=new A).id=t,r(c.fromJson(s));case 9:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()))},u=1;u<=a;u++)c(u);return t.next=8,Promise.all(s);case 8:l=t.sent,n(l.filter(function(e){return!e.isArchived}).reverse());case 10:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}}]),e}(),L=n(20);function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var z=function(e){Object(u.a)(n,e);var t=B(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onClickColor=r.onClickColor.bind(Object(L.a)(r)),r}return Object(c.a)(n,[{key:"onClickColor",value:function(e){console.log("pattern to edit color = "+this.props.patternToEditColor),this.props.setPatternColor(this.props.patternToEditColor,e)}},{key:"onClickDone",value:function(){this.props.setPatternToEditColor(void 0)}},{key:"render",value:function(){var e=this;return p.a.createElement("div",{className:"sub-toolbar"},p.a.createElement("div",{className:"color-picker"},p.a.createElement(V,{patternColor:this.props.patternColor,color:"white",onClickColor:this.onClickColor}),p.a.createElement(V,{patternColor:this.props.patternColor,color:"red",onClickColor:this.onClickColor}),p.a.createElement(V,{patternColor:this.props.patternColor,color:"orange",onClickColor:this.onClickColor}),p.a.createElement(V,{patternColor:this.props.patternColor,color:"yellow",onClickColor:this.onClickColor}),p.a.createElement(V,{patternColor:this.props.patternColor,color:"green",onClickColor:this.onClickColor}),p.a.createElement(V,{patternColor:this.props.patternColor,color:"blue",onClickColor:this.onClickColor}),p.a.createElement(V,{patternColor:this.props.patternColor,color:"purple",onClickColor:this.onClickColor})),p.a.createElement("div",{className:"done-button",onClick:function(){return e.onClickDone()}},"DONE"))}}]),n}(h.Component),V=function(e){Object(u.a)(n,e);var t=B(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this,t="color-option background-"+this.props.color;return this.props.patternColor===this.props.color&&(t+=" selected"),p.a.createElement("div",{onClick:function(){return e.props.onClickColor(e.props.color)},className:t})}}]),n}(h.Component),H=Object(b.b)(function(e){return{patternToEditColor:e.toolbar.patternToEditColor,patternColor:e.toolbar.patternColors[e.toolbar.patternToEditColor]}},function(e){return{setPatternToEditColor:function(t){return e(Object(C.Xd)(t))},setPatternColor:function(t,n){return e(Object(C.Wd)(t,n))}}})(z),U=n(38),J=n(79),G=n(664),W=n(34),K=n(176);function X(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Q=function(e){Object(u.a)(n,e);var t=X(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"onClick",value:function(){this.props.connectionStatus===K.a&&this.props.sequencerEngine.clockSync.retry()}},{key:"render",value:function(){var e=this;if(this.props.connectionStatus===K.b)return p.a.createElement("div",null);var t="";t=this.props.connectionStatus===K.d?"Waiting for peer to connect":this.props.connectionStatus===K.a?"Disconnected (click to retry)":"Synced with "+this.props.connectedUserName;var n=this.props.connectionStatus===K.d?" flashit":"";return p.a.createElement("div",{onClick:function(){return e.onClick()},className:"connection-status "+this.props.connectionStatus+n},t," ",p.a.createElement("div",{className:"clock-type"},this.props.clockType))}}]),n}(h.Component),Y=Object(b.b)(function(e){return{connectedUserName:e.clock.connectedUserName,connectionStatus:e.clock.connectionStatus,clockType:e.sequencer.clockType}},null)(Q);n(39),n(2434);function Z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}new F;var $=function(e){Object(u.a)(n,e);var t=Z(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).state={dropdownOpen:!1},r}return Object(c.a)(n,[{key:"goToMixer",value:function(e){this.props.sequencerEngine.keyListener.lastViewMode=this.props.viewMode,this.props.setViewMode(J.b),this.props.setMixViewMode(e)}},{key:"goToArrangement",value:function(){this.props.sequencerEngine.keyListener.lastViewMode=this.props.viewMode,this.props.setViewMode(J.a)}},{key:"goToSequencer",value:function(){this.props.sequencerEngine.keyListener.lastViewMode=this.props.viewMode,this.props.setViewMode(J.e)}},{key:"goToPreferences",value:function(){this.props.setViewMode(J.d)}},{key:"goToHome",value:function(){window.location.href="/explore/"}},{key:"toggleViewDropdown",value:function(){this.props.setZIndexHack(!this.state.dropdownOpen),this.setState({dropdownOpen:!this.state.dropdownOpen})}},{key:"duplicateTrack",value:function(){this.sequencerEngine.duplicateTrack(this.props.selectedTrack)}},{key:"onSave",value:function(e,t,n){this.hideSaveModal(),this.props.sequencerEngine.save(e,t,!0,n)}},{key:"hideSaveModal",value:function(){this.props.setShowSaveModal(!1)}},{key:"save",value:function(){var e=Object(o.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.props.setShowSaveModal(!0);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onSelectResolution",value:function(e){this.props.sequencerEngine.resolution=e,this.props.sequencerEngine.select(this.props.sequencerEngine.cursor.track,0),this.setState(this.state)}},{key:"clickPattern",value:function(e){var t=this.props.sequencerEngine.store.getState();t.keyboard.isCommandDown?this.props.setPatternToEditColor(e):(this.props.sequencerEngine.switchToPattern(e),void 0!==t.toolbar.patternToEditColor&&this.props.setPatternToEditColor(e),this.setState(this.state))}},{key:"onDragStart",value:function(e){this.props.dragPattern(e)}},{key:"onDragOver",value:function(e){e.preventDefault()}},{key:"onDrop",value:function(e){this.props.sequencerEngine.movePatternTo(this.props.patternDragging,e),this.setState(this.state)}},{key:"onPlayMixClicked",value:function(){}},{key:"onClickRecordMixButton",value:function(){}},{key:"onCompactClicked",value:function(){this.props.setCompactMode(!this.props.isCompactMode)}},{key:"onNewClicked",value:function(){window.confirm("Are you sure you want to clear this sequence (and lose any work)?")&&this.props.sequencerEngine.newSequence()}},{key:"viewMode",get:function(){return this.props.viewMode}},{key:"getView",value:function(){return this.props.viewMode===J.e?"SEQUENCER":this.props.viewMode===J.b?"MIXER":this.props.viewMode===J.d?"PREFERENCES":this.props.viewMode===J.a?"ARRANGEMENT":"VIEW"}},{key:"onStartSequenceRolling",value:function(){this.props.sequencerEngine.sequenceRolling=!0}},{key:"onStopSequenceRolling",value:function(){this.props.sequencerEngine.sequenceRolling=!1}},{key:"render",value:function(){for(var e=this,t=[],n=0;n<this.props.sequencerEngine.numberOfPatterns();n++)t.push(n);var a=-1;for(var i in this.props.sequencerEngine.tracks){var o=this.props.sequencerEngine.tracks[i].pattern.length();a<o&&(a=o)}return-1==a&&(a=32),p.a.createElement("div",{className:"top-toolbar"},p.a.createElement(T.a,{sequencerEngine:this.props.sequencerEngine,onSave:function(t,n,r){return e.onSave(t,n,r)},onHide:function(){return e.hideSaveModal()},show:this.props.showSaveModal}),p.a.createElement("div",{className:"main-toolbar"},p.a.createElement(G.a,{sequencerEngine:this.props.sequencerEngine}),p.a.createElement(P.a,{sequencerEngine:this.props.sequencerEngine}),p.a.createElement("div",null,p.a.createElement(x.a,{sequencerEngine:this.props.sequencerEngine}),p.a.createElement(w.a,{sequencerEngine:this.props.sequencerEngine}),p.a.createElement(S.a,{sequencerEngine:this.props.sequencerEngine})),p.a.createElement(N.a,{sequencerEngine:this.props.sequencerEngine}),p.a.createElement(Y,{sequencerEngine:this.props.sequencerEngine}),this.props.trackRolling?p.a.createElement("div",{onMouseDown:function(){return e.onStartSequenceRolling()},onMouseUp:function(){return e.onStopSequenceRolling()},className:this.props.sequenceRolling?"roll-button rolling":"roll-button"},"ROLL ",this.props.rollResolution.toString()," "):"",this.props.midiMapMode!==O.c?p.a.createElement("div",{className:"roll-button"},this.props.midiMapMode===O.b?"MIDI MAP":"DELETE MIDI MAP"):"",p.a.createElement(U.a,{condition:this.props.viMode},p.a.createElement("div",{className:"roll-button command-button"},"COMMAND")),p.a.createElement("div",{className:"save-container"},p.a.createElement(U.a,{condition:this.props.onGoBack},p.a.createElement("div",{onClick:this.props.onGoBack,className:"go-back-button"},"BACK")),p.a.createElement(k,{sequencerEngine:this.props.sequencerEngine}),p.a.createElement("span",{onMouseOver:function(){return e.props.setContextualHelp(W.L)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},p.a.createElement(E.a,{store:this.props.sequencerEngine.store}),p.a.createElement("img",{onClick:function(){return e.goToSequencer()},src:"/sequencer-view.svg",className:this.viewMode===J.e?"view-mode-icon selected":"view-mode-icon"}),p.a.createElement("img",Object(r.a)({onClick:function(){return e.goToMixer(d.g)},src:"/mix-view.svg",className:"view-mode-icon"},"className",this.props.mixViewMode===d.g&&this.viewMode===J.b?"view-mode-icon selected":"view-mode-icon")),p.a.createElement("img",Object(r.a)({onClick:function(){return e.goToMixer(d.i)},src:"/mix-view.svg",className:"view-mode-icon"},"className",this.props.mixViewMode===d.i&&this.viewMode===J.b?"view-mode-icon selected":"view-mode-icon")),p.a.createElement("img",{src:"/arrangement-view.svg",onClick:function(){return e.goToArrangement()},className:this.viewMode===J.a?"view-mode-icon selected":"view-mode-icon"}),p.a.createElement(j.a,{store:this.props.sequencerEngine.store})),p.a.createElement("span",{onMouseOver:function(){return e.props.setContextualHelp(W.Wb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}}),p.a.createElement("div",{className:"light-blue-button common-button",onClick:function(){return e.props.setShowSettings(!0)}},"SETTINGS"),p.a.createElement("div",{className:"light-blue-button common-button",onClick:function(){return e.onNewClicked()}},"NEW"),p.a.createElement("div",{className:"pink-button common-button",onClick:function(){return e.save()}},"SAVE"))),p.a.createElement(U.a,{condition:void 0!==this.props.patternToEditColor},p.a.createElement(H,{sequencerEngine:this.props.sequencerEngine})))}}]),n}(h.Component);new R.a(4,!1),new R.a(4,!0),new R.a(8,!1),new R.a(8,!0),new R.a(16,!1),new R.a(16,!0),new R.a(32,!1),new R.a(32,!0);t.a=Object(b.b)(function(e){var t=e.sequencer.sequencerEngine.getSequenceId(),n=e.sequencer.isPlaying[t]||0;return{mixViewMode:e.mix.mixViewMode,midiMapMode:e.midi.midiMapMode,isCompactMode:e.sequencer.isCompactMode,resolution:e.sequencer.displayResolution,sequencerEngine:e.sequencer.sequencerEngine,detailsView:e.sequencer.detailsView,decentralized:e.sequencer.decentralized,viewMode:e.sequencer.viewMode,numberOfPatterns:e.sequencer.numberOfPatterns,samplePack:e.sequencer.samplePack,patternDragging:e.sequencer.patternDragging,isRecordingMix:e.mix.isRecordingMix,isPlayingMix:e.mix.isPlayingMix,isPlaying:n,patternToEditColor:e.toolbar.patternToEditColor,patternColors:e.toolbar.patternColors,trackRolling:e.sequencer.trackRolling,sequenceRolling:e.sequencer.sequenceRolling,viMode:e.commands.viMode,rollResolution:e.sequencer.resolution,showSaveModal:e.toolbar.showSaveModal}},function(e){return{setResolution:function(t){return e(Object(C.Ce)(t))},setViewMode:function(t){return e(Object(C.Dh)(t))},setMixViewMode:function(t){return e(Object(C.pd)(t))},setShowSettings:function(t){return e(Object(C.fg)(t))},dragPattern:function(t){return e(Object(C.i)(t))},setIsPlayingMix:function(t){return e(Object(C.Hc)(t))},setPatternToEditColor:function(t){return e(Object(C.Xd)(t))},setIsRecordingMix:function(t){return e(Object(C.Lc)(t))},setCompactMode:function(t){return e(Object(C.qb)(t))},setZIndexHack:function(t){return e(Object(C.Qh)(t))},setContextualHelp:function(t){return e(Object(C.ub)(t))}}})($)},function(e,t,n){"use strict";var r=n(9),a=n(5),i=n.n(a),o=n(14),s=n(2),c=n(4),u=n(7),l=n(10),f=n(1),h=n(0),p=n.n(h);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}h.Component;function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var v=function(e){Object(u.a)(n,e);var t=m(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).state={requests:{}},r.fetchRequests(),r}return Object(c.a)(n,[{key:"fetchRequests",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n,r,a,o,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.ethereum.guilds.getNewMemberRequests();case 2:t=e.sent,n={},e.t0=i.a.keys(t);case 5:if((e.t1=e.t0()).done){e.next=18;break}return r=e.t1.value,a=t[r].guildId,o=t[r].requester,e.next=11,this.props.ethereum.users.getUserName(o);case 11:return s=e.sent,e.next=14,this.props.ethereum.guilds.getGuildName(a);case 14:c=e.sent,n[a]={guildName:c,userName:s,blockNumber:t[r].blockNumber},e.next=5;break;case 18:this.setState({requests:n});case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"removeRequest",value:function(e){var t={};for(var n in this.state.requests)n!==e&&(t[n]=this.state.requests[n]);this.setState({requests:t})}},{key:"removeProposal",value:function(e){var t=Object(r.a)(this.state.proposals);t.splice(e,1),this.setState({proposals:t})}},{key:"render",value:function(){var e=this;return 0===Object.keys(this.state.requests).length?p.a.createElement("div",null):p.a.createElement("div",{className:"link-requests"},p.a.createElement("div",{className:"requests-header"},"Actions to Take"),Object.keys(this.state.requests).map(function(t){return p.a.createElement(b,{onAccept:function(n){return e.removeRequest(t)},onReject:function(n){return e.removeRequest(t)},ethereum:e.props.ethereum,guildId:t,guildName:e.state.requests[t].guildName,blockNumber:e.state.requests[t].blockNumber,userName:e.state.requests[t].userName})}))}}]),n}(h.Component),b=function(e){Object(u.a)(n,e);var t=m(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).state={date:""},r.fetchDate(),r}return Object(c.a)(n,[{key:"fetchDate",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.ethereum.web3.eth.getBlock(this.props.blockNumber);case 2:t=e.sent,n=new Date(1e3*t.timestamp).toLocaleString(),this.setState({date:n});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"accept",value:function(){this.props.ethereum.guilds.acceptRequestToAddToGuild(this.props.guildId),this.props.onAccept()}},{key:"reject",value:function(){this.props.ethereum.guilds.rejectRequestToAddToGuild(this.props.guildId),this.props.onReject()}},{key:"render",value:function(){var e=this;return p.a.createElement("div",{className:"new-member-request"},p.a.createElement("div",{className:"user-field"},p.a.createElement("a",{className:"user-hyperlink",href:"/user/"+this.props.userName},this.props.userName)),p.a.createElement("div",{className:"action-description"},"requested to add you to ",this.props.guildName),p.a.createElement("span",{className:"action-date"},this.state.date),p.a.createElement("div",{className:"action-btns"},p.a.createElement("div",{onClick:function(){return e.accept()},className:"common-button pink-button"},"ACCEPT"),p.a.createElement("div",{onClick:function(){return e.reject()},className:"common-button pink-button"},"REJECT")))}}]),n}(h.Component);t.a=v},,function(e,t,n){"use strict";var r=n(2);t.a=function e(){Object(r.a)(this,e),this.abi=[{constant:!1,inputs:[{name:"country",type:"bytes32"}],name:"deleteCountry",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"style",type:"bytes32"}],name:"deleteStyle",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"tag",type:"bytes32"}],name:"deleteTag",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"country",type:"bytes32"}],name:"newCountry",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"ipfsHash",type:"bytes32"},{name:"title",type:"string"}],name:"newSample",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"sampleHash",type:"bytes32"},{indexed:!0,name:"tag",type:"bytes32"}],name:"SampleTagged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"sampleHash",type:"bytes32"},{indexed:!0,name:"youtubeVideoId",type:"bytes32"}],name:"SampledYoutube",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"user",type:"address"},{indexed:!0,name:"sampleHash",type:"bytes32"},{indexed:!1,name:"title",type:"string"}],name:"SampleCreated",type:"event"},{constant:!1,inputs:[{name:"sampleHash",type:"bytes32"},{name:"title",type:"string"},{name:"youtubeVideoId",type:"bytes32"},{name:"tagsToAdd",type:"bytes32[4]"},{name:"stylesToAdd",type:"bytes32[4]"},{name:"country",type:"bytes32"},{name:"year",type:"int16"}],name:"newSampleWithMetadata",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"sampleHash",type:"bytes32"},{indexed:!0,name:"country",type:"bytes32"}],name:"SampleCountry",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"sampleHash",type:"bytes32"},{indexed:!0,name:"year",type:"int16"}],name:"SampleYear",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"sampleHash",type:"bytes32"},{indexed:!0,name:"style",type:"bytes32"}],name:"SampleStyle",type:"event"},{constant:!1,inputs:[{name:"sequenceHash",type:"bytes32"},{name:"title",type:"string"}],name:"newSequence",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"style",type:"bytes32"}],name:"newStyle",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"tag",type:"bytes32"}],name:"newTag",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"year",type:"int16"}],name:"newYear",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"user",type:"address"},{indexed:!0,name:"sequenceHash",type:"bytes32"},{indexed:!1,name:"title",type:"string"}],name:"SequenceCreated",type:"event"},{constant:!1,inputs:[{name:"sampleHash",type:"bytes32"},{name:"country",type:"bytes32"}],name:"setSampleCountry",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"sampleHash",type:"bytes32"},{name:"stylesToAdd",type:"bytes32[4]"},{name:"country",type:"bytes32"},{name:"year",type:"int16"}],name:"setSampleDiscogsMetadata",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"sampleHash",type:"bytes32"},{name:"style",type:"bytes32"}],name:"setSampleStyle",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"sampleHash",type:"bytes32"},{name:"tag",type:"bytes32"}],name:"setSampleTag",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"sampleHash",type:"bytes32"},{name:"tagsToAdd",type:"bytes32[4]"}],name:"setSampleTags",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"sampleHash",type:"bytes32"},{name:"year",type:"int16"}],name:"setSampleYear",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"sampleHash",type:"bytes32"},{name:"youtubeVideoId",type:"bytes32"}],name:"setSampleYoutubeVideoId",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"allYears",outputs:[{name:"",type:"int16"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"countries",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getNumberOfCountries",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getNumberOfStyles",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getNumberOfTags",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getNumberOfYears",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"styles",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"tags",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"}],this.contractAddress="0x87efb60d3239958f9e6671b45cae668da531a22b"}},function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(7),o=n(10),s=n(1),c=n(0),u=n.n(c);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var f=function(e){Object(i.a)(n,e);var t=l(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){return u.a.createElement("div",{className:"details-banner"},u.a.createElement("div",{className:"banner-back-button",onClick:this.props.onClickBack},"BACK"),u.a.createElement("div",{className:"banner-heading"},this.props.headerText))}}]),n}(c.Component);t.a=f},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(11),a=n(624),i=n(533),o=function(e,t,n,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#ffffff",u=[e,t,n];Object(i.a)(u),o.beginPath(),o.lineWidth=2,o.moveTo(u[0].x,u[0].y),o.lineTo(u[1].x,u[1].y),o.lineTo(u[2].x,u[2].y),o.closePath(),o.fillStyle="black",o.fill();var l=Object(a.a)(u,s,100),f=l.triangles,h=l.points,p=l.contours;l.segments;o.lineWidth=s>0?1:Math.max(1,Math.pow(s,.5)),f.forEach(function(e){var t=Object(r.a)(e,3),n=t[0],a=t[1],i=t[2];o.beginPath(),o.moveTo(n.x,n.y),o.lineTo(a.x,a.y),o.lineTo(i.x,i.y),o.strokeStyle="rgba(255, 255, 255,0.1)",o.stroke()}),p.forEach(function(e,t){if(0!==e.length){var n="M ".concat(e[0].x,", ").concat(e[0].y," L ")+e.slice(1).map(function(e){return e.x+","+e.y}).join(" "),r=new Path2D(n);p.length,p.length,p.length;o.lineWidth=s<10?1:Math.pow(s,.4),o.strokeStyle=c,o.stroke(r)}}),h.forEach(function(e){o.beginPath(),s<=4?o.fillRect(e.x,e.y,1,1):o.arc(e.x,e.y,1,0,2*Math.PI),o.fillStyle="rgba(255, 255, 255,"+.5*Math.random()+")",o.fill()})}},function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(12);t.a=Object(i.b)(function(e,t){return{triggerCount:t.track.triggerCount,otherTriggerCount:t.track.otherTriggerCount}},function(e){return{}})(function(e){var t=e.triggerCount,n=void 0===t?0:t,r=e.otherTriggerCount,i=void 0===r?0:r,o=e.color,s=n+i,c={width:Math.min(100,100*s/3)+"%",backgroundColor:o};return a.a.createElement("div",{className:"trigger-meter"},a.a.createElement("div",{style:c,className:"trigger-meter-indicator"}))})},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),a=function(e){var t=e.backgroundColor,n=e.theme;Object(r.useEffect)(function(){"dark"===n?(a("explorerColor","#111216"),a("cirklon-slider","#626262"),a("stepBeatDivision","#7d7d7d"),a("editor-bottom","#1d1f24"),a("piano-roll-control","#191919"),a("baseColor","black"),a("dividerColor","#80808052"),a("antiColor","white"),a("sidebarColor","#1d1f24"),a("sidebarColor2","#565656"),a("trackBorderColor","#1d1f24"),a("toolbarBackground","#1d1f24"),a("sampler-wrapper","#191b1fd6"),a("editorBackground","#111216"),a("sampleChooser","#32363c"),a("sidebar-btn","#52585c"),a("instrumentChooser","#353535"),a("trackInner","#000000a6"),a("guideStep","#252829"),a("stepColor","#4a4949"),a("toolbarButton","#16151d"),a("pianoRollRow","#171717"),a("pianoRollRowBlack","#0000008c"),a("lightInput","black"),a("menuBackground","#424242")):(a("explorerColor","#e1e3e9"),a("baseColor","white"),a("guideStep","#adafaf"),a("dividerColor","#80808052"),a("antiColor","black"),a("sampler-wrapper","#c1c4cad6"),a("sidebarColor","white"),a("sidebarColor2","gray"),a("toolbarBackground","#2c2c2c"),a("trackBorderColor","#cbcbcb"),a("cirklon-slider","#626262"),a("editorBackground",t),a("sampleChooser","#32363c"),a("sidebar-btn","#dbddde"),a("piano-roll-control","#dbddde"),a("editor-bottom","#a9a9a9"),a("instrumentChooser","#353535"),a("trackInner","#0000004d"),a("stepColor","#e2e2e2"),a("stepBeatDivision","#5e5e5e"),a("toolbarButton","#16151d"),a("pianoRollRow","white"),a("pianoRollRowBlack","#e1e1e1"),a("lightInput","white"),a("menuBackground","#424242"))},[n,t]);var a=function(e,t){document.documentElement.style.setProperty("--"+e,t)}}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=n(9),a=n(11),i=n(0),o=n.n(i),s=n(335),c=n(28),u=n(886),l=n(12),f=n(534),h=Object(l.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.parameter,r=e.connectToLFO,s=e.disconnectFromLFO,l=Object(i.useCallback)(function(){if(n)return n.availableLFOs;if(void 0!==t&&n){var e=n.track||n.context&&n.context.track;return e&&e.subSequence?e.subSequence.lfosTrack.lfos.map(function(e){return e.lfo}):n.context.subSequence?n.context.subSequence.lfosTrack.lfos.map(function(e){return e.lfo}):t.lfosTrack.lfos.map(function(e){return e.lfo})}return[]},[n]),h=Object(i.useState)(l()),p=Object(a.a)(h,2),d=p[0],m=p[1];return Object(i.useEffect)(function(){m(l())},[n,m]),o.a.createElement("div",{className:"modulators-container"},o.a.createElement("div",{className:"lfo-boxes"},d&&d.map(function(e,t){return o.a.createElement(f.a,Object(c.a)({connectToLFO:r,disconnectFromLFO:s,key:t,isToggled:!0,parameter:n,lfo:e,lfos:d},"parameter",n))})),o.a.createElement(u.a,{sequencerEngine:t,parameter:n}))}),p=(n(22),n(29)),d=new p.a,m=Object(l.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setSelectedColor,n=e.macro,r=e.macroToShow,c=e.setMacroToShow,u=Object(i.useState)(!1),l=Object(a.a)(u,2),f=l[0],p=l[1],m=Object(i.useState)(n.color),v=Object(a.a)(m,2),b=v[0],g=v[1],y=n===r,k=n.effect.track.sequencerEngine,O=n.signalParameter,j=Object(i.useCallback)(function(e){n.color=e.hex,g(e.hex),t(e)},[t,n,g]);return Object(i.useEffect)(function(){g(n.color)},[n,g]),o.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"macro-info"},o.a.createElement("div",{style:{backgroundColor:d.getColorForHash(n.id)},className:"macro-indicator"}),o.a.createElement("div",{className:"macro-name"},n.name),o.a.createElement(h,{parameter:O,sequencerEngine:k,disconnectFromLFO:function(e,t){return n.disconnectFromLFO(e,t)},connectToLFO:function(e,t){return n.connectToLFO(e,t)}}),o.a.createElement("div",{onClick:function(){return p(!f)},style:{backgroundColor:b},className:f?"color-btn showing":"color-btn"}),f&&o.a.createElement(s.a,{color:b,onChange:j}),o.a.createElement("div",{onClick:function(){return c(y?void 0:n)},className:y?"selected macro-show-btn":"macro-show-btn"},y?"Collapse":"Expand"))}),v=n(6),b=n(62),g=Object(l.b)(function(e,t){return{value:t.parameter[t.arg],_value:t.parameter.get(!0),depth:t.parameter._depth,minMax:e.effects.parameterMinMax[t.parameter.id]}},function(e){return{setParameterMinMax:function(t){return e(Object(v.Qd)(t))}}})(function(e){var t=e.value,n=e.parameter,r=e.arg,s=e.label,c=e.setParameterMinMax,u=Object(i.useState)(!1),l=Object(a.a)(u,2),f=l[0],h=l[1],p=Object(i.useState)(t),d=Object(a.a)(p,2),m=d[0],v=d[1];Object(i.useEffect)(function(){v(t)},[t,v]);var g=Object(i.useCallback)(function(e){var t=e.target.value;if("."===t)t=0;else if("-"===t)t=0;else if(""===t)t=0;else if(!Object(b.a)(t))return;t=parseFloat(t),n[r]=t;var a={};a[n.id]={min:n.min,max:n.max},a[n.id][r]=t,c(a),v(t)},[v,r,n]);Object(i.useEffect)(function(){f||v(t)},[f,t,v]);var y=Object(i.useCallback)(function(e){"Enter"===e.key&&h(!1)},[h]),k="d-parameter-"+r;return f?o.a.createElement("div",{className:k},s,":",o.a.createElement("input",{onKeyDown:y,className:"min-max-input",value:m,onChange:g,type:"text"})):o.a.createElement("div",{onClick:function(){return h(!0)},className:k},s,": ",Math.round(1e3*t)/1e3)}),y=new p.a,k=Object(l.b)(function(e,t){return{value:t.parameter.get(!0),depth:t.parameter._depth}},function(e){return{}})(function(e){var t=e.value,n=e.setSelected,r=e.selected,a=e.setParameter,s=e.parameter,c=e.parameterSelected,u=e.depth,l=e.isBoundsMode,f=(e.max,e.min,s),h=Object(i.useCallback)(function(e){e.hasGroup.ungroupParameter(e),n(r.filter(function(t){return t!==e}))},[n,r]);t=t<10?Math.round(1e3*t)/1e3:s.max-s.min>=1e3?Math.round(t):s.max-s.min>=100?Math.round(10*t)/10:Math.round(100*t)/100,u=Math.round(100*u)/100;var p=f.locked2D?"device-parameter locked":"device-parameter";return r.includes(f)&&(p+=" selected"),o.a.createElement("div",{onClick:function(){return n([f])},id:c===f?"accumulator-map-source":"",className:p},o.a.createElement("div",{onClick:function(){return a(f===c?void 0:f)},className:"dot",style:{backgroundColor:y.getColorForHash(f.name)}}),o.a.createElement("div",{className:"d-parameter-name"},f.name),l?o.a.createElement(g,{arg:"min",label:"Min",parameter:s}):o.a.createElement("div",{className:"d-parameter-value"},t),l?o.a.createElement(g,{arg:"max",label:"Max",parameter:s}):o.a.createElement("div",{className:"d-parameter-depth"},u),f.hasGroup&&!l?o.a.createElement("div",{onClick:function(){return h(f)},className:"ungroup-parameter"},"Ungroup"):"")});function O(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S=new p.a,P=function(e){var t=e.device,n=e.parameters,r=e.parameterSelected,a=e.setParameter,s=e.setSelected,c=e.selected,u=e.isBoundsMode;Object(i.useEffect)(function(){return function(){return n.includes(r)?a(void 0):void 0}},[r,n]);var l=n.filter(function(e){return!e.isPlaneMacro});return o.a.createElement("div",{className:"device"},o.a.createElement("div",{className:"device-name"},t),o.a.createElement("div",{className:"device-parameters"},l.map(function(e){return o.a.createElement(k,{isBoundsMode:u,setSelected:s,selected:c,parameter:e,setParameter:a,parameterSelected:r})})))},x=function(e){var t,n=new Set,r=w(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.hasGroup&&n.add(a.hasGroup)}}catch(i){r.e(i)}finally{r.f()}return Array.from(n)};t.a=Object(l.b)(function(e,t){return{parameterSelected:e.effects.accumulatorParameterSelected}},function(e){return{setParameter:function(t){return e(Object(v.r)(t))}}})(function(e){var t=e.macroToShow,n=e.setSelectedColor,s=e.setMacroToShow,c=e.setSelected,u=e.effect,l=e.setFilteredParameters,f=e.selected,h=e.filteredParameters,p=void 0===h?[]:h,d=e.setParameter,v=e.parameterSelected,b=e.expanded,g=e.isBoundsMode,y=Object(i.useState)(!1),k=Object(a.a)(y,2),j=k[0],E=k[1],T=Object(i.useState)(""),C=Object(a.a)(T,2),N=C[0],R=C[1];Object(i.useEffect)(function(){l(""===N?void 0:function(e,t){var n,r=[],a=O(e._parameters);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=[];i&&i.name&&(i.context&&(i.context.subDevice&&i.context.subDevice.name&&o.push(i.context.subDevice.name.toLowerCase()),i.context.effect&&i.context.effect.name&&o.push(i.context.effect.name.toLowerCase()),i.context.midiEffect&&i.context.midiEffect.name&&o.push(i.context.midiEffect.name.toLowerCase())),o.push(i.name.toLowerCase()),o.some(function(e){return e.includes(t.toLowerCase())})&&r.push(i))}}catch(s){a.e(s)}finally{a.f()}return r}(u,N)),c([])},[u,c,N,l]);var M=p.length>0?p:f,A=!1;M[0]&&M[0].isPlaneMacro&&(A=M[0],M=A.parameters),!A&&t&&(A=t);var q,D=[].concat(Object(r.a)(x(M)),[void 0]),I={},_=w(D);try{var F=function(){var e=q.value,t=M.filter(function(t){return t.hasGroup===e});if(0===t.length)return"continue";var n,r={},a=w(t);try{for(a.s();!(n=a.n()).done;){var i=n.value,o="Other";i.context&&(o=i.context.subDevice?i.context.subDevice.name:i.context.effect?i.context.effect.name:i.context.midiEffect?i.context.midiEffect.name:i.context.instrument?i.context.instrument.getName():i.context.lfoTrack?"LFO "+i.context.lfoTrack.lfo.number:"Other"),r[o]||(r[o]=[]),r[o].push(i)}}catch(s){a.e(s)}finally{a.f()}I[e?e.id:0]=r};for(_.s();!(q=_.n()).done;)F()}catch(L){_.e(L)}finally{_.f()}return j?o.a.createElement("div",{draggable:!0,onDragStart:function(e){return e.preventDefault()},onDragOver:function(e){return e.preventDefault()},className:"plane-sidebar hide"},o.a.createElement("div",{className:"sidebar-header"},o.a.createElement("div",{className:"collapse-toggle"},o.a.createElement("div",{onClick:function(){return E(!j)},className:j?"arrow-down":"arrow-right"})))):o.a.createElement("div",{draggable:!0,onDragStart:function(e){return e.preventDefault()},onDragOver:function(e){return e.preventDefault()},className:"plane-sidebar"},b?o.a.createElement("div",{className:"sidebar-header"},o.a.createElement("div",{className:"collapse-toggle"},o.a.createElement("div",{onClick:function(){return E(!j)},className:"arrow-right"}))):"",o.a.createElement("div",{className:"plane-search-container"},o.a.createElement("input",{value:N,onChange:function(e){return R(e.target.value)},type:"text",placeholder:"Search for parameters",className:"plane-search"}),o.a.createElement("div",{onClick:function(){return R("")},className:"clear-btn"},"x")),o.a.createElement("div",{className:"plane-results parameters-list"},A&&o.a.createElement(m,{setSelectedColor:n,macroToShow:t,setMacroToShow:s,macro:A}),Object.keys(I).map(function(e,t){return o.a.createElement("div",{key:e,className:"plane-param-group"},o.a.createElement("div",{className:"group-parameters-name"},o.a.createElement("div",{onClick:function(){return c("0"===e?M.filter(function(e){return!e.hasGroup}):M.filter(function(t){return t.hasGroup&&t.hasGroup.id===e}))},className:"group-thumb",style:{backgroundColor:"0"===e?"gray":S.getColorForHash(e)}}),o.a.createElement("div",null,"0"===e?"Not Grouped":"Group "+(u.groups.map(function(e){return e.id}).indexOf(e)+1))),o.a.createElement("div",{className:"group-parameters"},Object.keys(I[e]).map(function(t){return o.a.createElement(P,{key:t.id,setSelected:c,isBoundsMode:g,selected:f,setParameter:d,parameterSelected:v,device:t,parameters:I[e][t]})})))})))})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(205),s=n(384),c=n(9),u=n(39),l=n.n(u),f=n(12),h=(Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.parameter,n=e.sequencerEngine,o=Object(a.useState)(t.get()),s=Object(r.a)(o,2),u=(s[0],s[1]),f=n.tracks.map(function(e){return e.pattern.stepGroups.map(function(t){return t.transformations.map(function(n,r){return{value:n.id,label:e.trackNumber+1+"."+t.name+".tr"+(r+1)}})}).reduce(function(e,t){return[].concat(Object(c.a)(e),Object(c.a)(t))},[])}).reduce(function(e,t){return[].concat(Object(c.a)(e),Object(c.a)(t))},[]),h=Object(a.useCallback)(function(e){t.set(e.value),u(e.value)},[u]);return i.a.createElement(l.a,{options:f,value:f.find(function(e){return e.value===t.get()}),onChange:h,placeholder:"Depends"})}),n(62)),p=n(6),d=Object(f.b)(function(e,t){return{isMacroMapping:e.effects.isMacroMapping,val:t.parameter.get()}},function(e){return{setParameterToMap:function(t){return e(Object(p.Td)(t))}}})(function(e){var t=e.val,n=e.placeholder,o=e.parameter,s=e.className,c=e.isMacroMapping,u=e.setParameterToMap,l=Object(a.useState)(""),f=Object(r.a)(l,2),p=f[0],d=f[1];Object(a.useEffect)(function(){d(t)},[t,d]);var m=Object(a.useCallback)(function(e){var t=e.target.value;if("."===t||"-."===t)t=0;else if("-"===t)t=0;else if(""===t)t=0;else{if(!Object(h.a)(t))return;t=parseFloat(t)}o.set(t),d(t)},[d,o]);c&&(s+=" mapping");var v=Object(a.useCallback)(function(e){c&&(e.stopPropagation(),e.preventDefault(),o.isMapped||u(o))},[c,o]),b="parameter-"+o.id;return i.a.createElement("input",{id:b,onClick:v,className:s,value:p,onChange:m,placeholder:n})}),m=n(22),v=n(29),b=n(103),g=new v.a;t.a=Object(f.b)(function(e,t){return{_whenType:t.transformation.whenType}},function(e){return{}})(function(e){var t=e.transformation,n=e.sequencerEngine,c=e.track,u=e._whenType,f=Object(a.useState)(t.whenType),h=Object(r.a)(f,2),p=h[0],v=h[1],y=Object(a.useState)(t.thenType),k=Object(r.a)(y,2),O=k[0],j=k[1],w=Object(a.useState)(t.thenValue),E=Object(r.a)(w,2),S=(E[0],E[1],{color:g.getColorForHash(t.id)});Object(a.useEffect)(function(){v(u)},[u,v]);var P=Object(a.useCallback)(function(e){var n=e.value;t.whenType=n,v(n)},[v,t]),x=Object(a.useCallback)(function(e){var n=e.value;t.thenType=n,n===b.n&&(t.midiEffect=new s.a(c)),j(n)},[j,t,c]),T=Object(b.r)(t.thenType),C=T.min,N=T.max,R=T.step;return i.a.createElement("div",{className:"step-transformation-editor"},i.a.createElement("div",{className:"transformation-header"},i.a.createElement("div",{style:S,className:"transformation-name"},t.name),i.a.createElement("div",{className:p?"transformation":"transformation none"},i.a.createElement(l.a,{options:b.q,value:b.q.find(function(e){return e.value===p}),onChange:P,placeholder:"When"}),p===b.g?i.a.createElement(d,{className:"when-value",placeholder:"Value",parameter:t.auxValue}):i.a.createElement(d,{className:"when-value",placeholder:"Value",parameter:t.whenValue}),i.a.createElement("div",{className:"unit-type"},p===b.k||p===b.g?"%":" loops"),i.a.createElement(l.a,{className:"action",options:b.o,value:b.o.find(function(e){return e.value===O}),onChange:x,placeholder:"Action"}))),b.i.includes(O)?i.a.createElement("div",{className:"transformation"},i.a.createElement(m.a,{root:1,min:C,max:N,step:R,parameter:t.thenValue,name:"Amount"})):"",O===b.n&&t.midiEffect?i.a.createElement(o.a,{effect:t.midiEffect,sequencerEngine:n,track:c}):"")})},function(e,t,n){"use strict";var r=n(11),a=n(0),i=n.n(a),o=n(69),s=n(75),c=n(55),u=n(12),l=new(n(29).a),f=Object(u.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.frozenTrack,u=e.frozenTracks,f=e.frozenGroup,p=n.trackData,d=Object(a.useState)(void 0),m=Object(r.a)(d,2),v=m[0],b=m[1],g=p.type;Object(a.useEffect)(function(){if(p.type===c.f){var e=Object.keys(p.samplers)[0];if(e){var t=new s.a(e);t.load(!1).then(function(){b(t)})}}},[b,n]);var y=Object(a.useCallback)(function(){t.unfreeze(f,u,n)},[n,u,f,t]);if(g===c.f){if(!v)return[];var k={backgroundColor:l.getColorForHash(v.getId())},O=v.getThumbnail();return O&&""!==O&&(k.backgroundImage="url("+O+")"),i.a.createElement("div",{className:"frozen-track"},i.a.createElement("div",{className:"frozen-info-container"},i.a.createElement("div",{onClick:y,style:k,className:"frozen-track-thumbnail"}),i.a.createElement("div",{className:"frozen-track-name"},v.name.trim())))}if(g===c.b){var j=p.instrumentType,w=p.presetName||o.d[j],E={backgroundColor:l.getColorForHash(w)};return i.a.createElement("div",{className:"frozen-track"},i.a.createElement("div",{className:"frozen-info-container"},i.a.createElement("div",{onClick:y,style:E,className:"frozen-track-thumbnail"}),i.a.createElement("div",{className:"frozen-track-name"},w)))}if(g===c.e){var S=p.presetName||"Multi Freeze",P={backgroundColor:l.getColorForHash(S)};return p.presetName&&(S=p.presetName+" (Multi Freeze)"),i.a.createElement("div",{className:"frozen-track"},i.a.createElement("div",{className:"frozen-info-container"},i.a.createElement("div",{style:P,className:"dot frozen-track-thumbnail"}),i.a.createElement("div",{className:"frozen-track-name"},p.presetName||"Multi Freeze Track")),i.a.createElement(h,{_track:t,track:p}))}return[]}),h=(n(2558),t.a=Object(u.b)(function(e,t){return{frozenTracks:t.track.frozenTracks}},function(e){return{}})(function(e){var t=e.track,n=e._track,o=void 0===n?t:n,s=t.frozenTracks,c=t.frozenGroup,u=Object(a.useState)(!1),l=Object(r.a)(u,2),h=l[0],p=l[1],d=Object(a.useCallback)(function(){o.unfreeze(t.frozenGroup,t.frozenTracks)},[o,t]);return s?i.a.createElement("div",{className:h?"freeze-history hovered":"freeze-history"},i.a.createElement("div",{className:"unfreeze-button",onClick:d,onMouseLeave:function(){return p(!1)},onMouseOver:function(){return p(!0)}},"Unfreeze"),s.filter(function(e){return e}).map(function(e){return i.a.createElement(f,{track:o,frozenTracks:s,frozenGroup:c,frozenTrack:e})})):""}))},function(e,t,n){e.exports=n(2713)},,,,function(e,t,n){},,,,function(e,t,n){},,,,,,,,,,,,,function(e,t){},,function(e,t){},,function(e,t){},,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,function(e,t){},function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,function(e,t){},,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,function(e,t){},,function(e,t){},,,,,,function(e,t){},function(e,t){},,,,,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,function(e,t){},,function(e,t){},,,,,,function(e,t){},,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,function(e,t){},,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,function(e,t){},,function(e,t){},,,,,,,function(e,t,n){},,,,,,function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r={"./amulet/20210221.json":2674,"./catalog/20210202.json":2675,"./zora/20210101.json":2676,"./zora/20210604.json":2677};function a(e){var t=i(e);return n(t)}function i(e){var t=r[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}a.keys=function(){return Object.keys(r)},a.resolve=i,e.exports=a,a.id=2673},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r,a,i,o,s,c=n(0),u=n.n(c),l=n(194),f=n.n(l),h=(n(1562),n(2)),p=n(4),d=n(7),m=n(10),v=n(1),b=n(11),g=n(12),y=(n(1566),function(e){var t=e.showStemPlayer,n=e.setShowStemPlayer,r=e.brect,a=e.tokenId,i=e.playerChosen,o=e.isOver,s=e.mouse,l=e.setOver,f=e.rarity,h=e.thumbnail,p=e.setPlayerChosen,d=Object(c.useRef)(),m=d.current&&d.current.getBoundingClientRect(),v=m&&s&&s.x-m.left+r.left,b=m&&s&&s.y-m.top+r.top,g="spore-player-option";return i===a?g+=" chosen":i&&(g+=" unchosen"),u.a.createElement("div",{ref:d,onMouseOver:function(){return l(a)},onClick:function(){t?n(void 0):p(i===a?void 0:a)},className:g},o&&s&&u.a.createElement("div",{className:"mouse-radial",style:{left:v-500,top:b-500}}),u.a.createElement("img",{src:h}),u.a.createElement("div",{className:"sp-fields"},u.a.createElement("div",{className:"sp-name"},"SP-",a),u.a.createElement("div",{className:"sp-rarity"},f)))}),k=Object(g.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.playerChosen,n=e.setPlayerChosen,r=e.showStemPlayer,a=e.setShowStemPlayer,i=Object(c.useRef)(),o=Object(c.useState)(void 0),s=Object(b.a)(o,2),l=(s[0],s[1],Object(c.useState)()),f=Object(b.a)(l,2),h=f[0],p=f[1],d=Object(c.useState)(),m=Object(b.a)(d,2),v=m[0],g=m[1],k=Object(c.useCallback)(function(e){var t=i.current.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top;p({x:n,y:r})},[p]),O=Object(c.useCallback)(function(){p(void 0)},[p]),j=i.current&&i.current.getBoundingClientRect();Object(c.useEffect)(function(){console.log("over=",v)},[v]);var w="caurosel";return t&&(w+=" player-chosen"),u.a.createElement("div",{onMouseLeave:O,ref:i,onMouseMove:k,className:w},h&&u.a.createElement("div",{className:"mouse-radial",style:{left:h.x-500,top:h.y-500}}),u.a.createElement(y,{playerChosen:t,brect:j,setShowStemPlayer:a,showStemPlayer:r,mouse:h,isOver:1===v,setOver:g,setPlayerChosen:n,rarity:"Convolver",tokenId:1,thumbnail:"/sp-1-thumbnail.png"}),u.a.createElement(y,{setShowStemPlayer:a,showStemPlayer:r,brect:j,playerChosen:t,mouse:h,isOver:2===v,setOver:g,setPlayerChosen:n,rarity:"Ionic Filter",tokenId:2,thumbnail:"/sp-2-thumbnail.png"}),u.a.createElement(y,{setShowStemPlayer:a,showStemPlayer:r,brect:j,playerChosen:t,mouse:h,isOver:3===v,setOver:g,setPlayerChosen:n,rarity:"WaveFolder",tokenId:3,thumbnail:"/sp-3-thumbnail.png"}))}),O=n(247),j=n(746),w=n(456),E=n(557),S=n(15),P=n.n(S),x=function(e){return e.slice(0,4)+"..."+e.slice(-4)},T=function(e){e||(e=0);var t=Math.floor(e/60),n=Math.floor(e-60*t);return n<10&&(n="0"+n),"".concat(t,":").concat(n)},C=Object(g.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.creator,n=e.audioUnit,r=Object(c.useState)(!1),a=Object(b.a)(r,2),i=a[0],o=a[1],s=Object(c.useState)(void 0),l=Object(b.a)(s,2),f=l[0],h=l[1],p=Object(c.useState)(0),d=Object(b.a)(p,2),m=d[0],v=d[1],g=Object(c.useCallback)(function(){var e=P.a.Master.context.currentTime-f;i&&v(e/n.duration)},[i,v,f]);Object(w.a)(g,1e3);var y=Object(c.useCallback)(function(){i?n.stopSound():n.playSound(0),o(!i),v(0),h(P.a.Master.context.currentTime)},[i,v,o,n]);return Object(c.useEffect)(function(){return function(){return n.stopSound()}},[]),m=Math.min(100,m),u.a.createElement("div",{className:"audio-player"},u.a.createElement(E.a,{isPlaying:i,play:y}),u.a.createElement("div",{className:"play-time-and-slider"},u.a.createElement("div",{className:"play-slider"},u.a.createElement("div",{style:{width:240*m},className:"play-slider-inner"})),u.a.createElement("div",{className:"play-time"},u.a.createElement("div",{className:"time"},T(m*n.duration)," / ",T(n.duration)),u.a.createElement("div",{className:"creator"},x(t))),u.a.createElement("div",{className:"song-title-and-author"},u.a.createElement("div",{className:"song-title"},"Psilocybin"),u.a.createElement("div",{className:"song-creator"},"Keyon Christ"))))}),N=n(40),R=n(8),M=n(5),A=n.n(M),q=n(14),D=function(){function e(){Object(h.a)(this,e),this.abi=[{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes32",name:"sporeHash",type:"bytes32"},{internalType:"string",name:"message",type:"string"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"newSpore",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"",type:"uint256"},{indexed:!1,internalType:"uint256",name:"",type:"uint256"},{indexed:!1,internalType:"address",name:"",type:"address"},{indexed:!1,internalType:"address",name:"",type:"address"},{indexed:!1,internalType:"bytes32",name:"",type:"bytes32"}],name:"NewSporeCreated",type:"event"},{inputs:[{internalType:"string",name:"message",type:"string"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"verifyString",outputs:[{internalType:"address",name:"signer",type:"address"}],stateMutability:"pure",type:"function"}],this.contractAddress="0x8499252B8738b94Bf60D5Ac1CA0632Be816e6eF9"}return Object(p.a)(e,[{key:"getContract",value:function(e){return new e.eth.Contract(this.abi,this.contractAddress)}}]),e}(),I=n(354),_=n(31),F=n(47),L=n(588),B=function(){var e=Object(q.a)(A.a.mark(function e(t){var n,r;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new N.a((new D).contractAddress).from(_.I),e.next=3,n.executeQuery();case 3:return r=e.sent,void 0!==t&&(r=r.filter(function(e){return null===e.tokenId&&1===t||e.tokenId===t})),e.abrupt("return",r);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(q.a)(A.a.mark(function e(t,n){var r,a,i,o,s,c,u,l;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new N.a((new D).contractAddress).from(_.I),t&&r.where("sporeId",t.sporeId),e.next=4,r.executeQuery();case 4:if(a=e.sent,void 0!==n&&(a=a.filter(function(e){return null===e.tokenId&&1===n||e.tokenId===n})),0!==a.length){e.next=8;break}return e.abrupt("return",null);case 8:return console.log("RESULTS=",a),i=a[0],o=i.sporeHash,e.next=13,F.a.getSound(o,1e6);case 13:return s=e.sent,e.next=16,P.a.Master.context.decodeAudioData(L(s));case 16:return c=e.sent,(u=new I.a(P.a.Master.context)).setBuffer(c),l=Object(R.a)({audioUnit:u,audioBuffer:c},i),e.abrupt("return",l);case 21:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),V=n(202),H=Object(g.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.selected,n=e.tokenId,r=(e.spore,e.setShowStemPlayer),a=Object(c.useState)(!1),i=Object(b.a)(a,2),o=(i[0],i[1],Object(c.useState)(void 0)),s=Object(b.a)(o,2),l=s[0],f=s[1];Object(c.useEffect)(function(){f(void 0),z(t,n).then(function(e){f(e)})},[f,n,t]);return u.a.createElement("div",{className:"simple-player"},null===l?u.a.createElement("div",{onClick:function(){Object(j.a)("QmZ2QDquVcE9KVZFCqJRDWfzdgzp3E4T2PutPnCYpkRu64",0).then(function(e){console.log("spore made=",e)})},className:"no-spores"},"No spores have been made yet."):l?u.a.createElement(C,{creator:l.creator,audioUnit:l.audioUnit}):u.a.createElement(V.a,{intervalTime:100,intervalPiece:3,text:t?"Loading Spore #"+t.sporeId:"Loading Latest Spore"}),!t&&u.a.createElement("div",{onClick:function(){return r(!0)},className:"pushable stem-player-button"},"Expand Player"),t&&u.a.createElement("div",{className:"stem-player-button mint-spore"},"Mint Spore",u.a.createElement("div",{className:"spore-tooltip"},"to mint, you must own a spore player")))}),U=n(655),J=n(654),G=Object(g.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.spore,n=e.isSelected,r=e.setSelected,a=Object(c.useState)(),i=Object(b.a)(a,2),o=i[0],s=i[1];return Object(c.useEffect)(function(){Object(J.a)(t.blockNumber).then(s)},[t]),u.a.createElement("div",{onClick:function(){return r(t)},className:n?"spore-item selected":"spore-item"},u.a.createElement("div",{className:"spore-id"},"Spore #",t.sporeId),u.a.createElement("div",{className:"hyphen"}),u.a.createElement("div",{className:"spore-creator"},x(t.creator)),u.a.createElement("div",{className:"spore-date"},o&&function(e){var t=(new Date).getTime()-e.getTime();return console.log("distance = ",t),t<36e5?"".concat(Math.round(t/1e3/60)," min. ago"):t<1728e5?"".concat(Math.round(t/1e3/60/60)," hours ago"):Object(U.a)(e)}(o)))}),W=Object(g.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setShowStemPlayer,n=e.tokenId,r=Object(c.useState)([]),a=Object(b.a)(r,2),i=a[0],o=a[1],s=Object(c.useRef)(),l=Object(c.useState)(),f=Object(b.a)(l,2),h=f[0],p=f[1];return Object(c.useEffect)(function(){console.log("token id in sporesview=",n),B(n).then(function(e){o(e)})},[o,n]),Object(O.a)(s),u.a.createElement("div",{className:"list-and-player"},u.a.createElement("div",{ref:s,className:"spores-list"},0===i.length&&u.a.createElement("div",{className:"no-spores-yet"},"No spores have been detected on-chain."),i.map(function(e){return u.a.createElement(G,{isSelected:e===h,setSelected:p,spore:e})})),h&&u.a.createElement(H,{selected:h,setShowStemPlayer:t}))}),K=(n(92),n(49)),X="\n#define GLSLIFY 1\n#define PI 3.14159265\n\n// Common uniforms\nuniform vec2 u_resolution;\nuniform vec2 u_mouse;\nuniform float u_time;\nuniform float u_frame;\n\n/*\n * Random number generator with a float seed\n *\n * Credits:\n * http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0\n */\nhighp float random1d(float dt) {\n    highp float c = 43758.5453;\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\n/*\n *  Returns a random drop position for the given seed value\n */\nvec2 random_drop_pos(float val, vec2 screen_dim, vec2 velocity) {\n    float max_x_move = velocity.x * abs(screen_dim.y / velocity.y);\n    float x = -max_x_move * step(0.0, max_x_move) + (screen_dim.x + abs(max_x_move)) * random1d(val);\n    float y = (.95 + 0.05 * random1d(1.234 * val)) * screen_dim.y;\n\n    return vec2(x/3.0, y);\n}\n\n/*\n * Calculates the drop trail color at the given pixel position\n */\nvec3 trail_color(vec2 pixel, vec2 pos, vec2 velocity_dir, float width, float size) {\n    vec2 pixel_dir = pixel - pos;\n    float projected_dist = dot(pixel_dir, -velocity_dir);\n    float tanjential_dist_sq = dot(pixel_dir, pixel_dir) - pow(projected_dist, 2.0);\n    float width_sq = pow(width, 2.0);\n\n    float line = step(0.0, projected_dist) * (1.0 - smoothstep(width_sq / 3.0, width_sq, tanjential_dist_sq));\n    float dashed_line = line * step(0.5, cos(0.3 * projected_dist - PI / 3.0));\n    float fading_dashed_line = dashed_line * (1.0 - smoothstep(size / 5.0, size, projected_dist));\n\n    return vec3(fading_dashed_line);\n}\n\n/*\n * Calculates the drop wave color at the given pixel position\n */\nvec3 wave_color(vec2 pixel, vec2 pos, float size, float time) {\n    vec2 pixel_dir = pixel - pos;\n    float distorted_dist = length(pixel_dir * vec2(1.0, 3.5));\n\n    float inner_radius = (0.05 + 0.8 * time) * size;\n    float outer_radius = inner_radius + 0.25 * size;\n\n    float ring = smoothstep(inner_radius, inner_radius + 5.0, distorted_dist)\n            * (1.0 - smoothstep(outer_radius, outer_radius + 5.0, distorted_dist));\n    float fading_ring = ring * (1.0 - smoothstep(0.0, 0.7, time));\n\n    return vec3(fading_ring);\n}\n\n/*\n * Calculates the background color at the given pixel position\n */\nvec3 background_color(vec2 pixel, vec2 screen_dim, float time) {\n    return vec3(0.0, 0.0, 1.0 - smoothstep(-1.0, 0.8 + 0.2 * cos(0.5 * time), pixel.y / screen_dim.y*4.0));\n}\n\n/*\n * The main program\n */\nvoid main() {\n    // Set the total number of rain drops that are visible at a given time\n    const float n_drops = 17.0;\n\n    // Set the drop trail radius\n    float trail_width = 2.0;\n\n    // Set the drop trail size\n    float trail_size = 90.0;\n\n    // Set the drop wave size\n    float wave_size = 10.0;\n\n    // Set the drop fall time in seconds\n    float fall_time = 1.7;\n\n    // Set the drop total life time\n    float life_time = fall_time + 0.5;\n\n    // Set the drop velocity in pixels per second\n    vec2 velocity = vec2(u_mouse.x - 0.5 * u_resolution.x, -0.9 * u_resolution.y) / fall_time;\n    vec2 velocity_dir = normalize(velocity/gl_FragCoord.x);\n\n    // Iterate over the drops to calculate the pixel color\n    vec3 pixel_color = vec3(0.0);\n\n    for (float i = 0.0; i < n_drops; ++i) {\n        // Offset the running time for each drop\n        float time = u_time + life_time * (i + i / n_drops);\n\n        // Calculate the time since the drop appeared on the screen\n        float ellapsed_time = mod(time, life_time);\n\n        // Calculate the drop initial position\n        vec2 initial_pos = random_drop_pos(i + floor(time / life_time - i) * n_drops, u_resolution, velocity);\n\n        // Add the drop to the pixel color\n        if (ellapsed_time < fall_time) {\n            // Calculate the drop current position\n            vec2 current_pos = initial_pos + ellapsed_time * velocity;\n\n            // Add the trail color to the pixel color\n            pixel_color += trail_color(gl_FragCoord.xy, current_pos, velocity_dir, trail_width*sin(gl_FragCoord.x), trail_size);\n        } else {\n            // Calculate the drop final position\n            vec2 final_pos = initial_pos + fall_time * velocity;\n\n            // Add the wave color to the pixel color\n            pixel_color += wave_color(gl_FragCoord.xy + sin(gl_FragCoord.x*0.01) , final_pos, wave_size, ellapsed_time - fall_time);\n        }\n    }\n\n    // Add the background color to the pixel color\n    pixel_color += background_color(sin(gl_FragCoord.x*.001)+gl_FragCoord.xy, u_resolution, u_time);\n\n    // Fragment shader output\n    gl_FragColor = vec4(pixel_color, 1.0);\n}\n",Q="\n#define GLSLIFY 1\n/*\n * The main program\n */\nvoid main() {\n    // Vertex shader output\n    gl_Position = vec4(position, 1.0);\n}\n",Y=function(e){function t(){requestAnimationFrame(t),s.u_time.value=o.getElapsedTime(),s.u_frame.value+=1,r.render(a,i)}function n(e){r.setSize(window.innerWidth,window.innerHeight),s.u_resolution.value.set(window.innerWidth,window.innerHeight).multiplyScalar(window.devicePixelRatio)}Object(c.useEffect)(function(){!function(){(r=new K.S).setPixelRatio(window.devicePixelRatio),r.setSize(window.innerWidth/2,window.innerHeight/2),e.current.appendChild(r.domElement),a=new K.H,i=new K.z(-1,1,1,-1,0,1),o=new K.i(!0);var t=new K.B(2,2);s={u_time:{type:"f",value:0},u_frame:{type:"f",value:0},u_resolution:{type:"v2",value:new K.O(window.innerWidth,window.innerHeight).multiplyScalar(window.devicePixelRatio)},u_mouse:{type:"v2",value:new K.O(.7*window.innerWidth,window.innerHeight).multiplyScalar(window.devicePixelRatio)}};var c=new K.I({uniforms:s,vertexShader:Q,fragmentShader:X}),u=new K.u(t,c);a.add(u),window.addEventListener("resize",n,!1)}(),t()},[])},Z={1:"https://zequencer.mypinata.cloud/ipfs/QmYErgGMEmZLnnP1vAvMKQNMVTPqKJh2WiLETujZXDS2HR/",2:"https://zequencer.mypinata.cloud/ipfs/QmeGU4SzFDPdkv38kwAqWZFSXjiwaw4yb6DaNgmRax56P2/",3:"https://zequencer.mypinata.cloud/ipfs/QmRYo8dbhz2RsoPHATi2FL81hXoziT2R6zzxHSRhQbHn3S/"},$=Object(g.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.tokenId;return u.a.createElement("iframe",{sandbox:"allow-scripts allow-same-origin",height:"600",width:"400","aria-describedby":"spore",alt:"spore.vision",src:Z[t],className:"zora-mediaObject css-hnzuw7 zora-mediaObject--mediaLoaded zora-mediaObject--isFullPage",style:{borderWidth:"0px"}})}),ee=(n(898),n(2365),Object(g.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=Object(c.useState)(void 0),n=Object(b.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)(!1),o=Object(b.a)(i,2),s=o[0],l=o[1],f=Object(c.useState)(!1),h=Object(b.a)(f,2),p=h[0],d=h[1],m=Object(c.useState)(!1),v=Object(b.a)(m,2),g=(v[0],v[1],Object(c.useState)()),y=Object(b.a)(g,2),O=(y[0],y[1],Object(c.useState)()),j=Object(b.a)(O,2),w=(j[0],j[1],Object(c.useRef)());Object(c.useEffect)(function(){d(!1)},[s,d]),Object(c.useEffect)(function(){return window.addEventListener("mousewheel",E,{passive:!1}),function(){return window.removeEventListener("mousewheel",E)}},[]);var E=function(e){return e.preventDefault()};Object(c.useEffect)(function(){document.getElementsByTagName("html")[0].setAttribute("class","bad-scroll"),document.title="Spores"},[]),Y(w);var S="spore";return s&&(S+=" showing-spore-player"),p&&(S+=" showing-spores"),u.a.createElement("div",{ref:w,className:S},u.a.createElement(k,{showStemPlayer:s||p,setShowStemPlayer:function(e){l(e),d(e)},playerChosen:r,setPlayerChosen:a}),r&&!s&&p&&u.a.createElement(W,{tokenId:r,setShowStemPlayer:l}),r&&!p&&(s?u.a.createElement($,{tokenId:r}):u.a.createElement(H,{tokenId:r,setShowStemPlayer:l})),r&&(p||s)&&u.a.createElement("div",{onClick:function(){l(!1),d(!1)},className:"spore-button pushable stem-player-button"},"See Latest Spore",u.a.createElement("img",{className:"spore-icon one-spore",src:"/one-spore.svg"})),r&&!p&&!s&&u.a.createElement("div",{onClick:function(){return d(!0)},className:"spore-button pushable stem-player-button"},"See All Spores ",u.a.createElement("img",{className:"spore-icon",src:"/spores-icon-glow2.svg"})))})),te=(n(196),n(1359),n(1072),n(2723)),ne=n(2724),re=n(2722),ae=(n(59),n(2371),n(1067),n(727)),ie=n(9),oe=n(148),se=n(22),ce=n(86),ue=(n(2373),["Wave Folder","Soft Clipper","Bit Crusher","Compressor","Saturator","Delay","Oscilloscope","Guitar Amp","Freak Shifter","Frequency Shifter","Effect Rack","EQ 8","Convolver Reverb","Filter","Panner","Transient Shaper"]),le=ce.a.filter(function(e){return!ue.includes(e.label)}),fe=Object(g.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=Object(c.useState)([]),r=Object(b.a)(n,2),a=r[0],i=r[1],o=Object(c.useState)(!1),s=Object(b.a)(o,2),l=s[0],f=s[1];Object(c.useEffect)(function(){var e=t.sequencerEngine.scripting;e.runScript("+Chorus"),e.runScript("+Convolver Reverb"),i(t.effects)},[i,t]);var h=Object(c.useCallback)(function(e){"Phaser"===e&&(e="Ultra Phaser");var n=t.effects[0].wetParameter.get();t.effectsChain.deleteEffect(a[0]),t.sequencerEngine.scripting.runScript("+"+e),f(!1),t.effectsChain.moveEffectTo(2,0),"Distortion"===e&&t.effects[0].distortionParameter.set(.8),t.effects[0].wetParameter.set(n),i(Object(ie.a)(t.effects))},[a,i,f]);Object(c.useEffect)(function(){return window.addEventListener("click",p),function(){return window.removeEventListener("click",p)}},[f]);var p=Object(c.useCallback)(function(){f(!1)},[f]);if(0===a.length)return"";var d=a[0].parameters.find(function(e){return e.name.includes("Rate")});return u.a.createElement("div",{className:"synthz-effects"},u.a.createElement("div",{className:"synthz-effect"},u.a.createElement("div",{onClick:function(e){e.stopPropagation(),f(!0)},className:"effect-name"},a[0].name,u.a.createElement("div",{className:"effects-chooser"},u.a.createElement("div",{className:"arrow-down"}),l&&u.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"effect-dropdown"},le.map(function(e){var t=e.label,n=e.value;return u.a.createElement("div",{onClick:function(){return h(n)},className:"effect-option"},t)})))),u.a.createElement(oe.a,{size:125,parameter:a[0].parameters.find(function(e){return"Wet"===e.name})}),d&&u.a.createElement(se.a,{name:"Rate",parameter:d,min:0,max:1,step:.01,sequencerEngine:t.sequencerEngine})),u.a.createElement("div",{className:"synthz-effect"},u.a.createElement("div",{className:"effect-name"},a[1].name),u.a.createElement(oe.a,{size:125,parameter:a[1].parameters[0]})))}),he=(n(1532),n(173)),pe=n(6),de=n(290),me=n(75),ve=n(1090),be=(n(272),n(730));function ge(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ke=Object(g.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=Object(c.useState)([]),n=Object(b.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)(void 0),o=Object(b.a)(i,2),s=o[0],l=o[1],f=Object(c.useState)(void 0),h=Object(b.a)(f,2),p=h[0],d=h[1],m=Object(c.useState)(void 0),v=Object(b.a)(m,2),g=v[0],y=v[1];return Object(c.useEffect)(function(){g&&F.a.getJson(g.packHash).then(d)},[g,d]),Object(c.useEffect)(function(){Object(be.a)().then(function(e){y(e.find(function(e){return"synthz"===e.title}))})},[y]),Object(c.useEffect)(function(){if(p){var e,t=[],n=[],r=ge(p.samples);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(!(g.matchingContent&&g.matchingContent.length>0)||g.matchingContent.includes(i)){var o=new me.a(i);n.push(o.load()),t.push(o)}}}catch(c){r.e(c)}finally{r.f()}if(Promise.all(n).then(function(e){return a(t)}),p.presets){var s=p.presets;g.matchingContent&&g.matchingContent.length>0&&(s=s.filter(function(e){return g.matchingContent.includes(e)})),Object(de.b)(s).then(l)}}},[p,g]),u.a.createElement("div",null,p&&s&&u.a.createElement(ve.a,{setSave:e.setSave,track:e.track,sequencerEngine:e.sequencerEngine,json:Object(R.a)({},p,g,{samples:r,presets:s})}))}),Oe=n(1070),je=n(653),we=n(337),Ee=n(1105),Se=n(437),Pe=n(1065),xe=n(1068),Te=n(740),Ce=(n(1552),n(2711),n(1536),n(1537),n(1538),n(1520),n(1521),n(1522),n(1553),n(899),n(1523),n(1524),n(1525),n(1526),n(1554),n(1539),n(1076),n(1517),n(1527),n(1083),n(1540),n(1085),n(1516),n(1528),n(1529),n(1541),Object(g.b)(function(e,t){return{presetSaved:e.presets.presetSaved}},function(e){return{setPresetSaved:function(t){return e(Object(pe.se)(t))},setSelectedZObject:function(t){return e(Object(pe.uf)(t))}}})(function(e){var t=Object(c.useState)(!0),n=Object(b.a)(t,2),r=n[0],a=n[1],i=e.sequencerEngine?[void 0,s,void 0]:Object(Pe.a)(e),o=Object(b.a)(i,3),s=(o[0],o[1]);o[2];e.sequencerEngine&&(s=e.sequencerEngine),window.synthz=!0;var l=Object(xe.a)({sequencerEngine:s}),f=(Object(b.a)(l,1)[0],Object(c.useState)(!1)),h=Object(b.a)(f,2),p=(h[0],h[1]),d=Object(c.useState)(void 0),m=Object(b.a)(d,2),v=m[0],g=m[1],y=function(e){var t=Object(c.useState)(),n=Object(b.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)(void 0),o=Object(b.a)(i,2),s=o[0],u=o[1],l=Object(c.useState)(void 0),f=Object(b.a)(l,2),h=f[0],p=f[1];return Object(c.useEffect)(function(){if(e){var t=e.addMultiSynthTrack();t.setVolume(-4),t.setIsEnabled(!0),a(t);var n=new Se.a(e);n.enable(),n.thresholdParameter.set(-9),e.channelMixer.masterChannel.effectsChain.addEffect(n),e.currentSubSequence.createZObject(0,0,"system5"),e.currentSubSequence.loadSubPatch("Oscilloscope Notes 2").then(function(e){u(e)})}},[e,a,u,p]),Object(c.useEffect)(function(){h&&(h.width=314,h.height=153,h.effect.sendMessage("size",[h.width,h.height]),e.dispatch(Object(pe.uf)(r)))},[h]),{track:r,oscilloscope:s,canvasBackground:h}}(s),k=y.track,O=y.canvasBackground,j=y.oscilloscope,w=Object(c.useCallback)(function(){k&&(e.setSelectedZObject(k),p(!0),Object(he.j)(k))},[k,p]);Object(c.useEffect)(function(){e.presetSaved&&v&&setTimeout(function(){v.fn(e.presetSaved),e.setPresetSaved(void 0)},2e3)},[e.presetSaved,v]),Object(c.useEffect)(function(){return window.addEventListener("keydown",E),function(){return window.removeEventListener("keydown",E)}},[s]);var E=Object(c.useCallback)(function(){s&&!s.playing&&s.schedulePlay()},[s]);return u.a.createElement("div",{onClick:E,className:"v3 synthz no-select dark"},u.a.createElement(Oe.a,{sequencerEngine:s,store:e.store}),u.a.createElement(je.a,{store:e.store}),s&&k&&u.a.createElement(ke,{setSave:g,track:k,sequencerEngine:s}),u.a.createElement("img",{className:"pushable save-preset-icon",onClick:function(){return w()},src:"/save-preset-floppy.svg"}),k&&u.a.createElement(Te.a,{sequencerEngine:s,track:k,instrument:k.instrument}),u.a.createElement("div",{className:"oscilloscope-wrapper"},j&&u.a.createElement(we.a,{forceShow:!0,zobject:j})),s&&u.a.createElement(ae.a,{sequencerEngine:s}),u.a.createElement("div",{className:"canvas-wrapper"},O&&u.a.createElement(we.a,{zobject:O})),k&&u.a.createElement(fe,{track:k}),u.a.createElement("div",{className:"editor-and-sidebars"},u.a.createElement("div",{className:r?"right sidebar collapsed":"right sidebar Audition"},u.a.createElement("div",{className:"collapse-header"},u.a.createElement("div",{onClick:function(){return a(!r)},className:"pushable arrow-container"},u.a.createElement("div",{className:r?"collapsed-arrow":"uncollapsed-arrow"}))),!r&&k&&u.a.createElement(Ee.a,{object:k,sequencerEngine:s}))))}));function Ne(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(v.a)(e);if(t){var a=Object(v.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}var Re=u.a.lazy(function(){return n.e(20).then(n.bind(null,2896))}),Me=u.a.lazy(function(){return n.e(19).then(n.bind(null,2886))}),Ae=u.a.lazy(function(){return n.e(22).then(n.bind(null,2899))}),qe=u.a.lazy(function(){return n.e(23).then(n.bind(null,2897))}),De=u.a.lazy(function(){return n.e(12).then(n.bind(null,2898))}),Ie=(u.a.lazy(function(){return n.e(16).then(n.bind(null,2900))}),u.a.lazy(function(){return n.e(15).then(n.bind(null,2901))})),_e=u.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7)]).then(n.bind(null,2889))}),Fe=u.a.lazy(function(){return n.e(17).then(n.bind(null,2893))}),Le=u.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(8)]).then(n.bind(null,2892))}),Be=u.a.lazy(function(){return n.e(18).then(n.bind(null,2895))}),ze=(u.a.lazy(function(){return n.e(24).then(n.bind(null,2887))}),u.a.lazy(function(){return n.e(14).then(n.bind(null,2888))})),Ve=u.a.lazy(function(){return Promise.all([n.e(10),n.e(11)]).then(n.bind(null,2894))}),He=u.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3)]).then(n.bind(null,2885))}),Ue=u.a.lazy(function(){return n.e(13).then(n.bind(null,2891))}),Je=u.a.lazy(function(){return Promise.all([n.e(1),n.e(21)]).then(n.bind(null,2808))}),Ge=u.a.lazy(function(){return Promise.all([n.e(0),n.e(9)]).then(n.bind(null,2890))}),We=function(e){Object(d.a)(n,e);var t=Ne(n);function n(e){return Object(h.a)(this,n),t.call(this,e)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return window.isNFT?u.a.createElement(c.Suspense,{fallback:function(){return u.a.createElement("div",null,"Loading...")}},u.a.createElement(re.a,null,u.a.createElement(te.a,null,u.a.createElement(ne.a,{path:"/",render:function(t){return u.a.createElement(Je,Object.assign({},t,{store:e.props.store}))}})))):(window.spores=!0,window.spores?u.a.createElement(c.Suspense,{fallback:function(){return u.a.createElement("div",null,"Loading...")}},u.a.createElement(re.a,null,u.a.createElement(ne.a,{path:"/",render:function(t){return u.a.createElement(ee,Object.assign({},t,{store:e.props.store}))}}))):u.a.createElement(c.Suspense,{fallback:function(){return u.a.createElement("div",null,"Loading...")}},u.a.createElement(re.a,null,u.a.createElement(te.a,null,u.a.createElement(ne.a,{path:"/nftviewer/:sequenceId",render:function(t){return u.a.createElement(Je,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/screenshot/:sequenceId",render:function(t){return u.a.createElement(Je,Object.assign({},t,{screenshot:!0,store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/user/:userId",render:function(t){return u.a.createElement(Le,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/user/",render:function(t){return u.a.createElement(Le,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/exhibit/:sequenceId",render:function(t){return u.a.createElement(Ie,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/exhibit/",render:function(t){return u.a.createElement(Ie,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/explore/:sequenceId",render:function(t){return u.a.createElement(Ge,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/explore/",render:function(t){return u.a.createElement(Ge,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/contour/",render:function(t){return u.a.createElement(Me,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/spore/",render:function(t){return u.a.createElement(ee,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/nft/",render:function(t){return u.a.createElement(Re,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/exportfull/:sequenceId",render:function(t){return u.a.createElement(qe,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/guilds/",render:function(t){return u.a.createElement(Fe,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/tags/",render:function(t){return u.a.createElement(Be,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/synthz/",render:function(t){return u.a.createElement(Ce,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/v3/:sequenceId",render:function(t){return u.a.createElement(He,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/collect/:userName",render:function(t){return u.a.createElement(Ue,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/collect/",render:function(t){return u.a.createElement(Ue,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/v3/",render:function(t){return u.a.createElement(He,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/download/",render:function(t){return u.a.createElement(Ae,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/upload/",render:function(t){return u.a.createElement(ze,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/uploader/",render:function(t){return u.a.createElement(De,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/discover/",render:function(t){return u.a.createElement(Ve,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/",render:function(t){return u.a.createElement(_e,Object.assign({},t,{store:e.props.store}))}}),u.a.createElement(ne.a,{path:"/documentation",render:function(t){return u.a.createElement(_e,Object.assign({},t,{showDocumentation:!0,store:e.props.store}))}})))))}}]),n}(c.Component);var Ke=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Xe(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Qe=n(546),Ye=n(3),Ze=n(278),$e=n(168),et=n(326),tt=n(33),nt=n(79),rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{viewMode:nt.b,showPianoRoll:!1,alternateViewMode:nt.a,enableRollViewer:!0,decentralized:!0,waveformShowing:!1,masterVolumes:{},showSelectorMode:!1,resolution:new tt.a(16,!1),displayResolution:new tt.a(16,!1),numberOfPatterns:{},currentPattern:{},currentStep:{},currentGlobalStep:{},isPlaying:{},samplePack:void 0,sampleDownloadProgress:void 0,sampleDragging:void 0,effectDragging:void 0,patternDragging:void 0,completelyDoneLoading:!0,tracksRecording:{},tracksPreparingToRecord:{},trackSteps:{},theme:"dark",quantized:!0,isRecording:!1,showThemeGrid:!0,isRecordingExpanded:!1,sequenceName:void 0,trackFocused:void 0,showSettings:!1,loadingSequence:{},isCompactMode:!1,showEnvelopes:!1,showLFOs:!1,selectedLFO:1,selectedEnvelope:1,automationMode:Ze.a,showSequenceModal:!1,showModsModal:!1,sequenceRolling:!1,trackRolling:!1,showInstruments:!1,showSequences:!1,showPresets:!1,zIndexHack:!1,resampleMaster:!1,audioInputSource:void 0,latency:0,patternLocks:{},clockType:$e.b,showConvolverModal:!1,convolverSample:void 0,showLogin:!1,signingUp:!1,userToken:void 0,showPasswordModal:!1,passwordModalCallback:void 0,contextualHelp:void 0,showGroups:!1,currentSubSequence:{},subSequences:{},sidebarViewMode:et.g,sequenceLoadingProgress:{},isTranscribing:!1,scenes:[],backgroundColor:"#e4e4e4"},t=arguments.length>1?arguments[1]:void 0;window.logRedux&&console.log("REDUX CALL ACTION=",t.type,t.payload);var n={},r={};switch(t.type){case Ye.rc:return Object(R.a)({},e,{enableRollViewer:t.payload});case Ye.ib:return Object(R.a)({},e,{backgroundColor:t.payload});case Ye.q:return Object(R.a)({},e,{isPlaying:{}});case Ye.gf:return Object(R.a)({},e,{resolution:t.payload});case Ye.Zb:return Object(R.a)({},e,{displayResolution:t.payload});case Ye.mf:return Object(R.a)({},e,{sampleDownloadProgress:t.payload});case Ye.Ab:return Object(R.a)({},e,{completelyDoneLoading:t.payload});case Ye.lg:return Object(R.a)({},e,{sequencerEngine:t.payload});case Ye.Ni:return t.payload===nt.e?n=Object(R.a)({},e,{viewMode:t.payload,showSelectorMode:!1,sidebarViewMode:et.g}):(n=Object(R.a)({},e,{viewMode:t.payload}),t.payload!==nt.b&&t.payload!==nt.a||(n.alternateViewMode=t.payload)),n;case Ye.gh:return Object(R.a)({},e,{showThemeGrid:t.payload});case Ye.Xb:return Object(R.a)({},e,{viewMode:t.payload});case Ye.md:return Object(R.a)({},e,{isTranscribing:t.payload});case Ye.Lg:return Object(R.a)({},e,{showLogin:t.payload});case Ye.Ci:return void 0===t.payload.userName?Object(R.a)({},e,{userToken:void 0}):Object(R.a)({},e,{userToken:t.payload});case Ye.Lh:return Object(R.a)({},e,{theme:t.payload});case Ye.qh:return Object(R.a)({},e,{signingUp:t.payload});case Ye.ng:var a=Object(R.a)({},e.sequenceLoadingProgress);return a[t.payload.sequenceId]=t.payload.progress,Object(R.a)({},e,{sequenceLoadingProgress:a});case Ye.Wb:return Object(R.a)({},e,{decentralized:t.payload});case Ye.hg:return Object(R.a)({},e,{showSelectorMode:t.payload});case Ye.Lb:return(n=Object(R.a)({},e)).currentPattern[t.payload.sequenceId]=t.payload.currentPattern,n;case Ye.Yd:var i=e.numberOfPatterns;return i[t.payload.id]=t.payload.numberOfPatterns,Object(R.a)({},e,{numberOfPatterns:i});case Ye.Hb:return(n=Object(R.a)({},e)).currentStep[t.payload.sequenceId]=t.payload.currentStep,n.currentGlobalStep[t.payload.sequenceId]=t.payload.currentGlobalStep,n;case Ye.Ob:return(n=Object(R.a)({},e)).currentStep[t.payload.sequenceId]=t.payload.currentStep,n;case Ye.Jb:return(n=Object(R.a)({},e)).currentGlobalStep[t.payload.sequenceId]=t.payload.currentGlobalStep,n;case Ye.pf:return Object(R.a)({},e,{samplePack:t.payload});case Ye.k:return Object(R.a)({},e,{sampleDragging:t.payload});case Ye.b:return Object(R.a)({},e,{effectDragging:void 0});case Ye.i:return Object(R.a)({},e,{effectDragging:t.payload});case Ye.j:return Object(R.a)({},e,{patternDragging:t.payload});case Ye.rj:return(n=Object(R.a)({},e)).tracksRecording[t.payload.id]=t.payload.recording,n.tracksPreparingToRecord[t.payload.trackNumber]=!1,n;case Ye.qj:return(n=Object(R.a)({},e)).tracksRecording[t.payload.trackNumber]=!1,n.tracksPreparingToRecord[t.payload.trackNumber]=t.payload.preparing,n;case Ye.af:return Object(R.a)({},e,{quantized:t.payload});case Ye.id:return Object(R.a)({},e,{isRecording:t.payload});case Ye.jd:return Object(R.a)({},e,{isRecordingExpanded:t.payload});case Ye.fd:var o=Object(R.a)({},e.isPlaying);return o[t.payload.sequenceId]=t.payload.isPlaying,n=Object(R.a)({},e,{isPlaying:o,isMainPlaying:t.payload.isPlaying});case Ye.Ed:return(n=Object(R.a)({},e)).masterVolumes[t.payload.sequenceId]=t.payload.volume,n;case Ye.og:return Object(R.a)({},e,{sequenceName:t.payload});case Ye.ud:return Object(R.a)({},e,{latency:t.payload});case Ye.bi:return Object(R.a)({},e,{trackFocused:t.payload});case Ye.zb:return Object(R.a)({},e,{isCompactMode:t.payload});case Ye.Kg:return Object(R.a)({},e,{showLFOs:t.payload,showEnvelopes:!1});case Ye.Lf:return Object(R.a)({},e,{selectedLFO:t.payload});case Ye.Df:return Object(R.a)({},e,{selectedEnvelope:t.payload});case Ye.Dg:return Object(R.a)({},e,{showEnvelopes:t.payload,showLFOs:!1});case Ye.wb:return Object(R.a)({},e,{clockType:t.payload});case Ye.ah:return Object(R.a)({},e,{showSequenceModal:t.payload});case Ye.Db:return Object(R.a)({},e,{contextualHelp:void 0===t.payload.element?void 0:t.payload});case Ye.Mg:return Object(R.a)({},e,{showModsModal:t.payload});case Ye.zd:n=Object(R.a)({},e);var s=t.payload.loading,c=Object(R.a)({},n.loadingSequence);return c[t.payload.id]=s,n.loadingSequence=c,n;case Ye.We:return Object(R.a)({},e,{automationMode:t.payload});case Ye.rg:return Object(R.a)({},e,{sequenceRolling:t.payload});case Ye.oi:return Object(R.a)({},e,{trackRolling:t.payload});case Ye.Zg:return Object(R.a)({},e,{showSequences:t.payload});case Ye.Jg:return Object(R.a)({},e,{showInstruments:t.payload});case Ye.Ug:return Object(R.a)({},e,{showPresets:t.payload});case Ye.nj:return Object(R.a)({},e,{zIndexHack:t.payload});case Ye.ff:return Object(R.a)({},e,{resampleMaster:t.payload});case Ye.ab:return Object(R.a)({},e,{audioInputSource:t.payload});case Ye.pg:return r=Object(R.a)({},e.patternLocks),!t.payload.subSequence in r&&(r[t.payload.subSequence]={}),r[t.payload.subSequence][t.payload.patternNumber]=t.payload.locked,Object(R.a)({},e,{patternLocks:r});case Ye.qg:return r=Object(R.a)({},e.patternLocks),!t.payload.subSequence in t.payload.patternLocks&&(r[t.payload.subSequence]={}),r[t.payload.subSequence]=t.payload.patternLocks,Object(R.a)({},e,{patternLocks:r});case Ye.Qg:return Object(R.a)({},e,{showPasswordModal:t.payload});case Ye.we:return Object(R.a)({},e,{passwordModalCallback:t.payload});case Ye.zg:return Object(R.a)({},e,{showConvolverModal:t.payload.show,convolverSample:t.payload.convolverSample});case Ye.Hg:return Object(R.a)({},e,{showGroups:t.payload});case Ye.Rg:return Object(R.a)({},e,{showPianoRoll:t.payload});case Ye.Gh:var u=e.subSequences;return u[t.payload.sequenceId]=t.payload.ids,Object(R.a)({},e,{subSequences:u});case Ye.Pb:var l=e.currentSubSequence;return l[t.payload.sequenceId]=t.payload.subSequenceId,Object(R.a)({},e,{currentSubSequence:l});case Ye.ph:return Object(R.a)({},e,{sidebarViewMode:t.payload});case Ye.Ai:return Object(R.a)({},e,{uploadingFile:t.payload});case Ye.Ad:return Object(R.a)({},e,{loadingText:t.payload});case Ye.uf:return Object(R.a)({},e,{scenes:t.payload});case Ye.Mb:return Object(R.a)({},e,{currentScene:t.payload});case Ye.bh:return Object(R.a)({},e,{showSettings:t.payload});case Ye.Pi:return Object(R.a)({},e,{wallpaper:t.payload});case Ye.E:return Object(R.a)({},e,{animateWallpaper:t.payload});case Ye.Si:return Object(R.a)({},e,{waveformShowing:t.payload});default:return e}},at={subSection:void 0},it=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:at,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.ac:return Object(R.a)({},e,{subSection:t.payload});default:return e}},ot={editorPadding:{x:1,y:1},edgesPadding:{x:0,y:0},edgesSize:{width:1200,height:1200},position:{x:0,y:0},sidebarsShowing:!0,showPadSequencer:void 0,showProjectsModal:void 0,showSearchWindow:!1,cableSegmentations:{},lockedObjects:{},hiddenObjects:{},showEditorBottom:!1,leftSidebarWidth:50,presentationMode:!1},st={mintedTokens:[],hicDialog:void 0,zoraDialog:void 0,mintingProgress:void 0,newZoraTokenId:void 0},ct={zobjectsStack:[],tooltip:{},contextMenu:{},zobjectsFlashing:{},objectDragging:void 0,zobjectTypeDragging:void 0,zobjects:{},zmessages:{},viewableSubPatches:[],viewableZObjects:[],selectedZObject:void 0,jakiGrids:{},uxLocked:!1,fullScreenZObject:void 0,objectStylings:{},zobjectSizes:{},zobjectBackground:void 0},ut={show:!1,matrix:new Array(16).fill(new Array(10).fill(0)),colors:{},inputModules:[],outputModules:[],orientationRoutings:{},selectedSteps:void 0},lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Ig:return Object(R.a)({},e,{show:t.payload});case Ye.de:return Object(R.a)({},e,{orientationRoutings:t.payload});case Ye.Yc:return Object(R.a)({},e,{selectedSteps:t.payload});case Ye.Qd:return Object(R.a)({},e,{inputModules:t.payload.inputModules,outputModules:t.payload.outputModules});case Ye.Xc:return Object(R.a)({},e,{matrix:t.payload});case Ye.Sd:var n=Object(R.a)({},e.colors);return n[t.payload.id]=t.payload.color,Object(R.a)({},e,{colors:n});default:return e}},ft={actionsRemaining:200,timeRemaining:0},ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.v:return Object(R.a)({},e,{actionsRemaining:t.payload});case Ye.Mh:return Object(R.a)({},e,{timeRemaining:t.payload});default:return e}},pt={parameterTypeEditing:void 0,cirklonParameterSelected:{},stepParameterSelected:void 0,cirklonMode:{}},dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.n:return Object(R.a)({},e,{cirklonParameterSelected:{}});case Ye.Dh:return Object(R.a)({},e,{stepParameterSelected:t.payload});case Ye.ub:var n=Object(R.a)({},e.cirklonParameterSelected);return n[t.payload.track]=t.payload.parameter,Object(R.a)({},e,{cirklonParameterSelected:n});case Ye.tb:var r=Object(R.a)({},e.cirklonMode);return r[t.payload.track]=t.payload.mode,Object(R.a)({},e,{cirklonMode:r});default:return e}},mt=n(28),vt=Object(mt.a)({selectedTrackSlice:{},tracksToHide:[],selectedMidiTrack:0,triggers:{},trackSteps:{},trackToConvert:void 0,trackLengthMode:!1,trackStepGroups:{},trackLengthChoice:0,trackStepIds:{},selectedRackSubTrack:{},trackFills:{},tracksFrozen:{},frozenTracksPlaying:{},trackPatternSteps:{},trackPianoRollSteps:{},trackPianoRollDurations:{},trackVolumes:{},trackPannings:{},trackMutes:{},trackSolos:{},groupVolumes:{},groupPannings:{},trackEnvelopes:{},groupMutes:{},trackWarps:{},trackPianoRollPositions:{},sendMutes:{},trackSendVolumes:{},trackIsEnabled:{},selectedSampleTags:{},tracksToResample:[],trackToFreeze:void 0,trackPatternLocks:{},trackEffectsChain:{},showTrackEffects:{},showTrackFreezeHistory:{},lfoPatternLocks:{},envelopePatternLocks:{},isResampling:!1,resampleDuration:1,sampleSlices:{},trackIsLoading:{},annotationDragging:void 0,allSteps:{},trackBrowsedSamples:{},trackBrowsedPresets:{},groupTracks:{}},"trackEnvelopes",{}),bt=function(e){var t={},n={},r={},a=e.trackPianoRollSteps,i=e.trackPianoRollDurations,o=e.trackPianoRollPositions;for(var s in a){var c=a[s];for(var u in c){var l=c[u],f=i[s][u],h=o[s][u];for(var p in void 0===t[u]&&(t[u]={},n[u]={},r[u]={}),l)l[p]&&(t[u][p]=parseInt(s)),r[u][p]=h[p],n[u][p]=f[p]}}return{allSteps:t,allPositions:r,allDurations:n}},gt=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vt,n=arguments.length>1?arguments[1]:void 0,r=void 0,a=void 0;switch(n.type){case Ye.q:return vt;case Ye.h:e=Object(R.a)({},t);var i=n.payload;return delete e.trackSteps[i],delete e.trackFills[i],delete e.trackStepIds[i],delete e.trackPatternSteps[i],delete e.trackPianoRollSteps[i],delete e.trackPianoRollPositions[i],delete e.trackPianoRollDurations[i],delete e.trackMutes[i],e;case Ye.b:return Object(R.a)({},t,{trackDragging:void 0});case Ye.Xh:return console.log("SET TRACK DRAGGING",n.payload),Object(R.a)({},t,{trackDragging:n.payload});case Ye.oj:return void 0===(e=Object(R.a)({},t)).triggers[n.payload.trackNumber]&&(e.triggers[n.payload.trackNumber]={}),e.triggers[n.payload.trackNumber][n.payload.sliceNumber]=!0,e;case Ye.pj:return void 0===(e=Object(R.a)({},t)).triggers[n.payload.trackNumber]&&(e.triggers[n.payload.trackNumber]={}),e.triggers[n.payload.trackNumber][n.payload.sliceNumber]=!1,e;case Ye.C:return(e=Object(R.a)({},t)).trackSteps[n.payload.id]=n.payload.steps,e.trackPatternSteps[n.payload.id]=n.payload.patternSteps,e.trackFills[n.payload.id]=n.payload.fills,e.trackStepIds[n.payload.id]=n.payload.stepToId,e.trackStepGroups[n.payload.id]=n.payload.groups,n.payload.pianoRollSteps&&(e.trackPianoRollSteps[n.payload.id]=n.payload.pianoRollSteps),e.trackPianoRollPositions[n.payload.id]=n.payload.stepToPosition,e.trackPianoRollDurations[n.payload.id]=n.payload.pianoRollDurations,Object(R.a)({},e,bt(e));case Ye.sj:for(var o in e=Object(R.a)({},t),n.payload){var s=n.payload[o];e.trackSteps[s.id]=s.steps,e.trackFills[s.id]=s.trackFills,e.trackStepIds[s.id]=s.stepToId,e.trackPatternSteps[s.id]=s.trackPatternSteps,void 0!==s.pianoRollSteps&&(e.trackPianoRollSteps[s.id]=s.pianoRollSteps),e.trackPianoRollPositions[s.id]=s.pianoRollPositions,e.trackPianoRollDurations[s.id]=s.pianoRollDurations,e.trackMutes[s.id]=s.muted}return Object(R.a)({},e,bt(e));case Ye.ri:return(e=Object(R.a)({},t)).trackSteps[n.payload.id]=n.payload.steps,e;case Ye.ai:return(e=Object(R.a)({},t)).trackFills[n.payload.id]=n.payload.fills,e;case Ye.Mf:return Object(R.a)({},t,{selectedMidiTrack:n.payload});case Ye.mi:return(e=Object(R.a)({},t)).trackPianoRollSteps[n.payload.id]=n.payload.steps,Object(R.a)({},e,bt(e));case Ye.ii:return(e=Object(R.a)({},t)).trackMutes[n.payload.id]=n.payload.muted,e;case Ye.qi:return(e=Object(R.a)({},t)).trackSolos[n.payload.id]=n.payload.solo,e;case Ye.fg:return(e=Object(R.a)({},t)).selectedTrackSlice[n.payload.track]=n.payload.slice,e;case Ye.vi:return(e=Object(R.a)({},t)).trackVolumes[n.payload.id]=n.payload.volume,e;case Ye.ji:return(e=Object(R.a)({},t)).trackPannings[n.payload.id]=n.payload.pan,e;case Ye.ui:for(var c in e=Object(R.a)({},t),n.payload)e.trackPannings[c]=n.payload[c].panning,e.trackVolumes[c]=n.payload[c].volume,e.trackMutes[c]=n.payload[c].mute;return e;case Ye.Rc:return(e=Object(R.a)({},t)).groupVolumes[n.payload.groupNumber]=n.payload.volume,e;case Ye.Oc:return(e=Object(R.a)({},t)).groupPannings[n.payload.groupNumber]=n.payload.pan,e;case Ye.Nc:return(e=Object(R.a)({},t)).groupMutes[n.payload.groupNumber]=n.payload.muted,e;case Ye.ig:return(e=Object(R.a)({},t)).sendMutes[n.payload.sendNumber]=n.payload.muted,e;case Ye.pi:return void 0===(r=(e=Object(R.a)({},t)).trackSendVolumes[n.payload.trackVolume])&&(r={}),r[n.payload.sendNumber]=n.payload.volume,e.trackSendVolumes[n.payload.trackVolume]=r,e;case Ye.di:var u=(e=Object(R.a)({},t)).trackIsEnabled[n.payload.subSequenceId]||{};return u[n.payload.trackNumber]=n.payload.isEnabled,e.trackIsEnabled[n.payload.subSequenceId]=u,e;case Ye.wi:var l=(e=Object(R.a)({},t)).trackWarps[n.payload.subSequenceId]||{};return l[n.payload.trackNumber]=n.payload.warp,e.trackWarps[n.payload.subSequenceId]=l,e;case Ye.Jh:return(e=Object(R.a)({},t)).trackWarps[n.payload.subSequenceId]=n.payload.warps,e;case Ye.Zf:return(e=Object(R.a)({},t)).selectedSampleTags[n.payload.sampleId]=n.payload.tag,e;case Ye.B:return Object(R.a)({},t,{trackPatternLocks:n.payload});case Ye.A:return Object(R.a)({},t,{lfoPatternLocks:n.payload});case Ye.z:return Object(R.a)({},t,{envelopePatternLocks:n.payload});case Ye.ti:return Object(R.a)({},t,{trackToFreeze:n.payload});case Ye.ki:return void 0===(e=Object(R.a)({},t)).trackPatternLocks[n.payload.subSequence]&&(e.trackPatternLocks[n.payload.subSequence]={}),(r=e.trackPatternLocks[n.payload.subSequence][n.payload.trackNumber]||{})[n.payload.patternNumber]=n.payload.locked,e.trackPatternLocks[n.payload.subSequence][n.payload.trackNumber]=r,e;case Ye.li:return void 0===(e=Object(R.a)({},t)).trackPatternLocks[n.payload.subSequence]&&(e.trackPatternLocks[n.payload.subSequence]={}),e.trackPatternLocks[n.payload.subSequence][n.payload.trackNumber]=n.payload.patternLocks,e;case Ye.Qh:return Object(R.a)({},t,{tracksToResample:n.payload});case Ye.sc:return(e=Object(R.a)({},t)).envelopePatternLocks[n.payload.subSequence]=n.payload.patternLocks,e;case Ye.wd:return(e=Object(R.a)({},t)).lfoPatternLocks[n.payload.subSequence]=n.payload.patternLocks,e;case Ye.ld:return Object(R.a)({},t,{isResampling:n.payload});case Ye.ef:return Object(R.a)({},t,{resampleDuration:n.payload});case Ye.Yh:return(e=Object(R.a)({},t)).trackEffectsChain[n.payload.trackNumber]=n.payload.effectsChain,e;case Ye.qf:return(e=Object(R.a)({},t)).sampleSlices[n.payload.id]=n.payload.slices,e;case Ye.hh:return(e=Object(R.a)({},t)).showTrackEffects[n.payload.trackNumber]=n.payload.show,e;case Ye.ih:return(e=Object(R.a)({},t)).showTrackFreezeHistory[n.payload.id]=n.payload.show,e;case Ye.n:for(var f in(e=Object(R.a)({},t)).showTrackEffects)e.showTrackEffects[f]=!1;return e;case Ye.ci:return(a=(e=Object(R.a)({},t)).tracksFrozen[n.payload.subSequenceId]||{})[n.payload.trackNumber]=n.payload.frozen,e.tracksFrozen[n.payload.subSequenceId]=a,e;case Ye.ei:return(a=(e=Object(R.a)({},t)).trackIsLoading[n.payload.subSequenceId]||{})[n.payload.trackNumber]=n.payload.isLoading,e.trackIsLoading[n.payload.subSequenceId]=a,e;case Ye.Kc:return(a=(e=Object(R.a)({},t)).frozenTracksPlaying[n.payload.subSequenceId]||{})[n.payload.trackNumber]=n.payload.playing,e.frozenTracksPlaying[n.payload.subSequenceId]=a,e;case Ye.Ic:return(e=Object(R.a)({},t)).tracksFrozen[n.payload.subSequenceId]=n.payload.frozenTracks,e;case Ye.Jc:return(e=Object(R.a)({},t)).frozenTracksPlaying[n.payload.subSequenceId]=n.payload.frozenTracksPlaying,e;case Ye.oe:return(e=Object(R.a)({},t)).parametersToRecord=n.payload,e;case Ye.G:return Object(R.a)({},t,{annotationDragging:n.payload});case Ye.Wh:var h=Object(R.a)({},t.trackBrowsedSamples);return h[n.payload.trackId]=n.payload.samples,Object(R.a)({},t,{trackBrowsedSamples:h});case Ye.Vh:var p=Object(R.a)({},t.trackBrowsedPresets);return p[n.payload.trackId]=n.payload.presets,Object(R.a)({},t,{trackBrowsedPresets:p});case Ye.si:return Object(R.a)({},t,{trackToConvert:n.payload});case Ye.Ph:return Object(R.a)({},t,{tracksToHide:n.payload});case Ye.Xf:var d=Object(R.a)({},t.selectedRackSubTrack);return d[n.payload.trackId]=n.payload.track,Object(R.a)({},t,{selectedRackSubTrack:d});case Ye.gi:return Object(R.a)({},t,{trackLengthMode:n.payload});case Ye.fi:return Object(R.a)({},t,{trackLengthChoice:n.payload});case Ye.Qc:var m=t.groupTracks;return m[n.payload.groupId]=n.payload.tracks,Object(R.a)({},t,{groupTracks:m});case Ye.Zh:var v=Object(R.a)({},t.trackEnvelopes);return v[n.payload.id]=n.payload.envelopes,Object(R.a)({},t,{trackEnvelopes:v});default:return t}},yt={showFreezeModal:!1,selectedFreeze:void 0,offlineEngine:void 0,freezeDragging:void 0,freezeColumnSamples:{},currentExportInfo:void 0,loops:1},kt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Ib:return Object(R.a)({},e,{currentExportInfo:t.payload});case Ye.Gg:return Object(R.a)({},e,{showFreezeModal:t.payload});case Ye.Gc:var n=Object(R.a)({},e.freezeColumnSamples[t.payload.trackId]);n[t.payload.column]=t.payload.samples;var r=Object(R.a)({},e.freezeColumnSamples);return r[t.payload.trackId]=n,Object(R.a)({},e,{freezeColumnSamples:r});case Ye.Bd:return Object(R.a)({},e,{loops:t.payload});case Ye.If:return Object(R.a)({},e,{selectedFreeze:t.payload});case Ye.Hc:return Object(R.a)({},e,{freezeDragging:t.payload});case Ye.be:return Object(R.a)({},e,{offlineEngine:t.payload});default:return e}},Ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{recentlyAddedSounds:[],samplesToSave:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.dc:return Object(R.a)({},e,{droppedSamples:t.payload});case Ye.cf:return Object(R.a)({},e,{recentlyAddedSounds:t.payload});case Ye.q:return{};case Ye.if:var n=Object.assign({},e);return n[t.payload.sampleId]=t.payload.sample,n;case Ye.kf:return Object(R.a)({},e,{samplesToSave:t.payload});default:return e}},jt={guidePoint:{},pointHovered:{},parameterSliderDown:[],pointHasMoved:{},pointsSelected:{},pointDragging:{},selection:{},parameterAutomations:{},automationSchedulers:{},parameterMixAutomations:{},automationMixSchedulers:{},trackDevice:{},trackSubDevice:{},trackRackDevice:{},trackParameter:{},show:!1},wt=function(){var e,t,n,r,a,i,o,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jt,c=arguments.length>1?arguments[1]:void 0;switch(c.type){case Ye.Rh:var u=Object(R.a)({},s.trackDevice);return u[c.payload.trackId]=c.payload.device,(t=Object(R.a)({},s.trackParameter))[c.payload.trackId]=void 0,Object(R.a)({},s,{trackDevice:u,trackParameter:t});case Ye.Th:var l=Object(R.a)({},s.trackRackDevice);return l[c.payload.trackId]=c.payload.device,Object(R.a)({},s,{trackRackDevice:l});case Ye.d:return r=Object(R.a)({},s.parameterAutomations),a=Object(R.a)({},s.automationSchedulers),delete r[c.payload],delete a[c.payload],Object(R.a)({},s,{parameterAutomations:r,automationSchedulers:a});case Ye.e:return 0===c.payload.length?s:(n=c.payload[0].sequencerEngine.sequenceId,r=s.parameterAutomations[n]||{},a=s.automationSchedulers[n]||{},c.payload.forEach(function(e){delete r[e.id],delete a[e.id]}),(e=Object(R.a)({},s)).parameterAutomations[n]=r,e.automationSchedulers[n]=a,e);case Ye.Uh:var f=Object(R.a)({},s.trackSubDevice);return f[c.payload.trackId]=c.payload.subDevice,(t=Object(R.a)({},s.trackParameter))[c.payload.trackId]=void 0,Object(R.a)({},s,{trackSubDevice:f,trackParameter:t});case Ye.Sh:return(t=Object(R.a)({},s.trackParameter))[c.payload.trackId]=c.payload.parameter,Object(R.a)({},s,{trackParameter:t});case Ye.xg:return Object(R.a)({},s,{show:c.payload.show});case Ye.ue:return Object(R.a)({},s,{parameterSliderDown:void 0===c.payload?[]:Array.isArray(c.payload)?c.payload:[c.payload]});case Ye.p:return r=Object(R.a)({},s.parameterAutomations),a=Object(R.a)({},s.automationSchedulers),o=Object(R.a)({},s.automationMixSchedulers),i=Object(R.a)({},s.parameterMixAutomations),r[c.payload.newId]=r[c.payload.oldId],a[c.payload.newId]=a[c.payload.oldId],i[c.payload.newId]=i[c.payload.oldId],o[c.payload.newId]=o[c.payload.oldId],delete r[c.payload.oldId],delete a[c.payload.oldId],delete o[c.payload.oldId],delete i[c.payload.oldId],Object(R.a)({},s,{automationSchedulers:a,parameterAutomations:r,automationMixSchedulers:o,parameterMixAutomations:i});case Ye.pe:n=c.payload.parameter.sequencerEngine?c.payload.parameter.sequencerEngine.sequenceId:0;var h=Object(R.a)({},s.parameterAutomations),p=Object(R.a)({},s.automationSchedulers),d=s.automationSchedulers[n]||{},m=s.parameterAutomations[n]||{};return d[c.payload.parameter.id]=c.payload.scheduler,m[c.payload.parameter.id]=c.payload.automations,h[n]=m,p[n]=d,Object(R.a)({},s,{parameterAutomations:h,automationSchedulers:p});case Ye.te:n=c.payload.parameter.sequencerEngine?c.payload.parameter.sequencerEngine.sequenceId:0;var v=Object(R.a)({},s.parameterMixAutomations),b=Object(R.a)({},s.automationMixSchedulers),g=s.automationMixSchedulers[n]||{},y=s.parameterMixAutomations[n]||{};return g[c.payload.parameter.id]=c.payload.scheduler,y[c.payload.parameter.id]=c.payload.automations,v[n]=y,b[n]=g,Object(R.a)({},s,{parameterMixAutomations:v,automationMixSchedulers:b});case Ye.bb:var k=Object(R.a)({},s.guidePoint);return k[c.payload.id]=c.payload.guidePoint,Object(R.a)({},s,{guidePoint:k});case Ye.db:var O=Object(R.a)({},s.pointDragging);return O[c.payload.id]=c.payload.point,Object(R.a)({},s,{pointDragging:O});case Ye.eb:var j=Object(R.a)({},s.pointHasMoved);return j[c.payload.id]=c.payload.hasMoved,Object(R.a)({},s,{pointHasMoved:j});case Ye.fb:var w=Object(R.a)({},s.pointHovered);return w[c.payload.id]=c.payload.pt,Object(R.a)({},s,{pointHovered:w});case Ye.cb:var E=Object(R.a)({},s.pointsSelected);return E[c.payload.id]=c.payload.points,Object(R.a)({},s,{pointsSelected:E});case Ye.gb:var S=Object(R.a)({},s.selection);return S[c.payload.id]=c.payload.selection,Object(R.a)({},s,{selection:S});default:return s}},Et={track:0,step:0,show:!1},St=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Ub:return Object(R.a)({},e,{track:t.payload});case Ye.Tb:return Object(R.a)({},e,{step:t.payload});case Ye.Sb:return Object(R.a)({},e,{show:t.payload});default:return e}},Pt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.b:return Object(R.a)({},e,{pullablePartDragging:void 0});case Ye.Fg:return Object(R.a)({},e,{showFormantPresets:t.payload});case Ye.Ef:return Object(R.a)({},e,{selectedFMEnvelopeType:t.payload});case Ye.Gf:return Object(R.a)({},e,{selectedFMOperatorDetails:t.payload});case Ye.Ff:return Object(R.a)({},e,{selectedFMFormant:t.payload});case Ye.Ye:return Object(R.a)({},e,{pullablePartDragging:t.payload});case Ye.bd:return Object(R.a)({},e,{instrumentTypeDragging:t.payload});case Ye.tg:return Object(R.a)({},e,{showingFormants:t.payload});case Ye.Eg:return Object(R.a)({},e,{showFormantEffect:t.payload});default:return e}},xt={selectedGuild:void 0,isManaging:void 0},Tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Kf:return Object(R.a)({},e,{selectedGuild:t.payload});case Ye.ed:return Object(R.a)({},e,{isManaging:t.payload});default:return e}},Ct=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case Ye.a:return(e=Object.assign({},t))[n.payload.id]=n.payload,e;case Ye.s:return delete(e=Object.assign({},t))[n.payload.id],e;default:return t}},Nt=n(353),Rt=n(71),Mt={selectedTrackEffects:{},selectedGroupEffects:{},selectedTrackMidiEffects:{},groupCollapsed:{},hideMixer:!0,selectedGroup:void 0,selectedTrack:void 0,selectedStep:void 0,hoveredStep:void 0,selectedParameter:void 0,selectedParameterFlashing:void 0,effectsPaneOption:Nt.a,isPlayingMix:!1,isRecordingMix:!1,erasingAutomation:!1,mixes:[],currentMix:void 0,multiParameterSliderValues:{},mixViewMode:Nt.i,subSequenceFades:{},subSequenceMuted:{},selectedSequence:void 0,trackerParameterToEdit:void 0},At=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Jf:return Object(R.a)({},e,{selectedGroup:t.payload});case Ye.eg:return Object(R.a)({},e,{selectedTrack:t.payload});case Ye.Oh:return Object(R.a)({},e,{trackerParameterToEdit:t.payload});case Ye.cg:return Object(R.a)({},e,{selectedStep:t.payload});case Ye.Zc:return Object(R.a)({},e,{hoveredStep:t.payload});case Ye.Rf:return Object(R.a)({},e,{selectedParameter:t.payload});case Ye.Sf:return Object(R.a)({},e,{selectedParameterFlashing:t.payload});case Ye.kc:return Object(R.a)({},e,{effectsPaneOption:t.payload});case Ye.Uc:return Object(R.a)({},e,{hideMixer:t.payload});case Ye.kd:return Object(R.a)({},e,{isRecordingMix:t.payload});case Ye.gd:return Object(R.a)({},e,{isPlayingMix:t.payload});case Ye.Kd:return Object(R.a)({},e,{mixes:t.payload});case Ye.Kb:return Object(R.a)({},e,{currentMix:t.payload});case Ye.tc:return Object(R.a)({},e,{erasingAutomation:t.payload});case Ye.Pd:return Object(R.a)({},e,{mixViewMode:t.payload});case Ye.Hh:var n=Object(R.a)({},e.subSequenceFades);return n[t.payload.subSequenceId]=t.payload.value,Object(R.a)({},e,{subSequenceFades:n});case Ye.Vd:var r=e.multiParameterSliderValues;return r[t.payload.id]=t.payload.value,Object(R.a)({},e,{multiParameterSliderValues:r});case Ye.Ih:var a=Object(R.a)({},e);return a.subSequenceMuted[t.payload.id]=t.payload.muted,a;case Ye.Mc:var i=e.groupCollapsed[t.payload.subSequenceId]||{};return i[t.payload.groupNumber]=t.payload.collapsed,(a=Object(R.a)({},e)).groupCollapsed[t.payload.subSequenceId]=i,a;case Ye.bg:return Object(R.a)({},e,{selectedSequence:t.payload});case Ye.Nf:var o=t.payload,s=o.subSequenceId,c=(o.effectType,o.trackNumber),u=o.groupNumber,l=o.effect;if(t.payload.effectType===Rt.a){if(void 0!==t.payload.trackNumber){var f=Object(R.a)({},e.selectedTrackEffects[s]);f[c]=l;var h=Object(R.a)({},e.selectedTrackEffects);return h[s]=f,Object(R.a)({},e,{selectedTrackEffects:h})}var p=Object(R.a)({},e.selectedGroupEffects[s]);p[u]=l;var d=Object(R.a)({},e.selectedGroupEffects);return d[s]=p,Object(R.a)({},e,{selectedGroupEffects:d})}var m=Object(R.a)({},e.selectedTrackMidiEffects[s]);m[c]=l;var v=Object(R.a)({},e.selectedTrackMidiEffects);return v[s]=m,Object(R.a)({},e,{selectedTrackMidiEffects:v});case Ye.Od:return Object(R.a)({},e,{trackDragging:t.payload});default:return e}},qt={groupByPacks:!0,selectedFolder:void 0,folderDragging:void 0,presetDragging:void 0,selectedPreset:void 0,hasChangesToFolders:!1,trackPresetSaving:void 0},Dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Ve:return Object(R.a)({},e,{presetSaved:t.payload});case Ye.Pc:return Object(R.a)({},e,{groupByPacks:t.payload});case Ye.Hf:return Object(R.a)({},e,{selectedPreset:void 0,selectedFolder:t.payload});case Ye.Vf:return Object(R.a)({},e,{selectedFolder:void 0,selectedPreset:t.payload});case Ye.Sc:return Object(R.a)({},e,{hasChangesToFolders:t.payload});case Ye.Fc:return Object(R.a)({},e,{folderDragging:t.payload});case Ye.Ue:return Object(R.a)({},e,{presetDragging:t.payload});case Ye.ni:return Object(R.a)({},e,{trackPresetSaving:t.payload});default:return e}},It={notes:[],pianoRollLeftSpace:56,isDragToggled:!1,dragStepTranspose:void 0,stepDragging:void 0,stepDataDragging:void 0,isDraggingDuration:!1,stepToCopy:void 0,transposeDragging:void 0,isMouseDown:!1,isCommandDown:!1,pianoRollSelection:void 0,selectedPianoRollSteps:void 0,stepsToCopy:void 0,easyPatternToCopy:void 0,lastMidiKeyMapped:void 0,pianoRollPagination:void 0,keyMappings:{},padMappings:{},lastNotePlayed:void 0,dragOffset:void 0,cursor:void 0,notesDown:void 0},_t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:It,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.pd:return Object(R.a)({},e,{keyboardContext:t.payload});case Ye.Xd:return Object(R.a)({},e,{notesDown:t.payload});case Ye.m:return Object(R.a)({},e,{isDragToggled:t.payload});case Ye.l:return Object(R.a)({},e,{dragStepTranspose:t.payload});case Ye.o:var n=t.payload;return Object(R.a)({},e,{isMouseDown:n});case Ye.c:return Object(R.a)({},e,{isCommandDown:t.payload});case Ye.Ge:return Object(R.a)({},e,{pianoRollSlide:t.payload});case Ye.Ah:return Object(R.a)({},e,{stepDragging:t.payload});case Ye.Eh:return Object(R.a)({},e,{stepToCopy:t.payload});case Ye.cd:return Object(R.a)({},e,{isDraggingDuration:t.payload});case Ye.De:return Object(R.a)({},e,{notes:t.payload});case Ye.yh:return Object(R.a)({},e,{stepDataDragging:t.payload.stepData,stepDragging:t.payload.stepNumber});case Ye.zh:return Object(R.a)({},e,{stepDataDragging:t.payload});case Ye.Fe:return void 0===t.payload.stepNumber?Object(R.a)({},e,{pianoRollSelection:void 0}):Object(R.a)({},e,{pianoRollSelection:t.payload});case Ye.Tf:var r=e.selectedPianoRollSteps;return t.payload&&(r=r||[],r=[].concat(Object(ie.a)(r),Object(ie.a)(t.payload))),r&&r.every(function(e){return e&&e.pLockedParameters.length>0})&&setTimeout(function(){r.filter(function(e){return e.pLockedParameters.length>0}).forEach(function(e){return e.pLockedParameters.forEach(function(e){e.refresh(!0,!1,void 0,!0)})})},150),Object(R.a)({},e,{selectedPianoRollSteps:t.payload});case Ye.xh:return Object(R.a)({},e,{stepsToCopy:t.payload});case Ye.ec:return Object(R.a)({},e,{easyPatternToCopy:t.payload});case Ye.sd:return Object(R.a)({},e,{lastMidiKeyMapped:t.payload});case Ye.zi:return Object(R.a)({},e,{transposeDragging:t.payload.transpose});case Ye.Ee:return Object(R.a)({},e,{pianoRollPagination:t.payload});case Ye.qd:return Object(R.a)({},e,{keyMappings:t.payload});case Ye.me:return Object(R.a)({},e,{padMappings:t.payload});case Ye.td:return Object(R.a)({},e,{lastNotePlayed:t.payload});case Ye.Be:return Object(R.a)({},e,{dragOffset:t.payload});case Ye.Ae:return Object(R.a)({},e,{cursor:t.payload});default:return e}},Ft={linkingEffects:void 0,scriptVariables:{},selectedEffect:void 0,parameterToMap:void 0,pulledEffects:[],selectedSendEffect:void 0,selectedPalettes:{},sequencedPalettes:{},effectParameters:{},midiEffectDragging:void 0,effectCollapsed:{},effectsChainToShow:{},effectRackNodePositions:{},isMacroMapping:!1,copiedNodesForRack:[],planeMapping:void 0,parameterMinMax:{},effectPatternLocks:{},effectStarred:{},showingContextMenu:!1,planar:{}},Lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft,t=arguments.length>1?arguments[1]:void 0,n=Object(R.a)({},e);switch(t.type){case Ye.q:return Ft;case Ye.sg:return Object(R.a)({},e,{showingContextMenu:t.payload});case Ye.Ze:return Object(R.a)({},e,{pulledEffects:t.payload});case Ye.qc:var r=e.effectStarred;return r[t.payload.id]=t.payload.starred,Object(R.a)({},e,{effectStarred:r});case Ye.mb:return Object(R.a)({},e,{effectStarred:Object(R.a)({},e.effectStarred,t.payload)});case Ye.Cf:return Object(R.a)({},e,{selectedEffect:t.payload});case Ye.dd:return Object(R.a)({},e,{isMacroMapping:t.payload});case Ye.ve:return Object(R.a)({},e,{parameterToMap:t.payload});case Ye.ag:return Object(R.a)({},e,{selectedSendEffect:t.payload});case Ye.Gd:return Object(R.a)({},e,{midiEffectDragging:t.payload});case Ye.Eb:return Object(R.a)({},e,{copiedNodesForRack:t.payload});case Ye.u:return Object(R.a)({},e,{accumulatorParameterSelected:t.payload});case Ye.se:var a=e.parameterMinMax;return Object(R.a)({},e,{parameterMinMax:Object(R.a)({},a,t.payload)});case Ye.mc:return(n=Object(R.a)({},e)).effectParameters[t.payload.id]=t.payload.value,n;case Ye.nc:var i=Object(R.a)({},e.effectParameters,t.payload);return Object(R.a)({},e,{effectParameters:i});case Ye.jc:var o=Object(R.a)({},e.effectsChainToShow),s=o[t.payload.subSequenceId]||{};return s[t.payload.trackNumber]=t.payload.chainNumber,o[t.payload.subSequenceId]=s,Object(R.a)({},e,{effectsChainToShow:o});case Ye.lb:return Object(R.a)({},e,{effectCollapsed:Object(R.a)({},e.effectCollapsed,t.payload)});case Ye.lc:return(n=Object(R.a)({},e)).effectCollapsed[t.payload.id]=t.payload.isCollapsed,n;case Ye.ic:return(n=Object(R.a)({},e)).effectsChainToShow[t.payload.subSequenceId]=t.payload.effectsChains,n;case Ye.pc:var c=e.effectRackNodePositions[t.payload.rackId]||{};c[t.payload.effectId]={x:t.payload.x,y:t.payload.y};var u=Object(R.a)({},e.effectRackNodePositions);return u[t.payload.rackId]=c,Object(R.a)({},e,{effectRackNodePositions:u});case Ye.vf:var l=Object(R.a)({},e.scriptVariables);return l[t.payload.id]=t.payload.variables,Object(R.a)({},e,{scriptVariables:l});case Ye.Qf:var f=Object(R.a)({},e.selectedPalettes);return f[t.payload.trackId]=t.payload.palette,Object(R.a)({},e,{selectedPalettes:f});case Ye.jg:var h=Object(R.a)({},e.sequencedPalettes);return h[t.payload.trackId]=t.payload.palette,Object(R.a)({},e,{sequencedPalettes:h});case Ye.Ne:return Object(R.a)({},e,{planeMapping:t.payload});case Ye.xd:return Object(R.a)({},e,{linkingEffects:t.payload});case Ye.y:return Object(R.a)({},e,{effectPatternLocks:Object(R.a)({},e.effectPatternLocks,t.payload)});case Ye.oc:var p=Object(R.a)({},e.effectPatternLocks);return p[t.payload.id]=t.payload.patternLocks,Object(R.a)({},e,{effectPatternLocks:p});case Ye.He:var d=Object(R.a)({},e.planar);return d[t.payload.track]=t.payload.planar,Object(R.a)({},e,{planar:d});case Ye.b:return Object(R.a)({},e,{effectDragging:void 0,midiEffectDragging:void 0});default:return e}},Bt={sourceExploring:void 0,yearExploring:void 0,maximizeExplorer:void 0,currentSoundInList:void 0,currentTagInList:void 0,searchInput:void 0,yearSelected:void 0,countriesSelected:{},sampleToExplore:void 0,stylesSelected:{},tagsSelected:{},videosSelected:{},discogsSelected:{},sampleDragging:void 0,chordSelected:void 0,hierarchyRoot:void 0,hierarchyTreeTags:void 0,showYearSlider:!1,showCountries:!1,showStyles:!1,showVideos:!1,showTags:!1,showChordFilter:!1,showDateSampled:!1,searchResultsSamples:[],selectedChordSample:void 0,waveformSelection:void 0,sortBy:n(531).b,sidebarCollapsed:!1,dateSampled:void 0,startX:0,startY:0,endX:0,endY:0,similarSoundsToFind:void 0,showSamples2D:!1,searchResultsStart:0,quickAddSearchText:"",sampleTagDragging:void 0},zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.b:return Object(R.a)({},e,{sampleDragging:void 0,sampleTagDragging:void 0,samplesDragging:void 0});case Ye.Fd:return Object(R.a)({},e,{explorerMaximized:t.payload});case Ye.th:return Object(R.a)({},e,{sourceExploring:t.payload});case Ye.Xi:return Object(R.a)({},e,{yearExploring:t.payload});case Ye.of:return Object(R.a)({},e,{sampleExplorerSelected:t.payload});case Ye.Yi:return Object(R.a)({},e,{yearSelected:t.payload});case Ye.Kh:return Object(R.a)({},e,{tagsSelected:t.payload});case Ye.xf:return Object(R.a)({},e,{searchResultsStart:t.payload});case Ye.Fb:return Object(R.a)({},e,{countriesSelected:t.payload});case Ye.oh:return Object(R.a)({},e,{searchInput:t.payload});case Ye.Ji:return Object(R.a)({},e,{videosSelected:t.payload});case Ye.Yb:return Object(R.a)({},e,{discogsSelected:t.payload});case Ye.Fh:return Object(R.a)({},e,{stylesSelected:t.payload});case Ye.jf:return Object(R.a)({},e,{samplesDragging:t.payload});case Ye.Vc:return Object(R.a)({},e,{hierarchyRoot:t.payload});case Ye.Wc:return Object(R.a)({},e,{hierarchyTreeTags:t.payload});case Ye.fh:return Object(R.a)({},e,{showTags:t.payload});case Ye.lh:return Object(R.a)({},e,{showYearSlider:t.payload});case Ye.Ag:return Object(R.a)({},e,{showCountries:t.payload});case Ye.eh:return Object(R.a)({},e,{showStyles:t.payload});case Ye.yg:return Object(R.a)({},e,{showChordFilter:t.payload});case Ye.sb:return Object(R.a)({},e,{chordSelected:t.payload});case Ye.wf:return Object(R.a)({},e,{searchResultsSamples:t.payload});case Ye.Bf:return Object(R.a)({},e,{selectedChordSample:t.payload});case Ye.kh:return Object(R.a)({},e,{showVideos:t.payload});case Ye.Qi:return Object(R.a)({},e,{waveformSelection:t.payload});case Ye.Ri:var n=Object(R.a)({},e.waveformSelection,{end:t.payload});return Object(R.a)({},e,{waveformSelection:n});case Ye.yf:return Object(R.a)({},e,{sortBy:t.payload});case Ye.nh:return Object(R.a)({},e,{sidebarCollapsed:t.payload});case Ye.Bg:return Object(R.a)({},e,{showDateSampled:t.payload});case Ye.Vb:return Object(R.a)({},e,{dateSampled:t.payload});case Ye.rh:return Object(R.a)({},e,{similarSoundsToFind:t.payload});case Ye.Wg:return Object(R.a)({},e,{showSamples2D:t.payload});case Ye.t:return Object(R.a)({},e,{startX:t.payload.startX,startY:t.payload.startY,endX:t.payload.endX,endY:t.payload.endY});case Ye.nf:return Object(R.a)({},e,{sampleDragging:t.payload});case Ye.tf:return Object(R.a)({},e,{showSamples2D:void 0!==t.payload,sampleToExplore:t.payload});case Ye.bf:return Object(R.a)({},e,{quickAddSearchText:t.payload});case Ye.uc:return Object(R.a)({},e,{expandedProject:t.payload});case Ye.rf:return Object(R.a)({},e,{sampleTagDragging:t.payload});case Ye.Nb:return Object(R.a)({},e,{currentSoundInList:t.payload});case Ye.Qb:return Object(R.a)({},e,{currentTagInList:t.payload});case Ye.ug:return Object(R.a)({},e,{showingSoundList:t.payload});default:return e}},Vt={sampleAuditioning:void 0,rightSidebarOption:"Tools"},Ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.hf:return Object(R.a)({},e,{rightSidebarOption:t.payload});case Ye.lf:return Object(R.a)({},e,{sampleAuditioning:t.payload});case Ye.sf:return Object(R.a)({},e,{sampleTooltip:t.payload});default:return e}},Ut={viewMode:n(1069).c,currentMix:void 0,hasEditsToSave:!1,loadedTracks:[],bpm:120,spotlightTracks:[]},Jt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Di:return Object(R.a)({},e,{viewMode:t.payload});case Ye.Rb:return Object(R.a)({},e,{currentMix:t.payload});case Ye.Bi:return Object(R.a)({},e,{hasEditsToSave:t.payload});case Ye.yd:return Object(R.a)({},e,{loadedTracks:t.payload});case Ye.kb:return Object(R.a)({},e,{bpm:t.payload});case Ye.uh:return Object(R.a)({},e,{spotlightTracks:t.payload});default:return e}},Gt={patternToEditColor:void 0,patternColors:{},jakiGridMode:n(87).a,showSaveModal:!1},Wt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Xg:return Object(R.a)({},e,{showSaveModal:t.payload});case Ye.od:return Object(R.a)({},e,{jakiGridMode:t.payload});case Ye.ye:return Object(R.a)({},e,{patternToEditColor:t.payload});case Ye.xe:var n=Object(R.a)({},e.patternColors);return n[t.payload.pattern]=t.payload.color,Object(R.a)({},e,{patternColors:n});default:return e}},Kt={stepGroups:[],stepsSelection:void 0,selectedSteps:void 0,stepNumberDraggingFrom:void 0,stepNumberDraggedTo:void 0,singleStepToDrag:void 0,showStepOptions:void 0,masterStepToggles:Array(16).fill(!0)},Xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.r:return Object(R.a)({},e,{stepGroups:[].concat(Object(ie.a)(e.stepGroups),[t.payload])});case Ye.wh:return void 0===t.payload.fromStep?Object(R.a)({},e,{stepsSelection:void 0}):Object(R.a)({},e,{stepsSelection:t.payload});case Ye.dg:return void 0===t.payload.trackNumber?Object(R.a)({},e,{selectedSteps:void 0}):Object(R.a)({},e,{selectedSteps:t.payload});case Ye.Ch:return Object(R.a)({},e,{stepNumberDraggingFrom:t.payload});case Ye.Dd:return Object(R.a)({},e,{masterStepToggles:t.payload});case Ye.sh:return Object(R.a)({},e,{singleStepToDrag:t.payload});case Ye.Bh:return Object(R.a)({},e,{stepNumberDraggedTo:t.payload});case Ye.dh:return void 0===t.payload.option?Object(R.a)({},e,{showStepOptions:void 0}):Object(R.a)({},e,{showStepOptions:{option:t.payload.option,effect:t.payload.effect}});default:return e}},Qt={youtubeSearchTerms:"",selectedRecord:void 0},Yt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Zi:return Object(R.a)({},e,{youtubeSearchTerms:t.payload});case Ye.Yf:return Object(R.a)({},e,{selectedRecord:t.payload});default:return e}},Zt=n(124),$t={midiMapMode:Zt.c,parameterSelected:void 0,mappings:{},actionSelected:void 0,actionMappings:{},lastMidiCCPlayed:void 0},en=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$t,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case Ye.rd:return Object(R.a)({},r,{lastMidiCCPlayed:a.payload});case Ye.Hd:return Object(R.a)({},r,{midiMapMode:a.payload,parameterSelected:void 0,actionSelected:void 0});case Ye.re:return Object(R.a)({},r,{actionSelected:void 0,parameterSelected:a.payload});case Ye.x:return Object(R.a)({},r,{parameterSelected:void 0,actionSelected:a.payload});case Ye.qe:return void 0===(t=Object(R.a)({},r.mappings))[e=a.payload.midiControl]&&(t[e]=[]),t[e].push(a.payload.parameter),Object(R.a)({},r,{mappings:t});case Ye.w:return void 0===(n=Object(R.a)({},r.actionMappings))[e=a.payload.midiControl]&&(n[e]=[]),n[e].push(a.payload.action),Object(R.a)({},r,{actionMappings:n});case Ye.g:var i={},o=a.payload;for(var s in r.mappings){var c=r.mappings[s],u=c.indexOf(o);u>-1&&c.splice(u,1),c.length>0&&(i[s]=c)}return Object(R.a)({},r,{mappings:i,parameterSelected:void 0,midiMapMode:Zt.c});case Ye.f:return n=Object(R.a)({},r.actionMappings),t=Object(R.a)({},r.mapping),delete n[a.payload],delete t[a.payload],Object(R.a)({},r,{mappings:t,actionMappings:n});default:return r}},tn={connectionStatus:n(176).b,connectedUserName:void 0,clockTick:void 0,playScheduled:!1,availableUsers:[]},nn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Cb:return Object(R.a)({},e,{connectionStatus:t.payload});case Ye.Bb:return Object(R.a)({},e,{connectedUserName:t.payload});case Ye.vb:return Object(R.a)({},e,{clockTick:t.payload});case Ye.Oe:return Object(R.a)({},e,{playScheduled:t.payload});case Ye.hb:return console.log("setting available users = "),console.log(t.payload),Object(R.a)({},e,{availableUsers:t.payload});default:return e}},rn={showShareSequenceModal:!1},an=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.ch:return Object(R.a)({},e,{showShareSequenceModal:t.payload});default:return e}},on={totalLength:120,browserMode:1,bottomHeight:400,bottomMode:n(106).d,patternDragging:void 0,patternResizing:void 0,showSearcher:!1,isBottomResizing:!1,bottomOffset:0,patternStartSteps:{},loopSelected:!1,mixEvents:{},xScale:.25,selectedEvents:void 0,selection:{start:0,end:64},looping:!1,mouseX:void 0,mouseDownX:0,automationTypeToShow:{},selectedRows:[],rowSelections:{},cursorStep:void 0,showTracks:{},patternSelected:void 0},sn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:on,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Md:var n=Object(R.a)({},e.mixEvents),r=n[t.payload.subSequenceId]||{};return r[t.payload.type]=t.payload.events,n[t.payload.subSequenceId]=r,Object(R.a)({},e,{mixEvents:n});case Ye.T:return Object(R.a)({},e,{patternSelected:t.payload});case Ye.Nh:return Object(R.a)({},e,{totalLength:t.payload});case Ye.wg:var a=Object(R.a)({},e.showTracks);return a[t.payload.subSequenceId]=t.payload.show,Object(R.a)({},e,{showTracks:a});case Ye.vg:return Object(R.a)({},e,{showSearcher:t.payload});case Ye.H:var i=Object(R.a)({},e.automationTypeToShow);return i[t.payload.subSequenceId]=t.payload.type,Object(R.a)({},e,{automationTypeToShow:i});case Ye.Af:return Object(R.a)({},e,{rowSelections:void 0===t.payload?e.rowSelections:{},selectedEvents:t.payload});case Ye.X:return void 0===t.payload.start?Object(R.a)({},e,{selection:void 0}):Object(R.a)({},e,{selection:{start:t.payload.start,end:t.payload.end}});case Ye.V:return Object(R.a)({},e,{rowSelections:Object(R.a)({},t.payload)});case Ye.Q:return Object(R.a)({},e,{mouseX:t.payload});case Ye.P:return Object(R.a)({},e,{mouseDownX:t.payload});case Ye.N:return Object(R.a)({},e,{looping:t.payload});case Ye.O:return Object(R.a)({},e,{loopSelected:t.payload});case Ye.W:return Object(R.a)({},e,{selectedRows:t.payload});case Ye.Y:return Object(R.a)({},e,{xScale:t.payload});case Ye.I:return Object(R.a)({},e,{bottomHeight:t.payload});case Ye.J:return Object(R.a)({},e,{bottomMode:t.payload});case Ye.K:return Object(R.a)({},e,{isBottomResizing:t.payload});case Ye.R:return Object(R.a)({},e,{patternDragging:t.payload});case Ye.S:return Object(R.a)({},e,{patternResizing:t.payload});case Ye.U:var o=e.patternStartSteps[t.payload.subSequenceId]||{};o[t.payload.patternId]=t.payload.startStep;var s=e.patternStartSteps;return s[t.payload.subSequenceId]=o,Object(R.a)({},e,{patternStartSteps:s});case Ye.M:return Object(R.a)({},e,{cursorStep:t.payload});case Ye.L:return Object(R.a)({},e,{browserMode:t.payload});case Ye.jb:return Object(R.a)({},e,{bottomOffset:t.payload});default:return e}},cn={selectedOnsets:{},onsetThreshold:.5,showingOnsets:!1},un=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cn,t=arguments.length>1?arguments[1]:void 0,n=Object(R.a)({},e);switch(t.type){case Ye.Of:return n.selectedOnsets[t.payload.id]=t.payload.selectedOnsets,n;case Ye.ce:return Object(R.a)({},e,{onsetThreshold:t.payload});case Ye.Og:return Object(R.a)({},e,{showingOnsets:t.payload});default:return e}},ln={pendingTransactions:[],transactionUponLogin:void 0},fn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.xi:return Object(R.a)({},e,{transactionUponLogin:t.payload});case Ye.ze:return Object(R.a)({},e,{pendingTransactions:t.payload});default:return e}},hn={commandInput:void 0,commandPrefix:void 0,viMode:!1},pn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.xb:return Object(R.a)({},e,{commandInput:t.payload});case Ye.yb:return Object(R.a)({},e,{commandPrefix:t.payload});case Ye.Oi:return Object(R.a)({},e,{viMode:t.payload});default:return e}},dn=(n(649),n(650),{exploreOption:n(1106).b,exploreWork:void 0,toast:void 0,unpublished:void 0,annotationsView:void 0,personSelected:void 0,recordingMix:!1,projectDragging:void 0,mixColorValues:{},allSequences:[],workTransposes:{},mixHasEdits:!1,workVolumes:{},mixLoaded:void 0,mixerEffects:{REVERB:!0,PHASER:!1,DELAY:!1},eqEffects:{LOW:!0,MID:!0,HIGH:!0},worksLoaded:[]}),mn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn,t=arguments.length>1?arguments[1]:void 0,n=Object(R.a)({},e);switch(t.type){case Ye.xc:return n.mixerEffects=Object(R.a)({},n.mixerEffects),n.mixerEffects[t.payload.effect]=t.payload.toggle,n;case Ye.wc:return n.eqEffects=Object(R.a)({},n.eqEffects),n.eqEffects[t.payload.type]=t.payload.toggle,n;case Ye.Ld:return n.mixColorValues=Object(R.a)({},n.mixColorValues),n.mixColorValues[t.payload.id]=t.payload.value,n;case Ye.Xe:return Object(R.a)({},e,{projectDragging:t.payload});case Ye.Cc:return Object(R.a)({},e,{unpublished:t.payload});case Ye.Ac:return Object(R.a)({},e,{personSelected:t.payload});case Ye.Dc:return Object(R.a)({},e,{exploreWork:t.payload});case Ye.Bc:return Object(R.a)({},e,{toast:t.payload});case Ye.Nd:return Object(R.a)({},e,{mixHasEdits:t.payload});case Ye.vc:return Object(R.a)({},e,{allSequences:t.payload});case Ye.df:return Object(R.a)({},e,{isRecordingMix:t.payload});case Ye.zc:return Object(R.a)({},e,{exploreOption:t.payload});case Ye.yc:return Object(R.a)({},e,{mixLoaded:t.payload});case Ye.Ui:return Object(R.a)({},e,{worksLoaded:t.payload});case Ye.Vi:var r=Object(R.a)({},e.workTransposes);return r[t.payload.sequenceId]=t.payload.transpose,Object(R.a)({},e,{workTransposes:r});case Ye.Wi:var a=Object(R.a)({},e.workVolumes);return a[t.payload.sequenceId]=t.payload.volume,Object(R.a)({},e,{workVolumes:a});case Ye.F:return Object(R.a)({},e,{annotationsView:t.payload});default:return e}},vn={windowPosition:{x:500,y:200},packSelected:void 0},bn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.ee:return Object(R.a)({},e,{packSelected:t.payload});case Ye.Gb:return Object(R.a)({},e,{creatingNewPack:t.payload});case Ye.ge:return Object(R.a)({},e,{windowPosition:t.payload});case Ye.bc:return Object(R.a)({},e,{draggingWindow:t.payload});case Ye.fe:return Object(R.a)({},e,{packToEdit:t.payload});default:return e}},gn={modulesCollapsed:{},padEffects:{},drawingEdges:{},movingEdge:void 0,trackMidiEffects:{},padFXMode:{}},yn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.ke:var n=e.padFXMode;return n[t.payload.id]=t.payload.mode,Object(R.a)({},e,{padFXMode:n});case Ye.Rd:var r=Object(R.a)({},e.modulesCollapsed);return r[t.payload.id]=t.payload.collapsed,Object(R.a)({},e,{modulesCollapsed:r});case Ye.nb:return Object(R.a)({},e,{modulesCollapsed:t.payload});case Ye.cc:var a=e.drawingEdges;return a[t.payload.id]=t.payload.edge,Object(R.a)({},e,{drawingEdges:a});case Ye.Ud:return Object(R.a)({},e,{movingEdge:t.payload});case Ye.Pf:return Object(R.a)({},e,{selectedEdge:t.payload});case Ye.kg:var i=Object(R.a)({},e.sequencers);return i[t.payload.id]=t.payload.sequencers,Object(R.a)({},e,{sequencers:i});case Ye.mg:var o=Object(R.a)({},e.sequencerTracks);return o[t.payload.id]=t.payload.tracks,Object(R.a)({},e,{sequencerTracks:o});case Ye.ne:var s=Object(R.a)({},e.padSlots);return s[t.payload.id]=t.payload.slots,Object(R.a)({},e,{padSlots:s});case Ye.ie:return Object(R.a)({},e,{padsExpand:t.payload});case Ye.he:var c=Object(R.a)({},e.pads);return c[t.payload.id]=t.payload.pads,Object(R.a)({},e,{pads:c});case Ye.je:var u=e.padEffects;return u[t.payload.id]=t.payload.effects,Object(R.a)({},e,{padEffects:Object(R.a)({},u)});case Ye.hi:var l=e.trackMidiEffects;return l[t.payload.id]=t.payload.effects,Object(R.a)({},e,{trackMidiEffects:Object(R.a)({},l)});default:return e}},kn={stepsGroupMode:!1,transformationEdgeDragging:void 0},On=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.vh:return Object(R.a)({},e,{stepsGroupMode:t.payload});case Ye.yi:return Object(R.a)({},e,{transformationEdgeDragging:t.payload});default:return e}},jn={moduleSizes:{},windowPositions:{},presentationWindowPositions:{},selectedElements:{},inletConnections:{}},wn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.ad:return e.inletConnections[t.payload.id]=Object(R.a)({},t.payload.connections),Object(R.a)({},e,{inletConnections:Object(R.a)({},e.inletConnections)});case Ye.Td:var n=e.moduleSizes;return n[t.payload.id]=t.payload.size,Object(R.a)({},e,{moduleSizes:n});case Ye.pb:return Object(R.a)({},e,{windowPositions:Object(R.a)({},e.windowPositions,t.payload)});case Ye.ob:return Object(R.a)({},e,{presentationWindowPositions:Object(R.a)({},e.presentationWindowPositions,t.payload)});case Ye.Ti:var r=e.windowPositions||{};return r[t.payload.id]=t.payload.position,Object(R.a)({},e,{windowPositions:r});case Ye.Te:var a=e.presentationWindowPositions||{};return a[t.payload.id]=t.payload.position,Object(R.a)({},e,{presentationWindowPositions:a});case Ye.Wf:return Object(R.a)({},e,{selectedElements:t.payload});default:return e}},En=Object(Qe.b)({sequencer:rt,tracks:gt,groups:On,packs:bn,cursor:St,samples:Ot,guilds:Tt,palette:Ct,presets:Dt,mix:At,keyboard:_t,effects:Lt,selector:zt,spatial:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.vd:return Object(R.a)({},e,{leftSidebarWidth:t.payload});case Ye.hc:return Object(R.a)({},e,{editorPadding:t.payload});case Ye.fc:return Object(R.a)({},e,{edgesPadding:t.payload});case Ye.gc:return Object(R.a)({},e,{edgesSize:t.payload});case Ye.Cg:return Object(R.a)({},e,{showEditorBottom:t.payload});case Ye.gj:return Object(R.a)({},e,{zobjectInputText:t.payload});case Ye.qb:var n=e.cableSegmentations;return n[t.payload.id]=t.payload.segmentation,Object(R.a)({},e,{cableSegmentations:n});case Ye.Se:return Object(R.a)({},e,{presentationMode:t.payload});case Ye.rb:return Object(R.a)({},e,{cableSegmentations:t.payload});case Ye.Pg:return Object(R.a)({},e,{showPadSequencer:t.payload});case Ye.Ng:return Object(R.a)({},e,{showModulators:t.payload});case Ye.jh:return Object(R.a)({},e,{showTrackInstrument:t.payload});case Ye.Vg:return Object(R.a)({},e,{showProjectsModal:t.payload});case Ye.Cd:return Object(R.a)({},e,{mainScrollRef:t.payload});case Ye.Mi:return Object(R.a)({},e,{position:t.payload});case Ye.mh:return Object(R.a)({},e,{sidebarsShowing:t.payload});case Ye.Yg:return Object(R.a)({},e,{showSearchWindow:t.payload});case Ye.Hi:var r=e.lockedObjects;return r[t.payload.id]=t.payload.lock,Object(R.a)({},e,{lockedObjects:r});case Ye.Ii:return Object(R.a)({},e,{lockedObjects:t.payload});case Ye.Ei:var a=e.hiddenObjects;return a[t.payload.id]=t.payload.hide,Object(R.a)({},e,{hiddenObjects:a});case Ye.Fi:return Object(R.a)({},e,{hiddenObjects:t.payload});default:return e}},audition:Ht,user:Jt,toolbar:Wt,steps:Xt,documentation:it,discover:Yt,midi:en,clock:nn,modals:an,arrangement:sn,waveform:un,transactions:fn,commands:pn,freeze:kt,explore:mn,instruments:Pt,automation:wt,installation:ht,cirklon:dt,pads:yn,plane:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{filteredParameters:{},selectedParameters:{},regionMode:{},macroToShow:{},gradientColors:{},opacities:{},macros:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Le:var n=Object(R.a)({},e.regionMode);return n[t.payload.id]=t.payload.isRegionMode,Object(R.a)({},e,{regionMode:n});case Ye.Je:var r=Object(R.a)({},e.macroToShow);return r[t.payload.id]=t.payload.macro,Object(R.a)({},e,{macroToShow:r});case Ye.Ec:var a=Object(R.a)({},e.filteredParameters);return a[t.payload.id]=t.payload.filtered,Object(R.a)({},e,{filteredParameters:a});case Ye.Uf:var i=Object(R.a)({},e.selectedParameters);return i[t.payload.id]=t.payload.selected,Object(R.a)({},e,{selectedParameters:i});case Ye.Ie:var o=Object(R.a)({},e.gradientColors);return o[t.payload.id]=t.payload.color,Object(R.a)({},e,{gradientColors:o});case Ye.Ke:var s=Object(R.a)({},e.opacities);return s[t.payload.id]=t.payload.opacity,Object(R.a)({},e,{opacities:s});case Ye.Me:var c=e.macros||{};return c[t.payload.id]=t.payload.macros,Object(R.a)({},e,{macros:c});default:return e}},windows:wn,higherOrder:lt,zobject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.hj:return Object(R.a)({},e,{modal:t.payload});case Ye.ij:return Object(R.a)({},e,{progressbar:t.payload});case Ye.cj:return Object(R.a)({},e,{zobjectsStack:t.payload});case Ye.kj:var n=e.tooltip;return t.payload.id?n[t.payload.id]=t.payload:n={},Object(R.a)({},e,{tooltip:n});case Ye.ej:var r=e.contextMenu;return t.payload.id?r[t.payload.id]=t.payload:r={},Object(R.a)({},e,{contextMenu:r});case Ye.dj:return Object(R.a)({},e,{zobjectBackground:t.payload});case Ye.fj:var a=e.zobjectsFlashing;return a[t.payload.id]=t.payload.timestamp,Object(R.a)({},e,{zobjectsFlashing:a});case Ye.Zd:return Object(R.a)({},e,{objectDragging:t.payload});case Ye.ae:var i=e.objectStylings;return i[t.payload.id]=t.payload.styling,Object(R.a)({},e,{objectStylings:i});case Ye.jj:var o=e.zobjectSizes;return o[t.payload.id]=t.payload.size,Object(R.a)({},e,{zobjectSizes:o});case Ye.Lc:return Object(R.a)({},e,{fullScreenZObject:t.payload});case Ye.Gi:return Object(R.a)({},e,{uxLocked:t.payload});case Ye.nd:var s=Object(R.a)({},e.jakiGrids);return s[t.payload.id]=t.payload.grid,Object(R.a)({},e,{jakiGrids:s});case Ye.gg:return Object(R.a)({},e,{selectedZObject:t.payload});case Ye.zf:return Object(R.a)({},e,{secondaryZObject:t.payload});case Ye.bj:var c=Object(R.a)({},e.zobjects);return c[t.payload.id]=t.payload.objects,Object(R.a)({},e,{zobjects:c});case Ye.aj:var u=Object(R.a)({},e.zmessages);return u[t.payload.id]=t.payload.messages,Object(R.a)({},e,{zmessages:u});case Ye.lj:return Object(R.a)({},e,{zobjectTypeDragging:t.payload});case Ye.Ki:return Object(R.a)({},e,{viewableSubPatches:t.payload});case Ye.Li:return Object(R.a)({},e,{viewableZObjects:t.payload});default:return e}},nft:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Wd:return Object(R.a)({},e,{newZoraTokenId:t.payload});case Ye.Jd:return Object(R.a)({},e,{mintingProgress:t.payload});case Ye.hd:return Object(R.a)({},e,{isPreparingNFT:t.payload});case Ye.Tc:return Object(R.a)({},e,{hicDialog:t.payload});case Ye.mj:return Object(R.a)({},e,{zoraDialog:t.payload});case Ye.Id:return Object(R.a)({},e,{mintedTokens:t.payload});default:return e}},plugins:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{showPluginsPane:!0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.Qe:return Object(R.a)({},e,{pluginsPaneHeight:t.payload});case Ye.Tg:return Object(R.a)({},e,{showPluginsPane:t.payload});case Ye.Sg:return Object(R.a)({},e,{showPlugins:t.payload});case Ye.Pe:return Object(R.a)({},e,{pluginsLoaded:t.payload});case Ye.Re:return Object(R.a)({},e,{pluginToSave:t.payload});default:return e}}}),Sn=Object(Qe.c)(En);f.a.render(u.a.createElement(g.a,{store:Sn},u.a.createElement(We,{store:Sn})),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");Ke?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Xe(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):Xe(e)})}}()}],[[1558,5,6]]]);
//# sourceMappingURL=main.8940daae.chunk.js.map